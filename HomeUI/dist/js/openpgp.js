"use strict";(globalThis["webpackChunkflux"]=globalThis["webpackChunkflux"]||[]).push([[4932],{15604:(e,t,r)=>{r.r(t),r.d(t,{AEADEncryptedDataPacket:()=>Za,CleartextMessage:()=>tc,CompressedDataPacket:()=>Oa,GrammarError:()=>Ma,LiteralDataPacket:()=>Ba,MarkerPacket:()=>io,Message:()=>Yo,OnePassSignaturePacket:()=>Qa,PacketList:()=>Ta,PaddingPacket:()=>fo,PrivateKey:()=>No,PublicKey:()=>Fo,PublicKeyEncryptedSessionKeyPacket:()=>Wa,PublicKeyPacket:()=>eo,PublicSubkeyPacket:()=>no,SecretKeyPacket:()=>ao,SecretSubkeyPacket:()=>ho,Signature:()=>yo,SignaturePacket:()=>Ua,Subkey:()=>xo,SymEncryptedIntegrityProtectedDataPacket:()=>Va,SymEncryptedSessionKeyPacket:()=>$a,SymmetricallyEncryptedDataPacket:()=>ro,TrustPacket:()=>uo,UnparseablePacket:()=>tr,UserAttributePacket:()=>so,UserIDPacket:()=>co,armor:()=>re,config:()=>N,createCleartextMessage:()=>ic,createMessage:()=>$o,decrypt:()=>uc,decryptKey:()=>oc,decryptSessionKeys:()=>pc,encrypt:()=>hc,encryptKey:()=>cc,encryptSessionKey:()=>gc,enums:()=>F,generateKey:()=>nc,generateSessionKey:()=>yc,readCleartextMessage:()=>rc,readKey:()=>zo,readKeys:()=>_o,readMessage:()=>Xo,readPrivateKey:()=>Go,readPrivateKeys:()=>jo,readSignature:()=>go,reformatKey:()=>sc,revokeKey:()=>ac,sign:()=>fc,unarmor:()=>te,verify:()=>lc});
/*! OpenPGP.js v6.2.0 - 2025-07-17 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
const i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if("default"!==r&&!(r in e)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(e)}const s=Symbol("doneWritingPromise"),a=Symbol("doneWritingResolve"),o=Symbol("doneWritingReject"),c=Symbol("readingIndex");class h extends Array{constructor(){super(),Object.setPrototypeOf(this,h.prototype),this[s]=new Promise((e,t)=>{this[a]=e,this[o]=t}),this[s].catch(()=>{})}}function u(e){return e&&e.getReader&&Array.isArray(e)}function f(e){if(!u(e)){const t=e.getWriter(),r=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),r.call(t)},t}this.stream=e}function l(e){if(u(e))return"array";if(i.ReadableStream&&i.ReadableStream.prototype.isPrototypeOf(e))return"web";if(e&&!(i.ReadableStream&&e instanceof i.ReadableStream)&&"function"==typeof e._read&&"object"==typeof e._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!e||!e.getReader)&&"web-like"}function y(e){return Uint8Array.prototype.isPrototypeOf(e)}function g(e){if(1===e.length)return e[0];let t=0;for(let n=0;n<e.length;n++){if(!y(e[n]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=e[n].length}const r=new Uint8Array(t);let i=0;return e.forEach(function(e){r.set(e,i),i+=e.length}),r}h.prototype.getReader=function(){return void 0===this[c]&&(this[c]=0),{read:async()=>(await this[s],this[c]===this.length?{value:void 0,done:!0}:{value:this[this[c]++],done:!1})}},h.prototype.readToEnd=async function(e){await this[s];const t=e(this.slice(this[c]));return this.length=0,t},h.prototype.clone=function(){const e=new h;return e[s]=this[s].then(()=>{e.push(...this)}),e},f.prototype.write=async function(e){this.stream.push(e)},f.prototype.close=async function(){this.stream[a]()},f.prototype.abort=async function(e){return this.stream[o](e),e},f.prototype.releaseLock=function(){},"object"==typeof i.process&&i.process.versions;const p=new WeakSet,d=Symbol("externalBuffer");function A(e){if(this.stream=e,e[d]&&(this[d]=e[d].slice()),u(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(l(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{t.closed.catch(function(){}),t.releaseLock()},void(this._cancel=t.cancel.bind(t))}let t=!1;this._read=async()=>t||p.has(e)?{value:void 0,done:!0}:(t=!0,{value:e,done:!1}),this._releaseLock=()=>{if(t)try{p.add(e)}catch(e){}}}function w(e){return l(e)?e:new ReadableStream({start(t){t.enqueue(e),t.close()}})}function m(e){if(l(e))return e;const t=new h;return(async()=>{const r=T(t);await r.write(e),await r.close()})(),t}function b(e){return e.some(e=>l(e)&&!u(e))?function(e){e=e.map(w);const t=v(async function(e){await Promise.all(i.map(t=>x(t,e)))});let r=Promise.resolve();const i=e.map((i,n)=>B(i,(i,s)=>(r=r.then(()=>k(i,t.writable,{preventClose:n!==e.length-1})),r)));return t.readable}(e):e.some(e=>u(e))?function(e){const t=new h;let r=Promise.resolve();return e.forEach((i,n)=>(r=r.then(()=>k(i,t,{preventClose:n!==e.length-1})),r)),t}(e):"string"==typeof e[0]?e.join(""):g(e)}async function k(e,t,{preventClose:r=!1,preventAbort:i=!1,preventCancel:n=!1}={}){if(l(e)&&!u(e)){e=w(e);try{if(e[d]){const r=T(t);for(let t=0;t<e[d].length;t++)await r.ready,await r.write(e[d][t]);r.releaseLock()}await e.pipeTo(t,{preventClose:r,preventAbort:i,preventCancel:n})}catch(e){}return}const s=R(e=m(e)),a=T(t);try{for(;;){await a.ready;const{done:e,value:t}=await s.read();if(e){r||await a.close();break}await a.write(t)}}catch(e){i||await a.abort(e)}finally{s.releaseLock(),a.releaseLock()}}function E(e,t){const r=new TransformStream(t);return k(e,r.writable),r.readable}function v(e){let t,r,i,n=!1,s=!1;return{readable:new ReadableStream({start(e){i=e},pull(){t?t():n=!0},async cancel(t){s=!0,e&&await e(t),r&&r(t)}},{highWaterMark:0}),writable:new WritableStream({write:async function(e){if(s)throw Error("Stream is cancelled");i.enqueue(e),n?n=!1:(await new Promise((e,i)=>{t=e,r=i}),t=null,r=null)},close:i.close.bind(i),abort:i.error.bind(i)})}}function I(e,t=()=>{},r=()=>{}){if(u(e)){const i=new h;return(async()=>{const n=T(i);try{const i=await P(e),s=t(i),a=r();let o;o=void 0!==s&&void 0!==a?b([s,a]):void 0!==s?s:a,await n.write(o),await n.close()}catch(e){await n.abort(e)}})(),i}if(l(e))return E(e,{async transform(e,r){try{const i=await t(e);void 0!==i&&r.enqueue(i)}catch(e){r.error(e)}},async flush(e){try{const t=await r();void 0!==t&&e.enqueue(t)}catch(t){e.error(t)}}});const i=t(e),n=r();return void 0!==i&&void 0!==n?b([i,n]):void 0!==i?i:n}function B(e,t){if(l(e)&&!u(e)){let r;const i=new TransformStream({start(e){r=e}}),n=k(e,i.writable),s=v(async function(e){r.error(e),await n,await new Promise(setTimeout)});return t(i.readable,s.writable),s.readable}e=m(e);const r=new h;return t(e,r),r}function S(e,t){let r;const i=B(e,(e,n)=>{const s=R(e);s.remainder=()=>(s.releaseLock(),k(e,n),i),r=t(s)});return r}function K(e){if(u(e))return e.clone();if(l(e)){const t=function(e){if(u(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(l(e)){const t=w(e).tee();return t[0][d]=t[1][d]=e[d],t}return[U(e),U(e)]}(e);return D(e,t[0]),t[1]}return U(e)}function C(e){return u(e)?K(e):l(e)?new ReadableStream({start(t){const r=B(e,async(e,r)=>{const i=R(e),n=T(r);try{for(;;){await n.ready;const{done:r,value:s}=await i.read();if(r){try{t.close()}catch(e){}return void await n.close()}try{t.enqueue(s)}catch(e){}await n.write(s)}}catch(e){t.error(e),await n.abort(e)}});D(e,r)}}):U(e)}function D(e,t){Object.entries(Object.getOwnPropertyDescriptors(e.constructor.prototype)).forEach(([r,i])=>{"constructor"!==r&&(i.value?i.value=i.value.bind(t):i.get=i.get.bind(t),Object.defineProperty(e,r,i))})}function U(e,t=0,r=1/0){if(u(e))throw Error("Not implemented");if(l(e)){if(t>=0&&r>=0){let i=0;return E(e,{transform(e,n){i<r?(i+e.length>=t&&n.enqueue(U(e,Math.max(t-i,0),r-i)),i+=e.length):n.terminate()}})}if(t<0&&(r<0||r===1/0)){let i=[];return I(e,e=>{e.length>=-t?i=[e]:i.push(e)},()=>U(b(i),t,r))}if(0===t&&r<0){let i;return I(e,e=>{const n=i?b([i,e]):e;if(n.length>=-r)return i=U(n,r),U(n,t,r);i=n})}return console.warn(`stream.slice(input, ${t}, ${r}) not implemented efficiently.`),Q(async()=>U(await P(e),t,r))}return e[d]&&(e=b(e[d].concat([e]))),y(e)?e.subarray(t,r===1/0?e.length:r):e.slice(t,r)}async function P(e,t=b){return u(e)?e.readToEnd(t):l(e)?R(e).readToEnd(t):e}async function x(e,t){if(l(e)){if(e.cancel){const r=await e.cancel(t);return await new Promise(setTimeout),r}if(e.destroy)return e.destroy(t),await new Promise(setTimeout),t}}function Q(e){const t=new h;return(async()=>{const r=T(t);try{await r.write(await e()),await r.close()}catch(e){await r.abort(e)}})(),t}function R(e){return new A(e)}function T(e){return new f(e)}A.prototype.read=async function(){return this[d]&&this[d].length?{done:!1,value:this[d].shift()}:this._read()},A.prototype.releaseLock=function(){this[d]&&(this.stream[d]=this[d]),this._releaseLock()},A.prototype.cancel=function(e){return this._cancel(e)},A.prototype.readLine=async function(){let e,t=[];for(;!e;){let{done:r,value:i}=await this.read();if(i+="",r)return t.length?b(t):void 0;const n=i.indexOf("\n")+1;n&&(e=b(t.concat(i.substr(0,n))),t=[]),n!==i.length&&t.push(i.substr(n))}return this.unshift(...t),e},A.prototype.readByte=async function(){const{done:e,value:t}=await this.read();if(e)return;const r=t[0];return this.unshift(U(t,1)),r},A.prototype.readBytes=async function(e){const t=[];let r=0;for(;;){const{done:i,value:n}=await this.read();if(i)return t.length?b(t):void 0;if(t.push(n),r+=n.length,r>=e){const r=b(t);return this.unshift(U(r,e)),U(r,0,e)}}},A.prototype.peekBytes=async function(e){const t=await this.readBytes(e);return this.unshift(t),t},A.prototype.unshift=function(...e){this[d]||(this[d]=[]),1===e.length&&y(e[0])&&this[d].length&&e[0].length&&this[d][0].byteOffset>=e[0].length?this[d][0]=new Uint8Array(this[d][0].buffer,this[d][0].byteOffset-e[0].length,this[d][0].byteLength+e[0].length):this[d].unshift(...e.filter(e=>e&&e.length))},A.prototype.readToEnd=async function(e=b){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return e(t)};const M=Symbol("byValue");var F={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(e,t){if("number"==typeof t&&(t=this.read(e,t)),void 0!==e[t])return e[t];throw Error("Invalid enum value.")},read:function(e,t){if(e[M]||(e[M]=[],Object.entries(e).forEach(([t,r])=>{e[M][r]=t})),void 0!==e[M][t])return e[M][t];throw Error("Invalid enum value.")}},N={preferredHashAlgorithm:F.hash.sha512,preferredSymmetricAlgorithm:F.symmetric.aes256,preferredCompressionAlgorithm:F.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:F.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:F.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([F.symmetric.aes128,F.symmetric.aes192,F.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([F.hash.md5,F.hash.ripemd]),rejectMessageHashAlgorithms:new Set([F.hash.md5,F.hash.ripemd,F.hash.sha1]),rejectPublicKeyAlgorithms:new Set([F.publicKey.elgamal,F.publicKey.dsa]),rejectCurves:new Set([F.curve.secp256k1])};const L=(()=>{try{return!1}catch(i){}return!1})(),O={isString:function(e){return"string"==typeof e||e instanceof String},nodeRequire:()=>{},isArray:function(e){return e instanceof Array},isUint8Array:y,isStream:l,getNobleCurve:async(e,t)=>{if(!N.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then(function(){return dl});switch(e){case F.publicKey.ecdh:case F.publicKey.ecdsa:{const e=r.get(t);if(!e)throw Error("Unsupported curve");return e}case F.publicKey.x448:return r.get("x448");case F.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(e){let t=0;for(let r=0;r<e.length;r++)t+=256**r*e[e.length-1-r];return t},writeNumber:function(e,t){const r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e>>8*(t-i-1)&255;return r},readDate:function(e){const t=O.readNumber(e);return new Date(1e3*t)},writeDate:function(e){const t=Math.floor(e.getTime()/1e3);return O.writeNumber(t,4)},normalizeDate:function(e=Date.now()){return null===e||e===1/0?e:new Date(1e3*Math.floor(+e/1e3))},readMPI:function(e){const t=7+(e[0]<<8|e[1])>>>3;return O.readExactSubarray(e,2,2+t)},readExactSubarray:function(e,t,r){if(e.length<r-t)throw Error("Input array too short");return e.subarray(t,r)},leftPad(e,t){if(e.length>t)throw Error("Input array too long");const r=new Uint8Array(t),i=t-e.length;return r.set(e,i),r},uint8ArrayToMPI:function(e){const t=O.uint8ArrayBitLength(e);if(0===t)throw Error("Zero MPI");const r=e.subarray(e.length-Math.ceil(t/8)),i=new Uint8Array([(65280&t)>>8,255&t]);return O.concatUint8Array([i,r])},uint8ArrayBitLength:function(e){let t;for(t=0;t<e.length&&0===e[t];t++);if(t===e.length)return 0;const r=e.subarray(t);return 8*(r.length-1)+O.nbits(r[0])},hexToUint8Array:function(e){const t=new Uint8Array(e.length>>1);for(let r=0;r<e.length>>1;r++)t[r]=parseInt(e.substr(r<<1,2),16);return t},uint8ArrayToHex:function(e){const t="0123456789abcdef";let r="";return e.forEach(e=>{r+=t[e>>4]+t[15&e]}),r},stringToUint8Array:function(e){return I(e,e=>{if(!O.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})},uint8ArrayToString:function(e){const t=[],r=16384,i=(e=new Uint8Array(e)).length;for(let n=0;n<i;n+=r)t.push(String.fromCharCode.apply(String,e.subarray(n,n+r<i?n+r:i)));return t.join("")},encodeUTF8:function(e){const t=new TextEncoder("utf-8");function r(e,r=!1){return t.encode(e,{stream:!r})}return I(e,r,()=>r("",!0))},decodeUTF8:function(e){const t=new TextDecoder("utf-8");function r(e,r=!1){return t.decode(e,{stream:!r})}return I(e,r,()=>r(new Uint8Array,!0))},concat:b,concatUint8Array:g,equalsUint8Array:function(e,t){if(!O.isUint8Array(e)||!O.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},findLastIndex:function(e,t){for(let r=e.length;r>=0;r--)if(t(e[r],r,e))return r;return-1},writeChecksum:function(e){let t=0;for(let r=0;r<e.length;r++)t=t+e[r]&65535;return O.writeNumber(t,2)},printDebug:function(e){L&&console.log("[OpenPGP.js debug]",e)},printDebugError:function(e){L&&console.error("[OpenPGP.js debug]",e)},nbits:function(e){let t=1,r=e>>>16;return 0!==r&&(e=r,t+=16),r=e>>8,0!==r&&(e=r,t+=8),r=e>>4,0!==r&&(e=r,t+=4),r=e>>2,0!==r&&(e=r,t+=2),r=e>>1,0!==r&&(e=r,t+=1),t},double:function(e){const t=new Uint8Array(e.length),r=e.length-1;for(let i=0;i<r;i++)t[i]=e[i]<<1^e[i+1]>>7;return t[r]=e[r]<<1^135*(e[0]>>7),t},shiftRight:function(e,t){if(t)for(let r=e.length-1;r>=0;r--)e[r]>>=t,r>0&&(e[r]|=e[r-1]<<8-t);return e},getWebCrypto:function(){const e=void 0!==i&&i.crypto&&i.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!e)throw Error("The WebCrypto API is not available");return e},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(e){return!!O.isString(e)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(e)},canonicalizeEOL:function(e){let t=!1;return I(e,e=>{let r;t&&(e=O.concatUint8Array([new Uint8Array([13]),e])),13===e[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;const i=[];for(let t=0;r=e.indexOf(10,t)+1,r;t=r)13!==e[r-2]&&i.push(r);if(!i.length)return e;const n=new Uint8Array(e.length+i.length);let s=0;for(let t=0;t<i.length;t++){const r=e.subarray(i[t-1]||0,i[t]);n.set(r,s),s+=r.length,n[s-1]=13,n[s]=10,s++}return n.set(e.subarray(i[i.length-1]||0),s),n},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(e){let t=!1;return I(e,e=>{let r;13===(e=t&&10!==e[0]?O.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;let i=0;for(let t=0;t!==e.length;t=r){r=e.indexOf(13,t)+1,r||(r=e.length);const n=r-(10===e[r]?1:0);t&&e.copyWithin(i,t,n),i+=n-t}return e.subarray(0,i)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(e){return e.split("\n").map(e=>{let t=e.length-1;for(;t>=0&&(" "===e[t]||"\t"===e[t]||"\r"===e[t]);t--);return e.substr(0,t+1)}).join("\n")},wrapError:function(e,t){if(!t)return e instanceof Error?e:Error(e);if(e instanceof Error){try{e.message+=": "+t.message,e.cause=t}catch(e){}return e}return Error(e+": "+t.message,{cause:t})},constructAllowedPackets:function(e){const t={};return e.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(e){return new Promise(async(t,r)=>{let i;await Promise.all(e.map(async e=>{try{t(await e)}catch(e){i=e}})),r(i)})},selectUint8Array:function(e,t,r){const i=Math.max(t.length,r.length),n=new Uint8Array(i);let s=0;for(let a=0;a<n.length;a++)n[a]=t[a]&256-e|r[a]&255+e,s+=e&a<t.length|1-e&a<r.length;return n.subarray(0,s)},selectUint8:function(e,t,r){return t&256-e|r&255+e},isAES:function(e){return e===F.symmetric.aes128||e===F.symmetric.aes192||e===F.symmetric.aes256}},H=O.getNodeBuffer();let z,G;function _(e){let t=new Uint8Array;return I(e,e=>{t=O.concatUint8Array([t,e]);const r=[],i=Math.floor(t.length/45),n=45*i,s=z(t.subarray(0,n));for(let t=0;t<i;t++)r.push(s.substr(60*t,60)),r.push("\n");return t=t.subarray(n),r.join("")},()=>t.length?z(t)+"\n":"")}function j(e){let t="";return I(e,e=>{t+=e;let r=0;const i=[" ","\t","\r","\n"];for(let a=0;a<i.length;a++){const e=i[a];for(let i=t.indexOf(e);-1!==i;i=t.indexOf(e,i+1))r++}let n=t.length;for(;n>0&&(n-r)%4!=0;n--)i.includes(t[n])&&r--;const s=G(t.substr(0,n));return t=t.substr(n),s},()=>G(t))}function q(e){return j(e.replace(/-/g,"+").replace(/_/g,"/"))}function V(e,t){let r=_(e).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function J(e){const t=e.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?F.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?F.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?F.armor.signed:/MESSAGE/.test(t[1])?F.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?F.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?F.armor.privateKey:/SIGNATURE/.test(t[1])?F.armor.signature:void 0}function Y(e,t){let r="";return t.showVersion&&(r+="Version: "+t.versionString+"\n"),t.showComment&&(r+="Comment: "+t.commentString+"\n"),e&&(r+="Comment: "+e+"\n"),r+="\n",r}function Z(e){const t=function(e){let t=13501623;return I(e,e=>{const r=X?Math.floor(e.length/4):0,i=new Uint32Array(e.buffer,e.byteOffset,r);for(let n=0;n<r;n++)t^=i[n],t=W[0][t>>24&255]^W[1][t>>16&255]^W[2][t>>8&255]^W[3][255&t];for(let n=4*r;n<e.length;n++)t=t>>8^W[0][255&t^e[n]]},()=>new Uint8Array([t,t>>8,t>>16]))}(e);return _(t)}H?(z=e=>H.from(e).toString("base64"),G=e=>{const t=H.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(z=e=>btoa(O.uint8ArrayToString(e)),G=e=>O.stringToUint8Array(atob(e)));const W=[Array(255),Array(255),Array(255),Array(255)];for(let Oy=0;Oy<=255;Oy++){let e=Oy<<16;for(let t=0;t<8;t++)e=e<<1^(8388608&e?8801531:0);W[0][Oy]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let Oy=0;Oy<=255;Oy++)W[1][Oy]=W[0][Oy]>>8^W[0][255&W[0][Oy]];for(let Oy=0;Oy<=255;Oy++)W[2][Oy]=W[1][Oy]>>8^W[0][255&W[1][Oy]];for(let Oy=0;Oy<=255;Oy++)W[3][Oy]=W[2][Oy]>>8^W[0][255&W[2][Oy]];const X=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,255,!0),255===new Int16Array(e)[0]}();function $(e){for(let t=0;t<e.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(e[t])||O.printDebugError(Error("Improperly formatted armor header: "+e[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(e[t])||O.printDebugError(Error("Unknown header: "+e[t]))}function ee(e){let t=e;const r=e.lastIndexOf("=");return r>=0&&r!==e.length-1&&(t=e.slice(0,r)),t}function te(e){return new Promise(async(t,r)=>{try{const i=/^-----[^-]+-----$/m,n=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,h=a,u=[];const f=j(B(e,async(e,l)=>{const y=R(e);try{for(;;){let e=await y.readLine();if(void 0===e)throw Error("Misformed armored text");if(e=O.removeTrailingSpaces(e.replace(/[\r\n]/g,"")),s)if(o)c||s!==F.armor.signed||(i.test(e)?(u=u.join("\r\n"),c=!0,$(h),h=[],o=!1):u.push(e.replace(/^- /,"")));else if(i.test(e)&&r(Error("Mandatory blank line missing between armor headers and armor data")),n.test(e)){if($(h),o=!0,c||s!==F.armor.signed){t({text:u,data:f,headers:a,type:s});break}}else h.push(e);else i.test(e)&&(s=J(e))}}catch(e){return void r(e)}const g=T(l);try{for(;;){await g.ready;const{done:e,value:t}=await y.read();if(e)throw Error("Misformed armored text");const r=t+"";if(-1!==r.indexOf("=")||-1!==r.indexOf("-")){let e=await y.readToEnd();e.length||(e=""),e=r+e,e=O.removeTrailingSpaces(e.replace(/\r/g,""));const t=e.split(i);if(1===t.length)throw Error("Misformed armored text");const n=ee(t[0].slice(0,-1));await g.write(n);break}await g.write(r)}await g.ready,await g.close()}catch(e){await g.abort(e)}}))}catch(e){r(e)}}).then(async e=>(u(e.data)&&(e.data=await P(e.data)),e))}function re(e,t,r,i,n,s=!1,a=N){let o,c;e===F.armor.signed&&(o=t.text,c=t.hash,t=t.data);const h=s&&C(t),u=[];switch(e){case F.armor.multipartSection:u.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+i+"-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP MESSAGE, PART "+r+"/"+i+"-----\n");break;case F.armor.multipartLast:u.push("-----BEGIN PGP MESSAGE, PART "+r+"-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP MESSAGE, PART "+r+"-----\n");break;case F.armor.signed:u.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),u.push(c?`Hash: ${c}\n\n`:"\n"),u.push(o.replace(/^-/gm,"- -")),u.push("\n-----BEGIN PGP SIGNATURE-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP SIGNATURE-----\n");break;case F.armor.message:u.push("-----BEGIN PGP MESSAGE-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP MESSAGE-----\n");break;case F.armor.publicKey:u.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case F.armor.privateKey:u.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case F.armor.signature:u.push("-----BEGIN PGP SIGNATURE-----\n"),u.push(Y(n,a)),u.push(_(t)),h&&u.push("=",Z(h)),u.push("-----END PGP SIGNATURE-----\n")}return O.concat(u)}const ie=BigInt(0),ne=BigInt(1);function se(e){const t="0123456789ABCDEF";let r="";return e.forEach(e=>{r+=t[e>>4]+t[15&e]}),BigInt("0x0"+r)}function ae(e,t){const r=e%t;return r<ie?r+t:r}function oe(e,t,r){if(r===ie)throw Error("Modulo cannot be zero");if(r===ne)return BigInt(0);if(t<ie)throw Error("Unsopported negative exponent");let i=t,n=e;n%=r;let s=BigInt(1);for(;i>ie;){const e=i&ne;i>>=ne,s=e?s*n%r:s,n=n*n%r}return s}function ce(e){return e>=ie?e:-e}function he(e,t){const{gcd:r,x:i}=function(e,t){let r=BigInt(0),i=BigInt(1),n=BigInt(1),s=BigInt(0),a=ce(e),o=ce(t);const c=e<ie,h=t<ie;for(;o!==ie;){const e=a/o;let t=r;r=n-e*r,n=t,t=i,i=s-e*i,s=t,t=o,o=a%o,a=t}return{x:c?-n:n,y:h?-s:s,gcd:a}}(e,t);if(r!==ne)throw Error("Inverse does not exist");return ae(i+t,t)}function ue(e){const t=Number(e);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}function fe(e,t){return(e>>BigInt(t)&ne)===ie?0:1}function le(e){const t=e<ie?BigInt(-1):ie;let r=1,i=e;for(;(i>>=ne)!==t;)r++;return r}function ye(e){const t=e<ie?BigInt(-1):ie,r=BigInt(8);let i=1,n=e;for(;(n>>=r)!==t;)i++;return i}function ge(e,t="be",r){let i=e.toString(16);i.length%2==1&&(i="0"+i);const n=i.length/2,s=new Uint8Array(r||n),a=r?r-n:0;let o=0;for(;o<n;)s[o+a]=parseInt(i.slice(2*o,2*o+2),16),o++;return"be"!==t&&s.reverse(),s}const pe=O.getNodeCrypto();function de(e){const t="undefined"!=typeof crypto?crypto:pe?.webcrypto;if(t?.getRandomValues){const r=new Uint8Array(e);return t.getRandomValues(r)}throw Error("No secure random number generator available.")}function Ae(e,t){if(t<e)throw Error("Illegal parameter value: max <= min");const r=t-e;return ae(se(de(ye(r)+8)),r)+e}const we=BigInt(1);function me(e,t,r){const i=BigInt(30),n=we<<BigInt(e-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=Ae(n,n<<we),o=ue(ae(a,i));do{a+=BigInt(s[o]),o=(o+s[o])%s.length,le(a)>e&&(a=ae(a,n<<we),a+=n,o=ue(ae(a,i)))}while(!be(a,t,r));return a}function be(e,t,r){return(!t||function(e,t){let r=e,i=t;for(;i!==ie;){const e=i;i=r%i,r=e}return r}(e-we,t)===we)&&!!function(e){const t=BigInt(0);return ke.every(r=>ae(e,r)!==t)}(e)&&!!function(e,t=BigInt(2)){return oe(t,e-we,e)===we}(e)&&!!function(e,t){const r=le(e);t||(t=Math.max(1,r/48|0));const i=e-we;let n=0;for(;!fe(i,n);)n++;const s=e>>BigInt(n);for(;t>0;t--){let t,r=oe(Ae(BigInt(2),i),s,e);if(r!==we&&r!==i){for(t=1;t<n;t++){if(r=ae(r*r,e),r===we)return!1;if(r===i)break}if(t===n)return!1}}return!0}(e,r)}const ke=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(e=>BigInt(e)),Ee=O.getWebCrypto(),ve=O.getNodeCrypto(),Ie=ve&&ve.getHashes();function Be(e){if(ve&&Ie.includes(e))return async function(t){const r=ve.createHash(e);return I(t,e=>{r.update(e)},()=>new Uint8Array(r.digest()))}}function Se(e,t){const r=async()=>{const{nobleHashes:t}=await Promise.resolve().then(function(){return Gl}),r=t.get(e);if(!r)throw Error("Unsupported hash");return r};return async function(e){if(u(e)&&(e=await P(e)),O.isStream(e)){const t=(await r()).create();return I(e,e=>{t.update(e)},()=>t.digest())}return Ee&&t?new Uint8Array(await Ee.digest(t,e)):(await r())(e)}}const Ke=Be("md5")||Se("md5"),Ce=Be("sha1")||Se("sha1","SHA-1"),De=Be("sha224")||Se("sha224"),Ue=Be("sha256")||Se("sha256","SHA-256"),Pe=Be("sha384")||Se("sha384","SHA-384"),xe=Be("sha512")||Se("sha512","SHA-512"),Qe=Be("ripemd160")||Se("ripemd160"),Re=Be("sha3-256")||Se("sha3_256"),Te=Be("sha3-512")||Se("sha3_512");function Me(e,t){switch(e){case F.hash.md5:return Ke(t);case F.hash.sha1:return Ce(t);case F.hash.ripemd:return Qe(t);case F.hash.sha256:return Ue(t);case F.hash.sha384:return Pe(t);case F.hash.sha512:return xe(t);case F.hash.sha224:return De(t);case F.hash.sha3_256:return Re(t);case F.hash.sha3_512:return Te(t);default:throw Error("Unsupported hash function")}}function Fe(e){switch(e){case F.hash.md5:return 16;case F.hash.sha1:case F.hash.ripemd:return 20;case F.hash.sha256:return 32;case F.hash.sha384:return 48;case F.hash.sha512:return 64;case F.hash.sha224:return 28;case F.hash.sha3_256:return 32;case F.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const Ne=[];function Le(e,t){const r=e.length;if(r>t-11)throw Error("Message too long");const i=function(e){const t=new Uint8Array(e);let r=0;for(;r<e;){const i=de(e-r);for(let e=0;e<i.length;e++)0!==i[e]&&(t[r++]=i[e])}return t}(t-r-3),n=new Uint8Array(t);return n[1]=2,n.set(i,2),n.set(e,t-r),n}function Oe(e,t){let r=2,i=1;for(let o=r;o<e.length;o++)i&=0!==e[o],r+=i;const n=r-2,s=e.subarray(r+1),a=0===e[0]&2===e[1]&n>=8&!i;if(t)return O.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function He(e,t,r){let i;if(t.length!==Fe(e))throw Error("Invalid hash length");const n=new Uint8Array(Ne[e].length);for(i=0;i<Ne[e].length;i++)n[i]=Ne[e][i];const s=n.length+t.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(n,r-s),o.set(t,r-t.length),o}Ne[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Ne[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Ne[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Ne[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Ne[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Ne[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Ne[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const ze=O.getWebCrypto(),Ge=O.getNodeCrypto(),_e=BigInt(1);async function je(e,t,r,i,n,s,a,o,c){if(Fe(e)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!O.isStream(t))if(O.getWebCrypto())try{return await async function(e,t,r,i,n,s,a,o){const c=await Ye(r,i,n,s,a,o),h={name:"RSASSA-PKCS1-v1_5",hash:{name:e}},u=await ze.importKey("jwk",c,h,!1,["sign"]);return new Uint8Array(await ze.sign("RSASSA-PKCS1-v1_5",u,t))}(F.read(F.webHash,e),t,r,i,n,s,a,o)}catch(e){O.printDebugError(e)}else if(O.getNodeCrypto())return async function(e,t,r,i,n,s,a,o){const c=Ge.createSign(F.read(F.hash,e));c.write(t),c.end();const h=await Ye(r,i,n,s,a,o);return new Uint8Array(c.sign({key:h,format:"jwk",type:"pkcs1"}))}(e,t,r,i,n,s,a,o);return async function(e,t,r,i){t=se(t);const n=se(He(e,i,ye(t)));return r=se(r),ge(oe(n,r,t),"be",ye(t))}(e,r,n,c)}async function qe(e,t,r,i,n,s){if(t&&!O.isStream(t))if(O.getWebCrypto())try{return await async function(e,t,r,i,n){const s=Ze(i,n),a=await ze.importKey("jwk",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:e}},!1,["verify"]);return ze.verify("RSASSA-PKCS1-v1_5",a,r,t)}(F.read(F.webHash,e),t,r,i,n)}catch(e){O.printDebugError(e)}else if(O.getNodeCrypto())return async function(e,t,r,i,n){const s=Ze(i,n),a={key:s,format:"jwk",type:"pkcs1"},o=Ge.createVerify(F.read(F.hash,e));o.write(t),o.end();try{return o.verify(a,r)}catch(e){return!1}}(e,t,r,i,n);return async function(e,t,r,i,n){if(r=se(r),t=se(t),i=se(i),t>=r)throw Error("Signature size cannot exceed modulus size");const s=ge(oe(t,i,r),"be",ye(r)),a=He(e,n,ye(r));return O.equalsUint8Array(s,a)}(e,r,i,n,s)}async function Ve(e,t,r){return O.getNodeCrypto()?async function(e,t,r){const i=Ze(t,r),n={key:i,format:"jwk",type:"pkcs1",padding:Ge.constants.RSA_PKCS1_PADDING};return new Uint8Array(Ge.publicEncrypt(n,e))}(e,t,r):async function(e,t,r){if(t=se(t),e=se(Le(e,ye(t))),r=se(r),e>=t)throw Error("Message size cannot exceed modulus size");return ge(oe(e,r,t),"be",ye(t))}(e,t,r)}async function Je(e,t,r,i,n,s,a,o){if(O.getNodeCrypto()&&!o)try{return await async function(e,t,r,i,n,s,a){const o=await Ye(t,r,i,n,s,a),c={key:o,format:"jwk",type:"pkcs1",padding:Ge.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Ge.privateDecrypt(c,e))}catch(e){throw Error("Decryption error")}}(e,t,r,i,n,s,a)}catch(e){O.printDebugError(e)}return async function(e,t,r,i,n,s,a,o){if(e=se(e),t=se(t),r=se(r),i=se(i),n=se(n),s=se(s),a=se(a),e>=t)throw Error("Data too large.");const c=ae(i,s-_e),h=ae(i,n-_e),u=Ae(BigInt(2),t),f=oe(he(u,t),r,t);e=ae(e*f,t);const l=oe(e,h,n),y=oe(e,c,s),g=ae(a*(y-l),s);let p=g*n+l;return p=ae(p*u,t),Oe(ge(p,"be",ye(t)),o)}(e,t,r,i,n,s,a,o)}async function Ye(e,t,r,i,n,s){const a=se(i),o=se(n),c=se(r);let h=ae(c,o-_e),u=ae(c,a-_e);return u=ge(u),h=ge(h),{kty:"RSA",n:V(e),e:V(t),d:V(r),p:V(n),q:V(i),dp:V(h),dq:V(u),qi:V(s),ext:!0}}function Ze(e,t){return{kty:"RSA",n:V(e),e:V(t),ext:!0}}function We(e,t){return{n:q(e.n),e:ge(t),d:q(e.d),p:q(e.q),q:q(e.p),u:q(e.qi)}}const Xe=BigInt(1),$e="object"==typeof i&&"crypto"in i?i.crypto:void 0,et={};var tt=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},rt=function(){throw Error("no PRNG")},it=new Uint8Array(32);it[0]=9;var nt=tt(),st=tt([1]),at=tt([56129,1]),ot=tt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),ct=tt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ht=tt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ut=tt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),ft=tt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function lt(e,t,r,i){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=i>>24&255,e[t+5]=i>>16&255,e[t+6]=i>>8&255,e[t+7]=255&i}function yt(e,t,r,i){return function(e,t,r,i,n){var s,a=0;for(s=0;s<n;s++)a|=e[t+s]^r[i+s];return(1&a-1>>>8)-1}(e,t,r,i,32)}function gt(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function pt(e){var t,r,i=1;for(t=0;t<16;t++)r=e[t]+i+65535,i=Math.floor(r/65536),e[t]=r-65536*i;e[0]+=i-1+37*(i-1)}function dt(e,t,r){for(var i,n=~(r-1),s=0;s<16;s++)i=n&(e[s]^t[s]),e[s]^=i,t[s]^=i}function At(e,t){var r,i,n,s=tt(),a=tt();for(r=0;r<16;r++)a[r]=t[r];for(pt(a),pt(a),pt(a),i=0;i<2;i++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,dt(a,s,1-n)}for(r=0;r<16;r++)e[2*r]=255&a[r],e[2*r+1]=a[r]>>8}function wt(e,t){var r=new Uint8Array(32),i=new Uint8Array(32);return At(r,e),At(i,t),yt(r,0,i,0)}function mt(e){var t=new Uint8Array(32);return At(t,e),1&t[0]}function bt(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function kt(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]+r[i]}function Et(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]-r[i]}function vt(e,t,r){var i,n,s=0,a=0,o=0,c=0,h=0,u=0,f=0,l=0,y=0,g=0,p=0,d=0,A=0,w=0,m=0,b=0,k=0,E=0,v=0,I=0,B=0,S=0,K=0,C=0,D=0,U=0,P=0,x=0,Q=0,R=0,T=0,M=r[0],F=r[1],N=r[2],L=r[3],O=r[4],H=r[5],z=r[6],G=r[7],_=r[8],j=r[9],q=r[10],V=r[11],J=r[12],Y=r[13],Z=r[14],W=r[15];s+=(i=t[0])*M,a+=i*F,o+=i*N,c+=i*L,h+=i*O,u+=i*H,f+=i*z,l+=i*G,y+=i*_,g+=i*j,p+=i*q,d+=i*V,A+=i*J,w+=i*Y,m+=i*Z,b+=i*W,a+=(i=t[1])*M,o+=i*F,c+=i*N,h+=i*L,u+=i*O,f+=i*H,l+=i*z,y+=i*G,g+=i*_,p+=i*j,d+=i*q,A+=i*V,w+=i*J,m+=i*Y,b+=i*Z,k+=i*W,o+=(i=t[2])*M,c+=i*F,h+=i*N,u+=i*L,f+=i*O,l+=i*H,y+=i*z,g+=i*G,p+=i*_,d+=i*j,A+=i*q,w+=i*V,m+=i*J,b+=i*Y,k+=i*Z,E+=i*W,c+=(i=t[3])*M,h+=i*F,u+=i*N,f+=i*L,l+=i*O,y+=i*H,g+=i*z,p+=i*G,d+=i*_,A+=i*j,w+=i*q,m+=i*V,b+=i*J,k+=i*Y,E+=i*Z,v+=i*W,h+=(i=t[4])*M,u+=i*F,f+=i*N,l+=i*L,y+=i*O,g+=i*H,p+=i*z,d+=i*G,A+=i*_,w+=i*j,m+=i*q,b+=i*V,k+=i*J,E+=i*Y,v+=i*Z,I+=i*W,u+=(i=t[5])*M,f+=i*F,l+=i*N,y+=i*L,g+=i*O,p+=i*H,d+=i*z,A+=i*G,w+=i*_,m+=i*j,b+=i*q,k+=i*V,E+=i*J,v+=i*Y,I+=i*Z,B+=i*W,f+=(i=t[6])*M,l+=i*F,y+=i*N,g+=i*L,p+=i*O,d+=i*H,A+=i*z,w+=i*G,m+=i*_,b+=i*j,k+=i*q,E+=i*V,v+=i*J,I+=i*Y,B+=i*Z,S+=i*W,l+=(i=t[7])*M,y+=i*F,g+=i*N,p+=i*L,d+=i*O,A+=i*H,w+=i*z,m+=i*G,b+=i*_,k+=i*j,E+=i*q,v+=i*V,I+=i*J,B+=i*Y,S+=i*Z,K+=i*W,y+=(i=t[8])*M,g+=i*F,p+=i*N,d+=i*L,A+=i*O,w+=i*H,m+=i*z,b+=i*G,k+=i*_,E+=i*j,v+=i*q,I+=i*V,B+=i*J,S+=i*Y,K+=i*Z,C+=i*W,g+=(i=t[9])*M,p+=i*F,d+=i*N,A+=i*L,w+=i*O,m+=i*H,b+=i*z,k+=i*G,E+=i*_,v+=i*j,I+=i*q,B+=i*V,S+=i*J,K+=i*Y,C+=i*Z,D+=i*W,p+=(i=t[10])*M,d+=i*F,A+=i*N,w+=i*L,m+=i*O,b+=i*H,k+=i*z,E+=i*G,v+=i*_,I+=i*j,B+=i*q,S+=i*V,K+=i*J,C+=i*Y,D+=i*Z,U+=i*W,d+=(i=t[11])*M,A+=i*F,w+=i*N,m+=i*L,b+=i*O,k+=i*H,E+=i*z,v+=i*G,I+=i*_,B+=i*j,S+=i*q,K+=i*V,C+=i*J,D+=i*Y,U+=i*Z,P+=i*W,A+=(i=t[12])*M,w+=i*F,m+=i*N,b+=i*L,k+=i*O,E+=i*H,v+=i*z,I+=i*G,B+=i*_,S+=i*j,K+=i*q,C+=i*V,D+=i*J,U+=i*Y,P+=i*Z,x+=i*W,w+=(i=t[13])*M,m+=i*F,b+=i*N,k+=i*L,E+=i*O,v+=i*H,I+=i*z,B+=i*G,S+=i*_,K+=i*j,C+=i*q,D+=i*V,U+=i*J,P+=i*Y,x+=i*Z,Q+=i*W,m+=(i=t[14])*M,b+=i*F,k+=i*N,E+=i*L,v+=i*O,I+=i*H,B+=i*z,S+=i*G,K+=i*_,C+=i*j,D+=i*q,U+=i*V,P+=i*J,x+=i*Y,Q+=i*Z,R+=i*W,b+=(i=t[15])*M,a+=38*(E+=i*N),o+=38*(v+=i*L),c+=38*(I+=i*O),h+=38*(B+=i*H),u+=38*(S+=i*z),f+=38*(K+=i*G),l+=38*(C+=i*_),y+=38*(D+=i*j),g+=38*(U+=i*q),p+=38*(P+=i*V),d+=38*(x+=i*J),A+=38*(Q+=i*Y),w+=38*(R+=i*Z),m+=38*(T+=i*W),s=(i=(s+=38*(k+=i*F))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),o=(i=o+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),A=(i=A+n+65535)-65536*(n=Math.floor(i/65536)),w=(i=w+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),b=(i=b+n+65535)-65536*(n=Math.floor(i/65536)),s=(i=(s+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),o=(i=o+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),A=(i=A+n+65535)-65536*(n=Math.floor(i/65536)),w=(i=w+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),b=(i=b+n+65535)-65536*(n=Math.floor(i/65536)),s+=n-1+37*(n-1),e[0]=s,e[1]=a,e[2]=o,e[3]=c,e[4]=h,e[5]=u,e[6]=f,e[7]=l,e[8]=y,e[9]=g,e[10]=p,e[11]=d,e[12]=A,e[13]=w,e[14]=m,e[15]=b}function It(e,t){vt(e,t,t)}function Bt(e,t){var r,i=tt();for(r=0;r<16;r++)i[r]=t[r];for(r=253;r>=0;r--)It(i,i),2!==r&&4!==r&&vt(i,i,t);for(r=0;r<16;r++)e[r]=i[r]}function St(e,t,r){var i,n,s=new Uint8Array(32),a=new Float64Array(80),o=tt(),c=tt(),h=tt(),u=tt(),f=tt(),l=tt();for(n=0;n<31;n++)s[n]=t[n];for(s[31]=127&t[31]|64,s[0]&=248,bt(a,r),n=0;n<16;n++)c[n]=a[n],u[n]=o[n]=h[n]=0;for(o[0]=u[0]=1,n=254;n>=0;--n)dt(o,c,i=s[n>>>3]>>>(7&n)&1),dt(h,u,i),kt(f,o,h),Et(o,o,h),kt(h,c,u),Et(c,c,u),It(u,f),It(l,o),vt(o,h,o),vt(h,c,f),kt(f,o,h),Et(o,o,h),It(c,o),Et(h,u,l),vt(o,h,at),kt(o,o,u),vt(h,h,o),vt(o,u,l),vt(u,c,a),It(c,f),dt(o,c,i),dt(h,u,i);for(n=0;n<16;n++)a[n+16]=o[n],a[n+32]=h[n],a[n+48]=c[n],a[n+64]=u[n];var y=a.subarray(32),g=a.subarray(16);return Bt(y,y),vt(g,g,y),At(e,g),0}function Kt(e,t){return St(e,t,it)}var Ct=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Dt(e,t,r,i){for(var n,s,a,o,c,h,u,f,l,y,g,p,d,A,w,m,b,k,E,v,I,B,S,K,C,D,U=new Int32Array(16),P=new Int32Array(16),x=e[0],Q=e[1],R=e[2],T=e[3],M=e[4],F=e[5],N=e[6],L=e[7],O=t[0],H=t[1],z=t[2],G=t[3],_=t[4],j=t[5],q=t[6],V=t[7],J=0;i>=128;){for(E=0;E<16;E++)v=8*E+J,U[E]=r[v+0]<<24|r[v+1]<<16|r[v+2]<<8|r[v+3],P[E]=r[v+4]<<24|r[v+5]<<16|r[v+6]<<8|r[v+7];for(E=0;E<80;E++)if(n=x,s=Q,a=R,o=T,c=M,h=F,u=N,l=O,y=H,g=z,p=G,d=_,A=j,w=q,S=65535&(B=V),K=B>>>16,C=65535&(I=L),D=I>>>16,S+=65535&(B=(_>>>14|M<<18)^(_>>>18|M<<14)^(M>>>9|_<<23)),K+=B>>>16,C+=65535&(I=(M>>>14|_<<18)^(M>>>18|_<<14)^(_>>>9|M<<23)),D+=I>>>16,S+=65535&(B=_&j^~_&q),K+=B>>>16,C+=65535&(I=M&F^~M&N),D+=I>>>16,S+=65535&(B=Ct[2*E+1]),K+=B>>>16,C+=65535&(I=Ct[2*E]),D+=I>>>16,I=U[E%16],K+=(B=P[E%16])>>>16,C+=65535&I,D+=I>>>16,C+=(K+=(S+=65535&B)>>>16)>>>16,S=65535&(B=k=65535&S|K<<16),K=B>>>16,C=65535&(I=b=65535&C|(D+=C>>>16)<<16),D=I>>>16,S+=65535&(B=(O>>>28|x<<4)^(x>>>2|O<<30)^(x>>>7|O<<25)),K+=B>>>16,C+=65535&(I=(x>>>28|O<<4)^(O>>>2|x<<30)^(O>>>7|x<<25)),D+=I>>>16,K+=(B=O&H^O&z^H&z)>>>16,C+=65535&(I=x&Q^x&R^Q&R),D+=I>>>16,f=65535&(C+=(K+=(S+=65535&B)>>>16)>>>16)|(D+=C>>>16)<<16,m=65535&S|K<<16,S=65535&(B=p),K=B>>>16,C=65535&(I=o),D=I>>>16,K+=(B=k)>>>16,C+=65535&(I=b),D+=I>>>16,Q=n,R=s,T=a,M=o=65535&(C+=(K+=(S+=65535&B)>>>16)>>>16)|(D+=C>>>16)<<16,F=c,N=h,L=u,x=f,H=l,z=y,G=g,_=p=65535&S|K<<16,j=d,q=A,V=w,O=m,E%16==15)for(v=0;v<16;v++)I=U[v],S=65535&(B=P[v]),K=B>>>16,C=65535&I,D=I>>>16,I=U[(v+9)%16],S+=65535&(B=P[(v+9)%16]),K+=B>>>16,C+=65535&I,D+=I>>>16,b=U[(v+1)%16],S+=65535&(B=((k=P[(v+1)%16])>>>1|b<<31)^(k>>>8|b<<24)^(k>>>7|b<<25)),K+=B>>>16,C+=65535&(I=(b>>>1|k<<31)^(b>>>8|k<<24)^b>>>7),D+=I>>>16,b=U[(v+14)%16],K+=(B=((k=P[(v+14)%16])>>>19|b<<13)^(b>>>29|k<<3)^(k>>>6|b<<26))>>>16,C+=65535&(I=(b>>>19|k<<13)^(k>>>29|b<<3)^b>>>6),D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,U[v]=65535&C|D<<16,P[v]=65535&S|K<<16;S=65535&(B=O),K=B>>>16,C=65535&(I=x),D=I>>>16,I=e[0],K+=(B=t[0])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[0]=x=65535&C|D<<16,t[0]=O=65535&S|K<<16,S=65535&(B=H),K=B>>>16,C=65535&(I=Q),D=I>>>16,I=e[1],K+=(B=t[1])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[1]=Q=65535&C|D<<16,t[1]=H=65535&S|K<<16,S=65535&(B=z),K=B>>>16,C=65535&(I=R),D=I>>>16,I=e[2],K+=(B=t[2])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[2]=R=65535&C|D<<16,t[2]=z=65535&S|K<<16,S=65535&(B=G),K=B>>>16,C=65535&(I=T),D=I>>>16,I=e[3],K+=(B=t[3])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[3]=T=65535&C|D<<16,t[3]=G=65535&S|K<<16,S=65535&(B=_),K=B>>>16,C=65535&(I=M),D=I>>>16,I=e[4],K+=(B=t[4])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[4]=M=65535&C|D<<16,t[4]=_=65535&S|K<<16,S=65535&(B=j),K=B>>>16,C=65535&(I=F),D=I>>>16,I=e[5],K+=(B=t[5])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[5]=F=65535&C|D<<16,t[5]=j=65535&S|K<<16,S=65535&(B=q),K=B>>>16,C=65535&(I=N),D=I>>>16,I=e[6],K+=(B=t[6])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[6]=N=65535&C|D<<16,t[6]=q=65535&S|K<<16,S=65535&(B=V),K=B>>>16,C=65535&(I=L),D=I>>>16,I=e[7],K+=(B=t[7])>>>16,C+=65535&I,D+=I>>>16,D+=(C+=(K+=(S+=65535&B)>>>16)>>>16)>>>16,e[7]=L=65535&C|D<<16,t[7]=V=65535&S|K<<16,J+=128,i-=128}return i}function Ut(e,t,r){var i,n=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Dt(n,s,t,r),r%=128,i=0;i<r;i++)a[i]=t[o-r+i];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,lt(a,r-8,o/536870912|0,o<<3),Dt(n,s,a,r),i=0;i<8;i++)lt(e,8*i,n[i],s[i]);return 0}function Pt(e,t){var r=tt(),i=tt(),n=tt(),s=tt(),a=tt(),o=tt(),c=tt(),h=tt(),u=tt();Et(r,e[1],e[0]),Et(u,t[1],t[0]),vt(r,r,u),kt(i,e[0],e[1]),kt(u,t[0],t[1]),vt(i,i,u),vt(n,e[3],t[3]),vt(n,n,ct),vt(s,e[2],t[2]),kt(s,s,s),Et(a,i,r),Et(o,s,n),kt(c,s,n),kt(h,i,r),vt(e[0],a,o),vt(e[1],h,c),vt(e[2],c,o),vt(e[3],a,h)}function xt(e,t,r){var i;for(i=0;i<4;i++)dt(e[i],t[i],r)}function Qt(e,t){var r=tt(),i=tt(),n=tt();Bt(n,t[2]),vt(r,t[0],n),vt(i,t[1],n),At(e,i),e[31]^=mt(r)<<7}function Rt(e,t,r){var i,n;for(gt(e[0],nt),gt(e[1],st),gt(e[2],st),gt(e[3],nt),n=255;n>=0;--n)xt(e,t,i=r[n/8|0]>>(7&n)&1),Pt(t,e),Pt(e,e),xt(e,t,i)}function Tt(e,t){var r=[tt(),tt(),tt(),tt()];gt(r[0],ht),gt(r[1],ut),gt(r[2],st),vt(r[3],ht,ut),Rt(e,r,t)}function Mt(e,t,r){var i,n=new Uint8Array(64),s=[tt(),tt(),tt(),tt()];for(r||rt(t,32),Ut(n,t,32),n[0]&=248,n[31]&=127,n[31]|=64,Tt(s,n),Qt(e,s),i=0;i<32;i++)t[i+32]=e[i];return 0}var Ft=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Nt(e,t){var r,i,n,s;for(i=63;i>=32;--i){for(r=0,n=i-32,s=i-12;n<s;++n)t[n]+=r-16*t[i]*Ft[n-(i-32)],r=Math.floor((t[n]+128)/256),t[n]-=256*r;t[n]+=r,t[i]=0}for(r=0,n=0;n<32;n++)t[n]+=r-(t[31]>>4)*Ft[n],r=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=r*Ft[n];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function Lt(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;Nt(e,r)}function Ot(e,t){var r=tt(),i=tt(),n=tt(),s=tt(),a=tt(),o=tt(),c=tt();return gt(e[2],st),bt(e[1],t),It(n,e[1]),vt(s,n,ot),Et(n,n,e[2]),kt(s,e[2],s),It(a,s),It(o,a),vt(c,o,a),vt(r,c,n),vt(r,r,s),function(e,t){var r,i=tt();for(r=0;r<16;r++)i[r]=t[r];for(r=250;r>=0;r--)It(i,i),1!==r&&vt(i,i,t);for(r=0;r<16;r++)e[r]=i[r]}(r,r),vt(r,r,n),vt(r,r,s),vt(r,r,s),vt(e[0],r,s),It(i,e[0]),vt(i,i,s),wt(i,n)&&vt(e[0],e[0],ft),It(i,e[0]),vt(i,i,s),wt(i,n)?-1:(mt(e[0])===t[31]>>7&&Et(e[0],nt,e[0]),vt(e[3],e[0],e[1]),0)}var Ht=64;function zt(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}et.scalarMult=function(e,t){if(zt(e,t),32!==e.length)throw Error("bad n size");if(32!==t.length)throw Error("bad p size");var r=new Uint8Array(32);return St(r,e,t),r},et.box={},et.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return function(e,t){rt(t,32),Kt(e,t)}(e,t),{publicKey:e,secretKey:t}},et.box.keyPair.fromSecretKey=function(e){if(zt(e),32!==e.length)throw Error("bad secret key size");var t=new Uint8Array(32);return Kt(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},et.sign=function(e,t){if(zt(e,t),64!==t.length)throw Error("bad secret key size");var r=new Uint8Array(Ht+e.length);return function(e,t,r,i){var n,s,a=new Uint8Array(64),o=new Uint8Array(64),c=new Uint8Array(64),h=new Float64Array(64),u=[tt(),tt(),tt(),tt()];Ut(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;for(n=0;n<r;n++)e[64+n]=t[n];for(n=0;n<32;n++)e[32+n]=a[32+n];for(Ut(c,e.subarray(32),r+32),Lt(c),Tt(u,c),Qt(e,u),n=32;n<64;n++)e[n]=i[n];for(Ut(o,e,r+64),Lt(o),n=0;n<64;n++)h[n]=0;for(n=0;n<32;n++)h[n]=c[n];for(n=0;n<32;n++)for(s=0;s<32;s++)h[n+s]+=o[n]*a[s];Nt(e.subarray(32),h)}(r,e,e.length,t),r},et.sign.detached=function(e,t){for(var r=et.sign(e,t),i=new Uint8Array(Ht),n=0;n<i.length;n++)i[n]=r[n];return i},et.sign.detached.verify=function(e,t,r){if(zt(e,t,r),t.length!==Ht)throw Error("bad signature size");if(32!==r.length)throw Error("bad public key size");var i,n=new Uint8Array(Ht+e.length),s=new Uint8Array(Ht+e.length);for(i=0;i<Ht;i++)n[i]=t[i];for(i=0;i<e.length;i++)n[i+Ht]=e[i];return function(e,t,r,i){var n,s=new Uint8Array(32),a=new Uint8Array(64),o=[tt(),tt(),tt(),tt()],c=[tt(),tt(),tt(),tt()];if(r<64)return-1;if(Ot(c,i))return-1;for(n=0;n<r;n++)e[n]=t[n];for(n=0;n<32;n++)e[n+32]=i[n];if(Ut(a,e,r),Lt(a),Rt(o,c,a),Tt(c,t.subarray(32)),Pt(o,c),Qt(s,o),r-=64,yt(t,0,s,0)){for(n=0;n<r;n++)e[n]=0;return-1}for(n=0;n<r;n++)e[n]=t[n+64];return r}(s,n,n.length,r)>=0},et.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return Mt(e,t),{publicKey:e,secretKey:t}},et.sign.keyPair.fromSecretKey=function(e){if(zt(e),64!==e.length)throw Error("bad secret key size");for(var t=new Uint8Array(32),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},et.sign.keyPair.fromSeed=function(e){if(zt(e),32!==e.length)throw Error("bad seed size");for(var t=new Uint8Array(32),r=new Uint8Array(64),i=0;i<32;i++)r[i]=e[i];return Mt(t,r,!0),{publicKey:t,secretKey:r}},et.setPRNG=function(e){rt=e},function(){$e&&$e.getRandomValues&&et.setPRNG(function(e,t){var r,i=new Uint8Array(t);for(r=0;r<t;r+=65536)$e.getRandomValues(i.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=i[r];!function(e){for(var t=0;t<e.length;t++)e[t]=0}(i)})}();const Gt={"2a8648ce3d030107":F.curve.nistP256,"2b81040022":F.curve.nistP384,"2b81040023":F.curve.nistP521,"2b8104000a":F.curve.secp256k1,"2b06010401da470f01":F.curve.ed25519Legacy,"2b060104019755010501":F.curve.curve25519Legacy,"2b2403030208010107":F.curve.brainpoolP256r1,"2b240303020801010b":F.curve.brainpoolP384r1,"2b240303020801010d":F.curve.brainpoolP512r1};class _t{constructor(e){if(e instanceof _t)this.oid=e.oid;else if(O.isArray(e)||O.isUint8Array(e)){if(6===(e=new Uint8Array(e))[0]){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return O.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return O.uint8ArrayToHex(this.oid)}getName(){const e=Gt[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function jt(e){let t,r=0;const i=e[0];return i<192?([r]=e,t=1):i<255?(r=(e[0]-192<<8)+e[1]+192,t=2):255===i&&(r=O.readNumber(e.subarray(1,5)),t=5),{len:r,offset:t}}function qt(e){return e<192?new Uint8Array([e]):e>191&&e<8384?new Uint8Array([192+(e-192>>8),e-192&255]):O.concatUint8Array([new Uint8Array([255]),O.writeNumber(e,4)])}function Vt(e){if(e<0||e>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+e])}function Jt(e){return new Uint8Array([192|e])}function Yt(e,t){return O.concatUint8Array([Jt(e),qt(t)])}function Zt(e){return[F.packet.literalData,F.packet.compressedData,F.packet.symmetricallyEncryptedData,F.packet.symEncryptedIntegrityProtectedData,F.packet.aeadEncryptedData].includes(e)}async function Wt(e,t,r){let i,n;try{const s=await e.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await e.readByte();let o,c,u=-1,f=-1;f=0,64&a&&(f=1),f?u=63&a:(u=(63&a)>>2,c=3&a);const l=Zt(u);let y,g=null;if(t&&l){if("array"===t){const e=new h;i=T(e),g=e}else{const e=new TransformStream;i=T(e.writable),g=e.readable}n=r({tag:u,packet:g})}else g=[];do{if(f){const t=await e.readByte();if(y=!1,t<192)o=t;else if(t>=192&&t<224)o=(t-192<<8)+await e.readByte()+192;else if(t>223&&t<255){if(o=1<<(31&t),y=!0,!l)throw new TypeError("This packet type does not support partial lengths.")}else o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte()}else switch(c){case 0:o=await e.readByte();break;case 1:o=await e.readByte()<<8|await e.readByte();break;case 2:o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte();break;default:o=1/0}if(o>0){let t=0;for(;;){i&&await i.ready;const{done:r,value:n}=await e.read();if(r){if(o===1/0)break;throw Error("Unexpected end of packet")}const s=o===1/0?n:n.subarray(0,o-t);if(i?await i.write(s):g.push(s),t+=n.length,t>=o){e.unshift(n.subarray(o-t+n.length));break}}}}while(y);i?(await i.ready,await i.close()):(g=O.concatUint8Array(g),await r({tag:u,packet:g}))}catch(e){if(i)return await i.abort(e),!0;throw e}finally{i&&await n}}class Xt extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Xt),this.name="UnsupportedError"}}class $t extends Xt{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Xt),this.name="UnknownPacketError"}}class er extends Xt{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Xt),this.name="MalformedPacketError"}}class tr{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}}async function rr(e){switch(e){case F.publicKey.ed25519:try{const e=O.getWebCrypto(),t=await e.generateKey("Ed25519",!0,["sign","verify"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),r=await e.exportKey("jwk",t.privateKey),i=await e.exportKey("jwk",t.publicKey);return{A:new Uint8Array(q(i.x)),seed:q(r.d)}}catch(n){if("NotSupportedError"!==n.name)throw n;const r=de(ar(e)),{publicKey:i}=et.sign.keyPair.fromSeed(r);return{A:i,seed:r}}case F.publicKey.ed448:{const e=await O.getNobleCurve(F.publicKey.ed448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),seed:t}}default:throw Error("Unsupported EdDSA algorithm")}}async function ir(e,t,r,i,n,s){if(Fe(t)<Fe(or(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case F.publicKey.ed25519:try{const t=O.getWebCrypto(),r=hr(e,i,n),a=await t.importKey("jwk",r,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await t.sign("Ed25519",a,s))}}catch(e){if("NotSupportedError"!==e.name)throw e;const t=O.concatUint8Array([n,i]);return{RS:et.sign.detached(s,t)}}case F.publicKey.ed448:return{RS:(await O.getNobleCurve(F.publicKey.ed448)).sign(s,n)};default:throw Error("Unsupported EdDSA algorithm")}}async function nr(e,t,{RS:r},i,n,s){if(Fe(t)<Fe(or(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case F.publicKey.ed25519:try{const t=O.getWebCrypto(),i=cr(e,n),a=await t.importKey("jwk",i,"Ed25519",!1,["verify"]);return await t.verify("Ed25519",a,r,s)}catch(e){if("NotSupportedError"!==e.name)throw e;return et.sign.detached.verify(s,r,n)}case F.publicKey.ed448:return(await O.getNobleCurve(F.publicKey.ed448)).verify(r,s,n);default:throw Error("Unsupported EdDSA algorithm")}}async function sr(e,t,r){switch(e){case F.publicKey.ed25519:{const{publicKey:e}=et.sign.keyPair.fromSeed(r);return O.equalsUint8Array(t,e)}case F.publicKey.ed448:{const e=(await O.getNobleCurve(F.publicKey.ed448)).getPublicKey(r);return O.equalsUint8Array(t,e)}default:return!1}}function ar(e){switch(e){case F.publicKey.ed25519:return 32;case F.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function or(e){switch(e){case F.publicKey.ed25519:return F.hash.sha256;case F.publicKey.ed448:return F.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const cr=(e,t)=>{if(e===F.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:V(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},hr=(e,t,r)=>{if(e===F.publicKey.ed25519){const i=cr(e,t);return i.d=V(r),i}throw Error("Unsupported EdDSA algorithm")};var ur=Object.freeze({__proto__:null,generate:rr,getPayloadSize:ar,getPreferredHashAlgo:or,sign:ir,validateParams:sr,verify:nr});
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function fr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function lr(e,...t){if(!fr(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function yr(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function gr(e,t){lr(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function pr(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function dr(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Ar(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function wr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const mr=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function br(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!fr(e))throw Error("Uint8Array expected, got "+typeof e);e=Cr(e)}return e}function kr(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}function Er(e,t){if(kr(e,t)&&e.byteOffset<t.byteOffset)throw Error("complex overlap of input and output is not supported")}function vr(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}const Ir=(e,t)=>{function r(r,...i){if(lr(r),!mr)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){const t=i[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?lr(t):lr(t,e.nonceLength)}const n=e.tagLength;n&&void 0!==i[1]&&lr(i[1]);const s=t(r,...i),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");lr(t)}};let o=!1;return{encrypt(e,t){if(o)throw Error("cannot encrypt() twice with same key + nonce");return o=!0,lr(e),a(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(lr(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return a(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r};function Br(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!Kr(t))throw Error("invalid output, must be aligned");return t}function Sr(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),o=Number(r&s);e.setUint32(t+0,a,i),e.setUint32(t+4,o,i)}function Kr(e){return e.byteOffset%4==0}function Cr(e){return Uint8Array.from(e)}const Dr=16,Ur=new Uint8Array(16),Pr=dr(Ur),xr=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class Qr{constructor(e,t){this.blockLen=Dr,this.outputLen=Dr,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,lr(e=br(e),16);const r=wr(e);let i=r.getUint32(0,!1),n=r.getUint32(4,!1),s=r.getUint32(8,!1),a=r.getUint32(12,!1);const o=[];for(let A=0;A<128;A++)o.push({s0:xr(i),s1:xr(n),s2:xr(s),s3:xr(a)}),({s0:i,s1:n,s2:s,s3:a}={s3:(u=s)<<31|(f=a)>>>1,s2:(h=n)<<31|u>>>1,s1:(c=i)<<31|h>>>1,s0:c>>>1^225<<24&-(1&f)});var c,h,u,f;const l=(y=t||1024)>65536?8:y>1024?4:2;var y;if(![1,2,4,8].includes(l))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;const g=128/l,p=this.windowSize=2**l,d=[];for(let A=0;A<g;A++)for(let e=0;e<p;e++){let t=0,r=0,i=0,n=0;for(let s=0;s<l;s++){if(!(e>>>l-s-1&1))continue;const{s0:a,s1:c,s2:h,s3:u}=o[l*A+s];t^=a,r^=c,i^=h,n^=u}d.push({s0:t,s1:r,s2:i,s3:n})}this.t=d}_updateBlock(e,t,r,i){e^=this.s0,t^=this.s1,r^=this.s2,i^=this.s3;const{W:n,t:s,windowSize:a}=this;let o=0,c=0,h=0,u=0;const f=(1<<n)-1;let l=0;for(const y of[e,t,r,i])for(let e=0;e<4;e++){const t=y>>>8*e&255;for(let e=8/n-1;e>=0;e--){const r=t>>>n*e&f,{s0:i,s1:y,s2:g,s3:p}=s[l*a+r];o^=i,c^=y,h^=g,u^=p,l+=1}}this.s0=o,this.s1=c,this.s2=h,this.s3=u}update(e){yr(this),lr(e=br(e));const t=dr(e),r=Math.floor(e.length/Dr),i=e.length%Dr;for(let n=0;n<r;n++)this._updateBlock(t[4*n+0],t[4*n+1],t[4*n+2],t[4*n+3]);return i&&(Ur.set(e.subarray(r*Dr)),this._updateBlock(Pr[0],Pr[1],Pr[2],Pr[3]),Ar(Pr)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){yr(this),gr(e,this),this.finished=!0;const{s0:t,s1:r,s2:i,s3:n}=this,s=dr(e);return s[0]=t,s[1]=r,s[2]=i,s[3]=n,e}digest(){const e=new Uint8Array(Dr);return this.digestInto(e),this.destroy(),e}}class Rr extends Qr{constructor(e,t){lr(e=br(e));const r=function(e){e.reverse();const t=1&e[15];let r=0;for(let i=0;i<e.length;i++){const t=e[i];e[i]=t>>>1|r,r=(1&t)<<7}return e[0]^=225&-t,e}(Cr(e));super(r,t),Ar(r)}update(e){e=br(e),yr(this);const t=dr(e),r=e.length%Dr,i=Math.floor(e.length/Dr);for(let n=0;n<i;n++)this._updateBlock(xr(t[4*n+3]),xr(t[4*n+2]),xr(t[4*n+1]),xr(t[4*n+0]));return r&&(Ur.set(e.subarray(i*Dr)),this._updateBlock(xr(Pr[3]),xr(Pr[2]),xr(Pr[1]),xr(Pr[0])),Ar(Pr)),this}digestInto(e){yr(this),gr(e,this),this.finished=!0;const{s0:t,s1:r,s2:i,s3:n}=this,s=dr(e);return s[0]=t,s[1]=r,s[2]=i,s[3]=n,e.reverse()}}function Tr(e){const t=(t,r)=>e(r,t.length).update(br(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}const Mr=Tr((e,t)=>new Qr(e,t));Tr((e,t)=>new Rr(e,t));const Fr=16,Nr=new Uint8Array(Fr);function Lr(e){return e<<1^283&-(e>>7)}function Or(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=Lr(e);return r}const Hr=(()=>{const e=new Uint8Array(256);for(let r=0,i=1;r<256;r++,i^=Lr(i))e[r]=i;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let i=e[255-r];i|=i<<8,t[e[r]]=255&(i^i>>4^i>>5^i>>6^i>>7^99)}return Ar(e),t})(),zr=Hr.map((e,t)=>Hr.indexOf(t)),Gr=e=>e<<8|e>>>24,_r=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function jr(e,t){if(256!==e.length)throw Error("Wrong sbox length");const r=new Uint32Array(256).map((r,i)=>t(e[i])),i=r.map(Gr),n=i.map(Gr),s=n.map(Gr),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let h=0;h<256;h++)for(let t=0;t<256;t++){const u=256*h+t;a[u]=r[h]^i[t],o[u]=n[h]^s[t],c[u]=e[h]<<8|e[t]}return{sbox:e,sbox2:c,T0:r,T1:i,T2:n,T3:s,T01:a,T23:o}}const qr=jr(Hr,e=>Or(e,3)<<24|e<<16|e<<8|Or(e,2)),Vr=jr(zr,e=>Or(e,11)<<24|Or(e,13)<<16|Or(e,9)<<8|Or(e,14)),Jr=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=Lr(r))e[t]=r;return e})();function Yr(e){lr(e);const t=e.length;if(![16,24,32].includes(t))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+t);const{sbox2:r}=qr,i=[];Kr(e)||i.push(e=Cr(e));const n=dr(e),s=n.length,a=e=>Xr(r,e,e,e,e),o=new Uint32Array(t+28);o.set(n);for(let h=s;h<o.length;h++){let e=o[h-1];h%s==0?e=a((c=e)<<24|c>>>8)^Jr[h/s-1]:s>6&&h%s==4&&(e=a(e)),o[h]=o[h-s]^e}var c;return Ar(...i),o}function Zr(e){const t=Yr(e),r=t.slice(),i=t.length,{sbox2:n}=qr,{T0:s,T1:a,T2:o,T3:c}=Vr;for(let h=0;h<i;h+=4)for(let e=0;e<4;e++)r[h+e]=t[i-h-4+e];Ar(t);for(let h=4;h<i-4;h++){const e=r[h],t=Xr(n,e,e,e,e);r[h]=s[255&t]^a[t>>>8&255]^o[t>>>16&255]^c[t>>>24]}return r}function Wr(e,t,r,i,n,s){return e[r<<8&65280|i>>>8&255]^t[n>>>8&65280|s>>>24&255]}function Xr(e,t,r,i,n){return e[255&t|65280&r]|e[i>>>16&255|n>>>16&65280]<<16}function $r(e,t,r,i,n){const{sbox2:s,T01:a,T23:o}=qr;let c=0;t^=e[c++],r^=e[c++],i^=e[c++],n^=e[c++];const h=e.length/4-2;for(let u=0;u<h;u++){const s=e[c++]^Wr(a,o,t,r,i,n),h=e[c++]^Wr(a,o,r,i,n,t),u=e[c++]^Wr(a,o,i,n,t,r),f=e[c++]^Wr(a,o,n,t,r,i);t=s,r=h,i=u,n=f}return{s0:e[c++]^Xr(s,t,r,i,n),s1:e[c++]^Xr(s,r,i,n,t),s2:e[c++]^Xr(s,i,n,t,r),s3:e[c++]^Xr(s,n,t,r,i)}}function ei(e,t,r,i,n){const{sbox2:s,T01:a,T23:o}=Vr;let c=0;t^=e[c++],r^=e[c++],i^=e[c++],n^=e[c++];const h=e.length/4-2;for(let u=0;u<h;u++){const s=e[c++]^Wr(a,o,t,n,i,r),h=e[c++]^Wr(a,o,r,t,n,i),u=e[c++]^Wr(a,o,i,r,t,n),f=e[c++]^Wr(a,o,n,i,r,t);t=s,r=h,i=u,n=f}return{s0:e[c++]^Xr(s,t,n,i,r),s1:e[c++]^Xr(s,r,t,n,i),s2:e[c++]^Xr(s,i,r,t,n),s3:e[c++]^Xr(s,n,i,r,t)}}function ti(e,t,r,i){lr(t,Fr),lr(r);const n=r.length;Er(r,i=Br(n,i));const s=t,a=dr(s);let{s0:o,s1:c,s2:h,s3:u}=$r(e,a[0],a[1],a[2],a[3]);const f=dr(r),l=dr(i);for(let g=0;g+4<=f.length;g+=4){l[g+0]=f[g+0]^o,l[g+1]=f[g+1]^c,l[g+2]=f[g+2]^h,l[g+3]=f[g+3]^u;let t=1;for(let e=s.length-1;e>=0;e--)t=t+(255&s[e])|0,s[e]=255&t,t>>>=8;({s0:o,s1:c,s2:h,s3:u}=$r(e,a[0],a[1],a[2],a[3]))}const y=Fr*Math.floor(f.length/4);if(y<n){const e=new Uint32Array([o,c,h,u]),t=pr(e);for(let s=y,a=0;s<n;s++,a++)i[s]=r[s]^t[a];Ar(e)}return i}function ri(e,t,r,i,n){lr(r,Fr),lr(i),n=Br(i.length,n);const s=r,a=dr(s),o=wr(s),c=dr(i),h=dr(n),u=t?0:12,f=i.length;let l=o.getUint32(u,t),{s0:y,s1:g,s2:p,s3:d}=$r(e,a[0],a[1],a[2],a[3]);for(let w=0;w+4<=c.length;w+=4)h[w+0]=c[w+0]^y,h[w+1]=c[w+1]^g,h[w+2]=c[w+2]^p,h[w+3]=c[w+3]^d,l=l+1>>>0,o.setUint32(u,l,t),({s0:y,s1:g,s2:p,s3:d}=$r(e,a[0],a[1],a[2],a[3]));const A=Fr*Math.floor(c.length/4);if(A<f){const e=new Uint32Array([y,g,p,d]),t=pr(e);for(let r=A,s=0;r<f;r++,s++)n[r]=i[r]^t[s];Ar(e)}return n}const ii=Ir({blockSize:16,nonceLength:16},function(e,t){function r(r,i){if(lr(r),void 0!==i&&(lr(i),!Kr(i)))throw Error("unaligned destination");const n=Yr(e),s=Cr(t),a=[n,s];Kr(r)||a.push(r=Cr(r));const o=ti(n,s,r,i);return Ar(...a),o}return{encrypt:(e,t)=>r(e,t),decrypt:(e,t)=>r(e,t)}}),ni=Ir({blockSize:16,nonceLength:16},function(e,t,r={}){const i=!r.disablePadding;return{encrypt(r,n){const s=Yr(e),{b:a,o,out:c}=function(e,t,r){lr(e);let i=e.length;const n=i%Fr;if(!t&&0!==n)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");Kr(e)||(e=Cr(e));const s=dr(e);if(t){let e=Fr-n;e||(e=Fr),i+=e}return Er(e,r=Br(i,r)),{b:s,o:dr(r),out:r}}(r,i,n);let h=t;const u=[s];Kr(h)||u.push(h=Cr(h));const f=dr(h);let l=f[0],y=f[1],g=f[2],p=f[3],d=0;for(;d+4<=a.length;)l^=a[d+0],y^=a[d+1],g^=a[d+2],p^=a[d+3],({s0:l,s1:y,s2:g,s3:p}=$r(s,l,y,g,p)),o[d++]=l,o[d++]=y,o[d++]=g,o[d++]=p;if(i){const e=function(e){const t=new Uint8Array(16),r=dr(t);t.set(e);const i=Fr-e.length;for(let n=Fr-i;n<Fr;n++)t[n]=i;return r}(r.subarray(4*d));l^=e[0],y^=e[1],g^=e[2],p^=e[3],({s0:l,s1:y,s2:g,s3:p}=$r(s,l,y,g,p)),o[d++]=l,o[d++]=y,o[d++]=g,o[d++]=p}return Ar(...u),c},decrypt(r,n){!function(e){if(lr(e),e.length%Fr!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")}(r);const s=Zr(e);let a=t;const o=[s];Kr(a)||o.push(a=Cr(a));const c=dr(a);n=Br(r.length,n),Kr(r)||o.push(r=Cr(r)),Er(r,n);const h=dr(r),u=dr(n);let f=c[0],l=c[1],y=c[2],g=c[3];for(let e=0;e+4<=h.length;){const t=f,r=l,i=y,n=g;f=h[e+0],l=h[e+1],y=h[e+2],g=h[e+3];const{s0:a,s1:o,s2:c,s3:p}=ei(s,f,l,y,g);u[e++]=a^t,u[e++]=o^r,u[e++]=c^i,u[e++]=p^n}return Ar(...o),function(e,t){if(!t)return e;const r=e.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");const i=e[r-1];if(i<=0||i>16)throw Error("aes/pcks5: wrong padding");const n=e.subarray(0,-i);for(let s=0;s<i;s++)if(e[r-s-1]!==i)throw Error("aes/pcks5: wrong padding");return n}(n,i)}}}),si=Ir({blockSize:16,nonceLength:16},function(e,t){function r(r,i,n){lr(r);const s=r.length;if(kr(r,n=Br(s,n)))throw Error("overlapping src and dst not supported.");const a=Yr(e);let o=t;const c=[a];Kr(o)||c.push(o=Cr(o)),Kr(r)||c.push(r=Cr(r));const h=dr(r),u=dr(n),f=i?u:h,l=dr(o);let y=l[0],g=l[1],p=l[2],d=l[3];for(let e=0;e+4<=h.length;){const{s0:t,s1:r,s2:i,s3:n}=$r(a,y,g,p,d);u[e+0]=h[e+0]^t,u[e+1]=h[e+1]^r,u[e+2]=h[e+2]^i,u[e+3]=h[e+3]^n,y=f[e++],g=f[e++],p=f[e++],d=f[e++]}const A=Fr*Math.floor(h.length/4);if(A<s){({s0:y,s1:g,s2:p,s3:d}=$r(a,y,g,p,d));const e=pr(new Uint32Array([y,g,p,d]));for(let t=A,i=0;t<s;t++,i++)n[t]=r[t]^e[i];Ar(e)}return Ar(...c),n}return{encrypt:(e,t)=>r(e,!0,t),decrypt:(e,t)=>r(e,!1,t)}});function ai(e,t,r,i,n){const s=n?n.length:0,a=e.create(r,i.length+s);n&&a.update(n);const o=function(e,t,r){const i=new Uint8Array(16),n=wr(i);return Sr(n,0,BigInt(t),r),Sr(n,8,BigInt(e),r),i}(8*i.length,8*s,t);a.update(i),a.update(o);const c=a.digest();return Ar(o),c}const oi=Ir({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,r){if(t.length<8)throw Error("aes/gcm: invalid nonce length");function i(e,t,i){const n=ai(Mr,!1,e,i,r);for(let r=0;r<t.length;r++)n[r]^=t[r];return n}function n(){const r=Yr(e),i=Nr.slice(),n=Nr.slice();if(ri(r,!1,n,n,i),12===t.length)n.set(t);else{const e=Nr.slice();Sr(wr(e),8,BigInt(8*t.length),!1);const r=Mr.create(i).update(t).update(e);r.digestInto(n),r.destroy()}return{xk:r,authKey:i,counter:n,tagMask:ri(r,!1,n,Nr)}}return{encrypt(e){const{xk:t,authKey:r,counter:s,tagMask:a}=n(),o=new Uint8Array(e.length+16),c=[t,r,s,a];Kr(e)||c.push(e=Cr(e)),ri(t,!1,s,e,o.subarray(0,e.length));const h=i(r,a,o.subarray(0,o.length-16));return c.push(h),o.set(h,e.length),Ar(...c),o},decrypt(e){const{xk:t,authKey:r,counter:s,tagMask:a}=n(),o=[t,r,a,s];Kr(e)||o.push(e=Cr(e));const c=e.subarray(0,-16),h=e.subarray(-16),u=i(r,a,c);if(o.push(u),!vr(u,h))throw Error("aes/gcm: invalid ghash tag");const f=ri(t,!1,s,c);return Ar(...o),f}}});function ci(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&"Uint32Array"===e.constructor.name}function hi(e,t){if(lr(t,16),!ci(e))throw Error("_encryptBlock accepts result of expandKeyLE");const r=dr(t);let{s0:i,s1:n,s2:s,s3:a}=$r(e,r[0],r[1],r[2],r[3]);return r[0]=i,r[1]=n,r[2]=s,r[3]=a,t}function ui(e,t){if(lr(t,16),!ci(e))throw Error("_decryptBlock accepts result of expandKeyLE");const r=dr(t);let{s0:i,s1:n,s2:s,s3:a}=ei(e,r[0],r[1],r[2],r[3]);return r[0]=i,r[1]=n,r[2]=s,r[3]=a,t}const fi={encrypt(e,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const r=Yr(e);if(16===t.length)hi(r,t);else{const e=dr(t);let i=e[0],n=e[1];for(let t=0,s=1;t<6;t++)for(let a=2;a<e.length;a+=2,s++){const{s0:t,s1:o,s2:c,s3:h}=$r(r,i,n,e[a],e[a+1]);i=t,n=o^_r(s),e[a]=c,e[a+1]=h}e[0]=i,e[1]=n}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=Zr(e),i=t.length/8-1;if(1===i)ui(r,t);else{const e=dr(t);let n=e[0],s=e[1];for(let t=0,a=6*i;t<6;t++)for(let o=2*i;o>=1;o-=2,a--){s^=_r(a);const{s0:t,s1:i,s2:c,s3:h}=ei(r,n,s,e[o],e[o+1]);n=t,s=i,e[o]=c,e[o+1]=h}e[0]=n,e[1]=s}r.fill(0)}},li=new Uint8Array(8).fill(166),yi=Ir({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(8===t.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...e){let t=0;for(let i=0;i<e.length;i++){const r=e[i];lr(r),t+=r.length}const r=new Uint8Array(t);for(let i=0,n=0;i<e.length;i++){const t=e[i];r.set(t,n),n+=t.length}return r}(li,t);return fi.encrypt(e,r),r},decrypt(t){if(t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const r=Cr(t);if(fi.decrypt(e,r),!vr(r.subarray(0,8),li))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),gi={expandKeyLE:Yr,expandKeyDecLE:Zr,encrypt:$r,decrypt:ei,encryptBlock:hi,decryptBlock:ui,ctrCounter:ti,ctr32:ri};async function pi(e){switch(e){case F.symmetric.aes128:case F.symmetric.aes192:case F.symmetric.aes256:throw Error("Not a legacy cipher");case F.symmetric.cast5:case F.symmetric.blowfish:case F.symmetric.twofish:case F.symmetric.tripledes:{const{legacyCiphers:t}=await Promise.resolve().then(function(){return ny}),r=F.read(F.symmetric,e),i=t.get(r);if(!i)throw Error("Unsupported cipher algorithm");return i}default:throw Error("Unsupported cipher algorithm")}}function di(e){switch(e){case F.symmetric.aes128:case F.symmetric.aes192:case F.symmetric.aes256:case F.symmetric.twofish:return 16;case F.symmetric.blowfish:case F.symmetric.cast5:case F.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function Ai(e){switch(e){case F.symmetric.aes128:case F.symmetric.blowfish:case F.symmetric.cast5:return 16;case F.symmetric.aes192:case F.symmetric.tripledes:return 24;case F.symmetric.aes256:case F.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function wi(e){return{keySize:Ai(e),blockSize:di(e)}}const mi=O.getWebCrypto();async function bi(e,t,r){const{keySize:i}=wi(e);if(!O.isAES(e)||t.length!==i)throw Error("Unexpected algorithm or key size");try{const e=await mi.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),i=await mi.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),n=await mi.wrapKey("raw",i,e,{name:"AES-KW"});return new Uint8Array(n)}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;O.printDebugError("Browser did not support operation: "+e.message)}return yi(t).encrypt(r)}async function ki(e,t,r){const{keySize:i}=wi(e);if(!O.isAES(e)||t.length!==i)throw Error("Unexpected algorithm or key size");let n;try{n=await mi.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;return O.printDebugError("Browser did not support operation: "+e.message),yi(t).decrypt(r)}try{const e=await mi.unwrapKey("raw",r,n,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await mi.exportKey("raw",e))}catch(e){if("OperationError"===e.name)throw Error("Key Data Integrity failed");throw e}}const Ei=O.getWebCrypto();async function vi(e,t,r,i,n){const s=F.read(F.webHash,e);if(!s)throw Error("Hash algo not supported with HKDF");const a=await Ei.importKey("raw",t,"HKDF",!1,["deriveBits"]),o=await Ei.deriveBits({name:"HKDF",hash:s,salt:r,info:i},a,8*n);return new Uint8Array(o)}const Ii={x25519:O.encodeUTF8("OpenPGP X25519"),x448:O.encodeUTF8("OpenPGP X448")};async function Bi(e){switch(e){case F.publicKey.x25519:try{const e=O.getWebCrypto(),t=await e.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),r=await e.exportKey("jwk",t.privateKey),i=await e.exportKey("jwk",t.publicKey);if(r.x!==i.x){const e=Error("Unexpected mismatching public point");throw e.name="NotSupportedError",e}return{A:new Uint8Array(q(i.x)),k:q(r.d)}}catch(e){if("NotSupportedError"!==e.name)throw e;const t=de(32),{publicKey:r}=et.box.keyPair.fromSecretKey(t);return{A:r,k:t}}case F.publicKey.x448:{const e=await O.getNobleCurve(F.publicKey.x448),t=e.utils.randomPrivateKey();return{A:e.getPublicKey(t),k:t}}default:throw Error("Unsupported ECDH algorithm")}}async function Si(e,t,r){switch(e){case F.publicKey.x25519:{const{publicKey:e}=et.box.keyPair.fromSecretKey(r);return O.equalsUint8Array(t,e)}case F.publicKey.x448:{const e=(await O.getNobleCurve(F.publicKey.x448)).getPublicKey(r);return O.equalsUint8Array(t,e)}default:return!1}}async function Ki(e,t,r){const{ephemeralPublicKey:i,sharedSecret:n}=await Ui(e,r),s=O.concatUint8Array([i,r,n]);switch(e){case F.publicKey.x25519:{const e=F.symmetric.aes128,{keySize:r}=wi(e),n=await vi(F.hash.sha256,s,new Uint8Array,Ii.x25519,r);return{ephemeralPublicKey:i,wrappedKey:await bi(e,n,t)}}case F.publicKey.x448:{const e=F.symmetric.aes256,{keySize:r}=wi(F.symmetric.aes256),n=await vi(F.hash.sha512,s,new Uint8Array,Ii.x448,r);return{ephemeralPublicKey:i,wrappedKey:await bi(e,n,t)}}default:throw Error("Unsupported ECDH algorithm")}}async function Ci(e,t,r,i,n){const s=await Pi(e,t,i,n),a=O.concatUint8Array([t,i,s]);switch(e){case F.publicKey.x25519:{const e=F.symmetric.aes128,{keySize:t}=wi(e);return ki(e,await vi(F.hash.sha256,a,new Uint8Array,Ii.x25519,t),r)}case F.publicKey.x448:{const e=F.symmetric.aes256,{keySize:t}=wi(F.symmetric.aes256);return ki(e,await vi(F.hash.sha512,a,new Uint8Array,Ii.x448,t),r)}default:throw Error("Unsupported ECDH algorithm")}}function Di(e){switch(e){case F.publicKey.x25519:return 32;case F.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function Ui(e,t){switch(e){case F.publicKey.x25519:try{const r=O.getWebCrypto(),i=await r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),n=await r.exportKey("jwk",i.publicKey);if((await r.exportKey("jwk",i.privateKey)).x!==n.x){const e=Error("Unexpected mismatching public point");throw e.name="NotSupportedError",e}const s=Qi(e,t),a=await r.importKey("jwk",s,"X25519",!1,[]),o=await r.deriveBits({name:"X25519",public:a},i.privateKey,8*Di(e));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(q(n.x))}}catch(s){if("NotSupportedError"!==s.name)throw s;const i=de(Di(e)),n=et.scalarMult(i,t);xi(n);const{publicKey:a}=et.box.keyPair.fromSecretKey(i);return{ephemeralPublicKey:a,sharedSecret:n}}case F.publicKey.x448:{const e=await O.getNobleCurve(F.publicKey.x448),r=e.utils.randomPrivateKey(),i=e.getSharedSecret(r,t);return xi(i),{ephemeralPublicKey:e.getPublicKey(r),sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function Pi(e,t,r,i){switch(e){case F.publicKey.x25519:try{const n=O.getWebCrypto(),s=function(e,t,r){if(e===F.publicKey.x25519){const i=Qi(e,t);return i.d=V(r),i}throw Error("Unsupported ECDH algorithm")}(e,r,i),a=Qi(e,t),o=await n.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=await n.importKey("jwk",a,"X25519",!1,[]),h=await n.deriveBits({name:"X25519",public:c},o,8*Di(e));return new Uint8Array(h)}catch(e){if("NotSupportedError"!==e.name)throw e;const r=et.scalarMult(i,t);return xi(r),r}case F.publicKey.x448:{const e=(await O.getNobleCurve(F.publicKey.x448)).getSharedSecret(i,t);return xi(e),e}default:throw Error("Unsupported ECDH algorithm")}}function xi(e){let t=0;for(let r=0;r<e.length;r++)t|=e[r];if(0===t)throw Error("Unexpected low order point")}function Qi(e,t){if(e===F.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:V(t),ext:!0};throw Error("Unsupported ECDH algorithm")}var Ri=Object.freeze({__proto__:null,decrypt:Ci,encrypt:Ki,generate:Bi,generateEphemeralEncryptionMaterial:Ui,getPayloadSize:Di,recomputeSharedSecret:Pi,validateParams:Si});const Ti=O.getWebCrypto(),Mi=O.getNodeCrypto(),Fi={[F.curve.nistP256]:"P-256",[F.curve.nistP384]:"P-384",[F.curve.nistP521]:"P-521"},Ni=Mi?Mi.getCurves():[],Li=Mi?{[F.curve.secp256k1]:Ni.includes("secp256k1")?"secp256k1":void 0,[F.curve.nistP256]:Ni.includes("prime256v1")?"prime256v1":void 0,[F.curve.nistP384]:Ni.includes("secp384r1")?"secp384r1":void 0,[F.curve.nistP521]:Ni.includes("secp521r1")?"secp521r1":void 0,[F.curve.ed25519Legacy]:Ni.includes("ED25519")?"ED25519":void 0,[F.curve.curve25519Legacy]:Ni.includes("X25519")?"X25519":void 0,[F.curve.brainpoolP256r1]:Ni.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[F.curve.brainpoolP384r1]:Ni.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[F.curve.brainpoolP512r1]:Ni.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Oi={[F.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:F.publicKey.ecdsa,hash:F.hash.sha256,cipher:F.symmetric.aes128,node:Li[F.curve.nistP256],web:Fi[F.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[F.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:F.publicKey.ecdsa,hash:F.hash.sha384,cipher:F.symmetric.aes192,node:Li[F.curve.nistP384],web:Fi[F.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[F.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:F.publicKey.ecdsa,hash:F.hash.sha512,cipher:F.symmetric.aes256,node:Li[F.curve.nistP521],web:Fi[F.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[F.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:F.publicKey.ecdsa,hash:F.hash.sha256,cipher:F.symmetric.aes128,node:Li[F.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[F.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:F.publicKey.eddsaLegacy,hash:F.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[F.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:F.publicKey.ecdh,hash:F.hash.sha256,cipher:F.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[F.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:F.publicKey.ecdsa,hash:F.hash.sha256,cipher:F.symmetric.aes128,node:Li[F.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[F.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:F.publicKey.ecdsa,hash:F.hash.sha384,cipher:F.symmetric.aes192,node:Li[F.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[F.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:F.publicKey.ecdsa,hash:F.hash.sha512,cipher:F.symmetric.aes256,node:Li[F.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class Hi{constructor(e){try{this.name=e instanceof _t?e.getName():F.write(F.curve,e)}catch(e){throw new Xt("Unknown curve")}const t=Oi[this.name];this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node,this.web=t.web,this.payloadSize=t.payloadSize,this.sharedSize=t.sharedSize,this.wireFormatLeadingByte=t.wireFormatLeadingByte,this.web&&O.getWebCrypto()?this.type="web":this.node&&O.getNodeCrypto()?this.type="node":this.name===F.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===F.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(e,t){const r=await Ti.generateKey({name:"ECDSA",namedCurve:Fi[e]},!0,["sign","verify"]),i=await Ti.exportKey("jwk",r.privateKey);return{publicKey:Vi(await Ti.exportKey("jwk",r.publicKey),t),privateKey:q(i.d)}}(this.name,this.wireFormatLeadingByte)}catch(i){return O.printDebugError("Browser did not support generating ec key "+i.message),qi(this.name)}case"node":return async function(e){const t=Mi.createECDH(Li[e]);return await t.generateKeys(),{publicKey:new Uint8Array(t.getPublicKey()),privateKey:new Uint8Array(t.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:e,A:t}=await Bi(F.publicKey.x25519),r=e.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:O.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:r}}case"ed25519Legacy":{const{seed:e,A:t}=await rr(F.publicKey.ed25519);return{publicKey:O.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:e}}default:return qi(this.name)}}}async function zi(e){const t=new Hi(e),{oid:r,hash:i,cipher:n}=t,s=await t.genKeyPair();return{oid:r,Q:s.publicKey,secret:O.leftPad(s.privateKey,t.payloadSize),hash:i,cipher:n}}function Gi(e){return Oi[e.getName()].hash}async function _i(e,t,r,i){const n={[F.curve.nistP256]:!0,[F.curve.nistP384]:!0,[F.curve.nistP521]:!0,[F.curve.secp256k1]:!0,[F.curve.curve25519Legacy]:e===F.publicKey.ecdh,[F.curve.brainpoolP256r1]:!0,[F.curve.brainpoolP384r1]:!0,[F.curve.brainpoolP512r1]:!0},s=t.getName();if(!n[s])return!1;if(s===F.curve.curve25519Legacy){i=i.slice().reverse();const{publicKey:e}=et.box.keyPair.fromSecretKey(i);r=new Uint8Array(r);const t=new Uint8Array([64,...e]);return!!O.equalsUint8Array(t,r)}const a=(await O.getNobleCurve(F.publicKey.ecdsa,s)).getPublicKey(i,!1);return!!O.equalsUint8Array(a,r)}function ji(e,t){const{payloadSize:r,wireFormatLeadingByte:i,name:n}=e,s=n===F.curve.curve25519Legacy||n===F.curve.ed25519Legacy?r:2*r;if(t[0]!==i||t.length!==s+1)throw Error("Invalid point encoding")}async function qi(e){const t=await O.getNobleCurve(F.publicKey.ecdsa,e),r=t.utils.randomPrivateKey();return{publicKey:t.getPublicKey(r,!1),privateKey:r}}function Vi(e,t){const r=q(e.x),i=q(e.y),n=new Uint8Array(r.length+i.length+1);return n[0]=t,n.set(r,1),n.set(i,r.length+1),n}function Ji(e,t,r){const i=e,n=r.slice(1,i+1),s=r.slice(i+1,2*i+1);return{kty:"EC",crv:t,x:V(n),y:V(s),ext:!0}}function Yi(e,t,r,i){const n=Ji(e,t,r);return n.d=V(i),n}const Zi=O.getWebCrypto(),Wi=O.getNodeCrypto();async function Xi(e,t,r,i,n,s){const a=new Hi(e);if(ji(a,i),r&&!O.isStream(r)){const s={publicKey:i,privateKey:n};switch(a.type){case"web":try{return await async function(e,t,r,i){const n=e.payloadSize,s=Yi(e.payloadSize,Fi[e.name],i.publicKey,i.privateKey),a=await Zi.importKey("jwk",s,{name:"ECDSA",namedCurve:Fi[e.name],hash:{name:F.read(F.webHash,e.hash)}},!1,["sign"]),o=new Uint8Array(await Zi.sign({name:"ECDSA",namedCurve:Fi[e.name],hash:{name:F.read(F.webHash,t)}},a,r));return{r:o.slice(0,n),s:o.slice(n,n<<1)}}(a,t,r,s)}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;O.printDebugError("Browser did not support signing: "+e.message)}break;case"node":return async function(e,t,r,i){const n=O.nodeRequire("eckey-utils"),s=O.getNodeBuffer(),{privateKey:a}=n.generateDer({curveName:Li[e.name],privateKey:s.from(i)}),o=Wi.createSign(F.read(F.hash,t));o.write(r),o.end();const c=new Uint8Array(o.sign({key:a,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),h=e.payloadSize;return{r:c.subarray(0,h),s:c.subarray(h,h<<1)}}(a,t,r,n)}}const o=(await O.getNobleCurve(F.publicKey.ecdsa,a.name)).sign(s,n,{lowS:!1});return{r:ge(o.r,"be",a.payloadSize),s:ge(o.s,"be",a.payloadSize)}}async function $i(e,t,r,i,n,s){const a=new Hi(e);ji(a,n);const o=async()=>0===s[0]&&en(a,r,s.subarray(1),n);if(i&&!O.isStream(i))switch(a.type){case"web":try{const e=await async function(e,t,{r,s:i},n,s){const a=Ji(e.payloadSize,Fi[e.name],s),o=await Zi.importKey("jwk",a,{name:"ECDSA",namedCurve:Fi[e.name],hash:{name:F.read(F.webHash,e.hash)}},!1,["verify"]),c=O.concatUint8Array([r,i]).buffer;return Zi.verify({name:"ECDSA",namedCurve:Fi[e.name],hash:{name:F.read(F.webHash,t)}},o,c,n)}(a,t,r,i,n);return e||o()}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;O.printDebugError("Browser did not support verifying: "+e.message)}break;case"node":{const e=await async function(e,t,{r,s:i},n,s){const a=O.nodeRequire("eckey-utils"),o=O.getNodeBuffer(),{publicKey:c}=a.generateDer({curveName:Li[e.name],publicKey:o.from(s)}),h=Wi.createVerify(F.read(F.hash,t));h.write(n),h.end();const u=O.concatUint8Array([r,i]);try{return h.verify({key:c,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},u)}catch(e){return!1}}(a,t,r,i,n);return e||o()}}return await en(a,r,s,n)||o()}async function en(e,t,r,i){return(await O.getNobleCurve(F.publicKey.ecdsa,e.name)).verify(O.concatUint8Array([t.r,t.s]),r,i,{lowS:!1})}var tn=Object.freeze({__proto__:null,sign:Xi,validateParams:async function(e,t,r){const i=new Hi(e);if(i.keyType!==F.publicKey.ecdsa)return!1;switch(i.type){case"web":case"node":{const i=de(8),n=F.hash.sha256,s=await Me(n,i);try{const a=await Xi(e,n,i,t,r,s);return await $i(e,n,a,i,t,s)}catch(e){return!1}}default:return _i(F.publicKey.ecdsa,e,t,r)}},verify:$i});async function rn(e,t,r,i,n,s){if(ji(new Hi(e),i),Fe(t)<Fe(F.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await ir(F.publicKey.ed25519,t,0,i.subarray(1),n,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function nn(e,t,{r,s:i},n,s,a){if(ji(new Hi(e),s),Fe(t)<Fe(F.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=O.concatUint8Array([r,i]);return nr(F.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}async function sn(e,t,r){if(e.getName()!==F.curve.ed25519Legacy)return!1;const{publicKey:i}=et.sign.keyPair.fromSeed(r),n=new Uint8Array([64,...i]);return O.equalsUint8Array(t,n)}var an=Object.freeze({__proto__:null,sign:rn,validateParams:sn,verify:nn});function on(e){const t=e.length;if(t>0){const r=e[t-1];if(r>=1){const i=e.subarray(t-r),n=new Uint8Array(r).fill(r);if(O.equalsUint8Array(i,n))return e.subarray(0,t-r)}}throw Error("Invalid padding")}const cn=O.getWebCrypto(),hn=O.getNodeCrypto();function un(e,t,r,i){return O.concatUint8Array([t.write(),new Uint8Array([e]),r.write(),O.stringToUint8Array("Anonymous Sender    "),i])}async function fn(e,t,r,i,n=!1,s=!1){let a;if(n){for(a=0;a<t.length&&0===t[a];a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&0===t[a];a--);t=t.subarray(0,a+1)}return(await Me(e,O.concatUint8Array([new Uint8Array([0,0,0,1]),t,i]))).subarray(0,r)}async function ln(e,t){switch(e.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:i}=await Ui(F.publicKey.x25519,t.subarray(1));return{publicKey:O.concatUint8Array([new Uint8Array([e.wireFormatLeadingByte]),i]),sharedKey:r}}case"web":if(e.web&&O.getWebCrypto())try{return await async function(e,t){const r=Ji(e.payloadSize,e.web,t);let i=cn.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),n=cn.importKey("jwk",r,{name:"ECDH",namedCurve:e.web},!1,[]);[i,n]=await Promise.all([i,n]);let s=cn.deriveBits({name:"ECDH",namedCurve:e.web,public:n},i.privateKey,e.sharedSize),a=cn.exportKey("jwk",i.publicKey);[s,a]=await Promise.all([s,a]);const o=new Uint8Array(s),c=new Uint8Array(Vi(a,e.wireFormatLeadingByte));return{publicKey:c,sharedKey:o}}(e,t)}catch(s){return O.printDebugError(s),An(e,t)}break;case"node":return async function(e,t){const r=hn.createECDH(e.node);r.generateKeys();const i=new Uint8Array(r.computeSecret(t));return{publicKey:new Uint8Array(r.getPublicKey()),sharedKey:i}}(e,t);default:return An(e,t)}}async function yn(e,t,r,i,n){const s=function(e){const t=8-e.length%8,r=new Uint8Array(e.length+t).fill(t);return r.set(e),r}(r),a=new Hi(e);ji(a,i);const{publicKey:o,sharedKey:c}=await ln(a,i),h=un(F.publicKey.ecdh,e,t,n),{keySize:u}=wi(t.cipher),f=await fn(t.hash,c,u,h);return{publicKey:o,wrappedKey:await bi(t.cipher,f,s)}}async function gn(e,t,r,i){if(i.length!==e.payloadSize){const t=new Uint8Array(e.payloadSize);t.set(i,e.payloadSize-i.length),i=t}switch(e.type){case"curve25519Legacy":{const e=i.slice().reverse();return{secretKey:e,sharedKey:await Pi(F.publicKey.x25519,t.subarray(1),r.subarray(1),e)}}case"web":if(e.web&&O.getWebCrypto())try{return await async function(e,t,r,i){const n=Yi(e.payloadSize,e.web,r,i);let s=cn.importKey("jwk",n,{name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]);const a=Ji(e.payloadSize,e.web,t);let o=cn.importKey("jwk",a,{name:"ECDH",namedCurve:e.web},!0,[]);[s,o]=await Promise.all([s,o]);let c=cn.deriveBits({name:"ECDH",namedCurve:e.web,public:o},s,e.sharedSize),h=cn.exportKey("jwk",s);[c,h]=await Promise.all([c,h]);const u=new Uint8Array(c);return{secretKey:q(h.d),sharedKey:u}}(e,t,r,i)}catch(r){return O.printDebugError(r),dn(e,t,i)}break;case"node":return async function(e,t,r){const i=hn.createECDH(e.node);i.setPrivateKey(r);const n=new Uint8Array(i.computeSecret(t));return{secretKey:new Uint8Array(i.getPrivateKey()),sharedKey:n}}(e,t,i);default:return dn(e,t,i)}}async function pn(e,t,r,i,n,s,a){const o=new Hi(e);ji(o,n),ji(o,r);const{sharedKey:c}=await gn(o,r,n,s),h=un(F.publicKey.ecdh,e,t,a),{keySize:u}=wi(t.cipher);let f;for(let l=0;l<3;l++)try{const e=await fn(t.hash,c,u,h,1===l,2===l);return on(await ki(t.cipher,e,i))}catch(e){f=e}throw f}async function dn(e,t,r){return{secretKey:r,sharedKey:(await O.getNobleCurve(F.publicKey.ecdh,e.name)).getSharedSecret(r,t).subarray(1)}}async function An(e,t){const r=await O.getNobleCurve(F.publicKey.ecdh,e.name),{publicKey:i,privateKey:n}=await e.genKeyPair();return{publicKey:i,sharedKey:r.getSharedSecret(n,t).subarray(1)}}var wn=Object.freeze({__proto__:null,CurveWithOID:Hi,ecdh:Object.freeze({__proto__:null,decrypt:pn,encrypt:yn,validateParams:async function(e,t,r){return _i(F.publicKey.ecdh,e,t,r)}}),ecdhX:Ri,ecdsa:tn,eddsa:ur,eddsaLegacy:an,generate:zi,getPreferredHashAlgo:Gi});const mn=BigInt(0),bn=BigInt(1);class kn{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return O.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class En{constructor(e){if(e){const{hash:t,cipher:r}=e;this.hash=t,this.cipher=r}else this.hash=null,this.cipher=null}read(e){if(e.length<4||3!==e[0]||1!==e[1])throw new Xt("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class vn{static fromObject({wrappedKey:e,algorithm:t}){const r=new vn;return r.wrappedKey=e,r.algorithm=t,r}read(e){let t=0,r=e[t++];this.algorithm=r%2?e[t++]:null,r-=r%2,this.wrappedKey=O.readExactSubarray(e,t,t+r),t+=r}write(){return O.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function In(e,t,r,i,n){switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:{const{n:e,e:t}=r;return{c:await Ve(i,e,t)}}case F.publicKey.elgamal:{const{p:e,g:t,y:n}=r;return async function(e,t,r,i){t=se(t),r=se(r),i=se(i);const n=se(Le(e,ye(t))),s=Ae(Xe,t-Xe);return{c1:ge(oe(r,s,t)),c2:ge(ae(oe(i,s,t)*n,t))}}(i,e,t,n)}case F.publicKey.ecdh:{const{oid:e,Q:t,kdfParams:s}=r,{publicKey:a,wrappedKey:o}=await yn(e,s,i,t,n);return{V:a,C:new kn(o)}}case F.publicKey.x25519:case F.publicKey.x448:{if(t&&!O.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:n}=r,{ephemeralPublicKey:s,wrappedKey:a}=await Ki(e,i,n);return{ephemeralPublicKey:s,C:vn.fromObject({algorithm:t,wrappedKey:a})}}default:return[]}}async function Bn(e,t,r,i,n,s){switch(e){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:{const{c:e}=i,{n,e:a}=t,{d:o,p:c,q:h,u}=r;return Je(e,n,a,o,c,h,u,s)}case F.publicKey.elgamal:{const{c1:e,c2:n}=i;return async function(e,t,r,i,n){return e=se(e),t=se(t),r=se(r),Oe(ge(ae(he(oe(e,i=se(i),r),r)*t,r),"be",ye(r)),n)}(e,n,t.p,r.x,s)}case F.publicKey.ecdh:{const{oid:e,Q:s,kdfParams:a}=t,{d:o}=r,{V:c,C:h}=i;return pn(e,a,c,h.data,s,o,n)}case F.publicKey.x25519:case F.publicKey.x448:{const{A:n}=t,{k:s}=r,{ephemeralPublicKey:a,C:o}=i;if(null!==o.algorithm&&!O.isAES(o.algorithm))throw Error("AES session key expected");return Ci(e,a,o.wrappedKey,n,s)}default:throw Error("Unknown public key encryption algorithm.")}}function Sn(e,t,r){let i=0;switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:{const e=O.readMPI(t.subarray(i));i+=e.length+2;const r=O.readMPI(t.subarray(i));i+=r.length+2;const n=O.readMPI(t.subarray(i));i+=n.length+2;const s=O.readMPI(t.subarray(i));return i+=s.length+2,{read:i,privateParams:{d:e,p:r,q:n,u:s}}}case F.publicKey.dsa:case F.publicKey.elgamal:{const e=O.readMPI(t.subarray(i));return i+=e.length+2,{read:i,privateParams:{x:e}}}case F.publicKey.ecdsa:case F.publicKey.ecdh:{const n=xn(e,r.oid);let s=O.readMPI(t.subarray(i));return i+=s.length+2,s=O.leftPad(s,n),{read:i,privateParams:{d:s}}}case F.publicKey.eddsaLegacy:{const n=xn(e,r.oid);if(r.oid.getName()!==F.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=O.readMPI(t.subarray(i));return i+=s.length+2,s=O.leftPad(s,n),{read:i,privateParams:{seed:s}}}case F.publicKey.ed25519:case F.publicKey.ed448:{const r=xn(e),n=O.readExactSubarray(t,i,i+r);return i+=n.length,{read:i,privateParams:{seed:n}}}case F.publicKey.x25519:case F.publicKey.x448:{const r=xn(e),n=O.readExactSubarray(t,i,i+r);return i+=n.length,{read:i,privateParams:{k:n}}}default:throw new Xt("Unknown public key encryption algorithm.")}}function Kn(e,t){const r=new Set([F.publicKey.ed25519,F.publicKey.x25519,F.publicKey.ed448,F.publicKey.x448]),i=Object.keys(t).map(i=>{const n=t[i];return O.isUint8Array(n)?r.has(e)?n:O.uint8ArrayToMPI(n):n.write()});return O.concatUint8Array(i)}function Cn(e,t,r){switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:return async function(e,t){if(t=BigInt(t),O.getWebCrypto()){const r={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:ge(t),hash:{name:"SHA-1"}},i=await ze.generateKey(r,!0,["sign","verify"]);return We(await ze.exportKey("jwk",i.privateKey),t)}if(O.getNodeCrypto()){const r={modulusLength:e,publicExponent:ue(t),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},i=await new Promise((e,t)=>{Ge.generateKeyPair("rsa",r,(r,i,n)=>{r?t(r):e(n)})});return We(i,t)}let r,i,n;do{i=me(e-(e>>1),t,40),r=me(e>>1,t,40),n=r*i}while(le(n)!==e);const s=(r-_e)*(i-_e);return i<r&&([r,i]=[i,r]),{n:ge(n),e:ge(t),d:ge(he(t,s)),p:ge(r),q:ge(i),u:ge(he(r,i))}}(t,65537).then(({n:e,e:t,d:r,p:i,q:n,u:s})=>({privateParams:{d:r,p:i,q:n,u:s},publicParams:{n:e,e:t}}));case F.publicKey.ecdsa:return zi(r).then(({oid:e,Q:t,secret:r})=>({privateParams:{d:r},publicParams:{oid:new _t(e),Q:t}}));case F.publicKey.eddsaLegacy:return zi(r).then(({oid:e,Q:t,secret:r})=>({privateParams:{seed:r},publicParams:{oid:new _t(e),Q:t}}));case F.publicKey.ecdh:return zi(r).then(({oid:e,Q:t,secret:r,hash:i,cipher:n})=>({privateParams:{d:r},publicParams:{oid:new _t(e),Q:t,kdfParams:new En({hash:i,cipher:n})}}));case F.publicKey.ed25519:case F.publicKey.ed448:return rr(e).then(({A:e,seed:t})=>({privateParams:{seed:t},publicParams:{A:e}}));case F.publicKey.x25519:case F.publicKey.x448:return Bi(e).then(({A:e,k:t})=>({privateParams:{k:t},publicParams:{A:e}}));case F.publicKey.dsa:case F.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}async function Dn(e,t,r){if(!t||!r)throw Error("Missing key parameters");switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:{const{n:e,e:i}=t,{d:n,p:s,q:a,u:o}=r;return async function(e,t,r,i,n,s){if(e=se(e),(i=se(i))*(n=se(n))!==e)return!1;const a=BigInt(2);if(ae(i*(s=se(s)),n)!==BigInt(1))return!1;t=se(t),r=se(r);const o=Ae(a,a<<BigInt(Math.floor(le(e)/3))),c=o*r*t;return!(ae(c,i-_e)!==o||ae(c,n-_e)!==o)}(e,i,n,s,a,o)}case F.publicKey.dsa:{const{p:e,q:i,g:n,y:s}=t,{x:a}=r;return async function(e,t,r,i,n){if(e=se(e),t=se(t),r=se(r),i=se(i),r<=bn||r>=e)return!1;if(ae(e-bn,t)!==mn)return!1;if(oe(r,t,e)!==bn)return!1;const s=BigInt(le(t));if(s<BigInt(150)||!be(t,null,32))return!1;n=se(n);const a=BigInt(2);return i===oe(r,t*Ae(a<<s-bn,a<<s)+n,e)}(e,i,n,s,a)}case F.publicKey.elgamal:{const{p:e,g:i,y:n}=t,{x:s}=r;return async function(e,t,r,i){if(e=se(e),t=se(t),r=se(r),t<=Xe||t>=e)return!1;const n=BigInt(le(e));if(n<BigInt(1023))return!1;if(oe(t,e-Xe,e)!==Xe)return!1;let s=t,a=BigInt(1);const o=BigInt(2),c=o<<BigInt(17);for(;a<c;){if(s=ae(s*t,e),s===Xe)return!1;a++}i=se(i);const h=Ae(o<<n-Xe,o<<n);return r===oe(t,(e-Xe)*h+i,e)}(e,i,n,s)}case F.publicKey.ecdsa:case F.publicKey.ecdh:{const i=wn[F.read(F.publicKey,e)],{oid:n,Q:s}=t,{d:a}=r;return i.validateParams(n,s,a)}case F.publicKey.eddsaLegacy:{const{Q:e,oid:i}=t,{seed:n}=r;return sn(i,e,n)}case F.publicKey.ed25519:case F.publicKey.ed448:{const{A:i}=t,{seed:n}=r;return sr(e,i,n)}case F.publicKey.x25519:case F.publicKey.x448:{const{A:i}=t,{k:n}=r;return Si(e,i,n)}default:throw Error("Unknown public key algorithm.")}}function Un(e){const{keySize:t}=wi(e);return de(t)}function Pn(e){try{e.getName()}catch(e){throw new Xt("Unknown curve OID")}}function xn(e,t){switch(e){case F.publicKey.ecdsa:case F.publicKey.ecdh:case F.publicKey.eddsaLegacy:return new Hi(t).payloadSize;case F.publicKey.ed25519:case F.publicKey.ed448:return ar(e);case F.publicKey.x25519:case F.publicKey.x448:return Di(e);default:throw Error("Unknown elliptic algo")}}const Qn=O.getWebCrypto(),Rn=O.getNodeCrypto(),Tn=Rn?Rn.getCiphers():[],Mn={idea:Tn.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Tn.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Tn.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Tn.includes("bf-cfb")?"bf-cfb":void 0,aes128:Tn.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Tn.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Tn.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function Fn(e){const{blockSize:t}=wi(e),r=await de(t),i=new Uint8Array([r[r.length-2],r[r.length-1]]);return O.concat([r,i])}async function Nn(e,t,r,i,n){const s=F.read(F.symmetric,e);if(O.getNodeCrypto()&&Mn[s])return function(e,t,r,i){const n=F.read(F.symmetric,e),s=new Rn.createCipheriv(Mn[n],t,i);return I(r,e=>new Uint8Array(s.update(e)))}(e,t,r,i);if(O.isAES(e))return async function(e,t,r,i){if(Qn&&await On.isSupported(e)){const n=new On(e,t,i);return O.isStream(r)?I(r,e=>n.encryptChunk(e),()=>n.finish()):n.encrypt(r)}if(O.isStream(r)){const n=new Hn(!0,e,t,i);return I(r,e=>n.processChunk(e),()=>n.finish())}return si(t,i).encrypt(r)}(e,t,r,i);const a=new(await pi(e))(t),o=a.blockSize,c=i.slice();let h=new Uint8Array;const u=e=>{e&&(h=O.concatUint8Array([h,e]));const t=new Uint8Array(h.length);let r,i=0;for(;e?h.length>=o:h.length;){const e=a.encrypt(c);for(r=0;r<o;r++)c[r]=h[r]^e[r],t[i++]=c[r];h=h.subarray(o)}return t.subarray(0,i)};return I(r,u,u)}async function Ln(e,t,r,i){const n=F.read(F.symmetric,e);if(Rn&&Mn[n])return function(e,t,r,i){const n=F.read(F.symmetric,e),s=new Rn.createDecipheriv(Mn[n],t,i);return I(r,e=>new Uint8Array(s.update(e)))}(e,t,r,i);if(O.isAES(e))return async function(e,t,r,i){if(O.isStream(r)){const n=new Hn(!1,e,t,i);return I(r,e=>n.processChunk(e),()=>n.finish())}return si(t,i).decrypt(r)}(e,t,r,i);const s=new(await pi(e))(t),a=s.blockSize;let o=i,c=new Uint8Array;const h=e=>{e&&(c=O.concatUint8Array([c,e]));const t=new Uint8Array(c.length);let r,i=0;for(;e?c.length>=a:c.length;){const e=s.encrypt(o);for(o=c.subarray(0,a),r=0;r<a;r++)t[i++]=o[r]^e[r];c=c.subarray(a)}return t.subarray(0,i)};return I(r,h,h)}class On{constructor(e,t,r){const{blockSize:i}=wi(e);this.key=t,this.prevBlock=r,this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:t}=wi(e);return Qn.importKey("raw",new Uint8Array(t),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(e,t){const r="AES-CBC";this.keyRef=this.keyRef||await Qn.importKey("raw",this.key,r,!1,["encrypt"]);const i=await Qn.encrypt({name:r,iv:t||this.zeroBlock},this.keyRef,e);return new Uint8Array(i).subarray(0,e.length)}async encryptChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,i=O.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),n=O.concatUint8Array([this.prevBlock,i.subarray(0,i.length-this.blockSize)]),s=await this._runCBC(n);return zn(s,i),this.prevBlock=s.slice(-this.blockSize),r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,s}let i;if(this.i+=r.length,this.i===this.nextBlock.length){const t=this.nextBlock;i=await this._runCBC(this.prevBlock),zn(i,t),this.prevBlock=i.slice(),this.i=0;const n=e.subarray(r.length);this.nextBlock.set(n,this.i),this.i+=n.length}else i=new Uint8Array;return i}async finish(){let e;if(0===this.i)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const t=this.nextBlock,r=await this._runCBC(this.prevBlock);zn(r,t),e=r.subarray(0,t.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const t=(await this._runCBC(O.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return zn(t,e),this.clearSensitiveData(),t}}class Hn{constructor(e,t,r,i){this.forEncryption=e;const{blockSize:n}=wi(t);this.key=gi.expandKeyLE(r),i.byteOffset%4!=0&&(i=i.slice()),this.prevBlock=Gn(i),this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n}_runCFB(e){const t=Gn(e),r=new Uint8Array(e.length),i=Gn(r);for(let n=0;n+4<=i.length;n+=4){const{s0:e,s1:r,s2:s,s3:a}=gi.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);i[n+0]=t[n+0]^e,i[n+1]=t[n+1]^r,i[n+2]=t[n+2]^s,i[n+3]=t[n+3]^a,this.prevBlock=(this.forEncryption?i:t).slice(n,n+4)}return r}async processChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,i=O.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),n=this._runCFB(i);return r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,n}let i;if(this.i+=r.length,this.i===this.nextBlock.length){i=this._runCFB(this.nextBlock),this.i=0;const t=e.subarray(r.length);this.nextBlock.set(t,this.i),this.i+=t.length}else i=new Uint8Array;return i}async finish(){let e;return e=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function zn(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++)e[i]=e[i]^t[i]}const Gn=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),_n=O.getWebCrypto(),jn=O.getNodeCrypto(),qn=16;function Vn(e,t){const r=e.length-qn;for(let i=0;i<qn;i++)e[i+r]^=t[i];return e}const Jn=new Uint8Array(qn);async function Yn(e){const t=await Zn(e),r=O.double(await t(Jn)),i=O.double(r);return async function(e){return(await t(function(e,t,r){if(e.length&&e.length%qn==0)return Vn(e,t);const i=new Uint8Array(e.length+(qn-e.length%qn));return i.set(e),i[e.length]=128,Vn(i,r)}(e,r,i))).subarray(-16)}}async function Zn(e){if(O.getNodeCrypto())return async function(t){const r=new jn.createCipheriv("aes-"+8*e.length+"-cbc",e,Jn).update(t);return new Uint8Array(r)};if(O.getWebCrypto())try{return e=await _n.importKey("raw",e,{name:"AES-CBC",length:8*e.length},!1,["encrypt"]),async function(t){const r=await _n.encrypt({name:"AES-CBC",iv:Jn,length:128},e,t);return new Uint8Array(r).subarray(0,r.byteLength-qn)}}catch(n){if("NotSupportedError"!==n.name&&(24!==e.length||"OperationError"!==n.name))throw n;O.printDebugError("Browser did not support operation: "+n.message)}return async function(t){return ni(e,Jn,{disablePadding:!0}).encrypt(t)}}const Wn=O.getWebCrypto(),Xn=O.getNodeCrypto(),$n=O.getNodeBuffer(),es=16,ts=new Uint8Array(es),rs=new Uint8Array(es);rs[15]=1;const is=new Uint8Array(es);async function ns(e){const t=await Yn(e);return function(e,r){return t(O.concatUint8Array([e,r]))}}async function ss(e){if(O.getNodeCrypto())return async function(t,r){const i=new Xn.createCipheriv("aes-"+8*e.length+"-ctr",e,r),n=$n.concat([i.update(t),i.final()]);return new Uint8Array(n)};if(O.getWebCrypto())try{const t=await Wn.importKey("raw",e,{name:"AES-CTR",length:8*e.length},!1,["encrypt"]);return async function(e,r){const i=await Wn.encrypt({name:"AES-CTR",counter:r,length:128},t,e);return new Uint8Array(i)}}catch(n){if("NotSupportedError"!==n.name&&(24!==e.length||"OperationError"!==n.name))throw n;O.printDebugError("Browser did not support operation: "+n.message)}return async function(t,r){return ii(e,r).encrypt(t)}}async function as(e,t){if(e!==F.symmetric.aes128&&e!==F.symmetric.aes192&&e!==F.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,i]=await Promise.all([ns(t),ss(t)]);return{encrypt:async function(e,t,n){const[s,a]=await Promise.all([r(ts,t),r(rs,n)]),o=await i(e,s),c=await r(is,o);for(let r=0;r<16;r++)c[r]^=a[r]^s[r];return O.concatUint8Array([o,c])},decrypt:async function(e,t,n){if(e.length<16)throw Error("Invalid EAX ciphertext");const s=e.subarray(0,-16),a=e.subarray(-16),[o,c,h]=await Promise.all([r(ts,t),r(rs,n),r(is,s)]),u=h;for(let r=0;r<16;r++)u[r]^=c[r]^o[r];if(!O.equalsUint8Array(a,u))throw Error("Authentication tag mismatch");return await i(s,o)}}}is[15]=2,as.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[8+i]^=t[i];return r},as.blockLength=es,as.ivLength=16,as.tagLength=16;const os=16;function cs(e){let t=0;for(let r=1;!(e&r);r<<=1)t++;return t}function hs(e,t){for(let r=0;r<e.length;r++)e[r]^=t[r];return e}function us(e,t){return hs(e.slice(),t)}const fs=new Uint8Array(os),ls=new Uint8Array([1]);async function ys(e,t){const{keySize:r}=wi(e);if(!O.isAES(e)||t.length!==r)throw Error("Unexpected algorithm or key size");let i=0;const n=e=>ni(t,fs,{disablePadding:!0}).encrypt(e),s=e=>ni(t,fs,{disablePadding:!0}).decrypt(e);let a;function o(e,t,r,s){const o=t.length/os|0;!function(e,t){const r=O.nbits(Math.max(e.length,t.length)/os|0)-1;for(let n=i+1;n<=r;n++)a[n]=O.double(a[n-1]);i=r}(t,s);const c=O.concatUint8Array([fs.subarray(0,15-r.length),ls,r]),h=63&c[15];c[15]&=192;const u=n(c),f=O.concatUint8Array([u,us(u.subarray(0,8),u.subarray(1,9))]),l=O.shiftRight(f.subarray(0+(h>>3),17+(h>>3)),8-(7&h)).subarray(1),y=new Uint8Array(os),g=new Uint8Array(t.length+16);let p,d=0;for(p=0;p<o;p++)hs(l,a[cs(p+1)]),g.set(hs(e(us(l,t)),l),d),hs(y,e===n?t:g.subarray(d)),t=t.subarray(os),d+=os;if(t.length){hs(l,a.x);const r=n(l);g.set(us(t,r),d);const i=new Uint8Array(os);i.set(e===n?t:g.subarray(d,-16),0),i[t.length]=128,hs(y,i),d+=t.length}const A=hs(n(hs(hs(y,l),a.$)),function(e){if(!e.length)return fs;const t=e.length/os|0,r=new Uint8Array(os),i=new Uint8Array(os);for(let s=0;s<t;s++)hs(r,a[cs(s+1)]),hs(i,n(us(r,e))),e=e.subarray(os);if(e.length){hs(r,a.x);const t=new Uint8Array(os);t.set(e,0),t[e.length]=128,hs(t,r),hs(i,n(t))}return i}(s));return g.set(A,d),g}return function(){const e=n(fs),t=O.double(e);a=[],a[0]=O.double(t),a.x=e,a.$=t}(),{encrypt:async function(e,t,r){return o(n,e,t,r)},decrypt:async function(e,t,r){if(e.length<16)throw Error("Invalid OCB ciphertext");const i=e.subarray(-16);e=e.subarray(0,-16);const n=o(s,e,t,r);if(O.equalsUint8Array(i,n.subarray(-16)))return n.subarray(0,-16);throw Error("Authentication tag mismatch")}}}ys.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[7+i]^=t[i];return r},ys.blockLength=os,ys.ivLength=15,ys.tagLength=16;const gs=O.getWebCrypto(),ps=O.getNodeCrypto(),ds=O.getNodeBuffer(),As=16,ws="AES-GCM";async function ms(e,t){if(e!==F.symmetric.aes128&&e!==F.symmetric.aes192&&e!==F.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(O.getNodeCrypto())return{encrypt:async function(e,r,i=new Uint8Array){const n=new ps.createCipheriv("aes-"+8*t.length+"-gcm",t,r);n.setAAD(i);const s=ds.concat([n.update(e),n.final(),n.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(e,r,i=new Uint8Array){const n=new ps.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);n.setAAD(i),n.setAuthTag(e.slice(e.length-As,e.length));const s=ds.concat([n.update(e.slice(0,e.length-As)),n.final()]);return new Uint8Array(s)}};if(O.getWebCrypto())try{const e=await gs.importKey("raw",t,{name:ws},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(i,n,s=new Uint8Array){if(r&&!i.length)return oi(t,n,s).encrypt(i);const a=await gs.encrypt({name:ws,iv:n,additionalData:s,tagLength:128},e,i);return new Uint8Array(a)},decrypt:async function(i,n,s=new Uint8Array){if(r&&i.length===As)return oi(t,n,s).decrypt(i);try{const t=await gs.decrypt({name:ws,iv:n,additionalData:s,tagLength:128},e,i);return new Uint8Array(t)}catch(e){if("OperationError"===e.name)throw Error("Authentication tag mismatch")}}}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;O.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,i){return oi(t,r,i).encrypt(e)},decrypt:async function(e,r,i){return oi(t,r,i).decrypt(e)}}}function bs(e,t=!1){switch(e){case F.aead.eax:return as;case F.aead.ocb:return ys;case F.aead.gcm:return ms;case F.aead.experimentalGCM:if(!t)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return ms;default:throw Error("Unsupported AEAD mode")}}async function ks(e,t,r,i,n,s){switch(e){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:case F.publicKey.rsaSign:{const{n:e,e:a}=i;return qe(t,n,O.leftPad(r.s,e.length),e,a,s)}case F.publicKey.dsa:{const{g:e,p:t,q:n,y:a}=i,{r:o,s:c}=r;return async function(e,t,r,i,n,s,a,o){if(t=se(t),r=se(r),s=se(s),a=se(a),n=se(n),o=se(o),t<=mn||t>=a||r<=mn||r>=a)return O.printDebug("invalid DSA Signature"),!1;const c=ae(se(i.subarray(0,ye(a))),a),h=he(r,a);if(h===mn)return O.printDebug("invalid DSA Signature"),!1;n=ae(n,s),o=ae(o,s);const u=ae(c*h,a),f=ae(t*h,a);return ae(ae(oe(n,u,s)*oe(o,f,s),s),a)===t}(0,o,c,s,e,t,n,a)}case F.publicKey.ecdsa:{const{oid:e,Q:a}=i,o=new Hi(e).payloadSize;return $i(e,t,{r:O.leftPad(r.r,o),s:O.leftPad(r.s,o)},n,a,s)}case F.publicKey.eddsaLegacy:{const{oid:e,Q:n}=i,a=new Hi(e).payloadSize;return nn(e,t,{r:O.leftPad(r.r,a),s:O.leftPad(r.s,a)},0,n,s)}case F.publicKey.ed25519:case F.publicKey.ed448:{const{A:n}=i;return nr(e,t,r,0,n,s)}default:throw Error("Unknown signature algorithm.")}}async function Es(e,t,r,i,n,s){if(!r||!i)throw Error("Missing key parameters");switch(e){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:case F.publicKey.rsaSign:{const{n:e,e:a}=r,{d:o,p:c,q:h,u}=i;return{s:await je(t,n,e,a,o,c,h,u,s)}}case F.publicKey.dsa:{const{g:e,p:t,q:n}=r,{x:a}=i;return async function(e,t,r,i,n,s){const a=BigInt(0);let o,c,h,u;i=se(i),n=se(n),r=se(r),s=se(s),r=ae(r,i),s=ae(s,n);const f=ae(se(t.subarray(0,ye(n))),n);for(;;){if(o=Ae(bn,n),c=ae(oe(r,o,i),n),c===a)continue;const e=ae(s*c,n);if(u=ae(f+e,n),h=ae(he(o,n)*u,n),h!==a)break}return{r:ge(c,"be",ye(i)),s:ge(h,"be",ye(i))}}(0,s,e,t,n,a)}case F.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case F.publicKey.ecdsa:{const{oid:e,Q:a}=r,{d:o}=i;return Xi(e,t,n,a,o,s)}case F.publicKey.eddsaLegacy:{const{oid:e,Q:n}=r,{seed:a}=i;return rn(e,t,0,n,a,s)}case F.publicKey.ed25519:case F.publicKey.ed448:{const{A:n}=r,{seed:a}=i;return ir(e,t,0,n,a,s)}default:throw Error("Unknown signature algorithm.")}}ms.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[4+i]^=t[i];return r},ms.blockLength=16,ms.ivLength=12,ms.tagLength=As;class vs extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,vs),this.name="Argon2OutOfMemoryError"}}let Is,Bs;class Ss{constructor(e=N){const{passes:t,parallelism:r,memoryExponent:i}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=t,this.p=r,this.encodedM=i}generateSalt(){this.salt=de(16)}read(e){let t=0;return this.salt=e.subarray(t,t+16),t+=16,this.t=e[t++],this.p=e[t++],this.encodedM=e[t++],t}write(){const e=[new Uint8Array([F.write(F.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return O.concatUint8Array(e)}async produceKey(e,t){const r=2<<this.encodedM-1;try{Is=Is||(await Promise.resolve().then(function(){return My})).default,Bs=Bs||Is();const i=await Bs,n=i({version:19,type:2,password:O.encodeUTF8(e),salt:this.salt,tagLength:t,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(Bs=Is(),Bs.catch(()=>{})),n}catch(e){throw e.message&&(e.message.includes("Unable to grow instance memory")||e.message.includes("failed to grow memory")||e.message.includes("WebAssembly.Memory.grow")||e.message.includes("Out of memory"))?new vs("Could not allocate required memory for Argon2"):e}}}class Ks{constructor(e,t=N){this.algorithm=F.hash.sha256,this.type=F.read(F.s2k,e),this.c=t.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=de(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;switch(this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if("GNU"!==O.uint8ArrayToString(e.subarray(t,t+3)))throw new Xt("Unknown s2k type.");if(t+=3,1001!==1e3+e[t++])throw new Xt("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new Xt("Unknown s2k type.")}return t}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...O.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([F.write(F.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return O.concatUint8Array(e)}async produceKey(e,t){e=O.encodeUTF8(e);const r=[];let i=0,n=0;for(;i<t;){let t;switch(this.type){case"simple":t=O.concatUint8Array([new Uint8Array(n),e]);break;case"salted":t=O.concatUint8Array([new Uint8Array(n),this.salt,e]);break;case"iterated":{const r=O.concatUint8Array([this.salt,e]);let i=r.length;const s=Math.max(this.getCount(),i);t=new Uint8Array(n+s),t.set(r,n);for(let e=n+i;e<s;e+=i,i*=2)t.copyWithin(e,n,e);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await Me(this.algorithm,t);r.push(s),i+=s.length,n++}return O.concatUint8Array(r).subarray(0,t)}}const Cs=new Set([F.s2k.argon2,F.s2k.iterated]);function Ds(e,t=N){switch(e){case F.s2k.argon2:return new Ss(t);case F.s2k.iterated:case F.s2k.gnu:case F.s2k.salted:case F.s2k.simple:return new Ks(e,t);default:throw new Xt("Unsupported S2K type")}}function Us(e){const{s2kType:t}=e;if(!Cs.has(t))throw Error("The provided `config.s2kType` value is not allowed");return Ds(t,e)}var Ps=Uint8Array,xs=Uint16Array,Qs=Int32Array,Rs=new Ps([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ts=new Ps([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ms=new Ps([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fs=function(e,t){for(var r=new xs(31),i=0;i<31;++i)r[i]=t+=1<<e[i-1];var n=new Qs(r[30]);for(i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return{b:r,r:n}},Ns=Fs(Rs,2),Ls=Ns.b,Os=Ns.r;Ls[28]=258,Os[258]=28;for(var Hs=Fs(Ts,0),zs=Hs.b,Gs=Hs.r,_s=new xs(32768),js=0;js<32768;++js){var qs=(43690&js)>>1|(21845&js)<<1;qs=(61680&(qs=(52428&qs)>>2|(13107&qs)<<2))>>4|(3855&qs)<<4,_s[js]=((65280&qs)>>8|(255&qs)<<8)>>1}var Vs=function(e,t,r){for(var i=e.length,n=0,s=new xs(t);n<i;++n)e[n]&&++s[e[n]-1];var a,o=new xs(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;if(r){a=new xs(1<<t);var c=15-t;for(n=0;n<i;++n)if(e[n])for(var h=n<<4|e[n],u=t-e[n],f=o[e[n]-1]++<<u,l=f|(1<<u)-1;f<=l;++f)a[_s[f]>>c]=h}else for(a=new xs(i),n=0;n<i;++n)e[n]&&(a[n]=_s[o[e[n]-1]++]>>15-e[n]);return a},Js=new Ps(288);for(js=0;js<144;++js)Js[js]=8;for(js=144;js<256;++js)Js[js]=9;for(js=256;js<280;++js)Js[js]=7;for(js=280;js<288;++js)Js[js]=8;var Ys=new Ps(32);for(js=0;js<32;++js)Ys[js]=5;var Zs=Vs(Js,9,0),Ws=Vs(Js,9,1),Xs=Vs(Ys,5,0),$s=Vs(Ys,5,1),ea=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ta=function(e,t,r){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&r},ra=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},ia=function(e){return(e+7)/8|0},na=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new Ps(e.subarray(t,r))},sa=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],aa=function(e,t,r){var i=Error(t||sa[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,aa),!r)throw i;return i},oa=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>8},ca=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>8,e[i+2]|=r>>16},ha=function(e,t){for(var r=[],i=0;i<e.length;++i)e[i]&&r.push({s:i,f:e[i]});var n=r.length,s=r.slice();if(!n)return{t:da,l:0};if(1==n){var a=new Ps(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],h=0,u=1,f=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=n-1;)o=r[r[h].f<r[f].f?h++:f++],c=r[h!=u&&r[h].f<r[f].f?h++:f++],r[u++]={s:-1,f:o.f+c.f,l:o,r:c};var l=s[0].s;for(i=1;i<n;++i)s[i].s>l&&(l=s[i].s);var y=new xs(l+1),g=ua(r[u-1],y,0);if(g>t){i=0;var p=0,d=g-t,A=1<<d;for(s.sort(function(e,t){return y[t.s]-y[e.s]||e.f-t.f});i<n;++i){var w=s[i].s;if(!(y[w]>t))break;p+=A-(1<<g-y[w]),y[w]=t}for(p>>=d;p>0;){var m=s[i].s;y[m]<t?p-=1<<t-y[m]++-1:++i}for(;i>=0&&p;--i){var b=s[i].s;y[b]==t&&(--y[b],++p)}g=t}return{t:new Ps(y),l:g}},ua=function(e,t,r){return-1==e.s?Math.max(ua(e.l,t,r+1),ua(e.r,t,r+1)):t[e.s]=r},fa=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new xs(++t),i=0,n=e[0],s=1,a=function(e){r[i++]=e},o=1;o<=t;++o)if(e[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=e[o]}return{c:r.subarray(0,i),n:t}},la=function(e,t){for(var r=0,i=0;i<t.length;++i)r+=e[i]*t[i];return r},ya=function(e,t,r){var i=r.length,n=ia(t+2);e[n]=255&i,e[n+1]=i>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var s=0;s<i;++s)e[n+s+4]=r[s];return 8*(n+4+i)},ga=function(e,t,r,i,n,s,a,o,c,h,u){oa(t,u++,r),++n[256];for(var f=ha(n,15),l=f.t,y=f.l,g=ha(s,15),p=g.t,d=g.l,A=fa(l),w=A.c,m=A.n,b=fa(p),k=b.c,E=b.n,v=new xs(19),I=0;I<w.length;++I)++v[31&w[I]];for(I=0;I<k.length;++I)++v[31&k[I]];for(var B=ha(v,7),S=B.t,K=B.l,C=19;C>4&&!S[Ms[C-1]];--C);var D,U,P,x,Q=h+5<<3,R=la(n,Js)+la(s,Ys)+a,T=la(n,l)+la(s,p)+a+14+3*C+la(v,S)+2*v[16]+3*v[17]+7*v[18];if(c>=0&&Q<=R&&Q<=T)return ya(t,u,e.subarray(c,c+h));if(oa(t,u,1+(T<R)),u+=2,T<R){D=Vs(l,y,0),U=l,P=Vs(p,d,0),x=p;var M=Vs(S,K,0);for(oa(t,u,m-257),oa(t,u+5,E-1),oa(t,u+10,C-4),u+=14,I=0;I<C;++I)oa(t,u+3*I,S[Ms[I]]);u+=3*C;for(var F=[w,k],N=0;N<2;++N){var L=F[N];for(I=0;I<L.length;++I){var O=31&L[I];oa(t,u,M[O]),u+=S[O],O>15&&(oa(t,u,L[I]>>5&127),u+=L[I]>>12)}}}else D=Zs,U=Js,P=Xs,x=Ys;for(I=0;I<o;++I){var H=i[I];if(H>255){ca(t,u,D[257+(O=H>>18&31)]),u+=U[O+257],O>7&&(oa(t,u,H>>23&31),u+=Rs[O]);var z=31&H;ca(t,u,P[z]),u+=x[z],z>3&&(ca(t,u,H>>5&8191),u+=Ts[z])}else ca(t,u,D[H]),u+=U[H]}return ca(t,u,D[256]),u+U[256]},pa=new Qs([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),da=new Ps(0),Aa=function(){var e=1,t=0;return{p:function(r){for(var i=e,n=t,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)n+=i+=r[a];i=(65535&i)+15*(i>>16),n=(65535&n)+15*(n>>16)}e=i,t=n},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},wa=function(e,t,r,i,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Ps(s.length+e.length);a.set(s),a.set(e,s.length),e=a,n.w=s.length}return function(e,t,r,i,n,s){var a=s.z||e.length,o=new Ps(i+a+5*(1+Math.ceil(a/7e3))+n),c=o.subarray(i,o.length-n),h=s.l,u=7&(s.r||0);if(t){u&&(c[0]=s.r>>3);for(var f=pa[t-1],l=f>>13,y=8191&f,g=(1<<r)-1,p=s.p||new xs(32768),d=s.h||new xs(g+1),A=Math.ceil(r/3),w=2*A,m=function(t){return(e[t]^e[t+1]<<A^e[t+2]<<w)&g},b=new Qs(25e3),k=new xs(288),E=new xs(32),v=0,I=0,B=s.i||0,S=0,K=s.w||0,C=0;B+2<a;++B){var D=m(B),U=32767&B,P=d[D];if(p[U]=P,d[D]=U,K<=B){var x=a-B;if((v>7e3||S>24576)&&(x>423||!h)){u=ga(e,c,0,b,k,E,I,S,C,B-C,u),S=v=I=0,C=B;for(var Q=0;Q<286;++Q)k[Q]=0;for(Q=0;Q<30;++Q)E[Q]=0}var R=2,T=0,M=y,F=U-P&32767;if(x>2&&D==m(B-F))for(var N=Math.min(l,x)-1,L=Math.min(32767,B),O=Math.min(258,x);F<=L&&--M&&U!=P;){if(e[B+R]==e[B+R-F]){for(var H=0;H<O&&e[B+H]==e[B+H-F];++H);if(H>R){if(R=H,T=F,H>N)break;var z=Math.min(F,H-2),G=0;for(Q=0;Q<z;++Q){var _=B-F+Q&32767,j=_-p[_]&32767;j>G&&(G=j,P=_)}}}F+=(U=P)-(P=p[U])&32767}if(T){b[S++]=268435456|Os[R]<<18|Gs[T];var q=31&Os[R],V=31&Gs[T];I+=Rs[q]+Ts[V],++k[257+q],++E[V],K=B+R,++v}else b[S++]=e[B],++k[e[B]]}}for(B=Math.max(B,K);B<a;++B)b[S++]=e[B],++k[e[B]];u=ga(e,c,h,b,k,E,I,S,C,B-C,u),h||(s.r=7&u|c[u/8|0]<<3,u-=7,s.h=d,s.p=p,s.i=B,s.w=K)}else{for(B=s.w||0;B<a+h;B+=65535){var J=B+65535;J>=a&&(c[u/8|0]=h,J=a),u=ya(c,u+1,e.subarray(B,J))}s.i=a}return na(o,0,i+ia(u)+n)}(e,null==t.level?6:t.level,null==t.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,i,n)},ma=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},ba=function(){function e(e,t){if("function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new Ps(98304),this.o.dictionary){var r=this.o.dictionary.subarray(-32768);this.b.set(r,32768-r.length),this.s.i=32768-r.length}}return e.prototype.p=function(e,t){this.ondata(wa(e,this.o,0,0,this.s),t)},e.prototype.push=function(e,t){this.ondata||aa(5),this.s.l&&aa(4);var r=e.length+this.s.z;if(r>this.b.length){if(r>2*this.b.length-32768){var i=new Ps(-32768&r);i.set(this.b.subarray(0,this.s.z)),this.b=i}var n=this.b.length-this.s.z;this.b.set(e.subarray(0,n),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(n),32768),this.s.z=e.length-n+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&t,(this.s.z>this.s.w+8191||t)&&(this.p(this.b,t||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||aa(5),this.s.l&&aa(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e}(),ka=function(){function e(e,t){"function"==typeof e&&(t=e,e={}),this.ondata=t;var r=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:r?r.length:0},this.o=new Ps(32768),this.p=new Ps(0),r&&this.o.set(r)}return e.prototype.e=function(e){if(this.ondata||aa(5),this.d&&aa(4),this.p.length){if(e.length){var t=new Ps(this.p.length+e.length);t.set(this.p),t.set(e,this.p.length),this.p=t}}else this.p=e},e.prototype.c=function(e){this.s.i=+(this.d=e||!1);var t=this.s.b,r=function(e,t,r,i){var n=e.length;if(!n||t.f&&!t.l)return r||new Ps(0);var s=!r,a=s||2!=t.i,o=t.i;s&&(r=new Ps(3*n));var c=function(e){var t=r.length;if(e>t){var i=new Ps(Math.max(2*t,e));i.set(r),r=i}},h=t.f||0,u=t.p||0,f=t.b||0,l=t.l,y=t.d,g=t.m,p=t.n,d=8*n;do{if(!l){h=ta(e,u,1);var A=ta(e,u+1,3);if(u+=3,!A){var w=e[(D=ia(u)+4)-4]|e[D-3]<<8,m=D+w;if(m>n){o&&aa(0);break}a&&c(f+w),r.set(e.subarray(D,m),f),t.b=f+=w,t.p=u=8*m,t.f=h;continue}if(1==A)l=Ws,y=$s,g=9,p=5;else if(2==A){var b=ta(e,u,31)+257,k=ta(e,u+10,15)+4,E=b+ta(e,u+5,31)+1;u+=14;for(var v=new Ps(E),I=new Ps(19),B=0;B<k;++B)I[Ms[B]]=ta(e,u+3*B,7);u+=3*k;var S=ea(I),K=(1<<S)-1,C=Vs(I,S,1);for(B=0;B<E;){var D,U=C[ta(e,u,K)];if(u+=15&U,(D=U>>4)<16)v[B++]=D;else{var P=0,x=0;for(16==D?(x=3+ta(e,u,3),u+=2,P=v[B-1]):17==D?(x=3+ta(e,u,7),u+=3):18==D&&(x=11+ta(e,u,127),u+=7);x--;)v[B++]=P}}var Q=v.subarray(0,b),R=v.subarray(b);g=ea(Q),p=ea(R),l=Vs(Q,g,1),y=Vs(R,p,1)}else aa(1);if(u>d){o&&aa(0);break}}a&&c(f+131072);for(var T=(1<<g)-1,M=(1<<p)-1,F=u;;F=u){var N=(P=l[ra(e,u)&T])>>4;if((u+=15&P)>d){o&&aa(0);break}if(P||aa(2),N<256)r[f++]=N;else{if(256==N){F=u,l=null;break}var L=N-254;if(N>264){var O=Rs[B=N-257];L=ta(e,u,(1<<O)-1)+Ls[B],u+=O}var H=y[ra(e,u)&M],z=H>>4;if(H||aa(3),u+=15&H,R=zs[z],z>3&&(O=Ts[z],R+=ra(e,u)&(1<<O)-1,u+=O),u>d){o&&aa(0);break}a&&c(f+131072);var G=f+L;if(f<R){var _=0-R,j=Math.min(R,G);for(_+f<0&&aa(3);f<j;++f)r[f]=i[_+f]}for(;f<G;++f)r[f]=r[f-R]}}t.l=l,t.p=F,t.b=f,t.f=h,l&&(h=1,t.m=g,t.d=y,t.n=p)}while(!h);return f!=r.length&&s?na(r,0,f):r.subarray(0,f)}(this.p,this.s,this.o);this.ondata(na(r,t,this.s.b),this.d),this.o=na(r,this.s.b-32768),this.s.b=this.o.length,this.p=na(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Ea=function(){function e(e,t){this.c=Aa(),this.v=1,ba.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),ba.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var r=wa(e,this.o,this.v&&(this.o.dictionary?6:2),t&&4,this.s);this.v&&(function(e,t){var r=t.level,i=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=i<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=Aa();n.p(t.dictionary),ma(e,2,n.d())}}(r,this.o),this.v=0),t&&ma(r,r.length-4,this.c.d()),this.ondata(r,t)},e.prototype.flush=function(){ba.prototype.flush.call(this)},e}(),va=function(){function e(e,t){ka.call(this,e,t),this.v=e&&e.dictionary?2:1}return e.prototype.push=function(e,t){if(ka.prototype.e.call(this,e),this.v){if(this.p.length<6&&!t)return;this.p=this.p.subarray((r=this.p,i=this.v-1,(8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31)&&aa(6,"invalid zlib data"),(r[1]>>5&1)==+!i&&aa(6,"invalid zlib data: "+(32&r[1]?"need":"unexpected")+" dictionary"),2+(r[1]>>3&4))),this.v=0}var r,i;t&&(this.p.length<4&&aa(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),ka.prototype.c.call(this,t)},e}(),Ia="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ia.decode(da,{stream:!0})}catch(i){}class Ba{static get tag(){return F.packet.literalData}constructor(e=new Date){this.format=F.literal.utf8,this.date=O.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,t=F.literal.utf8){this.format=t,this.text=e,this.data=null}getText(e=!1){return(null===this.text||O.isStream(this.text))&&(this.text=O.decodeUTF8(O.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,t){this.format=t,this.data=e,this.text=null}getBytes(e=!1){return null===this.data&&(this.data=O.canonicalizeEOL(O.encodeUTF8(this.text))),e?C(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await S(e,async e=>{const t=await e.readByte(),r=await e.readByte();this.filename=O.decodeUTF8(await e.readBytes(r)),this.date=O.readDate(await e.readBytes(4));let i=e.remainder();u(i)&&(i=await P(i)),this.setBytes(i,t)})}writeHeader(){const e=O.encodeUTF8(this.filename),t=new Uint8Array([e.length]),r=new Uint8Array([this.format]),i=O.writeDate(this.date);return O.concatUint8Array([r,t,e,i])}write(){const e=this.writeHeader(),t=this.getBytes();return O.concat([e,t])}}class Sa{constructor(){this.bytes=""}read(e){return this.bytes=O.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return O.stringToUint8Array(this.bytes)}toHex(){return O.uint8ArrayToHex(O.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const t=new Sa;return t.read(O.hexToUint8Array(e)),t}static wildcard(){const e=new Sa;return e.read(new Uint8Array(8)),e}}const Ka=Symbol("verified"),Ca="salt@notations.openpgpjs.org",Da=new Set([F.signatureSubpacket.issuerKeyID,F.signatureSubpacket.issuerFingerprint,F.signatureSubpacket.embeddedSignature]);class Ua{static get tag(){return F.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Sa,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[Ka]=null}read(e,t=N){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Xt("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new Xt(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[r++],this.publicKeyAlgorithm=e[r++],this.hashAlgorithm=e[r++],r+=this.readSubPackets(e.subarray(r,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,r),r+=this.readSubPackets(e.subarray(r,e.length),!1),this.signedHashValue=e.subarray(r,r+2),r+=2,6===this.version){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t}const i=e.subarray(r,e.length),{read:n,signatureParams:s}=function(e,t){let r=0;switch(e){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:case F.publicKey.rsaSign:{const e=O.readMPI(t.subarray(r));return r+=e.length+2,{read:r,signatureParams:{s:e}}}case F.publicKey.dsa:case F.publicKey.ecdsa:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=O.readMPI(t.subarray(r));return r+=i.length+2,{read:r,signatureParams:{r:e,s:i}}}case F.publicKey.eddsaLegacy:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=O.readMPI(t.subarray(r));return r+=i.length+2,{read:r,signatureParams:{r:e,s:i}}}case F.publicKey.ed25519:case F.publicKey.ed448:{const i=2*ar(e),n=O.readExactSubarray(t,r,r+i);return r+=n.length,{read:r,signatureParams:{RS:n}}}default:throw new Xt("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,i);if(n<i.length)throw Error("Error reading MPIs");this.params=s}writeParams(){return this.params instanceof Promise?Q(async()=>Kn(this.publicKeyAlgorithm,await this.params)):Kn(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),6===this.version&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),O.concat(e)}async sign(e,t,r=new Date,i=!1,n){this.version=e.version,this.created=O.normalizeDate(r),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){const e=xa(this.hashAlgorithm);if(null===this.salt)this.salt=de(e);else if(e!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(n.nonDeterministicSignaturesViaNotation){if(0!==this.rawNotations.filter(({name:e})=>e===Ca).length)throw Error("Unexpected existing salt notation");{const e=de(xa(this.hashAlgorithm));this.rawNotations.push({name:Ca,value:e,humanReadable:!1,critical:!1})}}s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=O.concat(s);const a=this.toHash(this.signatureType,t,i),o=await this.hash(this.signatureType,t,a,i);this.signedHashValue=U(K(o),0,2);const c=async()=>Es(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,a,await P(o));O.isStream(o)?this.params=c():(this.params=await c(),this[Ka]=!0)}writeHashedSubPackets(){const e=F.signatureSubpacket,t=[];let r;if(null===this.created)throw Error("Missing signature creation time");t.push(Pa(e.signatureCreationTime,!0,O.writeDate(this.created))),null!==this.signatureExpirationTime&&t.push(Pa(e.signatureExpirationTime,!0,O.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&t.push(Pa(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(Pa(e.trustSignature,!0,r))),null!==this.regularExpression&&t.push(Pa(e.regularExpression,!0,this.regularExpression)),null!==this.revocable&&t.push(Pa(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&t.push(Pa(e.keyExpirationTime,!0,O.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(Pa(e.preferredSymmetricAlgorithms,!1,r))),null!==this.revocationKeyClass&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=O.concat([r,this.revocationKeyFingerprint]),t.push(Pa(e.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&t.push(Pa(e.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach(({name:i,value:n,humanReadable:s,critical:a})=>{r=[new Uint8Array([s?128:0,0,0,0])];const o=O.encodeUTF8(i);r.push(O.writeNumber(o.length,2)),r.push(O.writeNumber(n.length,2)),r.push(o),r.push(n),r=O.concat(r),t.push(Pa(e.notationData,a,r))}),null!==this.preferredHashAlgorithms&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(Pa(e.preferredHashAlgorithms,!1,r))),null!==this.preferredCompressionAlgorithms&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(Pa(e.preferredCompressionAlgorithms,!1,r))),null!==this.keyServerPreferences&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.keyServerPreferences)),t.push(Pa(e.keyServerPreferences,!1,r))),null!==this.preferredKeyServer&&t.push(Pa(e.preferredKeyServer,!1,O.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&t.push(Pa(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&t.push(Pa(e.policyURI,!1,O.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.keyFlags)),t.push(Pa(e.keyFlags,!0,r))),null!==this.signersUserID&&t.push(Pa(e.signersUserID,!1,O.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(r=O.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(Pa(e.reasonForRevocation,!0,r))),null!==this.features&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.features)),t.push(Pa(e.features,!1,r))),null!==this.signatureTargetPublicKeyAlgorithm&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(O.stringToUint8Array(this.signatureTargetHash)),r=O.concat(r),t.push(Pa(e.signatureTarget,!0,r))),null!==this.embeddedSignature&&t.push(Pa(e.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=O.concat(r),t.push(Pa(e.issuerFingerprint,this.version>=5,r))),null!==this.preferredAEADAlgorithms&&(r=O.stringToUint8Array(O.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(Pa(e.preferredAEADAlgorithms,!1,r))),null!==this.preferredCipherSuites&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),t.push(Pa(e.preferredCipherSuites,!1,r)));const i=O.concat(t),n=O.writeNumber(i.length,6===this.version?4:2);return O.concat([n,i])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map(({type:e,critical:t,body:r})=>Pa(e,t,r)),t=O.concat(e),r=O.writeNumber(t.length,6===this.version?4:2);return O.concat([r,t])}readSubPacket(e,t=!0){let r=0;const i=!!(128&e[r]),n=127&e[r];if(r++,t||(this.unhashedSubpackets.push({type:n,critical:i,body:e.subarray(r,e.length)}),Da.has(n)))switch(n){case F.signatureSubpacket.signatureCreationTime:this.created=O.readDate(e.subarray(r,e.length));break;case F.signatureSubpacket.signatureExpirationTime:{const t=O.readNumber(e.subarray(r,e.length));this.signatureNeverExpires=0===t,this.signatureExpirationTime=t;break}case F.signatureSubpacket.exportableCertification:this.exportable=1===e[r++];break;case F.signatureSubpacket.trustSignature:this.trustLevel=e[r++],this.trustAmount=e[r++];break;case F.signatureSubpacket.regularExpression:this.regularExpression=e[r];break;case F.signatureSubpacket.revocable:this.revocable=1===e[r++];break;case F.signatureSubpacket.keyExpirationTime:{const t=O.readNumber(e.subarray(r,e.length));this.keyExpirationTime=t,this.keyNeverExpires=0===t;break}case F.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.revocationKey:this.revocationKeyClass=e[r++],this.revocationKeyAlgorithm=e[r++],this.revocationKeyFingerprint=e.subarray(r,r+20);break;case F.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(e.subarray(r,e.length));else if(t)throw Error("Unexpected Issuer Key ID subpacket");break;case F.signatureSubpacket.notationData:{const t=!!(128&e[r]);r+=4;const n=O.readNumber(e.subarray(r,r+2));r+=2;const s=O.readNumber(e.subarray(r,r+2));r+=2;const a=O.decodeUTF8(e.subarray(r,r+n)),o=e.subarray(r+n,r+n+s);this.rawNotations.push({name:a,humanReadable:t,value:o,critical:i}),t&&(this.notations[a]=O.decodeUTF8(o));break}case F.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=O.decodeUTF8(e.subarray(r,e.length));break;case F.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==e[r++];break;case F.signatureSubpacket.policyURI:this.policyURI=O.decodeUTF8(e.subarray(r,e.length));break;case F.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.signersUserID:this.signersUserID=O.decodeUTF8(e.subarray(r,e.length));break;case F.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[r++],this.reasonForRevocationString=O.decodeUTF8(e.subarray(r,e.length));break;case F.signatureSubpacket.features:this.features=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[r++],this.signatureTargetHashAlgorithm=e[r++];const t=Fe(this.signatureTargetHashAlgorithm);this.signatureTargetHash=O.uint8ArrayToString(e.subarray(r,r+t));break}case F.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Ua,this.embeddedSignature.read(e.subarray(r,e.length));break;case F.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[r++],this.issuerFingerprint=e.subarray(r,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case F.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(r,e.length)];break;case F.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let t=r;t<e.length;t+=2)this.preferredCipherSuites.push([e[t],e[t+1]]);break;default:this.unknownSubpackets.push({type:n,critical:i,body:e.subarray(r,e.length)})}}readSubPackets(e,t=!0,r){const i=6===this.version?4:2,n=O.readNumber(e.subarray(0,i));let s=i;for(;s<2+n;){const i=jt(e.subarray(s,e.length));s+=i.offset,this.readSubPacket(e.subarray(s,s+i.len),t,r),s+=i.len}return s}toSign(e,t){const r=F.signature;switch(e){case r.binary:return null!==t.text?O.encodeUTF8(t.getText(!0)):t.getBytes(!0);case r.text:{const e=t.getBytes(!0);return O.canonicalizeEOL(e)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let e,i;if(t.userID)i=180,e=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");i=209,e=t.userAttribute}const n=e.write();return O.concat([this.toSign(r.key,t),new Uint8Array([i]),O.writeNumber(n.length,4),n])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return O.concat([this.toSign(r.key,t),this.toSign(r.key,{key:t.bind})]);case r.key:if(void 0===t.key)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,t);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let r=0;return I(K(this.signatureData),e=>{r+=e.length},()=>{const i=[];return 5!==this.version||this.signatureType!==F.signature.binary&&this.signatureType!==F.signature.text||(t?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),5===this.version&&i.push(new Uint8Array(4)),i.push(O.writeNumber(r,4)),O.concat(i)})}toHash(e,t,r=!1){const i=this.toSign(e,t);return O.concat([this.salt||new Uint8Array,i,this.signatureData,this.calculateTrailer(t,r)])}async hash(e,t,r,i=!1){if(6===this.version&&this.salt.length!==xa(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(e,t,i)),Me(this.hashAlgorithm,r)}async verify(e,t,r,i=new Date,n=!1,s=N){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const a=t===F.signature.binary||t===F.signature.text;if(!this[Ka]||a){let i,s;if(this.hashed?s=await this.hashed:(i=this.toHash(t,r,n),s=await this.hash(t,r,i)),s=await P(s),this.signedHashValue[0]!==s[0]||this.signedHashValue[1]!==s[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Ka]=await ks(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,i,s),!this[Ka])throw Error("Signature verification failed")}const o=O.normalizeDate(i);if(o&&this.created>o)throw Error("Signature creation time is in the future");if(o&&o>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+F.read(F.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[F.signature.binary,F.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+F.read(F.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:e,critical:t})=>{if(t)throw Error("Unknown critical signature subpacket type "+e)}),this.rawNotations.forEach(({name:e,critical:t})=>{if(t&&s.knownNotations.indexOf(e)<0)throw Error("Unknown critical notation: "+e)}),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const t=O.normalizeDate(e);return null!==t&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function Pa(e,t,r){const i=[];return i.push(qt(r.length+1)),i.push(new Uint8Array([(t?128:0)|e])),i.push(r),O.concat(i)}function xa(e){switch(e){case F.hash.sha256:return 16;case F.hash.sha384:return 24;case F.hash.sha512:return 32;case F.hash.sha224:case F.hash.sha3_256:return 16;case F.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class Qa{static get tag(){return F.packet.onePassSignature}static fromSignaturePacket(e,t){const r=new Qa;return r.version=6===e.version?6:3,r.signatureType=e.signatureType,r.hashAlgorithm=e.hashAlgorithm,r.publicKeyAlgorithm=e.publicKeyAlgorithm,r.issuerKeyID=e.issuerKeyID,r.salt=e.salt,r.issuerFingerprint=e.issuerFingerprint,r.flags=t?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Xt(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],6===this.version){const r=e[t++];this.salt=e.subarray(t,t+r),t+=r,this.issuerFingerprint=e.subarray(t,t+32),t+=32,this.issuerKeyID=new Sa,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Sa,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8;return this.flags=e[t++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),O.concatUint8Array(e)}calculateTrailer(...e){return Q(async()=>Ua.prototype.calculateTrailer.apply(await this.correspondingSig,e))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==F.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===e.version||6===this.version&&6!==e.version||6===this.version&&!O.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!O.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function Ra(e,t){if(!t[e]){let r;try{r=F.read(F.packet,e)}catch(t){throw new $t("Unknown packet type with tag: "+e)}throw Error("Packet not allowed in this context: "+r)}return new t[e]}Qa.prototype.hash=Ua.prototype.hash,Qa.prototype.toHash=Ua.prototype.toHash,Qa.prototype.toSign=Ua.prototype.toSign;class Ta extends Array{static async fromBinary(e,t,r=N,i=null,n=!1){const s=new Ta;return await s.read(e,t,r,i,n),s}async read(e,t,r=N,i=null,n=!1){let s;r.additionalAllowedPackets.length&&(s=O.constructAllowedPackets(r.additionalAllowedPackets),t={...t,...s}),this.stream=B(e,async(e,a)=>{const o=R(e),c=T(a);try{let a=O.isStream(e);for(;;){let h,u;if(await c.ready,await Wt(o,a,async e=>{try{if(e.tag===F.packet.marker||e.tag===F.packet.trust||e.tag===F.packet.padding)return;const n=Ra(e.tag,t);try{i?.recordPacket(e.tag,s)}catch(h){if(r.enforceGrammar)throw h;O.printDebugError(h)}n.packets=new Ta,n.fromStream=O.isStream(e.packet),u=n.fromStream;try{await n.read(e.packet,r)}catch(t){if(!(t instanceof Xt))throw O.wrapError(new er(`Parsing ${n.constructor.name} failed`),t);throw t}await c.write(n)}catch(t){const s=t instanceof $t&&e.tag<=39,a=t instanceof Xt&&!(t instanceof $t)&&!r.ignoreUnsupportedPackets,o=t instanceof er&&!r.ignoreMalformedPackets,u=Zt(e.tag);if(s||a||o||u||!(t instanceof $t||t instanceof Xt||t instanceof er))n?h=t:await c.abort(t);else{const t=new tr(e.tag,e.packet);await c.write(t)}O.printDebugError(t)}}),u&&(a=null),h)throw await o.readToEnd(),h;const f=await o.peekBytes(2);if(!f||!f.length){try{i?.recordEnd()}catch(e){if(r.enforceGrammar)throw e;O.printDebugError(e)}return await c.ready,void await c.close()}}}catch(e){await c.abort(e)}});const a=R(this.stream);for(;;){const{done:e,value:t}=await a.read();if(e?this.stream=null:this.push(t),e||Zt(t.constructor.tag))break}a.releaseLock()}write(){const e=[];for(let t=0;t<this.length;t++){const r=this[t]instanceof tr?this[t].tag:this[t].constructor.tag,i=this[t].write();if(O.isStream(i)&&Zt(this[t].constructor.tag)){let t=[],n=0;const s=512;e.push(Jt(r)),e.push(I(i,e=>{if(t.push(e),n+=e.length,n>=s){const e=Math.min(Math.log(n)/Math.LN2|0,30),r=2**e,i=O.concat([Vt(e)].concat(t));return t=[i.subarray(1+r)],n=t[0].length,i.subarray(0,1+r)}},()=>O.concat([qt(n)].concat(t))))}else{if(O.isStream(i)){let t=0;e.push(I(K(i),e=>{t+=e.length},()=>Yt(r,t)))}else e.push(Yt(r,i.length));e.push(i)}}return O.concat(e)}filterByTag(...e){const t=new Ta,r=e=>t=>e===t;for(let i=0;i<this.length;i++)e.some(r(this[i].constructor.tag))&&t.push(this[i]);return t}findPacket(e){return this.find(t=>t.constructor.tag===e)}indexOfTag(...e){const t=[],r=this,i=e=>t=>e===t;for(let n=0;n<this.length;n++)e.some(i(r[n].constructor.tag))&&t.push(n);return t}}class Ma extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Ma),this.name="GrammarError"}}var Fa;!function(e){e[e.EmptyMessage=0]="EmptyMessage",e[e.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",e[e.EncryptedSessionKeys=2]="EncryptedSessionKeys",e[e.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"}(Fa||(Fa={}));class Na{constructor(){this.state=Fa.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(e,t){switch(this.state){case Fa.EmptyMessage:case Fa.StandaloneAdditionalAllowedData:switch(e){case F.packet.literalData:case F.packet.compressedData:case F.packet.aeadEncryptedData:case F.packet.symEncryptedIntegrityProtectedData:case F.packet.symmetricallyEncryptedData:return void(this.state=Fa.PlaintextOrEncryptedData);case F.packet.signature:if(this.state===Fa.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new Ma("Trailing signature packet without OPS");return;case F.packet.onePassSignature:if(this.state===Fa.StandaloneAdditionalAllowedData)throw new Ma("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case F.packet.publicKeyEncryptedSessionKey:case F.packet.symEncryptedSessionKey:return void(this.state=Fa.EncryptedSessionKeys);default:if(!t?.[e])throw new Ma(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Fa.StandaloneAdditionalAllowedData)}case Fa.PlaintextOrEncryptedData:if(e===F.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new Ma("Trailing signature packet without OPS");return void(this.state=Fa.PlaintextOrEncryptedData)}if(!t?.[e])throw new Ma(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Fa.PlaintextOrEncryptedData);case Fa.EncryptedSessionKeys:switch(e){case F.packet.publicKeyEncryptedSessionKey:case F.packet.symEncryptedSessionKey:return void(this.state=Fa.EncryptedSessionKeys);case F.packet.symEncryptedIntegrityProtectedData:case F.packet.aeadEncryptedData:case F.packet.symmetricallyEncryptedData:return void(this.state=Fa.PlaintextOrEncryptedData);case F.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new Ma("Trailing signature packet without OPS");return void(this.state=Fa.PlaintextOrEncryptedData);default:if(!t?.[e])throw new Ma(`Unexpected packet ${e} in state ${this.state}`);this.state=Fa.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case Fa.EmptyMessage:case Fa.PlaintextOrEncryptedData:case Fa.EncryptedSessionKeys:case Fa.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new Ma("Missing trailing signature packets")}}}const La=O.constructAllowedPackets([Ba,Qa,Ua]);class Oa{static get tag(){return F.packet.compressedData}constructor(e=N){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,t=N){await S(e,async e=>{this.algorithm=await e.readByte(),this.compressed=e.remainder(),await this.decompress(t)})}write(){return null===this.compressed&&this.compress(),O.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=N){const t=F.read(F.compression,this.algorithm),r=ja[t];if(!r)throw Error(t+" decompression not supported");this.packets=await Ta.fromBinary(await r(this.compressed),La,e,new Na)}compress(){const e=F.read(F.compression,this.algorithm),t=_a[e];if(!t)throw Error(e+" compression not supported");this.compressed=t(this.packets.write())}}function Ha(e,t){return r=>{if(!O.isStream(r)||u(r))return Q(()=>P(r).then(e=>new Promise((r,i)=>{const n=new t;n.ondata=e=>{r(e)};try{n.push(e,!0)}catch(e){i(e)}})));if(e)try{const t=e();return r.pipeThrough(t)}catch(e){if("TypeError"!==e.name)throw e}const i=r.getReader(),n=new t;return new ReadableStream({async start(e){for(n.ondata=async(t,r)=>{e.enqueue(t),r&&e.close()};;){const{done:e,value:t}=await i.read();if(e)return void n.push(new Uint8Array,!0);t.length&&n.push(t)}}})}}function za(){return async function(e){const{decode:t}=await Promise.resolve().then(function(){return Ly});return Q(async()=>t(await P(e)))}}const Ga=e=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(e)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(e))}),_a={zip:Ha(Ga("deflate-raw").compressor,ba),zlib:Ha(Ga("deflate").compressor,Ea)},ja={uncompressed:e=>e,zip:Ha(Ga("deflate-raw").decompressor,ka),zlib:Ha(Ga("deflate").decompressor,va),bzip2:za()},qa=O.constructAllowedPackets([Ba,Oa,Qa,Ua]);class Va{static get tag(){return F.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:t}){if(1!==e&&2!==e)throw Error("Unsupported SEIPD version");const r=new Va;return r.version=e,2===e&&(r.aeadAlgorithm=t),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await S(e,async e=>{if(this.version=await e.readByte(),1!==this.version&&2!==this.version)throw new Xt(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()})}write(){return 2===this.version?O.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):O.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,t,r=N){const{blockSize:i,keySize:n}=wi(e);if(t.length!==n)throw Error("Unexpected session key size");let s=this.packets.write();if(u(s)&&(s=await P(s)),2===this.version)this.cipherAlgorithm=e,this.salt=de(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await Ja(this,"encrypt",t,s);else{const r=await Fn(e),n=new Uint8Array([211,20]),a=O.concat([r,s,n]),o=await Me(F.hash.sha1,C(a)),c=O.concat([a,o]);this.encrypted=await Nn(e,t,c,new Uint8Array(i))}return!0}async decrypt(e,t,r=N){if(t.length!==wi(e).keySize)throw Error("Unexpected session key size");let i,n=K(this.encrypted);u(n)&&(n=await P(n));let s=!1;if(2===this.version){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");i=await Ja(this,"decrypt",t,n)}else{const{blockSize:a}=wi(e),o=await Ln(e,t,n,new Uint8Array(a)),c=U(C(o),-20),h=U(o,0,-20),u=Promise.all([P(await Me(F.hash.sha1,C(h))),P(c)]).then(([e,t])=>{if(!O.equalsUint8Array(e,t))throw Error("Modification detected.");return new Uint8Array}),f=U(h,a+2);i=U(f,0,-2),i=b([i,Q(()=>u)]),O.isStream(n)&&r.allowUnauthenticatedStream?s=!0:i=await P(i)}return this.packets=await Ta.fromBinary(i,qa,r,new Na,s),!0}}async function Ja(e,t,r,i){const n=e instanceof Va&&2===e.version,s=!n&&e.constructor.tag===F.packet.aeadEncryptedData;if(!n&&!s)throw Error("Unexpected packet type");const a=bs(e.aeadAlgorithm,s),o="decrypt"===t?a.tagLength:0,c="encrypt"===t?a.tagLength:0,h=2**(e.chunkSizeByte+6)+o,u=s?8:0,f=new ArrayBuffer(13+u),l=new Uint8Array(f,0,5+u),y=new Uint8Array(f),g=new DataView(f),p=new Uint8Array(f,5,8);l.set([192|e.constructor.tag,e.version,e.cipherAlgorithm,e.aeadAlgorithm,e.chunkSizeByte],0);let d,A,w=0,m=Promise.resolve(),b=0,E=0;if(n){const{keySize:t}=wi(e.cipherAlgorithm),{ivLength:i}=a,n=new Uint8Array(f,0,5),s=await vi(F.hash.sha256,r,e.salt,n,t+i);r=s.subarray(0,t),d=s.subarray(t),d.fill(0,d.length-8),A=new DataView(d.buffer,d.byteOffset,d.byteLength)}else d=e.iv;const v=await a(e.cipherAlgorithm,r);return B(i,async(r,i)=>{if("array"!==O.isStream(r)){const t=new TransformStream({},{highWaterMark:O.getHardwareConcurrency()*2**(e.chunkSizeByte+6),size:e=>e.length});k(t.readable,i),i=t.writable}const s=R(r),a=T(i);try{for(;;){let e=await s.readBytes(h+o)||new Uint8Array;const r=e.subarray(e.length-o);let i,f,k;if(e=e.subarray(0,e.length-o),n)k=d;else{k=d.slice();for(let e=0;e<8;e++)k[d.length-8+e]^=p[e]}if(!w||e.length?(s.unshift(r),i=v[t](e,k,l),i.catch(()=>{}),E+=e.length-o+c):(g.setInt32(5+u+4,b),i=v[t](r,k,y),i.catch(()=>{}),E+=c,f=!0),b+=e.length-o,m=m.then(()=>i).then(async e=>{await a.ready,await a.write(e),E-=e.length}).catch(e=>a.abort(e)),(f||E>a.desiredSize)&&await m,f){await a.close();break}n?A.setInt32(d.length-4,++w):g.setInt32(9,++w)}}catch(e){await a.ready.catch(()=>{}),await a.abort(e)}})}const Ya=O.constructAllowedPackets([Ba,Oa,Qa,Ua]);class Za{static get tag(){return F.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=F.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(e){await S(e,async e=>{const t=await e.readByte();if(1!==t)throw new Xt(`Version ${t} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const r=bs(this.aeadAlgorithm,!0);this.iv=await e.readBytes(r.ivLength),this.encrypted=e.remainder()})}write(){return O.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(e,t,r=N){this.packets=await Ta.fromBinary(await Ja(this,"decrypt",t,K(this.encrypted)),Ya,r,new Na)}async encrypt(e,t,r=N){this.cipherAlgorithm=e;const{ivLength:i}=bs(this.aeadAlgorithm,!0);this.iv=de(i),this.chunkSizeByte=r.aeadChunkSizeByte;const n=this.packets.write();this.encrypted=await Ja(this,"encrypt",t,n)}}class Wa{static get tag(){return F.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Sa,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:t,anonymousRecipient:r,sessionKey:i,sessionKeyAlgorithm:n}){const s=new Wa;if(3!==e&&6!==e)throw Error("Unsupported PKESK version");return s.version=e,6===e&&(s.publicKeyVersion=r?null:t.version,s.publicKeyFingerprint=r?null:t.getFingerprintBytes()),s.publicKeyID=r?Sa.wildcard():t.getKeyID(),s.publicKeyAlgorithm=t.algorithm,s.sessionKey=i,s.sessionKeyAlgorithm=n,s}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new Xt(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){const r=e[t++];if(r){this.publicKeyVersion=e[t++];const i=r-1;this.publicKeyFingerprint=e.subarray(t,t+i),t+=i,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Sa.wildcard()}else t+=this.publicKeyID.read(e.subarray(t,t+8));if(this.publicKeyAlgorithm=e[t++],this.encrypted=function(e,t){let r=0;switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:return{c:O.readMPI(t.subarray(r))};case F.publicKey.elgamal:{const e=O.readMPI(t.subarray(r));return r+=e.length+2,{c1:e,c2:O.readMPI(t.subarray(r))}}case F.publicKey.ecdh:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=new kn;return i.read(t.subarray(r)),{V:e,C:i}}case F.publicKey.x25519:case F.publicKey.x448:{const i=xn(e),n=O.readExactSubarray(t,r,r+i);r+=n.length;const s=new vn;return s.read(t.subarray(r)),{ephemeralPublicKey:n,C:s}}default:throw new Xt("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,e.subarray(t)),this.publicKeyAlgorithm===F.publicKey.x25519||this.publicKeyAlgorithm===F.publicKey.x448)if(3===this.version)this.sessionKeyAlgorithm=F.write(F.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}write(){const e=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),Kn(this.publicKeyAlgorithm,this.encrypted)),O.concatUint8Array(e)}async encrypt(e){const t=F.write(F.publicKey,this.publicKeyAlgorithm),r=3===this.version?this.sessionKeyAlgorithm:null,i=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),n=Xa(this.version,t,r,this.sessionKey);this.encrypted=await In(t,r,e.publicParams,n,i)}async decrypt(e,t){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const r=t?Xa(this.version,this.publicKeyAlgorithm,t.sessionKeyAlgorithm,t.sessionKey):null,i=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),n=await Bn(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,i,r),{sessionKey:s,sessionKeyAlgorithm:a}=function(e,t,r,i){switch(t){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.elgamal:case F.publicKey.ecdh:{const t=r.subarray(0,r.length-2),n=r.subarray(r.length-2),s=O.writeChecksum(t.subarray(t.length%8)),a=s[0]===n[0]&s[1]===n[1],o=6===e?{sessionKeyAlgorithm:null,sessionKey:t}:{sessionKeyAlgorithm:t[0],sessionKey:t.subarray(1)};if(i){const t=a&o.sessionKeyAlgorithm===i.sessionKeyAlgorithm&o.sessionKey.length===i.sessionKey.length;return{sessionKey:O.selectUint8Array(t,o.sessionKey,i.sessionKey),sessionKeyAlgorithm:6===e?null:O.selectUint8(t,o.sessionKeyAlgorithm,i.sessionKeyAlgorithm)}}if(a&&(6===e||F.read(F.symmetric,o.sessionKeyAlgorithm)))return o;throw Error("Decryption error")}case F.publicKey.x25519:case F.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:r};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,n,t);if(3===this.version){const e=this.publicKeyAlgorithm!==F.publicKey.x25519&&this.publicKeyAlgorithm!==F.publicKey.x448;if(this.sessionKeyAlgorithm=e?a:this.sessionKeyAlgorithm,s.length!==wi(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=s}}function Xa(e,t,r,i){switch(t){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.elgamal:case F.publicKey.ecdh:return O.concatUint8Array([new Uint8Array(6===e?[]:[r]),i,O.writeChecksum(i.subarray(i.length%8))]);case F.publicKey.x25519:case F.publicKey.x448:return i;default:throw Error("Unsupported public key algorithm")}}class $a{static get tag(){return F.packet.symEncryptedSessionKey}constructor(e=N){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=F.write(F.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let t=0;if(this.version=e[t++],4!==this.version&&5!==this.version&&6!==this.version)throw new Xt(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&t++;const r=e[t++];this.version>=5&&(this.aeadAlgorithm=e[t++],6===this.version&&t++);const i=e[t++];if(this.s2k=Ds(i),t+=this.s2k.read(e.subarray(t,e.length)),this.version>=5){const r=bs(this.aeadAlgorithm,!0);this.iv=e.subarray(t,t+=r.ivLength)}this.version>=5||t<e.length?(this.encrypted=e.subarray(t,e.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const e=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let t;const r=this.s2k.write();if(6===this.version){const i=r.length,n=3+i+this.iv.length;t=O.concatUint8Array([new Uint8Array([this.version,n,e,this.aeadAlgorithm,i]),r,this.iv,this.encrypted])}else 5===this.version?t=O.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(t=O.concatUint8Array([new Uint8Array([this.version,e]),r]),null!==this.encrypted&&(t=O.concatUint8Array([t,this.encrypted])));return t}async decrypt(e){const t=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:i}=wi(t),n=await this.s2k.produceKey(e,i);if(this.version>=5){const e=bs(this.aeadAlgorithm,!0),r=new Uint8Array([192|$a.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),s=6===this.version?await vi(F.hash.sha256,n,new Uint8Array,r,i):n,a=await e(t,s);this.sessionKey=await a.decrypt(this.encrypted,this.iv,r)}else if(null!==this.encrypted){const e=await Ln(t,n,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=F.write(F.symmetric,e[0]),this.sessionKey=e.subarray(1,e.length),this.sessionKey.length!==wi(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=n}async encrypt(e,t=N){const r=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=Us(t),this.s2k.generateSalt();const{blockSize:i,keySize:n}=wi(r),s=await this.s2k.produceKey(e,n);if(null===this.sessionKey&&(this.sessionKey=Un(this.sessionKeyAlgorithm)),this.version>=5){const e=bs(this.aeadAlgorithm);this.iv=de(e.ivLength);const t=new Uint8Array([192|$a.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),i=6===this.version?await vi(F.hash.sha256,s,new Uint8Array,t,n):s,a=await e(r,i);this.encrypted=await a.encrypt(this.sessionKey,this.iv,t)}else{const e=O.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await Nn(r,s,e,new Uint8Array(i))}}}class eo{static get tag(){return F.packet.publicKey}constructor(e=new Date,t=N){this.version=t.v6Keys?6:4,this.created=O.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const t=new eo,{version:r,created:i,algorithm:n,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=i,t.algorithm=n,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}async read(e,t=N){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new Xt("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=O.readDate(e.subarray(r,r+4)),r+=4,this.algorithm=e[r++],this.version>=5&&(r+=4);const{read:t,publicParams:i}=function(e,t){let r=0;switch(e){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=O.readMPI(t.subarray(r));return r+=i.length+2,{read:r,publicParams:{n:e,e:i}}}case F.publicKey.dsa:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=O.readMPI(t.subarray(r));r+=i.length+2;const n=O.readMPI(t.subarray(r));r+=n.length+2;const s=O.readMPI(t.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:e,q:i,g:n,y:s}}}case F.publicKey.elgamal:{const e=O.readMPI(t.subarray(r));r+=e.length+2;const i=O.readMPI(t.subarray(r));r+=i.length+2;const n=O.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{p:e,g:i,y:n}}}case F.publicKey.ecdsa:{const e=new _t;r+=e.read(t),Pn(e);const i=O.readMPI(t.subarray(r));return r+=i.length+2,{read:r,publicParams:{oid:e,Q:i}}}case F.publicKey.eddsaLegacy:{const e=new _t;if(r+=e.read(t),Pn(e),e.getName()!==F.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let i=O.readMPI(t.subarray(r));return r+=i.length+2,i=O.leftPad(i,33),{read:r,publicParams:{oid:e,Q:i}}}case F.publicKey.ecdh:{const e=new _t;r+=e.read(t),Pn(e);const i=O.readMPI(t.subarray(r));r+=i.length+2;const n=new En;return r+=n.read(t.subarray(r)),{read:r,publicParams:{oid:e,Q:i,kdfParams:n}}}case F.publicKey.ed25519:case F.publicKey.ed448:case F.publicKey.x25519:case F.publicKey.x448:{const i=O.readExactSubarray(t,r,r+xn(e));return r+=i.length,{read:r,publicParams:{A:i}}}default:throw new Xt("Unknown public key encryption algorithm.")}}(this.algorithm,e.subarray(r));if(6===this.version&&i.oid&&(i.oid.getName()===F.curve.curve25519Legacy||i.oid.getName()===F.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=i,r+=t,await this.computeFingerprintAndKeyID(),r}throw new Xt(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(O.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const t=Kn(this.algorithm,this.publicParams);return this.version>=5&&e.push(O.writeNumber(t.length,4)),e.push(t),O.concatUint8Array(e)}writeForHash(e){const t=this.writePublicKey(),r=149+e,i=e>=5?4:2;return O.concatUint8Array([new Uint8Array([r]),O.writeNumber(t.length,i),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Sa,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(4!==this.version)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Me(F.hash.sha256,e);else{if(4!==this.version)throw Error("Unsupported key version");this.fingerprint=await Me(F.hash.sha1,e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return O.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&O.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=F.read(F.publicKey,this.algorithm);const t=this.publicParams.n||this.publicParams.p;return t?e.bits=O.uint8ArrayBitLength(t):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}eo.prototype.readPublicKey=eo.prototype.read,eo.prototype.writePublicKey=eo.prototype.write;const to=O.constructAllowedPackets([Ba,Oa,Qa,Ua]);class ro{static get tag(){return F.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}async decrypt(e,t,r=N){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:i}=wi(e),n=await P(K(this.encrypted)),s=await Ln(e,t,n.subarray(i+2),n.subarray(2,i+2));this.packets=await Ta.fromBinary(s,to,r)}async encrypt(e,t,r=N){const i=this.packets.write(),{blockSize:n}=wi(e),s=await Fn(e),a=await Nn(e,t,s,new Uint8Array(n)),o=await Nn(e,t,i,a.subarray(2));this.encrypted=O.concat([a,o])}}class io{static get tag(){return F.packet.marker}read(e){return 80===e[0]&&71===e[1]&&80===e[2]}write(){return new Uint8Array([80,71,80])}}class no extends eo{static get tag(){return F.packet.publicSubkey}constructor(e,t){super(e,t)}static fromSecretSubkeyPacket(e){const t=new no,{version:r,created:i,algorithm:n,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=i,t.algorithm=n,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}}class so{static get tag(){return F.packet.userAttribute}constructor(){this.attributes=[]}read(e){let t=0;for(;t<e.length;){const r=jt(e.subarray(t,e.length));t+=r.offset,this.attributes.push(O.uint8ArrayToString(e.subarray(t,t+r.len))),t+=r.len}}write(){const e=[];for(let t=0;t<this.attributes.length;t++)e.push(qt(this.attributes[t].length)),e.push(O.stringToUint8Array(this.attributes[t]));return O.concatUint8Array(e)}equals(e){return!!(e&&e instanceof so)&&this.attributes.every(function(t,r){return t===e.attributes[r]})}}class ao extends eo{static get tag(){return F.packet.secretKey}constructor(e=new Date,t=N){super(e,t),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(e,t=N){let r=await this.readPublicKey(e,t);const i=r;this.s2kUsage=e[r++],5===this.version&&r++,6===this.version&&this.s2kUsage&&r++;try{if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){this.symmetric=e[r++],253===this.s2kUsage&&(this.aead=e[r++]),6===this.version&&r++;const t=e[r++];if(this.s2k=Ds(t),r+=this.s2k.read(e.subarray(r,e.length)),"gnu-dummy"===this.s2k.type)return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=253===this.s2kUsage&&(5===this.version||4===this.version&&t.parseAEADEncryptedV4KeysAsLegacy),253!==this.s2kUsage||this.isLegacyAEAD?(this.iv=e.subarray(r,r+wi(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(r,r+bs(this.aead).ivLength),this.usedModernAEAD=!0),r+=this.iv.length)}catch(t){if(!this.s2kUsage)throw t;this.unparseableKeyMaterial=e.subarray(i),this.isEncrypted=!0}if(5===this.version&&(r+=4),this.keyMaterial=e.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let t;if(6===this.version)t=this.keyMaterial;else if(t=this.keyMaterial.subarray(0,-2),!O.equalsUint8Array(O.writeChecksum(t),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:e,privateParams:r}=Sn(this.algorithm,t,this.publicParams);if(e<t.length)throw Error("Error reading MPIs");this.privateParams=r}catch(e){if(e instanceof Xt)throw e;throw Error("Error reading MPIs")}}}write(){const e=this.writePublicKey();if(this.unparseableKeyMaterial)return O.concatUint8Array([e,this.unparseableKeyMaterial]);const t=[e];t.push(new Uint8Array([this.s2kUsage]));const r=[];if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){r.push(this.symmetric),253===this.s2kUsage&&r.push(this.aead);const e=this.s2k.write();6===this.version&&r.push(e.length),r.push(...e)}return this.s2kUsage&&"gnu-dummy"!==this.s2k.type&&r.push(...this.iv),(5===this.version||6===this.version&&this.s2kUsage)&&t.push(new Uint8Array([r.length])),t.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=Kn(this.algorithm,this.privateParams)),5===this.version&&t.push(O.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||6===this.version||t.push(O.writeChecksum(this.keyMaterial))),O.concatUint8Array(t)}isDecrypted(){return!1===this.isEncrypted}isMissingSecretKeyMaterial(){return void 0!==this.unparseableKeyMaterial||this.isDummy()}isDummy(){return!(!this.s2k||"gnu-dummy"!==this.s2k.type)}makeDummy(e=N){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=Ds(F.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=F.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(e,t=N){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=Us(t),this.s2k.generateSalt();const r=Kn(this.algorithm,this.privateParams);this.symmetric=F.symmetric.aes256;const{blockSize:i}=wi(this.symmetric);if(t.aeadProtect){this.s2kUsage=253,this.aead=t.preferredAEADAlgorithm;const n=bs(this.aead);this.isLegacyAEAD=5===this.version,this.usedModernAEAD=!this.isLegacyAEAD;const s=Jt(this.constructor.tag),a=await oo(this.version,this.s2k,e,this.symmetric,this.aead,s,this.isLegacyAEAD),o=await n(this.symmetric,a);this.iv=this.isLegacyAEAD?de(i):de(n.ivLength);const c=this.isLegacyAEAD?new Uint8Array:O.concatUint8Array([s,this.writePublicKey()]);this.keyMaterial=await o.encrypt(r,this.iv.subarray(0,n.ivLength),c)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const t=await oo(this.version,this.s2k,e,this.symmetric);this.iv=de(i),this.keyMaterial=await Nn(this.symmetric,t,O.concatUint8Array([r,await Me(F.hash.sha1,r)]),this.iv)}}async decrypt(e){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let t;const r=Jt(this.constructor.tag);if(254!==this.s2kUsage&&253!==this.s2kUsage)throw 255===this.s2kUsage?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let i;if(t=await oo(this.version,this.s2k,e,this.symmetric,this.aead,r,this.isLegacyAEAD),253===this.s2kUsage){const n=bs(this.aead,!0),s=await n(this.symmetric,t);try{const e=this.isLegacyAEAD?new Uint8Array:O.concatUint8Array([r,this.writePublicKey()]);i=await s.decrypt(this.keyMaterial,this.iv.subarray(0,n.ivLength),e)}catch(e){if("Authentication tag mismatch"===e.message)throw Error("Incorrect key passphrase: "+e.message);throw e}}else{const e=await Ln(this.symmetric,t,this.keyMaterial,this.iv);i=e.subarray(0,-20);const r=await Me(F.hash.sha1,i);if(!O.equalsUint8Array(r,e.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:e}=Sn(this.algorithm,i,this.publicParams);this.privateParams=e}catch(e){throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=await Dn(this.algorithm,this.publicParams,this.privateParams)}catch(n){e=!1}if(!e)throw Error("Key is invalid")}async generate(e,t){if(6===this.version&&(this.algorithm===F.publicKey.ecdh&&t===F.curve.curve25519Legacy||this.algorithm===F.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${t}. Generate a key of type 'curve25519' instead`);const{privateParams:r,publicParams:i}=await Cn(this.algorithm,e,t);this.privateParams=r,this.publicParams=i,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(e=>{this.privateParams[e].fill(0),delete this.privateParams[e]}),this.privateParams=null,this.isEncrypted=!0)}}async function oo(e,t,r,i,n,s,a){if("argon2"===t.type&&!n)throw Error("Using Argon2 S2K without AEAD is not allowed");if("simple"===t.type&&6===e)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=wi(i),c=await t.produceKey(r,o);if(!n||5===e||a)return c;const h=O.concatUint8Array([s,new Uint8Array([e,i,n])]);return vi(F.hash.sha256,c,new Uint8Array,h,o)}class co{static get tag(){return F.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(O.isString(e)||e.name&&!O.isString(e.name)||e.email&&!O.isEmailAddress(e.email)||e.comment&&!O.isString(e.comment))throw Error("Invalid user ID format");const t=new co;Object.assign(t,e);const r=[];return t.name&&r.push(t.name),t.comment&&r.push(`(${t.comment})`),t.email&&r.push(`<${t.email}>`),t.userID=r.join(" "),t}read(e,t=N){const r=O.decodeUTF8(e);if(r.length>t.maxUserIDLength)throw Error("User ID string is too long");const i=e=>/^[^\s@]+@[^\s@]+$/.test(e),n=r.indexOf("<"),s=r.lastIndexOf(">");if(-1!==n&&-1!==s&&s>n){const e=r.substring(n+1,s);if(i(e)){this.email=e;const t=r.substring(0,n).trim(),i=t.indexOf("("),s=t.lastIndexOf(")");-1!==i&&-1!==s&&s>i?(this.comment=t.substring(i+1,s).trim(),this.name=t.substring(0,i).trim()):(this.name=t,this.comment="")}}else i(r.trim())&&(this.email=r.trim(),this.name="",this.comment="");this.userID=r}write(){return O.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class ho extends ao{static get tag(){return F.packet.secretSubkey}constructor(e=new Date,t=N){super(e,t)}}class uo{static get tag(){return F.packet.trust}read(){throw new Xt("Trust packets are not supported")}write(){throw new Xt("Trust packets are not supported")}}class fo{static get tag(){return F.packet.padding}constructor(){this.padding=null}read(e){}write(){return this.padding}async createPadding(e){this.padding=await de(e)}}const lo=O.constructAllowedPackets([Ua]);class yo{constructor(e){this.packets=e||new Ta}write(){return this.packets.write()}armor(e=N){const t=this.packets.some(e=>e.constructor.tag===Ua.tag&&6!==e.version);return re(F.armor.signature,this.write(),void 0,void 0,void 0,t,e)}getSigningKeyIDs(){return this.packets.map(e=>e.issuerKeyID)}}async function go({armoredSignature:e,binarySignature:t,config:r,...i}){r={...N,...r};let n=e||t;if(!n)throw Error("readSignature: must pass options object containing `armoredSignature` or `binarySignature`");if(e&&!O.isString(e))throw Error("readSignature: options.armoredSignature must be a string");if(t&&!O.isUint8Array(t))throw Error("readSignature: options.binarySignature must be a Uint8Array");const s=Object.keys(i);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(e){const{type:e,data:t}=await te(n);if(e!==F.armor.signature)throw Error("Armored text not of type signature");n=t}const a=await Ta.fromBinary(n,lo,r);return new yo(a)}async function po(e,t){const r=new ho(e.date,t);return r.packets=null,r.algorithm=F.write(F.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve),await r.computeFingerprintAndKeyID(),r}async function Ao(e,t){const r=new ao(e.date,t);return r.packets=null,r.algorithm=F.write(F.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve,e.config),await r.computeFingerprintAndKeyID(),r}async function wo(e,t,r,i,n=new Date,s){let a,o;for(let c=e.length-1;c>=0;c--)try{(!a||e[c].created>=a.created)&&(await e[c].verify(t,r,i,n,void 0,s),a=e[c])}catch(e){o=e}if(!a)throw O.wrapError(`Could not find valid ${F.read(F.signature,r)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(e,t,r)=>t+" "+r.toLowerCase()),o);return a}function mo(e,t,r=new Date){const i=O.normalizeDate(r);if(null!==i){const r=Bo(e,t);return!(e.created<=i&&i<r)}return!1}async function bo(e,t,r,i){const n={};n.key=t,n.bind=e;const s={signatureType:F.signature.subkeyBinding};return r.sign?(s.keyFlags=[F.keyFlags.signData],s.embeddedSignature=await Eo(n,[],e,{signatureType:F.signature.keyBinding},r.date,void 0,void 0,void 0,i)):s.keyFlags=[F.keyFlags.encryptCommunication|F.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),await Eo(n,[],t,s,r.date,void 0,void 0,void 0,i)}async function ko(e,t,r=new Date,i=[],n){const s=F.hash.sha256,a=n.preferredHashAlgorithm,o=await Promise.all(e.map(async(e,t)=>(await e.getPrimarySelfSignature(r,i[t],n)).preferredHashAlgorithms||[])),c=new Map;for(const f of o)for(const e of f)try{const t=F.write(F.hash,e);c.set(t,c.has(t)?c.get(t)+1:1)}catch{}const h=t=>0===e.length||c.get(t)===e.length||t===s,u=()=>{if(0===c.size)return s;const e=Array.from(c.keys()).filter(e=>h(e)).sort((e,t)=>Fe(e)-Fe(t))[0];return Fe(e)>=Fe(s)?e:s};if(new Set([F.publicKey.ecdsa,F.publicKey.eddsaLegacy,F.publicKey.ed25519,F.publicKey.ed448]).has(t.algorithm)){const e=function(e,t){switch(e){case F.publicKey.ecdsa:case F.publicKey.eddsaLegacy:return Gi(t);case F.publicKey.ed25519:case F.publicKey.ed448:return or(e);default:throw Error("Unknown elliptic signing algo")}}(t.algorithm,t.publicParams.oid),r=h(a),i=Fe(a)>=Fe(e);if(r&&i)return a;{const t=u();return Fe(t)>=Fe(e)?t:e}}return h(a)?a:u()}async function Eo(e,t,r,i,n,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const h=new Ua;return Object.assign(h,i),h.publicKeyAlgorithm=r.algorithm,h.hashAlgorithm=await ko(t,r,n,s,c),h.rawNotations=[...a],await h.sign(r,e,n,o,c),h}async function vo(e,t,r,i=new Date,n){(e=e[r])&&(t[r].length?await Promise.all(e.map(async function(e){e.isExpired(i)||n&&!await n(e)||t[r].some(function(t){return O.equalsUint8Array(t.writeParams(),e.writeParams())})||t[r].push(e)})):t[r]=e)}async function Io(e,t,r,i,n,s,a=new Date,o){s=s||e;const c=[];return await Promise.all(i.map(async function(e){try{if(!n||e.issuerKeyID.equals(n.issuerKeyID)){const i=![F.reasonForRevocation.keyRetired,F.reasonForRevocation.keySuperseded,F.reasonForRevocation.userIDInvalid].includes(e.reasonForRevocationFlag);await e.verify(s,t,r,i?null:a,!1,o),c.push(e.issuerKeyID)}}catch(e){}})),n?(n.revoked=!!c.some(e=>e.equals(n.issuerKeyID))||n.revoked||!1,n.revoked):c.length>0}function Bo(e,t){let r;return!1===t.keyNeverExpires&&(r=e.created.getTime()+1e3*t.keyExpirationTime),r?new Date(r):1/0}function So(e,t={}){switch(e.type=e.type||t.type,e.curve=e.curve||t.curve,e.rsaBits=e.rsaBits||t.rsaBits,e.keyExpirationTime=void 0!==e.keyExpirationTime?e.keyExpirationTime:t.keyExpirationTime,e.passphrase=O.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e.sign=e.sign||!1,e.type){case"ecc":try{e.curve=F.write(F.curve,e.curve)}catch(e){throw Error("Unknown curve")}e.curve!==F.curve.ed25519Legacy&&e.curve!==F.curve.curve25519Legacy&&"ed25519"!==e.curve&&"curve25519"!==e.curve||(e.curve=e.sign?F.curve.ed25519Legacy:F.curve.curve25519Legacy),e.sign?e.algorithm=e.curve===F.curve.ed25519Legacy?F.publicKey.eddsaLegacy:F.publicKey.ecdsa:e.algorithm=F.publicKey.ecdh;break;case"curve25519":e.algorithm=e.sign?F.publicKey.ed25519:F.publicKey.x25519;break;case"curve448":e.algorithm=e.sign?F.publicKey.ed448:F.publicKey.x448;break;case"rsa":e.algorithm=F.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+e.type)}return e}function Ko(e,t,r){switch(e.algorithm){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:case F.publicKey.dsa:case F.publicKey.ecdsa:case F.publicKey.eddsaLegacy:case F.publicKey.ed25519:case F.publicKey.ed448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&F.keyFlags.signData);default:return!1}}function Co(e,t,r){switch(e.algorithm){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:case F.publicKey.elgamal:case F.publicKey.ecdh:case F.publicKey.x25519:case F.publicKey.x448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&F.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&F.keyFlags.encryptStorage);default:return!1}}function Do(e,t,r){if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(e.algorithm){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaEncrypt:case F.publicKey.elgamal:case F.publicKey.ecdh:case F.publicKey.x25519:case F.publicKey.x448:return!(t.keyFlags&&!(t.keyFlags[0]&F.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)||!t.keyFlags||!!(t.keyFlags[0]&F.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&F.keyFlags.encryptStorage);default:return!1}}function Uo(e,t){const r=F.write(F.publicKey,e.algorithm),i=e.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(r))throw Error(i.algorithm+" keys are considered too weak.");switch(r){case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:case F.publicKey.rsaEncrypt:if(i.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case F.publicKey.ecdsa:case F.publicKey.eddsaLegacy:case F.publicKey.ecdh:if(t.rejectCurves.has(i.curve))throw Error(`Support for ${i.algorithm} keys using curve ${i.curve} is disabled.`)}}class Po{constructor(e,t){this.userID=e.constructor.tag===F.packet.userID?e:null,this.userAttribute=e.constructor.tag===F.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new Ta;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new Po(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,t,r){const i=this.mainKey.keyPacket,n={userID:this.userID,userAttribute:this.userAttribute,key:i},s=new Po(n.userID||n.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(e.map(async function(e){if(!e.isPrivate())throw Error("Need private key for signing");if(e.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");const s=await e.getSigningKey(void 0,t,void 0,r);return Eo(n,[e],s.keyPacket,{signatureType:F.signature.certGeneric,keyFlags:[F.keyFlags.certifyKeys|F.keyFlags.signData]},t,void 0,void 0,void 0,r)})),await s.update(this,t,r),s}async isRevoked(e,t,r=new Date,i=N){const n=this.mainKey.keyPacket;return Io(n,F.signature.certRevocation,{key:n,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,r,i)}async verifyCertificate(e,t,r=new Date,i){const n=this,s=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:o}=e,c=t.filter(e=>e.getKeys(o).length>0);return 0===c.length?null:(await Promise.all(c.map(async t=>{const s=await t.getSigningKey(o,e.created,void 0,i);if(e.revoked||await n.isRevoked(e,s.keyPacket,r,i))throw Error("User certificate is revoked");try{await e.verify(s.keyPacket,F.signature.certGeneric,a,r,void 0,i)}catch(e){throw O.wrapError("User certificate is invalid",e)}})),!0)}async verifyAllCertifications(e,t=new Date,r){const i=this,n=this.selfCertifications.concat(this.otherCertifications);return Promise.all(n.map(async n=>({keyID:n.issuerKeyID,valid:await i.verifyCertificate(n,e,t,r).catch(()=>!1)})))}async verify(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,i=this.mainKey.keyPacket,n={userID:this.userID,userAttribute:this.userAttribute,key:i};let s;for(let a=this.selfCertifications.length-1;a>=0;a--)try{const s=this.selfCertifications[a];if(s.revoked||await r.isRevoked(s,void 0,e,t))throw Error("Self-certification is revoked");try{await s.verify(i,F.signature.certGeneric,n,e,void 0,t)}catch(e){throw O.wrapError("Self-certification is invalid",e)}return!0}catch(e){s=e}throw s}async update(e,t,r){const i=this.mainKey.keyPacket,n={userID:this.userID,userAttribute:this.userAttribute,key:i};await vo(e,this,"selfCertifications",t,async function(e){try{return await e.verify(i,F.signature.certGeneric,n,t,!1,r),!0}catch(e){return!1}}),await vo(e,this,"otherCertifications",t),await vo(e,this,"revocationSignatures",t,function(e){return Io(i,F.signature.certRevocation,n,[e],void 0,void 0,t,r)})}async revoke(e,{flag:t=F.reasonForRevocation.noReason,string:r=""}={},i=new Date,n=N){const s={userID:this.userID,userAttribute:this.userAttribute,key:e},a=new Po(s.userID||s.userAttribute,this.mainKey);return a.revocationSignatures.push(await Eo(s,[],e,{signatureType:F.signature.certRevocation,reasonForRevocationFlag:F.write(F.reasonForRevocation,t),reasonForRevocationString:r},i,void 0,void 0,!1,n)),await a.update(this),a}}class xo{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new Ta;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new xo(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,t,r=new Date,i=N){const n=this.mainKey.keyPacket;return Io(n,F.signature.subkeyRevocation,{key:n,bind:this.keyPacket},this.revocationSignatures,e,t,r,i)}async verify(e=new Date,t=N){const r=this.mainKey.keyPacket,i={key:r,bind:this.keyPacket},n=await wo(this.bindingSignatures,r,F.signature.subkeyBinding,i,e,t);if(n.revoked||await this.isRevoked(n,null,e,t))throw Error("Subkey is revoked");if(mo(this.keyPacket,n,e))throw Error("Subkey is expired");return n}async getExpirationTime(e=new Date,t=N){const r=this.mainKey.keyPacket,i={key:r,bind:this.keyPacket};let n;try{n=await wo(this.bindingSignatures,r,F.signature.subkeyBinding,i,e,t)}catch(e){return null}const s=Bo(this.keyPacket,n),a=n.getExpirationTime();return s<a?s:a}async update(e,t=new Date,r=N){const i=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===F.packet.publicSubkey&&e.keyPacket.constructor.tag===F.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const n=this,s={key:i,bind:n.keyPacket};await vo(e,this,"bindingSignatures",t,async function(e){for(let t=0;t<n.bindingSignatures.length;t++)if(n.bindingSignatures[t].issuerKeyID.equals(e.issuerKeyID))return e.created>n.bindingSignatures[t].created&&(n.bindingSignatures[t]=e),!1;try{return await e.verify(i,F.signature.subkeyBinding,s,t,void 0,r),!0}catch(e){return!1}}),await vo(e,this,"revocationSignatures",t,function(e){return Io(i,F.signature.subkeyRevocation,s,[e],void 0,void 0,t,r)})}async revoke(e,{flag:t=F.reasonForRevocation.noReason,string:r=""}={},i=new Date,n=N){const s={key:e,bind:this.keyPacket},a=new xo(this.keyPacket,this.mainKey);return a.revocationSignatures.push(await Eo(s,[],e,{signatureType:F.signature.subkeyRevocation,reasonForRevocationFlag:F.write(F.reasonForRevocation,t),reasonForRevocationString:r},i,void 0,void 0,!1,n)),await a.update(this),a}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(e=>{xo.prototype[e]=function(){return this.keyPacket[e]()}});const Qo=O.constructAllowedPackets([Ua]),Ro=new Set([F.packet.publicKey,F.packet.privateKey]),To=new Set([F.packet.publicKey,F.packet.privateKey,F.packet.publicSubkey,F.packet.privateSubkey]);class Mo{packetListToStructure(e,t=new Set){let r,i,n,s;for(const a of e){if(a instanceof tr){To.has(a.tag)&&!s&&(s=Ro.has(a.tag)?Ro:To);continue}const e=a.constructor.tag;if(s){if(!s.has(e))continue;s=null}if(t.has(e))throw Error("Unexpected packet type: "+e);switch(e){case F.packet.publicKey:case F.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=a,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case F.packet.userID:case F.packet.userAttribute:r=new Po(a,this),this.users.push(r);break;case F.packet.publicSubkey:case F.packet.secretSubkey:r=null,n=new xo(a,this),this.subkeys.push(n);break;case F.packet.signature:switch(a.signatureType){case F.signature.certGeneric:case F.signature.certPersona:case F.signature.certCasual:case F.signature.certPositive:if(!r){O.printDebug("Dropping certification signatures without preceding user packet");continue}a.issuerKeyID.equals(i)?r.selfCertifications.push(a):r.otherCertifications.push(a);break;case F.signature.certRevocation:r?r.revocationSignatures.push(a):this.directSignatures.push(a);break;case F.signature.key:this.directSignatures.push(a);break;case F.signature.subkeyBinding:if(!n){O.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}n.bindingSignatures.push(a);break;case F.signature.keyRevocation:this.revocationSignatures.push(a);break;case F.signature.subkeyRevocation:if(!n){O.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}n.revocationSignatures.push(a)}}}}toPacketList(){const e=new Ta;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(t=>e.push(...t.toPacketList())),this.subkeys.map(t=>e.push(...t.toPacketList())),e}clone(e=!1){const t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach(e=>{if(e.keyPacket=Object.create(Object.getPrototypeOf(e.keyPacket),Object.getOwnPropertyDescriptors(e.keyPacket)),!e.keyPacket.isDecrypted())return;const t={};Object.keys(e.keyPacket.privateParams).forEach(r=>{t[r]=new Uint8Array(e.keyPacket.privateParams[r])}),e.keyPacket.privateParams=t}),t}getSubkeys(e=null){return this.subkeys.filter(t=>!e||t.getKeyID().equals(e,!0))}getKeys(e=null){const t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>null!==e)}write(){return this.toPacketList().write()}async getSigningKey(e=null,t=new Date,r={},i=N){await this.verifyPrimaryKey(t,r,i);const n=this.keyPacket;try{Uo(n,i)}catch(e){throw O.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort((e,t)=>t.keyPacket.created-e.keyPacket.created||t.keyPacket.algorithm-e.keyPacket.algorithm);let a;for(const o of s)if(!e||o.getKeyID().equals(e))try{await o.verify(t,i);const e={key:n,bind:o.keyPacket},r=await wo(o.bindingSignatures,n,F.signature.subkeyBinding,e,t,i);if(!Ko(o.keyPacket,r,i))continue;if(!r.embeddedSignature)throw Error("Missing embedded signature");return await wo([r.embeddedSignature],o.keyPacket,F.signature.keyBinding,e,t,i),Uo(o.keyPacket,i),o}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,i);if((!e||n.getKeyID().equals(e))&&Ko(n,s,i))return Uo(n,i),this}catch(e){a=e}throw O.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),a)}async getEncryptionKey(e,t=new Date,r={},i=N){await this.verifyPrimaryKey(t,r,i);const n=this.keyPacket;try{Uo(n,i)}catch(e){throw O.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort((e,t)=>t.keyPacket.created-e.keyPacket.created||t.keyPacket.algorithm-e.keyPacket.algorithm);let a;for(const o of s)if(!e||o.getKeyID().equals(e))try{await o.verify(t,i);const e={key:n,bind:o.keyPacket},r=await wo(o.bindingSignatures,n,F.signature.subkeyBinding,e,t,i);if(Co(o.keyPacket,r,i))return Uo(o.keyPacket,i),o}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,i);if((!e||n.getKeyID().equals(e))&&Co(n,s,i))return Uo(n,i),this}catch(e){a=e}throw O.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),a)}async isRevoked(e,t,r=new Date,i=N){return Io(this.keyPacket,F.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,r,i)}async verifyPrimaryKey(e=new Date,t={},r=N){const i=this.keyPacket;if(await this.isRevoked(null,null,e,r))throw Error("Primary key is revoked");if(mo(i,await this.getPrimarySelfSignature(e,t,r),e))throw Error("Primary key is expired");if(6!==i.version){const t=await wo(this.directSignatures,i,F.signature.key,{key:i},e,r).catch(()=>{});if(t&&mo(i,t,e))throw Error("Primary key is expired")}}async getExpirationTime(e,t=N){let r;try{const i=await this.getPrimarySelfSignature(null,e,t),n=Bo(this.keyPacket,i),s=i.getExpirationTime(),a=6!==this.keyPacket.version&&await wo(this.directSignatures,this.keyPacket,F.signature.key,{key:this.keyPacket},null,t).catch(()=>{});if(a){const e=Bo(this.keyPacket,a);r=Math.min(n,s,e)}else r=n<s?n:s}catch(e){r=null}return O.normalizeDate(r)}async getPrimarySelfSignature(e=new Date,t={},r=N){const i=this.keyPacket;if(6===i.version)return wo(this.directSignatures,i,F.signature.key,{key:i},e,r);const{selfCertification:n}=await this.getPrimaryUser(e,t,r);return n}async getPrimaryUser(e=new Date,t={},r=N){const i=this.keyPacket,n=[];let s;for(let h=0;h<this.users.length;h++)try{const s=this.users[h];if(!s.userID)continue;if(void 0!==t.name&&s.userID.name!==t.name||void 0!==t.email&&s.userID.email!==t.email||void 0!==t.comment&&s.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");const a={userID:s.userID,key:i},o=await wo(s.selfCertifications,i,F.signature.certGeneric,a,e,r);n.push({index:h,user:s,selfCertification:o})}catch(e){s=e}if(!n.length)throw s||Error("Could not find primary user");await Promise.all(n.map(async function(t){return t.selfCertification.revoked||t.user.isRevoked(t.selfCertification,null,e,r)}));const a=n.sort(function(e,t){const r=e.selfCertification,i=t.selfCertification;return i.revoked-r.revoked||r.isPrimaryUserID-i.isPrimaryUserID||r.created-i.created}).pop(),{user:o,selfCertification:c}=a;if(c.revoked||await o.isRevoked(c,null,e,r))throw Error("Primary user is revoked");return a}async update(e,t=new Date,r=N){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(this.subkeys.length!==e.subkeys.length||!this.subkeys.every(t=>e.subkeys.some(e=>t.hasSameFingerprintAs(e))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,r)}const i=this.clone();return await vo(e,i,"revocationSignatures",t,n=>Io(i.keyPacket,F.signature.keyRevocation,i,[n],null,e.keyPacket,t,r)),await vo(e,i,"directSignatures",t),await Promise.all(e.users.map(async e=>{const n=i.users.filter(t=>e.userID&&e.userID.equals(t.userID)||e.userAttribute&&e.userAttribute.equals(t.userAttribute));if(n.length>0)await Promise.all(n.map(i=>i.update(e,t,r)));else{const t=e.clone();t.mainKey=i,i.users.push(t)}})),await Promise.all(e.subkeys.map(async e=>{const n=i.subkeys.filter(t=>t.hasSameFingerprintAs(e));if(n.length>0)await Promise.all(n.map(i=>i.update(e,t,r)));else{const t=e.clone();t.mainKey=i,i.subkeys.push(t)}})),i}async getRevocationCertificate(e=new Date,t=N){const r={key:this.keyPacket},i=await wo(this.revocationSignatures,this.keyPacket,F.signature.keyRevocation,r,e,t),n=new Ta;n.push(i);const s=6!==this.keyPacket.version;return re(F.armor.publicKey,n.write(),null,null,"This is a revocation certificate",s,t)}async applyRevocationCertificate(e,t=new Date,r=N){const i=await te(e),n=(await Ta.fromBinary(i.data,Qo,r)).findPacket(F.packet.signature);if(!n||n.signatureType!==F.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!n.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await n.verify(this.keyPacket,F.signature.keyRevocation,{key:this.keyPacket},t,void 0,r)}catch(e){throw O.wrapError("Could not verify revocation signature",e)}const s=this.clone();return s.revocationSignatures.push(n),s}async signPrimaryUser(e,t,r,i=N){const{index:n,user:s}=await this.getPrimaryUser(t,r,i),a=await s.certify(e,t,i),o=this.clone();return o.users[n]=a,o}async signAllUsers(e,t=new Date,r=N){const i=this.clone();return i.users=await Promise.all(this.users.map(function(i){return i.certify(e,t,r)})),i}async verifyPrimaryUser(e,t=new Date,r,i=N){const n=this.keyPacket,{user:s}=await this.getPrimaryUser(t,r,i);return e?await s.verifyAllCertifications(e,t,i):[{keyID:n.getKeyID(),valid:await s.verify(t,i).catch(()=>!1)}]}async verifyAllUsers(e,t=new Date,r=N){const i=this.keyPacket,n=[];return await Promise.all(this.users.map(async s=>{const a=e?await s.verifyAllCertifications(e,t,r):[{keyID:i.getKeyID(),valid:await s.verify(t,r).catch(()=>!1)}];n.push(...a.map(e=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:e.keyID,valid:e.valid})))})),n}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(e=>{Mo.prototype[e]=xo.prototype[e]});class Fo extends Mo{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([F.packet.secretKey,F.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=N){const t=6!==this.keyPacket.version;return re(F.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}}class No extends Fo{constructor(e){if(super(),this.packetListToStructure(e,new Set([F.packet.publicKey,F.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new Ta,t=this.toPacketList();for(const r of t)switch(r.constructor.tag){case F.packet.secretKey:{const t=eo.fromSecretKeyPacket(r);e.push(t);break}case F.packet.secretSubkey:{const t=no.fromSecretSubkeyPacket(r);e.push(t);break}default:e.push(r)}return new Fo(e)}armor(e=N){const t=6!==this.keyPacket.version;return re(F.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,t,e)}async getDecryptionKeys(e,t=new Date,r={},i=N){const n=this.keyPacket,s=[];let a=null;for(let c=0;c<this.subkeys.length;c++)if(!e||this.subkeys[c].getKeyID().equals(e,!0)){if(this.subkeys[c].keyPacket.isDummy()){a=a||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const e={key:n,bind:this.subkeys[c].keyPacket},r=await wo(this.subkeys[c].bindingSignatures,n,F.signature.subkeyBinding,e,t,i);Do(this.subkeys[c].keyPacket,r,i)&&s.push(this.subkeys[c])}catch(e){a=e}}const o=await this.getPrimarySelfSignature(t,r,i);if(e&&!n.getKeyID().equals(e,!0)||!Do(n,o,i)||(n.isDummy()?a=a||Error("Gnu-dummy key packets cannot be used for decryption"):s.push(this)),0===s.length)throw a||Error("No decryption key packets found");return s}isDecrypted(){return this.getKeys().some(({keyPacket:e})=>e.isDecrypted())}async validate(e=N){if(!this.isPrivate())throw Error("Cannot validate a public key");let t;if(this.keyPacket.isDummy()){const r=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});r&&!r.keyPacket.isDummy()&&(t=r.keyPacket)}else t=this.keyPacket;if(t)return t.validate();{const e=this.getKeys();if(e.map(e=>e.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(e.map(async e=>e.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()})}async revoke({flag:e=F.reasonForRevocation.noReason,string:t=""}={},r=new Date,i=N){if(!this.isPrivate())throw Error("Need private key for revoking");const n={key:this.keyPacket},s=this.clone();return s.revocationSignatures.push(await Eo(n,[],this.keyPacket,{signatureType:F.signature.keyRevocation,reasonForRevocationFlag:F.write(F.reasonForRevocation,e),reasonForRevocationString:t},r,void 0,void 0,void 0,i)),s}async addSubkey(e={}){const t={...N,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<t.minRSABits)throw Error(`rsaBits should be at least ${t.minRSABits}, got: ${e.rsaBits}`);const r=this.keyPacket;if(r.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!r.isDecrypted())throw Error("Key is not decrypted");const i=r.getAlgorithmInfo();i.type=function(e){switch(F.write(F.publicKey,e)){case F.publicKey.rsaEncrypt:case F.publicKey.rsaEncryptSign:case F.publicKey.rsaSign:case F.publicKey.dsa:return"rsa";case F.publicKey.ecdsa:case F.publicKey.eddsaLegacy:return"ecc";case F.publicKey.ed25519:return"curve25519";case F.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(i.algorithm),i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519Legacy",e=So(e,i);const n=await po(e,{...t,v6Keys:6===this.keyPacket.version});Uo(n,t);const s=await bo(n,r,e,t),a=this.toPacketList();return a.push(n,s),new No(a)}}const Lo=O.constructAllowedPackets([eo,no,ao,ho,co,so,Ua]);function Oo(e){for(const t of e)switch(t.constructor.tag){case F.packet.secretKey:return new No(e);case F.packet.publicKey:return new Fo(e)}throw Error("No key packet found")}async function Ho(e,t,r,i){r.passphrase&&await e.encrypt(r.passphrase,i),await Promise.all(t.map(async function(e,t){const n=r.subkeys[t].passphrase;n&&await e.encrypt(n,i)}));const n=new Ta;function s(e,t){return[t,...e.filter(e=>e!==t)]}function a(){const e={};e.keyFlags=[F.keyFlags.certifyKeys|F.keyFlags.signData];const t=s([F.symmetric.aes256,F.symmetric.aes128],i.preferredSymmetricAlgorithm);if(e.preferredSymmetricAlgorithms=t,i.aeadProtect){const r=s([F.aead.gcm,F.aead.eax,F.aead.ocb],i.preferredAEADAlgorithm);e.preferredCipherSuites=r.flatMap(e=>t.map(t=>[t,e]))}return e.preferredHashAlgorithms=s([F.hash.sha512,F.hash.sha256,F.hash.sha3_512,F.hash.sha3_256],i.preferredHashAlgorithm),e.preferredCompressionAlgorithms=s([F.compression.uncompressed,F.compression.zlib,F.compression.zip],i.preferredCompressionAlgorithm),e.features=[0],e.features[0]|=F.features.modificationDetection,i.aeadProtect&&(e.features[0]|=F.features.seipdv2),r.keyExpirationTime>0&&(e.keyExpirationTime=r.keyExpirationTime,e.keyNeverExpires=!1),e}if(n.push(e),6===e.version){const t={key:e},s=a();s.signatureType=F.signature.key;const o=await Eo(t,[],e,s,r.date,void 0,void 0,void 0,i);n.push(o)}await Promise.all(r.userIDs.map(async function(t,n){const s=co.fromObject(t),o={userID:s,key:e},c=6!==e.version?a():{};return c.signatureType=F.signature.certPositive,0===n&&(c.isPrimaryUserID=!0),{userIDPacket:s,signaturePacket:await Eo(o,[],e,c,r.date,void 0,void 0,void 0,i)}})).then(e=>{e.forEach(({userIDPacket:e,signaturePacket:t})=>{n.push(e),n.push(t)})}),await Promise.all(t.map(async function(t,n){const s=r.subkeys[n];return{secretSubkeyPacket:t,subkeySignaturePacket:await bo(t,e,s,i)}})).then(e=>{e.forEach(({secretSubkeyPacket:e,subkeySignaturePacket:t})=>{n.push(e),n.push(t)})});const o={key:e};return n.push(await Eo(o,[],e,{signatureType:F.signature.keyRevocation,reasonForRevocationFlag:F.reasonForRevocation.noReason,reasonForRevocationString:""},r.date,void 0,void 0,void 0,i)),r.passphrase&&e.clearPrivateParams(),await Promise.all(t.map(async function(e,t){r.subkeys[t].passphrase&&e.clearPrivateParams()})),new No(n)}async function zo({armoredKey:e,binaryKey:t,config:r,...i}){if(r={...N,...r},!e&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!O.isString(e))throw Error("readKey: options.armoredKey must be a string");if(t&&!O.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(e){const{type:t,data:r}=await te(e);if(t!==F.armor.publicKey&&t!==F.armor.privateKey)throw Error("Armored text not of type key");s=r}else s=t;const a=await Ta.fromBinary(s,Lo,r),o=a.indexOfTag(F.packet.publicKey,F.packet.secretKey);if(0===o.length)throw Error("No key packet found");return Oo(a.slice(o[0],o[1]))}async function Go({armoredKey:e,binaryKey:t,config:r,...i}){if(r={...N,...r},!e&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!O.isString(e))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!O.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(e){const{type:t,data:r}=await te(e);if(t!==F.armor.privateKey)throw Error("Armored text not of type private key");s=r}else s=t;const a=await Ta.fromBinary(s,Lo,r),o=a.indexOfTag(F.packet.publicKey,F.packet.secretKey);for(let c=0;c<o.length;c++){if(a[o[c]].constructor.tag===F.packet.publicKey)continue;const e=a.slice(o[c],o[c+1]);return new No(e)}throw Error("No secret key packet found")}async function _o({armoredKeys:e,binaryKeys:t,config:r,...i}){r={...N,...r};let n=e||t;if(!n)throw Error("readKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(e&&!O.isString(e))throw Error("readKeys: options.armoredKeys must be a string");if(t&&!O.isUint8Array(t))throw Error("readKeys: options.binaryKeys must be a Uint8Array");const s=Object.keys(i);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(e){const{type:t,data:r}=await te(e);if(t!==F.armor.publicKey&&t!==F.armor.privateKey)throw Error("Armored text not of type key");n=r}const a=[],o=await Ta.fromBinary(n,Lo,r),c=o.indexOfTag(F.packet.publicKey,F.packet.secretKey);if(0===c.length)throw Error("No key packet found");for(let h=0;h<c.length;h++){const e=Oo(o.slice(c[h],c[h+1]));a.push(e)}return a}async function jo({armoredKeys:e,binaryKeys:t,config:r}){r={...N,...r};let i=e||t;if(!i)throw Error("readPrivateKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(e&&!O.isString(e))throw Error("readPrivateKeys: options.armoredKeys must be a string");if(t&&!O.isUint8Array(t))throw Error("readPrivateKeys: options.binaryKeys must be a Uint8Array");if(e){const{type:t,data:r}=await te(e);if(t!==F.armor.privateKey)throw Error("Armored text not of type private key");i=r}const n=[],s=await Ta.fromBinary(i,Lo,r),a=s.indexOfTag(F.packet.publicKey,F.packet.secretKey);for(let o=0;o<a.length;o++){if(s[a[o]].constructor.tag===F.packet.publicKey)continue;const e=s.slice(a[o],a[o+1]),t=new No(e);n.push(t)}if(0===n.length)throw Error("No secret key packet found");return n}const qo=O.constructAllowedPackets([Ba,Oa,Za,Va,ro,Wa,$a,Qa,Ua]),Vo=O.constructAllowedPackets([$a]),Jo=O.constructAllowedPackets([Ua]);class Yo{constructor(e){this.packets=e||new Ta}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(F.packet.publicKeyEncryptedSessionKey).forEach(function(t){e.push(t.publicKeyID)}),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),t=e.packets.filterByTag(F.packet.onePassSignature);return t.length>0?t.map(e=>e.issuerKeyID):e.packets.filterByTag(F.packet.signature).map(e=>e.issuerKeyID)}async decrypt(e,t,r,i=new Date,n=N){const s=this.packets.filterByTag(F.packet.symmetricallyEncryptedData,F.packet.symEncryptedIntegrityProtectedData,F.packet.aeadEncryptedData);if(0===s.length)throw Error("No encrypted data found");const a=s[0],o=a.cipherAlgorithm,c=r||await this.decryptSessionKeys(e,t,o,i,n);let h=null;const u=Promise.all(c.map(async({algorithm:e,data:t})=>{if(!O.isUint8Array(t)||!a.cipherAlgorithm&&!O.isString(e))throw Error("Invalid session key for decryption.");try{const r=a.cipherAlgorithm||F.write(F.symmetric,e);await a.decrypt(r,t,n)}catch(e){O.printDebugError(e),h=e}}));if(x(a.encrypted),a.encrypted=null,await u,!a.packets||!a.packets.length)throw h||Error("Decryption failed.");const f=new Yo(a.packets);return a.packets=new Ta,f}async decryptSessionKeys(e,t,r,i=new Date,n=N){let s,a=[];if(t){const e=this.packets.filterByTag(F.packet.symEncryptedSessionKey);if(0===e.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(t.map(async function(t,r){let i;i=r?await Ta.fromBinary(e.write(),Vo,n):e,await Promise.all(i.map(async function(e){try{await e.decrypt(t),a.push(e)}catch(e){O.printDebugError(e),e instanceof vs&&(s=e)}}))}))}else{if(!e)throw Error("No key or password specified.");{const t=this.packets.filterByTag(F.packet.publicKeyEncryptedSessionKey);if(0===t.length)throw Error("No public key encrypted session key packet found.");await Promise.all(t.map(async function(t){await Promise.all(e.map(async function(e){let o;try{o=(await e.getDecryptionKeys(t.publicKeyID,null,void 0,n)).map(e=>e.keyPacket)}catch(e){return void(s=e)}let c=[F.symmetric.aes256,F.symmetric.aes128,F.symmetric.tripledes,F.symmetric.cast5];try{const t=await e.getPrimarySelfSignature(i,void 0,n);t.preferredSymmetricAlgorithms&&(c=c.concat(t.preferredSymmetricAlgorithms))}catch(e){}await Promise.all(o.map(async function(e){if(!e.isDecrypted())throw Error("Decryption key is not decrypted.");if(!n.constantTimePKCS1Decryption||t.publicKeyAlgorithm!==F.publicKey.rsaEncrypt&&t.publicKeyAlgorithm!==F.publicKey.rsaEncryptSign&&t.publicKeyAlgorithm!==F.publicKey.rsaSign&&t.publicKeyAlgorithm!==F.publicKey.elgamal)try{await t.decrypt(e);const i=r||t.sessionKeyAlgorithm;if(i&&!c.includes(F.write(F.symmetric,i)))throw Error("A non-preferred symmetric algorithm was used.");a.push(t)}catch(e){O.printDebugError(e),s=e}else{const i=t.write();await Promise.all((r?[r]:Array.from(n.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async t=>{const r=new Wa;r.read(i);const n={sessionKeyAlgorithm:t,sessionKey:Un(t)};try{await r.decrypt(e,n),a.push(r)}catch(e){O.printDebugError(e),s=e}}))}}))})),x(t.encrypted),t.encrypted=null}))}}if(a.length>0){if(a.length>1){const e=new Set;a=a.filter(t=>{const r=t.sessionKeyAlgorithm+O.uint8ArrayToString(t.sessionKey);return!e.has(r)&&(e.add(r),!0)})}return a.map(e=>({data:e.sessionKey,algorithm:e.sessionKeyAlgorithm&&F.read(F.symmetric,e.sessionKeyAlgorithm)}))}throw s||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(F.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(F.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(F.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],t=new Date,r=[],i=N){const{symmetricAlgo:n,aeadAlgo:s}=await async function(e=[],t=new Date,r=[],i=N){const n=await Promise.all(e.map((e,n)=>e.getPrimarySelfSignature(t,r[n],i)));if(e.length?n.every(e=>e.features&&e.features[0]&F.features.seipdv2):i.aeadProtect){const e={symmetricAlgo:F.symmetric.aes128,aeadAlgo:F.aead.ocb},t=[{symmetricAlgo:i.preferredSymmetricAlgorithm,aeadAlgo:i.preferredAEADAlgorithm},{symmetricAlgo:i.preferredSymmetricAlgorithm,aeadAlgo:F.aead.ocb},{symmetricAlgo:F.symmetric.aes128,aeadAlgo:i.preferredAEADAlgorithm}];for(const r of t)if(n.every(e=>e.preferredCipherSuites&&e.preferredCipherSuites.some(e=>e[0]===r.symmetricAlgo&&e[1]===r.aeadAlgo)))return r;return e}const s=F.symmetric.aes128,a=i.preferredSymmetricAlgorithm;return{symmetricAlgo:n.every(e=>e.preferredSymmetricAlgorithms&&e.preferredSymmetricAlgorithms.includes(a))?a:s,aeadAlgo:void 0}}(e,t,r,i),a=F.read(F.symmetric,n),o=s?F.read(F.aead,s):void 0;return await Promise.all(e.map(e=>e.getEncryptionKey().catch(()=>null).then(e=>{if(e&&(e.keyPacket.algorithm===F.publicKey.x25519||e.keyPacket.algorithm===F.publicKey.x448)&&!o&&!O.isAES(n))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:Un(n),algorithm:a,aeadAlgorithm:o}}async encrypt(e,t,r,i=!1,n=[],s=new Date,a=[],o=N){if(r){if(!O.isUint8Array(r.data)||!O.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)r=await Yo.generateSessionKey(e,s,a,o);else{if(!t||!t.length)throw Error("No keys, passwords, or session key provided.");r=await Yo.generateSessionKey(void 0,void 0,void 0,o)}const{data:c,algorithm:h,aeadAlgorithm:u}=r,f=await Yo.encryptSessionKey(c,h,u,e,t,i,n,s,a,o),l=Va.fromObject({version:u?2:1,aeadAlgorithm:u?F.write(F.aead,u):null});l.packets=this.packets;const y=F.write(F.symmetric,h);return await l.encrypt(y,c,o),f.packets.push(l),l.packets=new Ta,f}static async encryptSessionKey(e,t,r,i,n,s=!1,a=[],o=new Date,c=[],h=N){const u=new Ta,f=F.write(F.symmetric,t),l=r&&F.write(F.aead,r);if(i){const t=await Promise.all(i.map(async function(t,r){const i=await t.getEncryptionKey(a[r],o,c,h),n=Wa.fromObject({version:l?6:3,encryptionKeyPacket:i.keyPacket,anonymousRecipient:s,sessionKey:e,sessionKeyAlgorithm:f});return await n.encrypt(i.keyPacket),delete n.sessionKey,n}));u.push(...t)}if(n){const t=async function(e,t){try{return await e.decrypt(t),1}catch(e){return 0}},r=(e,t)=>e+t,i=async function(e,s,a,o){const c=new $a(h);return c.sessionKey=e,c.sessionKeyAlgorithm=s,a&&(c.aeadAlgorithm=a),await c.encrypt(o,h),h.passwordCollisionCheck&&1!==(await Promise.all(n.map(e=>t(c,e)))).reduce(r)?i(e,s,o):(delete c.sessionKey,c)},s=await Promise.all(n.map(t=>i(e,f,l,t)));u.push(...s)}return new Yo(u)}async sign(e=[],t=[],r=null,i=[],n=new Date,s=[],a=[],o=[],c=N){const h=new Ta,u=this.packets.findPacket(F.packet.literalData);if(!u)throw Error("No literal data packet to sign.");const f=await Zo(u,e,t,r,i,n,s,a,o,!1,c),l=f.map((e,t)=>Qa.fromSignaturePacket(e,0===t)).reverse();return h.push(...l),h.push(u),h.push(...f),new Yo(h)}compress(e,t=N){if(e===F.compression.uncompressed)return this;const r=new Oa(t);r.algorithm=e,r.packets=this.packets;const i=new Ta;return i.push(r),new Yo(i)}async signDetached(e=[],t=[],r=null,i=[],n=[],s=new Date,a=[],o=[],c=N){const h=this.packets.findPacket(F.packet.literalData);if(!h)throw Error("No literal data packet to sign.");return new yo(await Zo(h,e,t,r,i,n,s,a,o,!0,c))}async verify(e,t=new Date,r=N){const i=this.unwrapCompressed(),n=i.packets.filterByTag(F.packet.literalData);if(1!==n.length)throw Error("Can only verify message with one literal data packet.");let s=i.packets;u(s.stream)&&(s=s.concat(await P(s.stream,e=>e||[])));const a=s.filterByTag(F.packet.onePassSignature).reverse(),o=s.filterByTag(F.packet.signature);return a.length&&!o.length&&O.isStream(s.stream)&&!u(s.stream)?(await Promise.all(a.map(async e=>{e.correspondingSig=new Promise((t,r)=>{e.correspondingSigResolve=t,e.correspondingSigReject=r}),e.signatureData=Q(async()=>(await e.correspondingSig).signatureData),e.hashed=P(await e.hash(e.signatureType,n[0],void 0,!1)),e.hashed.catch(()=>{})})),s.stream=B(s.stream,async(e,t)=>{const r=R(e),i=T(t);try{for(let e=0;e<a.length;e++){const{value:t}=await r.read();a[e].correspondingSigResolve(t)}await r.readToEnd(),await i.ready,await i.close()}catch(e){a.forEach(t=>{t.correspondingSigReject(e)}),await i.abort(e)}}),Wo(a,n,e,t,!1,r)):Wo(o,n,e,t,!1,r)}verifyDetached(e,t,r=new Date,i=N){const n=this.unwrapCompressed().packets.filterByTag(F.packet.literalData);if(1!==n.length)throw Error("Can only verify message with one literal data packet.");return Wo(e.packets.filterByTag(F.packet.signature),n,t,r,!0,i)}unwrapCompressed(){const e=this.packets.filterByTag(F.packet.compressedData);return e.length?new Yo(e[0].packets):this}async appendSignature(e,t=N){await this.packets.read(O.isUint8Array(e)?e:(await te(e)).data,Jo,t)}write(){return this.packets.write()}armor(e=N){const t=this.packets[this.packets.length-1],r=t.constructor.tag===Va.tag?2!==t.version:this.packets.some(e=>e.constructor.tag===Ua.tag&&6!==e.version);return re(F.armor.message,this.write(),null,null,null,r,e)}}async function Zo(e,t,r=[],i=null,n=[],s=new Date,a=[],o=[],c=[],h=!1,u=N){const f=new Ta,l=null===e.text?F.signature.binary:F.signature.text;if(await Promise.all(t.map(async(t,i)=>{const f=a[i];if(!t.isPrivate())throw Error("Need private key for signing");const y=await t.getSigningKey(n[i],s,f,u);return Eo(e,r.length?r:[t],y.keyPacket,{signatureType:l},s,o,c,h,u)})).then(e=>{f.push(...e)}),i){const e=i.packets.filterByTag(F.packet.signature);f.push(...e)}return f}async function Wo(e,t,r,i=new Date,n=!1,s=N){return Promise.all(e.filter(function(e){return["text","binary"].includes(F.read(F.signature,e.signatureType))}).map(async function(e){return async function(e,t,r,i=new Date,n=!1,s=N){let a,o;for(const u of r){const t=u.getKeys(e.issuerKeyID);if(t.length>0){a=u,o=t[0];break}}const c=e instanceof Qa?e.correspondingSig:e,h={keyID:e.issuerKeyID,verified:(async()=>{if(!o)throw Error("Could not find signing key with key ID "+e.issuerKeyID.toHex());await e.verify(o.keyPacket,e.signatureType,t[0],i,n,s);const r=await c;if(o.getCreationTime()>r.created)throw Error("Key is newer than the signature");try{await a.getSigningKey(o.getKeyID(),r.created,void 0,s)}catch(e){if(!s.allowInsecureVerificationWithReformattedKeys||!e.message.match(/Signature creation time is in the future/))throw e;await a.getSigningKey(o.getKeyID(),i,void 0,s)}return!0})(),signature:(async()=>{const e=await c,t=new Ta;return e&&t.push(e),new yo(t)})()};return h.signature.catch(()=>{}),h.verified.catch(()=>{}),h}(e,t,r,i,n,s)}))}async function Xo({armoredMessage:e,binaryMessage:t,config:r,...i}){r={...N,...r};let n=e||t;if(!n)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(e&&!O.isString(e)&&!O.isStream(e))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!O.isUint8Array(t)&&!O.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(i);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=O.isStream(n);if(e){const{type:e,data:t}=await te(n);if(e!==F.armor.message)throw Error("Armored text not of type message");n=t}const o=await Ta.fromBinary(n,qo,r,new Na),c=new Yo(o);return c.fromStream=a,c}async function $o({text:e,binary:t,filename:r,date:i=new Date,format:n=(void 0!==e?"utf8":"binary"),...s}){const a=void 0!==e?e:t;if(void 0===a)throw Error("createMessage: must pass options object containing `text` or `binary`");if(e&&!O.isString(e)&&!O.isStream(e))throw Error("createMessage: options.text must be a string or stream");if(t&&!O.isUint8Array(t)&&!O.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=O.isStream(a),h=new Ba(i);void 0!==e?h.setText(a,F.write(F.literal,n)):h.setBytes(a,F.write(F.literal,n)),void 0!==r&&h.setFilename(r);const u=new Ta;u.push(h);const f=new Yo(u);return f.fromStream=c,f}const ec=O.constructAllowedPackets([Ua]);class tc{constructor(e,t){if(this.text=O.removeTrailingSpaces(e).replace(/\r?\n/g,"\r\n"),t&&!(t instanceof yo))throw Error("Invalid signature input");this.signature=t||new yo(new Ta)}getSigningKeyIDs(){const e=[];return this.signature.packets.forEach(function(t){e.push(t.issuerKeyID)}),e}async sign(e,t=[],r=null,i=[],n=new Date,s=[],a=[],o=[],c=N){const h=new Ba;h.setText(this.text);const u=new yo(await Zo(h,e,t,r,i,n,s,a,o,!0,c));return new tc(this.text,u)}verify(e,t=new Date,r=N){const i=this.signature.packets.filterByTag(F.packet.signature),n=new Ba;return n.setText(this.text),Wo(i,[n],e,t,!0,r)}getText(){return this.text.replace(/\r\n/g,"\n")}armor(e=N){const t=this.signature.packets.some(e=>6!==e.version),r={hash:t?Array.from(new Set(this.signature.packets.map(e=>F.read(F.hash,e.hashAlgorithm).toUpperCase()))).join():null,text:this.text,data:this.signature.packets.write()};return re(F.armor.signed,r,void 0,void 0,void 0,t,e)}}async function rc({cleartextMessage:e,config:t,...r}){if(t={...N,...t},!e)throw Error("readCleartextMessage: must pass options object containing `cleartextMessage`");if(!O.isString(e))throw Error("readCleartextMessage: options.cleartextMessage must be a string");const i=Object.keys(r);if(i.length>0)throw Error("Unknown option: "+i.join(", "));const n=await te(e);if(n.type!==F.armor.signed)throw Error("No cleartext signed message.");const s=await Ta.fromBinary(n.data,ec,t);!function(e,t){const r=function(e){const r=e=>t=>e.hashAlgorithm===t;for(let i=0;i<t.length;i++)if(t[i].constructor.tag===F.packet.signature&&!e.some(r(t[i])))return!1;return!0},i=[];if(e.forEach(e=>{const t=e.match(/^Hash: (.+)$/);if(!t)throw Error('Only "Hash" header allowed in cleartext signed message');{const e=t[1].replace(/\s/g,"").split(",").map(e=>{try{return F.write(F.hash,e.toLowerCase())}catch(t){throw Error("Unknown hash algorithm in armor header: "+e.toLowerCase())}});i.push(...e)}}),i.length&&!r(i))throw Error("Hash algorithm mismatch in armor header and signature")}(n.headers,s);const a=new yo(s);return new tc(n.text,a)}async function ic({text:e,...t}){if(!e)throw Error("createCleartextMessage: must pass options object containing `text`");if(!O.isString(e))throw Error("createCleartextMessage: options.text must be a string");const r=Object.keys(t);if(r.length>0)throw Error("Unknown option: "+r.join(", "));return new tc(e)}async function nc({userIDs:e=[],passphrase:t,type:r,curve:i,rsaBits:n=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:c="armored",config:h,...u}){bc(h={...N,...h}),r||i?(r=r||"ecc",i=i||"curve25519Legacy"):(r=h.v6Keys?"curve25519":"ecc",i="curve25519Legacy"),e=kc(e);const f=Object.keys(u);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(0===e.length&&!h.v6Keys)throw Error("UserIDs are required for V4 keys");if("rsa"===r&&n<h.minRSABits)throw Error(`rsaBits should be at least ${h.minRSABits}, got: ${n}`);const l={userIDs:e,passphrase:t,type:r,rsaBits:n,curve:i,keyExpirationTime:s,date:a,subkeys:o};try{const{key:e,revocationCertificate:t}=await async function(e,t){e.sign=!0,(e=So(e)).subkeys=e.subkeys.map((t,r)=>So(e.subkeys[r],e));let r=[Ao(e,t)];r=r.concat(e.subkeys.map(e=>po(e,t)));const i=await Promise.all(r),n=await Ho(i[0],i.slice(1),e,t),s=await n.getRevocationCertificate(e.date,t);return n.revocationSignatures=[],{key:n,revocationCertificate:s}}(l,h);return e.getKeys().forEach(({keyPacket:e})=>Uo(e,h)),{privateKey:Ic(e,c,h),publicKey:Ic(e.toPublic(),c,h),revocationCertificate:t}}catch(e){throw O.wrapError("Error generating keypair",e)}}async function sc({privateKey:e,userIDs:t=[],passphrase:r,keyExpirationTime:i=0,date:n,format:s="armored",config:a,...o}){bc(a={...N,...a}),t=kc(t);const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(0===t.length&&6!==e.keyPacket.version)throw Error("UserIDs are required for V4 keys");const h={privateKey:e,userIDs:t,passphrase:r,keyExpirationTime:i,date:n};try{const{key:e,revocationCertificate:t}=await async function(e,t){e=o(e);const{privateKey:r}=e;if(!r.isPrivate())throw Error("Cannot reformat a public key");if(r.keyPacket.isDummy())throw Error("Cannot reformat a gnu-dummy primary key");if(!r.getKeys().every(({keyPacket:e})=>e.isDecrypted()))throw Error("Key is not decrypted");const i=r.keyPacket;e.subkeys||(e.subkeys=await Promise.all(r.subkeys.map(async e=>{const r=e.keyPacket,n={key:i,bind:r},s=await wo(e.bindingSignatures,i,F.signature.subkeyBinding,n,null,t).catch(()=>({}));return{sign:s.keyFlags&&s.keyFlags[0]&F.keyFlags.signData}})));const n=r.subkeys.map(e=>e.keyPacket);if(e.subkeys.length!==n.length)throw Error("Number of subkey options does not match number of subkeys");e.subkeys=e.subkeys.map(t=>o(t,e));const s=await Ho(i,n,e,t),a=await s.getRevocationCertificate(e.date,t);return s.revocationSignatures=[],{key:s,revocationCertificate:a};function o(e,t={}){return e.keyExpirationTime=e.keyExpirationTime||t.keyExpirationTime,e.passphrase=O.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e}}(h,a);return{privateKey:Ic(e,s,a),publicKey:Ic(e.toPublic(),s,a),revocationCertificate:t}}catch(e){throw O.wrapError("Error reformatting keypair",e)}}async function ac({key:e,revocationCertificate:t,reasonForRevocation:r,date:i=new Date,format:n="armored",config:s,...a}){bc(s={...N,...s});const o=Object.keys(a);if(o.length>0)throw Error("Unknown option: "+o.join(", "));try{const a=t?await e.applyRevocationCertificate(t,i,s):await e.revoke(r,i,s);return a.isPrivate()?{privateKey:Ic(a,n,s),publicKey:Ic(a.toPublic(),n,s)}:{privateKey:null,publicKey:Ic(a,n,s)}}catch(e){throw O.wrapError("Error revoking key",e)}}async function oc({privateKey:e,passphrase:t,config:r,...i}){bc(r={...N,...r});const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!e.isPrivate())throw Error("Cannot decrypt a public key");const s=e.clone(!0),a=O.isArray(t)?t:[t];try{return await Promise.all(s.getKeys().map(e=>O.anyPromise(a.map(t=>e.keyPacket.decrypt(t))))),await s.validate(r),s}catch(e){throw s.clearPrivateParams(),O.wrapError("Error decrypting private key",e)}}async function cc({privateKey:e,passphrase:t,config:r,...i}){bc(r={...N,...r});const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!e.isPrivate())throw Error("Cannot encrypt a public key");const s=e.clone(!0),a=s.getKeys(),o=O.isArray(t)?t:Array(a.length).fill(t);if(o.length!==a.length)throw Error("Invalid number of passphrases given for key encryption");try{return await Promise.all(a.map(async(e,t)=>{const{keyPacket:i}=e;await i.encrypt(o[t],r),i.clearPrivateParams()})),s}catch(e){throw s.clearPrivateParams(),O.wrapError("Error encrypting private key",e)}}async function hc({message:e,encryptionKeys:t,signingKeys:r,passwords:i,sessionKey:n,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:h=[],date:u=new Date,signingUserIDs:f=[],encryptionUserIDs:l=[],signatureNotations:y=[],config:g,...p}){if(bc(g={...N,...g}),dc(e),wc(s),t=kc(t),r=kc(r),i=kc(i),c=kc(c),h=kc(h),f=kc(f),l=kc(l),y=kc(y),p.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(p.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(p.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==p.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const d=Object.keys(p);if(d.length>0)throw Error("Unknown option: "+d.join(", "));r||(r=[]);try{if((r.length||a)&&(e=await e.sign(r,t,a,c,u,f,h,y,g)),e=e.compress(await async function(e=[],t=new Date,r=[],i=N){const n=F.compression.uncompressed,s=i.preferredCompressionAlgorithm,a=await Promise.all(e.map(async function(e,n){const a=(await e.getPrimarySelfSignature(t,r[n],i)).preferredCompressionAlgorithms;return!!a&&a.indexOf(s)>=0}));return a.every(Boolean)?s:n}(t,u,l,g),g),e=await e.encrypt(t,i,n,o,h,u,l,g),"object"===s)return e;const p="armored"===s?e.armor(g):e.write();return await Ec(p)}catch(e){throw O.wrapError("Error encrypting message",e)}}async function uc({message:e,decryptionKeys:t,passwords:r,sessionKeys:i,verificationKeys:n,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:h,...u}){if(bc(h={...N,...h}),dc(e),n=kc(n),t=kc(t),r=kc(r),i=kc(i),u.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(u.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const f=Object.keys(u);if(f.length>0)throw Error("Unknown option: "+f.join(", "));try{const u=await e.decrypt(t,r,i,c,h);n||(n=[]);const f={};if(f.signatures=o?await u.verifyDetached(o,n,c,h):await u.verify(n,c,h),f.data="binary"===a?u.getLiteralData():u.getText(),f.filename=u.getFilename(),vc(f,e,...new Set([u,u.unwrapCompressed()])),s){if(0===n.length)throw Error("Verification keys are required to verify message signatures");if(0===f.signatures.length)throw Error("Message is not signed");f.data=b([f.data,Q(async()=>(await O.anyPromise(f.signatures.map(e=>e.verified)),"binary"===a?new Uint8Array:""))])}return f.data=await Ec(f.data),f}catch(e){throw O.wrapError("Error decrypting message",e)}}async function fc({message:e,signingKeys:t,recipientKeys:r=[],format:i="armored",detached:n=!1,signingKeyIDs:s=[],date:a=new Date,signingUserIDs:o=[],recipientUserIDs:c=[],signatureNotations:h=[],config:u,...f}){if(bc(u={...N,...u}),Ac(e),wc(i),t=kc(t),s=kc(s),o=kc(o),r=kc(r),c=kc(c),h=kc(h),f.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.sign, pass `signingKeys` instead");if(void 0!==f.armor)throw Error("The `armor` option has been removed from openpgp.sign, pass `format` instead.");const l=Object.keys(f);if(l.length>0)throw Error("Unknown option: "+l.join(", "));if(e instanceof tc&&"binary"===i)throw Error("Cannot return signed cleartext message in binary format");if(e instanceof tc&&n)throw Error("Cannot detach-sign a cleartext message");if(!t||0===t.length)throw Error("No signing keys provided");try{let f;return f=n?await e.signDetached(t,r,void 0,s,a,o,c,h,u):await e.sign(t,r,void 0,s,a,o,c,h,u),"object"===i?f:(f="armored"===i?f.armor(u):f.write(),n&&(f=B(e.packets.write(),async(e,t)=>{await Promise.all([k(f,t),P(e).catch(()=>{})])})),await Ec(f))}catch(e){throw O.wrapError("Error signing message",e)}}async function lc({message:e,verificationKeys:t,expectSigned:r=!1,format:i="utf8",signature:n=null,date:s=new Date,config:a,...o}){if(bc(a={...N,...a}),Ac(e),t=kc(t),o.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(e instanceof tc&&"binary"===i)throw Error("Can't return cleartext message data as binary");if(e instanceof tc&&n)throw Error("Can't verify detached cleartext signature");try{const o={};if(o.signatures=n?await e.verifyDetached(n,t,s,a):await e.verify(t,s,a),o.data="binary"===i?e.getLiteralData():e.getText(),e.fromStream&&!n&&vc(o,...new Set([e,e.unwrapCompressed()])),r){if(0===o.signatures.length)throw Error("Message is not signed");o.data=b([o.data,Q(async()=>(await O.anyPromise(o.signatures.map(e=>e.verified)),"binary"===i?new Uint8Array:""))])}return o.data=await Ec(o.data),o}catch(e){throw O.wrapError("Error verifying signed message",e)}}async function yc({encryptionKeys:e,date:t=new Date,encryptionUserIDs:r=[],config:i,...n}){if(bc(i={...N,...i}),e=kc(e),r=kc(r),n.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.generateSessionKey, pass `encryptionKeys` instead");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));try{return await Yo.generateSessionKey(e,t,r,i)}catch(e){throw O.wrapError("Error generating session key",e)}}async function gc({data:e,algorithm:t,aeadAlgorithm:r,encryptionKeys:i,passwords:n,format:s="armored",wildcard:a=!1,encryptionKeyIDs:o=[],date:c=new Date,encryptionUserIDs:h=[],config:u,...f}){if(bc(u={...N,...u}),function(e){if(!O.isUint8Array(e))throw Error("Parameter [data] must be of type Uint8Array")}(e),function(e,t){if(!O.isString(e))throw Error("Parameter ["+t+"] must be of type String")}(t,"algorithm"),wc(s),i=kc(i),n=kc(n),o=kc(o),h=kc(h),f.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encryptSessionKey, pass `encryptionKeys` instead");const l=Object.keys(f);if(l.length>0)throw Error("Unknown option: "+l.join(", "));if(!(i&&0!==i.length||n&&0!==n.length))throw Error("No encryption keys or passwords provided.");try{return Ic(await Yo.encryptSessionKey(e,t,r,i,n,a,o,c,h,u),s,u)}catch(e){throw O.wrapError("Error encrypting session key",e)}}async function pc({message:e,decryptionKeys:t,passwords:r,date:i=new Date,config:n,...s}){if(bc(n={...N,...n}),dc(e),t=kc(t),r=kc(r),s.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decryptSessionKeys, pass `decryptionKeys` instead");const a=Object.keys(s);if(a.length>0)throw Error("Unknown option: "+a.join(", "));try{return await e.decryptSessionKeys(t,r,void 0,i,n)}catch(e){throw O.wrapError("Error decrypting session keys",e)}}function dc(e){if(!(e instanceof Yo))throw Error("Parameter [message] needs to be of type Message")}function Ac(e){if(!(e instanceof tc||e instanceof Yo))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}function wc(e){if("armored"!==e&&"binary"!==e&&"object"!==e)throw Error("Unsupported format "+e)}const mc=Object.keys(N).length;function bc(e){const t=Object.keys(e);if(t.length!==mc)for(const r of t)if(void 0===N[r])throw Error("Unknown config property: "+r)}function kc(e){return e&&!O.isArray(e)&&(e=[e]),e}async function Ec(e){return"array"===O.isStream(e)?P(e):e}function vc(e,t,...r){e.data=B(t.packets.stream,async(t,i)=>{await k(e.data,i,{preventClose:!0});const n=T(i);try{await P(t,e=>e),await Promise.all(r.map(e=>P(e.packets.stream,e=>e))),await n.close()}catch(e){await n.abort(e)}})}function Ic(e,t,r){switch(t){case"object":return e;case"armored":return e.armor(r);case"binary":return e.write();default:throw Error("Unsupported format "+t)}}const Bc="object"==typeof i&&"crypto"in i?i.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Sc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Kc(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function Cc(e,...t){if(!Sc(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function Dc(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function Uc(e,t){Cc(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function Pc(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function xc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Qc(e,t){return e<<32-t|e>>>t}function Rc(e,t){return e<<t|e>>>32-t>>>0}const Tc=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?e=>e:function(e){for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;var t;return e},Mc=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),Fc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Nc(e){if(Cc(e),Mc)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Fc[e[r]];return t}const Lc=48,Oc=57,Hc=65,zc=70,Gc=97,_c=102;function jc(e){return e>=Lc&&e<=Oc?e-Lc:e>=Hc&&e<=zc?e-(Hc-10):e>=Gc&&e<=_c?e-(Gc-10):void 0}function qc(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(Mc)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const t=jc(e.charCodeAt(s)),r=jc(e.charCodeAt(s+1));if(void 0===t||void 0===r){const t=e[s]+e[s+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[n]=16*t+r}return i}function Vc(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function Jc(e){return"string"==typeof e&&(e=Vc(e)),Cc(e),e}function Yc(...e){let t=0;for(let i=0;i<e.length;i++){const r=e[i];Cc(r),t+=r.length}const r=new Uint8Array(t);for(let i=0,n=0;i<e.length;i++){const t=e[i];r.set(t,n),n+=t.length}return r}class Zc{}function Wc(e){const t=t=>e().update(Jc(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}const Xc=Wc;function $c(e=32){if(Bc&&"function"==typeof Bc.getRandomValues)return Bc.getRandomValues(new Uint8Array(e));if(Bc&&"function"==typeof Bc.randomBytes)return Uint8Array.from(Bc.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const eh=BigInt(0),th=BigInt(1);function rh(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function ih(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function nh(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?eh:BigInt("0x"+e)}function sh(e){return nh(Nc(e))}function ah(e){return Cc(e),nh(Nc(Uint8Array.from(e).reverse()))}function oh(e,t){return qc(e.toString(16).padStart(2*t,"0"))}function ch(e,t){return oh(e,t).reverse()}function hh(e,t,r){let i;if("string"==typeof t)try{i=qc(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Sc(t))throw Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}const uh=e=>"bigint"==typeof e&&eh<=e;function fh(e,t,r,i){if(!function(e,t,r){return uh(e)&&uh(t)&&uh(r)&&t<=e&&e<r}(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}const lh=e=>(th<<BigInt(e))-th;function yh(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){const n=e[t];if(i&&void 0===n)return;const s=typeof n;if(s!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function gh(e){const t=new WeakMap;return(r,...i)=>{const n=t.get(r);if(void 0!==n)return n;const s=e(r,...i);return t.set(r,s),s
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */}}const ph=BigInt(0),dh=BigInt(1),Ah=BigInt(2),wh=BigInt(3),mh=BigInt(4),bh=BigInt(5),kh=BigInt(8);function Eh(e,t){const r=e%t;return r>=ph?r:t+r}function vh(e,t,r){let i=e;for(;t-- >ph;)i*=i,i%=r;return i}function Ih(e,t){if(e===ph)throw Error("invert: expected non-zero number");if(t<=ph)throw Error("invert: expected positive modulus, got "+t);let r=Eh(e,t),i=t,n=ph,s=dh;for(;r!==ph;){const e=i%r,t=n-s*(i/r);i=r,r=e,n=s,s=t}if(i!==dh)throw Error("invert: does not exist");return Eh(n,t)}function Bh(e,t){const r=(e.ORDER+dh)/mh,i=e.pow(t,r);if(!e.eql(e.sqr(i),t))throw Error("Cannot find square root");return i}function Sh(e,t){const r=(e.ORDER-bh)/kh,i=e.mul(t,Ah),n=e.pow(i,r),s=e.mul(t,n),a=e.mul(e.mul(s,Ah),n),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),t))throw Error("Cannot find square root");return o}function Kh(e){return e%mh===wh?Bh:e%kh===bh?Sh:function(e){if(e<BigInt(3))throw Error("sqrt is not defined for small field");let t=e-dh,r=0;for(;t%Ah===ph;)t/=Ah,r++;let i=Ah;const n=Ph(e);for(;1===Uh(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return Bh;let s=n.pow(i,t);const a=(t+dh)/Ah;return function(e,i){if(e.is0(i))return i;if(1!==Uh(e,i))throw Error("Cannot find square root");let n=r,o=e.mul(e.ONE,s),c=e.pow(i,t),h=e.pow(i,a);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");const i=dh<<BigInt(n-t-1),s=e.pow(o,i);n=t,o=e.sqr(s),c=e.mul(c,o),h=e.mul(h,s)}return h}}(e)}const Ch=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Dh(e,t,r=!1){const i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),s=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),s),i}function Uh(e,t){const r=(e.ORDER-dh)/Ah,i=e.pow(t,r),n=e.eql(i,e.ONE),s=e.eql(i,e.ZERO),a=e.eql(i,e.neg(e.ONE));if(!n&&!s&&!a)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function Ph(e,t,r=!1,i={}){if(e<=ph)throw Error("invalid field: expected ORDER > 0, got "+e);let n,s;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");const e=t;e.BITS&&(n=e.BITS),e.sqrt&&(s=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(n=t),i.sqrt&&(s=i.sqrt);const{nBitLength:a,nByteLength:o}=function(e,t){void 0!==t&&Kc(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(e,n);if(o>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let c;const h=Object.freeze({ORDER:e,isLE:r,BITS:a,BYTES:o,MASK:lh(a),ZERO:ph,ONE:dh,create:t=>Eh(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return ph<=t&&t<e},is0:e=>e===ph,isValidNot0:e=>!h.is0(e)&&h.isValid(e),isOdd:e=>(e&dh)===dh,neg:t=>Eh(-t,e),eql:(e,t)=>e===t,sqr:t=>Eh(t*t,e),add:(t,r)=>Eh(t+r,e),sub:(t,r)=>Eh(t-r,e),mul:(t,r)=>Eh(t*r,e),pow:(e,t)=>function(e,t,r){if(r<ph)throw Error("invalid exponent, negatives unsupported");if(r===ph)return e.ONE;if(r===dh)return t;let i=e.ONE,n=t;for(;r>ph;)r&dh&&(i=e.mul(i,n)),n=e.sqr(n),r>>=dh;return i}(h,e,t),div:(t,r)=>Eh(t*Ih(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Ih(t,e),sqrt:s||(t=>(c||(c=Kh(e)),c(h,t))),toBytes:e=>r?ch(e,o):oh(e,o),fromBytes:e=>{if(e.length!==o)throw Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?ah(e):sh(e)},invertBatch:e=>Dh(h,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(h)}function xh(e){if("bigint"!=typeof e)throw Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Qh(e){const t=xh(e);return t+Math.ceil(t/2)}function Rh(e,t,r){return e&t^~e&r}function Th(e,t,r){return e&t^e&r^t&r}class Mh extends Zc{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=xc(this.buffer)}update(e){Dc(this),Cc(e=Jc(e));const{view:t,buffer:r,blockLen:i}=this,n=e.length;for(let s=0;s<n;){const a=Math.min(i-this.pos,n-s);if(a!==i)r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=xc(e);for(;i<=n-s;s+=i)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Dc(this),Uc(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:n}=this;let{pos:s}=this;t[s++]=128,Pc(this.buffer.subarray(s)),this.padOffset>i-s&&(this.process(r,0),s=0);for(let u=s;u<i;u++)t[u]=0;!function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),o=Number(r&s),c=i?4:0,h=i?0:4;e.setUint32(t+c,a,i),e.setUint32(t+h,o,i)}(r,i-8,BigInt(8*this.length),n),this.process(r,0);const a=xc(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,h=this.get();if(c>h.length)throw Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)a.setUint32(4*u,h[u],n)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:n,destroyed:s,pos:a}=this;return e.destroyed=s,e.finished=n,e.length=i,e.pos=a,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Fh=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Nh=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Lh=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Oh=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Hh=BigInt(2**32-1),zh=BigInt(32);function Gh(e,t=!1){return t?{h:Number(e&Hh),l:Number(e>>zh&Hh)}:{h:0|Number(e>>zh&Hh),l:0|Number(e&Hh)}}function _h(e,t=!1){const r=e.length;let i=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:a}=Gh(e[s],t);[i[s],n[s]]=[r,a]}return[i,n]}const jh=(e,t,r)=>e>>>r,qh=(e,t,r)=>e<<32-r|t>>>r,Vh=(e,t,r)=>e>>>r|t<<32-r,Jh=(e,t,r)=>e<<32-r|t>>>r,Yh=(e,t,r)=>e<<64-r|t>>>r-32,Zh=(e,t,r)=>e>>>r-32|t<<64-r;function Wh(e,t,r,i){const n=(t>>>0)+(i>>>0);return{h:e+r+(n/2**32|0)|0,l:0|n}}const Xh=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),$h=(e,t,r,i)=>t+r+i+(e/2**32|0)|0,eu=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),tu=(e,t,r,i,n)=>t+r+i+n+(e/2**32|0)|0,ru=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),iu=(e,t,r,i,n,s)=>t+r+i+n+s+(e/2**32|0)|0,nu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),su=new Uint32Array(64);class au extends Mh{constructor(e=32){super(64,e,8,!1),this.A=0|Fh[0],this.B=0|Fh[1],this.C=0|Fh[2],this.D=0|Fh[3],this.E=0|Fh[4],this.F=0|Fh[5],this.G=0|Fh[6],this.H=0|Fh[7]}get(){const{A:e,B:t,C:r,D:i,E:n,F:s,G:a,H:o}=this;return[e,t,r,i,n,s,a,o]}set(e,t,r,i,n,s,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let u=0;u<16;u++,t+=4)su[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=su[u-15],t=su[u-2],r=Qc(e,7)^Qc(e,18)^e>>>3,i=Qc(t,17)^Qc(t,19)^t>>>10;su[u]=i+su[u-7]+r+su[u-16]|0}let{A:r,B:i,C:n,D:s,E:a,F:o,G:c,H:h}=this;for(let u=0;u<64;u++){const e=h+(Qc(a,6)^Qc(a,11)^Qc(a,25))+Rh(a,o,c)+nu[u]+su[u]|0,t=(Qc(r,2)^Qc(r,13)^Qc(r,22))+Th(r,i,n)|0;h=c,c=o,o=a,a=s+e|0,s=n,n=i,i=r,r=e+t|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,h=h+this.H|0,this.set(r,i,n,s,a,o,c,h)}roundClean(){Pc(su)}destroy(){this.set(0,0,0,0,0,0,0,0),Pc(this.buffer)}}class ou extends au{constructor(){super(28),this.A=0|Nh[0],this.B=0|Nh[1],this.C=0|Nh[2],this.D=0|Nh[3],this.E=0|Nh[4],this.F=0|Nh[5],this.G=0|Nh[6],this.H=0|Nh[7]}}const cu=(()=>_h(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),hu=(()=>cu[0])(),uu=(()=>cu[1])(),fu=new Uint32Array(80),lu=new Uint32Array(80);class yu extends Mh{constructor(e=64){super(128,e,16,!1),this.Ah=0|Oh[0],this.Al=0|Oh[1],this.Bh=0|Oh[2],this.Bl=0|Oh[3],this.Ch=0|Oh[4],this.Cl=0|Oh[5],this.Dh=0|Oh[6],this.Dl=0|Oh[7],this.Eh=0|Oh[8],this.El=0|Oh[9],this.Fh=0|Oh[10],this.Fl=0|Oh[11],this.Gh=0|Oh[12],this.Gl=0|Oh[13],this.Hh=0|Oh[14],this.Hl=0|Oh[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:s,Dh:a,Dl:o,Eh:c,El:h,Fh:u,Fl:f,Gh:l,Gl:y,Hh:g,Hl:p}=this;return[e,t,r,i,n,s,a,o,c,h,u,f,l,y,g,p]}set(e,t,r,i,n,s,a,o,c,h,u,f,l,y,g,p){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|c,this.El=0|h,this.Fh=0|u,this.Fl=0|f,this.Gh=0|l,this.Gl=0|y,this.Hh=0|g,this.Hl=0|p}process(e,t){for(let w=0;w<16;w++,t+=4)fu[w]=e.getUint32(t),lu[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const e=0|fu[w-15],t=0|lu[w-15],r=Vh(e,t,1)^Vh(e,t,8)^jh(e,0,7),i=Jh(e,t,1)^Jh(e,t,8)^qh(e,t,7),n=0|fu[w-2],s=0|lu[w-2],a=Vh(n,s,19)^Yh(n,s,61)^jh(n,0,6),o=Jh(n,s,19)^Zh(n,s,61)^qh(n,s,6),c=eu(i,o,lu[w-7],lu[w-16]),h=tu(c,r,a,fu[w-7],fu[w-16]);fu[w]=0|h,lu[w]=0|c}let{Ah:r,Al:i,Bh:n,Bl:s,Ch:a,Cl:o,Dh:c,Dl:h,Eh:u,El:f,Fh:l,Fl:y,Gh:g,Gl:p,Hh:d,Hl:A}=this;for(let w=0;w<80;w++){const e=Vh(u,f,14)^Vh(u,f,18)^Yh(u,f,41),t=Jh(u,f,14)^Jh(u,f,18)^Zh(u,f,41),m=u&l^~u&g,b=ru(A,t,f&y^~f&p,uu[w],lu[w]),k=iu(b,d,e,m,hu[w],fu[w]),E=0|b,v=Vh(r,i,28)^Yh(r,i,34)^Yh(r,i,39),I=Jh(r,i,28)^Zh(r,i,34)^Zh(r,i,39),B=r&n^r&a^n&a,S=i&s^i&o^s&o;d=0|g,A=0|p,g=0|l,p=0|y,l=0|u,y=0|f,({h:u,l:f}=Wh(0|c,0|h,0|k,0|E)),c=0|a,h=0|o,a=0|n,o=0|s,n=0|r,s=0|i;const K=Xh(E,I,S);r=$h(K,k,v,B),i=0|K}({h:r,l:i}=Wh(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:s}=Wh(0|this.Bh,0|this.Bl,0|n,0|s)),({h:a,l:o}=Wh(0|this.Ch,0|this.Cl,0|a,0|o)),({h:c,l:h}=Wh(0|this.Dh,0|this.Dl,0|c,0|h)),({h:u,l:f}=Wh(0|this.Eh,0|this.El,0|u,0|f)),({h:l,l:y}=Wh(0|this.Fh,0|this.Fl,0|l,0|y)),({h:g,l:p}=Wh(0|this.Gh,0|this.Gl,0|g,0|p)),({h:d,l:A}=Wh(0|this.Hh,0|this.Hl,0|d,0|A)),this.set(r,i,n,s,a,o,c,h,u,f,l,y,g,p,d,A)}roundClean(){Pc(fu,lu)}destroy(){Pc(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class gu extends yu{constructor(){super(48),this.Ah=0|Lh[0],this.Al=0|Lh[1],this.Bh=0|Lh[2],this.Bl=0|Lh[3],this.Ch=0|Lh[4],this.Cl=0|Lh[5],this.Dh=0|Lh[6],this.Dl=0|Lh[7],this.Eh=0|Lh[8],this.El=0|Lh[9],this.Fh=0|Lh[10],this.Fl=0|Lh[11],this.Gh=0|Lh[12],this.Gl=0|Lh[13],this.Hh=0|Lh[14],this.Hl=0|Lh[15]}}const pu=Wc(()=>new au),du=Wc(()=>new ou),Au=Wc(()=>new yu),wu=Wc(()=>new gu);class mu extends Zc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");Kc(e.outputLen),Kc(e.blockLen)}(e);const r=Jc(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let s=0;s<n.length;s++)n[s]^=54;this.iHash.update(n),this.oHash=e.create();for(let s=0;s<n.length;s++)n[s]^=106;this.oHash.update(n),Pc(n)}update(e){return Dc(this),this.iHash.update(e),this}digestInto(e){Dc(this),Cc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:s,outputLen:a}=this;return e.finished=i,e.destroyed=n,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bu=(e,t,r)=>new mu(e,t).update(r).digest();bu.create=(e,t)=>new mu(e,t)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const ku=BigInt(0),Eu=BigInt(1);function vu(e,t){const r=t.negate();return e?r:t}function Iu(e,t,r){const i="pz"===t?e=>e.pz:e=>e.ez,n=Dh(e.Fp,r.map(i)),s=r.map((e,t)=>e.toAffine(n[t]));return s.map(e.fromAffine)}function Bu(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function Su(e,t){Bu(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:lh(e),maxNumber:r,shiftBy:BigInt(e)}}function Ku(e,t,r){const{windowSize:i,mask:n,maxNumber:s,shiftBy:a}=r;let o=Number(e&n),c=e>>a;o>i&&(o-=s,c+=Eu);const h=t*i;return{nextN:c,offset:h+Math.abs(o)-1,isZero:0===o,isNeg:o<0,isNegF:t%2!=0,offsetF:h}}const Cu=new WeakMap,Du=new WeakMap;function Uu(e){return Du.get(e)||1}function Pu(e){if(e!==ku)throw Error("invalid wNAF")}function xu(e,t){return{constTimeNegate:vu,hasPrecomputes:e=>1!==Uu(e),unsafeLadder(t,r,i=e.ZERO){let n=t;for(;r>ku;)r&Eu&&(i=i.add(n)),n=n.double(),r>>=Eu;return i},precomputeWindow(e,r){const{windows:i,windowSize:n}=Su(r,t),s=[];let a=e,o=a;for(let t=0;t<i;t++){o=a,s.push(o);for(let e=1;e<n;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(r,i,n){let s=e.ZERO,a=e.BASE;const o=Su(r,t);for(let e=0;e<o.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:h,isNegF:u,offsetF:f}=Ku(n,e,o);n=t,c?a=a.add(vu(u,i[f])):s=s.add(vu(h,i[r]))}return Pu(n),{p:s,f:a}},wNAFUnsafe(r,i,n,s=e.ZERO){const a=Su(r,t);for(let e=0;e<a.windows&&n!==ku;e++){const{nextN:t,offset:r,isZero:o,isNeg:c}=Ku(n,e,a);if(n=t,!o){const e=i[r];s=s.add(c?e.negate():e)}}return Pu(n),s},getPrecomputes(e,t,r){let i=Cu.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),Cu.set(t,i))),i},wNAFCached(e,t,r){const i=Uu(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){const n=Uu(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){Bu(r,t),Du.set(e,r),Cu.delete(e)}}}function Qu(e,t,r,i){!function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);const n=r.length,s=i.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");const a=e.ZERO,o=function(e){let t;for(t=0;e>eh;e>>=th,t+=1);return t}(BigInt(n));let c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);const h=lh(c),u=Array(Number(h)+1).fill(a);let f=a;for(let l=Math.floor((t.BITS-1)/c)*c;l>=0;l-=c){u.fill(a);for(let t=0;t<s;t++){const e=i[t],n=Number(e>>BigInt(l)&h);u[n]=u[n].add(r[t])}let e=a;for(let t=u.length-1,r=a;t>0;t--)r=r.add(u[t]),e=e.add(r);if(f=f.add(e),0!==l)for(let t=0;t<c;t++)f=f.double()}return f}function Ru(e,t){if(t){if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){yh(e,Ch.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return Ph(e)}function Tu(e,t,r={}){if(!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(const a of["p","n","h"]){const e=t[a];if(!("bigint"==typeof e&&e>ku))throw Error(`CURVE.${a} must be positive bigint`)}const i=Ru(t.p,r.Fp),n=Ru(t.n,r.Fn),s=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const a of s)if(!i.isValid(t[a]))throw Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:i,Fn:n}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Mu(e){void 0!==e.lowS&&rh("lowS",e.lowS),void 0!==e.prehash&&rh("prehash",e.prehash)}const Fu={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{const{Err:r}=Fu;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const i=t.length/2,n=ih(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");const s=i>127?ih(n.length/2|128):"";return ih(e)+s+n+t},decode(e,t){const{Err:r}=Fu;let i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");const n=t[i++];let s=0;if(128&n){const e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const a=t.subarray(i,i+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of a)s=s<<8|t;if(i+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;const a=t.subarray(i,i+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+s)}}},_int:{encode(e){const{Err:t}=Fu;if(e<Nu)throw new t("integer: negative integers are not allowed");let r=ih(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Fu;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return sh(e)}},toSig(e){const{Err:t,_int:r,_tlv:i}=Fu,n=hh("signature",e),{v:s,l:a}=i.decode(48,n);if(a.length)throw new t("invalid signature: left bytes after parsing");const{v:o,l:c}=i.decode(2,s),{v:h,l:u}=i.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(h)}},hexFromSig(e){const{_tlv:t,_int:r}=Fu,i=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,i)}},Nu=BigInt(0),Lu=BigInt(1),Ou=BigInt(2),Hu=BigInt(3),zu=BigInt(4);function Gu(e,t,r){const{BYTES:i}=e;return function(n){let s;if("bigint"==typeof n)s=n;else{let r=hh("private key",n);if(t){if(!t.includes(2*r.length))throw Error("invalid private key");const e=new Uint8Array(i);e.set(r,e.length-r.length),r=e}try{s=e.fromBytes(r)}catch(e){throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof n}`)}}if(r&&(s=e.create(s)),!e.isValidNot0(s))throw Error("invalid private key: out of range [1..N-1]");return s}}function _u(e,t={}){const{Fp:r,Fn:i}=Tu("weierstrass",e,t),{h:n,n:s}=e;yh(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:a}=t;if(a&&(!r.is0(e.a)||"bigint"!=typeof a.beta||"function"!=typeof a.splitScalar))throw Error('invalid endo: expected "beta": bigint and "splitScalar": function');function o(){if(!r.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}const c=t.toBytes||function(e,t,i){const{x:n,y:s}=t.toAffine(),a=r.toBytes(n);return rh("isCompressed",i),i?(o(),Yc(ju(!r.isOdd(s)),a)):Yc(Uint8Array.of(4),a,r.toBytes(s))},h=t.fromBytes||function(e){Cc(e);const t=r.BYTES,i=t+1,n=2*t+1,s=e.length,a=e[0],c=e.subarray(1);if(s!==i||2!==a&&3!==a){if(s===n&&4===a){const e=r.fromBytes(c.subarray(0*t,1*t)),i=r.fromBytes(c.subarray(1*t,2*t));if(!f(e,i))throw Error("bad point: is not on curve");return{x:e,y:i}}throw Error(`bad point: got length ${s}, expected compressed=${i} or uncompressed=${n}`)}{const t=r.fromBytes(c);if(!r.isValid(t))throw Error("bad point: is not on curve, wrong x");const i=u(t);let n;try{n=r.sqrt(i)}catch(e){const t=e instanceof Error?": "+e.message:"";throw Error("bad point: is not on curve, sqrt error"+t)}return o(),!(1&~a)!==r.isOdd(n)&&(n=r.neg(n)),{x:t,y:n}}},u=function(e,t,r){return function(i){const n=e.sqr(i),s=e.mul(n,i);return e.add(e.add(s,e.mul(i,t)),r)}}(r,e.a,e.b);function f(e,t){const i=r.sqr(t),n=u(e);return r.eql(i,n)}if(!f(e.Gx,e.Gy))throw Error("bad curve params: generator point");const l=r.mul(r.pow(e.a,Hu),zu),y=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(l,y)))throw Error("bad curve params: a or b");function g(e,t,i=!1){if(!r.isValid(t)||i&&r.is0(t))throw Error("bad point coordinate "+e);return t}function p(e){if(!(e instanceof m))throw Error("ProjectivePoint expected")}const d=gh((e,t)=>{const{px:i,py:n,pz:s}=e;if(r.eql(s,r.ONE))return{x:i,y:n};const a=e.is0();null==t&&(t=a?r.ONE:r.inv(s));const o=r.mul(i,t),c=r.mul(n,t),h=r.mul(s,t);if(a)return{x:r.ZERO,y:r.ZERO};if(!r.eql(h,r.ONE))throw Error("invZ was invalid");return{x:o,y:c}}),A=gh(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}const{x:i,y:n}=e.toAffine();if(!r.isValid(i)||!r.isValid(n))throw Error("bad point: x or y not field elements");if(!f(i,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function w(e,t,i,n,s){return i=new m(r.mul(i.px,e),i.py,i.pz),t=vu(n,t),i=vu(s,i),t.add(i)}class m{constructor(e,t,r){this.px=g("x",e),this.py=g("y",t,!0),this.pz=g("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:i}=e||{};if(!e||!r.isValid(t)||!r.isValid(i))throw Error("invalid affine point");if(e instanceof m)throw Error("projective point not allowed");return r.is0(t)&&r.is0(i)?m.ZERO:new m(t,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return Iu(m,"pz",e)}static fromBytes(e){return Cc(e),m.fromHex(e)}static fromHex(e){const t=m.fromAffine(h(hh("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=Gu(i,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return m.BASE.multiply(r(e))}static msm(e,t){return Qu(m,i,e,t)}precompute(e=8,t=!0){return k.setWindowSize(this,e),t||this.multiply(Hu),this}_setWindowSize(e){this.precompute(e)}assertValidity(){A(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){p(e);const{px:t,py:i,pz:n}=this,{px:s,py:a,pz:o}=e,c=r.eql(r.mul(t,o),r.mul(s,n)),h=r.eql(r.mul(i,o),r.mul(a,n));return c&&h}negate(){return new m(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:i}=e,n=r.mul(i,Hu),{px:s,py:a,pz:o}=this;let c=r.ZERO,h=r.ZERO,u=r.ZERO,f=r.mul(s,s),l=r.mul(a,a),y=r.mul(o,o),g=r.mul(s,a);return g=r.add(g,g),u=r.mul(s,o),u=r.add(u,u),c=r.mul(t,u),h=r.mul(n,y),h=r.add(c,h),c=r.sub(l,h),h=r.add(l,h),h=r.mul(c,h),c=r.mul(g,c),u=r.mul(n,u),y=r.mul(t,y),g=r.sub(f,y),g=r.mul(t,g),g=r.add(g,u),u=r.add(f,f),f=r.add(u,f),f=r.add(f,y),f=r.mul(f,g),h=r.add(h,f),y=r.mul(a,o),y=r.add(y,y),f=r.mul(y,g),c=r.sub(c,f),u=r.mul(y,l),u=r.add(u,u),u=r.add(u,u),new m(c,h,u)}add(t){p(t);const{px:i,py:n,pz:s}=this,{px:a,py:o,pz:c}=t;let h=r.ZERO,u=r.ZERO,f=r.ZERO;const l=e.a,y=r.mul(e.b,Hu);let g=r.mul(i,a),d=r.mul(n,o),A=r.mul(s,c),w=r.add(i,n),b=r.add(a,o);w=r.mul(w,b),b=r.add(g,d),w=r.sub(w,b),b=r.add(i,s);let k=r.add(a,c);return b=r.mul(b,k),k=r.add(g,A),b=r.sub(b,k),k=r.add(n,s),h=r.add(o,c),k=r.mul(k,h),h=r.add(d,A),k=r.sub(k,h),f=r.mul(l,b),h=r.mul(y,A),f=r.add(h,f),h=r.sub(d,f),f=r.add(d,f),u=r.mul(h,f),d=r.add(g,g),d=r.add(d,g),A=r.mul(l,A),b=r.mul(y,b),d=r.add(d,A),A=r.sub(g,A),A=r.mul(l,A),b=r.add(b,A),g=r.mul(d,b),u=r.add(u,g),g=r.mul(k,b),h=r.mul(w,h),h=r.sub(h,g),g=r.mul(w,d),f=r.mul(k,f),f=r.add(f,g),new m(h,u,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(m.ZERO)}multiply(e){const{endo:r}=t;if(!i.isValidNot0(e))throw Error("invalid scalar: out of range");let n,s;const a=e=>k.wNAFCached(this,e,m.normalizeZ);if(r){const{k1neg:t,k1:i,k2neg:o,k2:c}=r.splitScalar(e),{p:h,f:u}=a(i),{p:f,f:l}=a(c);s=u.add(l),n=w(r.beta,h,f,t,o)}else{const{p:t,f:r}=a(e);n=t,s=r}return m.normalizeZ([n,s])[0]}multiplyUnsafe(e){const{endo:r}=t,n=this;if(!i.isValid(e))throw Error("invalid scalar: out of range");if(e===Nu||n.is0())return m.ZERO;if(e===Lu)return n;if(k.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:i,k2neg:s,k2:a}=r.splitScalar(e),{p1:o,p2:c}=function(e,t,r,i){let n=t,s=e.ZERO,a=e.ZERO;for(;r>ku||i>ku;)r&Eu&&(s=s.add(n)),i&Eu&&(a=a.add(n)),n=n.double(),r>>=Eu,i>>=Eu;return{p1:s,p2:a}}(m,n,i,a);return w(r.beta,o,c,t,s)}return k.wNAFCachedUnsafe(n,e)}multiplyAndAddUnsafe(e,t,r){const i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return d(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return n===Lu||(e?e(m,this):k.wNAFCachedUnsafe(this,s).is0())}clearCofactor(){const{clearCofactor:e}=t;return n===Lu?this:e?e(m,this):this.multiplyUnsafe(n)}toBytes(e=!0){return rh("isCompressed",e),this.assertValidity(),c(m,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return Nc(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}m.BASE=new m(e.Gx,e.Gy,r.ONE),m.ZERO=new m(r.ZERO,r.ONE,r.ZERO),m.Fp=r,m.Fn=i;const b=i.BITS,k=xu(m,t.endo?Math.ceil(b/2):b);return m}function ju(e){return Uint8Array.of(e?2:3)}function qu(e,t,r={}){yh(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const i=t.randomBytes||$c,n=t.hmac||((e,...r)=>bu(t.hash,e,Yc(...r))),{Fp:s,Fn:a}=e,{ORDER:o,BITS:c}=a;function h(e){return e>o>>Lu}function u(e,t){if(!a.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class f{constructor(e,t,r){u("r",e),u("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=a.BYTES,r=hh("compactSignature",e,2*t);return new f(a.fromBytes(r.subarray(0,t)),a.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r:t,s:r}=Fu.toSig(hh("DER",e));return new f(t,r)}assertValidity(){}addRecoveryBit(e){return new f(this.r,this.s,e)}recoverPublicKey(t){const r=s.ORDER,{r:i,s:n,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");if(o*Ou<r&&c>1)throw Error("recovery id is ambiguous for h>1 curve");const h=2===c||3===c?i+o:i;if(!s.isValid(h))throw Error("recovery id 2 or 3 invalid");const u=s.toBytes(h),f=e.fromHex(Yc(ju(!(1&c)),u)),l=a.inv(h),y=d(hh("msgHash",t)),g=a.create(-y*l),p=a.create(n*l),A=e.BASE.multiplyUnsafe(g).add(f.multiplyUnsafe(p));if(A.is0())throw Error("point at infinify");return A.assertValidity(),A}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,a.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return Yc(a.toBytes(this.r),a.toBytes(this.s));if("der"===e)return qc(Fu.hexFromSig(this));throw Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Nc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Nc(this.toBytes("compact"))}}const l=Gu(a,r.allowedPrivateKeyLengths,r.wrapPrivateKey),y={isValidPrivateKey(e){try{return l(e),!0}catch(e){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const e=o;return function(e,t,r=!1){const i=e.length,n=xh(t),s=Qh(t);if(i<16||i<s||i>1024)throw Error("expected "+s+"-1024 bytes of input, got "+i);const a=Eh(r?ah(e):sh(e),t-dh)+dh;return r?ch(a,n):oh(a,n)}(i(Qh(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function g(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const i=hh("key",t).length,n=s.BYTES,o=n+1,c=2*n+1;return r.allowedPrivateKeyLengths||a.BYTES===o?void 0:i===o||i===c}const p=t.bits2int||function(e){if(e.length>8192)throw Error("input is too large");const t=sh(e),r=8*e.length-c;return r>0?t>>BigInt(r):t},d=t.bits2int_modN||function(e){return a.create(p(e))},A=lh(c);function w(e){return fh("num < 2^"+c,e,Nu,A),a.toBytes(e)}function m(r,n,o=b){if(["recovered","canonical"].some(e=>e in o))throw Error("sign() legacy options not supported");const{hash:c}=t;let{lowS:u,prehash:y,extraEntropy:g}=o;null==u&&(u=!0),r=hh("msgHash",r),Mu(o),y&&(r=hh("prehashed msgHash",c(r)));const A=d(r),m=l(n),k=[w(m),w(A)];if(null!=g&&!1!==g){const e=!0===g?i(s.BYTES):g;k.push(hh("extraEntropy",e))}const E=Yc(...k),v=A;return{seed:E,k2sig:function(t){const r=p(t);if(!a.isValidNot0(r))return;const i=a.inv(r),n=e.BASE.multiply(r).toAffine(),s=a.create(n.x);if(s===Nu)return;const o=a.create(i*a.create(v+s*m));if(o===Nu)return;let c=(n.x===s?0:2)|Number(n.y&Lu),l=o;return u&&h(o)&&(l=function(e){return h(e)?a.neg(e):e}(o),c^=1),new f(s,l,c)}}}const b={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,i=!0){if(!0===g(t))throw Error("first arg must be private key");if(!1===g(r))throw Error("second arg must be public key");return e.fromHex(r).multiply(l(t)).toBytes(i)},sign:function(e,r,i=b){const{seed:s,k2sig:o}=m(e,r,i),c=function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");const i=e=>new Uint8Array(e),n=e=>Uint8Array.of(e);let s=i(e),a=i(e),o=0;const c=()=>{s.fill(1),a.fill(0),o=0},h=(...e)=>r(a,s,...e),u=(e=i(0))=>{a=h(n(0),e),s=h(),0!==e.length&&(a=h(n(1),e),s=h())},f=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){s=h();const t=s.slice();r.push(t),e+=s.length}return Yc(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(f()));)u();return c(),r}}(t.hash.outputLen,a.BYTES,n);return c(s,o)},verify:function(r,i,n,s=k){const o=r;i=hh("msgHash",i),n=hh("publicKey",n),Mu(s);const{lowS:c,prehash:h,format:u}=s;if("strict"in s)throw Error("options.strict was renamed to lowS");if(void 0!==u&&!["compact","der","js"].includes(u))throw Error('format must be "compact", "der" or "js"');const l="string"==typeof o||Sc(o),y=!l&&!u&&"object"==typeof o&&null!==o&&"bigint"==typeof o.r&&"bigint"==typeof o.s;if(!l&&!y)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");let g,p;try{if(y){if(void 0!==u&&"js"!==u)throw Error("invalid format");g=new f(o.r,o.s)}if(l){try{"compact"!==u&&(g=f.fromDER(o))}catch(e){if(!(e instanceof Fu.Err))throw e}g||"der"===u||(g=f.fromCompact(o))}p=e.fromHex(n)}catch(e){return!1}if(!g)return!1;if(c&&g.hasHighS())return!1;h&&(i=t.hash(i));const{r:A,s:w}=g,m=d(i),b=a.inv(w),E=a.create(m*b),v=a.create(A*b),I=e.BASE.multiplyUnsafe(E).add(p.multiplyUnsafe(v));return!I.is0()&&a.create(I.x)===A},utils:y,Point:e,Signature:f})}function Vu(e){const{CURVE:t,curveOpts:r}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:Ph(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}function Ju(e){const{CURVE:t,curveOpts:r,ecdsaOpts:i}=Vu(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,qu(_u(t,r),i,r))}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Yu(e,t){const r=t=>Ju({...e,hash:t});return{...r(t),create:r}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zu={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Wu={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Xu={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},$u=Ph(Zu.p),ef=Ph(Wu.p),tf=Ph(Xu.p),rf=Yu({...Zu,Fp:$u,lowS:!1},pu),nf=Yu({...Wu,Fp:ef,lowS:!1},wu),sf=Yu({...Xu,Fp:tf,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Au),af=BigInt(0),of=BigInt(1),cf=BigInt(2),hf=BigInt(7),uf=BigInt(256),ff=BigInt(113),lf=[],yf=[],gf=[];for(let Oy=0,Hy=of,zy=1,Gy=0;Oy<24;Oy++){[zy,Gy]=[Gy,(2*zy+3*Gy)%5],lf.push(2*(5*Gy+zy)),yf.push((Oy+1)*(Oy+2)/2%64);let e=af;for(let t=0;t<7;t++)Hy=(Hy<<of^(Hy>>hf)*ff)%uf,Hy&cf&&(e^=of<<(of<<BigInt(t))-of);gf.push(e)}const pf=_h(gf,!0),df=pf[0],Af=pf[1],wf=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),mf=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class bf extends Zc{constructor(e,t,r,i=!1,n=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,Kc(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}clone(){return this._cloneInto()}keccak(){Tc(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,n=(i+2)%10,s=r[n],a=r[n+1],o=wf(s,a,1)^r[t],c=mf(s,a,1)^r[t+1];for(let r=0;r<50;r+=10)e[i+r]^=o,e[i+r+1]^=c}let t=e[2],n=e[3];for(let r=0;r<24;r++){const i=yf[r],s=wf(t,n,i),a=mf(t,n,i),o=lf[r];t=e[o],n=e[o+1],e[o]=s,e[o+1]=a}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)r[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~r[(t+2)%10]&r[(t+4)%10]}e[0]^=df[i],e[1]^=Af[i]}Pc(r)}(this.state32,this.rounds),Tc(this.state32),this.posOut=0,this.pos=0}update(e){Dc(this),Cc(e=Jc(e));const{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){const s=Math.min(t-this.pos,i-n);for(let t=0;t<s;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,128&t&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Dc(this,!1),Cc(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Kc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Uc(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Pc(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:s}=this;return e||(e=new bf(t,r,i,s,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}const kf=(e,t,r)=>Wc(()=>new bf(t,e,r)),Ef=(()=>kf(6,136,32))(),vf=(()=>kf(6,72,64))(),If=(e,t,r)=>function(e){const t=(t,r)=>e(r).update(Jc(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}((i={})=>new bf(t,e,void 0===i.dkLen?r:i.dkLen,!0)),Bf=(()=>If(31,136,32))(),Sf=BigInt(0),Kf=BigInt(1),Cf=BigInt(2),Df=BigInt(8),Uf={zip215:!0};function Pf(e,t={}){const{Fp:r,Fn:i}=Tu("edwards",e,t),{h:n,n:s}=e;yh(t,{},{uvRatio:"function"});const a=Cf<<BigInt(8*i.BYTES)-Kf,o=e=>r.create(e),c=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(r.div(e,t))}}catch(e){return{isValid:!1,value:Sf}}});if(!function(e,t,r,i){const n=e.sqr(r),s=e.sqr(i),a=e.add(e.mul(t.a,n),s),o=e.add(e.ONE,e.mul(t.d,e.mul(n,s)));return e.eql(a,o)}(r,e,e.Gx,e.Gy))throw Error("bad curve params: generator point");function h(e,t,r=!1){return fh("coordinate "+e,t,r?Kf:Sf,a),t}function u(e){if(!(e instanceof y))throw Error("ExtendedPoint expected")}const f=gh((e,t)=>{const{ex:i,ey:n,ez:s}=e,a=e.is0();null==t&&(t=a?Df:r.inv(s));const c=o(i*t),h=o(n*t),u=o(s*t);if(a)return{x:Sf,y:Kf};if(u!==Kf)throw Error("invZ was invalid");return{x:c,y:h}}),l=gh(t=>{const{a:r,d:i}=e;if(t.is0())throw Error("bad point: ZERO");const{ex:n,ey:s,ez:a,et:c}=t,h=o(n*n),u=o(s*s),f=o(a*a),l=o(f*f),y=o(h*r);if(o(f*o(y+u))!==o(l+o(i*o(h*u))))throw Error("bad point: equation left != right (1)");if(o(n*s)!==o(a*c))throw Error("bad point: equation left != right (2)");return!0});class y{constructor(e,t,r,i){this.ex=h("x",e),this.ey=h("y",t),this.ez=h("z",r,!0),this.et=h("t",i),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof y)throw Error("extended point not allowed");const{x:t,y:r}=e||{};return h("x",t),h("y",r),new y(t,r,Kf,o(t*r))}static normalizeZ(e){return Iu(y,"ez",e)}static msm(e,t){return Qu(y,i,e,t)}_setWindowSize(e){this.precompute(e)}precompute(e=8,t=!0){return g.setWindowSize(this,e),t||this.multiply(Cf),this}assertValidity(){l(this)}equals(e){u(e);const{ex:t,ey:r,ez:i}=this,{ex:n,ey:s,ez:a}=e,c=o(t*a),h=o(n*i),f=o(r*a),l=o(s*i);return c===h&&f===l}is0(){return this.equals(y.ZERO)}negate(){return new y(o(-this.ex),this.ey,this.ez,o(-this.et))}double(){const{a:t}=e,{ex:r,ey:i,ez:n}=this,s=o(r*r),a=o(i*i),c=o(Cf*o(n*n)),h=o(t*s),u=r+i,f=o(o(u*u)-s-a),l=h+a,g=l-c,p=h-a,d=o(f*g),A=o(l*p),w=o(f*p),m=o(g*l);return new y(d,A,m,w)}add(t){u(t);const{a:r,d:i}=e,{ex:n,ey:s,ez:a,et:c}=this,{ex:h,ey:f,ez:l,et:g}=t,p=o(n*h),d=o(s*f),A=o(c*i*g),w=o(a*l),m=o((n+s)*(h+f)-p-d),b=w-A,k=w+A,E=o(d-r*p),v=o(m*b),I=o(k*E),B=o(m*E),S=o(b*k);return new y(v,I,S,B)}subtract(e){return this.add(e.negate())}multiply(e){const t=e;fh("scalar",t,Kf,s);const{p:r,f:i}=g.wNAFCached(this,t,y.normalizeZ);return y.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=y.ZERO){const r=e;return fh("scalar",r,Sf,s),r===Sf?y.ZERO:this.is0()||r===Kf?this:g.wNAFCachedUnsafe(this,r,y.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(n).is0()}isTorsionFree(){return g.wNAFCachedUnsafe(this,s).is0()}toAffine(e){return f(this,e)}clearCofactor(){return n===Kf?this:this.multiplyUnsafe(n)}static fromBytes(e,t=!1){return Cc(e),this.fromHex(e,t)}static fromHex(t,i=!1){const{d:n,a:s}=e,h=r.BYTES;t=hh("pointHex",t,h),rh("zip215",i);const u=t.slice(),f=t[h-1];u[h-1]=-129&f;const l=ah(u),g=i?a:r.ORDER;fh("pointHex.y",l,Sf,g);const p=o(l*l),d=o(p-Kf),A=o(n*p-s);let{isValid:w,value:m}=c(d,A);if(!w)throw Error("Point.fromHex: invalid y coordinate");const b=(m&Kf)===Kf,k=!!(128&f);if(!i&&m===Sf&&k)throw Error("Point.fromHex: x=0 and x_0=1");return k!==b&&(m=o(-m)),y.fromAffine({x:m,y:l})}static fromPrivateScalar(e){return y.BASE.multiply(e)}toBytes(){const{x:e,y:t}=this.toAffine(),i=ch(t,r.BYTES);return i[i.length-1]|=e&Kf?128:0,i}toRawBytes(){return this.toBytes()}toHex(){return Nc(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}y.BASE=new y(e.Gx,e.Gy,Kf,o(e.Gx*e.Gy)),y.ZERO=new y(Sf,Kf,Kf,Sf),y.Fp=r,y.Fn=i;const g=xu(y,8*i.BYTES);return y}function xf(e,t){yh(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r,hash:i}=t,{BASE:n,Fp:s,Fn:a}=e,o=a.ORDER,c=t.randomBytes||$c,h=t.adjustScalarBytes||(e=>e),u=t.domain||((e,t,r)=>{if(rh("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function f(e){return a.create(e)}function l(e){return f(ah(e))}function y(e){const{head:t,prefix:r,scalar:a}=function(e){const t=s.BYTES;e=hh("private key",e,t);const r=hh("hashed private key",i(e),2*t),n=h(r.slice(0,t));return{head:n,prefix:r.slice(t,2*t),scalar:l(n)}}(e),o=n.multiply(a),c=o.toBytes();return{head:t,prefix:r,scalar:a,point:o,pointBytes:c}}function g(e=Uint8Array.of(),...t){const n=Yc(...t);return l(i(u(n,hh("context",e),!!r)))}const p=Uf;return n.precompute(8),{getPublicKey:function(e){return y(e).pointBytes},sign:function(e,t,i={}){e=hh("message",e),r&&(e=r(e));const{prefix:a,scalar:c,pointBytes:h}=y(t),u=g(i.context,a,e),l=n.multiply(u).toBytes(),p=f(u+g(i.context,l,h,e)*c);fh("signature.s",p,Sf,o);const d=s.BYTES;return hh("result",Yc(l,ch(p,d)),2*d)},verify:function(t,i,a,o=p){const{context:c,zip215:h}=o,u=s.BYTES;t=hh("signature",t,2*u),i=hh("message",i),a=hh("publicKey",a,u),void 0!==h&&rh("zip215",h),r&&(i=r(i));const f=ah(t.slice(u,2*u));let l,y,d;try{l=e.fromHex(a,h),y=e.fromHex(t.slice(0,u),h),d=n.multiplyUnsafe(f)}catch(e){return!1}if(!h&&l.isSmallOrder())return!1;const A=g(c,y.toBytes(),l.toBytes(),i);return y.add(l.multiplyUnsafe(A)).subtract(d).clearCofactor().is0()},utils:{getExtendedPublicKey:y,randomPrivateKey:()=>c(s.BYTES),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},Point:e}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qf=BigInt(0),Rf=BigInt(1),Tf=BigInt(2);function Mf(e){const t=(yh(r=e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r}));var r;const{P:i,type:n,adjustScalarBytes:s,powPminus2:a,randomBytes:o}=t,c="x25519"===n;if(!c&&"x448"!==n)throw Error("invalid type");const h=o||$c,u=c?255:448,f=c?32:56,l=c?BigInt(9):BigInt(5),y=c?BigInt(121665):BigInt(39081),g=c?Tf**BigInt(254):Tf**BigInt(447),p=c?BigInt(8)*Tf**BigInt(251)-Rf:BigInt(4)*Tf**BigInt(445)-Rf,d=g+p+Rf,A=e=>Eh(e,i),w=m(l);function m(e){return ch(A(e),f)}function b(e,t){const r=function(e,t){fh("u",e,Qf,i),fh("scalar",t,g,d);const r=t,n=e;let s=Rf,o=Qf,c=e,h=Rf,f=Qf;for(let i=BigInt(u-1);i>=Qf;i--){const e=r>>i&Rf;f^=e,({x_2:s,x_3:c}=E(f,s,c)),({x_2:o,x_3:h}=E(f,o,h)),f=e;const t=s+o,a=A(t*t),u=s-o,l=A(u*u),g=a-l,p=c+h,d=A((c-h)*t),w=A(p*u),m=d+w,b=d-w;c=A(m*m),h=A(n*A(b*b)),s=A(a*l),o=A(g*(a+A(y*g)))}({x_2:s,x_3:c}=E(f,s,c)),({x_2:o,x_3:h}=E(f,o,h));const l=a(o);return A(s*l)}(function(e){const t=hh("u coordinate",e,f);return c&&(t[31]&=127),A(ah(t))}(t),function(e){return ah(s(hh("scalar",e,f)))}(e));if(r===Qf)throw Error("invalid private or public key received");return m(r)}function k(e){return b(e,w)}function E(e,t,r){const i=A(e*(t-r));return{x_2:t=A(t-i),x_3:r=A(r+i)}}return{scalarMult:b,scalarMultBase:k,getSharedSecret:(e,t)=>b(e,t),getPublicKey:e=>k(e),utils:{randomPrivateKey:()=>h(f)},GuBytes:w.slice()}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ff={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")};Pf(Object.assign({},Ff,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}));const Nf=Wc(()=>Bf.create({dkLen:114})),Lf=BigInt(1),Of=BigInt(2),Hf=BigInt(3);BigInt(4);const zf=BigInt(11),Gf=BigInt(22),_f=BigInt(44),jf=BigInt(88),qf=BigInt(223);function Vf(e){const t=Ff.p,r=e*e*e%t,i=r*r*e%t,n=vh(i,Hf,t)*i%t,s=vh(n,Hf,t)*i%t,a=vh(s,Of,t)*r%t,o=vh(a,zf,t)*a%t,c=vh(o,Gf,t)*o%t,h=vh(c,_f,t)*c%t,u=vh(h,jf,t)*h%t,f=vh(u,_f,t)*c%t,l=vh(f,Of,t)*r%t,y=vh(l,Lf,t)*e%t;return vh(y,qf,t)*l%t}function Jf(e){return e[0]&=252,e[55]|=128,e[56]=0,e}function Yf(e,t){const r=Ff.p,i=Eh(e*e*t,r),n=Eh(i*e,r),s=Eh(n*i*t,r),a=Eh(n*Vf(s),r),o=Eh(a*a,r);return{isValid:Eh(o*t,r)===e,value:a}}const Zf=(()=>Ph(Ff.p,456,!0))(),Wf=function(e){const{CURVE:t,curveOpts:r,eddsaOpts:i}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:Ph(t.n,e.nBitLength,!0),uvRatio:e.uvRatio},eddsaOpts:{hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve}}}(e);return function(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}(e,xf(Pf(t,r),i))}((()=>({...Ff,Fp:Zf,nBitLength:456,hash:Nf,adjustScalarBytes:Jf,domain:(e,t,r)=>{if(t.length>255)throw Error("context must be smaller than 255, got: "+t.length);return Yc(Vc("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)},uvRatio:Yf}))()),Xf=(()=>{const e=Ff.p;return Mf({P:e,type:"x448",powPminus2:t=>Eh(vh(Vf(t),Of,e)*t,e),adjustScalarBytes:Jf})})(),$f={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);const el=BigInt(1),tl=BigInt(2),rl=(e,t)=>(e+t/tl)/t,il=Ph($f.p,void 0,void 0,{sqrt:function(e){const t=$f.p,r=BigInt(3),i=BigInt(6),n=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),h=e*e*e%t,u=h*h*e%t,f=vh(u,r,t)*u%t,l=vh(f,r,t)*u%t,y=vh(l,tl,t)*h%t,g=vh(y,n,t)*y%t,p=vh(g,s,t)*g%t,d=vh(p,o,t)*p%t,A=vh(d,c,t)*d%t,w=vh(A,o,t)*p%t,m=vh(w,r,t)*u%t,b=vh(m,a,t)*g%t,k=vh(b,i,t)*h%t,E=vh(k,tl,t);if(!il.eql(il.sqr(E),e))throw Error("Cannot find square root");return E}}),nl=Yu({...$f,Fp:il,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=$f.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-el*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=rl(s*e,t),c=rl(-i*e,t);let h=Eh(e-o*r-c*n,t),u=Eh(-o*i-c*s,t);const f=h>a,l=u>a;if(f&&(h=t-h),l&&(u=t-u),h>a||u>a)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:h,k2neg:l,k2:u}}}},pu),sl=pu,al=du,ol=Ph(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),cl=Yu({a:ol.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:ol,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},sl),hl=Au,ul=wu,fl=Ph(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),ll=Yu({a:fl.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:fl,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},ul),yl=Ph(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),gl=Yu({a:yl.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:yl,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},hl),pl=new Map(Object.entries({nistP256:rf,nistP384:nf,nistP521:sf,brainpoolP256r1:cl,brainpoolP384r1:ll,brainpoolP512r1:gl,secp256k1:nl,x448:Xf,ed448:Wf}));var dl=Object.freeze({__proto__:null,nobleCurves:pl});const Al=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),wl=new Uint32Array(80);class ml extends Mh{constructor(){super(64,20,8,!1),this.A=0|Al[0],this.B=0|Al[1],this.C=0|Al[2],this.D=0|Al[3],this.E=0|Al[4]}get(){const{A:e,B:t,C:r,D:i,E:n}=this;return[e,t,r,i,n]}set(e,t,r,i,n){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n}process(e,t){for(let o=0;o<16;o++,t+=4)wl[o]=e.getUint32(t,!1);for(let o=16;o<80;o++)wl[o]=Rc(wl[o-3]^wl[o-8]^wl[o-14]^wl[o-16],1);let{A:r,B:i,C:n,D:s,E:a}=this;for(let o=0;o<80;o++){let e,t;o<20?(e=Rh(i,n,s),t=1518500249):o<40?(e=i^n^s,t=1859775393):o<60?(e=Th(i,n,s),t=2400959708):(e=i^n^s,t=3395469782);const c=Rc(r,5)+e+a+t+wl[o]|0;a=s,s=n,n=Rc(i,30),i=r,r=c}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,s=s+this.D|0,a=a+this.E|0,this.set(r,i,n,s,a)}roundClean(){Pc(wl)}destroy(){this.set(0,0,0,0,0),Pc(this.buffer)}}const bl=Wc(()=>new ml),kl=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),El=(()=>Uint8Array.from(Array(16).fill(0).map((e,t)=>t)))(),vl=(()=>El.map(e=>(9*e+5)%16))(),Il=(()=>{const e=[[El],[vl]];for(let t=0;t<4;t++)for(let r of e)r.push(r[t].map(e=>kl[e]));return e})(),Bl=(()=>Il[0])(),Sl=(()=>Il[1])(),Kl=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),Cl=Bl.map((e,t)=>e.map(e=>Kl[t][e])),Dl=Sl.map((e,t)=>e.map(e=>Kl[t][e])),Ul=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Pl=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function xl(e,t,r,i){return 0===e?t^r^i:1===e?t&r|~t&i:2===e?(t|~r)^i:3===e?t&i|r&~i:t^(r|~i)}const Ql=new Uint32Array(16);class Rl extends Mh{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:i,h4:n}=this;return[e,t,r,i,n]}set(e,t,r,i,n){this.h0=0|e,this.h1=0|t,this.h2=0|r,this.h3=0|i,this.h4=0|n}process(e,t){for(let l=0;l<16;l++,t+=4)Ql[l]=e.getUint32(t,!0);let r=0|this.h0,i=r,n=0|this.h1,s=n,a=0|this.h2,o=a,c=0|this.h3,h=c,u=0|this.h4,f=u;for(let l=0;l<5;l++){const e=4-l,t=Ul[l],y=Pl[l],g=Bl[l],p=Sl[l],d=Cl[l],A=Dl[l];for(let i=0;i<16;i++){const e=Rc(r+xl(l,n,a,c)+Ql[g[i]]+t,d[i])+u|0;r=u,u=c,c=0|Rc(a,10),a=n,n=e}for(let r=0;r<16;r++){const t=Rc(i+xl(e,s,o,h)+Ql[p[r]]+y,A[r])+f|0;i=f,f=h,h=0|Rc(o,10),o=s,s=t}}this.set(this.h1+a+h|0,this.h2+c+f|0,this.h3+u+i|0,this.h4+r+s|0,this.h0+n+o|0)}roundClean(){Pc(Ql)}destroy(){this.destroyed=!0,Pc(this.buffer),this.set(0,0,0,0,0)}}const Tl=bl,Ml=Wc(()=>new Rl),Fl=Array.from({length:64},(e,t)=>Math.floor(2**32*Math.abs(Math.sin(t+1)))),Nl=(e,t,r)=>e&t^~e&r,Ll=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Ol=new Uint32Array(16);class Hl extends Mh{constructor(){super(64,16,8,!0),this.A=0|Ll[0],this.B=0|Ll[1],this.C=0|Ll[2],this.D=0|Ll[3]}get(){const{A:e,B:t,C:r,D:i}=this;return[e,t,r,i]}set(e,t,r,i){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i}process(e,t){for(let a=0;a<16;a++,t+=4)Ol[a]=e.getUint32(t,!0);let{A:r,B:i,C:n,D:s}=this;for(let a=0;a<64;a++){let e,t,o;a<16?(e=Nl(i,n,s),t=a,o=[7,12,17,22]):a<32?(e=Nl(s,i,n),t=(5*a+1)%16,o=[5,9,14,20]):a<48?(e=i^n^s,t=(3*a+5)%16,o=[4,11,16,23]):(e=n^(i|~s),t=7*a%16,o=[6,10,15,21]),e=e+r+Fl[a]+Ol[t],r=s,s=n,n=i,i+=Rc(e,o[a%4])}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,s=s+this.D|0,this.set(r,i,n,s)}roundClean(){Ol.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const zl=new Map(Object.entries({md5:Xc(()=>new Hl),sha1:Tl,sha224:al,sha256:sl,sha384:ul,sha512:hl,sha3_256:Ef,sha3_512:vf,ripemd160:Ml}));var Gl=Object.freeze({__proto__:null,nobleHashes:zl});function _l(e,t,r,i,n,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],h=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],l=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let g,p,d,A,w,m,b,k,E,v,I=0,B=t.length;const S=32===e.length?3:9;k=3===S?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(t=function(e){const t=8-e.length%8;let r;if(!(t<8)){if(8===t)return e;throw Error("des: invalid padding")}r=0;const i=new Uint8Array(e.length+t);for(let n=0;n<e.length;n++)i[n]=e[n];for(let n=0;n<t;n++)i[e.length+n]=r;return i}(t),B=t.length);let K=new Uint8Array(B),C=0;for(;I<B;){for(m=t[I++]<<24|t[I++]<<16|t[I++]<<8|t[I++],b=t[I++]<<24|t[I++]<<16|t[I++]<<8|t[I++],d=252645135&(m>>>4^b),b^=d,m^=d<<4,d=65535&(m>>>16^b),b^=d,m^=d<<16,d=858993459&(b>>>2^m),m^=d,b^=d<<2,d=16711935&(b>>>8^m),m^=d,b^=d<<8,d=1431655765&(m>>>1^b),b^=d,m^=d<<1,m=m<<1|m>>>31,b=b<<1|b>>>31,p=0;p<S;p+=3){for(E=k[p+1],v=k[p+2],g=k[p];g!==E;g+=v)A=b^e[g],w=(b>>>4|b<<28)^e[g+1],d=m,m=b,b=d^(o[A>>>24&63]|h[A>>>16&63]|f[A>>>8&63]|y[63&A]|a[w>>>24&63]|c[w>>>16&63]|u[w>>>8&63]|l[63&w]);d=m,m=b,b=d}m=m>>>1|m<<31,b=b>>>1|b<<31,d=1431655765&(m>>>1^b),b^=d,m^=d<<1,d=16711935&(b>>>8^m),m^=d,b^=d<<8,d=858993459&(b>>>2^m),m^=d,b^=d<<2,d=65535&(m>>>16^b),b^=d,m^=d<<16,d=252645135&(m>>>4^b),b^=d,m^=d<<4,K[C++]=m>>>24,K[C++]=m>>>16&255,K[C++]=m>>>8&255,K[C++]=255&m,K[C++]=b>>>24,K[C++]=b>>>16&255,K[C++]=b>>>8&255,K[C++]=255&b}return r||(K=function(e){let t,r=null;if(t=0,!r){for(r=1;e[e.length-r]===t;)r++;r--}return e.subarray(0,e.length-r)}(K)),K}function jl(e){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],h=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=e.length>8?3:1,d=Array(32*p),A=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let w,m,b,k=0,E=0;for(let v=0;v<p;v++){let p=e[k++]<<24|e[k++]<<16|e[k++]<<8|e[k++],v=e[k++]<<24|e[k++]<<16|e[k++]<<8|e[k++];b=252645135&(p>>>4^v),v^=b,p^=b<<4,b=65535&(v>>>-16^p),p^=b,v^=b<<-16,b=858993459&(p>>>2^v),v^=b,p^=b<<2,b=65535&(v>>>-16^p),p^=b,v^=b<<-16,b=1431655765&(p>>>1^v),v^=b,p^=b<<1,b=16711935&(v>>>8^p),p^=b,v^=b<<8,b=1431655765&(p>>>1^v),v^=b,p^=b<<1,b=p<<8|v>>>20&240,p=v<<24|v<<8&16711680|v>>>8&65280|v>>>24&240,v=b;for(let e=0;e<16;e++)A[e]?(p=p<<2|p>>>26,v=v<<2|v>>>26):(p=p<<1|p>>>27,v=v<<1|v>>>27),p&=-15,v&=-15,w=t[p>>>28]|r[p>>>24&15]|i[p>>>20&15]|n[p>>>16&15]|s[p>>>12&15]|a[p>>>8&15]|o[p>>>4&15],m=c[v>>>28]|h[v>>>24&15]|u[v>>>20&15]|f[v>>>16&15]|l[v>>>12&15]|y[v>>>8&15]|g[v>>>4&15],b=65535&(m>>>16^w),d[E++]=w^b,d[E++]=m^b<<16}return d}function ql(e){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(e.subarray(8*t,8*t+8)));this.encrypt=function(e){return _l(jl(this.key[2]),_l(jl(this.key[1]),_l(jl(this.key[0]),e,!0),!1),!0)}}function Vl(){this.BlockSize=8,this.KeySize=16,this.setKey=function(e){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),e.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(e),!0},this.reset=function(){for(let e=0;e<16;e++)this.masking[e]=0,this.rotate[e]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,a=c,c=o^i(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^n(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^i(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^n(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^i(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^n(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^i(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^n(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^i(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^n(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>>16&255,t[s+6]=o>>>8&255,t[s+7]=255&o}return t},this.decrypt=function(e){const t=Array(e.length);for(let s=0;s<e.length;s+=8){let a,o=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],c=e[s+4]<<24|e[s+5]<<16|e[s+6]<<8|e[s+7];a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,a=c,c=o^n(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^i(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^n(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^i(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^n(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^i(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^n(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^i(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^n(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^i(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,t[s]=c>>>24&255,t[s+1]=c>>>16&255,t[s+2]=c>>>8&255,t[s+3]=255&c,t[s+4]=o>>>24&255,t[s+5]=o>>16&255,t[s+6]=o>>8&255,t[s+7]=255&o}return t};const e=[,,,,];e[0]=[,,,,],e[0][0]=[4,0,13,15,12,14,8],e[0][1]=[5,2,16,18,17,19,10],e[0][2]=[6,3,23,22,21,20,9],e[0][3]=[7,1,26,25,27,24,11],e[1]=[,,,,],e[1][0]=[0,6,21,23,20,22,16],e[1][1]=[1,4,0,2,1,3,18],e[1][2]=[2,5,7,6,5,4,17],e[1][3]=[3,7,10,9,11,8,19],e[2]=[,,,,],e[2][0]=[4,0,13,15,12,14,8],e[2][1]=[5,2,16,18,17,19,10],e[2][2]=[6,3,23,22,21,20,9],e[2][3]=[7,1,26,25,27,24,11],e[3]=[,,,,],e[3][0]=[0,6,21,23,20,22,16],e[3][1]=[1,4,0,2,1,3,18],e[3][2]=[2,5,7,6,5,4,17],e[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function r(e,t,r){const i=t+e,n=i<<r|i>>>32-r;return(s[0][n>>>24]^s[1][n>>>16&255])-s[2][n>>>8&255]+s[3][255&n]}function i(e,t,r){const i=t^e,n=i<<r|i>>>32-r;return s[0][n>>>24]-s[1][n>>>16&255]+s[2][n>>>8&255]^s[3][255&n]}function n(e,t,r){const i=t-e,n=i<<r|i>>>32-r;return(s[0][n>>>24]+s[1][n>>>16&255]^s[2][n>>>8&255])-s[3][255&n]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(r){const i=[,,,,,,,,],n=Array(32);let a;for(let e=0;e<4;e++)a=4*e,i[e]=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3];const o=[6,7,4,5];let c,h=0;for(let u=0;u<2;u++)for(let r=0;r<4;r++){for(a=0;a<4;a++){const t=e[r][a];c=i[t[1]],c^=s[4][i[t[2]>>>2]>>>24-8*(3&t[2])&255],c^=s[5][i[t[3]>>>2]>>>24-8*(3&t[3])&255],c^=s[6][i[t[4]>>>2]>>>24-8*(3&t[4])&255],c^=s[7][i[t[5]>>>2]>>>24-8*(3&t[5])&255],c^=s[o[a]][i[t[6]>>>2]>>>24-8*(3&t[6])&255],i[t[0]]=c}for(a=0;a<4;a++){const e=t[r][a];c=s[4][i[e[0]>>>2]>>>24-8*(3&e[0])&255],c^=s[5][i[e[1]>>>2]>>>24-8*(3&e[1])&255],c^=s[6][i[e[2]>>>2]>>>24-8*(3&e[2])&255],c^=s[7][i[e[3]>>>2]>>>24-8*(3&e[3])&255],c^=s[4+a][i[e[4]>>>2]>>>24-8*(3&e[4])&255],n[h]=c,h++}}for(let e=0;e<16;e++)this.masking[e]=n[e],this.rotate[e]=31&n[16+e]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Jl(e){this.cast5=new Vl,this.cast5.setKey(e),this.encrypt=function(e){return this.cast5.encrypt(e)}}ql.keySize=ql.prototype.keySize=24,ql.blockSize=ql.prototype.blockSize=8,Jl.blockSize=Jl.prototype.blockSize=8,Jl.keySize=Jl.prototype.keySize=16;const Yl=4294967295;function Zl(e,t){return(e<<t|e>>>32-t)&Yl}function Wl(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function Xl(e,t,r){e.splice(t,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function $l(e,t){return e>>>8*t&255}function ey(e){this.tf=function(){let e=null,t=null,r=-1,i=[],n=[[],[],[],[]];function s(e){return n[0][$l(e,0)]^n[1][$l(e,1)]^n[2][$l(e,2)]^n[3][$l(e,3)]}function a(e){return n[0][$l(e,3)]^n[1][$l(e,0)]^n[2][$l(e,1)]^n[3][$l(e,2)]}function o(e,t){let r=s(t[0]),n=a(t[1]);t[2]=Zl(t[2]^r+n+i[4*e+8]&Yl,31),t[3]=Zl(t[3],1)^r+2*n+i[4*e+9]&Yl,r=s(t[2]),n=a(t[3]),t[0]=Zl(t[0]^r+n+i[4*e+10]&Yl,31),t[1]=Zl(t[1],1)^r+2*n+i[4*e+11]&Yl}function c(e,t){let r=s(t[0]),n=a(t[1]);t[2]=Zl(t[2],1)^r+n+i[4*e+10]&Yl,t[3]=Zl(t[3]^r+2*n+i[4*e+11]&Yl,31),r=s(t[2]),n=a(t[3]),t[0]=Zl(t[0],1)^r+n+i[4*e+8]&Yl,t[1]=Zl(t[1]^r+2*n+i[4*e+9]&Yl,31)}return{name:"twofish",blocksize:16,open:function(t){let r,s,a,o,c;e=t;const h=[],u=[],f=[];let l;const y=[];let g,p,d;const A=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],w=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],m=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],b=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],k=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],E=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],v=[[],[]],I=[[],[],[],[]];function B(e){return e^e>>2^[0,90,180,238][3&e]}function S(e){return e^e>>1^e>>2^[0,238,180,90][3&e]}function K(e,t){let r,i,n;for(r=0;r<8;r++)i=t>>>24,t=t<<8&Yl|e>>>24,e=e<<8&Yl,n=i<<1,128&i&&(n^=333),t^=i^n<<16,n^=i>>>1,1&i&&(n^=166),t^=n<<24|n<<8;return t}function C(e,t){const r=t>>4,i=15&t,n=A[e][r^i],s=w[e][k[i]^E[r]];return b[e][k[s]^E[n]]<<4|m[e][n^s]}function D(e,t){let r=$l(e,0),i=$l(e,1),n=$l(e,2),s=$l(e,3);switch(l){case 4:r=v[1][r]^$l(t[3],0),i=v[0][i]^$l(t[3],1),n=v[0][n]^$l(t[3],2),s=v[1][s]^$l(t[3],3);case 3:r=v[1][r]^$l(t[2],0),i=v[1][i]^$l(t[2],1),n=v[0][n]^$l(t[2],2),s=v[0][s]^$l(t[2],3);case 2:r=v[0][v[0][r]^$l(t[1],0)]^$l(t[0],0),i=v[0][v[1][i]^$l(t[1],1)]^$l(t[0],1),n=v[1][v[0][n]^$l(t[1],2)]^$l(t[0],2),s=v[1][v[1][s]^$l(t[1],3)]^$l(t[0],3)}return I[0][r]^I[1][i]^I[2][n]^I[3][s]}for(e=e.slice(0,32),r=e.length;16!==r&&24!==r&&32!==r;)e[r++]=0;for(r=0;r<e.length;r+=4)f[r>>2]=Wl(e,r);for(r=0;r<256;r++)v[0][r]=C(0,r),v[1][r]=C(1,r);for(r=0;r<256;r++)g=v[1][r],p=B(g),d=S(g),I[0][r]=g+(p<<8)+(d<<16)+(d<<24),I[2][r]=p+(d<<8)+(g<<16)+(d<<24),g=v[0][r],p=B(g),d=S(g),I[1][r]=d+(d<<8)+(p<<16)+(g<<24),I[3][r]=p+(g<<8)+(d<<16)+(p<<24);for(l=f.length/2,r=0;r<l;r++)s=f[r+r],h[r]=s,a=f[r+r+1],u[r]=a,y[l-r-1]=K(s,a);for(r=0;r<40;r+=2)s=16843009*r,a=s+16843009,s=D(s,h),a=Zl(D(a,u),8),i[r]=s+a&Yl,i[r+1]=Zl(s+2*a,9);for(r=0;r<256;r++)switch(s=a=o=c=r,l){case 4:s=v[1][s]^$l(y[3],0),a=v[0][a]^$l(y[3],1),o=v[0][o]^$l(y[3],2),c=v[1][c]^$l(y[3],3);case 3:s=v[1][s]^$l(y[2],0),a=v[1][a]^$l(y[2],1),o=v[0][o]^$l(y[2],2),c=v[0][c]^$l(y[2],3);case 2:n[0][r]=I[0][v[0][v[0][s]^$l(y[1],0)]^$l(y[0],0)],n[1][r]=I[1][v[0][v[1][a]^$l(y[1],1)]^$l(y[0],1)],n[2][r]=I[2][v[1][v[0][o]^$l(y[1],2)]^$l(y[0],2)],n[3][r]=I[3][v[1][v[1][c]^$l(y[1],3)]^$l(y[0],3)]}},close:function(){i=[],n=[[],[],[],[]]},encrypt:function(e,n){t=e,r=n;const s=[Wl(t,r)^i[0],Wl(t,r+4)^i[1],Wl(t,r+8)^i[2],Wl(t,r+12)^i[3]];for(let t=0;t<8;t++)o(t,s);return Xl(t,r,s[2]^i[4]),Xl(t,r+4,s[3]^i[5]),Xl(t,r+8,s[0]^i[6]),Xl(t,r+12,s[1]^i[7]),r+=16,t},decrypt:function(e,n){t=e,r=n;const s=[Wl(t,r)^i[4],Wl(t,r+4)^i[5],Wl(t,r+8)^i[6],Wl(t,r+12)^i[7]];for(let t=7;t>=0;t--)c(t,s);Xl(t,r,s[2]^i[0]),Xl(t,r+4,s[3]^i[1]),Xl(t,r+8,s[0]^i[2]),Xl(t,r+12,s[1]^i[3]),r+=16},finalize:function(){return t}}}(),this.tf.open(Array.from(e),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function ty(){}function ry(e){this.bf=new ty,this.bf.init(e),this.encrypt=function(e){return this.bf.encryptBlock(e)}}ey.keySize=ey.prototype.keySize=32,ey.blockSize=ey.prototype.blockSize=16,ty.prototype.BLOCKSIZE=8,ty.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],ty.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],ty.prototype.NN=16,ty.prototype._clean=function(e){return e<0&&(e=2147483648+(2147483647&e)),e},ty.prototype._F=function(e){let t;const r=255&e,i=255&(e>>>=8),n=255&(e>>>=8),s=255&(e>>>=8);return t=this.sboxes[0][s]+this.sboxes[1][n],t^=this.sboxes[2][i],t+=this.sboxes[3][r],t},ty.prototype._encryptBlock=function(e){let t,r=e[0],i=e[1];for(t=0;t<this.NN;++t){r^=this.parray[t],i=this._F(r)^i;const e=r;r=i,i=e}r^=this.parray[this.NN+0],i^=this.parray[this.NN+1],e[0]=this._clean(i),e[1]=this._clean(r)},ty.prototype.encryptBlock=function(e){let t;const r=[0,0],i=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)r[0]=r[0]<<8|255&e[t+0],r[1]=r[1]<<8|255&e[t+i];this._encryptBlock(r);const n=[];for(t=0;t<this.BLOCKSIZE/2;++t)n[t+0]=r[0]>>>24-8*t&255,n[t+i]=r[1]>>>24-8*t&255;return n},ty.prototype._decryptBlock=function(e){let t,r=e[0],i=e[1];for(t=this.NN+1;t>1;--t){r^=this.parray[t],i=this._F(r)^i;const e=r;r=i,i=e}r^=this.parray[1],i^=this.parray[0],e[0]=this._clean(i),e[1]=this._clean(r)},ty.prototype.init=function(e){let t,r=0;for(this.parray=[],t=0;t<this.NN+2;++t){let i=0;for(let t=0;t<4;++t)i=i<<8|255&e[r],++r>=e.length&&(r=0);this.parray[t]=this.PARRAY[t]^i}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],r=0;r<256;++r)this.sboxes[t][r]=this.SBOXES[t][r];const i=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(i),this.parray[t+0]=i[0],this.parray[t+1]=i[1];for(t=0;t<4;++t)for(r=0;r<256;r+=2)this._encryptBlock(i),this.sboxes[t][r+0]=i[0],this.sboxes[t][r+1]=i[1]},ry.keySize=ry.prototype.keySize=16,ry.blockSize=ry.prototype.blockSize=8;const iy=new Map(Object.entries({tripledes:ql,cast5:Jl,twofish:ey,blowfish:ry}));var ny=Object.freeze({__proto__:null,legacyCiphers:iy});function sy(e,t,r,i){e[t]+=r[i],e[t+1]+=r[i+1]+(e[t]<r[i])}function ay(e,t){e[0]+=t,e[1]+=e[0]<t}function oy(e,t,r,i,n,s,a,o){sy(e,r,e,i),sy(e,r,t,a);let c=e[s]^e[r],h=e[s+1]^e[r+1];e[s]=h,e[s+1]=c,sy(e,n,e,s),c=e[i]^e[n],h=e[i+1]^e[n+1],e[i]=c>>>24^h<<8,e[i+1]=h>>>24^c<<8,sy(e,r,e,i),sy(e,r,t,o),c=e[s]^e[r],h=e[s+1]^e[r+1],e[s]=c>>>16^h<<16,e[s+1]=h>>>16^c<<16,sy(e,n,e,s),c=e[i]^e[n],h=e[i+1]^e[n+1],e[i]=h>>>31^c<<1,e[i+1]=c>>>31^h<<1}const cy=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),hy=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(e=>2*e));function uy(e,t){const r=new Uint32Array(32),i=new Uint32Array(e.b.buffer,e.b.byteOffset,32);for(let s=0;s<16;s++)r[s]=e.h[s],r[s+16]=cy[s];r[24]^=e.t0[0],r[25]^=e.t0[1];const n=t?4294967295:0;r[28]^=n,r[29]^=n;for(let s=0;s<12;s++){const e=s<<4;oy(r,i,0,8,16,24,hy[e+0],hy[e+1]),oy(r,i,2,10,18,26,hy[e+2],hy[e+3]),oy(r,i,4,12,20,28,hy[e+4],hy[e+5]),oy(r,i,6,14,22,30,hy[e+6],hy[e+7]),oy(r,i,0,10,20,30,hy[e+8],hy[e+9]),oy(r,i,2,12,22,24,hy[e+10],hy[e+11]),oy(r,i,4,14,16,26,hy[e+12],hy[e+13]),oy(r,i,6,8,18,28,hy[e+14],hy[e+15])}for(let s=0;s<16;s++)e.h[s]^=r[s]^r[s+16]}class fy{constructor(e,t,r,i){const n=new Uint8Array(64);this.S={b:new Uint8Array(gy),h:new Uint32Array(yy/4),t0:new Uint32Array(2),c:0,outlen:e},n[0]=e,t&&(n[1]=t.length),n[2]=1,n[3]=1,r&&n.set(r,32),i&&n.set(i,48);const s=new Uint32Array(n.buffer,n.byteOffset,n.length/Uint32Array.BYTES_PER_ELEMENT);for(let a=0;a<16;a++)this.S.h[a]=cy[a]^s[a];if(t){const e=new Uint8Array(gy);e.set(t),this.update(e)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let t=0;for(;t<e.length;){this.S.c===gy&&(ay(this.S.t0,this.S.c),uy(this.S,!1),this.S.c=0);let r=gy-this.S.c;this.S.b.set(e.subarray(t,t+r),this.S.c);const i=Math.min(r,e.length-t);this.S.c+=i,t+=i}return this}digest(e){ay(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=gy,uy(this.S,!0);const t=e||new Uint8Array(this.S.outlen);for(let r=0;r<this.S.outlen;r++)t[r]=this.S.h[r>>2]>>8*(3&r);return this.S.h=null,t.buffer}}function ly(e,t,r,i){if(e>yy)throw Error(`outlen must be at most ${yy} (given: ${e})`);return new fy(e,t,r,i)}const yy=64,gy=128,py=1024,dy=205===new Uint8Array(new Uint16Array([43981]).buffer)[0];function Ay(e,t,r){return e[r+0]=t,e[r+1]=t>>8,e[r+2]=t>>16,e[r+3]=t>>24,e}function wy(e,t,r){if(t>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let i=t;for(let n=r;n<r+7;n++)e[n]=i,i=(i-e[n])/256;return e}function my(e,t,r){const i=new Uint8Array(64),n=new Uint8Array(4+t.length);if(Ay(n,e,0),n.set(t,4),e<=64)return ly(e).update(n).digest(r),r;const s=Math.ceil(e/32)-2;for(let o=0;o<s;o++)ly(64).update(0===o?n:i).digest(i),r.set(i.subarray(0,32),32*o);const a=new Uint8Array(ly(e-32*s).update(i).digest());return r.set(a,32*s),r}function by(e,t,r,i){return e.fn.XOR(t.byteOffset,r.byteOffset,i.byteOffset),t}function ky(e,t,r,i){return e.fn.G(t.byteOffset,r.byteOffset,i.byteOffset,e.refs.gZ.byteOffset),i}function Ey(e,t,r,i){return e.fn.G2(t.byteOffset,r.byteOffset,i.byteOffset,e.refs.gZ.byteOffset),i}function*vy(e,t,r,i,n,s,a,o){e.refs.prngTmp.fill(0);const c=e.refs.prngTmp.subarray(0,48);wy(c,t,0),wy(c,r,8),wy(c,i,16),wy(c,n,24),wy(c,s,32),wy(c,2,40);for(let h=1;h<=a;h++){wy(e.refs.prngTmp,h,c.length);const t=Ey(e,e.refs.ZERO1024,e.refs.prngTmp,e.refs.prngR);for(let e=1===h?8*o:0;e<t.length;e+=8)yield t.subarray(e,e+8)}return[]}function Iy(e,{memory:t,instance:r}){if(!dy)throw Error("BigEndian system not supported");const i=function({type:e,version:t,tagLength:r,password:i,salt:n,ad:s,secret:a,parallelism:o,memorySize:c,passes:h}){const u=(e,t,r,i)=>{if(t<r||t>i)throw Error(`${e} size should be between ${r} and ${i} bytes`)};if(2!==e||19!==t)throw Error("Unsupported type or version");return u("password",i,8,4294967295),u("salt",n,8,4294967295),u("tag",r,4,4294967295),u("memory",c,8*o,4294967295),s&&u("associated data",s,0,4294967295),a&&u("secret",a,0,32),{type:e,version:t,tagLength:r,password:i,salt:n,ad:s,secret:a,lanes:o,memorySize:c,passes:h}}({type:2,version:19,...e}),{G:n,G2:s,xor:a,getLZ:o}=r.exports,c={},h={};h.G=n,h.G2=s,h.XOR=a;const u=4*i.lanes*Math.floor(i.memorySize/(4*i.lanes)),f=u*py+10240;if(t.buffer.byteLength<f){const e=Math.ceil((f-t.buffer.byteLength)/65536);t.grow(e)}let l=0;c.gZ=new Uint8Array(t.buffer,l,py),l+=c.gZ.length,c.prngR=new Uint8Array(t.buffer,l,py),l+=c.prngR.length,c.prngTmp=new Uint8Array(t.buffer,l,py),l+=c.prngTmp.length,c.ZERO1024=new Uint8Array(t.buffer,l,1024),l+=c.ZERO1024.length;const y=new Uint32Array(t.buffer,l,2);l+=y.length*Uint32Array.BYTES_PER_ELEMENT;const g={fn:h,refs:c},p=new Uint8Array(t.buffer,l,py);l+=p.length;const d=new Uint8Array(t.buffer,l,i.memorySize*py),A=new Uint8Array(t.buffer,0,l),w=function(e){const t=ly(64),r=new Uint8Array(4),i=new Uint8Array(24);Ay(i,e.lanes,0),Ay(i,e.tagLength,4),Ay(i,e.memorySize,8),Ay(i,e.passes,12),Ay(i,e.version,16),Ay(i,e.type,20);const n=[i];e.password?(n.push(Ay(new Uint8Array(4),e.password.length,0)),n.push(e.password)):n.push(r),e.salt?(n.push(Ay(new Uint8Array(4),e.salt.length,0)),n.push(e.salt)):n.push(r),e.secret?(n.push(Ay(new Uint8Array(4),e.secret.length,0)),n.push(e.secret)):n.push(r),e.ad?(n.push(Ay(new Uint8Array(4),e.ad.length,0)),n.push(e.ad)):n.push(r),t.update(function(e){if(1===e.length)return e[0];let t=0;for(let n=0;n<e.length;n++){if(!(e[n]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");t+=e[n].length}const r=new Uint8Array(t);let i=0;return e.forEach(e=>{r.set(e,i),i+=e.length}),r}(n));const s=t.digest();return new Uint8Array(s)}(i),m=u/i.lanes,b=Array(i.lanes).fill(null).map(()=>Array(m)),k=(e,t)=>(b[e][t]=d.subarray(e*m*1024+1024*t,e*m*1024+1024*t+py),b[e][t]);for(let B=0;B<i.lanes;B++){const e=new Uint8Array(w.length+8);e.set(w),Ay(e,0,w.length),Ay(e,B,w.length+4),my(py,e,k(B,0)),Ay(e,1,w.length),my(py,e,k(B,1))}const E=m/4;for(let B=0;B<i.passes;B++)for(let e=0;e<4;e++){const t=0===B&&e<=1;for(let r=0;r<i.lanes;r++){let n=0===e&&0===B?2:0;const s=t?vy(g,B,r,e,u,i.passes,E,n):null;for(;n<E;n++){const a=e*E+n,c=a>0?b[r][a-1]:b[r][m-1],h=t?s.next().value:c;o(y.byteOffset,h.byteOffset,r,i.lanes,B,e,n,4,E);const u=y[0],f=y[1];0===B&&k(r,a),ky(g,c,b[u][f],B>0?p:b[r][a]),B>0&&by(g,b[r][a],p,b[r][a])}}}const v=b[0][m-1];for(let B=1;B<i.lanes;B++)by(g,v,v,b[B][m-1]);const I=my(i.tagLength,v,new Uint8Array(i.tagLength));return A.fill(0),t.grow(0),I}let By;async function Sy(e,t){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),i=await async function(e,t,r){const i={env:{memory:e}};if(void 0===By)try{const e=await t(i);return By=!0,e}catch(e){By=!1}return(By?t:r)(i)}(r,e,t);return e=>Iy(e,{instance:i.instance,memory:r})}function Ky(e,t,r,n){var s=null,a=i.atob(r),o=a.length;s=new Uint8Array(new ArrayBuffer(o));for(var c=0;c<o;c++)s[c]=a.charCodeAt(c);return function(e,t,r){var i=r?WebAssembly.instantiateStreaming:WebAssembly.instantiate,n=r?WebAssembly.compileStreaming:WebAssembly.compile;return t?i(e,t):n(e)}(s,n,!1)}var Cy,Dy,Uy,Py,xy,Qy,Ry,Ty,My=Object.freeze({__proto__:null,default:async()=>Sy(e=>Ky(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",e),e=>Ky(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",e))});function Fy(){if(Dy)return Cy;Dy=1;var e=[0,1,3,7,15,31,63,127,255],t=function(e){this.stream=e,this.bitOffset=0,this.curByte=0,this.hasByte=!1};return t.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},t.prototype.read=function(t){for(var r=0;t>0;){this._ensureByte();var i=8-this.bitOffset;if(t>=i)r<<=i,r|=e[i]&this.curByte,this.hasByte=!1,this.bitOffset=0,t-=i;else{r<<=t;var n=i-t;r|=(this.curByte&e[t]<<n)>>n,this.bitOffset+=t,t=0}}return r},t.prototype.seek=function(e){var t=e%8,r=(e-t)/8;this.bitOffset=t,this.stream.seek(r),this.hasByte=!1},t.prototype.pi=function(){var e,t=new Uint8Array(6);for(e=0;e<t.length;e++)t[e]=this.read(8);return function(e){return Array.prototype.map.call(e,e=>("00"+e.toString(16)).slice(-2)).join("")}(t)},Cy=t}var Ny=function(){if(Ty)return Ry;Ty=1;var e,t=Fy(),r=function(){if(Py)return Uy;Py=1;var e=function(){};return e.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},e.prototype.read=function(e,t,r){for(var i=0;i<r;){var n=this.readByte();if(n<0)return 0===i?-1:i;e[t++]=n,i++}return i},e.prototype.seek=function(e){throw Error("abstract method seek() not implemented")},e.prototype.writeByte=function(e){throw Error("abstract method readByte() not implemented")},e.prototype.write=function(e,t,r){var i;for(i=0;i<r;i++)this.writeByte(e[t++]);return r},e.prototype.flush=function(){},Uy=e}(),i=Qy?xy:(Qy=1,e=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),xy=function(){var t=4294967295;this.getCRC=function(){return~t>>>0},this.updateCRC=function(r){t=t<<8^e[255&(t>>>24^r)]},this.updateCRCRun=function(r,i){for(;i-- >0;)t=t<<8^e[255&(t>>>24^r)]}}),n=function(e,t){var r,i=e[t];for(r=t;r>0;r--)e[r]=e[r-1];return e[0]=i,i},s={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},a={};a[s.LAST_BLOCK]="Bad file checksum",a[s.NOT_BZIP_DATA]="Not bzip data",a[s.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",a[s.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",a[s.DATA_ERROR]="Data error",a[s.OUT_OF_MEMORY]="Out of memory",a[s.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var o=function(e,t){var r=a[e]||"unknown error";t&&(r+=": "+t);var i=new TypeError(r);throw i.errorCode=e,i},c=function(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)};c.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new i,!0):(this.writeCount=-1,!1)},c.prototype._start_bunzip=function(e,r){var i=new Uint8Array(4);4===e.read(i,0,4)&&"BZh"===String.fromCharCode(i[0],i[1],i[2])||o(s.NOT_BZIP_DATA,"bad magic");var n=i[3]-48;(n<1||n>9)&&o(s.NOT_BZIP_DATA,"level out of range"),this.reader=new t(e),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=r,this.streamCRC=0},c.prototype._get_next_block=function(){var e,t,r,i=this.reader,a=i.pi();if("177245385090"===a)return!1;"314159265359"!==a&&o(s.NOT_BZIP_DATA),this.targetBlockCRC=i.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,i.read(1)&&o(s.OBSOLETE_INPUT);var c=i.read(24);c>this.dbufSize&&o(s.DATA_ERROR,"initial position out of bounds");var h=i.read(16),u=new Uint8Array(256),f=0;for(e=0;e<16;e++)if(h&1<<15-e){var l=16*e;for(r=i.read(16),t=0;t<16;t++)r&1<<15-t&&(u[f++]=l+t)}var y=i.read(3);(y<2||y>6)&&o(s.DATA_ERROR);var g=i.read(15);0===g&&o(s.DATA_ERROR);var p=new Uint8Array(256);for(e=0;e<y;e++)p[e]=e;var d=new Uint8Array(g);for(e=0;e<g;e++){for(t=0;i.read(1);t++)t>=y&&o(s.DATA_ERROR);d[e]=n(p,t)}var A,w=f+2,m=[];for(t=0;t<y;t++){var b,k,E=new Uint8Array(w),v=new Uint16Array(21);for(h=i.read(5),e=0;e<w;e++){for(;(h<1||h>20)&&o(s.DATA_ERROR),i.read(1);)i.read(1)?h--:h++;E[e]=h}for(b=k=E[0],e=1;e<w;e++)E[e]>k?k=E[e]:E[e]<b&&(b=E[e]);A={},m.push(A),A.permute=new Uint16Array(258),A.limit=new Uint32Array(22),A.base=new Uint32Array(21),A.minLen=b,A.maxLen=k;var I=0;for(e=b;e<=k;e++)for(v[e]=A.limit[e]=0,h=0;h<w;h++)E[h]===e&&(A.permute[I++]=h);for(e=0;e<w;e++)v[E[e]]++;for(I=h=0,e=b;e<k;e++)I+=v[e],A.limit[e]=I-1,I<<=1,h+=v[e],A.base[e+1]=I-h;A.limit[k+1]=Number.MAX_VALUE,A.limit[k]=I+v[k]-1,A.base[b]=0}var B=new Uint32Array(256);for(e=0;e<256;e++)p[e]=e;var S,K=0,C=0,D=0,U=this.dbuf=new Uint32Array(this.dbufSize);for(w=0;;){for(w--||(w=49,D>=g&&o(s.DATA_ERROR),A=m[d[D++]]),e=A.minLen,t=i.read(e);e>A.maxLen&&o(s.DATA_ERROR),!(t<=A.limit[e]);e++)t=t<<1|i.read(1);((t-=A.base[e])<0||t>=258)&&o(s.DATA_ERROR);var P=A.permute[t];if(0!==P&&1!==P){if(K)for(K=0,C+h>this.dbufSize&&o(s.DATA_ERROR),B[S=u[p[0]]]+=h;h--;)U[C++]=S;if(P>f)break;C>=this.dbufSize&&o(s.DATA_ERROR),B[S=u[S=n(p,e=P-1)]]++,U[C++]=S}else K||(K=1,h=0),h+=0===P?K:2*K,K<<=1}for((c<0||c>=C)&&o(s.DATA_ERROR),t=0,e=0;e<256;e++)r=t+B[e],B[e]=t,t=r;for(e=0;e<C;e++)U[B[S=255&U[e]]]|=e<<8,B[S]++;var x=0,Q=0,R=0;return C&&(Q=255&(x=U[c]),x>>=8,R=-1),this.writePos=x,this.writeCurrent=Q,this.writeCount=C,this.writeRun=R,!0},c.prototype._read_bunzip=function(e,t){var r,i,n;if(this.writeCount<0)return 0;var a=this.dbuf,c=this.writePos,h=this.writeCurrent,u=this.writeCount;this.outputsize;for(var f=this.writeRun;u;){for(u--,i=h,h=255&(c=a[c]),c>>=8,3==f++?(r=h,n=i,h=-1):(r=1,n=h),this.blockCRC.updateCRCRun(n,r);r--;)this.outputStream.writeByte(n),this.nextoutput++;h!=i&&(f=0)}return this.writeCount=u,this.blockCRC.getCRC()!==this.targetBlockCRC&&o(s.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var h=function(e){if("readByte"in e)return e;var t=new r;return t.pos=0,t.readByte=function(){return e[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=e.length},t},u=function(e){var t=new r,i=!0;if(e)if("number"==typeof e)t.buffer=new Uint8Array(e),i=!1;else{if("writeByte"in e)return e;t.buffer=e,i=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(e){if(i&&this.pos>=this.buffer.length){var t=new Uint8Array(2*this.buffer.length);t.set(this.buffer),this.buffer=t}this.buffer[this.pos++]=e},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!i)throw new TypeError("outputsize does not match decoded input");var e=new Uint8Array(this.pos);e.set(this.buffer.subarray(0,this.pos)),this.buffer=e}return this.buffer},t._coerced=!0,t};return Ry={Bunzip:c,Stream:r,Err:s,decode:function(e,t,r){for(var i=h(e),n=u(t),a=new c(i,n);!("eof"in i)||!i.eof();)if(a._init_block())a._read_bunzip();else{var f=a.reader.read(32)>>>0;if(f!==a.streamCRC&&o(s.DATA_ERROR,"Bad stream CRC (got "+a.streamCRC.toString(16)+" expected "+f.toString(16)+")"),!r||!("eof"in i)||i.eof())break;a._start_bunzip(i,n)}if("getBuffer"in n)return n.getBuffer()},decodeBlock:function(e,t,r){var n=h(e),s=u(r),a=new c(n,s);if(a.reader.seek(t),a._get_next_block()&&(a.blockCRC=new i,a.writeCopies=0,a._read_bunzip()),"getBuffer"in s)return s.getBuffer()},table:function(e,t,i){var n=new r;n.delegate=h(e),n.pos=0,n.readByte=function(){return this.pos++,this.delegate.readByte()},n.delegate.eof&&(n.eof=n.delegate.eof.bind(n.delegate));var s=new r;s.pos=0,s.writeByte=function(){this.pos++};for(var a=new c(n,s),o=a.dbufSize;!("eof"in n)||!n.eof();){var u=8*n.pos+a.reader.bitOffset;if(a.reader.hasByte&&(u-=8),a._init_block()){var f=s.pos;a._read_bunzip(),t(u,s.pos-f)}else{if(a.reader.read(32),!i||!("eof"in n)||n.eof())break;a._start_bunzip(n,s),console.assert(a.dbufSize===o,"shouldn't change block size within multistream file")}}}}}(),Ly=n({__proto__:null},[Ny])}}]);