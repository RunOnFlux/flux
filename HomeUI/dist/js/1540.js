"use strict";(self["webpackChunkflux"]=self["webpackChunkflux"]||[]).push([[1540],{34547:(e,t,a)=>{a.d(t,{Z:()=>d});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"toastification"},[t("div",{staticClass:"d-flex align-items-start"},[t("b-avatar",{staticClass:"mr-75 flex-shrink-0",attrs:{variant:e.variant,size:"1.8rem"}},[t("feather-icon",{attrs:{icon:e.icon,size:"15"}})],1),t("div",{staticClass:"d-flex flex-grow-1"},[t("div",[e.title?t("h5",{staticClass:"mb-0 font-weight-bolder toastification-title",class:`text-${e.variant}`,domProps:{textContent:e._s(e.title)}}):e._e(),e.text?t("small",{staticClass:"d-inline-block text-body",domProps:{textContent:e._s(e.text)}}):e._e()]),t("span",{staticClass:"cursor-pointer toastification-close-icon ml-auto",on:{click:function(t){return e.$emit("close-toast")}}},[e.hideClose?e._e():t("feather-icon",{staticClass:"text-body",attrs:{icon:"XIcon"}})],1)])],1)])},r=[],o=a(47389);const n={components:{BAvatar:o.SH},props:{variant:{type:String,default:"primary"},icon:{type:String,default:null},title:{type:String,default:null},text:{type:String,default:null},hideClose:{type:Boolean,default:!1}}},i=n;var l=a(1001),c=(0,l.Z)(i,s,r,!1,null,"22d964ca",null);const d=c.exports},1540:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Z});var s=function(){var e=this,t=e._self._c;return t("div",[t("h6",{staticClass:"mb-1"},[e._v(" Click the 'Download File' button to download the log. This may take a few minutes depending on file size. ")]),t("h6",{staticClass:"mb-1"},[e._v(" Click the 'Show File' button to view the last 100 lines of the log file. ")]),t("b-row",e._l(e.logTypes,(function(a){return t("b-col",{key:a},[t("b-card",{attrs:{title:`${e.capitalizeWord(a)} File`}},[t("div",[t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1",attrs:{id:`start-download-${a}`,variant:"outline-primary",size:"md",block:""}},[e._v(" Download File ")]),e.total[a]&&e.downloaded[a]?t("div",{staticClass:"d-flex",staticStyle:{width:"300px"}},[t("b-card-text",{staticClass:"mt-1 mb-0 mr-auto"},[e._v(" "+e._s(`${(e.downloaded[a]/1e6).toFixed(2)} / ${(e.total[a]/1e6).toFixed(2)}`)+" MB - "+e._s(`${(e.downloaded[a]/e.total[a]*100).toFixed(2)}%`)+" ")]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"btn-icon cancel-button",attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.cancelDownload(a)}}},[e._v(" x ")])],1):e._e(),t("b-popover",{ref:"popover",refInFor:!0,attrs:{target:`start-download-${a}`,triggers:"click",show:e.downloadPopoverShow[a],placement:"auto",container:"my-container"},on:{"update:show":function(t){return e.$set(e.downloadPopoverShow,a,t)}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("span",[e._v("Are You Sure?")]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"close",attrs:{variant:"transparent","aria-label":"Close"},on:{click:function(t){return e.onDownloadClose(a)}}},[t("span",{staticClass:"d-inline-block text-white",attrs:{"aria-hidden":"true"}},[e._v("×")])])],1)]},proxy:!0}],null,!0)},[t("div",[t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1",attrs:{size:"sm",variant:"danger"},on:{click:function(t){return e.onDownloadClose(a)}}},[e._v(" Cancel ")]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],attrs:{size:"sm",variant:"primary"},on:{click:function(t){return e.onDownloadOk(a)}}},[e._v(" Download "+e._s(e.capitalizeWord(a))+" ")])],1)]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1 mt-1",attrs:{id:`start-tail-${a}`,variant:"outline-primary",size:"md",block:""}},[e._v(" Show File ")]),t("b-popover",{ref:"popover",refInFor:!0,attrs:{target:`start-tail-${a}`,triggers:"click",show:e.tailPopoverShow[a],placement:"auto",container:"my-container"},on:{"update:show":function(t){return e.$set(e.tailPopoverShow,a,t)}},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("span",[e._v("Are You Sure?")]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"close",attrs:{variant:"transparent","aria-label":"Close"},on:{click:function(t){return e.onTailClose(a)}}},[t("span",{staticClass:"d-inline-block text-white",attrs:{"aria-hidden":"true"}},[e._v("×")])])],1)]},proxy:!0}],null,!0)},[t("div",[t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1",attrs:{size:"sm",variant:"danger"},on:{click:function(t){return e.onTailClose(a)}}},[e._v(" Cancel ")]),t("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],attrs:{size:"sm",variant:"primary"},on:{click:function(t){return e.onTailOk(a)}}},[e._v(" Show "+e._s(e.capitalizeWord(a))+" ")])],1)])],1)])],1)})),1),e.callResponse.data.message?t("b-card",[t("b-btn",{staticClass:"top-right",attrs:{variant:"danger"},on:{click:e.closeTextArea}},[t("b-icon",{attrs:{icon:"x"}})],1),t("b-form-textarea",{staticClass:"mt-1",attrs:{plaintext:"","no-resize":"",rows:"30",value:e.callResponse.data.message}})],1):e._e(),t("request-history")],1)},r=[],o=a(86855),n=a(50725),i=a(26253),l=a(15193),c=a(53862),d=a(333),u=a(64206),p=a(34547),h=function(){var e=this,t=e._self._c;return t("div",[t("b-card",[t("b-row",[t("b-col",{attrs:{align:"center"}},[e._v(" 1 Min Requests: "+e._s(e.oneMinuteRequests)+" ")]),t("b-col",{attrs:{align:"center"}},[e._v(" 5 Min Requests: "+e._s(e.fiveMinuteRequests)+" ")]),t("b-col",{attrs:{align:"center"}},[e._v(" 15 Min Requests: "+e._s(e.fifteenMinuteRequests)+" ")]),t("b-col",{attrs:{align:"center"}},[e._v(" Total Requests: "+e._s(e.totalRequests)+" ")])],1)],1),t("b-container",{staticClass:"p-0 wrapper",attrs:{fluid:""}},[t("b-table",{ref:"primaryTable",staticClass:"primary-table",attrs:{caption:"Outbound Requests","caption-top":"","table-variant":"secondary",items:e.primaryRows,fields:e.primaryFields,bordered:"",responsive:"","sticky-header":"100%","primary-key":"target",hover:"",fixed:"","no-border-collapse":"","show-empty":""},on:{"row-clicked":e.onRowClicked},scopedSlots:e._u([{key:"cell(lastSeen)",fn:function(t){return[e._v(" "+e._s(e.timestampToLastSeen(t.item.lastSeen))+" ")]}},{key:"row-details",fn:function({item:a}){return[t("b-table",{ref:`requestsTable_${a.target}`,attrs:{items:a.requests,fields:e.secondaryFields,"no-border-collapse":"",fixed:"",small:"","sticky-header":"400px","primary-key":"id"},scopedSlots:e._u([{key:"cell(timestamp)",fn:function(t){return[e._v(" "+e._s(new Date(t.item.timestamp).toISOString())+" ")]}}],null,!0)})]}}])})],1)],1)},m=[],g=(a(70560),a(62599));const f={components:{},data(){return{accessViaIp:!1,refreshTimer:null,socket:null,now:Date.now(),totalRequests:0,targets:{},primaryRows:[],secondaryRows:[],detailsRow:null,primaryFields:[{key:"target"},{key:"count",class:"small-col"},{key:"lastSeen",class:"small-col"}],secondaryFields:[{key:"verb"},{key:"params"},{key:"timeout"},{key:"timestamp"}]}},computed:{oneMinuteRequests(){const e=this.now-6e4;return this.requestsSinceTimestamp(e)},fiveMinuteRequests(){const e=this.now-3e5;return this.requestsSinceTimestamp(e)},fifteenMinuteRequests(){const e=this.now-9e5;return this.requestsSinceTimestamp(e)}},beforeMount(){const{hostname:e}=window.location;this.accessViaIp=!/[a-z]/i.test(e)},mounted(){!this.socket&&this.accessViaIp&&this.connectSocket(),this.refreshTimer=setInterval((()=>{this.now=Date.now()}),5e3)},unmounted(){this.socket&&this.socket.disconnect(),clearInterval(this.refreshTimer)},methods:{requestsSinceTimestamp(e){return Object.values(this.targets).flatMap((t=>t.filter((t=>t.timestamp>e)))).length},timestampToLastSeen(e){const t=Math.max(this.now-e,0),a=new Date(t).toISOString().substring(11,19);return a},generatePrimaryRow(e){const t=this.targets[e],a=t.length,{timestamp:s}=this.latestRequest(e),r={target:e,lastSeen:s,count:a,requests:t};return r},historyAddedHandler(e){this.primaryRows.length=0,this.targets=e,Object.keys(this.targets).forEach((e=>{this.primaryRows.push(this.generatePrimaryRow(e))})),this.totalRequests=Object.values(this.targets).reduce(((e,t)=>e+t.length),0)},requestAddedHandler(e){const{target:t,requestData:a}=e;t in this.targets||(this.targets[t]=[]),this.targets[t].push(a);const s=this.generatePrimaryRow(t),r=this.primaryRows.find((e=>e.target===t));r?(r.count=s.count,r.lastSeen=s.lastSeen):this.primaryRows.push(s),this.totalRequests+=1},requestRemovedHandler(e){const{target:t,id:a}=e;if(!(t in this.targets))return;const s=this.targets[t],r=s.findIndex((e=>e.id===a)),o=this.primaryRows.findIndex((e=>e.target===t));-1!==r?(s.splice(r,1),this.primaryRows[o].count-=1,s.length||(delete this.targets[t],this.primaryRows.splice(o,1)),this.totalRequests-=1):console.log("Unknown request, skipping")},connectSocket(){const{protocol:e,hostname:t,port:a}=window.location,s="127.0.0.1"===t?3333:+a+1,r=`${e}//${t}:${s}/debug`,o=localStorage.getItem("zelidauth");o&&(this.socket=(0,g.ZP)(r,{query:{roomName:"outboundHttp",authDetails:o},autoConnect:!1}),this.socket.on("connect",(()=>{console.log("connected")})),this.socket.on("addHistory",(e=>this.historyAddedHandler(e))),this.socket.on("addRequest",(e=>this.requestAddedHandler(e))),this.socket.on("removeRequest",(e=>this.requestRemovedHandler(e))),this.socket.connect())},latestRequest(e){const t=this.targets[e].reduce(((e,t)=>e&&e.timestamp>t.timestamp?e:t));return t},onRowClicked(e){const{detailsRow:t}=this;t&&t!==e&&(t._showDetails=!1),this.$set(e,"_showDetails",!e._showDetails),this.detailsRow=e}}},b=f;var v=a(1001),w=(0,v.Z)(b,h,m,!1,null,null,null);const x=w.exports;var k=a(20266),y=a(87066),R=a(39055);const C={components:{BCard:o._,BCol:n.l,BRow:i.T,BButton:l.T,BPopover:c.x,BFormTextarea:d.y,BCardText:u.j,RequestHistory:x,ToastificationContent:p.Z},directives:{Ripple:k.Z},data(){return{downloadPopoverShow:{},tailPopoverShow:{},abortToken:{},downloaded:{},total:{},callResponse:{status:"",data:{}},logTypes:["error","warn","info","debug"]}},computed:{fluxLogTail(){return this.callResponse.data.message?this.callResponse.data.message.split("\n").reverse().filter((e=>""!==e)).join("\n"):this.callResponse.data}},methods:{closeTextArea(){this.callResponse={status:"",data:{}}},cancelDownload(e){this.abortToken[e].cancel("User download cancelled"),this.downloaded[e]="",this.total[e]=""},onDownloadClose(e){this.downloadPopoverShow[e]=!1},async onDownloadOk(e){const t=this;t.abortToken[e]&&t.abortToken[e].cancel(),this.downloadPopoverShow[e]=!1;const a=y["default"].CancelToken,s=a.source();this.abortToken[e]=s;const r=localStorage.getItem("zelidauth"),o={headers:{zelidauth:r},responseType:"blob",onDownloadProgress(a){t.downloaded[e]=a.loaded,t.total[e]=a.total,t.$forceUpdate()},cancelToken:t.abortToken[e].token},n=await R.Z.justAPI().get(`/flux/${e}log`,o),i=window.URL.createObjectURL(new Blob([n.data])),l=document.createElement("a");l.href=i,l.setAttribute("download",`${e}.log`),document.body.appendChild(l),l.click()},onTailClose(e){this.tailPopoverShow[e]=!1},async onTailOk(e){this.tailPopoverShow[e]=!1;const t=localStorage.getItem("zelidauth");R.Z.tailFluxLog(e,t).then((e=>{"error"===e.data.status?this.$toast({component:p.Z,props:{title:e.data.data.message||e.data.data,icon:"InfoIcon",variant:"danger"}}):(this.callResponse.status=e.data.status,this.callResponse.data=e.data.data)})).catch((t=>{this.$toast({component:p.Z,props:{title:`Error while trying to get latest ${e} log`,icon:"InfoIcon",variant:"danger"}}),console.log(t)}))},capitalizeWord(e){return e[0].toUpperCase()+e.slice(1)}}},_=C;var S=(0,v.Z)(_,s,r,!1,null,null,null);const Z=S.exports},39055:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(80914);const r={softUpdateFlux(e){return(0,s.Z)().get("/flux/softupdateflux",{headers:{zelidauth:e}})},softUpdateInstallFlux(e){return(0,s.Z)().get("/flux/softupdatefluxinstall",{headers:{zelidauth:e}})},updateFlux(e){return(0,s.Z)().get("/flux/updateflux",{headers:{zelidauth:e}})},hardUpdateFlux(e){return(0,s.Z)().get("/flux/hardupdateflux",{headers:{zelidauth:e}})},rebuildHome(e){return(0,s.Z)().get("/flux/rebuildhome",{headers:{zelidauth:e}})},updateDaemon(e){return(0,s.Z)().get("/flux/updatedaemon",{headers:{zelidauth:e}})},reindexDaemon(e){return(0,s.Z)().get("/flux/reindexdaemon",{headers:{zelidauth:e}})},updateBenchmark(e){return(0,s.Z)().get("/flux/updatebenchmark",{headers:{zelidauth:e}})},getFluxVersion(){return(0,s.Z)().get("/flux/version")},broadcastMessage(e,t){const a=t,r={headers:{zelidauth:e}};return(0,s.Z)().post("/flux/broadcastmessage",JSON.stringify(a),r)},connectedPeers(){return(0,s.Z)().get(`/flux/connectedpeers?timestamp=${Date.now()}`)},connectedPeersInfo(){return(0,s.Z)().get(`/flux/connectedpeersinfo?timestamp=${Date.now()}`)},incomingConnections(){return(0,s.Z)().get(`/flux/incomingconnections?timestamp=${Date.now()}`)},incomingConnectionsInfo(){return(0,s.Z)().get(`/flux/incomingconnectionsinfo?timestamp=${Date.now()}`)},addPeer(e,t){return(0,s.Z)().get(`/flux/addpeer/${t}`,{headers:{zelidauth:e}})},removePeer(e,t){return(0,s.Z)().get(`/flux/removepeer/${t}`,{headers:{zelidauth:e}})},removeIncomingPeer(e,t){return(0,s.Z)().get(`/flux/removeincomingpeer/${t}`,{headers:{zelidauth:e}})},adjustKadena(e,t,a){return(0,s.Z)().get(`/flux/adjustkadena/${t}/${a}`,{headers:{zelidauth:e}})},adjustRouterIP(e,t){return(0,s.Z)().get(`/flux/adjustrouterip/${t}`,{headers:{zelidauth:e}})},adjustBlockedPorts(e,t){const a={blockedPorts:t},r={headers:{zelidauth:e}};return(0,s.Z)().post("/flux/adjustblockedports",a,r)},adjustAPIPort(e,t){return(0,s.Z)().get(`/flux/adjustapiport/${t}`,{headers:{zelidauth:e}})},adjustBlockedRepositories(e,t){const a={blockedRepositories:t},r={headers:{zelidauth:e}};return(0,s.Z)().post("/flux/adjustblockedrepositories",a,r)},getKadenaAccount(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/kadena",e)},getRouterIP(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/routerip",e)},getBlockedPorts(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/blockedports",e)},getAPIPort(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/apiport",e)},getBlockedRepositories(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/blockedrepositories",e)},getMarketPlaceURL(){return(0,s.Z)().get("/flux/marketplaceurl")},getZelid(){const e={headers:{"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/zelid",e)},getStaticIpInfo(){return(0,s.Z)().get("/flux/staticip")},restartFluxOS(e){const t={headers:{zelidauth:e,"x-apicache-bypass":!0}};return(0,s.Z)().get("/flux/restart",t)},tailFluxLog(e,t){return(0,s.Z)().get(`/flux/tail${e}log`,{headers:{zelidauth:t}})},justAPI(){return(0,s.Z)()},cancelToken(){return s.S}}}}]);