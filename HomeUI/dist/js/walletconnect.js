(globalThis["webpackChunkflux"]=globalThis["webpackChunkflux"]||[]).push([[601],{14382:(e,t,i)=>{"use strict";function s(){return(null===i.g||void 0===i.g?void 0:i.g.crypto)||(null===i.g||void 0===i.g?void 0:i.g.msCrypto)||{}}function r(){const e=s();return e.subtle||e.webkitSubtle}function o(){return!!s()&&!!r()}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=s,t.getSubtleCrypto=r,t.isBrowserCryptoAvailable=o},23780:(e,t)=>{"use strict";function i(){return"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product}function s(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node}function r(){return!i()&&!s()}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=i,t.isNode=s,t.isBrowser=r},16503:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(14382),t),s.__exportStar(i(23780),t)},79714:(e,t,i)=>{"use strict";i.d(t,{q:()=>s});class s{}},76727:(e,t,i)=>{"use strict";i.r(t),i.d(t,{IEvents:()=>s.q});var s=i(79714)},19754:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HEARTBEAT_EVENTS=t.HEARTBEAT_INTERVAL=void 0;const s=i(45735);t.HEARTBEAT_INTERVAL=s.FIVE_SECONDS,t.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}},11432:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(19754),t)},46032:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeat=void 0;const s=i(70655),r=i(17187),o=i(45735),n=i(51755),a=i(11432);class c extends n.IHeartBeat{constructor(e){super(e),this.events=new r.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(null===e||void 0===e?void 0:e.interval)||a.HEARTBEAT_INTERVAL}static init(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=new c(e);return yield t.init(),t}))}init(){return s.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}initialize(){return s.__awaiter(this,void 0,void 0,(function*(){this.intervalRef=setInterval((()=>this.pulse()),o.toMiliseconds(this.interval))}))}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}t.HeartBeat=c},53991:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(46032),t),s.__exportStar(i(51755),t),s.__exportStar(i(11432),t)},41045:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IHeartBeat=void 0;const s=i(76727);class r extends s.IEvents{constructor(e){super()}}t.IHeartBeat=r},51755:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(41045),t)},18408:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PINO_CUSTOM_CONTEXT_KEY=t.PINO_LOGGER_DEFAULTS=void 0,t.PINO_LOGGER_DEFAULTS={level:"info"},t.PINO_CUSTOM_CONTEXT_KEY="custom_context"},60562:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const s=i(70655),r=s.__importDefault(i(36559));Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),s.__exportStar(i(18408),t),s.__exportStar(i(85594),t)},85594:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateChildLogger=t.formatChildLoggerContext=t.getLoggerContext=t.setBrowserLoggerContext=t.getBrowserLoggerContext=t.getDefaultLoggerOptions=void 0;const s=i(18408);function r(e){return Object.assign(Object.assign({},e),{level:(null===e||void 0===e?void 0:e.level)||s.PINO_LOGGER_DEFAULTS.level})}function o(e,t=s.PINO_CUSTOM_CONTEXT_KEY){return e[t]||""}function n(e,t,i=s.PINO_CUSTOM_CONTEXT_KEY){return e[i]=t,e}function a(e,t=s.PINO_CUSTOM_CONTEXT_KEY){let i="";return i="undefined"===typeof e.bindings?o(e,t):e.bindings().context||"",i}function c(e,t,i=s.PINO_CUSTOM_CONTEXT_KEY){const r=a(e,i),o=r.trim()?`${r}/${t}`:t;return o}function l(e,t,i=s.PINO_CUSTOM_CONTEXT_KEY){const r=c(e,t,i),o=e.child({context:r});return n(o,r,i)}t.getDefaultLoggerOptions=r,t.getBrowserLoggerContext=o,t.setBrowserLoggerContext=n,t.getLoggerContext=a,t.formatChildLoggerContext=c,t.generateChildLogger=l},14539:()=>{},37884:()=>{},38511:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>Ua});i(70560),i(98858),i(61318),i(86247),i(21412),i(43097);var s=i(17187),r=i.n(s),o=i(40402),n=i(24678);const a=e=>JSON.stringify(e,((e,t)=>"bigint"===typeof t?t.toString()+"n":t)),c=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=e.replace(t,'$1"$2n"$3');return JSON.parse(i,((e,t)=>{const i="string"===typeof t&&t.match(/^\d+n$/);return i?BigInt(t.substring(0,t.length-1)):t}))};function l(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return c(e)}catch(t){return e}}function h(e){return"string"===typeof e?e:a(e)||""}const d="idb-keyval";var p=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",i=e=>t+e;let s;return e.dbName&&e.storeName&&(s=(0,n.MT)(e.dbName,e.storeName)),{name:d,options:e,async hasItem(e){return!(typeof await(0,n.U2)(i(e),s)>"u")},async getItem(e){return await(0,n.U2)(i(e),s)??null},setItem(e,t){return(0,n.t8)(i(e),t,s)},removeItem(e){return(0,n.IV)(i(e),s)},getKeys(){return(0,n.XP)(s)},clear(){return(0,n.ZH)(s)}}};const u="WALLET_CONNECT_V2_INDEXED_DB",g="keyvaluestorage";class m{constructor(){this.indexedDb=(0,o.o6)({driver:p({dbName:u,storeName:g})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map((e=>[e.key,e.value]))}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,h(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof i.g<"u"?i.g:typeof self<"u"?self:{},y={exports:{}};function f(e){var t;return[e[0],l(null!=(t=e[1])?t:"")]}(function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),typeof w<"u"&&w.localStorage?y.exports=w.localStorage:typeof window<"u"&&window.localStorage?y.exports=window.localStorage:y.exports=new t})();class b{constructor(){this.localStorage=y.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(f)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return l(t)}async setItem(e,t){this.localStorage.setItem(e,h(t))}async removeItem(e){this.localStorage.removeItem(e)}}const v="wc_storage_version",E=1,x=async(e,t,i)=>{const s=v,r=await t.getItem(s);if(r&&r>=E)return void i(t);const o=await e.getKeys();if(!o.length)return void i(t);const n=[];for(;o.length;){const i=o.shift();if(!i)continue;const s=i.toLowerCase();if(s.includes("wc@")||s.includes("walletconnect")||s.includes("wc_")||s.includes("wallet_connect")){const s=await e.getItem(i);await t.setItem(i,s),n.push(i)}}await t.setItem(s,E),i(t),I(e,n)},I=async(e,t)=>{t.length&&t.forEach((async t=>{await e.removeItem(t)}))};class O{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new b;this.storage=e;try{const t=new m;x(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise((e=>{const t=setInterval((()=>{this.initialized&&(clearInterval(t),e())}),20)}))}}var _=i(53991),S=i(60562),C=i(79714);class P extends C.q{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class N extends C.q{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class R{constructor(e,t){this.logger=e,this.core=t}}class T extends C.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class D extends C.q{constructor(e){super()}}class k{constructor(e,t,i,s){this.core=e,this.logger=t,this.name=i}}class A extends C.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class $ extends C.q{constructor(e,t){super(),this.core=e,this.logger=t}}class M{constructor(e,t){this.projectId=e,this.logger=t}}class L{constructor(e,t){this.projectId=e,this.logger=t}}class U{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class j{constructor(e){this.client=e}}var q=i(31050),z=i(31416),W=i(45735);const V="EdDSA",K="JWT",B=".",H="base64url",F="utf8",Y="utf8",Z=":",G="did",Q="key",J="base58btc",X="z",ee="K36",te=32;var ie=i(20605),se=i(92263),re=i(52217);function oe(e){return(0,se.B)((0,re.m)(h(e),F),H)}function ne(e){const t=(0,re.m)(ee,J),i=X+(0,se.B)((0,ie.z)([t,e]),J);return[G,Q,i].join(Z)}function ae(e){return(0,se.B)(e,H)}function ce(e){return(0,re.m)([oe(e.header),oe(e.payload)].join(B),Y)}function le(e){return[oe(e.header),oe(e.payload),ae(e.signature)].join(B)}function he(e=(0,z.randomBytes)(te)){return q._w(e)}async function de(e,t,i,s,r=(0,W.fromMiliseconds)(Date.now())){const o={alg:V,typ:K},n=ne(s.publicKey),a=r+i,c={iss:n,sub:e,aud:t,iat:r,exp:a},l=ce({header:o,payload:c}),h=q.Xx(s.secretKey,l);return le({header:o,payload:c,signature:h})}i(37884);var pe=i(15501),ue=i(512),ge=i(73294),me=i(57664),we=i(37466),ye=i(43631),fe=i(67313),be=i(97217),ve=i(17563);i(14539);const Ee={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function xe(e,t){return e.includes(":")?[e]:t.chains||[]}const Ie="base10",Oe="base16",_e="base64pad",Se="utf8",Ce=0,Pe=1,Ne=0,Re=1,Te=12,De=32;function ke(){const e=me.Au();return{privateKey:(0,we.BB)(e.secretKey,Oe),publicKey:(0,we.BB)(e.publicKey,Oe)}}function Ae(){const e=(0,z.randomBytes)(De);return(0,we.BB)(e,Oe)}function $e(e,t){const i=me.gi((0,we.mL)(e,Oe),(0,we.mL)(t,Oe),!0),s=new ue.t(ge.mE,i).expand(De);return(0,we.BB)(s,Oe)}function Me(e){const t=(0,ge.vp)((0,we.mL)(e,Oe));return(0,we.BB)(t,Oe)}function Le(e){const t=(0,ge.vp)((0,we.mL)(e,Se));return(0,we.BB)(t,Oe)}function Ue(e){return(0,we.mL)(`${e}`,Ie)}function je(e){return Number((0,we.BB)(e,Ie))}function qe(e){const t=Ue(typeof e.type<"u"?e.type:Ce);if(je(t)===Pe&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const i=typeof e.senderPublicKey<"u"?(0,we.mL)(e.senderPublicKey,Oe):void 0,s=typeof e.iv<"u"?(0,we.mL)(e.iv,Oe):(0,z.randomBytes)(Te),r=new pe.OK((0,we.mL)(e.symKey,Oe)).seal(s,(0,we.mL)(e.message,Se));return We({type:t,sealed:r,iv:s,senderPublicKey:i})}function ze(e){const t=new pe.OK((0,we.mL)(e.symKey,Oe)),{sealed:i,iv:s}=Ve(e.encoded),r=t.open(s,i);if(null===r)throw new Error("Failed to decrypt");return(0,we.BB)(r,Se)}function We(e){if(je(e.type)===Pe){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,we.BB)((0,we.zo)([e.type,e.senderPublicKey,e.iv,e.sealed]),_e)}return(0,we.BB)((0,we.zo)([e.type,e.iv,e.sealed]),_e)}function Ve(e){const t=(0,we.mL)(e,_e),i=t.slice(Ne,Re),s=Re;if(je(i)===Pe){const e=s+De,r=e+Te,o=t.slice(s,e),n=t.slice(e,r),a=t.slice(r);return{type:i,sealed:a,iv:n,senderPublicKey:o}}const r=s+Te,o=t.slice(s,r),n=t.slice(r);return{type:i,sealed:n,iv:o}}function Ke(e,t){const i=Ve(e);return Be({type:je(i.type),senderPublicKey:typeof i.senderPublicKey<"u"?(0,we.BB)(i.senderPublicKey,Oe):void 0,receiverPublicKey:t?.receiverPublicKey})}function Be(e){const t=e?.type||Ce;if(t===Pe){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function He(e){return e.type===Pe&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var Fe=Object.defineProperty,Ye=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable,Qe=(e,t,i)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Je=(e,t)=>{for(var i in t||(t={}))Ze.call(t,i)&&Qe(e,i,t[i]);if(Ye)for(var i of Ye(t))Ge.call(t,i)&&Qe(e,i,t[i]);return e};const Xe="ReactNative",et={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},tt="js";function it(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function st(){return!(0,fe.getDocument)()&&!!(0,fe.getNavigator)()&&navigator.product===Xe}function rt(){return!it()&&!!(0,fe.getNavigator)()&&!!(0,fe.getDocument)()}function ot(){return st()?et.reactNative:it()?et.node:rt()?et.browser:et.unknown}function nt(){var e;try{return st()&&typeof i.g<"u"&&typeof(null==i.g?void 0:i.g.Application)<"u"?null==(e=i.g.Application)?void 0:e.applicationId:void 0}catch{return}}function at(e,t){let i=ve.parse(e);return i=Je(Je({},i),t),e=ve.stringify(i),e}function ct(){return(0,be.D)()||{name:"",description:"",url:"",icons:[""]}}function lt(){if(ot()===et.reactNative&&typeof i.g<"u"&&typeof(null==i.g?void 0:i.g.Platform)<"u"){const{OS:e,Version:t}=i.g.Platform;return[e,t].join("-")}const e=(0,ye.qY)();if(null===e)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function ht(){var e;const t=ot();return t===et.browser?[t,(null==(e=(0,fe.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}function dt(e,t,i){const s=lt(),r=ht();return[[e,t].join("-"),[tt,i].join("-"),s,r].join("/")}function pt({protocol:e,version:t,relayUrl:i,sdkVersion:s,auth:r,projectId:o,useOnCloseEvent:n,bundleId:a}){const c=i.split("?"),l=dt(e,t,s),h={auth:r,ua:l,projectId:o,useOnCloseEvent:n||void 0,origin:a||void 0},d=at(c[1]||"",h);return c[0]+"?"+d}function ut(e,t){return e.filter((e=>t.includes(e))).length===e.length}function gt(e){return Object.fromEntries(e.entries())}function mt(e){return new Map(Object.entries(e))}function wt(e=W.FIVE_MINUTES,t){const i=(0,W.toMiliseconds)(e||W.FIVE_MINUTES);let s,r,o;return{resolve:e=>{o&&s&&(clearTimeout(o),s(e))},reject:e=>{o&&r&&(clearTimeout(o),r(e))},done:()=>new Promise(((e,n)=>{o=setTimeout((()=>{n(new Error(t))}),i),s=e,r=n}))}}function yt(e,t,i){return new Promise((async(s,r)=>{const o=setTimeout((()=>r(new Error(i))),t);try{const t=await e;s(t)}catch(n){r(n)}clearTimeout(o)}))}function ft(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function bt(e){return ft("topic",e)}function vt(e){return ft("id",e)}function Et(e){const[t,i]=e.split(":"),s={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof i)s.topic=i;else{if("id"!==t||!Number.isInteger(Number(i)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${i}`);s.id=Number(i)}return s}function xt(e,t){return(0,W.fromMiliseconds)((t||Date.now())+(0,W.toMiliseconds)(e))}function It(e){return Date.now()>=(0,W.toMiliseconds)(e)}function Ot(e,t){return`${e}${t?`:${t}`:""}`}async function _t({id:e,topic:t,wcDeepLink:s}){try{if(!s)return;const r="string"==typeof s?JSON.parse(s):s;let o=r?.href;if("string"!=typeof o)return;o.endsWith("/")&&(o=o.slice(0,-1));const n=`${o}/wc?requestId=${e}&sessionTopic=${t}`,a=ot();a===et.browser?n.startsWith("https://")?window.open(n,"_blank","noreferrer noopener"):window.open(n,"_self","noreferrer noopener"):a===et.reactNative&&typeof(null==i.g?void 0:i.g.Linking)<"u"&&await i.g.Linking.openURL(n)}catch(r){console.error(r)}}async function St(e,t){try{return await e.getItem(t)||(rt()?localStorage.getItem(t):void 0)}catch(i){console.error(i)}}const Ct="irn";function Pt(e){return e?.relay||{protocol:Ct}}function Nt(e){const t=Ee[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Rt=Object.defineProperty,Tt=Object.defineProperties,Dt=Object.getOwnPropertyDescriptors,kt=Object.getOwnPropertySymbols,At=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,Mt=(e,t,i)=>t in e?Rt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Lt=(e,t)=>{for(var i in t||(t={}))At.call(t,i)&&Mt(e,i,t[i]);if(kt)for(var i of kt(t))$t.call(t,i)&&Mt(e,i,t[i]);return e},Ut=(e,t)=>Tt(e,Dt(t));function jt(e,t="-"){const i={},s="relay"+t;return Object.keys(e).forEach((t=>{if(t.startsWith(s)){const r=t.replace(s,""),o=e[t];i[r]=o}})),i}function qt(e){e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,t),r=e.substring(t+1,i).split("@"),o=typeof i<"u"?e.substring(i):"",n=ve.parse(o);return{protocol:s,topic:zt(r[0]),version:parseInt(r[1],10),symKey:n.symKey,relay:jt(n),expiryTimestamp:n.expiryTimestamp?parseInt(n.expiryTimestamp,10):void 0}}function zt(e){return e.startsWith("//")?e.substring(2):e}function Wt(e,t="-"){const i="relay",s={};return Object.keys(e).forEach((r=>{const o=i+t+r;e[r]&&(s[o]=e[r])})),s}function Vt(e){return`${e.protocol}:${e.topic}@${e.version}?`+ve.stringify(Ut(Lt({symKey:e.symKey},Wt(e.relay)),{expiryTimestamp:e.expiryTimestamp}))}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function Kt(e){const t=[];return e.forEach((e=>{const[i,s]=e.split(":");t.push(`${i}:${s}`)})),t}function Bt(e){const t=[];return Object.values(e).forEach((e=>{t.push(...Kt(e.accounts))})),t}function Ht(e,t){const i=[];return Object.values(e).forEach((e=>{Kt(e.accounts).includes(t)&&i.push(...e.methods)})),i}function Ft(e,t){const i=[];return Object.values(e).forEach((e=>{Kt(e.accounts).includes(t)&&i.push(...e.events)})),i}const Yt={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Zt={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Gt(e,t){const{message:i,code:s}=Zt[e];return{message:t?`${i} ${t}`:i,code:s}}function Qt(e,t){const{message:i,code:s}=Yt[e];return{message:t?`${i} ${t}`:i,code:s}}function Jt(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Xt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function ei(e){return typeof e>"u"}function ti(e,t){return!(!t||!ei(e))||"string"==typeof e&&!!e.trim().length}function ii(e,t){return!(!t||!ei(e))||"number"==typeof e&&!isNaN(e)}function si(e,t){const{requiredNamespaces:i}=t,s=Object.keys(e.namespaces),r=Object.keys(i);let o=!0;return!!ut(r,s)&&(s.forEach((t=>{const{accounts:s,methods:r,events:n}=e.namespaces[t],a=Kt(s),c=i[t];(!ut(xe(t,c),a)||!ut(c.methods,r)||!ut(c.events,n))&&(o=!1)})),o)}function ri(e){return!(!ti(e,!1)||!e.includes(":"))&&2===e.split(":").length}function oi(e){if(ti(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&ri(e)}}return!1}function ni(e){if(ti(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function ai(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}function ci(e){return e?.topic}function li(e,t){let i=null;return ti(e?.publicKey,!1)||(i=Gt("MISSING_OR_INVALID",`${t} controller public key should be a string`)),i}function hi(e){let t=!0;return Jt(e)?e.length&&(t=e.every((e=>ti(e,!1)))):t=!1,t}function di(e,t,i){let s=null;return Jt(t)&&t.length?t.forEach((e=>{s||ri(e)||(s=Qt("UNSUPPORTED_CHAINS",`${i}, chain ${e} should be a string and conform to "namespace:chainId" format`))})):ri(e)||(s=Qt("UNSUPPORTED_CHAINS",`${i}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function pi(e,t,i){let s=null;return Object.entries(e).forEach((([e,r])=>{if(s)return;const o=di(e,xe(e,r),`${t} ${i}`);o&&(s=o)})),s}function ui(e,t){let i=null;return Jt(e)?e.forEach((e=>{i||oi(e)||(i=Qt("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):i=Qt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),i}function gi(e,t){let i=null;return Object.values(e).forEach((e=>{if(i)return;const s=ui(e?.accounts,`${t} namespace`);s&&(i=s)})),i}function mi(e,t){let i=null;return hi(e?.methods)?hi(e?.events)||(i=Qt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):i=Qt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),i}function wi(e,t){let i=null;return Object.values(e).forEach((e=>{if(i)return;const s=mi(e,`${t}, namespace`);s&&(i=s)})),i}function yi(e,t,i){let s=null;if(e&&Xt(e)){const r=wi(e,t);r&&(s=r);const o=pi(e,t,i);o&&(s=o)}else s=Gt("MISSING_OR_INVALID",`${t}, ${i} should be an object with data`);return s}function fi(e,t){let i=null;if(e&&Xt(e)){const s=wi(e,t);s&&(i=s);const r=gi(e,t);r&&(i=r)}else i=Gt("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return i}function bi(e){return ti(e.protocol,!0)}function vi(e,t){let i=!1;return t&&!e?i=!0:e&&Jt(e)&&e.length&&e.forEach((e=>{i=bi(e)})),i}function Ei(e){return"number"==typeof e}function xi(e){return typeof e<"u"&&null!==typeof e}function Ii(e){return!(!e||"object"!=typeof e||!e.code||!ii(e.code,!1)||!e.message||!ti(e.message,!1))}function Oi(e){return!(ei(e)||!ti(e.method,!1))}function _i(e){return!(ei(e)||ei(e.result)&&ei(e.error)||!ii(e.id,!1)||!ti(e.jsonrpc,!1))}function Si(e){return!(ei(e)||!ti(e.name,!1))}function Ci(e,t){return!(!ri(t)||!Bt(e).includes(t))}function Pi(e,t,i){return!!ti(i,!1)&&Ht(e,t).includes(i)}function Ni(e,t,i){return!!ti(i,!1)&&Ft(e,t).includes(i)}function Ri(e,t,i){let s=null;const r=Ti(e),o=ki(t),n=Object.keys(r),a=Object.keys(o),c=Di(Object.keys(e)),l=Di(Object.keys(t)),h=c.filter((e=>!l.includes(e)));return h.length&&(s=Gt("NON_CONFORMING_NAMESPACES",`${i} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${h.toString()}\n      Received: ${Object.keys(t).toString()}`)),ut(n,a)||(s=Gt("NON_CONFORMING_NAMESPACES",`${i} namespaces chains don't satisfy required namespaces.\n      Required: ${n.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach((e=>{if(!e.includes(":")||s)return;const r=Kt(t[e].accounts);r.includes(e)||(s=Gt("NON_CONFORMING_NAMESPACES",`${i} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${r.toString()}`))})),n.forEach((e=>{s||(ut(r[e].methods,o[e].methods)?ut(r[e].events,o[e].events)||(s=Gt("NON_CONFORMING_NAMESPACES",`${i} namespaces events don't satisfy namespace events for ${e}`)):s=Gt("NON_CONFORMING_NAMESPACES",`${i} namespaces methods don't satisfy namespace methods for ${e}`))})),s}function Ti(e){const t={};return Object.keys(e).forEach((i=>{var s;i.includes(":")?t[i]=e[i]:null==(s=e[i].chains)||s.forEach((s=>{t[s]={methods:e[i].methods,events:e[i].events}}))})),t}function Di(e){return[...new Set(e.map((e=>e.includes(":")?e.split(":")[0]:e)))]}function ki(e){const t={};return Object.keys(e).forEach((i=>{if(i.includes(":"))t[i]=e[i];else{const s=Kt(e[i].accounts);s?.forEach((s=>{t[s]={accounts:e[i].accounts.filter((e=>e.includes(`${s}:`))),methods:e[i].methods,events:e[i].events}}))}})),t}function Ai(e,t){return ii(e,!1)&&e<=t.max&&e>=t.min}function $i(){const e=ot();return new Promise((t=>{switch(e){case et.browser:t(Mi());break;case et.reactNative:t(Li());break;case et.node:t(Ui());break;default:t(!0)}}))}function Mi(){return rt()&&navigator?.onLine}async function Li(){if(st()&&typeof i.g<"u"&&null!=i.g&&i.g.NetInfo){const e=await(null==i.g?void 0:i.g.NetInfo.fetch());return e?.isConnected}return!0}function Ui(){return!0}function ji(e){switch(ot()){case et.browser:qi(e);break;case et.reactNative:zi(e);break;case et.node:break}}function qi(e){!st()&&rt()&&(window.addEventListener("online",(()=>e(!0))),window.addEventListener("offline",(()=>e(!1))))}function zi(e){st()&&typeof i.g<"u"&&null!=i.g&&i.g.NetInfo&&i.g?.NetInfo.addEventListener((t=>e(t?.isConnected)))}const Wi={};class Vi{static get(e){return Wi[e]}static set(e,t){Wi[e]=t}static delete(e){delete Wi[e]}}const Ki="PARSE_ERROR",Bi="INVALID_REQUEST",Hi="METHOD_NOT_FOUND",Fi="INVALID_PARAMS",Yi="INTERNAL_ERROR",Zi="SERVER_ERROR",Gi=[-32700,-32600,-32601,-32602,-32603],Qi={[Ki]:{code:-32700,message:"Parse error"},[Bi]:{code:-32600,message:"Invalid Request"},[Hi]:{code:-32601,message:"Method not found"},[Fi]:{code:-32602,message:"Invalid params"},[Yi]:{code:-32603,message:"Internal error"},[Zi]:{code:-32e3,message:"Server error"}},Ji=Zi;function Xi(e){return Gi.includes(e)}function es(e){return Object.keys(Qi).includes(e)?Qi[e]:Qi[Ji]}function ts(e){const t=Object.values(Qi).find((t=>t.code===e));return t||Qi[Ji]}function is(e,t,i){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${t}`):e}var ss=i(16503);function rs(e=3){const t=Date.now()*Math.pow(10,e),i=Math.floor(Math.random()*Math.pow(10,e));return t+i}function os(e=6){return BigInt(rs(e))}function ns(e,t,i){return{id:i||rs(),jsonrpc:"2.0",method:e,params:t}}function as(e,t){return{id:e,jsonrpc:"2.0",result:t}}function cs(e,t,i){return{id:e,jsonrpc:"2.0",error:ls(t,i)}}function ls(e,t){return"undefined"===typeof e?es(Yi):("string"===typeof e&&(e=Object.assign(Object.assign({},es(Zi)),{message:e})),"undefined"!==typeof t&&(e.data=t),Xi(e.code)&&(e=ts(e.code)),e)}class hs{}class ds extends hs{constructor(){super()}}class ps extends ds{constructor(e){super()}}const us="^wss?:";function gs(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}function ms(e,t){const i=gs(e);return"undefined"!==typeof i&&new RegExp(t).test(i)}function ws(e){return ms(e,us)}function ys(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function fs(e){return"object"===typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function bs(e){return fs(e)&&"method"in e}function vs(e){return fs(e)&&(Es(e)||xs(e))}function Es(e){return"result"in e}function xs(e){return"error"in e}class Is extends ps{constructor(e){super(e),this.events=new s.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(ns(e.method,e.params||[],e.id||os().toString()),t)}async requestStrict(e,t){return new Promise((async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(r){s(r)}this.events.on(`${e.id}`,(e=>{xs(e)?s(e.error):i(e.result)}));try{await this.connection.send(e,t)}catch(r){s(r)}}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),vs(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"===typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const Os=()=>typeof WebSocket<"u"?WebSocket:typeof i.g<"u"&&typeof i.g.WebSocket<"u"?i.g.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:i(57026),_s=()=>typeof WebSocket<"u"||typeof i.g<"u"&&typeof i.g.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ss=e=>e.split("?")[0],Cs=10,Ps=Os();class Ns{constructor(e){if(this.url=e,this.events=new s.EventEmitter,this.registering=!1,!ws(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise(((e,t)=>{typeof this.socket>"u"?t(new Error("Connection already closed")):(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close())}))}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(h(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!ws(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))}))}return this.url=e,this.registering=!0,new Promise(((t,i)=>{const s=new URLSearchParams(e).get("origin"),r=(0,ss.isReactNative)()?{headers:{origin:s}}:{rejectUnauthorized:!ys(e)},o=new Ps(e,[],r);_s()?o.onerror=e=>{const t=e;i(this.emitError(t.error))}:o.on("error",(e=>{i(this.emitError(e))})),o.onopen=()=>{this.onOpen(o),t(o)}}))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?l(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),s=i.message||i.toString(),r=cs(e,s);this.events.emit("payload",r)}parseError(e,t=this.url){return is(e,Ss(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Cs&&this.events.setMaxListeners(Cs)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Ss(this.url)}`));return this.events.emit("register_error",t),t}}var Rs=i(72307),Ts=i.n(Rs),Ds=i(80204),ks=i.n(Ds);function As(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),s=0;s<i.length;s++)i[s]=255;for(var r=0;r<e.length;r++){var o=e.charAt(r),n=o.charCodeAt(0);if(255!==i[n])throw new TypeError(o+" is ambiguous");i[n]=r}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function d(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var i=0,s=0,r=0,o=t.length;r!==o&&0===t[r];)r++,i++;for(var n=(o-r)*h+1>>>0,l=new Uint8Array(n);r!==o;){for(var d=t[r],p=0,u=n-1;(0!==d||p<s)&&-1!==u;u--,p++)d+=256*l[u]>>>0,l[u]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");s=p,r++}for(var g=n-s;g!==n&&0===l[g];)g++;for(var m=c.repeat(i);g<n;++g)m+=e.charAt(l[g]);return m}function p(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var s=0,r=0;e[t]===c;)s++,t++;for(var o=(e.length-t)*l+1>>>0,n=new Uint8Array(o);e[t];){var h=i[e.charCodeAt(t)];if(255===h)return;for(var d=0,p=o-1;(0!==h||d<r)&&-1!==p;p--,d++)h+=a*n[p]>>>0,n[p]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,t++}if(" "!==e[t]){for(var u=o-r;u!==o&&0===n[u];)u++;for(var g=new Uint8Array(s+(o-u)),m=s;u!==o;)g[m++]=n[u++];return g}}}function u(e){var i=p(e);if(i)return i;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:p,decode:u}}var $s=As,Ms=$s;const Ls=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Us=e=>(new TextEncoder).encode(e),js=e=>(new TextDecoder).decode(e);class qs{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class zs{constructor(e,t,i){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Vs(this,e)}}class Ws{constructor(e){this.decoders=e}or(e){return Vs(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vs=(e,t)=>new Ws({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ks{constructor(e,t,i,s){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=s,this.encoder=new qs(e,t,i),this.decoder=new zs(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bs=({name:e,prefix:t,encode:i,decode:s})=>new Ks(e,t,i,s),Hs=({prefix:e,name:t,alphabet:i})=>{const{encode:s,decode:r}=Ms(i,t);return Bs({prefix:e,name:t,encode:s,decode:e=>Ls(r(e))})},Fs=(e,t,i,s)=>{const r={};for(let h=0;h<t.length;++h)r[t[h]]=h;let o=e.length;for(;"="===e[o-1];)--o;const n=new Uint8Array(o*i/8|0);let a=0,c=0,l=0;for(let h=0;h<o;++h){const t=r[e[h]];if(void 0===t)throw new SyntaxError(`Non-${s} character`);c=c<<i|t,a+=i,a>=8&&(a-=8,n[l++]=255&c>>a)}if(a>=i||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return n},Ys=(e,t,i)=>{const s="="===t[t.length-1],r=(1<<i)-1;let o="",n=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],n+=8;n>i;)n-=i,o+=t[r&a>>n];if(n&&(o+=t[r&a<<i-n]),s)for(;o.length*i&7;)o+="=";return o},Zs=({name:e,prefix:t,bitsPerChar:i,alphabet:s})=>Bs({prefix:t,name:e,encode(e){return Ys(e,s,i)},decode(t){return Fs(t,s,i,e)}}),Gs=Bs({prefix:"\0",name:"identity",encode:e=>js(e),decode:e=>Us(e)});var Qs=Object.freeze({__proto__:null,identity:Gs});const Js=Zs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Xs=Object.freeze({__proto__:null,base2:Js});const er=Zs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var tr=Object.freeze({__proto__:null,base8:er});const ir=Hs({prefix:"9",name:"base10",alphabet:"0123456789"});var sr=Object.freeze({__proto__:null,base10:ir});const rr=Zs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),or=Zs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var nr=Object.freeze({__proto__:null,base16:rr,base16upper:or});const ar=Zs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cr=Zs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lr=Zs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hr=Zs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dr=Zs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pr=Zs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ur=Zs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gr=Zs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mr=Zs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wr=Object.freeze({__proto__:null,base32:ar,base32upper:cr,base32pad:lr,base32padupper:hr,base32hex:dr,base32hexupper:pr,base32hexpad:ur,base32hexpadupper:gr,base32z:mr});const yr=Hs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fr=Hs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var br=Object.freeze({__proto__:null,base36:yr,base36upper:fr});const vr=Hs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Er=Hs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xr=Object.freeze({__proto__:null,base58btc:vr,base58flickr:Er});const Ir=Zs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Or=Zs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_r=Zs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Sr=Zs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Cr=Object.freeze({__proto__:null,base64:Ir,base64pad:Or,base64url:_r,base64urlpad:Sr});const Pr=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Nr=Pr.reduce(((e,t,i)=>(e[i]=t,e)),[]),Rr=Pr.reduce(((e,t,i)=>(e[t.codePointAt(0)]=i,e)),[]);function Tr(e){return e.reduce(((e,t)=>(e+=Nr[t],e)),"")}function Dr(e){const t=[];for(const i of e){const e=Rr[i.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${i}`);t.push(e)}return new Uint8Array(t)}const kr=Bs({prefix:"ðŸš€",name:"base256emoji",encode:Tr,decode:Dr});var Ar=Object.freeze({__proto__:null,base256emoji:kr}),$r=qr,Mr=128,Lr=127,Ur=~Lr,jr=Math.pow(2,31);function qr(e,t,i){t=t||[],i=i||0;for(var s=i;e>=jr;)t[i++]=255&e|Mr,e/=128;for(;e&Ur;)t[i++]=255&e|Mr,e>>>=7;return t[i]=0|e,qr.bytes=i-s+1,t}var zr=Kr,Wr=128,Vr=127;function Kr(e,t){var i,s=0,r=(t=t||0,0),o=t,n=e.length;do{if(o>=n)throw Kr.bytes=0,new RangeError("Could not decode varint");i=e[o++],s+=r<28?(i&Vr)<<r:(i&Vr)*Math.pow(2,r),r+=7}while(i>=Wr);return Kr.bytes=o-t,s}var Br=Math.pow(2,7),Hr=Math.pow(2,14),Fr=Math.pow(2,21),Yr=Math.pow(2,28),Zr=Math.pow(2,35),Gr=Math.pow(2,42),Qr=Math.pow(2,49),Jr=Math.pow(2,56),Xr=Math.pow(2,63),eo=function(e){return e<Br?1:e<Hr?2:e<Fr?3:e<Yr?4:e<Zr?5:e<Gr?6:e<Qr?7:e<Jr?8:e<Xr?9:10},to={encode:$r,decode:zr,encodingLength:eo},io=to;const so=(e,t,i=0)=>(io.encode(e,t,i),t),ro=e=>io.encodingLength(e),oo=(e,t)=>{const i=t.byteLength,s=ro(e),r=s+ro(i),o=new Uint8Array(r+i);return so(e,o,0),so(i,o,s),o.set(t,r),new no(e,i,t,o)};class no{constructor(e,t,i,s){this.code=e,this.size=t,this.digest=i,this.bytes=s}}const ao=({name:e,code:t,encode:i})=>new co(e,t,i);class co{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?oo(this.code,t):t.then((e=>oo(this.code,e)))}throw Error("Unknown type, must be binary type")}}const lo=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ho=ao({name:"sha2-256",code:18,encode:lo("SHA-256")}),po=ao({name:"sha2-512",code:19,encode:lo("SHA-512")});Object.freeze({__proto__:null,sha256:ho,sha512:po});const uo=0,go="identity",mo=Ls,wo=e=>oo(uo,mo(e)),yo={code:uo,name:go,encode:mo,digest:wo};Object.freeze({__proto__:null,identity:yo});new TextEncoder,new TextDecoder;const fo={...Qs,...Xs,...tr,...sr,...nr,...wr,...br,...xr,...Cr,...Ar};function bo(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function vo(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?bo(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Eo(e,t,i,s){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:i},decoder:{decode:s}}}const xo=Eo("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Io=Eo("ascii","a",(e=>{let t="a";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}),(e=>{e=e.substring(1);const t=vo(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t})),Oo={utf8:xo,"utf-8":xo,hex:fo.base16,latin1:Io,ascii:Io,binary:Io,...fo};function _o(e,t="utf8"){const i=Oo[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?i.decoder.decode(`${i.prefix}${e}`):bo(globalThis.Buffer.from(e,"utf-8"))}const So="wc",Co=2,Po="core",No=`${So}@2:${Po}:`,Ro={name:Po,logger:"error"},To={database:":memory:"},Do="crypto",ko="client_ed25519_seed",Ao=W.ONE_DAY,$o="keychain",Mo="0.3",Lo="messages",Uo="0.3",jo=W.SIX_HOURS,qo="publisher",zo="irn",Wo="error",Vo="wss://relay.walletconnect.com",Ko="wss://relay.walletconnect.org",Bo="relayer",Ho={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Fo="_subscription",Yo={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Zo=W.ONE_SECOND,Go="2.11.3",Qo=1e4,Jo="0.3",Xo="WALLETCONNECT_CLIENT_ID",en={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},tn="subscription",sn="0.3",rn=1e3*W.FIVE_SECONDS,on="pairing",nn="0.3",an={wc_pairingDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:W.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:W.ONE_DAY,prompt:!1,tag:0},res:{ttl:W.ONE_DAY,prompt:!1,tag:0}}},cn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ln={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},hn="history",dn="0.3",pn="expirer",un={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},gn="0.3",mn="verify-api",wn="https://verify.walletconnect.com",yn="https://verify.walletconnect.org",fn=[wn,yn],bn="echo",vn="https://echo.walletconnect.com";class En{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=$o,this.version=Mo,this.initialized=!1,this.storagePrefix=No,this.init=async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}},this.has=e=>(this.isInitialized(),this.keychain.has(e)),this.set=async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()},this.get=e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=Gt("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t},this.del=async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()},this.core=e,this.logger=(0,S.generateChildLogger)(t,this.name)}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,gt(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?mt(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class xn{constructor(e,t,i){this.core=e,this.logger=t,this.name=Do,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=e=>(this.isInitialized(),this.keychain.has(e)),this.getClientId=async()=>{this.isInitialized();const e=await this.getClientSeed(),t=he(e);return ne(t.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const e=ke();return this.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=async e=>{this.isInitialized();const t=await this.getClientSeed(),i=he(t),s=Ae(),r=Ao;return await de(s,e,r,i)},this.generateSharedKey=(e,t,i)=>{this.isInitialized();const s=this.getPrivateKey(e),r=$e(s,t);return this.setSymKey(r,i)},this.setSymKey=async(e,t)=>{this.isInitialized();const i=t||Me(e);return await this.keychain.set(i,e),i},this.deleteKeyPair=async e=>{this.isInitialized(),await this.keychain.del(e)},this.deleteSymKey=async e=>{this.isInitialized(),await this.keychain.del(e)},this.encode=async(e,t,i)=>{this.isInitialized();const s=Be(i),r=h(t);if(He(s)){const t=s.senderPublicKey,i=s.receiverPublicKey;e=await this.generateSharedKey(t,i)}const o=this.getSymKey(e),{type:n,senderPublicKey:a}=s;return qe({type:n,symKey:o,message:r,senderPublicKey:a})},this.decode=async(e,t,i)=>{this.isInitialized();const s=Ke(t,i);if(He(s)){const t=s.receiverPublicKey,i=s.senderPublicKey;e=await this.generateSharedKey(t,i)}try{const i=this.getSymKey(e),s=ze({symKey:i,encoded:t});return l(s)}catch(O){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(O)}},this.getPayloadType=e=>{const t=Ve(e);return je(t.type)},this.getPayloadSenderPublicKey=e=>{const t=Ve(e);return t.senderPublicKey?(0,we.BB)(t.senderPublicKey,Oe):void 0},this.core=e,this.logger=(0,S.generateChildLogger)(t,this.name),this.keychain=i||new En(this.core,this.logger)}get context(){return(0,S.getLoggerContext)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ko)}catch{e=Ae(),await this.keychain.set(ko,e)}return _o(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class In extends R{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Lo,this.version=Uo,this.initialized=!1,this.storagePrefix=No,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}},this.set=async(e,t)=>{this.isInitialized();const i=Le(t);let s=this.messages.get(e);return typeof s>"u"&&(s={}),typeof s[i]<"u"||(s[i]=t,this.messages.set(e,s),await this.persist()),i},this.get=e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t},this.has=(e,t)=>{this.isInitialized();const i=this.get(e),s=Le(t);return typeof i[s]<"u"},this.del=async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()},this.logger=(0,S.generateChildLogger)(e,this.name),this.core=t}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,gt(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?mt(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class On extends T{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new s.EventEmitter,this.name=qo,this.queue=new Map,this.publishTimeout=(0,W.toMiliseconds)(W.ONE_MINUTE),this.failedPublishTimeout=(0,W.toMiliseconds)(W.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(e,t,i)=>{var s;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:i}});const r=i?.ttl||jo,o=Pt(i),n=i?.prompt||!1,a=i?.tag||0,c=i?.id||os().toString(),l={topic:e,message:t,opts:{ttl:r,relay:o,prompt:n,tag:a,id:c}},h=`Failed to publish payload, please try again. id:${c} tag:${a}`,d=Date.now();let p,g=1;try{for(;void 0===p;){if(Date.now()-d>this.publishTimeout)throw new Error(h);this.logger.trace({id:c,attempts:g},`publisher.publish - attempt ${g}`),p=await await yt(this.rpcPublish(e,t,r,o,n,a,c).catch((e=>this.logger.warn(e))),this.publishTimeout,h),g++,p||await new Promise((e=>setTimeout(e,this.failedPublishTimeout)))}this.relayer.events.emit(Ho.publish,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:i}})}catch(u){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(u),null!=(s=i?.internal)&&s.throwOnFailedPublish)throw u;this.queue.set(c,l)}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.relayer=e,this.logger=(0,S.generateChildLogger)(t,this.name),this.registerEventListeners()}get context(){return(0,S.getLoggerContext)(this.logger)}rpcPublish(e,t,i,s,r,o,n){var a,c,l,h;const d={method:Nt(s.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:r,tag:o},id:n};return ei(null==(a=d.params)?void 0:a.prompt)&&(null==(c=d.params)||delete c.prompt),ei(null==(l=d.params)?void 0:l.tag)&&(null==(h=d.params)||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:d}),this.relayer.request(d)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach((async e=>{const{topic:t,message:i,opts:s}=e;await this.publish(t,i,s)}))}registerEventListeners(){this.relayer.core.heartbeat.on(_.HEARTBEAT_EVENTS.pulse,(()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(Ho.connection_stalled);this.checkQueue()})),this.relayer.on(Ho.message_ack,(e=>{this.removeRequestFromQueue(e.id.toString())}))}}class _n{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const s=i.filter((e=>e!==t));s.length?this.map.set(e,s):this.map.delete(e)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Sn=Object.defineProperty,Cn=Object.defineProperties,Pn=Object.getOwnPropertyDescriptors,Nn=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Tn=Object.prototype.propertyIsEnumerable,Dn=(e,t,i)=>t in e?Sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,kn=(e,t)=>{for(var i in t||(t={}))Rn.call(t,i)&&Dn(e,i,t[i]);if(Nn)for(var i of Nn(t))Tn.call(t,i)&&Dn(e,i,t[i]);return e},An=(e,t)=>Cn(e,Pn(t));class $n extends A{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new _n,this.events=new s.EventEmitter,this.name=tn,this.version=sn,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=No,this.subscribeTimeout=(0,W.toMiliseconds)(W.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const i=Pt(t),s={topic:e,relay:i};this.pending.set(e,s);const r=await this.rpcSubscribe(e,i);return"string"==typeof r&&(this.onSubscribe(r,s),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),r}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}},this.unsubscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),typeof t?.id<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)},this.isSubscribed=async e=>{if(this.topics.includes(e))return!0;const t=`${this.pendingSubscriptionWatchLabel}_${e}`;return await new Promise(((i,s)=>{const r=new W.Watch;r.start(t);const o=setInterval((()=>{!this.pending.has(e)&&this.topics.includes(e)&&(clearInterval(o),r.stop(t),i(!0)),r.elapsed(t)>=rn&&(clearInterval(o),r.stop(t),s(new Error("Subscription resolution timeout")))}),this.pollingInterval)})).catch((()=>!1))},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=(0,S.generateChildLogger)(t,this.name),this.clientId=""}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map((async i=>await this.unsubscribeById(e,i,t))))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const s=Pt(i);await this.rpcUnsubscribe(e,t,s);const r=Qt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,r),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t){const i={method:Nt(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await yt(this.relayer.request(i).catch((e=>this.logger.warn(e))),this.subscribeTimeout)?Le(e+this.clientId):null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ho.connection_stalled)}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:Nt(t.protocol).batchSubscribe,params:{topics:e.map((e=>e.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await yt(this.relayer.request(i).catch((e=>this.logger.warn(e))),this.subscribeTimeout)}catch{this.relayer.events.emit(Ho.connection_stalled)}}rpcUnsubscribe(e,t,i){const s={method:Nt(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,An(kn({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach((e=>{this.setSubscription(e.id,kn({},e)),this.pending.delete(e.topic)}))}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,kn({},t)),this.topicMap.set(t.topic,e),this.events.emit(en.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=Gt("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(en.deleted,An(kn({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(en.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const e=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(e)}}this.events.emit(en.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:e}=Gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Jt(t)&&this.onBatchSubscribe(t.map(((t,i)=>An(kn({},e[i]),{id:t}))))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const e=[];this.pending.forEach((t=>{e.push(t)})),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(_.HEARTBEAT_EVENTS.pulse,(async()=>{await this.checkPending()})),this.events.on(en.created,(async e=>{const t=en.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})),this.events.on(en.deleted,(async e=>{const t=en.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise((e=>{const t=setInterval((()=>{this.restartInProgress||(clearInterval(t),e())}),this.pollingInterval)}))}}var Mn=Object.defineProperty,Ln=Object.getOwnPropertySymbols,Un=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable,qn=(e,t,i)=>t in e?Mn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,zn=(e,t)=>{for(var i in t||(t={}))Un.call(t,i)&&qn(e,i,t[i]);if(Ln)for(var i of Ln(t))jn.call(t,i)&&qn(e,i,t[i]);return e};class Wn extends D{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new s.EventEmitter,this.name=Bo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=(0,W.toMiliseconds)(W.THIRTY_SECONDS+W.ONE_SECOND),this.request=async e=>{var t,i;this.logger.debug("Publishing Request Payload");const s=e.id||os().toString();await this.toEstablishConnection();try{const r=this.provider.request(e);this.requestsInFlight.set(s,{promise:r,request:e}),this.logger.trace({id:s,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - attempt to publish...");const o=await new Promise((async(e,t)=>{const i=()=>{t(new Error(`relayer.request - publish interrupted, id: ${s}`))};this.provider.on(Yo.disconnect,i);const o=await r;this.provider.off(Yo.disconnect,i),e(o)}));return this.logger.trace({id:s,method:e.method,topic:null==(i=e.params)?void 0:i.topic},"relayer.request - published"),o}catch(r){throw this.logger.debug(`Failed to Publish Request: ${s}`),r}finally{this.requestsInFlight.delete(s)}},this.resetPingTimeout=()=>{if(it())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout((()=>{var e,t,i;null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)||i.terminate()}),this.heartBeatTimeout)}catch(e){this.logger.warn(e)}},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.startPingTimeout(),this.events.emit(Ho.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit(Ho.error,e),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Yo.payload,this.onPayloadHandler),this.provider.on(Yo.connect,this.onConnectHandler),this.provider.on(Yo.disconnect,this.onDisconnectHandler),this.provider.on(Yo.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,S.generateChildLogger)(e.logger,this.name):(0,S.pino)((0,S.getDefaultLoggerOptions)({level:e.logger||Wo})),this.messages=new In(this.logger,e.core),this.subscriber=new $n(this,this.logger),this.publisher=new On(this,this.logger),this.relayUrl=e?.relayUrl||Vo,this.projectId=e.projectId,this.bundleId=nt(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ko}...`),await this.restartTransport(Ko)}this.initialized=!0,setTimeout((async()=>{0===this.subscriber.topics.length&&0===this.subscriber.pending.size&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)}),Qo)}get context(){return(0,S.getLoggerContext)(this.logger)}get connected(){var e,t,i;return 1===(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)}get connecting(){var e,t,i;return 0===(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var i;this.isInitialized();let s,r=(null==(i=this.subscriber.topicMap.get(e))?void 0:i[0])||"";const o=t=>{t.topic===e&&(this.subscriber.off(en.created,o),s())};return await Promise.all([new Promise((e=>{s=e,this.subscriber.on(en.created,o)})),new Promise((async i=>{r=await this.subscriber.subscribe(e,t)||r,i()}))]),r}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map((e=>e.promise)))}catch(e){this.logger.warn(e)}this.hasExperiencedNetworkDisruption||this.connected?await yt(this.provider.disconnect(),2e3,"provider.disconnect()").catch((()=>this.onProviderDisconnect())):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect(),await this.createProvider()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise((async(e,t)=>{const i=()=>{this.provider.off(Yo.disconnect,i),t(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Yo.disconnect,i),await yt(this.provider.connect(),(0,W.toMiliseconds)(W.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch((e=>{t(e)})),await this.subscriber.start(),this.hasExperiencedNetworkDisruption=!1,e()}))}catch(t){this.logger.error(t);const e=t;if(!this.isConnectionStalled(e.message))throw t}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await $i())throw new Error("No internet connection detected. Please restart your network and try again.")}startPingTimeout(){var e,t,i,s,r;if(it())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(r=null==(s=null==(i=this.provider)?void 0:i.connection)?void 0:s.socket)||r.once("ping",(()=>{this.resetPingTimeout()}))),this.resetPingTimeout()}catch(o){this.logger.warn(o)}}isConnectionStalled(e){return this.staleConnectionErrors.some((t=>e.includes(t)))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Is(new Ns(pt({sdkVersion:Go,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;if(!i||0===i.length)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const s=this.messages.has(t,i);return s&&this.logger.debug(`Ignoring duplicate message: ${i}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),bs(e)){if(!e.method.endsWith(Fo))return;const t=e.params,{topic:i,message:s,publishedAt:r}=t.data,o={topic:i,message:s,publishedAt:r};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(zn({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else vs(e)&&this.events.emit(Ho.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ho.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=as(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Yo.payload,this.onPayloadHandler),this.provider.off(Yo.connect,this.onConnectHandler),this.provider.off(Yo.disconnect,this.onDisconnectHandler),this.provider.off(Yo.error,this.onProviderErrorHandler)}async registerEventListeners(){let e=await $i();ji((async t=>{e!==t&&(e=t,t?await this.restartTransport().catch((e=>this.logger.error(e))):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}))}async onProviderDisconnect(){await this.subscriber.stop(),this.events.emit(Ho.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&setTimeout((async()=>{await this.transportOpen().catch((e=>this.logger.error(e)))}),(0,W.toMiliseconds)(Zo))}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise((e=>{const t=setInterval((()=>{this.connected&&(clearInterval(t),e())}),this.connectionStatusPollingInterval)})),await this.transportOpen())}}var Vn=Object.defineProperty,Kn=Object.getOwnPropertySymbols,Bn=Object.prototype.hasOwnProperty,Hn=Object.prototype.propertyIsEnumerable,Fn=(e,t,i)=>t in e?Vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Yn=(e,t)=>{for(var i in t||(t={}))Bn.call(t,i)&&Fn(e,i,t[i]);if(Kn)for(var i of Kn(t))Hn.call(t,i)&&Fn(e,i,t[i]);return e};class Zn extends k{constructor(e,t,i,s=No,r=void 0){super(e,t,i,s),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=Jo,this.cached=[],this.initialized=!1,this.storagePrefix=No,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>{this.getKey&&null!==e&&!ei(e)?this.map.set(this.getKey(e),e):ai(e)?this.map.set(e.id,e):ci(e)&&this.map.set(e.topic,e)})),this.cached=[],this.initialized=!0)},this.set=async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())},this.get=e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e)),this.getAll=e=>(this.isInitialized(),e?this.values.filter((t=>Object.keys(e).every((i=>Ts()(t[i],e[i]))))):this.values),this.update=async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const i=Yn(Yn({},this.getData(e)),t);this.map.set(e,i),await this.persist()},this.delete=async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())},this.logger=(0,S.generateChildLogger)(t,this.name),this.storagePrefix=s,this.getKey=r}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=Gt("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=Gt("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=Gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Gn{constructor(e,t){this.core=e,this.logger=t,this.name=on,this.version=nn,this.events=new(r()),this.initialized=!1,this.storagePrefix=No,this.ignoredPayloadTypes=[Pe],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]},this.create=async()=>{this.isInitialized();const e=Ae(),t=await this.core.crypto.setSymKey(e),i=xt(W.FIVE_MINUTES),s={protocol:zo},r={topic:t,expiry:i,relay:s,active:!1},o=Vt({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:e,relay:s,expiryTimestamp:i});return await this.pairings.set(t,r),await this.core.relayer.subscribe(t),this.core.expirer.set(t,i),{topic:t,uri:o}},this.pair=async e=>{this.isInitialized(),this.isValidPair(e);const{topic:t,symKey:i,relay:s,expiryTimestamp:r}=qt(e.uri);let o;if(this.pairings.keys.includes(t)&&(o=this.pairings.get(t),o.active))throw new Error(`Pairing already exists: ${t}. Please try again with a new connection URI.`);const n=r||xt(W.FIVE_MINUTES),a={topic:t,relay:s,expiry:n,active:!1};return await this.pairings.set(t,a),this.core.expirer.set(t,n),e.activatePairing&&await this.activate({topic:t}),this.events.emit(cn.create,a),this.core.crypto.keychain.has(t)||await this.core.crypto.setSymKey(i,t),await this.core.relayer.subscribe(t,{relay:s}),a},this.activate=async({topic:e})=>{this.isInitialized();const t=xt(W.THIRTY_DAYS);await this.pairings.update(e,{active:!0,expiry:t}),this.core.expirer.set(e,t)},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e);const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:i,resolve:s,reject:r}=wt();this.events.once(Ot("pairing_ping",e),(({error:e})=>{e?r(e):s()})),await i()}},this.updateExpiry=async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})},this.updateMetadata=async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",Qt("USER_DISCONNECTED")),await this.deletePairing(t))},this.sendRequest=async(e,t,i)=>{const s=ns(t,i),r=await this.core.crypto.encode(e,s),o=an[t].req;return this.core.history.set(e,s),this.core.relayer.publish(e,r,o),s.id},this.sendResult=async(e,t,i)=>{const s=as(e,i),r=await this.core.crypto.encode(t,s),o=await this.core.history.get(t,e),n=an[o.request.method].res;await this.core.relayer.publish(t,r,n),await this.core.history.resolve(s)},this.sendError=async(e,t,i)=>{const s=cs(e,i),r=await this.core.crypto.encode(t,s),o=await this.core.history.get(t,e),n=an[o.request.method]?an[o.request.method].res:an.unregistered_method.res;await this.core.relayer.publish(t,r,n),await this.core.history.resolve(s)},this.deletePairing=async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,Qt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])},this.cleanup=async()=>{const e=this.pairings.getAll().filter((e=>It(e.expiry)));await Promise.all(e.map((e=>this.deletePairing(e.topic))))},this.onRelayEventRequest=e=>{const{topic:t,payload:i}=e;switch(i.method){case"wc_pairingPing":return this.onPairingPingRequest(t,i);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,i);default:return this.onUnknownRpcMethodRequest(t,i)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:i}=e,s=(await this.core.history.get(t,i.id)).request.method;switch(s){case"wc_pairingPing":return this.onPairingPingResponse(t,i);default:return this.onUnknownRpcMethodResponse(s)}},this.onPairingPingRequest=async(e,t)=>{const{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult(i,e,!0),this.events.emit(cn.ping,{id:i,topic:e})}catch(s){await this.sendError(i,e,s),this.logger.error(s)}},this.onPairingPingResponse=(e,t)=>{const{id:i}=t;setTimeout((()=>{Es(t)?this.events.emit(Ot("pairing_ping",i),{}):xs(t)&&this.events.emit(Ot("pairing_ping",i),{error:t.error})}),500)},this.onPairingDeleteRequest=async(e,t)=>{const{id:i}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(cn.delete,{id:i,topic:e})}catch(s){await this.sendError(i,e,s),this.logger.error(s)}},this.onUnknownRpcMethodRequest=async(e,t)=>{const{id:i,method:s}=t;try{if(this.registeredMethods.includes(s))return;const t=Qt("WC_METHOD_UNSUPPORTED",s);await this.sendError(i,e,t),this.logger.error(t)}catch(R){await this.sendError(i,e,R),this.logger.error(R)}},this.onUnknownRpcMethodResponse=e=>{this.registeredMethods.includes(e)||this.logger.error(Qt("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=e=>{var t;if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`pair() params: ${e}`);throw new Error(t)}if(!ni(e.uri)){const{message:t}=Gt("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw new Error(t)}const i=qt(e.uri);if(null==(t=i?.relay)||!t.protocol){const{message:e}=Gt("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(e)}if(null==i||!i.symKey){const{message:e}=Gt("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(e)}if(null!=i&&i.expiryTimestamp&&(0,W.toMiliseconds)(i?.expiryTimestamp)<Date.now()){const{message:e}=Gt("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}},this.isValidPing=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidDisconnect=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidPairingTopic=async e=>{if(!ti(e,!1)){const{message:t}=Gt("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=Gt("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(It(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=Gt("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}},this.core=e,this.logger=(0,S.generateChildLogger)(t,this.name),this.pairings=new Zn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,S.getLoggerContext)(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ho.message,(async e=>{const{topic:t,message:i}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(t,i);try{bs(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):vs(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(r){this.logger.error(r)}}))}registerExpirerEvents(){this.core.expirer.on(un.expired,(async e=>{const{topic:t}=Et(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(cn.expire,{topic:t}))}))}}class Qn extends N{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new s.EventEmitter,this.name=hn,this.version=dn,this.cached=[],this.initialized=!1,this.storagePrefix=No,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.records.set(e.id,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(e,t,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:i}),this.records.has(t.id))return;const s={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:i,expiry:xt(W.THIRTY_DAYS)};this.records.set(s.id,s),this.events.emit(ln.created,s)},this.resolve=async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=xs(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.events.emit(ln.updated,t))},this.get=async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t)),this.delete=(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach((i=>{if(i.topic===e){if(typeof t<"u"&&i.id!==t)return;this.records.delete(i.id),this.events.emit(ln.deleted,i)}}))},this.exists=async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e),this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=(0,S.generateChildLogger)(t,this.name)}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach((t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:ns(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)})),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=Gt("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ln.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=Gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ln.created,(e=>{const t=ln.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(ln.updated,(e=>{const t=ln.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(ln.deleted,(e=>{const t=ln.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.core.heartbeat.on(_.HEARTBEAT_EVENTS.pulse,(()=>{this.cleanup()}))}cleanup(){try{this.records.forEach((e=>{(0,W.toMiliseconds)(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))}))}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Jn extends ${constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new s.EventEmitter,this.name=pn,this.version=gn,this.cached=[],this.initialized=!1,this.storagePrefix=No,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.expirations.set(e.target,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}},this.set=(e,t)=>{this.isInitialized();const i=this.formatTarget(e),s={target:i,expiry:t};this.expirations.set(i,s),this.checkExpiry(i,s),this.events.emit(un.created,{target:i,expiration:s})},this.get=e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)},this.del=e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),i=this.getExpiration(t);this.expirations.delete(t),this.events.emit(un.deleted,{target:t,expiration:i})}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=(0,S.generateChildLogger)(t,this.name)}get context(){return(0,S.getLoggerContext)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return bt(e);if("number"==typeof e)return vt(e);const{message:t}=Gt("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(un.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=Gt("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=Gt("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:i}=t;(0,W.toMiliseconds)(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(un.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((e,t)=>this.checkExpiry(t,e)))}registerEventListeners(){this.core.heartbeat.on(_.HEARTBEAT_EVENTS.pulse,(()=>this.checkExpirations())),this.events.on(un.created,(e=>{const t=un.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(un.expired,(e=>{const t=un.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(un.deleted,(e=>{const t=un.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Xn extends M{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=mn,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async e=>{if(this.verifyDisabled||st()||!rt())return;const t=this.getVerifyUrl(e?.verifyUrl);this.verifyUrl!==t&&this.removeIframe(),this.verifyUrl=t;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i)}if(!this.initialized){this.removeIframe(),this.verifyUrl=yn;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i),this.verifyDisabled=!0}}},this.register=async e=>{this.initialized?this.sendPost(e.attestationId):(this.addToQueue(e.attestationId),await this.init())},this.resolve=async e=>{if(this.isDevEnv)return"";const t=this.getVerifyUrl(e?.verifyUrl);let i;try{i=await this.fetchAttestation(e.attestationId,t)}catch(s){this.logger.info(`failed to resolve attestation: ${e.attestationId} from url: ${t}`),this.logger.info(s),i=await this.fetchAttestation(e.attestationId,yn)}return i},this.fetchAttestation=async(e,t)=>{this.logger.info(`resolving attestation: ${e} from url: ${t}`);const i=this.startAbortTimer(2*W.ONE_SECOND),s=await fetch(`${t}/attestation/${e}`,{signal:this.abortController.signal});return clearTimeout(i),200===s.status?await s.json():void 0},this.addToQueue=e=>{this.queue.push(e)},this.processQueue=()=>{0!==this.queue.length&&(this.queue.forEach((e=>this.sendPost(e))),this.queue=[])},this.sendPost=e=>{var t;try{if(!this.iframe)return;null==(t=this.iframe.contentWindow)||t.postMessage(e,"*"),this.logger.info(`postMessage sent: ${e} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let e;const t=i=>{"verify_ready"===i.data&&(this.onInit(),window.removeEventListener("message",t),e())};await Promise.race([new Promise((i=>{const s=document.getElementById(mn);if(s)return this.iframe=s,this.onInit(),i();window.addEventListener("message",t);const r=document.createElement("iframe");r.id=mn,r.src=`${this.verifyUrl}/${this.projectId}`,r.style.display="none",document.body.append(r),this.iframe=r,e=i})),new Promise(((e,i)=>setTimeout((()=>{window.removeEventListener("message",t),i("verify iframe load timeout")}),(0,W.toMiliseconds)(W.FIVE_SECONDS))))])},this.onInit=()=>{this.initialized=!0,this.processQueue()},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=e=>{let t=e||wn;return fn.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${wn}`),t=wn),t},this.logger=(0,S.generateChildLogger)(t,this.name),this.verifyUrl=wn,this.abortController=new AbortController,this.isDevEnv=it()&&{NODE_ENV:"production",BASE_URL:"/"}.IS_VITEST}get context(){return(0,S.getLoggerContext)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout((()=>this.abortController.abort()),(0,W.toMiliseconds)(e))}}class ea extends L{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=bn,this.registerDeviceToken=async e=>{const{clientId:t,token:i,notificationType:s,enableEncrypted:r=!1}=e,o=`${vn}/${this.projectId}/clients`;await ks()(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:s,token:i,always_raw:r})})},this.logger=(0,S.generateChildLogger)(t,this.context)}}var ta=Object.defineProperty,ia=Object.getOwnPropertySymbols,sa=Object.prototype.hasOwnProperty,ra=Object.prototype.propertyIsEnumerable,oa=(e,t,i)=>t in e?ta(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,na=(e,t)=>{for(var i in t||(t={}))sa.call(t,i)&&oa(e,i,t[i]);if(ia)for(var i of ia(t))ra.call(t,i)&&oa(e,i,t[i]);return e};class aa extends P{constructor(e){super(e),this.protocol=So,this.version=Co,this.name=Po,this.events=new s.EventEmitter,this.initialized=!1,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Vo,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,S.pino)((0,S.getDefaultLoggerOptions)({level:e?.logger||Ro.logger}));this.logger=(0,S.generateChildLogger)(t,this.name),this.heartbeat=new _.HeartBeat,this.crypto=new xn(this,this.logger,e?.keychain),this.history=new Qn(this,this.logger),this.expirer=new Jn(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new O(na(na({},To),e?.storageOptions)),this.relayer=new Wn({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Gn(this,this.logger),this.verify=new Xn(this.projectId||"",this.logger),this.echoClient=new ea(this.projectId||"",this.logger)}static async init(e){const t=new aa(e);await t.initialize();const i=await t.crypto.getClientId();return await t.storage.setItem(Xo,i),t}get context(){return(0,S.getLoggerContext)(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const ca=aa,la="wc",ha=2,da="client",pa=`${la}@${ha}:${da}:`,ua={name:da,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},ga="WALLETCONNECT_DEEPLINK_CHOICE",ma="proposal",wa="Proposal expired",ya="session",fa=W.SEVEN_DAYS,ba="engine",va={wc_sessionPropose:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1104},res:{ttl:W.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1106},res:{ttl:W.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1112},res:{ttl:W.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1114},res:{ttl:W.ONE_DAY,prompt:!1,tag:1115}}},Ea={min:W.FIVE_MINUTES,max:W.SEVEN_DAYS},xa={idle:"IDLE",active:"ACTIVE"},Ia="request",Oa=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var _a=Object.defineProperty,Sa=Object.defineProperties,Ca=Object.getOwnPropertyDescriptors,Pa=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,Ra=Object.prototype.propertyIsEnumerable,Ta=(e,t,i)=>t in e?_a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Da=(e,t)=>{for(var i in t||(t={}))Na.call(t,i)&&Ta(e,i,t[i]);if(Pa)for(var i of Pa(t))Ra.call(t,i)&&Ta(e,i,t[i]);return e},ka=(e,t)=>Sa(e,Ca(t));class Aa extends j{constructor(e){super(e),this.name=ba,this.events=new(r()),this.initialized=!1,this.ignoredPayloadTypes=[Pe],this.requestQueue={state:xa.idle,queue:[]},this.sessionRequestQueue={state:xa.idle,queue:[]},this.requestQueueDelay=W.ONE_SECOND,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(va)}),this.initialized=!0,setTimeout((()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()}),(0,W.toMiliseconds)(this.requestQueueDelay)))},this.connect=async e=>{await this.isInitialized();const t=ka(Da({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:r,sessionProperties:o,relays:n}=t;let a,c=i,l=!1;try{c&&(l=this.client.core.pairing.pairings.get(c).active)}catch(f){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),f}if(!c||!l){const{topic:e,uri:t}=await this.client.core.pairing.create();c=e,a=t}if(!c){const{message:e}=Gt("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(e)}const h=await this.client.core.crypto.generateKeyPair(),d=va.wc_sessionPropose.req.ttl||W.FIVE_MINUTES,p=xt(d),u=Da({requiredNamespaces:s,optionalNamespaces:r,relays:n??[{protocol:zo}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:p},o&&{sessionProperties:o}),{reject:g,resolve:m,done:w}=wt(d,wa);this.events.once(Ot("session_connect"),(async({error:e,session:t})=>{if(e)g(e);else if(t){t.self.publicKey=h;const e=ka(Da({},t),{requiredNamespaces:u.requiredNamespaces,optionalNamespaces:u.optionalNamespaces});await this.client.session.set(t.topic,e),await this.setExpiry(t.topic,t.expiry),c&&await this.client.core.pairing.updateMetadata({topic:c,metadata:t.peer.metadata}),m(e)}}));const y=await this.sendRequest({topic:c,method:"wc_sessionPropose",params:u,throwOnFailedPublish:!0});return await this.setProposal(y,Da({id:y},u)),{uri:a,approval:w}},this.pair=async e=>{await this.isInitialized();try{return await this.client.core.pairing.pair(e)}catch(t){throw this.client.logger.error("pair() failed"),t}},this.approve=async e=>{await this.isInitialized();try{await this.isValidApprove(e)}catch(g){throw this.client.logger.error("approve() -> isValidApprove() failed"),g}const{id:t,relayProtocol:i,namespaces:s,sessionProperties:r}=e;let o;try{o=this.client.proposal.get(t)}catch(g){throw this.client.logger.error(`approve() -> proposal.get(${t}) failed`),g}let{pairingTopic:n,proposer:a,requiredNamespaces:c,optionalNamespaces:l}=o;n=n||"";const h=await this.client.core.crypto.generateKeyPair(),d=a.publicKey,p=await this.client.core.crypto.generateSharedKey(h,d),u=Da({relay:{protocol:i??"irn"},namespaces:s,pairingTopic:n,controller:{publicKey:h,metadata:this.client.metadata},expiry:xt(fa)},r&&{sessionProperties:r});await this.client.core.relayer.subscribe(p);const m=ka(Da({},u),{topic:p,requiredNamespaces:c,optionalNamespaces:l,pairingTopic:n,acknowledged:!1,self:u.controller,peer:{publicKey:a.publicKey,metadata:a.metadata},controller:h});await this.client.session.set(p,m);try{await this.sendResult({id:t,topic:n,result:{relay:{protocol:i??"irn"},responderPublicKey:h},throwOnFailedPublish:!0}),await this.sendRequest({topic:p,method:"wc_sessionSettle",params:u,throwOnFailedPublish:!0})}catch(g){throw this.client.logger.error(g),this.client.session.delete(p,Qt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(p),g}return await this.client.core.pairing.updateMetadata({topic:n,metadata:a.metadata}),await this.client.proposal.delete(t,Qt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:n}),await this.setExpiry(p,xt(fa)),{topic:p,acknowledged:()=>new Promise((e=>setTimeout((()=>e(this.client.session.get(p))),500)))}},this.reject=async e=>{await this.isInitialized();try{await this.isValidReject(e)}catch(r){throw this.client.logger.error("reject() -> isValidReject() failed"),r}const{id:t,reason:i}=e;let s;try{s=this.client.proposal.get(t).pairingTopic}catch(r){throw this.client.logger.error(`reject() -> proposal.get(${t}) failed`),r}s&&(await this.sendError(t,s,i),await this.client.proposal.delete(t,Qt("USER_DISCONNECTED")))},this.update=async e=>{await this.isInitialized();try{await this.isValidUpdate(e)}catch(k){throw this.client.logger.error("update() -> isValidUpdate() failed"),k}const{topic:t,namespaces:i}=e,{done:s,resolve:r,reject:o}=wt(),n=rs(),a=os().toString(),c=this.client.session.get(t).namespaces;return this.events.once(Ot("session_update",n),(async({error:e})=>{e?o(e):(await this.client.session.update(t,{namespaces:i}),r())})),this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:a}).catch((e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),o(e)})),{acknowledged:s}},this.extend=async e=>{await this.isInitialized();try{await this.isValidExtend(e)}catch(R){throw this.client.logger.error("extend() -> isValidExtend() failed"),R}const{topic:t}=e,i=rs(),{done:s,resolve:r,reject:o}=wt();return this.events.once(Ot("session_extend",i),(({error:e})=>{e?o(e):r()})),await this.setExpiry(t,xt(fa)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch((e=>{o(e)})),{acknowledged:s}},this.request=async e=>{await this.isInitialized();try{await this.isValidRequest(e)}catch(O){throw this.client.logger.error("request() -> isValidRequest() failed"),O}const{chainId:t,request:i,topic:s,expiry:r=va.wc_sessionRequest.req.ttl}=e,o=rs(),n=os().toString(),{done:a,resolve:c,reject:l}=wt(r,"Request expired. Please try again.");return this.events.once(Ot("session_request",o),(({error:e,result:t})=>{e?l(e):c(t)})),await Promise.all([new Promise((async e=>{await this.sendRequest({clientRpcId:o,relayRpcId:n,topic:s,method:"wc_sessionRequest",params:{request:ka(Da({},i),{expiryTimestamp:xt(r)}),chainId:t},expiry:r,throwOnFailedPublish:!0}).catch((e=>l(e))),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:t,id:o}),e()})),new Promise((async e=>{const t=await St(this.client.core.storage,ga);_t({id:o,topic:s,wcDeepLink:t}),e()})),a()]).then((e=>e[2]))},this.respond=async e=>{await this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:i}=e,{id:s}=i;Es(i)?await this.sendResult({id:s,topic:t,result:i.result,throwOnFailedPublish:!0}):xs(i)&&await this.sendError(s,t,i.error),this.cleanupAfterResponse(e)},this.ping=async e=>{await this.isInitialized();try{await this.isValidPing(e)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=rs(),i=os().toString(),{done:s,resolve:r,reject:o}=wt();this.events.once(Ot("session_ping",e),(({error:e})=>{e?o(e):r()})),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:i}),s()])}else this.client.core.pairing.pairings.keys.includes(t)&&await this.client.core.pairing.ping({topic:t})},this.emit=async e=>{await this.isInitialized(),await this.isValidEmit(e);const{topic:t,event:i,chainId:s}=e,r=os().toString();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:i,chainId:s},throwOnFailedPublish:!0,relayRpcId:r})},this.disconnect=async e=>{await this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:Qt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else{if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=Gt("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw new Error(e)}await this.client.core.pairing.disconnect({topic:t})}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter((t=>si(t,e)))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter((i=>{var s,r;return(null==(s=i.peerMetadata)?void 0:s.url)&&(null==(r=i.peerMetadata)?void 0:r.url)===e.peer.metadata.url&&i.topic&&i.topic!==t.topic}));if(0===i.length)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map((e=>this.client.core.pairing.disconnect({topic:e.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(t){this.client.logger.error(t)}},this.deleteSession=async e=>{const{topic:t,expirerHasDeleted:i=!1,emitEvent:s=!0,id:r=0}=e,{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await this.client.session.delete(t,Qt("USER_DISCONNECTED")),this.addToRecentlyDeleted(t,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),i||this.client.core.expirer.del(t),this.client.core.storage.removeItem(ga).catch((e=>this.client.logger.warn(e))),this.getPendingSessionRequests().forEach((e=>{e.topic===t&&this.deletePendingSessionRequest(e.id,Qt("USER_DISCONNECTED"))})),s&&this.client.events.emit("session_delete",{id:r,topic:t})},this.deleteProposal=async(e,t)=>{await Promise.all([this.client.proposal.delete(e,Qt("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,t,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),i?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter((t=>t.id!==e)),i&&(this.sessionRequestQueue.state=xa.idle,this.client.events.emit("session_request_expire",{id:e}))},this.setExpiry=async(e,t)=>{this.client.session.keys.includes(e)&&await this.client.session.update(e,{expiry:t}),this.client.core.expirer.set(e,t)},this.setProposal=async(e,t)=>{await this.client.proposal.set(e,t),this.client.core.expirer.set(e,xt(va.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async e=>{const{id:t,topic:i,params:s,verifyContext:r}=e,o=s.request.expiryTimestamp||xt(va.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(t,{id:t,topic:i,params:s,verifyContext:r}),o&&this.client.core.expirer.set(t,o)},this.sendRequest=async e=>{const{topic:t,method:i,params:s,expiry:r,relayRpcId:o,clientRpcId:n,throwOnFailedPublish:a}=e,c=ns(i,s,n);if(rt()&&Oa.includes(i)){const e=Le(JSON.stringify(c));this.client.core.verify.register({attestationId:e})}let l;try{l=await this.client.core.crypto.encode(t,c)}catch(D){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${t} failed`),D}const h=va[i].req;return r&&(h.ttl=r),o&&(h.id=o),this.client.core.history.set(t,c),a?(h.internal=ka(Da({},h.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(t,l,h)):this.client.core.relayer.publish(t,l,h).catch((e=>this.client.logger.error(e))),c.id},this.sendResult=async e=>{const{id:t,topic:i,result:s,throwOnFailedPublish:r}=e,o=as(t,s);let n,a;try{n=await this.client.core.crypto.encode(i,o)}catch(k){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),k}try{a=await this.client.core.history.get(i,t)}catch(k){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${t}) failed`),k}const c=va[a.request.method].res;r?(c.internal=ka(Da({},c.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,n,c)):this.client.core.relayer.publish(i,n,c).catch((e=>this.client.logger.error(e))),await this.client.core.history.resolve(o)},this.sendError=async(e,t,i)=>{const s=cs(e,i);let r,o;try{r=await this.client.core.crypto.encode(t,s)}catch(a){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${t} failed`),a}try{o=await this.client.core.history.get(t,e)}catch(a){throw this.client.logger.error(`sendError() -> history.get(${t}, ${e}) failed`),a}const n=va[o.request.method].res;this.client.core.relayer.publish(t,r,n),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const e=[],t=[];this.client.session.getAll().forEach((t=>{let i=!1;It(t.expiry)&&(i=!0),this.client.core.crypto.keychain.has(t.topic)||(i=!0),i&&e.push(t.topic)})),this.client.proposal.getAll().forEach((e=>{It(e.expiryTimestamp)&&t.push(e.id)})),await Promise.all([...e.map((e=>this.deleteSession({topic:e}))),...t.map((e=>this.deleteProposal(e)))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state!==xa.active){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=xa.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise((e=>setTimeout(e,300)))}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=xa.idle}else this.client.logger.info("Request queue already active, skipping...")},this.processRequest=e=>{const{topic:t,payload:i}=e,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(t,i);case"wc_sessionSettle":return this.onSessionSettleRequest(t,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(t,i);case"wc_sessionExtend":return this.onSessionExtendRequest(t,i);case"wc_sessionPing":return this.onSessionPingRequest(t,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(t,i);case"wc_sessionRequest":return this.onSessionRequest(t,i);case"wc_sessionEvent":return this.onSessionEventRequest(t,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async e=>{const{topic:t,payload:i}=e,s=(await this.client.core.history.get(t,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,i);case"wc_sessionExtend":return this.onSessionExtendResponse(t,i);case"wc_sessionPing":return this.onSessionPingResponse(t,i);case"wc_sessionRequest":return this.onSessionRequestResponse(t,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:t}=e,{message:i}=Gt("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(i)},this.onSessionProposeRequest=async(e,t)=>{const{params:i,id:s}=t;try{this.isValidConnect(Da({},t.params));const r=i.expiryTimestamp||xt(va.wc_sessionPropose.req.ttl),o=Da({id:s,pairingTopic:e,expiryTimestamp:r},i);await this.setProposal(s,o);const n=Le(JSON.stringify(t)),a=await this.getVerifyContext(n,o.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:o,verifyContext:a})}catch(r){await this.sendError(s,e,r),this.client.logger.error(r)}},this.onSessionProposeResponse=async(e,t)=>{const{id:i}=t;if(Es(t)){const{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const r=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:r});const o=r.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});const n=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:n});const a=await this.client.core.crypto.generateSharedKey(o,n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:a});const c=await this.client.core.relayer.subscribe(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else if(xs(t)){await this.client.proposal.delete(i,Qt("USER_DISCONNECTED"));const e=Ot("session_connect");if(0===this.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);this.events.emit(Ot("session_connect"),{error:t.error})}},this.onSessionSettleRequest=async(e,t)=>{const{id:i,params:s}=t;try{this.isValidSessionSettleRequest(s);const{relay:i,controller:r,expiry:o,namespaces:n,sessionProperties:a,pairingTopic:c}=t.params,l=Da({topic:e,relay:i,expiry:o,namespaces:n,acknowledged:!0,pairingTopic:c,requiredNamespaces:{},optionalNamespaces:{},controller:r.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:r.publicKey,metadata:r.metadata}},a&&{sessionProperties:a});await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0});const h=Ot("session_connect");if(0===this.events.listenerCount(h))throw new Error(`emitting ${h} without any listeners 997`);this.events.emit(Ot("session_connect"),{session:l}),this.cleanupDuplicatePairings(l)}catch(r){await this.sendError(i,e,r),this.client.logger.error(r)}},this.onSessionSettleResponse=async(e,t)=>{const{id:i}=t;Es(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(Ot("session_approve",i),{})):xs(t)&&(await this.client.session.delete(e,Qt("USER_DISCONNECTED")),this.events.emit(Ot("session_approve",i),{error:t.error}))},this.onSessionUpdateRequest=async(e,t)=>{const{params:i,id:s}=t;try{const t=`${e}_session_update`,r=Vi.get(t);if(r&&this.isRequestOutOfSync(r,s))return this.client.logger.info(`Discarding out of sync request - ${s}`),void this.sendError(s,e,Qt("INVALID_UPDATE_REQUEST"));this.isValidUpdate(Da({topic:e},i));try{Vi.set(t,s),await this.client.session.update(e,{namespaces:i.namespaces}),await this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0})}catch(R){throw Vi.delete(t),R}this.client.events.emit("session_update",{id:s,topic:e,params:i})}catch(r){await this.sendError(s,e,r),this.client.logger.error(r)}},this.isRequestOutOfSync=(e,t)=>parseInt(t.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,t)=>{const{id:i}=t,s=Ot("session_update",i);if(0===this.events.listenerCount(s))throw new Error(`emitting ${s} without any listeners`);Es(t)?this.events.emit(Ot("session_update",i),{}):xs(t)&&this.events.emit(Ot("session_update",i),{error:t.error})},this.onSessionExtendRequest=async(e,t)=>{const{id:i}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,xt(fa)),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:e})}catch(s){await this.sendError(i,e,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(e,t)=>{const{id:i}=t,s=Ot("session_extend",i);if(0===this.events.listenerCount(s))throw new Error(`emitting ${s} without any listeners`);Es(t)?this.events.emit(Ot("session_extend",i),{}):xs(t)&&this.events.emit(Ot("session_extend",i),{error:t.error})},this.onSessionPingRequest=async(e,t)=>{const{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:e})}catch(s){await this.sendError(i,e,s),this.client.logger.error(s)}},this.onSessionPingResponse=(e,t)=>{const{id:i}=t,s=Ot("session_ping",i);if(0===this.events.listenerCount(s))throw new Error(`emitting ${s} without any listeners`);setTimeout((()=>{Es(t)?this.events.emit(Ot("session_ping",i),{}):xs(t)&&this.events.emit(Ot("session_ping",i),{error:t.error})}),500)},this.onSessionDeleteRequest=async(e,t)=>{const{id:i}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise((t=>{this.client.core.relayer.once(Ho.publish,(async()=>{t(await this.deleteSession({topic:e,id:i}))}))})),this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Qt("USER_DISCONNECTED")})])}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async(e,t)=>{const{id:i,params:s}=t;try{this.isValidRequest(Da({topic:e},s));const t=Le(JSON.stringify(ns("wc_sessionRequest",s,i))),r=this.client.session.get(e),o=await this.getVerifyContext(t,r.peer.metadata),n={id:i,topic:e,params:s,verifyContext:o};await this.setPendingSessionRequest(n),this.addSessionRequestToSessionRequestQueue(n),this.processSessionRequestQueue()}catch(r){await this.sendError(i,e,r),this.client.logger.error(r)}},this.onSessionRequestResponse=(e,t)=>{const{id:i}=t,s=Ot("session_request",i);if(0===this.events.listenerCount(s))throw new Error(`emitting ${s} without any listeners`);Es(t)?this.events.emit(Ot("session_request",i),{result:t.result}):xs(t)&&this.events.emit(Ot("session_request",i),{error:t.error})},this.onSessionEventRequest=async(e,t)=>{const{id:i,params:s}=t;try{const t=`${e}_session_event_${s.event.name}`,r=Vi.get(t);if(r&&this.isRequestOutOfSync(r,i))return void this.client.logger.info(`Discarding out of sync request - ${i}`);this.isValidEmit(Da({topic:e},s)),this.client.events.emit("session_event",{id:i,topic:e,params:s}),Vi.set(t,i)}catch(r){await this.sendError(i,e,r),this.client.logger.error(r)}},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.sessionRequestQueue.state=xa.idle,this.processSessionRequestQueue()}),(0,W.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:t})=>{const i=this.client.core.history.pending;i.length>0&&i.filter((t=>t.topic===e&&"wc_sessionRequest"===t.request.method)).forEach((e=>{const i=e.request.id,s=Ot("session_request",i);if(0===this.events.listenerCount(s))throw new Error(`emitting ${s} without any listeners`);this.events.emit(Ot("session_request",e.request.id),{error:t})}))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===xa.active)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.sessionRequestQueue.state=xa.active,this.client.events.emit("session_request",e)}catch(t){this.client.logger.error(t)}else this.client.logger.info("session request queue is empty.")},this.onPairingCreated=e=>{if(e.active)return;const t=this.client.proposal.getAll().find((t=>t.pairingTopic===e.topic));t&&this.onSessionProposeRequest(e.topic,ns("wc_sessionPropose",{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties},t.id))},this.isValidConnect=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:r,relays:o}=e;if(ei(t)||await this.isValidPairingTopic(t),!vi(o,!0)){const{message:e}=Gt("MISSING_OR_INVALID",`connect() relays: ${o}`);throw new Error(e)}!ei(i)&&0!==Xt(i)&&this.validateNamespaces(i,"requiredNamespaces"),!ei(s)&&0!==Xt(s)&&this.validateNamespaces(s,"optionalNamespaces"),ei(r)||this.validateSessionProps(r,"sessionProperties")},this.validateNamespaces=(e,t)=>{const i=yi(e,"connect()",t);if(i)throw new Error(i.message)},this.isValidApprove=async e=>{if(!xi(e))throw new Error(Gt("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:i,relayProtocol:s,sessionProperties:r}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);const o=this.client.proposal.get(t),n=fi(i,"approve()");if(n)throw new Error(n.message);const a=Ri(o.requiredNamespaces,i,"approve()");if(a)throw new Error(a.message);if(!ti(s,!0)){const{message:e}=Gt("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(e)}ei(r)||this.validateSessionProps(r,"sessionProperties")},this.isValidReject=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:i}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!Ii(i)){const{message:e}=Gt("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(e)}},this.isValidSessionSettleRequest=e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:i,namespaces:s,expiry:r}=e;if(!bi(t)){const{message:e}=Gt("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const o=li(i,"onSessionSettleRequest()");if(o)throw new Error(o.message);const n=fi(s,"onSessionSettleRequest()");if(n)throw new Error(n.message);if(It(r)){const{message:e}=Gt("EXPIRED","onSessionSettleRequest()");throw new Error(e)}},this.isValidUpdate=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const s=this.client.session.get(t),r=fi(i,"update()");if(r)throw new Error(r.message);const o=Ri(s.requiredNamespaces,i,"update()");if(o)throw new Error(o.message)},this.isValidExtend=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)},this.isValidRequest=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:i,chainId:s,expiry:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const{namespaces:o}=this.client.session.get(t);if(!Ci(o,s)){const{message:e}=Gt("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(e)}if(!Oi(i)){const{message:e}=Gt("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(e)}if(!Pi(o,s,i.method)){const{message:e}=Gt("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(e)}if(r&&!Ai(r,Ea)){const{message:e}=Gt("MISSING_OR_INVALID",`request() expiry: ${r}. Expiry must be a number (in seconds) between ${Ea.min} and ${Ea.max}`);throw new Error(e)}},this.isValidRespond=async e=>{var t;if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:i,response:s}=e;try{await this.isValidSessionTopic(i)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(!_i(s)){const{message:e}=Gt("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(e)}},this.isValidPing=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidEmit=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:i,chainId:s}=e;await this.isValidSessionTopic(t);const{namespaces:r}=this.client.session.get(t);if(!Ci(r,s)){const{message:e}=Gt("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(e)}if(!Si(i)){const{message:e}=Gt("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(e)}if(!Ni(r,s,i.name)){const{message:e}=Gt("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(e)}},this.isValidDisconnect=async e=>{if(!xi(e)){const{message:t}=Gt("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.getVerifyContext=async(e,t)=>{const i={verified:{verifyUrl:t.verifyUrl||wn,validation:"UNKNOWN",origin:t.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:e,verifyUrl:t.verifyUrl});s&&(i.verified.origin=s.origin,i.verified.isScam=s.isScam,i.verified.validation=s.origin===new URL(t.url).origin?"VALID":"INVALID")}catch(s){this.client.logger.info(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(i)}`),i},this.validateSessionProps=(e,t)=>{Object.values(e).forEach((e=>{if(!ti(e,!1)){const{message:i}=Gt("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw new Error(i)}}))},this.addToRecentlyDeleted=(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const i of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(i)}}},this.checkRecentlyDeleted=e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:i}=Gt("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(i)}}}async isInitialized(){if(!this.initialized){const{message:e}=Gt("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ho.message,(async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const s=await this.client.core.crypto.decode(t,i);try{bs(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):vs(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.client.core.history.delete(t,s.id)):this.onRelayEventUnknownPayload({topic:t,payload:s})}catch(r){this.client.logger.error(r)}}))}registerExpirerEvents(){this.client.core.expirer.on(un.expired,(async e=>{const{topic:t,id:i}=Et(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,Gt("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))}))}registerPairingEvents(){this.client.core.pairing.events.on(cn.create,(e=>this.onPairingCreated(e))),this.client.core.pairing.events.on(cn.delete,(e=>{this.addToRecentlyDeleted(e.topic,"pairing")}))}isValidPairingTopic(e){if(!ti(e,!1)){const{message:t}=Gt("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Gt("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(It(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Gt("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!ti(e,!1)){const{message:t}=Gt("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=Gt("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(It(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=Gt("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=Gt("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(ti(e,!1)){const{message:t}=Gt("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=Gt("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if(!Ei(e)){const{message:t}=Gt("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Gt("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(It(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=Gt("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class $a extends Zn{constructor(e,t){super(e,t,ma,pa),this.core=e,this.logger=t}}class Ma extends Zn{constructor(e,t){super(e,t,ya,pa),this.core=e,this.logger=t}}class La extends Zn{constructor(e,t){super(e,t,Ia,pa,(e=>e.id)),this.core=e,this.logger=t}}class Ua extends U{constructor(e){super(e),this.protocol=la,this.version=ha,this.name=ua.name,this.events=new s.EventEmitter,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.removeAllListeners=e=>this.events.removeAllListeners(e),this.connect=async e=>{try{return await this.engine.connect(e)}catch(t){throw this.logger.error(t.message),t}},this.pair=async e=>{try{return await this.engine.pair(e)}catch(t){throw this.logger.error(t.message),t}},this.approve=async e=>{try{return await this.engine.approve(e)}catch(t){throw this.logger.error(t.message),t}},this.reject=async e=>{try{return await this.engine.reject(e)}catch(t){throw this.logger.error(t.message),t}},this.update=async e=>{try{return await this.engine.update(e)}catch(t){throw this.logger.error(t.message),t}},this.extend=async e=>{try{return await this.engine.extend(e)}catch(t){throw this.logger.error(t.message),t}},this.request=async e=>{try{return await this.engine.request(e)}catch(t){throw this.logger.error(t.message),t}},this.respond=async e=>{try{return await this.engine.respond(e)}catch(t){throw this.logger.error(t.message),t}},this.ping=async e=>{try{return await this.engine.ping(e)}catch(t){throw this.logger.error(t.message),t}},this.emit=async e=>{try{return await this.engine.emit(e)}catch(t){throw this.logger.error(t.message),t}},this.disconnect=async e=>{try{return await this.engine.disconnect(e)}catch(t){throw this.logger.error(t.message),t}},this.find=e=>{try{return this.engine.find(e)}catch(t){throw this.logger.error(t.message),t}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.name=e?.name||ua.name,this.metadata=e?.metadata||ct();const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,S.pino)((0,S.getDefaultLoggerOptions)({level:e?.logger||ua.logger}));this.core=e?.core||new ca(e),this.logger=(0,S.generateChildLogger)(t,this.name),this.session=new Ma(this.core,this.logger),this.proposal=new $a(this.core,this.logger),this.pendingRequest=new La(this.core,this.logger),this.engine=new Aa(this)}static async init(e){const t=new Ua(e);return await t.initialize(),t}get context(){return(0,S.getLoggerContext)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(P){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(P.message),P}}}},98172:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(94608),t),s.__exportStar(i(47471),t)},94608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},47471:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},45735:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(43298),t),s.__exportStar(i(21115),t),s.__exportStar(i(85502),t),s.__exportStar(i(98172),t)},85502:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(40868),t)},40868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;class i{}t.IWatch=i},3258:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;const s=i(98172);function r(e){return e*s.ONE_THOUSAND}function o(e){return Math.floor(e/s.ONE_THOUSAND)}t.toMiliseconds=r,t.fromMiliseconds=o},13013:(e,t)=>{"use strict";function i(e){return new Promise((t=>{setTimeout((()=>{t(!0)}),e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=i},43298:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(70655);s.__exportStar(i(13013),t),s.__exportStar(i(3258),t)},21115:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if("undefined"!==typeof t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const i=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:i})}get(e){const t=this.timestamps.get(e);if("undefined"===typeof t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e),i=t.elapsed||Date.now()-t.started;return i}}t.Watch=i,t["default"]=i},67313:(e,t)=>{"use strict";function i(e){let t;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function s(e){const t=i(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}function r(){return s("document")}function o(){return i("document")}function n(){return s("navigator")}function a(){return i("navigator")}function c(){return s("location")}function l(){return i("location")}function h(){return s("crypto")}function d(){return i("crypto")}function p(){return s("localStorage")}function u(){return i("localStorage")}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=i,t.getFromWindowOrThrow=s,t.getDocumentOrThrow=r,t.getDocument=o,t.getNavigatorOrThrow=n,t.getNavigator=a,t.getLocationOrThrow=c,t.getLocation=l,t.getCryptoOrThrow=h,t.getCrypto=d,t.getLocalStorageOrThrow=p,t.getLocalStorage=u},97217:(e,t,i)=>{"use strict";i(70560),t.D=void 0;const s=i(67313);function r(){let e,t;try{e=s.getDocumentOrThrow(),t=s.getLocationOrThrow()}catch(p){return null}function i(){const i=e.getElementsByTagName("link"),s=[];for(let e=0;e<i.length;e++){const r=i[e],o=r.getAttribute("rel");if(o&&o.toLowerCase().indexOf("icon")>-1){const e=r.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let i=t.protocol+"//"+t.host;if(0===e.indexOf("/"))i+=e;else{const s=t.pathname.split("/");s.pop();const r=s.join("/");i+=r+"/"+e}s.push(i)}else if(0===e.indexOf("//")){const i=t.protocol+e;s.push(i)}else s.push(e)}}return s}function r(...t){const i=e.getElementsByTagName("meta");for(let e=0;e<i.length;e++){const s=i[e],r=["itemprop","property","name"].map((e=>s.getAttribute(e))).filter((e=>!!e&&t.includes(e)));if(r.length&&r){const e=s.getAttribute("content");if(e)return e}}return""}function o(){let t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}function n(){const e=r("description","og:description","twitter:description","keywords");return e}const a=o(),c=n(),l=t.origin,h=i(),d={description:c,url:l,icons:h,name:a};return d}t.D=r},29568:(e,t,i)=>{"use strict";i.d(t,{AV:()=>o,ConfigCtrl:()=>u,ExplorerCtrl:()=>k,OptionsCtrl:()=>d,ThemeCtrl:()=>K,ToastCtrl:()=>H,jb:()=>$,uA:()=>l,zv:()=>n});i(70560),i(98858),i(61318);var s=i(17832);const r=(0,s.sj)({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),o={state:r,subscribe(e){return(0,s.Ld)(r,(()=>e(r)))},push(e,t){e!==r.view&&(r.view=e,t&&(r.data=t),r.history.push(e))},reset(e){r.view=e,r.history=[e]},replace(e){r.history.length>1&&(r.history[r.history.length-1]=e,r.view=e)},goBack(){if(r.history.length>1){r.history.pop();const[e]=r.history.slice(-1);r.view=e}},setData(e){r.data=e}},n={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"&&Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},isAndroid(){return n.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const e=navigator.userAgent.toLowerCase();return n.isMobile()&&(e.includes("iphone")||e.includes("ipad"))},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},isArray(e){return Array.isArray(e)&&e.length>0},formatNativeUrl(e,t,i){if(n.isHttpUrl(e))return this.formatUniversalUrl(e,t,i);let s=e;s.includes("://")||(s=e.replaceAll("/","").replaceAll(":",""),s=`${s}://`),s.endsWith("/")||(s=`${s}/`),this.setWalletConnectDeepLink(s,i);const r=encodeURIComponent(t);return`${s}wc?uri=${r}`},formatUniversalUrl(e,t,i){if(!n.isHttpUrl(e))return this.formatNativeUrl(e,t,i);let s=e;s.endsWith("/")||(s=`${s}/`),this.setWalletConnectDeepLink(s,i);const r=encodeURIComponent(t);return`${s}wc?uri=${r}`},async wait(e){return new Promise((t=>{setTimeout(t,e)}))},openHref(e,t){window.open(e,t,"noreferrer noopener")},setWalletConnectDeepLink(e,t){try{localStorage.setItem(n.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(e){try{const[t]=e.split("?");localStorage.setItem(n.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(n.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(n.WCM_VERSION,"2.6.2")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var e;const t=null==(e=o.state.data)?void 0:e.Wallet;if(!t)throw new Error('Missing "Wallet" view data');return t}},a=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),c=(0,s.sj)({enabled:a,userSessionId:"",events:[],connectedWalletId:void 0}),l={state:c,subscribe(e){return(0,s.Ld)(c.events,(()=>e((0,s.CO)(c.events[c.events.length-1]))))},initialize(){c.enabled&&typeof(null==crypto?void 0:crypto.randomUUID)<"u"&&(c.userSessionId=crypto.randomUUID())},setConnectedWalletId(e){c.connectedWalletId=e},click(e){if(c.enabled){const t={type:"CLICK",name:e.name,userSessionId:c.userSessionId,timestamp:Date.now(),data:e};c.events.push(t)}},track(e){if(c.enabled){const t={type:"TRACK",name:e.name,userSessionId:c.userSessionId,timestamp:Date.now(),data:e};c.events.push(t)}},view(e){if(c.enabled){const t={type:"VIEW",name:e.name,userSessionId:c.userSessionId,timestamp:Date.now(),data:e};c.events.push(t)}}},h=(0,s.sj)({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),d={state:h,subscribe(e){return(0,s.Ld)(h,(()=>e(h)))},setChains(e){h.chains=e},setWalletConnectUri(e){h.walletConnectUri=e},setIsCustomDesktop(e){h.isCustomDesktop=e},setIsCustomMobile(e){h.isCustomMobile=e},setIsDataLoaded(e){h.isDataLoaded=e},setIsUiLoaded(e){h.isUiLoaded=e},setIsAuth(e){h.isAuth=e}},p=(0,s.sj)({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),u={state:p,subscribe(e){return(0,s.Ld)(p,(()=>e(p)))},setConfig(e){var t,i;l.initialize(),d.setChains(e.chains),d.setIsAuth(Boolean(e.enableAuthMode)),d.setIsCustomMobile(Boolean(null==(t=e.mobileWallets)?void 0:t.length)),d.setIsCustomDesktop(Boolean(null==(i=e.desktopWallets)?void 0:i.length)),n.setModalVersionInStorage(),Object.assign(p,e)}};var g=Object.defineProperty,m=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,f=(e,t,i)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,b=(e,t)=>{for(var i in t||(t={}))w.call(t,i)&&f(e,i,t[i]);if(m)for(var i of m(t))y.call(t,i)&&f(e,i,t[i]);return e};const v="https://explorer-api.walletconnect.com",E="wcm",x="js-2.6.2";async function I(e,t){const i=b({sdkType:E,sdkVersion:x},t),s=new URL(e,v);return s.searchParams.append("projectId",u.state.projectId),Object.entries(i).forEach((([e,t])=>{t&&s.searchParams.append(e,String(t))})),(await fetch(s)).json()}const O={async getDesktopListings(e){return I("/w3m/v1/getDesktopListings",e)},async getMobileListings(e){return I("/w3m/v1/getMobileListings",e)},async getInjectedListings(e){return I("/w3m/v1/getInjectedListings",e)},async getAllListings(e){return I("/w3m/v1/getAllListings",e)},getWalletImageUrl(e){return`${v}/w3m/v1/getWalletImage/${e}?projectId=${u.state.projectId}&sdkType=${E}&sdkVersion=${x}`},getAssetImageUrl(e){return`${v}/w3m/v1/getAssetImage/${e}?projectId=${u.state.projectId}&sdkType=${E}&sdkVersion=${x}`}};var _=Object.defineProperty,S=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,N=(e,t,i)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,R=(e,t)=>{for(var i in t||(t={}))C.call(t,i)&&N(e,i,t[i]);if(S)for(var i of S(t))P.call(t,i)&&N(e,i,t[i]);return e};const T=n.isMobile(),D=(0,s.sj)({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),k={state:D,async getRecomendedWallets(){const{explorerRecommendedWalletIds:e,explorerExcludedWalletIds:t}=u.state;if("NONE"===e||"ALL"===t&&!e)return D.recomendedWallets;if(n.isArray(e)){const t={recommendedIds:e.join(",")},{listings:i}=await O.getAllListings(t),s=Object.values(i);s.sort(((t,i)=>{const s=e.indexOf(t.id),r=e.indexOf(i.id);return s-r})),D.recomendedWallets=s}else{const{chains:e,isAuth:i}=d.state,s=e?.join(","),r=n.isArray(t),o={page:1,sdks:i?"auth_v1":void 0,entries:n.RECOMMENDED_WALLET_AMOUNT,chains:s,version:2,excludedIds:r?t.join(","):void 0},{listings:a}=T?await O.getMobileListings(o):await O.getDesktopListings(o);D.recomendedWallets=Object.values(a)}return D.recomendedWallets},async getWallets(e){const t=R({},e),{explorerRecommendedWalletIds:i,explorerExcludedWalletIds:s}=u.state,{recomendedWallets:r}=D;if("ALL"===s)return D.wallets;r.length?t.excludedIds=r.map((e=>e.id)).join(","):n.isArray(i)&&(t.excludedIds=i.join(",")),n.isArray(s)&&(t.excludedIds=[t.excludedIds,s].filter(Boolean).join(",")),d.state.isAuth&&(t.sdks="auth_v1");const{page:o,search:a}=e,{listings:c,total:l}=T?await O.getMobileListings(t):await O.getDesktopListings(t),h=Object.values(c),p=a?"search":"wallets";return D[p]={listings:[...D[p].listings,...h],total:l,page:o??1},{listings:h,total:l}},getWalletImageUrl(e){return O.getWalletImageUrl(e)},getAssetImageUrl(e){return O.getAssetImageUrl(e)},resetSearch(){D.search={listings:[],total:0,page:1}}},A=(0,s.sj)({open:!1}),$={state:A,subscribe(e){return(0,s.Ld)(A,(()=>e(A)))},async open(e){return new Promise((t=>{const{isUiLoaded:i,isDataLoaded:s}=d.state;if(n.removeWalletConnectDeepLink(),d.setWalletConnectUri(e?.uri),d.setChains(e?.chains),o.reset("ConnectWallet"),i&&s)A.open=!0,t();else{const e=setInterval((()=>{const i=d.state;i.isUiLoaded&&i.isDataLoaded&&(clearInterval(e),A.open=!0,t())}),200)}}))},close(){A.open=!1}};var M=Object.defineProperty,L=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,q=(e,t,i)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,z=(e,t)=>{for(var i in t||(t={}))U.call(t,i)&&q(e,i,t[i]);if(L)for(var i of L(t))j.call(t,i)&&q(e,i,t[i]);return e};function W(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const V=(0,s.sj)({themeMode:W()?"dark":"light"}),K={state:V,subscribe(e){return(0,s.Ld)(V,(()=>e(V)))},setThemeConfig(e){const{themeMode:t,themeVariables:i}=e;t&&(V.themeMode=t),i&&(V.themeVariables=z({},i))}},B=(0,s.sj)({open:!1,message:"",variant:"success"}),H={state:B,subscribe(e){return(0,s.Ld)(B,(()=>e(B)))},openToast(e,t){B.open=!0,B.message=e,B.variant=t},closeToast(){B.open=!1}}},75016:(e,t,i)=>{"use strict";i.r(t),i.d(t,{WcmModal:()=>At,WcmQrCode:()=>Ie});i(70560);var s=i(43265),r=i(69065),o=i(8109),n=i(29568),a=i(33692),c=i(55817),l=i(35162),h=i(92592),d=Object.defineProperty,p=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,m=(e,t,i)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,w=(e,t)=>{for(var i in t||(t={}))u.call(t,i)&&m(e,i,t[i]);if(p)for(var i of p(t))g.call(t,i)&&m(e,i,t[i]);return e};function y(){var e;const t=null!=(e=n.ThemeCtrl.state.themeMode)?e:"dark",i={light:{foreground:{1:"rgb(20,20,20)",2:"rgb(121,134,134)",3:"rgb(158,169,169)"},background:{1:"rgb(255,255,255)",2:"rgb(241,243,243)",3:"rgb(228,231,231)"},overlay:"rgba(0,0,0,0.1)"},dark:{foreground:{1:"rgb(228,231,231)",2:"rgb(148,158,158)",3:"rgb(110,119,119)"},background:{1:"rgb(20,20,20)",2:"rgb(39,42,42)",3:"rgb(59,64,64)"},overlay:"rgba(255,255,255,0.1)"}}[t];return{"--wcm-color-fg-1":i.foreground[1],"--wcm-color-fg-2":i.foreground[2],"--wcm-color-fg-3":i.foreground[3],"--wcm-color-bg-1":i.background[1],"--wcm-color-bg-2":i.background[2],"--wcm-color-bg-3":i.background[3],"--wcm-color-overlay":i.overlay}}function f(){return{"--wcm-accent-color":"#3396FF","--wcm-accent-fill-color":"#FFFFFF","--wcm-z-index":"89","--wcm-background-color":"#3396FF","--wcm-background-border-radius":"8px","--wcm-container-border-radius":"30px","--wcm-wallet-icon-border-radius":"15px","--wcm-wallet-icon-large-border-radius":"30px","--wcm-wallet-icon-small-border-radius":"7px","--wcm-input-border-radius":"28px","--wcm-button-border-radius":"10px","--wcm-notification-border-radius":"36px","--wcm-secondary-button-border-radius":"28px","--wcm-icon-button-border-radius":"50%","--wcm-button-hover-highlight-border-radius":"10px","--wcm-text-big-bold-size":"20px","--wcm-text-big-bold-weight":"600","--wcm-text-big-bold-line-height":"24px","--wcm-text-big-bold-letter-spacing":"-0.03em","--wcm-text-big-bold-text-transform":"none","--wcm-text-xsmall-bold-size":"10px","--wcm-text-xsmall-bold-weight":"700","--wcm-text-xsmall-bold-line-height":"12px","--wcm-text-xsmall-bold-letter-spacing":"0.02em","--wcm-text-xsmall-bold-text-transform":"uppercase","--wcm-text-xsmall-regular-size":"12px","--wcm-text-xsmall-regular-weight":"600","--wcm-text-xsmall-regular-line-height":"14px","--wcm-text-xsmall-regular-letter-spacing":"-0.03em","--wcm-text-xsmall-regular-text-transform":"none","--wcm-text-small-thin-size":"14px","--wcm-text-small-thin-weight":"500","--wcm-text-small-thin-line-height":"16px","--wcm-text-small-thin-letter-spacing":"-0.03em","--wcm-text-small-thin-text-transform":"none","--wcm-text-small-regular-size":"14px","--wcm-text-small-regular-weight":"600","--wcm-text-small-regular-line-height":"16px","--wcm-text-small-regular-letter-spacing":"-0.03em","--wcm-text-small-regular-text-transform":"none","--wcm-text-medium-regular-size":"16px","--wcm-text-medium-regular-weight":"600","--wcm-text-medium-regular-line-height":"20px","--wcm-text-medium-regular-letter-spacing":"-0.03em","--wcm-text-medium-regular-text-transform":"none","--wcm-font-family":"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', sans-serif","--wcm-font-feature-settings":"'tnum' on, 'lnum' on, 'case' on","--wcm-success-color":"rgb(38,181,98)","--wcm-error-color":"rgb(242, 90, 103)","--wcm-overlay-background-color":"rgba(0, 0, 0, 0.3)","--wcm-overlay-backdrop-filter":"none"}}const b={getPreset(e){return f()[e]},setTheme(){const e=document.querySelector(":root"),{themeVariables:t}=n.ThemeCtrl.state;if(e){const i=w(w(w({},y()),f()),t);Object.entries(i).forEach((([t,i])=>e.style.setProperty(t,i)))}},globalCss:s.iv`*,::after,::before{margin:0;padding:0;box-sizing:border-box;font-style:normal;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent;backface-visibility:hidden}button{cursor:pointer;display:flex;justify-content:center;align-items:center;position:relative;border:none;background-color:transparent;transition:all .2s ease}@media (hover:hover) and (pointer:fine){button:active{transition:all .1s ease;transform:scale(.93)}}button::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;transition:background-color,.2s ease}button:disabled{cursor:not-allowed}button svg,button wcm-text{position:relative;z-index:1}input{border:none;outline:0;appearance:none}img{display:block}::selection{color:var(--wcm-accent-fill-color);background:var(--wcm-accent-color)}`},v=s.iv`button{border-radius:var(--wcm-secondary-button-border-radius);height:28px;padding:0 10px;background-color:var(--wcm-accent-color)}button path{fill:var(--wcm-accent-fill-color)}button::after{border-radius:inherit;border:1px solid var(--wcm-color-overlay)}button:disabled::after{background-color:transparent}.wcm-icon-left svg{margin-right:5px}.wcm-icon-right svg{margin-left:5px}button:active::after{background-color:var(--wcm-color-overlay)}.wcm-ghost,.wcm-ghost:active::after,.wcm-outline{background-color:transparent}.wcm-ghost:active{opacity:.5}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}.wcm-ghost:hover::after{background-color:transparent}.wcm-ghost:hover{opacity:.5}}button:disabled{background-color:var(--wcm-color-bg-3);pointer-events:none}.wcm-ghost::after{border-color:transparent}.wcm-ghost path{fill:var(--wcm-color-fg-2)}.wcm-outline path{fill:var(--wcm-accent-color)}.wcm-outline:disabled{background-color:transparent;opacity:.5}`;var E=Object.defineProperty,x=Object.getOwnPropertyDescriptor,I=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?x(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&E(t,i,o),o};let O=class extends s.oi{constructor(){super(...arguments),this.disabled=!1,this.iconLeft=void 0,this.iconRight=void 0,this.onClick=()=>null,this.variant="default"}render(){const e={"wcm-icon-left":void 0!==this.iconLeft,"wcm-icon-right":void 0!==this.iconRight,"wcm-ghost":"ghost"===this.variant,"wcm-outline":"outline"===this.variant};let t="inverse";return"ghost"===this.variant&&(t="secondary"),"outline"===this.variant&&(t="accent"),s.dy`<button class="${(0,o.$)(e)}" ?disabled="${this.disabled}" @click="${this.onClick}">${this.iconLeft}<wcm-text variant="small-regular" color="${t}"><slot></slot></wcm-text>${this.iconRight}</button>`}};O.styles=[b.globalCss,v],I([(0,r.Cb)({type:Boolean})],O.prototype,"disabled",2),I([(0,r.Cb)()],O.prototype,"iconLeft",2),I([(0,r.Cb)()],O.prototype,"iconRight",2),I([(0,r.Cb)()],O.prototype,"onClick",2),I([(0,r.Cb)()],O.prototype,"variant",2),O=I([(0,r.Mo)("wcm-button")],O);const _=s.iv`:host{display:inline-block}button{padding:0 15px 1px;height:40px;border-radius:var(--wcm-button-border-radius);color:var(--wcm-accent-fill-color);background-color:var(--wcm-accent-color)}button::after{content:'';top:0;bottom:0;left:0;right:0;position:absolute;background-color:transparent;border-radius:inherit;transition:background-color .2s ease;border:1px solid var(--wcm-color-overlay)}button:active::after{background-color:var(--wcm-color-overlay)}button:disabled{padding-bottom:0;background-color:var(--wcm-color-bg-3);color:var(--wcm-color-fg-3)}.wcm-secondary{color:var(--wcm-accent-color);background-color:transparent}.wcm-secondary::after{display:none}@media(hover:hover){button:hover::after{background-color:var(--wcm-color-overlay)}}`;var S=Object.defineProperty,C=Object.getOwnPropertyDescriptor,P=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?C(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&S(t,i,o),o};let N=class extends s.oi{constructor(){super(...arguments),this.disabled=!1,this.variant="primary"}render(){const e={"wcm-secondary":"secondary"===this.variant};return s.dy`<button ?disabled="${this.disabled}" class="${(0,o.$)(e)}"><slot></slot></button>`}};N.styles=[b.globalCss,_],P([(0,r.Cb)({type:Boolean})],N.prototype,"disabled",2),P([(0,r.Cb)()],N.prototype,"variant",2),N=P([(0,r.Mo)("wcm-button-big")],N);const R=s.iv`:host{background-color:var(--wcm-color-bg-2);border-top:1px solid var(--wcm-color-bg-3)}div{padding:10px 20px;display:inherit;flex-direction:inherit;align-items:inherit;width:inherit;justify-content:inherit}`;var T=Object.defineProperty,D=Object.getOwnPropertyDescriptor,k=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?D(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&T(t,i,o),o};let A=class extends s.oi{render(){return s.dy`<div><slot></slot></div>`}};A.styles=[b.globalCss,R],A=k([(0,r.Mo)("wcm-info-footer")],A);const $={CROSS_ICON:a.YP`<svg width="12" height="12" viewBox="0 0 12 12"><path d="M9.94 11A.75.75 0 1 0 11 9.94L7.414 6.353a.5.5 0 0 1 0-.708L11 2.061A.75.75 0 1 0 9.94 1L6.353 4.586a.5.5 0 0 1-.708 0L2.061 1A.75.75 0 0 0 1 2.06l3.586 3.586a.5.5 0 0 1 0 .708L1 9.939A.75.75 0 1 0 2.06 11l3.586-3.586a.5.5 0 0 1 .708 0L9.939 11Z" fill="#fff"/></svg>`,WALLET_CONNECT_LOGO:a.YP`<svg width="178" height="29" viewBox="0 0 178 29" id="wcm-wc-logo"><path d="M10.683 7.926c5.284-5.17 13.85-5.17 19.134 0l.636.623a.652.652 0 0 1 0 .936l-2.176 2.129a.343.343 0 0 1-.478 0l-.875-.857c-3.686-3.607-9.662-3.607-13.348 0l-.937.918a.343.343 0 0 1-.479 0l-2.175-2.13a.652.652 0 0 1 0-.936l.698-.683Zm23.633 4.403 1.935 1.895a.652.652 0 0 1 0 .936l-8.73 8.543a.687.687 0 0 1-.956 0L20.37 17.64a.172.172 0 0 0-.239 0l-6.195 6.063a.687.687 0 0 1-.957 0l-8.73-8.543a.652.652 0 0 1 0-.936l1.936-1.895a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .239 0l6.195-6.064a.687.687 0 0 1 .957 0l6.196 6.064a.172.172 0 0 0 .24 0l6.195-6.064a.687.687 0 0 1 .956 0ZM48.093 20.948l2.338-9.355c.139-.515.258-1.07.416-1.942.12.872.258 1.427.357 1.942l2.022 9.355h4.181l3.528-13.874h-3.21l-1.943 8.523a24.825 24.825 0 0 0-.456 2.457c-.158-.931-.317-1.625-.495-2.438l-1.883-8.542h-4.201l-2.042 8.542a41.204 41.204 0 0 0-.475 2.438 41.208 41.208 0 0 0-.476-2.438l-1.903-8.542h-3.349l3.508 13.874h4.083ZM63.33 21.304c1.585 0 2.596-.654 3.11-1.605-.059.297-.078.595-.078.892v.357h2.655V15.22c0-2.735-1.248-4.32-4.3-4.32-2.636 0-4.36 1.466-4.52 3.487h2.914c.1-.891.734-1.426 1.705-1.426.911 0 1.407.515 1.407 1.11 0 .435-.258.693-1.03.792l-1.388.159c-2.061.257-3.825 1.01-3.825 3.19 0 1.982 1.645 3.092 3.35 3.092Zm.891-2.041c-.773 0-1.348-.436-1.348-1.19 0-.733.655-1.09 1.645-1.268l.674-.119c.575-.118.892-.218 1.09-.396v.912c0 1.228-.892 2.06-2.06 2.06ZM70.398 7.074v13.874h2.874V7.074h-2.874ZM74.934 7.074v13.874h2.874V7.074h-2.874ZM84.08 21.304c2.735 0 4.5-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922H81.92ZM94.92 21.146c.633 0 1.248-.1 1.525-.179v-2.18c-.218.04-.475.06-.693.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.338v-2.24h-2.338V7.788H91.47v3.448H89.37v2.24h2.1v4.201c0 2.3 1.15 3.469 3.45 3.469ZM104.62 21.304c3.924 0 6.302-2.299 6.599-5.608h-3.111c-.238 1.803-1.506 3.032-3.369 3.032-2.2 0-3.746-1.784-3.746-4.796 0-2.953 1.605-4.638 3.805-4.638 1.883 0 2.953 1.15 3.171 2.834h3.191c-.317-3.448-2.854-5.41-6.342-5.41-3.984 0-7.036 2.695-7.036 7.214 0 4.677 2.676 7.372 6.838 7.372ZM117.449 21.304c2.993 0 5.114-1.882 5.114-5.172 0-3.23-2.121-5.233-5.114-5.233-2.972 0-5.093 2.002-5.093 5.233 0 3.29 2.101 5.172 5.093 5.172Zm0-2.22c-1.327 0-2.18-1.09-2.18-2.952 0-1.903.892-2.973 2.18-2.973 1.308 0 2.2 1.07 2.2 2.973 0 1.862-.872 2.953-2.2 2.953ZM126.569 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.229-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM137.464 20.948v-5.689c0-1.208.753-2.1 1.823-2.1 1.011 0 1.606.773 1.606 2.06v5.729h2.873v-6.144c0-2.339-1.228-3.905-3.428-3.905-1.526 0-2.458.734-2.953 1.606a5.31 5.31 0 0 0 .079-.892v-.377h-2.874v9.712h2.874ZM149.949 21.304c2.735 0 4.499-1.546 4.697-3.567h-2.893c-.139.892-.892 1.387-1.804 1.387-1.228 0-2.12-.99-2.14-2.358h6.897v-.555c0-3.21-1.764-5.312-4.816-5.312-2.933 0-4.994 2.062-4.994 5.173 0 3.37 2.12 5.232 5.053 5.232Zm-2.16-6.421c.119-1.11.932-1.922 2.081-1.922 1.11 0 1.883.772 1.903 1.922h-3.984ZM160.876 21.304c3.013 0 4.658-1.645 4.975-4.201h-2.874c-.099 1.07-.713 1.982-2.001 1.982-1.309 0-2.2-1.21-2.2-2.993 0-1.942 1.03-2.933 2.259-2.933 1.209 0 1.803.872 1.883 1.882h2.873c-.218-2.358-1.823-4.142-4.776-4.142-2.874 0-5.153 1.903-5.153 5.193 0 3.25 1.923 5.212 5.014 5.212ZM172.067 21.146c.634 0 1.248-.1 1.526-.179v-2.18c-.218.04-.476.06-.694.06-1.05 0-1.427-.595-1.427-1.566v-3.805h2.339v-2.24h-2.339V7.788h-2.854v3.448h-2.1v2.24h2.1v4.201c0 2.3 1.15 3.469 3.449 3.469Z" fill="#fff"/></svg>`,WALLET_CONNECT_ICON:a.YP`<svg width="28" height="20" viewBox="0 0 28 20"><g clip-path="url(#a)"><path d="M7.386 6.482c3.653-3.576 9.575-3.576 13.228 0l.44.43a.451.451 0 0 1 0 .648L19.55 9.033a.237.237 0 0 1-.33 0l-.606-.592c-2.548-2.496-6.68-2.496-9.228 0l-.648.634a.237.237 0 0 1-.33 0L6.902 7.602a.451.451 0 0 1 0-.647l.483-.473Zm16.338 3.046 1.339 1.31a.451.451 0 0 1 0 .648l-6.035 5.909a.475.475 0 0 1-.662 0L14.083 13.2a.119.119 0 0 0-.166 0l-4.283 4.194a.475.475 0 0 1-.662 0l-6.035-5.91a.451.451 0 0 1 0-.647l1.338-1.31a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0l4.283 4.194c.046.044.12.044.166 0l4.283-4.194a.475.475 0 0 1 .662 0Z" fill="#000000"/></g><defs><clipPath id="a"><path fill="#ffffff" d="M0 0h28v20H0z"/></clipPath></defs></svg>`,WALLET_CONNECT_ICON_COLORED:a.YP`<svg width="96" height="96" fill="none"><path fill="#fff" d="M25.322 33.597c12.525-12.263 32.83-12.263 45.355 0l1.507 1.476a1.547 1.547 0 0 1 0 2.22l-5.156 5.048a.814.814 0 0 1-1.134 0l-2.074-2.03c-8.737-8.555-22.903-8.555-31.64 0l-2.222 2.175a.814.814 0 0 1-1.134 0l-5.156-5.049a1.547 1.547 0 0 1 0-2.22l1.654-1.62Zm56.019 10.44 4.589 4.494a1.547 1.547 0 0 1 0 2.22l-20.693 20.26a1.628 1.628 0 0 1-2.267 0L48.283 56.632a.407.407 0 0 0-.567 0L33.03 71.012a1.628 1.628 0 0 1-2.268 0L10.07 50.75a1.547 1.547 0 0 1 0-2.22l4.59-4.494a1.628 1.628 0 0 1 2.267 0l14.687 14.38c.156.153.41.153.567 0l14.685-14.38a1.628 1.628 0 0 1 2.268 0l14.687 14.38c.156.153.41.153.567 0l14.686-14.38a1.628 1.628 0 0 1 2.268 0Z"/><path stroke="#000" d="M25.672 33.954c12.33-12.072 32.325-12.072 44.655 0l1.508 1.476a1.047 1.047 0 0 1 0 1.506l-5.157 5.048a.314.314 0 0 1-.434 0l-2.074-2.03c-8.932-8.746-23.409-8.746-32.34 0l-2.222 2.174a.314.314 0 0 1-.434 0l-5.157-5.048a1.047 1.047 0 0 1 0-1.506l1.655-1.62Zm55.319 10.44 4.59 4.494a1.047 1.047 0 0 1 0 1.506l-20.694 20.26a1.128 1.128 0 0 1-1.568 0l-14.686-14.38a.907.907 0 0 0-1.267 0L32.68 70.655a1.128 1.128 0 0 1-1.568 0L10.42 50.394a1.047 1.047 0 0 1 0-1.506l4.59-4.493a1.128 1.128 0 0 1 1.567 0l14.687 14.379a.907.907 0 0 0 1.266 0l-.35-.357.35.357 14.686-14.38a1.128 1.128 0 0 1 1.568 0l14.687 14.38a.907.907 0 0 0 1.267 0l14.686-14.38a1.128 1.128 0 0 1 1.568 0Z"/></svg>`,BACK_ICON:a.YP`<svg width="10" height="18" viewBox="0 0 10 18"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.735.179a.75.75 0 0 1 .087 1.057L2.92 8.192a1.25 1.25 0 0 0 0 1.617l5.902 6.956a.75.75 0 1 1-1.144.97L1.776 10.78a2.75 2.75 0 0 1 0-3.559L7.678.265A.75.75 0 0 1 8.735.18Z" fill="#fff"/></svg>`,COPY_ICON:a.YP`<svg width="24" height="24" fill="none"><path fill="#fff" fill-rule="evenodd" d="M7.01 7.01c.03-1.545.138-2.5.535-3.28A5 5 0 0 1 9.73 1.545C10.8 1 12.2 1 15 1c2.8 0 4.2 0 5.27.545a5 5 0 0 1 2.185 2.185C23 4.8 23 6.2 23 9c0 2.8 0 4.2-.545 5.27a5 5 0 0 1-2.185 2.185c-.78.397-1.735.505-3.28.534l-.001.01c-.03 1.54-.138 2.493-.534 3.27a5 5 0 0 1-2.185 2.186C13.2 23 11.8 23 9 23c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C1 19.2 1 17.8 1 15c0-2.8 0-4.2.545-5.27A5 5 0 0 1 3.73 7.545C4.508 7.149 5.46 7.04 7 7.01h.01ZM15 15.5c-1.425 0-2.403-.001-3.162-.063-.74-.06-1.139-.172-1.427-.319a3.5 3.5 0 0 1-1.53-1.529c-.146-.288-.257-.686-.318-1.427C8.501 11.403 8.5 10.425 8.5 9c0-1.425.001-2.403.063-3.162.06-.74.172-1.139.318-1.427a3.5 3.5 0 0 1 1.53-1.53c.288-.146.686-.257 1.427-.318.759-.062 1.737-.063 3.162-.063 1.425 0 2.403.001 3.162.063.74.06 1.139.172 1.427.318a3.5 3.5 0 0 1 1.53 1.53c.146.288.257.686.318 1.427.062.759.063 1.737.063 3.162 0 1.425-.001 2.403-.063 3.162-.06.74-.172 1.139-.319 1.427a3.5 3.5 0 0 1-1.529 1.53c-.288.146-.686.257-1.427.318-.759.062-1.737.063-3.162.063ZM7 8.511c-.444.009-.825.025-1.162.052-.74.06-1.139.172-1.427.318a3.5 3.5 0 0 0-1.53 1.53c-.146.288-.257.686-.318 1.427-.062.759-.063 1.737-.063 3.162 0 1.425.001 2.403.063 3.162.06.74.172 1.139.318 1.427a3.5 3.5 0 0 0 1.53 1.53c.288.146.686.257 1.427.318.759.062 1.737.063 3.162.063 1.425 0 2.403-.001 3.162-.063.74-.06 1.139-.172 1.427-.319a3.5 3.5 0 0 0 1.53-1.53c.146-.287.257-.685.318-1.426.027-.337.043-.718.052-1.162H15c-2.8 0-4.2 0-5.27-.545a5 5 0 0 1-2.185-2.185C7 13.2 7 11.8 7 9v-.489Z" clip-rule="evenodd"/></svg>`,RETRY_ICON:a.YP`<svg width="15" height="16" viewBox="0 0 15 16"><path d="M6.464 2.03A.75.75 0 0 0 5.403.97L2.08 4.293a1 1 0 0 0 0 1.414L5.403 9.03a.75.75 0 0 0 1.06-1.06L4.672 6.177a.25.25 0 0 1 .177-.427h2.085a4 4 0 1 1-3.93 4.746c-.077-.407-.405-.746-.82-.746-.414 0-.755.338-.7.748a5.501 5.501 0 1 0 5.45-6.248H4.848a.25.25 0 0 1-.177-.427L6.464 2.03Z" fill="#fff"/></svg>`,DESKTOP_ICON:a.YP`<svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 5.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C2.204 1 3.13 1 4.98 1h6.04c1.85 0 2.775 0 3.466.394a3 3 0 0 1 1.12 1.12C16 3.204 16 4.13 16 5.98v1.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C13.796 12 12.87 12 11.02 12H4.98c-1.85 0-2.775 0-3.466-.394a3 3 0 0 1-1.12-1.12C0 9.796 0 8.87 0 7.02V5.98ZM4.98 2.5h6.04c.953 0 1.568.001 2.034.043.446.04.608.108.69.154a1.5 1.5 0 0 1 .559.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033v1.04c0 .952-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.046-.243.114-.69.154-.466.042-1.08.043-2.033.043H4.98c-.952 0-1.568-.001-2.034-.043-.446-.04-.608-.108-.69-.154a1.5 1.5 0 0 1-.559-.56c-.046-.08-.114-.243-.154-.69-.042-.465-.043-1.08-.043-2.033V5.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.046.243-.114.69-.154.465-.042 1.08-.043 2.033-.043Z" fill="#fff"/><path d="M4 14.25a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,MOBILE_ICON:a.YP`<svg width="16" height="16" viewBox="0 0 16 16"><path d="M6.75 5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4.98c0-1.85 0-2.775.394-3.466a3 3 0 0 1 1.12-1.12C5.204 0 6.136 0 8 0s2.795 0 3.486.394a3 3 0 0 1 1.12 1.12C13 2.204 13 3.13 13 4.98v6.04c0 1.85 0 2.775-.394 3.466a3 3 0 0 1-1.12 1.12C10.796 16 9.864 16 8 16s-2.795 0-3.486-.394a3 3 0 0 1-1.12-1.12C3 13.796 3 12.87 3 11.02V4.98Zm8.5 0v6.04c0 .953-.001 1.568-.043 2.034-.04.446-.108.608-.154.69a1.499 1.499 0 0 1-.56.559c-.08.045-.242.113-.693.154-.47.042-1.091.043-2.05.043-.959 0-1.58-.001-2.05-.043-.45-.04-.613-.109-.693-.154a1.5 1.5 0 0 1-.56-.56c-.046-.08-.114-.243-.154-.69-.042-.466-.043-1.08-.043-2.033V4.98c0-.952.001-1.568.043-2.034.04-.446.108-.608.154-.69a1.5 1.5 0 0 1 .56-.559c.08-.045.243-.113.693-.154C6.42 1.501 7.041 1.5 8 1.5c.959 0 1.58.001 2.05.043.45.04.613.109.693.154a1.5 1.5 0 0 1 .56.56c.046.08.114.243.154.69.042.465.043 1.08.043 2.033Z" fill="#fff"/></svg>`,ARROW_DOWN_ICON:a.YP`<svg width="14" height="14" viewBox="0 0 14 14"><path d="M2.28 7.47a.75.75 0 0 0-1.06 1.06l5.25 5.25a.75.75 0 0 0 1.06 0l5.25-5.25a.75.75 0 0 0-1.06-1.06l-3.544 3.543a.25.25 0 0 1-.426-.177V.75a.75.75 0 0 0-1.5 0v10.086a.25.25 0 0 1-.427.176L2.28 7.47Z" fill="#fff"/></svg>`,ARROW_UP_RIGHT_ICON:a.YP`<svg width="15" height="14" fill="none"><path d="M4.5 1.75A.75.75 0 0 1 5.25 1H12a1.5 1.5 0 0 1 1.5 1.5v6.75a.75.75 0 0 1-1.5 0V4.164a.25.25 0 0 0-.427-.176L4.061 11.5A.75.75 0 0 1 3 10.44l7.513-7.513a.25.25 0 0 0-.177-.427H5.25a.75.75 0 0 1-.75-.75Z" fill="#fff"/></svg>`,ARROW_RIGHT_ICON:a.YP`<svg width="6" height="14" viewBox="0 0 6 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.181 1.099a.75.75 0 0 1 1.024.279l2.433 4.258a2.75 2.75 0 0 1 0 2.729l-2.433 4.257a.75.75 0 1 1-1.303-.744L4.335 7.62a1.25 1.25 0 0 0 0-1.24L1.902 2.122a.75.75 0 0 1 .28-1.023Z" fill="#fff"/></svg>`,QRCODE_ICON:a.YP`<svg width="25" height="24" viewBox="0 0 25 24"><path d="M23.748 9a.748.748 0 0 0 .748-.752c-.018-2.596-.128-4.07-.784-5.22a6 6 0 0 0-2.24-2.24c-1.15-.656-2.624-.766-5.22-.784a.748.748 0 0 0-.752.748c0 .414.335.749.748.752 1.015.007 1.82.028 2.494.088.995.09 1.561.256 1.988.5.7.398 1.28.978 1.679 1.678.243.427.41.993.498 1.988.061.675.082 1.479.09 2.493a.753.753 0 0 0 .75.749ZM3.527.788C4.677.132 6.152.022 8.747.004A.748.748 0 0 1 9.5.752a.753.753 0 0 1-.749.752c-1.014.007-1.818.028-2.493.088-.995.09-1.561.256-1.988.5-.7.398-1.28.978-1.679 1.678-.243.427-.41.993-.499 1.988-.06.675-.081 1.479-.088 2.493A.753.753 0 0 1 1.252 9a.748.748 0 0 1-.748-.752c.018-2.596.128-4.07.784-5.22a6 6 0 0 1 2.24-2.24ZM1.252 15a.748.748 0 0 0-.748.752c.018 2.596.128 4.07.784 5.22a6 6 0 0 0 2.24 2.24c1.15.656 2.624.766 5.22.784a.748.748 0 0 0 .752-.748.753.753 0 0 0-.749-.752c-1.014-.007-1.818-.028-2.493-.089-.995-.089-1.561-.255-1.988-.498a4.5 4.5 0 0 1-1.679-1.68c-.243-.426-.41-.992-.499-1.987-.06-.675-.081-1.479-.088-2.493A.753.753 0 0 0 1.252 15ZM22.996 15.749a.753.753 0 0 1 .752-.749c.415 0 .751.338.748.752-.018 2.596-.128 4.07-.784 5.22a6 6 0 0 1-2.24 2.24c-1.15.656-2.624.766-5.22.784a.748.748 0 0 1-.752-.748c0-.414.335-.749.748-.752 1.015-.007 1.82-.028 2.494-.089.995-.089 1.561-.255 1.988-.498a4.5 4.5 0 0 0 1.679-1.68c.243-.426.41-.992.498-1.987.061-.675.082-1.479.09-2.493Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7 4a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 11h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 4H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1ZM13.5 6.5A2.5 2.5 0 0 1 16 4h2a2.5 2.5 0 0 1 2.5 2.5v2A2.5 2.5 0 0 1 18 11h-2a2.5 2.5 0 0 1-2.5-2.5v-2Zm2.5-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1ZM7 13a2.5 2.5 0 0 0-2.5 2.5v2A2.5 2.5 0 0 0 7 20h2a2.5 2.5 0 0 0 2.5-2.5v-2A2.5 2.5 0 0 0 9 13H7Zm2 1.5H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Z" fill="#fff"/><path d="M13.5 15.5c0-.465 0-.697.038-.89a2 2 0 0 1 1.572-1.572C15.303 13 15.535 13 16 13v2.5h-2.5ZM18 13c.465 0 .697 0 .89.038a2 2 0 0 1 1.572 1.572c.038.193.038.425.038.89H18V13ZM18 17.5h2.5c0 .465 0 .697-.038.89a2 2 0 0 1-1.572 1.572C18.697 20 18.465 20 18 20v-2.5ZM13.5 17.5H16V20c-.465 0-.697 0-.89-.038a2 2 0 0 1-1.572-1.572c-.038-.193-.038-.425-.038-.89Z" fill="#fff"/></svg>`,SCAN_ICON:a.YP`<svg width="16" height="16" fill="none"><path fill="#fff" d="M10 15.216c0 .422.347.763.768.74 1.202-.064 2.025-.222 2.71-.613a5.001 5.001 0 0 0 1.865-1.866c.39-.684.549-1.507.613-2.709a.735.735 0 0 0-.74-.768.768.768 0 0 0-.76.732c-.009.157-.02.306-.032.447-.073.812-.206 1.244-.384 1.555-.31.545-.761.996-1.306 1.306-.311.178-.743.311-1.555.384-.141.013-.29.023-.447.032a.768.768 0 0 0-.732.76ZM10 .784c0 .407.325.737.732.76.157.009.306.02.447.032.812.073 1.244.206 1.555.384a3.5 3.5 0 0 1 1.306 1.306c.178.311.311.743.384 1.555.013.142.023.29.032.447a.768.768 0 0 0 .76.732.734.734 0 0 0 .74-.768c-.064-1.202-.222-2.025-.613-2.71A5 5 0 0 0 13.477.658c-.684-.39-1.507-.549-2.709-.613a.735.735 0 0 0-.768.74ZM5.232.044A.735.735 0 0 1 6 .784a.768.768 0 0 1-.732.76c-.157.009-.305.02-.447.032-.812.073-1.244.206-1.555.384A3.5 3.5 0 0 0 1.96 3.266c-.178.311-.311.743-.384 1.555-.013.142-.023.29-.032.447A.768.768 0 0 1 .784 6a.735.735 0 0 1-.74-.768c.064-1.202.222-2.025.613-2.71A5 5 0 0 1 2.523.658C3.207.267 4.03.108 5.233.044ZM5.268 14.456a.768.768 0 0 1 .732.76.734.734 0 0 1-.768.74c-1.202-.064-2.025-.222-2.71-.613a5 5 0 0 1-1.865-1.866c-.39-.684-.549-1.507-.613-2.709A.735.735 0 0 1 .784 10c.407 0 .737.325.76.732.009.157.02.306.032.447.073.812.206 1.244.384 1.555a3.5 3.5 0 0 0 1.306 1.306c.311.178.743.311 1.555.384.142.013.29.023.447.032Z"/></svg>`,CHECKMARK_ICON:a.YP`<svg width="13" height="12" viewBox="0 0 13 12"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.155.132a.75.75 0 0 1 .232 1.035L5.821 11.535a1 1 0 0 1-1.626.09L.665 7.21a.75.75 0 1 1 1.17-.937L4.71 9.867a.25.25 0 0 0 .406-.023L11.12.364a.75.75 0 0 1 1.035-.232Z" fill="#fff"/></svg>`,SEARCH_ICON:a.YP`<svg width="20" height="21"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.432 13.992c-.354-.353-.91-.382-1.35-.146a5.5 5.5 0 1 1 2.265-2.265c-.237.441-.208.997.145 1.35l3.296 3.296a.75.75 0 1 1-1.06 1.061l-3.296-3.296Zm.06-5a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z" fill="#949E9E"/></svg>`,WALLET_PLACEHOLDER:a.YP`<svg width="60" height="60" fill="none" viewBox="0 0 60 60"><g clip-path="url(#q)"><path id="wallet-placeholder-fill" fill="#fff" d="M0 24.9c0-9.251 0-13.877 1.97-17.332a15 15 0 0 1 5.598-5.597C11.023 0 15.648 0 24.9 0h10.2c9.252 0 13.877 0 17.332 1.97a15 15 0 0 1 5.597 5.598C60 11.023 60 15.648 60 24.9v10.2c0 9.252 0 13.877-1.97 17.332a15.001 15.001 0 0 1-5.598 5.597C48.977 60 44.352 60 35.1 60H24.9c-9.251 0-13.877 0-17.332-1.97a15 15 0 0 1-5.597-5.598C0 48.977 0 44.352 0 35.1V24.9Z"/><path id="wallet-placeholder-dash" stroke="#000" stroke-dasharray="4 4" stroke-width="1.5" d="M.04 41.708a231.598 231.598 0 0 1-.039-4.403l.75-.001L.75 35.1v-2.55H0v-5.1h.75V24.9l.001-2.204h-.75c.003-1.617.011-3.077.039-4.404l.75.016c.034-1.65.099-3.08.218-4.343l-.746-.07c.158-1.678.412-3.083.82-4.316l.713.236c.224-.679.497-1.296.827-1.875a14.25 14.25 0 0 1 1.05-1.585L3.076 5.9A15 15 0 0 1 5.9 3.076l.455.596a14.25 14.25 0 0 1 1.585-1.05c.579-.33 1.196-.603 1.875-.827l-.236-.712C10.812.674 12.217.42 13.895.262l.07.746C15.23.89 16.66.824 18.308.79l-.016-.75C19.62.012 21.08.004 22.695.001l.001.75L24.9.75h2.55V0h5.1v.75h2.55l2.204.001v-.75c1.617.003 3.077.011 4.404.039l-.016.75c1.65.034 3.08.099 4.343.218l.07-.746c1.678.158 3.083.412 4.316.82l-.236.713c.679.224 1.296.497 1.875.827a14.24 14.24 0 0 1 1.585 1.05l.455-.596A14.999 14.999 0 0 1 56.924 5.9l-.596.455c.384.502.735 1.032 1.05 1.585.33.579.602 1.196.827 1.875l.712-.236c.409 1.233.663 2.638.822 4.316l-.747.07c.119 1.264.184 2.694.218 4.343l.75-.016c.028 1.327.036 2.787.039 4.403l-.75.001.001 2.204v2.55H60v5.1h-.75v2.55l-.001 2.204h.75a231.431 231.431 0 0 1-.039 4.404l-.75-.016c-.034 1.65-.099 3.08-.218 4.343l.747.07c-.159 1.678-.413 3.083-.822 4.316l-.712-.236a10.255 10.255 0 0 1-.827 1.875 14.242 14.242 0 0 1-1.05 1.585l.596.455a14.997 14.997 0 0 1-2.824 2.824l-.455-.596c-.502.384-1.032.735-1.585 1.05-.579.33-1.196.602-1.875.827l.236.712c-1.233.409-2.638.663-4.316.822l-.07-.747c-1.264.119-2.694.184-4.343.218l.016.75c-1.327.028-2.787.036-4.403.039l-.001-.75-2.204.001h-2.55V60h-5.1v-.75H24.9l-2.204-.001v.75a231.431 231.431 0 0 1-4.404-.039l.016-.75c-1.65-.034-3.08-.099-4.343-.218l-.07.747c-1.678-.159-3.083-.413-4.316-.822l.236-.712a10.258 10.258 0 0 1-1.875-.827 14.252 14.252 0 0 1-1.585-1.05l-.455.596A14.999 14.999 0 0 1 3.076 54.1l.596-.455a14.24 14.24 0 0 1-1.05-1.585 10.259 10.259 0 0 1-.827-1.875l-.712.236C.674 49.188.42 47.783.262 46.105l.746-.07C.89 44.77.824 43.34.79 41.692l-.75.016Z"/><path fill="#fff" fill-rule="evenodd" d="M35.643 32.145c-.297-.743-.445-1.114-.401-1.275a.42.42 0 0 1 .182-.27c.134-.1.463-.1 1.123-.1.742 0 1.499.046 2.236-.05a6 6 0 0 0 5.166-5.166c.051-.39.051-.855.051-1.784 0-.928 0-1.393-.051-1.783a6 6 0 0 0-5.166-5.165c-.39-.052-.854-.052-1.783-.052h-7.72c-4.934 0-7.401 0-9.244 1.051a8 8 0 0 0-2.985 2.986C16.057 22.28 16.003 24.58 16 29 15.998 31.075 16 33.15 16 35.224A7.778 7.778 0 0 0 23.778 43H28.5c1.394 0 2.09 0 2.67-.116a6 6 0 0 0 4.715-4.714c.115-.58.115-1.301.115-2.744 0-1.31 0-1.964-.114-2.49a4.998 4.998 0 0 0-.243-.792Z" clip-rule="evenodd"/><path fill="#9EA9A9" fill-rule="evenodd" d="M37 18h-7.72c-2.494 0-4.266.002-5.647.126-1.361.122-2.197.354-2.854.728a6.5 6.5 0 0 0-2.425 2.426c-.375.657-.607 1.492-.729 2.853-.11 1.233-.123 2.777-.125 4.867 0 .7 0 1.05.097 1.181.096.13.182.181.343.2.163.02.518-.18 1.229-.581a6.195 6.195 0 0 1 3.053-.8H37c.977 0 1.32-.003 1.587-.038a4.5 4.5 0 0 0 3.874-3.874c.036-.268.039-.611.039-1.588 0-.976-.003-1.319-.038-1.587a4.5 4.5 0 0 0-3.875-3.874C38.32 18.004 37.977 18 37 18Zm-7.364 12.5h-7.414a4.722 4.722 0 0 0-4.722 4.723 6.278 6.278 0 0 0 6.278 6.278H28.5c1.466 0 1.98-.008 2.378-.087a4.5 4.5 0 0 0 3.535-3.536c.08-.397.087-.933.087-2.451 0-1.391-.009-1.843-.08-2.17a3.5 3.5 0 0 0-2.676-2.676c-.328-.072-.762-.08-2.108-.08Z" clip-rule="evenodd"/></g><defs><clipPath id="q"><path fill="#fff" d="M0 0h60v60H0z"/></clipPath></defs></svg>`,GLOBE_ICON:a.YP`<svg width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" fill-rule="evenodd" d="M15.5 8a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0Zm-2.113.75c.301 0 .535.264.47.558a6.01 6.01 0 0 1-2.867 3.896c-.203.116-.42-.103-.334-.32.409-1.018.691-2.274.797-3.657a.512.512 0 0 1 .507-.477h1.427Zm.47-2.058c.065.294-.169.558-.47.558H11.96a.512.512 0 0 1-.507-.477c-.106-1.383-.389-2.638-.797-3.656-.087-.217.13-.437.333-.32a6.01 6.01 0 0 1 2.868 3.895Zm-4.402.558c.286 0 .515-.24.49-.525-.121-1.361-.429-2.534-.83-3.393-.279-.6-.549-.93-.753-1.112a.535.535 0 0 0-.724 0c-.204.182-.474.513-.754 1.112-.4.859-.708 2.032-.828 3.393a.486.486 0 0 0 .49.525h2.909Zm-5.415 0c.267 0 .486-.21.507-.477.106-1.383.389-2.638.797-3.656.087-.217-.13-.437-.333-.32a6.01 6.01 0 0 0-2.868 3.895c-.065.294.169.558.47.558H4.04ZM2.143 9.308c-.065-.294.169-.558.47-.558H4.04c.267 0 .486.21.507.477.106 1.383.389 2.639.797 3.657.087.217-.13.436-.333.32a6.01 6.01 0 0 1-2.868-3.896Zm3.913-.033a.486.486 0 0 1 .49-.525h2.909c.286 0 .515.24.49.525-.121 1.361-.428 2.535-.83 3.394-.279.6-.549.93-.753 1.112a.535.535 0 0 1-.724 0c-.204-.182-.474-.513-.754-1.112-.4-.859-.708-2.033-.828-3.394Z" clip-rule="evenodd"/></svg>`},M=s.iv`.wcm-toolbar-placeholder{top:0;bottom:0;left:0;right:0;width:100%;position:absolute;display:block;pointer-events:none;height:100px;border-radius:calc(var(--wcm-background-border-radius) * .9);background-color:var(--wcm-background-color);background-position:center;background-size:cover}.wcm-toolbar{height:38px;display:flex;position:relative;margin:5px 15px 5px 5px;justify-content:space-between;align-items:center}.wcm-toolbar img,.wcm-toolbar svg{height:28px;object-position:left center;object-fit:contain}#wcm-wc-logo path{fill:var(--wcm-accent-fill-color)}button{width:28px;height:28px;border-radius:var(--wcm-icon-button-border-radius);border:0;display:flex;justify-content:center;align-items:center;cursor:pointer;background-color:var(--wcm-color-bg-1);box-shadow:0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-bg-2)}button svg{display:block;object-position:center}button path{fill:var(--wcm-color-fg-1)}.wcm-toolbar div{display:flex}@media(hover:hover){button:hover{background-color:var(--wcm-color-bg-2)}}`;var L=Object.defineProperty,U=Object.getOwnPropertyDescriptor,j=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?U(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&L(t,i,o),o};let q=class extends s.oi{render(){return s.dy`<div class="wcm-toolbar-placeholder"></div><div class="wcm-toolbar">${$.WALLET_CONNECT_LOGO} <button @click="${n.jb.close}">${$.CROSS_ICON}</button></div>`}};q.styles=[b.globalCss,M],q=j([(0,r.Mo)("wcm-modal-backcard")],q);const z=s.iv`main{padding:20px;padding-top:0;width:100%}`;var W=Object.defineProperty,V=Object.getOwnPropertyDescriptor,K=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?V(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&W(t,i,o),o};let B=class extends s.oi{render(){return s.dy`<main><slot></slot></main>`}};B.styles=[b.globalCss,z],B=K([(0,r.Mo)("wcm-modal-content")],B);const H=s.iv`footer{padding:10px;display:flex;flex-direction:column;align-items:inherit;justify-content:inherit;border-top:1px solid var(--wcm-color-bg-2)}`;var F=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,Z=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Y(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&F(t,i,o),o};let G=class extends s.oi{render(){return s.dy`<footer><slot></slot></footer>`}};G.styles=[b.globalCss,H],G=Z([(0,r.Mo)("wcm-modal-footer")],G);const Q=s.iv`header{display:flex;justify-content:center;align-items:center;padding:20px;position:relative}.wcm-border{border-bottom:1px solid var(--wcm-color-bg-2);margin-bottom:20px}header button{padding:15px 20px}header button:active{opacity:.5}@media(hover:hover){header button:hover{opacity:.5}}.wcm-back-btn{position:absolute;left:0}.wcm-action-btn{position:absolute;right:0}path{fill:var(--wcm-accent-color)}`;var J=Object.defineProperty,X=Object.getOwnPropertyDescriptor,ee=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?X(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&J(t,i,o),o};let te=class extends s.oi{constructor(){super(...arguments),this.title="",this.onAction=void 0,this.actionIcon=void 0,this.border=!1}backBtnTemplate(){return s.dy`<button class="wcm-back-btn" @click="${n.AV.goBack}">${$.BACK_ICON}</button>`}actionBtnTemplate(){return s.dy`<button class="wcm-action-btn" @click="${this.onAction}">${this.actionIcon}</button>`}render(){const e={"wcm-border":this.border},t=n.AV.state.history.length>1,i=this.title?s.dy`<wcm-text variant="big-bold">${this.title}</wcm-text>`:s.dy`<slot></slot>`;return s.dy`<header class="${(0,o.$)(e)}">${t?this.backBtnTemplate():null} ${i} ${this.onAction?this.actionBtnTemplate():null}</header>`}};te.styles=[b.globalCss,Q],ee([(0,r.Cb)()],te.prototype,"title",2),ee([(0,r.Cb)()],te.prototype,"onAction",2),ee([(0,r.Cb)()],te.prototype,"actionIcon",2),ee([(0,r.Cb)({type:Boolean})],te.prototype,"border",2),te=ee([(0,r.Mo)("wcm-modal-header")],te);const ie={MOBILE_BREAKPOINT:600,WCM_RECENT_WALLET_DATA:"WCM_RECENT_WALLET_DATA",EXPLORER_WALLET_URL:"https://explorer.walletconnect.com/?type=wallet",getShadowRootElement(e,t){const i=e.renderRoot.querySelector(t);if(!i)throw new Error(`${t} not found`);return i},getWalletIcon({id:e,image_id:t}){const{walletImages:i}=n.ConfigCtrl.state;return null!=i&&i[e]?i[e]:t?n.ExplorerCtrl.getWalletImageUrl(t):""},getWalletName(e,t=!1){return t&&e.length>8?`${e.substring(0,8)}..`:e},isMobileAnimation(){return window.innerWidth<=ie.MOBILE_BREAKPOINT},async preloadImage(e){const t=new Promise(((t,i)=>{const s=new Image;s.onload=t,s.onerror=i,s.crossOrigin="anonymous",s.src=e}));return Promise.race([t,n.zv.wait(3e3)])},getErrorMessage(e){return e instanceof Error?e.message:"Unknown Error"},debounce(e,t=500){let i;return(...s)=>{function r(){e(...s)}i&&clearTimeout(i),i=setTimeout(r,t)}},handleMobileLinking(e){const{walletConnectUri:t}=n.OptionsCtrl.state,{mobile:i,name:s}=e,r=i?.native,o=i?.universal;function a(e){let t="";r?t=n.zv.formatUniversalUrl(r,e,s):o&&(t=n.zv.formatNativeUrl(o,e,s)),n.zv.openHref(t,"_self")}ie.setRecentWallet(e),t&&a(t)},handleAndroidLinking(){const{walletConnectUri:e}=n.OptionsCtrl.state;e&&(n.zv.setWalletConnectAndroidDeepLink(e),n.zv.openHref(e,"_self"))},async handleUriCopy(){const{walletConnectUri:e}=n.OptionsCtrl.state;if(e)try{await navigator.clipboard.writeText(e),n.ToastCtrl.openToast("Link copied","success")}catch{n.ToastCtrl.openToast("Failed to copy","error")}},getCustomImageUrls(){const{walletImages:e}=n.ConfigCtrl.state,t=Object.values(e??{});return Object.values(t)},truncate(e,t=8){return e.length<=t?e:`${e.substring(0,4)}...${e.substring(e.length-4)}`},setRecentWallet(e){try{localStorage.setItem(ie.WCM_RECENT_WALLET_DATA,JSON.stringify(e))}catch{console.info("Unable to set recent wallet")}},getRecentWallet(){try{const e=localStorage.getItem(ie.WCM_RECENT_WALLET_DATA);return e?JSON.parse(e):void 0}catch{console.info("Unable to get recent wallet")}},caseSafeIncludes(e,t){return e.toUpperCase().includes(t.toUpperCase())},openWalletExplorerUrl(){n.zv.openHref(ie.EXPLORER_WALLET_URL,"_blank")},getCachedRouterWalletPlatforms(){const{desktop:e,mobile:t}=n.zv.getWalletRouterData(),i=Boolean(e?.native),s=Boolean(e?.universal),r=Boolean(t?.native)||Boolean(t?.universal);return{isDesktop:i,isMobile:r,isWeb:s}},goToConnectingView(e){n.AV.setData({Wallet:e});const t=n.zv.isMobile(),{isDesktop:i,isWeb:s,isMobile:r}=ie.getCachedRouterWalletPlatforms();t?r?n.AV.push("MobileConnecting"):s?n.AV.push("WebConnecting"):n.AV.push("InstallWallet"):i?n.AV.push("DesktopConnecting"):s?n.AV.push("WebConnecting"):r?n.AV.push("MobileQrcodeConnecting"):n.AV.push("InstallWallet")}},se=s.iv`.wcm-router{overflow:hidden;will-change:transform}.wcm-content{display:flex;flex-direction:column}`;var re=Object.defineProperty,oe=Object.getOwnPropertyDescriptor,ne=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?oe(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&re(t,i,o),o};let ae=class extends s.oi{constructor(){super(),this.view=n.AV.state.view,this.prevView=n.AV.state.view,this.unsubscribe=void 0,this.oldHeight="0px",this.resizeObserver=void 0,this.unsubscribe=n.AV.subscribe((e=>{this.view!==e.view&&this.onChangeRoute()}))}firstUpdated(){this.resizeObserver=new ResizeObserver((([e])=>{const t=`${e.contentRect.height}px`;"0px"!==this.oldHeight&&(0,c.j)(this.routerEl,{height:[this.oldHeight,t]},{duration:.2}),this.oldHeight=t})),this.resizeObserver.observe(this.contentEl)}disconnectedCallback(){var e,t;null==(e=this.unsubscribe)||e.call(this),null==(t=this.resizeObserver)||t.disconnect()}get routerEl(){return ie.getShadowRootElement(this,".wcm-router")}get contentEl(){return ie.getShadowRootElement(this,".wcm-content")}viewTemplate(){switch(this.view){case"ConnectWallet":return s.dy`<wcm-connect-wallet-view></wcm-connect-wallet-view>`;case"DesktopConnecting":return s.dy`<wcm-desktop-connecting-view></wcm-desktop-connecting-view>`;case"MobileConnecting":return s.dy`<wcm-mobile-connecting-view></wcm-mobile-connecting-view>`;case"WebConnecting":return s.dy`<wcm-web-connecting-view></wcm-web-connecting-view>`;case"MobileQrcodeConnecting":return s.dy`<wcm-mobile-qr-connecting-view></wcm-mobile-qr-connecting-view>`;case"WalletExplorer":return s.dy`<wcm-wallet-explorer-view></wcm-wallet-explorer-view>`;case"Qrcode":return s.dy`<wcm-qrcode-view></wcm-qrcode-view>`;case"InstallWallet":return s.dy`<wcm-install-wallet-view></wcm-install-wallet-view>`;default:return s.dy`<div>Not Found</div>`}}async onChangeRoute(){await(0,c.j)(this.routerEl,{opacity:[1,0],scale:[1,1.02]},{duration:.15,delay:.1}).finished,this.view=n.AV.state.view,(0,c.j)(this.routerEl,{opacity:[0,1],scale:[.99,1]},{duration:.37,delay:.05})}render(){return s.dy`<div class="wcm-router"><div class="wcm-content">${this.viewTemplate()}</div></div>`}};ae.styles=[b.globalCss,se],ne([(0,r.SB)()],ae.prototype,"view",2),ne([(0,r.SB)()],ae.prototype,"prevView",2),ae=ne([(0,r.Mo)("wcm-modal-router")],ae);const ce=s.iv`div{height:36px;width:max-content;display:flex;justify-content:center;align-items:center;padding:9px 15px 11px;position:absolute;top:12px;box-shadow:0 6px 14px -6px rgba(10,16,31,.3),0 10px 32px -4px rgba(10,16,31,.15);z-index:2;left:50%;transform:translateX(-50%);pointer-events:none;backdrop-filter:blur(20px) saturate(1.8);-webkit-backdrop-filter:blur(20px) saturate(1.8);border-radius:var(--wcm-notification-border-radius);border:1px solid var(--wcm-color-overlay);background-color:var(--wcm-color-overlay)}svg{margin-right:5px}@-moz-document url-prefix(){div{background-color:var(--wcm-color-bg-3)}}.wcm-success path{fill:var(--wcm-accent-color)}.wcm-error path{fill:var(--wcm-error-color)}`;var le=Object.defineProperty,he=Object.getOwnPropertyDescriptor,de=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?he(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&le(t,i,o),o};let pe=class extends s.oi{constructor(){super(),this.open=!1,this.unsubscribe=void 0,this.timeout=void 0,this.unsubscribe=n.ToastCtrl.subscribe((e=>{e.open?(this.open=!0,this.timeout=setTimeout((()=>n.ToastCtrl.closeToast()),2200)):(this.open=!1,clearTimeout(this.timeout))}))}disconnectedCallback(){var e;null==(e=this.unsubscribe)||e.call(this),clearTimeout(this.timeout),n.ToastCtrl.closeToast()}render(){const{message:e,variant:t}=n.ToastCtrl.state,i={"wcm-success":"success"===t,"wcm-error":"error"===t};return this.open?s.dy`<div class="${(0,o.$)(i)}">${"success"===t?$.CHECKMARK_ICON:null} ${"error"===t?$.CROSS_ICON:null}<wcm-text variant="small-regular">${e}</wcm-text></div>`:null}};pe.styles=[b.globalCss,ce],de([(0,r.SB)()],pe.prototype,"open",2),pe=de([(0,r.Mo)("wcm-modal-toast")],pe);const ue=.1,ge=2.5,me=7;function we(e,t,i){return e!==t&&(e-t<0?t-e:e-t)<=i+ue}function ye(e,t){const i=Array.prototype.slice.call(h.create(e,{errorCorrectionLevel:t}).modules.data,0),s=Math.sqrt(i.length);return i.reduce(((e,t,i)=>(i%s===0?e.push([t]):e[e.length-1].push(t))&&e),[])}const fe={generate(e,t,i){const r="#141414",o="#ffffff",n=[],a=ye(e,"Q"),c=t/a.length,l=[{x:0,y:0},{x:1,y:0},{x:0,y:1}];l.forEach((({x:e,y:t})=>{const i=(a.length-me)*c*e,h=(a.length-me)*c*t,d=.45;for(let a=0;a<l.length;a+=1){const e=c*(me-2*a);n.push(s.YP`<rect fill="${a%2===0?r:o}" height="${e}" rx="${e*d}" ry="${e*d}" width="${e}" x="${i+c*a}" y="${h+c*a}">`)}}));const h=Math.floor((i+25)/c),d=a.length/2-h/2,p=a.length/2+h/2-1,u=[];a.forEach(((e,t)=>{e.forEach(((e,i)=>{if(a[t][i]&&!(t<me&&i<me||t>a.length-(me+1)&&i<me||t<me&&i>a.length-(me+1))&&!(t>d&&t<p&&i>d&&i<p)){const e=t*c+c/2,s=i*c+c/2;u.push([e,s])}}))}));const g={};return u.forEach((([e,t])=>{g[e]?g[e].push(t):g[e]=[t]})),Object.entries(g).map((([e,t])=>{const i=t.filter((e=>t.every((t=>!we(e,t,c)))));return[Number(e),i]})).forEach((([e,t])=>{t.forEach((t=>{n.push(s.YP`<circle cx="${e}" cy="${t}" fill="${r}" r="${c/ge}">`)}))})),Object.entries(g).filter((([e,t])=>t.length>1)).map((([e,t])=>{const i=t.filter((e=>t.some((t=>we(e,t,c)))));return[Number(e),i]})).map((([e,t])=>{t.sort(((e,t)=>e<t?-1:1));const i=[];for(const s of t){const e=i.find((e=>e.some((e=>we(s,e,c)))));e?e.push(s):i.push([s])}return[e,i.map((e=>[e[0],e[e.length-1]]))]})).forEach((([e,t])=>{t.forEach((([t,i])=>{n.push(s.YP`<line x1="${e}" x2="${e}" y1="${t}" y2="${i}" stroke="${r}" stroke-width="${c/(ge/2)}" stroke-linecap="round">`)}))})),n}},be=s.iv`@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}div{position:relative;user-select:none;display:block;overflow:hidden;aspect-ratio:1/1;animation:fadeIn ease .2s}.wcm-dark{background-color:#fff;border-radius:var(--wcm-container-border-radius);padding:18px;box-shadow:0 2px 5px #000}svg:first-child,wcm-wallet-image{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{transform:translateY(-50%) translateX(-50%)}wcm-wallet-image{width:25%;height:25%;border-radius:var(--wcm-wallet-icon-border-radius)}svg:first-child{transform:translateY(-50%) translateX(-50%) scale(.9)}svg:first-child path:first-child{fill:var(--wcm-accent-color)}svg:first-child path:last-child{stroke:var(--wcm-color-overlay)}`;var ve=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,xe=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Ee(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&ve(t,i,o),o};let Ie=class extends s.oi{constructor(){super(...arguments),this.uri="",this.size=0,this.imageId=void 0,this.walletId=void 0,this.imageUrl=void 0}svgTemplate(){const e="light"===n.ThemeCtrl.state.themeMode?this.size:this.size-36;return s.YP`<svg height="${e}" width="${e}">${fe.generate(this.uri,e,e/4)}</svg>`}render(){const e={"wcm-dark":"dark"===n.ThemeCtrl.state.themeMode};return s.dy`<div style="${`width: ${this.size}px`}" class="${(0,o.$)(e)}">${this.walletId||this.imageUrl?s.dy`<wcm-wallet-image walletId="${(0,l.o)(this.walletId)}" imageId="${(0,l.o)(this.imageId)}" imageUrl="${(0,l.o)(this.imageUrl)}"></wcm-wallet-image>`:$.WALLET_CONNECT_ICON_COLORED} ${this.svgTemplate()}</div>`}};Ie.styles=[b.globalCss,be],xe([(0,r.Cb)()],Ie.prototype,"uri",2),xe([(0,r.Cb)({type:Number})],Ie.prototype,"size",2),xe([(0,r.Cb)()],Ie.prototype,"imageId",2),xe([(0,r.Cb)()],Ie.prototype,"walletId",2),xe([(0,r.Cb)()],Ie.prototype,"imageUrl",2),Ie=xe([(0,r.Mo)("wcm-qrcode")],Ie);const Oe=s.iv`:host{position:relative;height:28px;width:80%}input{width:100%;height:100%;line-height:28px!important;border-radius:var(--wcm-input-border-radius);font-style:normal;font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',sans-serif;font-feature-settings:'case' on;font-weight:500;font-size:16px;letter-spacing:-.03em;padding:0 10px 0 34px;transition:.2s all ease;color:var(--wcm-color-fg-1);background-color:var(--wcm-color-bg-3);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay);caret-color:var(--wcm-accent-color)}input::placeholder{color:var(--wcm-color-fg-2)}svg{left:10px;top:4px;pointer-events:none;position:absolute;width:20px;height:20px}input:focus-within{box-shadow:inset 0 0 0 1px var(--wcm-accent-color)}path{fill:var(--wcm-color-fg-2)}`;var _e=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,Ce=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Se(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&_e(t,i,o),o};let Pe=class extends s.oi{constructor(){super(...arguments),this.onChange=()=>null}render(){return s.dy`<input type="text" @input="${this.onChange}" placeholder="Search wallets"> ${$.SEARCH_ICON}`}};Pe.styles=[b.globalCss,Oe],Ce([(0,r.Cb)()],Pe.prototype,"onChange",2),Pe=Ce([(0,r.Mo)("wcm-search-input")],Pe);const Ne=s.iv`@keyframes rotate{100%{transform:rotate(360deg)}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}100%{stroke-dasharray:90,150;stroke-dashoffset:-124}}svg{animation:rotate 2s linear infinite;display:flex;justify-content:center;align-items:center}svg circle{stroke-linecap:round;animation:dash 1.5s ease infinite;stroke:var(--wcm-accent-color)}`;var Re=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,De=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Te(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Re(t,i,o),o};let ke=class extends s.oi{render(){return s.dy`<svg viewBox="0 0 50 50" width="24" height="24"><circle cx="25" cy="25" r="20" fill="none" stroke-width="4" stroke="#fff"/></svg>`}};ke.styles=[b.globalCss,Ne],ke=De([(0,r.Mo)("wcm-spinner")],ke);const Ae=s.iv`span{font-style:normal;font-family:var(--wcm-font-family);font-feature-settings:var(--wcm-font-feature-settings)}.wcm-xsmall-bold{font-family:var(--wcm-text-xsmall-bold-font-family);font-weight:var(--wcm-text-xsmall-bold-weight);font-size:var(--wcm-text-xsmall-bold-size);line-height:var(--wcm-text-xsmall-bold-line-height);letter-spacing:var(--wcm-text-xsmall-bold-letter-spacing);text-transform:var(--wcm-text-xsmall-bold-text-transform)}.wcm-xsmall-regular{font-family:var(--wcm-text-xsmall-regular-font-family);font-weight:var(--wcm-text-xsmall-regular-weight);font-size:var(--wcm-text-xsmall-regular-size);line-height:var(--wcm-text-xsmall-regular-line-height);letter-spacing:var(--wcm-text-xsmall-regular-letter-spacing);text-transform:var(--wcm-text-xsmall-regular-text-transform)}.wcm-small-thin{font-family:var(--wcm-text-small-thin-font-family);font-weight:var(--wcm-text-small-thin-weight);font-size:var(--wcm-text-small-thin-size);line-height:var(--wcm-text-small-thin-line-height);letter-spacing:var(--wcm-text-small-thin-letter-spacing);text-transform:var(--wcm-text-small-thin-text-transform)}.wcm-small-regular{font-family:var(--wcm-text-small-regular-font-family);font-weight:var(--wcm-text-small-regular-weight);font-size:var(--wcm-text-small-regular-size);line-height:var(--wcm-text-small-regular-line-height);letter-spacing:var(--wcm-text-small-regular-letter-spacing);text-transform:var(--wcm-text-small-regular-text-transform)}.wcm-medium-regular{font-family:var(--wcm-text-medium-regular-font-family);font-weight:var(--wcm-text-medium-regular-weight);font-size:var(--wcm-text-medium-regular-size);line-height:var(--wcm-text-medium-regular-line-height);letter-spacing:var(--wcm-text-medium-regular-letter-spacing);text-transform:var(--wcm-text-medium-regular-text-transform)}.wcm-big-bold{font-family:var(--wcm-text-big-bold-font-family);font-weight:var(--wcm-text-big-bold-weight);font-size:var(--wcm-text-big-bold-size);line-height:var(--wcm-text-big-bold-line-height);letter-spacing:var(--wcm-text-big-bold-letter-spacing);text-transform:var(--wcm-text-big-bold-text-transform)}:host(*){color:var(--wcm-color-fg-1)}.wcm-color-primary{color:var(--wcm-color-fg-1)}.wcm-color-secondary{color:var(--wcm-color-fg-2)}.wcm-color-tertiary{color:var(--wcm-color-fg-3)}.wcm-color-inverse{color:var(--wcm-accent-fill-color)}.wcm-color-accnt{color:var(--wcm-accent-color)}.wcm-color-error{color:var(--wcm-error-color)}`;var $e=Object.defineProperty,Me=Object.getOwnPropertyDescriptor,Le=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Me(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&$e(t,i,o),o};let Ue=class extends s.oi{constructor(){super(...arguments),this.variant="medium-regular",this.color="primary"}render(){const e={"wcm-big-bold":"big-bold"===this.variant,"wcm-medium-regular":"medium-regular"===this.variant,"wcm-small-regular":"small-regular"===this.variant,"wcm-small-thin":"small-thin"===this.variant,"wcm-xsmall-regular":"xsmall-regular"===this.variant,"wcm-xsmall-bold":"xsmall-bold"===this.variant,"wcm-color-primary":"primary"===this.color,"wcm-color-secondary":"secondary"===this.color,"wcm-color-tertiary":"tertiary"===this.color,"wcm-color-inverse":"inverse"===this.color,"wcm-color-accnt":"accent"===this.color,"wcm-color-error":"error"===this.color};return s.dy`<span><slot class="${(0,o.$)(e)}"></slot></span>`}};Ue.styles=[b.globalCss,Ae],Le([(0,r.Cb)()],Ue.prototype,"variant",2),Le([(0,r.Cb)()],Ue.prototype,"color",2),Ue=Le([(0,r.Mo)("wcm-text")],Ue);const je=s.iv`button{width:100%;height:100%;border-radius:var(--wcm-button-hover-highlight-border-radius);display:flex;align-items:flex-start}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}button>div{width:80px;padding:5px 0;display:flex;flex-direction:column;align-items:center}wcm-text{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}wcm-wallet-image{height:60px;width:60px;transition:all .2s ease;border-radius:var(--wcm-wallet-icon-border-radius);margin-bottom:5px}.wcm-sublabel{margin-top:2px}`;var qe=Object.defineProperty,ze=Object.getOwnPropertyDescriptor,We=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?ze(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&qe(t,i,o),o};let Ve=class extends s.oi{constructor(){super(...arguments),this.onClick=()=>null,this.name="",this.walletId="",this.label=void 0,this.imageId=void 0,this.installed=!1,this.recent=!1}sublabelTemplate(){return this.recent?s.dy`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">RECENT</wcm-text>`:this.installed?s.dy`<wcm-text class="wcm-sublabel" variant="xsmall-bold" color="tertiary">INSTALLED</wcm-text>`:null}handleClick(){n.uA.click({name:"WALLET_BUTTON",walletId:this.walletId}),this.onClick()}render(){var e;return s.dy`<button @click="${this.handleClick.bind(this)}"><div><wcm-wallet-image walletId="${this.walletId}" imageId="${(0,l.o)(this.imageId)}"></wcm-wallet-image><wcm-text variant="xsmall-regular">${null!=(e=this.label)?e:ie.getWalletName(this.name,!0)}</wcm-text>${this.sublabelTemplate()}</div></button>`}};Ve.styles=[b.globalCss,je],We([(0,r.Cb)()],Ve.prototype,"onClick",2),We([(0,r.Cb)()],Ve.prototype,"name",2),We([(0,r.Cb)()],Ve.prototype,"walletId",2),We([(0,r.Cb)()],Ve.prototype,"label",2),We([(0,r.Cb)()],Ve.prototype,"imageId",2),We([(0,r.Cb)({type:Boolean})],Ve.prototype,"installed",2),We([(0,r.Cb)({type:Boolean})],Ve.prototype,"recent",2),Ve=We([(0,r.Mo)("wcm-wallet-button")],Ve);const Ke=s.iv`:host{display:block}div{overflow:hidden;position:relative;border-radius:inherit;width:100%;height:100%;background-color:var(--wcm-color-overlay)}svg{position:relative;width:100%;height:100%}div::after{content:'';position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit;border:1px solid var(--wcm-color-overlay)}div img{width:100%;height:100%;object-fit:cover;object-position:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var Be=Object.defineProperty,He=Object.getOwnPropertyDescriptor,Fe=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?He(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Be(t,i,o),o};let Ye=class extends s.oi{constructor(){super(...arguments),this.walletId="",this.imageId=void 0,this.imageUrl=void 0}render(){var e;const t=null!=(e=this.imageUrl)&&e.length?this.imageUrl:ie.getWalletIcon({id:this.walletId,image_id:this.imageId});return s.dy`${t.length?s.dy`<div><img crossorigin="anonymous" src="${t}" alt="${this.id}"></div>`:$.WALLET_PLACEHOLDER}`}};Ye.styles=[b.globalCss,Ke],Fe([(0,r.Cb)()],Ye.prototype,"walletId",2),Fe([(0,r.Cb)()],Ye.prototype,"imageId",2),Fe([(0,r.Cb)()],Ye.prototype,"imageUrl",2),Ye=Fe([(0,r.Mo)("wcm-wallet-image")],Ye);var Ze=Object.defineProperty,Ge=Object.getOwnPropertyDescriptor,Qe=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Ge(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Ze(t,i,o),o};let Je=class extends s.oi{constructor(){super(),this.preload=!0,this.preloadData()}async loadImages(e){try{null!=e&&e.length&&await Promise.all(e.map((async e=>ie.preloadImage(e))))}catch{console.info("Unsuccessful attempt at preloading some images",e)}}async preloadListings(){if(n.ConfigCtrl.state.enableExplorer){await n.ExplorerCtrl.getRecomendedWallets(),n.OptionsCtrl.setIsDataLoaded(!0);const{recomendedWallets:e}=n.ExplorerCtrl.state,t=e.map((e=>ie.getWalletIcon(e)));await this.loadImages(t)}else n.OptionsCtrl.setIsDataLoaded(!0)}async preloadCustomImages(){const e=ie.getCustomImageUrls();await this.loadImages(e)}async preloadData(){try{this.preload&&(this.preload=!1,await Promise.all([this.preloadListings(),this.preloadCustomImages()]))}catch(e){console.error(e),n.ToastCtrl.openToast("Failed preloading","error")}}};Qe([(0,r.SB)()],Je.prototype,"preload",2),Je=Qe([(0,r.Mo)("wcm-explorer-context")],Je);var Xe=Object.defineProperty,et=Object.getOwnPropertyDescriptor,tt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?et(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Xe(t,i,o),o};let it=class extends s.oi{constructor(){super(),this.unsubscribeTheme=void 0,b.setTheme(),this.unsubscribeTheme=n.ThemeCtrl.subscribe(b.setTheme)}disconnectedCallback(){var e;null==(e=this.unsubscribeTheme)||e.call(this)}};it=tt([(0,r.Mo)("wcm-theme-context")],it);const st=s.iv`@keyframes scroll{0%{transform:translate3d(0,0,0)}100%{transform:translate3d(calc(-70px * 9),0,0)}}.wcm-slider{position:relative;overflow-x:hidden;padding:10px 0;margin:0 -20px;width:calc(100% + 40px)}.wcm-track{display:flex;width:calc(70px * 18);animation:scroll 20s linear infinite;opacity:.7}.wcm-track svg{margin:0 5px}wcm-wallet-image{width:60px;height:60px;margin:0 5px;border-radius:var(--wcm-wallet-icon-border-radius)}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-title{display:flex;align-items:center;margin-bottom:10px}.wcm-title svg{margin-right:6px}.wcm-title path{fill:var(--wcm-accent-color)}wcm-modal-footer .wcm-title{padding:0 10px}wcm-button-big{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);filter:drop-shadow(0 0 17px var(--wcm-color-bg-1))}wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-info-footer wcm-text{text-align:center;margin-bottom:15px}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var rt=Object.defineProperty,ot=Object.getOwnPropertyDescriptor,nt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?ot(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&rt(t,i,o),o};let at=class extends s.oi{onGoToQrcode(){n.AV.push("Qrcode")}render(){const{recomendedWallets:e}=n.ExplorerCtrl.state,t=[...e,...e],i=2*n.zv.RECOMMENDED_WALLET_AMOUNT;return s.dy`<wcm-modal-header title="Connect your wallet" .onAction="${this.onGoToQrcode}" .actionIcon="${$.QRCODE_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-title">${$.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">WalletConnect</wcm-text></div><div class="wcm-slider"><div class="wcm-track">${[...Array(i)].map(((e,i)=>{const r=t[i%t.length];return r?s.dy`<wcm-wallet-image walletId="${r.id}" imageId="${r.image_id}"></wcm-wallet-image>`:$.WALLET_PLACEHOLDER}))}</div><wcm-button-big @click="${ie.handleAndroidLinking}"><wcm-text variant="medium-regular" color="inverse">Select Wallet</wcm-text></wcm-button-big></div></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">Choose WalletConnect to see supported apps on your device</wcm-text></wcm-info-footer>`}};at.styles=[b.globalCss,st],at=nt([(0,r.Mo)("wcm-android-wallet-selection")],at);const ct=s.iv`@keyframes loading{to{stroke-dashoffset:0}}@keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(1px,0,0)}30%,50%,70%{transform:translate3d(-2px,0,0)}40%,60%{transform:translate3d(2px,0,0)}}:host{display:flex;flex-direction:column;align-items:center}div{position:relative;width:110px;height:110px;display:flex;justify-content:center;align-items:center;margin:40px 0 20px 0;transform:translate3d(0,0,0)}svg{position:absolute;width:110px;height:110px;fill:none;stroke:transparent;stroke-linecap:round;stroke-width:2px;top:0;left:0}use{stroke:var(--wcm-accent-color);animation:loading 1s linear infinite}wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:90px;height:90px}wcm-text{margin-bottom:40px}.wcm-error svg{stroke:var(--wcm-error-color)}.wcm-error use{display:none}.wcm-error{animation:shake .4s cubic-bezier(.36,.07,.19,.97) both}.wcm-stale svg,.wcm-stale use{display:none}`;var lt=Object.defineProperty,ht=Object.getOwnPropertyDescriptor,dt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?ht(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&lt(t,i,o),o};let pt=class extends s.oi{constructor(){super(...arguments),this.walletId=void 0,this.imageId=void 0,this.isError=!1,this.isStale=!1,this.label=""}svgLoaderTemplate(){var e,t;const i=null!=(t=null==(e=n.ThemeCtrl.state.themeVariables)?void 0:e["--wcm-wallet-icon-large-border-radius"])?t:b.getPreset("--wcm-wallet-icon-large-border-radius");let r=0;r=i.includes("%")?.88*parseInt(i,10):parseInt(i,10),r*=1.17;const o=317-1.57*r,a=425-1.8*r;return s.dy`<svg viewBox="0 0 110 110" width="110" height="110"><rect id="wcm-loader" x="2" y="2" width="106" height="106" rx="${r}"/><use xlink:href="#wcm-loader" stroke-dasharray="106 ${o}" stroke-dashoffset="${a}"></use></svg>`}render(){const e={"wcm-error":this.isError,"wcm-stale":this.isStale};return s.dy`<div class="${(0,o.$)(e)}">${this.svgLoaderTemplate()}<wcm-wallet-image walletId="${(0,l.o)(this.walletId)}" imageId="${(0,l.o)(this.imageId)}"></wcm-wallet-image></div><wcm-text variant="medium-regular" color="${this.isError?"error":"primary"}">${this.isError?"Connection declined":this.label}</wcm-text>`}};pt.styles=[b.globalCss,ct],dt([(0,r.Cb)()],pt.prototype,"walletId",2),dt([(0,r.Cb)()],pt.prototype,"imageId",2),dt([(0,r.Cb)({type:Boolean})],pt.prototype,"isError",2),dt([(0,r.Cb)({type:Boolean})],pt.prototype,"isStale",2),dt([(0,r.Cb)()],pt.prototype,"label",2),pt=dt([(0,r.Mo)("wcm-connector-waiting")],pt);const ut={manualWallets(){var e,t;const{mobileWallets:i,desktopWallets:s}=n.ConfigCtrl.state,r=null==(e=ut.recentWallet())?void 0:e.id,o=n.zv.isMobile()?i:s,a=o?.filter((e=>r!==e.id));return null!=(t=n.zv.isMobile()?a?.map((({id:e,name:t,links:i})=>({id:e,name:t,mobile:i,links:i}))):a?.map((({id:e,name:t,links:i})=>({id:e,name:t,desktop:i,links:i}))))?t:[]},recentWallet(){return ie.getRecentWallet()},recomendedWallets(e=!1){var t;const i=e||null==(t=ut.recentWallet())?void 0:t.id,{recomendedWallets:s}=n.ExplorerCtrl.state;return s.filter((e=>i!==e.id))}},gt={onConnecting(e){ie.goToConnectingView(e)},manualWalletsTemplate(){return ut.manualWallets().map((e=>s.dy`<wcm-wallet-button walletId="${e.id}" name="${e.name}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`))},recomendedWalletsTemplate(e=!1){return ut.recomendedWallets(e).map((e=>s.dy`<wcm-wallet-button name="${e.name}" walletId="${e.id}" imageId="${e.image_id}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`))},recentWalletTemplate(){const e=ut.recentWallet();if(e)return s.dy`<wcm-wallet-button name="${e.name}" walletId="${e.id}" imageId="${(0,l.o)(e.image_id)}" .recent="${!0}" .onClick="${()=>this.onConnecting(e)}"></wcm-wallet-button>`}},mt=s.iv`.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between}.wcm-desktop-title,.wcm-mobile-title{display:flex;align-items:center}.wcm-mobile-title{justify-content:space-between;margin-bottom:20px;margin-top:-10px}.wcm-desktop-title{margin-bottom:10px;padding:0 10px}.wcm-subtitle{display:flex;align-items:center}.wcm-subtitle:last-child path{fill:var(--wcm-color-fg-3)}.wcm-desktop-title svg,.wcm-mobile-title svg{margin-right:6px}.wcm-desktop-title path,.wcm-mobile-title path{fill:var(--wcm-accent-color)}`;var wt=Object.defineProperty,yt=Object.getOwnPropertyDescriptor,ft=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?yt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&wt(t,i,o),o};let bt=class extends s.oi{render(){const{explorerExcludedWalletIds:e,enableExplorer:t}=n.ConfigCtrl.state,i="ALL"!==e&&t,r=gt.manualWalletsTemplate(),o=gt.recomendedWalletsTemplate();let a=[gt.recentWalletTemplate(),...r,...o];a=a.filter(Boolean);const c=a.length>4||i;let l=[];l=c?a.slice(0,3):a;const h=Boolean(l.length);return s.dy`<wcm-modal-header .border="${!0}" title="Connect your wallet" .onAction="${ie.handleUriCopy}" .actionIcon="${$.COPY_ICON}"></wcm-modal-header><wcm-modal-content><div class="wcm-mobile-title"><div class="wcm-subtitle">${$.MOBILE_ICON}<wcm-text variant="small-regular" color="accent">Mobile</wcm-text></div><div class="wcm-subtitle">${$.SCAN_ICON}<wcm-text variant="small-regular" color="secondary">Scan with your wallet</wcm-text></div></div><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>${h?s.dy`<wcm-modal-footer><div class="wcm-desktop-title">${$.DESKTOP_ICON}<wcm-text variant="small-regular" color="accent">Desktop</wcm-text></div><div class="wcm-grid">${l} ${c?s.dy`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-footer>`:null}`}};bt.styles=[b.globalCss,mt],bt=ft([(0,r.Mo)("wcm-desktop-wallet-selection")],bt);const vt=s.iv`div{background-color:var(--wcm-color-bg-2);padding:10px 20px 15px 20px;border-top:1px solid var(--wcm-color-bg-3);text-align:center}a{color:var(--wcm-accent-color);text-decoration:none;transition:opacity .2s ease-in-out;display:inline}a:active{opacity:.8}@media(hover:hover){a:hover{opacity:.8}}`;var Et=Object.defineProperty,xt=Object.getOwnPropertyDescriptor,It=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?xt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Et(t,i,o),o};let Ot=class extends s.oi{render(){const{termsOfServiceUrl:e,privacyPolicyUrl:t}=n.ConfigCtrl.state;return e??t?s.dy`<div><wcm-text variant="small-regular" color="secondary">By connecting your wallet to this app, you agree to the app's ${e?s.dy`<a href="${e}" target="_blank" rel="noopener noreferrer">Terms of Service</a>`:null} ${e&&t?"and":null} ${t?s.dy`<a href="${t}" target="_blank" rel="noopener noreferrer">Privacy Policy</a>`:null}</wcm-text></div>`:null}};Ot.styles=[b.globalCss,vt],Ot=It([(0,r.Mo)("wcm-legal-notice")],Ot);const _t=s.iv`div{display:grid;grid-template-columns:repeat(4,80px);margin:0 -10px;justify-content:space-between;row-gap:10px}`;var St=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor,Pt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Ct(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&St(t,i,o),o};let Nt=class extends s.oi{onQrcode(){n.AV.push("Qrcode")}render(){const{explorerExcludedWalletIds:e,enableExplorer:t}=n.ConfigCtrl.state,i="ALL"!==e&&t,r=gt.manualWalletsTemplate(),o=gt.recomendedWalletsTemplate();let a=[gt.recentWalletTemplate(),...r,...o];a=a.filter(Boolean);const c=a.length>8||i;let l=[];l=c?a.slice(0,7):a;const h=Boolean(l.length);return s.dy`<wcm-modal-header title="Connect your wallet" .onAction="${this.onQrcode}" .actionIcon="${$.QRCODE_ICON}"></wcm-modal-header>${h?s.dy`<wcm-modal-content><div>${l} ${c?s.dy`<wcm-view-all-wallets-button></wcm-view-all-wallets-button>`:null}</div></wcm-modal-content>`:null}`}};Nt.styles=[b.globalCss,_t],Nt=Pt([(0,r.Mo)("wcm-mobile-wallet-selection")],Nt);const Rt=s.iv`:host{all:initial}.wcm-overlay{top:0;bottom:0;left:0;right:0;position:fixed;z-index:var(--wcm-z-index);overflow:hidden;display:flex;justify-content:center;align-items:center;opacity:0;pointer-events:none;background-color:var(--wcm-overlay-background-color);backdrop-filter:var(--wcm-overlay-backdrop-filter)}@media(max-height:720px) and (orientation:landscape){.wcm-overlay{overflow:scroll;align-items:flex-start;padding:20px 0}}.wcm-active{pointer-events:auto}.wcm-container{position:relative;max-width:360px;width:100%;outline:0;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) var(--wcm-container-border-radius) var(--wcm-container-border-radius);border:1px solid var(--wcm-color-overlay);overflow:hidden}.wcm-card{width:100%;position:relative;border-radius:var(--wcm-container-border-radius);overflow:hidden;box-shadow:0 6px 14px -6px rgba(10,16,31,.12),0 10px 32px -4px rgba(10,16,31,.1),0 0 0 1px var(--wcm-color-overlay);background-color:var(--wcm-color-bg-1);color:var(--wcm-color-fg-1)}@media(max-width:600px){.wcm-container{max-width:440px;border-radius:var(--wcm-background-border-radius) var(--wcm-background-border-radius) 0 0}.wcm-card{border-radius:var(--wcm-container-border-radius) var(--wcm-container-border-radius) 0 0}.wcm-overlay{align-items:flex-end}}@media(max-width:440px){.wcm-container{border:0}}`;var Tt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,kt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Dt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Tt(t,i,o),o};let At=class extends s.oi{constructor(){super(),this.open=!1,this.active=!1,this.unsubscribeModal=void 0,this.abortController=void 0,this.unsubscribeModal=n.jb.subscribe((e=>{e.open?this.onOpenModalEvent():this.onCloseModalEvent()}))}disconnectedCallback(){var e;null==(e=this.unsubscribeModal)||e.call(this)}get overlayEl(){return ie.getShadowRootElement(this,".wcm-overlay")}get containerEl(){return ie.getShadowRootElement(this,".wcm-container")}toggleBodyScroll(e){if(document.querySelector("body"))if(e){const e=document.getElementById("wcm-styles");e?.remove()}else document.head.insertAdjacentHTML("beforeend",'<style id="wcm-styles">html,body{touch-action:none;overflow:hidden;overscroll-behavior:contain;}</style>')}onCloseModal(e){e.target===e.currentTarget&&n.jb.close()}onOpenModalEvent(){this.toggleBodyScroll(!1),this.addKeyboardEvents(),this.open=!0,setTimeout((async()=>{const e=ie.isMobileAnimation()?{y:["50vh","0vh"]}:{scale:[.98,1]},t=.1,i=.2;await Promise.all([(0,c.j)(this.overlayEl,{opacity:[0,1]},{delay:t,duration:i}).finished,(0,c.j)(this.containerEl,e,{delay:t,duration:i}).finished]),this.active=!0}),0)}async onCloseModalEvent(){this.toggleBodyScroll(!0),this.removeKeyboardEvents();const e=ie.isMobileAnimation()?{y:["0vh","50vh"]}:{scale:[1,.98]},t=.2;await Promise.all([(0,c.j)(this.overlayEl,{opacity:[1,0]},{duration:t}).finished,(0,c.j)(this.containerEl,e,{duration:t}).finished]),this.containerEl.removeAttribute("style"),this.active=!1,this.open=!1}addKeyboardEvents(){this.abortController=new AbortController,window.addEventListener("keydown",(e=>{var t;"Escape"===e.key?n.jb.close():"Tab"===e.key&&(null!=(t=e.target)&&t.tagName.includes("wcm-")||this.containerEl.focus())}),this.abortController),this.containerEl.focus()}removeKeyboardEvents(){var e;null==(e=this.abortController)||e.abort(),this.abortController=void 0}render(){const e={"wcm-overlay":!0,"wcm-active":this.active};return s.dy`<wcm-explorer-context></wcm-explorer-context><wcm-theme-context></wcm-theme-context><div id="wcm-modal" class="${(0,o.$)(e)}" @click="${this.onCloseModal}" role="alertdialog" aria-modal="true"><div class="wcm-container" tabindex="0">${this.open?s.dy`<wcm-modal-backcard></wcm-modal-backcard><div class="wcm-card"><wcm-modal-router></wcm-modal-router><wcm-modal-toast></wcm-modal-toast></div>`:null}</div></div>`}};At.styles=[b.globalCss,Rt],kt([(0,r.SB)()],At.prototype,"open",2),kt([(0,r.SB)()],At.prototype,"active",2),At=kt([(0,r.Mo)("wcm-modal")],At);const $t=s.iv`div{display:flex;margin-top:15px}slot{display:inline-block;margin:0 5px}wcm-button{margin:0 5px}`;var Mt=Object.defineProperty,Lt=Object.getOwnPropertyDescriptor,Ut=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Lt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Mt(t,i,o),o};let jt=class extends s.oi{constructor(){super(...arguments),this.isMobile=!1,this.isDesktop=!1,this.isWeb=!1,this.isRetry=!1}onMobile(){n.zv.isMobile()?n.AV.replace("MobileConnecting"):n.AV.replace("MobileQrcodeConnecting")}onDesktop(){n.AV.replace("DesktopConnecting")}onWeb(){n.AV.replace("WebConnecting")}render(){return s.dy`<div>${this.isRetry?s.dy`<slot></slot>`:null} ${this.isMobile?s.dy`<wcm-button .onClick="${this.onMobile}" .iconLeft="${$.MOBILE_ICON}" variant="outline">Mobile</wcm-button>`:null} ${this.isDesktop?s.dy`<wcm-button .onClick="${this.onDesktop}" .iconLeft="${$.DESKTOP_ICON}" variant="outline">Desktop</wcm-button>`:null} ${this.isWeb?s.dy`<wcm-button .onClick="${this.onWeb}" .iconLeft="${$.GLOBE_ICON}" variant="outline">Web</wcm-button>`:null}</div>`}};jt.styles=[b.globalCss,$t],Ut([(0,r.Cb)({type:Boolean})],jt.prototype,"isMobile",2),Ut([(0,r.Cb)({type:Boolean})],jt.prototype,"isDesktop",2),Ut([(0,r.Cb)({type:Boolean})],jt.prototype,"isWeb",2),Ut([(0,r.Cb)({type:Boolean})],jt.prototype,"isRetry",2),jt=Ut([(0,r.Mo)("wcm-platform-selection")],jt);const qt=s.iv`button{display:flex;flex-direction:column;padding:5px 10px;border-radius:var(--wcm-button-hover-highlight-border-radius);height:100%;justify-content:flex-start}.wcm-icons{width:60px;height:60px;display:flex;flex-wrap:wrap;padding:7px;border-radius:var(--wcm-wallet-icon-border-radius);justify-content:space-between;align-items:center;margin-bottom:5px;background-color:var(--wcm-color-bg-2);box-shadow:inset 0 0 0 1px var(--wcm-color-overlay)}button:active{background-color:var(--wcm-color-overlay)}@media(hover:hover){button:hover{background-color:var(--wcm-color-overlay)}}.wcm-icons img{width:21px;height:21px;object-fit:cover;object-position:center;border-radius:calc(var(--wcm-wallet-icon-border-radius)/ 2);border:1px solid var(--wcm-color-overlay)}.wcm-icons svg{width:21px;height:21px}.wcm-icons img:nth-child(1),.wcm-icons img:nth-child(2),.wcm-icons svg:nth-child(1),.wcm-icons svg:nth-child(2){margin-bottom:4px}wcm-text{width:100%;text-align:center}#wallet-placeholder-fill{fill:var(--wcm-color-bg-3)}#wallet-placeholder-dash{stroke:var(--wcm-color-overlay)}`;var zt=Object.defineProperty,Wt=Object.getOwnPropertyDescriptor,Vt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Wt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&zt(t,i,o),o};let Kt=class extends s.oi{onClick(){n.AV.push("WalletExplorer")}render(){const{recomendedWallets:e}=n.ExplorerCtrl.state,t=ut.manualWallets(),i=[...e,...t].reverse().slice(0,4);return s.dy`<button @click="${this.onClick}"><div class="wcm-icons">${i.map((e=>{const t=ie.getWalletIcon(e);if(t)return s.dy`<img crossorigin="anonymous" src="${t}">`;const i=ie.getWalletIcon({id:e.id});return i?s.dy`<img crossorigin="anonymous" src="${i}">`:$.WALLET_PLACEHOLDER}))} ${[...Array(4-i.length)].map((()=>$.WALLET_PLACEHOLDER))}</div><wcm-text variant="xsmall-regular">View All</wcm-text></button>`}};Kt.styles=[b.globalCss,qt],Kt=Vt([(0,r.Mo)("wcm-view-all-wallets-button")],Kt);const Bt=s.iv`.wcm-qr-container{width:100%;display:flex;justify-content:center;align-items:center;aspect-ratio:1/1}`;var Ht=Object.defineProperty,Ft=Object.getOwnPropertyDescriptor,Yt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Ft(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Ht(t,i,o),o};let Zt=class extends s.oi{constructor(){super(),this.walletId="",this.imageId="",this.uri="",setTimeout((()=>{const{walletConnectUri:e}=n.OptionsCtrl.state;this.uri=e}),0)}get overlayEl(){return ie.getShadowRootElement(this,".wcm-qr-container")}render(){return s.dy`<div class="wcm-qr-container">${this.uri?s.dy`<wcm-qrcode size="${this.overlayEl.offsetWidth}" uri="${this.uri}" walletId="${(0,l.o)(this.walletId)}" imageId="${(0,l.o)(this.imageId)}"></wcm-qrcode>`:s.dy`<wcm-spinner></wcm-spinner>`}</div>`}};Zt.styles=[b.globalCss,Bt],Yt([(0,r.Cb)()],Zt.prototype,"walletId",2),Yt([(0,r.Cb)()],Zt.prototype,"imageId",2),Yt([(0,r.SB)()],Zt.prototype,"uri",2),Zt=Yt([(0,r.Mo)("wcm-walletconnect-qr")],Zt);var Gt=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,Jt=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Qt(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Gt(t,i,o),o};let Xt=class extends s.oi{viewTemplate(){return n.zv.isAndroid()?s.dy`<wcm-android-wallet-selection></wcm-android-wallet-selection>`:n.zv.isMobile()?s.dy`<wcm-mobile-wallet-selection></wcm-mobile-wallet-selection>`:s.dy`<wcm-desktop-wallet-selection></wcm-desktop-wallet-selection>`}render(){return s.dy`${this.viewTemplate()}<wcm-legal-notice></wcm-legal-notice>`}};Xt.styles=[b.globalCss],Xt=Jt([(0,r.Mo)("wcm-connect-wallet-view")],Xt);const ei=s.iv`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var ti=Object.defineProperty,ii=Object.getOwnPropertyDescriptor,si=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?ii(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&ti(t,i,o),o};let ri=class extends s.oi{constructor(){super(),this.isError=!1,this.openDesktopApp()}onFormatAndRedirect(e){const{desktop:t,name:i}=n.zv.getWalletRouterData(),s=t?.native;if(s){const t=n.zv.formatNativeUrl(s,e,i);n.zv.openHref(t,"_self")}}openDesktopApp(){const{walletConnectUri:e}=n.OptionsCtrl.state,t=n.zv.getWalletRouterData();ie.setRecentWallet(t),e&&this.onFormatAndRedirect(e)}render(){const{name:e,id:t,image_id:i}=n.zv.getWalletRouterData(),{isMobile:r,isWeb:o}=ie.getCachedRouterWalletPlatforms();return s.dy`<wcm-modal-header title="${e}" .onAction="${ie.handleUriCopy}" .actionIcon="${$.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${(0,l.o)(i)}" label="${`Continue in ${e}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Connection can continue loading if ${e} is not installed on your device`}</wcm-text><wcm-platform-selection .isMobile="${r}" .isWeb="${o}" .isRetry="${!0}"><wcm-button .onClick="${this.openDesktopApp.bind(this)}" .iconRight="${$.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};ri.styles=[b.globalCss,ei],si([(0,r.SB)()],ri.prototype,"isError",2),ri=si([(0,r.Mo)("wcm-desktop-connecting-view")],ri);const oi=s.iv`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}wcm-button{margin-top:15px}`;var ni=Object.defineProperty,ai=Object.getOwnPropertyDescriptor,ci=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?ai(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&ni(t,i,o),o};let li=class extends s.oi{onInstall(e){e&&n.zv.openHref(e,"_blank")}render(){const{name:e,id:t,image_id:i,homepage:r}=n.zv.getWalletRouterData();return s.dy`<wcm-modal-header title="${e}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${(0,l.o)(i)}" label="Not Detected" .isStale="${!0}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Download ${e} to continue. If multiple browser extensions are installed, disable non ${e} ones and try again`}</wcm-text><wcm-button .onClick="${()=>this.onInstall(r)}" .iconLeft="${$.ARROW_DOWN_ICON}">Download</wcm-button></wcm-info-footer>`}};li.styles=[b.globalCss,oi],li=ci([(0,r.Mo)("wcm-install-wallet-view")],li);const hi=s.iv`wcm-wallet-image{border-radius:var(--wcm-wallet-icon-large-border-radius);width:96px;height:96px;margin-bottom:20px}wcm-info-footer{display:flex;width:100%}.wcm-app-store{justify-content:space-between}.wcm-app-store wcm-wallet-image{margin-right:10px;margin-bottom:0;width:28px;height:28px;border-radius:var(--wcm-wallet-icon-small-border-radius)}.wcm-app-store div{display:flex;align-items:center}.wcm-app-store wcm-button{margin-right:-10px}.wcm-note{flex-direction:column;align-items:center;padding:5px 0}.wcm-note wcm-text{text-align:center}wcm-platform-selection{margin-top:-15px}.wcm-note wcm-text{margin-top:15px}.wcm-note wcm-text span{color:var(--wcm-accent-color)}`;var di=Object.defineProperty,pi=Object.getOwnPropertyDescriptor,ui=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?pi(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&di(t,i,o),o};let gi=class extends s.oi{constructor(){super(),this.isError=!1,this.openMobileApp()}onFormatAndRedirect(e,t=!1){const{mobile:i,name:s}=n.zv.getWalletRouterData(),r=i?.native,o=i?.universal;if(r&&!t){const t=n.zv.formatNativeUrl(r,e,s);n.zv.openHref(t,"_self")}else if(o){const t=n.zv.formatUniversalUrl(o,e,s);n.zv.openHref(t,"_self")}}openMobileApp(e=!1){const{walletConnectUri:t}=n.OptionsCtrl.state,i=n.zv.getWalletRouterData();ie.setRecentWallet(i),t&&this.onFormatAndRedirect(t,e)}onGoToAppStore(e){e&&n.zv.openHref(e,"_blank")}render(){const{name:e,id:t,image_id:i,app:r,mobile:o}=n.zv.getWalletRouterData(),{isWeb:a}=ie.getCachedRouterWalletPlatforms(),c=r?.ios,h=o?.universal;return s.dy`<wcm-modal-header title="${e}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${(0,l.o)(i)}" label="Tap 'Open' to continueâ€¦" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer class="wcm-note"><wcm-platform-selection .isWeb="${a}" .isRetry="${!0}"><wcm-button .onClick="${()=>this.openMobileApp(!1)}" .iconRight="${$.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection>${h?s.dy`<wcm-text color="secondary" variant="small-thin">Still doesn't work? <span tabindex="0" @click="${()=>this.openMobileApp(!0)}">Try this alternate link</span></wcm-text>`:null}</wcm-info-footer><wcm-info-footer class="wcm-app-store"><div><wcm-wallet-image walletId="${t}" imageId="${(0,l.o)(i)}"></wcm-wallet-image><wcm-text>${`Get ${e}`}</wcm-text></div><wcm-button .iconRight="${$.ARROW_RIGHT_ICON}" .onClick="${()=>this.onGoToAppStore(c)}" variant="ghost">App Store</wcm-button></wcm-info-footer>`}};gi.styles=[b.globalCss,hi],ui([(0,r.SB)()],gi.prototype,"isError",2),gi=ui([(0,r.Mo)("wcm-mobile-connecting-view")],gi);const mi=s.iv`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var wi=Object.defineProperty,yi=Object.getOwnPropertyDescriptor,fi=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?yi(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&wi(t,i,o),o};let bi=class extends s.oi{render(){const{name:e,id:t,image_id:i}=n.zv.getWalletRouterData(),{isDesktop:r,isWeb:o}=ie.getCachedRouterWalletPlatforms();return s.dy`<wcm-modal-header title="${e}" .onAction="${ie.handleUriCopy}" .actionIcon="${$.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr walletId="${t}" imageId="${(0,l.o)(i)}"></wcm-walletconnect-qr></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`Scan this QR Code with your phone's camera or inside ${e} app`}</wcm-text><wcm-platform-selection .isDesktop="${r}" .isWeb="${o}"></wcm-platform-selection></wcm-info-footer>`}};bi.styles=[b.globalCss,mi],bi=fi([(0,r.Mo)("wcm-mobile-qr-connecting-view")],bi);var vi=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,xi=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Ei(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&vi(t,i,o),o};let Ii=class extends s.oi{render(){return s.dy`<wcm-modal-header title="Scan the code" .onAction="${ie.handleUriCopy}" .actionIcon="${$.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-walletconnect-qr></wcm-walletconnect-qr></wcm-modal-content>`}};Ii.styles=[b.globalCss],Ii=xi([(0,r.Mo)("wcm-qrcode-view")],Ii);const Oi=s.iv`wcm-modal-content{height:clamp(200px,60vh,600px);display:block;overflow:scroll;scrollbar-width:none;position:relative;margin-top:1px}.wcm-grid{display:grid;grid-template-columns:repeat(4,80px);justify-content:space-between;margin:-15px -10px;padding-top:20px}wcm-modal-content::after,wcm-modal-content::before{content:'';position:fixed;pointer-events:none;z-index:1;width:100%;height:20px;opacity:1}wcm-modal-content::before{box-shadow:0 -1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(var(--wcm-color-bg-1),rgba(255,255,255,0))}wcm-modal-content::after{box-shadow:0 1px 0 0 var(--wcm-color-bg-1);background:linear-gradient(rgba(255,255,255,0),var(--wcm-color-bg-1));top:calc(100% - 20px)}wcm-modal-content::-webkit-scrollbar{display:none}.wcm-placeholder-block{display:flex;justify-content:center;align-items:center;height:100px;overflow:hidden}.wcm-empty,.wcm-loading{display:flex}.wcm-loading .wcm-placeholder-block{height:100%}.wcm-end-reached .wcm-placeholder-block{height:0;opacity:0}.wcm-empty .wcm-placeholder-block{opacity:1;height:100%}wcm-wallet-button{margin:calc((100% - 60px)/ 3) 0}`;var _i=Object.defineProperty,Si=Object.getOwnPropertyDescriptor,Ci=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Si(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&_i(t,i,o),o};const Pi=40;let Ni=class extends s.oi{constructor(){super(...arguments),this.loading=!n.ExplorerCtrl.state.wallets.listings.length,this.firstFetch=!n.ExplorerCtrl.state.wallets.listings.length,this.search="",this.endReached=!1,this.intersectionObserver=void 0,this.searchDebounce=ie.debounce((e=>{e.length>=1?(this.firstFetch=!0,this.endReached=!1,this.search=e,n.ExplorerCtrl.resetSearch(),this.fetchWallets()):this.search&&(this.search="",this.endReached=this.isLastPage(),n.ExplorerCtrl.resetSearch())}))}firstUpdated(){this.createPaginationObserver()}disconnectedCallback(){var e;null==(e=this.intersectionObserver)||e.disconnect()}get placeholderEl(){return ie.getShadowRootElement(this,".wcm-placeholder-block")}createPaginationObserver(){this.intersectionObserver=new IntersectionObserver((([e])=>{e.isIntersecting&&(!this.search||!this.firstFetch)&&this.fetchWallets()})),this.intersectionObserver.observe(this.placeholderEl)}isLastPage(){const{wallets:e,search:t}=n.ExplorerCtrl.state,{listings:i,total:s}=this.search?t:e;return s<=Pi||i.length>=s}async fetchWallets(){var e;const{wallets:t,search:i}=n.ExplorerCtrl.state,{listings:s,total:r,page:o}=this.search?i:t;if(!this.endReached&&(this.firstFetch||r>Pi&&s.length<r))try{this.loading=!0;const t=null==(e=n.OptionsCtrl.state.chains)?void 0:e.join(","),{listings:i}=await n.ExplorerCtrl.getWallets({page:this.firstFetch?1:o+1,entries:Pi,search:this.search,version:2,chains:t}),s=i.map((e=>ie.getWalletIcon(e)));await Promise.all([...s.map((async e=>ie.preloadImage(e))),n.zv.wait(300)]),this.endReached=this.isLastPage()}catch(a){console.error(a),n.ToastCtrl.openToast(ie.getErrorMessage(a),"error")}finally{this.loading=!1,this.firstFetch=!1}}onConnect(e){n.zv.isAndroid()?ie.handleMobileLinking(e):ie.goToConnectingView(e)}onSearchChange(e){const{value:t}=e.target;this.searchDebounce(t)}render(){const{wallets:e,search:t}=n.ExplorerCtrl.state,{listings:i}=this.search?t:e,r=this.loading&&!i.length,a=this.search.length>=3;let c=gt.manualWalletsTemplate(),l=gt.recomendedWalletsTemplate(!0);a&&(c=c.filter((({values:e})=>ie.caseSafeIncludes(e[0],this.search))),l=l.filter((({values:e})=>ie.caseSafeIncludes(e[0],this.search))));const h=!this.loading&&!i.length&&!l.length,d={"wcm-loading":r,"wcm-end-reached":this.endReached||!this.loading,"wcm-empty":h};return s.dy`<wcm-modal-header><wcm-search-input .onChange="${this.onSearchChange.bind(this)}"></wcm-search-input></wcm-modal-header><wcm-modal-content class="${(0,o.$)(d)}"><div class="wcm-grid">${r?null:c} ${r?null:l} ${r?null:i.map((e=>s.dy`${e?s.dy`<wcm-wallet-button imageId="${e.image_id}" name="${e.name}" walletId="${e.id}" .onClick="${()=>this.onConnect(e)}"></wcm-wallet-button>`:null}`))}</div><div class="wcm-placeholder-block">${h?s.dy`<wcm-text variant="big-bold" color="secondary">No results found</wcm-text>`:null} ${!h&&this.loading?s.dy`<wcm-spinner></wcm-spinner>`:null}</div></wcm-modal-content>`}};Ni.styles=[b.globalCss,Oi],Ci([(0,r.SB)()],Ni.prototype,"loading",2),Ci([(0,r.SB)()],Ni.prototype,"firstFetch",2),Ci([(0,r.SB)()],Ni.prototype,"search",2),Ci([(0,r.SB)()],Ni.prototype,"endReached",2),Ni=Ci([(0,r.Mo)("wcm-wallet-explorer-view")],Ni);const Ri=s.iv`wcm-info-footer{flex-direction:column;align-items:center;display:flex;width:100%;padding:5px 0}wcm-text{text-align:center}`;var Ti=Object.defineProperty,Di=Object.getOwnPropertyDescriptor,ki=(e,t,i,s)=>{for(var r,o=s>1?void 0:s?Di(t,i):t,n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s?r(t,i,o):r(o))||o);return s&&o&&Ti(t,i,o),o};let Ai=class extends s.oi{constructor(){super(),this.isError=!1,this.openWebWallet()}onFormatAndRedirect(e){const{desktop:t,name:i}=n.zv.getWalletRouterData(),s=t?.universal;if(s){const t=n.zv.formatUniversalUrl(s,e,i);n.zv.openHref(t,"_blank")}}openWebWallet(){const{walletConnectUri:e}=n.OptionsCtrl.state,t=n.zv.getWalletRouterData();ie.setRecentWallet(t),e&&this.onFormatAndRedirect(e)}render(){const{name:e,id:t,image_id:i}=n.zv.getWalletRouterData(),{isMobile:r,isDesktop:o}=ie.getCachedRouterWalletPlatforms(),a=n.zv.isMobile();return s.dy`<wcm-modal-header title="${e}" .onAction="${ie.handleUriCopy}" .actionIcon="${$.COPY_ICON}"></wcm-modal-header><wcm-modal-content><wcm-connector-waiting walletId="${t}" imageId="${(0,l.o)(i)}" label="${`Continue in ${e}...`}" .isError="${this.isError}"></wcm-connector-waiting></wcm-modal-content><wcm-info-footer><wcm-text color="secondary" variant="small-thin">${`${e} web app has opened in a new tab. Go there, accept the connection, and come back`}</wcm-text><wcm-platform-selection .isMobile="${r}" .isDesktop="${!a&&o}" .isRetry="${!0}"><wcm-button .onClick="${this.openWebWallet.bind(this)}" .iconRight="${$.RETRY_ICON}">Retry</wcm-button></wcm-platform-selection></wcm-info-footer>`}};Ai.styles=[b.globalCss,Ri],ki([(0,r.SB)()],Ai.prototype,"isError",2),Ai=ki([(0,r.Mo)("wcm-web-connecting-view")],Ai)},62693:(e,t,i)=>{"use strict";i.d(t,{u:()=>r});var s=i(29568);class r{constructor(e){this.openModal=s.jb.open,this.closeModal=s.jb.close,this.subscribeModal=s.jb.subscribe,this.setTheme=s.ThemeCtrl.setThemeConfig,s.ThemeCtrl.setThemeConfig(e),s.ConfigCtrl.setConfig(e),this.initUi()}async initUi(){if(typeof window<"u"){await Promise.all([i.e(601),i.e(9083)]).then(i.bind(i,75016));const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),s.OptionsCtrl.setIsUiLoaded(!0)}}}}}]);