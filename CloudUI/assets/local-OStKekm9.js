import{u as N}from"./useSEO-5BaNf11O.js";import{M as w}from"./tabView-yiP-Zt8D.js";import{_ as R,c as F,r as y}from"./index-QPPWK7xw.js";import{D as M}from"./DaemonService-D09C4O6H.js";import{q}from"./query-parser-C3-dT-Rr.js";import{e as d}from"./eventBus-BZyChua5.js";import{s as W}from"./vue-core-CU9AIURn.js";import{Y as j,X as O,Z as _,x as V,_ as x}from"./vuetify-_4u1He_j.js";import{u as P}from"./i18n-Bm8bpAAW.js";import{r as a,o as Q,c as X,a6 as Y,f as Z,g as f,a3 as o,Q as s,T as A,P as I,x as B,U as S,y as U,j as C}from"./apexcharts-nIAyciCq.js";import"./unhead-DEOrWl0D.js";import"./ConfirmCustomDialog-D5jNuL5-.js";import"./MapComponent-D1NdOhsg.js";import"./leaflet-core-jNE0Bq0j.js";import"./leaflet-cluster-0ODEUdTP.js";import"./http-BZQDkn3h.js";import"./ansi-utils-ChIB8aIv.js";import"./LoadingSpinner-BLJvP0iy.js";import"./geolocation-BklMEt0S.js";import"./ExplorerService-oc3qiwdf.js";import"./useLoginSheet-e2RZXtPE.js";import"./crypto-metamask-D6vz180a.js";import"./socketio-BDGyx5_k.js";import"./uuid-B49X2dQj.js";import"./vueuse-Bid7ZbHY.js";import"./cookie-BfmCf_44.js";import"./unjs-utils-GcjLqAqW.js";import"./casl-DNC8KRD8.js";import"./scrollbar-CXs_Utq1.js";import"./icons-mdi-_QP0sdRJ.js";import"./sanitizer-DAUAC_Zc.js";import"./element-plus-Cr1Qs4Q_.js";import"./lodash-C_Sw0jJq.js";import"./event-utils-DGlX1gEp.js";const G={__name:"local",setup(H){N();const{t:g}=P(),T=F(),{privilege:v}=W(T),r=a(0),n=a(!1),t=a(!0),D=localStorage.getItem("zelidauth"),L=q.parse(D||""),h=a(!!L.zelid),l=a(-1),i=a([]),c=a([]);a([]);async function u(){console.log("Load tiggered.."),t.value=!0;try{const e=await y.installedApps();e.data.status==="success"&&(c.value=e.data.data)}catch(e){console.error("Failed to fetch installed apps:",e),n.value=!0}t.value=!1}async function z(){t.value=!0,n.value=!1;try{const e=await y.globalAppSpecifications();e?.data?.data&&(i.value=e.data.data)}catch(e){console.error("Error loading apps:",e),n.value=!0}t.value=!1}async function E(){try{const e=await M.getBlockCount();e.data.status==="success"?(l.value=e.data.data,console.log("Daemon block count set:",l.value)):(console.warn("Daemon block count fetch failed:",e.data),l.value=-1)}catch(e){console.error("Error fetching daemon block count:",e.message),l.value=-1}}function b(){u()}Q(async()=>{d.on("updateInstalledApp",b),d.on("backendURLChanged",()=>{const e=localStorage.getItem("backendURL");console.log(e),u()}),await E(),await u(),await z(),console.log("Initial data fetching complete")});const k=X(()=>v.value==="fluxteam"||v.value==="admin");return Y(()=>{d.off("backendURLChanged",u),d.off("updateInstalledApp",b)}),(e,p)=>(f(),Z("div",null,[o(j,{modelValue:r.value,"onUpdate:modelValue":p[0]||(p[0]=m=>r.value=m),"background-color":"transparent",class:"tabs-no-slider",grow:"","hide-slider":""},{default:s(()=>[o(_,{class:"tab-chip"},{default:s(()=>[A(S(U(g)("menu.application.installedApps"))+" ",1),c.value.length?(f(),I(V,{key:0,content:c.value.length,color:"success","offset-x":"-5","offset-y":"8",class:"ml-2",floating:"",rounded:"",size:"small",density:"default"},null,8,["content"])):B("",!0)]),_:1}),o(_,{class:"tab-chip"},{default:s(()=>[A(S(U(g)("menu.application.availableApps"))+" ",1),i.value.length?(f(),I(V,{key:0,content:i.value.length,color:"success","offset-x":"-5","offset-y":"8",class:"ml-2",floating:"",rounded:"",size:"small",density:"default"},null,8,["content"])):B("",!0)]),_:1})]),_:1},8,["modelValue"]),o(O,{modelValue:r.value,"onUpdate:modelValue":p[1]||(p[1]=m=>r.value=m),class:"mt-4",touch:!1},{default:s(()=>[o(x,null,{default:s(()=>[C("div",null,[o(w,{apps:c.value,loading:t.value,"logged-in":h.value,"current-block-height":l.value,"active-apps-tab":"","api-error":n.value,"show-status":"","show-control":k.value,privilege:"none"},null,8,["apps","loading","logged-in","current-block-height","api-error","show-control"])])]),_:1}),o(x,null,{default:s(()=>[C("div",null,[o(w,{apps:i.value,loading:t.value,"logged-in":h.value,"current-block-height":l.value,"active-apps-tab":"","api-error":n.value,"show-install":k.value,privilege:"none"},null,8,["apps","loading","logged-in","current-block-height","api-error","show-install"])])]),_:1})]),_:1},8,["modelValue"])]))}},Te=R(G,[["__scopeId","data-v-57cca995"]]);export{Te as default};
