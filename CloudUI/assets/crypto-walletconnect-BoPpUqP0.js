const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/features-D9a5eNDa.js","assets/crypto-metamask-FwTrKlAT.js","assets/monaco-D0sk5loy.js","assets/vuetify-COByHKRY.js","assets/monaco-WeXJsRih.css","assets/leaflet-core-BkStxytj.js","assets/embedded-wallet-DsGHl2LI.js","assets/index-D_zm-K7P.js","assets/index-CV0VcXMx.js","assets/if-defined-6m10w9Qt.js","assets/ref-DSfTBPMk.js","assets/index-DFl_BNpm.js","assets/HelpersUtil-Ceoqyml3.js","assets/index-X_-EJwPv.js","assets/index-DRV-Cm6-.js","assets/index-JCPEDFAS.js","assets/index-D1jicTFt.js","assets/index-DymnY_n7.js","assets/email-DWlaghZ0.js","assets/index-DZnnW4sT.js","assets/index-CdoEbcRz.js","assets/socials-DDXz-Y7A.js","assets/index-Bh2aBPPu.js","assets/index-_H5-cyK8.js","assets/index-DzcP5YIc.js","assets/index-DUgrMXIz.js","assets/index-DxbOIESz.js","assets/swaps-DmkWdRJu.js","assets/index-CX2PrQao.js","assets/index-Cufl2_2o.js","assets/index-CkBOb-xj.js","assets/send-CQaMDvdb.js","assets/index-DbWPKNxz.js","assets/index-BrBaJD4C.js","assets/index-CPgLHso0.js","assets/index-0OHFrRwG.js","assets/receive-DqlfvApE.js","assets/onramp-COl71srh.js","assets/index-BdOHXo6q.js","assets/index-SAJG1yCM.js","assets/index-B8iVy1kG.js","assets/pay-with-exchange-BkVSq0uc.js","assets/transactions-CaXXJlby.js","assets/index-D-GMrHNq.js","assets/index-OHmYjhGf.js","assets/index-YBjINvSu.js","assets/index-DpcsMR89.js","assets/index-BVY9HFSL.js","assets/data-capture-DyRWRugJ.js","assets/index-DWvgfAU_.js","assets/index-CKrcksJK.js","assets/w3m-modal-NEk6MaSi.js","assets/index-fTTV28Tp.js","assets/index-BwGbh7KE.js","assets/leaflet-cluster-TUIETKBq.js","assets/apexcharts-C6hMdrdB.js","assets/index-DEdtE669.css"])))=>i.map(i=>d[i]);
import{r as RN,k as my,H as $_,c as Ap,a as rf,t as D_,b as yy,d as kN,e as ac,f as by,g as rs,h as $N,i as DN,j as UN,s as BN,l as MN,m as Ps,n as LN,o as Ca,p as Rw,q as _a,u as kw,v as Jl,w as Xl,x as FN,y as U_,z as wy,A as ch,B as fs,C as ts,D as Ga,E as Ey,F as sf,G as jN,I as qN,N as vy}from"./crypto-metamask-FwTrKlAT.js";import{a as aa,g as B_}from"./leaflet-core-BkStxytj.js";import{_ as kt}from"./monaco-D0sk5loy.js";const zN=Symbol(),$w=Object.getPrototypeOf,vg=new WeakMap,HN=t=>t&&(vg.has(t)?vg.get(t):$w(t)===Object.prototype||$w(t)===Array.prototype),WN=t=>HN(t)&&t[zN]||null,Dw=(t,e=!0)=>{vg.set(t,e)},of={},Cy=t=>typeof t=="object"&&t!==null,VN=t=>Cy(t)&&!wl.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),M_=(t,e)=>{const n=Cg.get(t);if(n?.[0]===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Dw(r,!0),Cg.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(wl.has(i))Dw(i,!1);else if(Zi.has(i)){const[c,u]=Zi.get(i);a.value=M_(c,u())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},KN=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),u=Reflect.get(s,i,a);if(c&&(Uw(u,o)||Bu.has(o)&&Uw(u,Bu.get(o))))return!0;n(i),Cy(o)&&(o=WN(o)||o);const l=!Zi.has(o)&&YN(o)?Je(o):o;return e(i,l),Reflect.set(s,i,l,a),r(["set",[i],o,u]),!0}}),Zi=new WeakMap,wl=new WeakSet,Cg=new WeakMap,Bd=[1],Bu=new WeakMap;let Uw=Object.is,GN=(t,e)=>new Proxy(t,e),YN=VN,ZN=M_,JN=KN;function Je(t={}){if(!Cy(t))throw new Error("object required");const e=Bu.get(t);if(e)return e;let n=Bd[0];const r=new Set,s=(y,E=++Bd[0])=>{n!==E&&(i=n=E,r.forEach(A=>A(y,E)))};let i=n;const o=(y=Bd[0])=>(i!==y&&(i=y,c.forEach(([E])=>{const A=E[1](y);A>n&&(n=A)})),n),a=y=>(E,A)=>{const w=[...E];w[1]=[y,...w[1]],s(w,A)},c=new Map,u=(y,E)=>{const A=!wl.has(E)&&Zi.get(E);if(A){if((of?"production":void 0)!=="production"&&c.has(y))throw new Error("prop listener already exists");if(r.size){const w=A[2](a(y));c.set(y,[A,w])}else c.set(y,[A])}},l=y=>{var E;const A=c.get(y);A&&(c.delete(y),(E=A[1])==null||E.call(A))},d=y=>(r.add(y),r.size===1&&c.forEach(([A,w],C)=>{if((of?"production":void 0)!=="production"&&w)throw new Error("remove already exists");const _=A[2](a(C));c.set(C,[A,_])}),()=>{r.delete(y),r.size===0&&c.forEach(([A,w],C)=>{w&&(w(),c.set(C,[A]))})});let f=!0;const h=JN(()=>f,u,l,s),g=GN(t,h);Bu.set(t,g);const p=[t,o,d];return Zi.set(g,p),Reflect.ownKeys(t).forEach(y=>{const E=Object.getOwnPropertyDescriptor(t,y);"value"in E&&E.writable&&(g[y]=t[y])}),f=!1,g}function vt(t,e,n){const r=Zi.get(t);(of?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const u=o(l=>{i.push(l),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,u()}}function Mu(t){const e=Zi.get(t);(of?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return ZN(n,r())}function Lu(t){return wl.add(t),t}function XN(){return{proxyStateMap:Zi,refSet:wl,snapCache:Cg,versionHolder:Bd,proxyCache:Bu}}function bt(t,e,n,r){let s=t[e];return vt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:QN,snapCache:ex}=XN(),Ql=t=>QN.has(t);function tx(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const u=ex.get(a),l=u?.[1];if(l&&!s.has(l)){const d=new Map(r);s.set(l,d)}},o=u=>s.get(u)||r,a={data:e,index:n,epoch:0,get size(){return Ql(this)||i(),o(this).size},get(u){const d=o(this).get(u);if(d===void 0){this.epoch;return}return this.data[d]},has(u){const l=o(this);return this.epoch,l.has(u)},set(u,l){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(u);return d===void 0?(r.set(u,this.index),this.data[this.index++]=l):this.data[d]=l,this.epoch++,this},delete(u){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");const l=r.get(u);return l===void 0?!1:(delete this.data[l],r.delete(u),this.epoch++,!0)},clear(){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(u){this.epoch,o(this).forEach((d,f)=>{u(this.data[d],f,this)})},*entries(){this.epoch;const u=o(this);for(const[l,d]of u)yield[l,this.data[d]]},*keys(){this.epoch;const u=o(this);for(const l of u.keys())yield l},*values(){this.epoch;const u=o(this);for(const l of u.values())yield this.data[l]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Je(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var Md={exports:{}},nx=Md.exports,Bw;function rx(){return Bw||(Bw=1,(function(t,e){(function(n,r){t.exports=r()})(nx,(function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",c="hour",u="day",l="week",d="month",f="quarter",h="year",g="date",p="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(O){var m=["th","st","nd","rd"],b=O%100;return"["+O+(m[(b-20)%10]||m[b]||m[0])+"]"}},w=function(O,m,b){var v=String(O);return!v||v.length>=m?O:""+Array(m+1-v.length).join(b)+O},C={s:w,z:function(O){var m=-O.utcOffset(),b=Math.abs(m),v=Math.floor(b/60),S=b%60;return(m<=0?"+":"-")+w(v,2,"0")+":"+w(S,2,"0")},m:function O(m,b){if(m.date()<b.date())return-O(b,m);var v=12*(b.year()-m.year())+(b.month()-m.month()),S=m.clone().add(v,d),I=b-S<0,x=m.clone().add(v+(I?-1:1),d);return+(-(v+(b-S)/(I?S-x:x-S))||0)},a:function(O){return O<0?Math.ceil(O)||0:Math.floor(O)},p:function(O){return{M:d,y:h,w:l,d:u,D:g,h:c,m:a,s:o,ms:i,Q:f}[O]||String(O||"").toLowerCase().replace(/s$/,"")},u:function(O){return O===void 0}},_="en",P={};P[_]=A;var k="$isDayjsObject",U=function(O){return O instanceof D||!(!O||!O[k])},$=function O(m,b,v){var S;if(!m)return _;if(typeof m=="string"){var I=m.toLowerCase();P[I]&&(S=I),b&&(P[I]=b,S=I);var x=m.split("-");if(!S&&x.length>1)return O(x[0])}else{var B=m.name;P[B]=m,S=B}return!v&&S&&(_=S),S||!v&&_},L=function(O,m){if(U(O))return O.clone();var b=typeof m=="object"?m:{};return b.date=O,b.args=arguments,new D(b)},M=C;M.l=$,M.i=U,M.w=function(O,m){return L(O,{locale:m.$L,utc:m.$u,x:m.$x,$offset:m.$offset})};var D=(function(){function O(b){this.$L=$(b.locale,null,!0),this.parse(b),this.$x=this.$x||b.x||{},this[k]=!0}var m=O.prototype;return m.parse=function(b){this.$d=(function(v){var S=v.date,I=v.utc;if(S===null)return new Date(NaN);if(M.u(S))return new Date;if(S instanceof Date)return new Date(S);if(typeof S=="string"&&!/Z$/i.test(S)){var x=S.match(y);if(x){var B=x[2]-1||0,F=(x[7]||"0").substring(0,3);return I?new Date(Date.UTC(x[1],B,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)):new Date(x[1],B,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)}}return new Date(S)})(b),this.init()},m.init=function(){var b=this.$d;this.$y=b.getFullYear(),this.$M=b.getMonth(),this.$D=b.getDate(),this.$W=b.getDay(),this.$H=b.getHours(),this.$m=b.getMinutes(),this.$s=b.getSeconds(),this.$ms=b.getMilliseconds()},m.$utils=function(){return M},m.isValid=function(){return this.$d.toString()!==p},m.isSame=function(b,v){var S=L(b);return this.startOf(v)<=S&&S<=this.endOf(v)},m.isAfter=function(b,v){return L(b)<this.startOf(v)},m.isBefore=function(b,v){return this.endOf(v)<L(b)},m.$g=function(b,v,S){return M.u(b)?this[v]:this.set(S,b)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(b,v){var S=this,I=!!M.u(v)||v,x=M.p(b),B=function(J,te){var Ae=M.w(S.$u?Date.UTC(S.$y,te,J):new Date(S.$y,te,J),S);return I?Ae:Ae.endOf(u)},F=function(J,te){return M.w(S.toDate()[J].apply(S.toDate("s"),(I?[0,0,0,0]:[23,59,59,999]).slice(te)),S)},W=this.$W,j=this.$M,q=this.$D,Y="set"+(this.$u?"UTC":"");switch(x){case h:return I?B(1,0):B(31,11);case d:return I?B(1,j):B(0,j+1);case l:var Q=this.$locale().weekStart||0,ue=(W<Q?W+7:W)-Q;return B(I?q-ue:q+(6-ue),j);case u:case g:return F(Y+"Hours",0);case c:return F(Y+"Minutes",1);case a:return F(Y+"Seconds",2);case o:return F(Y+"Milliseconds",3);default:return this.clone()}},m.endOf=function(b){return this.startOf(b,!1)},m.$set=function(b,v){var S,I=M.p(b),x="set"+(this.$u?"UTC":""),B=(S={},S[u]=x+"Date",S[g]=x+"Date",S[d]=x+"Month",S[h]=x+"FullYear",S[c]=x+"Hours",S[a]=x+"Minutes",S[o]=x+"Seconds",S[i]=x+"Milliseconds",S)[I],F=I===u?this.$D+(v-this.$W):v;if(I===d||I===h){var W=this.clone().set(g,1);W.$d[B](F),W.init(),this.$d=W.set(g,Math.min(this.$D,W.daysInMonth())).$d}else B&&this.$d[B](F);return this.init(),this},m.set=function(b,v){return this.clone().$set(b,v)},m.get=function(b){return this[M.p(b)]()},m.add=function(b,v){var S,I=this;b=Number(b);var x=M.p(v),B=function(j){var q=L(I);return M.w(q.date(q.date()+Math.round(j*b)),I)};if(x===d)return this.set(d,this.$M+b);if(x===h)return this.set(h,this.$y+b);if(x===u)return B(1);if(x===l)return B(7);var F=(S={},S[a]=r,S[c]=s,S[o]=n,S)[x]||1,W=this.$d.getTime()+b*F;return M.w(W,this)},m.subtract=function(b,v){return this.add(-1*b,v)},m.format=function(b){var v=this,S=this.$locale();if(!this.isValid())return S.invalidDate||p;var I=b||"YYYY-MM-DDTHH:mm:ssZ",x=M.z(this),B=this.$H,F=this.$m,W=this.$M,j=S.weekdays,q=S.months,Y=S.meridiem,Q=function(te,Ae,Oe,Be){return te&&(te[Ae]||te(v,I))||Oe[Ae].slice(0,Be)},ue=function(te){return M.s(B%12||12,te,"0")},J=Y||function(te,Ae,Oe){var Be=te<12?"AM":"PM";return Oe?Be.toLowerCase():Be};return I.replace(E,(function(te,Ae){return Ae||(function(Oe){switch(Oe){case"YY":return String(v.$y).slice(-2);case"YYYY":return M.s(v.$y,4,"0");case"M":return W+1;case"MM":return M.s(W+1,2,"0");case"MMM":return Q(S.monthsShort,W,q,3);case"MMMM":return Q(q,W);case"D":return v.$D;case"DD":return M.s(v.$D,2,"0");case"d":return String(v.$W);case"dd":return Q(S.weekdaysMin,v.$W,j,2);case"ddd":return Q(S.weekdaysShort,v.$W,j,3);case"dddd":return j[v.$W];case"H":return String(B);case"HH":return M.s(B,2,"0");case"h":return ue(1);case"hh":return ue(2);case"a":return J(B,F,!0);case"A":return J(B,F,!1);case"m":return String(F);case"mm":return M.s(F,2,"0");case"s":return String(v.$s);case"ss":return M.s(v.$s,2,"0");case"SSS":return M.s(v.$ms,3,"0");case"Z":return x}return null})(te)||x.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(b,v,S){var I,x=this,B=M.p(v),F=L(b),W=(F.utcOffset()-this.utcOffset())*r,j=this-F,q=function(){return M.m(x,F)};switch(B){case h:I=q()/12;break;case d:I=q();break;case f:I=q()/3;break;case l:I=(j-W)/6048e5;break;case u:I=(j-W)/864e5;break;case c:I=j/s;break;case a:I=j/r;break;case o:I=j/n;break;default:I=j}return S?I:M.a(I)},m.daysInMonth=function(){return this.endOf(d).$D},m.$locale=function(){return P[this.$L]},m.locale=function(b,v){if(!b)return this.$L;var S=this.clone(),I=$(b,v,!0);return I&&(S.$L=I),S},m.clone=function(){return M.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},O})(),T=D.prototype;return L.prototype=T,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",u],["$M",d],["$y",h],["$D",g]].forEach((function(O){T[O[1]]=function(m){return this.$g(m,O[0],O[1])}})),L.extend=function(O,m){return O.$i||(O(m,D,L),O.$i=!0),L},L.locale=$,L.isDayjs=U,L.unix=function(O){return L(1e3*O)},L.en=P[_],L.Ls=P,L.p={},L}))})(Md)),Md.exports}var sx=rx();const Ya=aa(sx);var Ld={exports:{}},ix=Ld.exports,Mw;function ox(){return Mw||(Mw=1,(function(t,e){(function(n,r){t.exports=r()})(ix,(function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var r=["th","st","nd","rd"],s=n%100;return"["+n+(r[(s-20)%10]||r[s]||r[0])+"]"}}}))})(Ld)),Ld.exports}var ax=ox();const cx=aa(ax);var Fd={exports:{}},ux=Fd.exports,Lw;function lx(){return Lw||(Lw=1,(function(t,e){(function(n,r){t.exports=r()})(ux,(function(){return function(n,r,s){n=n||{};var i=r.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(u,l,d,f){return i.fromToBase(u,l,d,f)}s.en.relativeTime=o,i.fromToBase=function(u,l,d,f,h){for(var g,p,y,E=d.$locale().relativeTime||o,A=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],w=A.length,C=0;C<w;C+=1){var _=A[C];_.d&&(g=f?s(u).diff(d,_.d,!0):d.diff(u,_.d,!0));var P=(n.rounding||Math.round)(Math.abs(g));if(y=g>0,P<=_.r||!_.r){P<=1&&C>0&&(_=A[C-1]);var k=E[_.l];h&&(P=h(""+P)),p=typeof k=="string"?k.replace("%d",P):k(P,l,_.l,y);break}}if(l)return p;var U=y?E.future:E.past;return typeof U=="function"?U(p):U.replace("%s",p)},i.to=function(u,l){return a(u,l,this,!0)},i.from=function(u,l){return a(u,l,this)};var c=function(u){return u.$u?s.utc():s()};i.toNow=function(u){return this.to(c(this),u)},i.fromNow=function(u){return this.from(c(this),u)}}}))})(Fd)),Fd.exports}var dx=lx();const fx=aa(dx);var jd={exports:{}},hx=jd.exports,Fw;function px(){return Fw||(Fw=1,(function(t,e){(function(n,r){t.exports=r()})(hx,(function(){return function(n,r,s){s.updateLocale=function(i,o){var a=s.Ls[i];if(a)return(o?Object.keys(o):[]).forEach((function(c){a[c]=o[c]})),a}}}))})(jd)),jd.exports}var gx=px();const mx=aa(gx);Ya.extend(fx);Ya.extend(mx);const yx={...cx,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},bx=["January","February","March","April","May","June","July","August","September","October","November","December"];Ya.locale("en-web3-modal",yx);const jw={getMonthNameByIndex(t){return bx[t]},getYear(t=new Date().toISOString()){return Ya(t).year()},getRelativeDateFromNow(t){return Ya(t).locale("en-web3-modal").fromNow(!0)},formatDate(t,e="DD MMM"){return Ya(t).format(e)}};var qw={};const z={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",BASE_ACCOUNT:"baseAccount",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122",TON:"ton"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks",ton:"TON"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",TON:"ton"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof qw<"u"?qw.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}},IS_DEVELOPMENT:typeof process<"u"&&!1,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},Fu={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(n=>n.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const n=t.find(s=>s.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return z.CHAIN_NAME_MAP?.[r]||void 0}},L_=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var wx=20,Ex=1,Wo=1e6,zw=1e6,vx=-7,Cx=21,_x=!1,El="[big.js] ",ca=El+"Invalid ",uh=ca+"decimal places",Ax=ca+"rounding mode",F_=El+"Division by zero",Qe={},bs=void 0,Sx=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function j_(){function t(e){var n=this;if(!(n instanceof t))return e===bs?j_():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(ca+"value");e=e===0&&1/e<0?"-0":String(e)}Ix(n,e)}n.constructor=t}return t.prototype=Qe,t.DP=wx,t.RM=Ex,t.NE=vx,t.PE=Cx,t.strict=_x,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Ix(t,e){var n,r,s;if(!Sx.test(e))throw Error(ca+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function ua(t,e,n,r){var s=t.c;if(n===bs&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(Ax);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==bs))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==bs||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function la(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}Qe.abs=function(){var t=new this.constructor(this);return t.s=1,t};Qe.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Qe.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Wo)throw Error(uh);if(!s[0])throw Error(F_);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,u,l,d,f=s.slice(),h=a=s.length,g=r.length,p=r.slice(0,a),y=p.length,E=t,A=E.c=[],w=0,C=o+(E.e=e.e-t.e)+1;for(E.s=i,i=C<0?0:C,f.unshift(0);y++<a;)p.push(0);do{for(u=0;u<10;u++){if(a!=(y=p.length))l=a>y?1:-1;else for(d=-1,l=0;++d<a;)if(s[d]!=p[d]){l=s[d]>p[d]?1:-1;break}if(l<0){for(c=y==a?s:f;y;){if(p[--y]<c[y]){for(d=y;d&&!p[--d];)p[d]=9;--p[d],p[y]+=10}p[y]-=c[y]}for(;!p[0];)p.shift()}else break}A[w++]=l?u:++u,p[0]&&l?p[y]=r[h]||0:p=[r[h]]}while((h++<g||p[0]!==bs)&&i--);return!A[0]&&w!=1&&(A.shift(),E.e--,C--),w>C&&ua(E,C,n.RM,p[0]!==bs),E};Qe.eq=function(t){return this.cmp(t)===0};Qe.gt=function(t){return this.cmp(t)>0};Qe.gte=function(t){return this.cmp(t)>-1};Qe.lt=function(t){return this.cmp(t)<0};Qe.lte=function(t){return this.cmp(t)<1};Qe.minus=Qe.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var u=i.c.slice(),l=i.e,d=t.c,f=t.e;if(!u[0]||!d[0])return d[0]?t.s=-c:u[0]?t=new o(i):t.s=1,t;if(a=l-f){for((s=a<0)?(a=-a,r=u):(f=l,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=u.length<d.length)?u:d).length,a=c=0;c<n;c++)if(u[c]!=d[c]){s=u[c]<d[c];break}if(s&&(r=u,u=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=u.length))>0)for(;c--;)u[e++]=0;for(c=e;n>a;){if(u[--n]<d[n]){for(e=n;e&&!u[--e];)u[e]=9;--u[e],u[n]+=10}u[n]-=d[n]}for(;u[--c]===0;)u.pop();for(;u[0]===0;)u.shift(),--f;return u[0]||(t.s=1,u=[f=0]),t.c=u,t.e=f,t};Qe.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(F_);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};Qe.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Qe.plus=Qe.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,u=t.c;if(!a[0]||!u[0])return u[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=u):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-u.length<0&&(r=u,u=a,a=r),e=u.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+u[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Qe.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-zw||t>zw)throw Error(ca+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};Qe.prec=function(t,e){if(t!==~~t||t<1||t>Wo)throw Error(ca+"precision");return ua(new this.constructor(this),t,e)};Qe.round=function(t,e){if(t===bs)t=0;else if(t!==~~t||t<-Wo||t>Wo)throw Error(uh);return ua(new this.constructor(this),t+this.e+1,e)};Qe.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(El+"No square root");i=Math.sqrt(+la(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return ua(t,(s.DP-=4)+t.e+1,s.RM)};Qe.times=Qe.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,u=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+u,o<a&&(e=s,s=i,i=e,u=o,o=a,a=u),e=new Array(u=o+a);u--;)e[u]=0;for(c=a;c--;){for(a=0,u=o+c;u>c;)a=e[u]+i[c]*s[u-c-1]+a,e[u--]=a%10,a=a/10|0;e[u]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Qe.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==bs){if(t!==~~t||t<0||t>Wo)throw Error(uh);for(n=ua(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return la(n,!0,!!r)};Qe.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==bs){if(t!==~~t||t<0||t>Wo)throw Error(uh);for(n=ua(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return la(n,!1,!!r)};Qe[Symbol.for("nodejs.util.inspect.custom")]=Qe.toJSON=Qe.toString=function(){var t=this,e=t.constructor;return la(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Qe.toNumber=function(){var t=+la(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(El+"Imprecise conversion");return t};Qe.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==bs){if(t!==~~t||t<1||t>Wo)throw Error(ca+"precision");for(n=ua(new r(n),t,e);n.c.length<t;)n.c.push(0)}return la(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};Qe.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(El+"valueOf disallowed");return la(t,t.e<=e.NE||t.e>=e.PE,!0)};var wi=j_();const mt={bigNumber(t){return t?new wi(t):new wi(0)},multiply(t,e){if(t===void 0||e===void 0)return new wi(0);const n=new wi(t),r=new wi(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new wi(0).toFixed(e):new wi(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new wi(e).toNumber()}},pte={numericInputKeyDown(t,e,n){const r=["Backspace","Meta","Ctrl","a","A","c","C","x","X","v","V","ArrowLeft","ArrowRight","Tab"],s=t.metaKey||t.ctrlKey,i=t.key,o=i.toLocaleLowerCase(),a=o==="a",c=o==="c",u=o==="v",l=o==="x",d=i===",",f=i===".",h=i>="0"&&i<="9";!s&&(a||c||u||l)&&t.preventDefault(),e==="0"&&!d&&!f&&i==="0"&&t.preventDefault(),e==="0"&&h&&(n(i),t.preventDefault()),(d||f)&&(e||(n("0."),t.preventDefault()),(e?.includes(".")||e?.includes(","))&&t.preventDefault()),!h&&!r.includes(i)&&!f&&!d&&t.preventDefault()}},Tx=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Nx=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],xx=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Px={getERC20Abi:t=>z.USDT_CONTRACT_ADDRESSES.includes(t)?xx:Tx,getSwapAbi:()=>Nx},gte={URLS:{FAQ:"https://walletconnect.com/faq"}},Dt={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},Fr={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001,USER_REJECTED_METHODS:5002,USER_REJECTED:5e3},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){if(Fr.isRpcProviderError(t)){const e=t.code===Fr.RPC_ERROR_CODE.USER_REJECTED_REQUEST,n=t.code===Fr.RPC_ERROR_CODE.USER_REJECTED_METHODS;return e||n||Fr.isUserRejectedMessage(t.message)}return t instanceof Error?Fr.isUserRejectedMessage(t.message):!1}};let Ox=class extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=Fr.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}},Fa=class extends Ox{constructor(e){super(e,{code:Fr.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=Fr.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const be={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version",TON_WALLETS_CACHE:"@appkit/ton_wallets_cache"};function Sp(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const me={setItem(t,e){wu()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(wu())return localStorage.getItem(t)||void 0},removeItem(t){wu()&&localStorage.removeItem(t)},clear(){wu()&&localStorage.clear()}};function wu(){return typeof window<"u"&&typeof localStorage<"u"}function ju(t,e){const n=t?.["--apkt-accent"]??t?.["--w3m-accent"];return e==="light"?{"--w3m-accent":n||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":n||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var Hw={};const Ip=(typeof process<"u"&&typeof Hw<"u"?Hw.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",q_=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],Rx="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",De={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:Ip,SECURE_SITE_DASHBOARD:`${Ip}/dashboard`,SECURE_SITE_FAVICON:`${Ip}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],SUGGESTED_TOKENS_BY_CHAIN:{"eip155:42161":["USDâ‚®0"]},BALANCE_SUPPORTED_CHAINS:[z.CHAIN.EVM,z.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[z.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[z.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[z.CHAIN.EVM,z.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[z.CHAIN.EVM,z.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[z.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x",ton:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[z.CHAIN.EVM,z.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa",ton:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},G={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5,tonWallets:864e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=G.getActiveNamespace(),e=G.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{me.setItem(be.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=me.getItem(be.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{me.removeItem(be.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{me.setItem(be.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{me.setItem(be.ACTIVE_CAIP_NETWORK_ID,t),G.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return me.getItem(be.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{me.removeItem(be.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Sp(t);me.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=G.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),me.setItem(be.RECENT_WALLETS,JSON.stringify(e)),me.setItem(be.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=me.getItem(be.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=me.getItem(be.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{me.removeItem(be.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=Sp(t);me.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return me.getItem(be.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Sp(t);return me.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{me.setItem(be.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return me.getItem(be.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{me.removeItem(be.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return me.getItem(be.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return me.getItem(be.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{me.setItem(be.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return me.getItem(be.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=me.getItem(be.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));me.setItem(be.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=G.getConnectedNamespaces();e.includes(t)||(e.push(t),G.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=G.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),G.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return me.getItem(be.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{me.setItem(be.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{me.removeItem(be.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=me.getItem(be.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=G.getBalanceCache();me.setItem(be.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=G.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;G.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=G.getBalanceCache();e[t.caipAddress]=t,me.setItem(be.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=me.getItem(be.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=G.getBalanceCache();me.setItem(be.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=G.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),G.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=G.getNativeBalanceCache();e[t.caipAddress]=t,me.setItem(be.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=me.getItem(be.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=G.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;G.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=G.getEnsCache();e[t.address]=t,me.setItem(be.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=G.getEnsCache();me.setItem(be.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=me.getItem(be.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=G.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;G.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=G.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},me.setItem(be.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=G.getIdentityCache();me.setItem(be.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},getTonWalletsCache(){try{const t=me.getItem(be.TON_WALLETS_CACHE),e=t?JSON.parse(t):void 0;if(e&&!this.isCacheExpired(e.timestamp,this.cacheExpiry.tonWallets))return e;G.removeTonWalletsCache()}catch{console.info("Unable to get ton wallets cache")}},updateTonWalletsCache(t){try{const e=G.getTonWalletsCache()||{timestamp:0,wallets:[]};e.timestamp=new Date().getTime(),e.wallets=t,me.setItem(be.TON_WALLETS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ton wallets cache",t)}},removeTonWalletsCache(){try{me.removeItem(be.TON_WALLETS_CACHE)}catch{console.info("Unable to remove ton wallets cache")}},clearAddressCache(){try{me.removeItem(be.PORTFOLIO_CACHE),me.removeItem(be.NATIVE_BALANCE_CACHE),me.removeItem(be.ENS_CACHE),me.removeItem(be.IDENTITY_CACHE),me.removeItem(be.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{me.setItem(be.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=me.getItem(be.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=G.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===z.CONNECTOR_ID.AUTH;if(a&&!c){const u=new Set(a.accounts.map(d=>d.address.toLowerCase())),l=o.accounts.filter(d=>!u.has(d.address.toLowerCase()));a.accounts.push(...l)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};me.setItem(be.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=me.getItem(be.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=G.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),me.setItem(be.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=me.getItem(be.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=G.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),me.setItem(be.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=G.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),me.setItem(be.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(G.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=me.getItem(be.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const r=G.getTransactionsCache()[t]?.[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;G.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=G.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},me.setItem(be.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=G.getTransactionsCache(),r=n?.[t]||{},{[e]:s,...i}=r;me.setItem(be.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=me.getItem(be.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=G.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;G.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=G.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},me.setItem(be.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=G.getTokenPriceCache();me.setItem(be.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t?.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=me.getItem(be.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=G.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,me.setItem(be.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},oe={getWindow(){if(!(typeof window>"u"))return window},isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return oe.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=De.TEN_SEC_MS:!0},isAllowedRetry(t,e=De.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(oe.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const n=new URL(t),r=new URL(e);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+De.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(oe.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!oe.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?G.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,oe.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const u=(Math.floor(c*1e3)/1e3).toFixed(3);u&&(n=u)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return z.W3M_API_URL},getBlockchainApiUrl(){return z.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return z.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?De.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in z.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),u=t.substring(s),l=c+n;return a+l+u}};var bte=RN(),cc={};const kx="https://secure.walletconnect.org/sdk",$x=(typeof process<"u"&&typeof cc<"u"?cc.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||kx,Dx=(typeof process<"u"&&typeof cc<"u"?cc.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",Ux=(typeof process<"u"&&typeof cc<"u"?cc.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",ge={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},lt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Ww={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Rt={set(t,e){rr.isClient&&localStorage.setItem(`${ge.STORAGE_KEY}${t}`,e)},get(t){return rr.isClient?localStorage.getItem(`${ge.STORAGE_KEY}${t}`):null},delete(t,e){rr.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${ge.STORAGE_KEY}${t}`))}},ed=30*1e3,rr={checkIfAllowedToTriggerEmail(){const t=Rt.get(ge.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<ed){const n=Math.ceil((ed-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Rt.get(ge.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<ed)return Math.ceil((ed-e)/1e3)}return 0},checkIfRequestExists(t){return lt.NOT_SAFE_RPC_METHODS.includes(t.method)||lt.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&(t?.match(Ww.transactionHash)||t?.match(Ww.signedMessage))?ge.RPC_RESPONSE_TYPE_TX:ge.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return lt.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Ge;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Ge||(Ge={}));var _g;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(_g||(_g={}));const le=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mi=t=>{switch(typeof t){case"undefined":return le.undefined;case"string":return le.string;case"number":return isNaN(t)?le.nan:le.number;case"boolean":return le.boolean;case"function":return le.function;case"bigint":return le.bigint;case"symbol":return le.symbol;case"object":return Array.isArray(t)?le.array:t===null?le.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?le.promise:typeof Map<"u"&&t instanceof Map?le.map:typeof Set<"u"&&t instanceof Set?le.set:typeof Date<"u"&&t instanceof Date?le.date:le.object;default:return le.unknown}},ne=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Bx=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Wr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const u=o.path[c];c===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Wr.create=t=>new Wr(t);const qu=(t,e)=>{let n;switch(t.code){case ne.invalid_type:t.received===le.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ne.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case ne.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case ne.invalid_union:n="Invalid input";break;case ne.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case ne.invalid_enum_value:n=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case ne.invalid_arguments:n="Invalid function arguments";break;case ne.invalid_return_type:n="Invalid function return type";break;case ne.invalid_date:n="Invalid date";break;case ne.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ne.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ne.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ne.custom:n="Invalid input";break;case ne.invalid_intersection_types:n="Intersection results could not be merged";break;case ne.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ne.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ge.assertNever(t)}return{message:n}};let z_=qu;function Mx(t){z_=t}function af(){return z_}const cf=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(u=>!!u).slice().reverse();for(const u of c)a=u(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},Lx=[];function pe(t,e){const n=cf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,af(),qu].filter(r=>!!r)});t.common.issues.push(n)}class fn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return xe;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return fn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return xe;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const xe=Object.freeze({status:"aborted"}),H_=t=>({status:"dirty",value:t}),An=t=>({status:"valid",value:t}),Ag=t=>t.status==="aborted",Sg=t=>t.status==="dirty",zu=t=>t.status==="valid",uf=t=>typeof Promise<"u"&&t instanceof Promise;var _e;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(_e||(_e={}));class As{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Vw=(t,e)=>{if(zu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Wr(t.common.issues);return this._error=n,this._error}}};function Pe(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class $e{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Mi(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Mi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new fn,ctx:{common:e.parent.common,data:e.data,parsedType:Mi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(uf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mi(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Vw(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mi(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(uf(s)?s:Promise.resolve(s));return Vw(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:ne.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Gr({schema:this,typeName:Ie.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ri.create(this,this._def)}nullable(){return Go.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Vr.create(this,this._def)}promise(){return lc.create(this,this._def)}or(e){return Ku.create([this,e],this._def)}and(e){return Gu.create(this,e,this._def)}transform(e){return new Gr({...Pe(this._def),schema:this,typeName:Ie.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Qu({...Pe(this._def),innerType:this,defaultValue:n,typeName:Ie.ZodDefault})}brand(){return new V_({typeName:Ie.ZodBranded,type:this,...Pe(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new hf({...Pe(this._def),innerType:this,catchValue:n,typeName:Ie.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return vl.create(this,e)}readonly(){return gf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fx=/^c[^\s-]{8,}$/i,jx=/^[a-z][a-z0-9]*$/,qx=/^[0-9A-HJKMNP-TV-Z]{26}$/,zx=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Hx=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Wx="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Tp;const Vx=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Kx=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Gx=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Yx(t,e){return!!((e==="v4"||!e)&&Vx.test(t)||(e==="v6"||!e)&&Kx.test(t))}class qr extends $e{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==le.string){const i=this._getOrReturnCtx(e);return pe(i,{code:ne.invalid_type,expected:le.string,received:i.parsedType}),xe}const r=new fn;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?pe(s,{code:ne.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&pe(s,{code:ne.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Hx.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"email",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Tp||(Tp=new RegExp(Wx,"u")),Tp.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"emoji",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")zx.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"uuid",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Fx.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"cuid",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")jx.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"cuid2",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")qx.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"ulid",code:ne.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),pe(s,{validation:"url",code:ne.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"regex",code:ne.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Gx(i).test(e.data)||(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?Yx(e.data,i.version)||(s=this._getOrReturnCtx(e,s),pe(s,{validation:"ip",code:ne.invalid_string,message:i.message}),r.dirty()):Ge.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:ne.invalid_string,..._e.errToObj(r)})}_addCheck(e){return new qr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",..._e.errToObj(e)})}url(e){return this._addCheck({kind:"url",..._e.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",..._e.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",..._e.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",..._e.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",..._e.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",..._e.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",..._e.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,..._e.errToObj(e?.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,..._e.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,..._e.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,..._e.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,..._e.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,..._e.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,..._e.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,..._e.errToObj(n)})}nonempty(e){return this.min(1,_e.errToObj(e))}trim(){return new qr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new qr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new qr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}qr.create=t=>{var e;return new qr({checks:[],typeName:Ie.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};function Zx(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Ji extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==le.number){const i=this._getOrReturnCtx(e);return pe(i,{code:ne.invalid_type,expected:le.number,received:i.parsedType}),xe}let r;const s=new fn;for(const i of this._def.checks)i.kind==="int"?Ge.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Zx(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.not_finite,message:i.message}),s.dirty()):Ge.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,_e.toString(n))}gt(e,n){return this.setLimit("min",e,!1,_e.toString(n))}lte(e,n){return this.setLimit("max",e,!0,_e.toString(n))}lt(e,n){return this.setLimit("max",e,!1,_e.toString(n))}setLimit(e,n,r,s){return new Ji({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:_e.toString(s)}]})}_addCheck(e){return new Ji({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:_e.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:_e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:_e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:_e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:_e.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:_e.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:_e.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:_e.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:_e.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ji.create=t=>new Ji({checks:[],typeName:Ie.ZodNumber,coerce:t?.coerce||!1,...Pe(t)});class Xi extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==le.bigint){const i=this._getOrReturnCtx(e);return pe(i,{code:ne.invalid_type,expected:le.bigint,received:i.parsedType}),xe}let r;const s=new fn;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),pe(r,{code:ne.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Ge.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,_e.toString(n))}gt(e,n){return this.setLimit("min",e,!1,_e.toString(n))}lte(e,n){return this.setLimit("max",e,!0,_e.toString(n))}lt(e,n){return this.setLimit("max",e,!1,_e.toString(n))}setLimit(e,n,r,s){return new Xi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:_e.toString(s)}]})}_addCheck(e){return new Xi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:_e.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:_e.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:_e.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:_e.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:_e.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Xi.create=t=>{var e;return new Xi({checks:[],typeName:Ie.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Pe(t)})};class Hu extends $e{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==le.boolean){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.boolean,received:r.parsedType}),xe}return An(e.data)}}Hu.create=t=>new Hu({typeName:Ie.ZodBoolean,coerce:t?.coerce||!1,...Pe(t)});class Vo extends $e{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==le.date){const i=this._getOrReturnCtx(e);return pe(i,{code:ne.invalid_type,expected:le.date,received:i.parsedType}),xe}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return pe(i,{code:ne.invalid_date}),xe}const r=new fn;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),pe(s,{code:ne.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ge.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Vo({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:_e.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:_e.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Vo.create=t=>new Vo({checks:[],coerce:t?.coerce||!1,typeName:Ie.ZodDate,...Pe(t)});class lf extends $e{_parse(e){if(this._getType(e)!==le.symbol){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.symbol,received:r.parsedType}),xe}return An(e.data)}}lf.create=t=>new lf({typeName:Ie.ZodSymbol,...Pe(t)});class Wu extends $e{_parse(e){if(this._getType(e)!==le.undefined){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.undefined,received:r.parsedType}),xe}return An(e.data)}}Wu.create=t=>new Wu({typeName:Ie.ZodUndefined,...Pe(t)});class Vu extends $e{_parse(e){if(this._getType(e)!==le.null){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.null,received:r.parsedType}),xe}return An(e.data)}}Vu.create=t=>new Vu({typeName:Ie.ZodNull,...Pe(t)});class uc extends $e{constructor(){super(...arguments),this._any=!0}_parse(e){return An(e.data)}}uc.create=t=>new uc({typeName:Ie.ZodAny,...Pe(t)});class jo extends $e{constructor(){super(...arguments),this._unknown=!0}_parse(e){return An(e.data)}}jo.create=t=>new jo({typeName:Ie.ZodUnknown,...Pe(t)});class di extends $e{_parse(e){const n=this._getOrReturnCtx(e);return pe(n,{code:ne.invalid_type,expected:le.never,received:n.parsedType}),xe}}di.create=t=>new di({typeName:Ie.ZodNever,...Pe(t)});class df extends $e{_parse(e){if(this._getType(e)!==le.undefined){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.void,received:r.parsedType}),xe}return An(e.data)}}df.create=t=>new df({typeName:Ie.ZodVoid,...Pe(t)});class Vr extends $e{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==le.array)return pe(n,{code:ne.invalid_type,expected:le.array,received:n.parsedType}),xe;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(pe(n,{code:o?ne.too_big:ne.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(pe(n,{code:ne.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(pe(n,{code:ne.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new As(n,o,n.path,a)))).then(o=>fn.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new As(n,o,n.path,a)));return fn.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Vr({...this._def,minLength:{value:e,message:_e.toString(n)}})}max(e,n){return new Vr({...this._def,maxLength:{value:e,message:_e.toString(n)}})}length(e,n){return new Vr({...this._def,exactLength:{value:e,message:_e.toString(n)}})}nonempty(e){return this.min(1,e)}}Vr.create=(t,e)=>new Vr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ie.ZodArray,...Pe(e)});function $a(t){if(t instanceof ht){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ri.create($a(r))}return new ht({...t._def,shape:()=>e})}else return t instanceof Vr?new Vr({...t._def,type:$a(t.element)}):t instanceof ri?ri.create($a(t.unwrap())):t instanceof Go?Go.create($a(t.unwrap())):t instanceof Ss?Ss.create(t.items.map(e=>$a(e))):t}class ht extends $e{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ge.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==le.object){const u=this._getOrReturnCtx(e);return pe(u,{code:ne.invalid_type,expected:le.object,received:u.parsedType}),xe}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof di&&this._def.unknownKeys==="strip"))for(const u in s.data)o.includes(u)||a.push(u);const c=[];for(const u of o){const l=i[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new As(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof di){const u=this._def.unknownKeys;if(u==="passthrough")for(const l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(pe(s,{code:ne.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const l of a){const d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new As(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const l of c){const d=await l.key;u.push({key:d,value:await l.value,alwaysSet:l.alwaysSet})}return u}).then(u=>fn.mergeObjectSync(r,u)):fn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return _e.errToObj,new ht({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=_e.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new ht({...this._def,unknownKeys:"strip"})}passthrough(){return new ht({...this._def,unknownKeys:"passthrough"})}extend(e){return new ht({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ht({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ie.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new ht({...this._def,catchall:e})}pick(e){const n={};return Ge.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new ht({...this._def,shape:()=>n})}omit(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new ht({...this._def,shape:()=>n})}deepPartial(){return $a(this)}partial(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new ht({...this._def,shape:()=>n})}required(e){const n={};return Ge.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ri;)i=i._def.innerType;n[r]=i}}),new ht({...this._def,shape:()=>n})}keyof(){return W_(Ge.objectKeys(this.shape))}}ht.create=(t,e)=>new ht({shape:()=>t,unknownKeys:"strip",catchall:di.create(),typeName:Ie.ZodObject,...Pe(e)});ht.strictCreate=(t,e)=>new ht({shape:()=>t,unknownKeys:"strict",catchall:di.create(),typeName:Ie.ZodObject,...Pe(e)});ht.lazycreate=(t,e)=>new ht({shape:t,unknownKeys:"strip",catchall:di.create(),typeName:Ie.ZodObject,...Pe(e)});class Ku extends $e{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Wr(a.ctx.common.issues));return pe(n,{code:ne.invalid_union,unionErrors:o}),xe}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const u={...n,common:{...n.common,issues:[]},parent:null},l=c._parseSync({data:n.data,path:n.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new Wr(c));return pe(n,{code:ne.invalid_union,unionErrors:a}),xe}}get options(){return this._def.options}}Ku.create=(t,e)=>new Ku({options:t,typeName:Ie.ZodUnion,...Pe(e)});const qd=t=>t instanceof Zu?qd(t.schema):t instanceof Gr?qd(t.innerType()):t instanceof Ju?[t.value]:t instanceof Qi?t.options:t instanceof Xu?Object.keys(t.enum):t instanceof Qu?qd(t._def.innerType):t instanceof Wu?[void 0]:t instanceof Vu?[null]:null;class lh extends $e{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==le.object)return pe(n,{code:ne.invalid_type,expected:le.object,received:n.parsedType}),xe;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(pe(n,{code:ne.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),xe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=qd(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new lh({typeName:Ie.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...Pe(r)})}}function Ig(t,e){const n=Mi(t),r=Mi(e);if(t===e)return{valid:!0,data:t};if(n===le.object&&r===le.object){const s=Ge.objectKeys(e),i=Ge.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=Ig(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===le.array&&r===le.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=Ig(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===le.date&&r===le.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Gu extends $e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(Ag(i)||Ag(o))return xe;const a=Ig(i.value,o.value);return a.valid?((Sg(i)||Sg(o))&&n.dirty(),{status:n.value,value:a.data}):(pe(r,{code:ne.invalid_intersection_types}),xe)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Gu.create=(t,e,n)=>new Gu({left:t,right:e,typeName:Ie.ZodIntersection,...Pe(n)});class Ss extends $e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==le.array)return pe(r,{code:ne.invalid_type,expected:le.array,received:r.parsedType}),xe;if(r.data.length<this._def.items.length)return pe(r,{code:ne.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),xe;!this._def.rest&&r.data.length>this._def.items.length&&(pe(r,{code:ne.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new As(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>fn.mergeArray(n,o)):fn.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ss({...this._def,rest:e})}}Ss.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ss({items:t,typeName:Ie.ZodTuple,rest:null,...Pe(e)})};class Yu extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==le.object)return pe(r,{code:ne.invalid_type,expected:le.object,received:r.parsedType}),xe;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new As(r,a,r.path,a)),value:o._parse(new As(r,r.data[a],r.path,a))});return r.common.async?fn.mergeObjectAsync(n,s):fn.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof $e?new Yu({keyType:e,valueType:n,typeName:Ie.ZodRecord,...Pe(r)}):new Yu({keyType:qr.create(),valueType:e,typeName:Ie.ZodRecord,...Pe(n)})}}class ff extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==le.map)return pe(r,{code:ne.invalid_type,expected:le.map,received:r.parsedType}),xe;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],u)=>({key:s._parse(new As(r,a,r.path,[u,"key"])),value:i._parse(new As(r,c,r.path,[u,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return xe;(u.status==="dirty"||l.status==="dirty")&&n.dirty(),a.set(u.value,l.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return xe;(u.status==="dirty"||l.status==="dirty")&&n.dirty(),a.set(u.value,l.value)}return{status:n.value,value:a}}}}ff.create=(t,e,n)=>new ff({valueType:e,keyType:t,typeName:Ie.ZodMap,...Pe(n)});class Ko extends $e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==le.set)return pe(r,{code:ne.invalid_type,expected:le.set,received:r.parsedType}),xe;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(pe(r,{code:ne.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(pe(r,{code:ne.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const u=new Set;for(const l of c){if(l.status==="aborted")return xe;l.status==="dirty"&&n.dirty(),u.add(l.value)}return{status:n.value,value:u}}const a=[...r.data.values()].map((c,u)=>i._parse(new As(r,c,r.path,u)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new Ko({...this._def,minSize:{value:e,message:_e.toString(n)}})}max(e,n){return new Ko({...this._def,maxSize:{value:e,message:_e.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Ko.create=(t,e)=>new Ko({valueType:t,minSize:null,maxSize:null,typeName:Ie.ZodSet,...Pe(e)});class Za extends $e{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==le.function)return pe(n,{code:ne.invalid_type,expected:le.function,received:n.parsedType}),xe;function r(a,c){return cf({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,af(),qu].filter(u=>!!u),issueData:{code:ne.invalid_arguments,argumentsError:c}})}function s(a,c){return cf({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,af(),qu].filter(u=>!!u),issueData:{code:ne.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof lc){const a=this;return An(async function(...c){const u=new Wr([]),l=await a._def.args.parseAsync(c,i).catch(h=>{throw u.addIssue(r(c,h)),u}),d=await Reflect.apply(o,this,l);return await a._def.returns._def.type.parseAsync(d,i).catch(h=>{throw u.addIssue(s(d,h)),u})})}else{const a=this;return An(function(...c){const u=a._def.args.safeParse(c,i);if(!u.success)throw new Wr([r(c,u.error)]);const l=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(l,i);if(!d.success)throw new Wr([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Za({...this._def,args:Ss.create(e).rest(jo.create())})}returns(e){return new Za({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Za({args:e||Ss.create([]).rest(jo.create()),returns:n||jo.create(),typeName:Ie.ZodFunction,...Pe(r)})}}class Zu extends $e{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Zu.create=(t,e)=>new Zu({getter:t,typeName:Ie.ZodLazy,...Pe(e)});class Ju extends $e{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return pe(n,{received:n.data,code:ne.invalid_literal,expected:this._def.value}),xe}return{status:"valid",value:e.data}}get value(){return this._def.value}}Ju.create=(t,e)=>new Ju({value:t,typeName:Ie.ZodLiteral,...Pe(e)});function W_(t,e){return new Qi({values:t,typeName:Ie.ZodEnum,...Pe(e)})}class Qi extends $e{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return pe(n,{expected:Ge.joinValues(r),received:n.parsedType,code:ne.invalid_type}),xe}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return pe(n,{received:n.data,code:ne.invalid_enum_value,options:r}),xe}return An(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Qi.create(e)}exclude(e){return Qi.create(this.options.filter(n=>!e.includes(n)))}}Qi.create=W_;class Xu extends $e{_parse(e){const n=Ge.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==le.string&&r.parsedType!==le.number){const s=Ge.objectValues(n);return pe(r,{expected:Ge.joinValues(s),received:r.parsedType,code:ne.invalid_type}),xe}if(n.indexOf(e.data)===-1){const s=Ge.objectValues(n);return pe(r,{received:r.data,code:ne.invalid_enum_value,options:s}),xe}return An(e.data)}get enum(){return this._def.values}}Xu.create=(t,e)=>new Xu({values:t,typeName:Ie.ZodNativeEnum,...Pe(e)});class lc extends $e{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==le.promise&&n.common.async===!1)return pe(n,{code:ne.invalid_type,expected:le.promise,received:n.parsedType}),xe;const r=n.parsedType===le.promise?n.data:Promise.resolve(n.data);return An(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}lc.create=(t,e)=>new lc({type:t,typeName:Ie.ZodPromise,...Pe(e)});class Gr extends $e{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ie.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{pe(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?xe:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?xe:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!zu(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>zu(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);Ge.assertNever(s)}}Gr.create=(t,e,n)=>new Gr({schema:t,typeName:Ie.ZodEffects,effect:e,...Pe(n)});Gr.createWithPreprocess=(t,e,n)=>new Gr({schema:e,effect:{type:"preprocess",transform:t},typeName:Ie.ZodEffects,...Pe(n)});class ri extends $e{_parse(e){return this._getType(e)===le.undefined?An(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ri.create=(t,e)=>new ri({innerType:t,typeName:Ie.ZodOptional,...Pe(e)});class Go extends $e{_parse(e){return this._getType(e)===le.null?An(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Go.create=(t,e)=>new Go({innerType:t,typeName:Ie.ZodNullable,...Pe(e)});class Qu extends $e{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===le.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Qu.create=(t,e)=>new Qu({innerType:t,typeName:Ie.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Pe(e)});class hf extends $e{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return uf(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Wr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Wr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}hf.create=(t,e)=>new hf({innerType:t,typeName:Ie.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Pe(e)});class pf extends $e{_parse(e){if(this._getType(e)!==le.nan){const r=this._getOrReturnCtx(e);return pe(r,{code:ne.invalid_type,expected:le.nan,received:r.parsedType}),xe}return{status:"valid",value:e.data}}}pf.create=t=>new pf({typeName:Ie.ZodNaN,...Pe(t)});const Jx=Symbol("zod_brand");class V_ extends $e{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class vl extends $e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?xe:i.status==="dirty"?(n.dirty(),H_(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?xe:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new vl({in:e,out:n,typeName:Ie.ZodPipeline})}}class gf extends $e{_parse(e){const n=this._def.innerType._parse(e);return zu(n)&&(n.value=Object.freeze(n.value)),n}}gf.create=(t,e)=>new gf({innerType:t,typeName:Ie.ZodReadonly,...Pe(e)});const K_=(t,e={},n)=>t?uc.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...u,fatal:c})}}):uc.create(),Xx={object:ht.lazycreate};var Ie;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ie||(Ie={}));const Qx=(t,e={message:`Input not instance of ${t.name}`})=>K_(n=>n instanceof t,e),G_=qr.create,Y_=Ji.create,e3=pf.create,t3=Xi.create,Z_=Hu.create,n3=Vo.create,r3=lf.create,s3=Wu.create,i3=Vu.create,o3=uc.create,a3=jo.create,c3=di.create,u3=df.create,l3=Vr.create,d3=ht.create,f3=ht.strictCreate,h3=Ku.create,p3=lh.create,g3=Gu.create,m3=Ss.create,y3=Yu.create,b3=ff.create,w3=Ko.create,E3=Za.create,v3=Zu.create,C3=Ju.create,_3=Qi.create,A3=Xu.create,S3=lc.create,Kw=Gr.create,I3=ri.create,T3=Go.create,N3=Gr.createWithPreprocess,x3=vl.create,P3=()=>G_().optional(),O3=()=>Y_().optional(),R3=()=>Z_().optional(),k3={string:(t=>qr.create({...t,coerce:!0})),number:(t=>Ji.create({...t,coerce:!0})),boolean:(t=>Hu.create({...t,coerce:!0})),bigint:(t=>Xi.create({...t,coerce:!0})),date:(t=>Vo.create({...t,coerce:!0}))},$3=xe;var N=Object.freeze({__proto__:null,defaultErrorMap:qu,setErrorMap:Mx,getErrorMap:af,makeIssue:cf,EMPTY_PATH:Lx,addIssueToContext:pe,ParseStatus:fn,INVALID:xe,DIRTY:H_,OK:An,isAborted:Ag,isDirty:Sg,isValid:zu,isAsync:uf,get util(){return Ge},get objectUtil(){return _g},ZodParsedType:le,getParsedType:Mi,ZodType:$e,ZodString:qr,ZodNumber:Ji,ZodBigInt:Xi,ZodBoolean:Hu,ZodDate:Vo,ZodSymbol:lf,ZodUndefined:Wu,ZodNull:Vu,ZodAny:uc,ZodUnknown:jo,ZodNever:di,ZodVoid:df,ZodArray:Vr,ZodObject:ht,ZodUnion:Ku,ZodDiscriminatedUnion:lh,ZodIntersection:Gu,ZodTuple:Ss,ZodRecord:Yu,ZodMap:ff,ZodSet:Ko,ZodFunction:Za,ZodLazy:Zu,ZodLiteral:Ju,ZodEnum:Qi,ZodNativeEnum:Xu,ZodPromise:lc,ZodEffects:Gr,ZodTransformer:Gr,ZodOptional:ri,ZodNullable:Go,ZodDefault:Qu,ZodCatch:hf,ZodNaN:pf,BRAND:Jx,ZodBranded:V_,ZodPipeline:vl,ZodReadonly:gf,custom:K_,Schema:$e,ZodSchema:$e,late:Xx,get ZodFirstPartyTypeKind(){return Ie},coerce:k3,any:o3,array:l3,bigint:t3,boolean:Z_,date:n3,discriminatedUnion:p3,effect:Kw,enum:_3,function:E3,instanceof:Qx,intersection:g3,lazy:v3,literal:C3,map:b3,nan:e3,nativeEnum:A3,never:c3,null:i3,nullable:T3,number:Y_,object:d3,oboolean:R3,onumber:O3,optional:I3,ostring:P3,pipeline:x3,preprocess:N3,promise:S3,record:y3,set:w3,strictObject:f3,string:G_,symbol:r3,transformer:Kw,tuple:m3,undefined:s3,union:h3,unknown:a3,void:u3,NEVER:$3,ZodIssueCode:ne,quotelessJson:Bx,ZodError:Wr});const pt=N.object({message:N.string()});function fe(t){return N.literal(ge[t])}const dh=N.object({serializedMessage:N.string().optional(),accountAddress:N.string(),chainId:N.string(),notBefore:N.string().optional(),domain:N.string(),uri:N.string(),version:N.string(),nonce:N.string(),statement:N.string().optional(),resources:N.array(N.string()).optional(),requestId:N.string().optional(),issuedAt:N.string().optional(),expirationTime:N.string().optional()});N.object({accessList:N.array(N.string()),blockHash:N.string().nullable(),blockNumber:N.string().nullable(),chainId:N.string().or(N.number()),from:N.string(),gas:N.string(),hash:N.string(),input:N.string().nullable(),maxFeePerGas:N.string(),maxPriorityFeePerGas:N.string(),nonce:N.string(),r:N.string(),s:N.string(),to:N.string(),transactionIndex:N.string().nullable(),type:N.string(),v:N.string(),value:N.string()});const D3=N.object({chainId:N.string().or(N.number()),rpcUrl:N.optional(N.string())}),U3=N.object({email:N.string().email()}),B3=N.object({otp:N.string()}),M3=N.object({uri:N.string(),preferredAccountType:N.optional(N.string()),chainId:N.optional(N.string().or(N.number())),siwxMessage:N.optional(dh),rpcUrl:N.optional(N.string())}),L3=N.object({chainId:N.optional(N.string().or(N.number())),preferredAccountType:N.optional(N.string()),socialUri:N.optional(N.string()),siwxMessage:N.optional(dh),rpcUrl:N.optional(N.string())}),F3=N.object({provider:N.enum(["google","github","apple","facebook","x","discord"])}),j3=N.object({email:N.string().email()}),q3=N.object({otp:N.string()}),z3=N.object({otp:N.string()}),H3=N.object({themeMode:N.optional(N.enum(["light","dark"])),themeVariables:N.optional(N.record(N.string(),N.string().or(N.number()))),w3mThemeVariables:N.optional(N.record(N.string(),N.string()))}),W3=N.object({metadata:N.object({name:N.string(),description:N.string(),url:N.string(),icons:N.array(N.string())}).optional(),sdkVersion:N.string().optional(),sdkType:N.string().optional(),projectId:N.string()}),V3=N.object({type:N.string()}),K3=N.object({action:N.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),G3=N.object({url:N.string()}),Y3=N.object({userName:N.string()}),Z3=N.object({email:N.string().optional().nullable(),address:N.string(),chainId:N.string().or(N.number()),accounts:N.array(N.object({address:N.string(),type:N.enum([lt.ACCOUNT_TYPES.EOA,lt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:N.string().optional().nullable(),preferredAccountType:N.optional(N.string()),signature:N.string().optional(),message:N.string().optional(),siwxMessage:N.optional(dh)}),J3=N.object({action:N.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),X3=N.object({email:N.string().email().optional().nullable(),address:N.string(),chainId:N.string().or(N.number()),smartAccountDeployed:N.optional(N.boolean()),accounts:N.array(N.object({address:N.string(),type:N.enum([lt.ACCOUNT_TYPES.EOA,lt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:N.optional(N.string()),signature:N.string().optional(),message:N.string().optional(),siwxMessage:N.optional(dh)}),Q3=N.object({uri:N.string()}),eP=N.object({isConnected:N.boolean()}),tP=N.object({chainId:N.string().or(N.number())}),nP=N.object({chainId:N.string().or(N.number())}),rP=N.object({newEmail:N.string().email()}),sP=N.object({smartAccountEnabledNetworks:N.array(N.number())});N.object({address:N.string(),isDeployed:N.boolean()});const iP=N.object({version:N.string().optional()}),oP=N.object({type:N.string(),address:N.string()}),aP=N.any(),cP=N.object({method:N.literal("eth_accounts")}),uP=N.object({method:N.literal("eth_blockNumber")}),lP=N.object({method:N.literal("eth_call"),params:N.array(N.any())}),dP=N.object({method:N.literal("eth_chainId")}),fP=N.object({method:N.literal("eth_estimateGas"),params:N.array(N.any())}),hP=N.object({method:N.literal("eth_feeHistory"),params:N.array(N.any())}),pP=N.object({method:N.literal("eth_gasPrice")}),gP=N.object({method:N.literal("eth_getAccount"),params:N.array(N.any())}),mP=N.object({method:N.literal("eth_getBalance"),params:N.array(N.any())}),yP=N.object({method:N.literal("eth_getBlockByHash"),params:N.array(N.any())}),bP=N.object({method:N.literal("eth_getBlockByNumber"),params:N.array(N.any())}),wP=N.object({method:N.literal("eth_getBlockReceipts"),params:N.array(N.any())}),EP=N.object({method:N.literal("eth_getBlockTransactionCountByHash"),params:N.array(N.any())}),vP=N.object({method:N.literal("eth_getBlockTransactionCountByNumber"),params:N.array(N.any())}),CP=N.object({method:N.literal("eth_getCode"),params:N.array(N.any())}),_P=N.object({method:N.literal("eth_getFilterChanges"),params:N.array(N.any())}),AP=N.object({method:N.literal("eth_getFilterLogs"),params:N.array(N.any())}),SP=N.object({method:N.literal("eth_getLogs"),params:N.array(N.any())}),IP=N.object({method:N.literal("eth_getProof"),params:N.array(N.any())}),TP=N.object({method:N.literal("eth_getStorageAt"),params:N.array(N.any())}),NP=N.object({method:N.literal("eth_getTransactionByBlockHashAndIndex"),params:N.array(N.any())}),xP=N.object({method:N.literal("eth_getTransactionByBlockNumberAndIndex"),params:N.array(N.any())}),PP=N.object({method:N.literal("eth_getTransactionByHash"),params:N.array(N.any())}),OP=N.object({method:N.literal("eth_getTransactionCount"),params:N.array(N.any())}),RP=N.object({method:N.literal("eth_getTransactionReceipt"),params:N.array(N.any())}),kP=N.object({method:N.literal("eth_getUncleCountByBlockHash"),params:N.array(N.any())}),$P=N.object({method:N.literal("eth_getUncleCountByBlockNumber"),params:N.array(N.any())}),DP=N.object({method:N.literal("eth_maxPriorityFeePerGas")}),UP=N.object({method:N.literal("eth_newBlockFilter")}),BP=N.object({method:N.literal("eth_newFilter"),params:N.array(N.any())}),MP=N.object({method:N.literal("eth_newPendingTransactionFilter")}),LP=N.object({method:N.literal("eth_sendRawTransaction"),params:N.array(N.any())}),FP=N.object({method:N.literal("eth_syncing"),params:N.array(N.any())}),jP=N.object({method:N.literal("eth_uninstallFilter"),params:N.array(N.any())}),Gw=N.object({method:N.literal("personal_sign"),params:N.array(N.any())}),qP=N.object({method:N.literal("eth_signTypedData_v4"),params:N.array(N.any())}),zP=N.object({method:N.literal("eth_sendTransaction"),params:N.array(N.any())}),HP=N.object({method:N.literal("solana_signMessage"),params:N.object({message:N.string(),pubkey:N.string()})}),WP=N.object({method:N.literal("solana_signTransaction"),params:N.object({transaction:N.string()})}),VP=N.object({method:N.literal("solana_signAllTransactions"),params:N.object({transactions:N.array(N.string())})}),KP=N.object({method:N.literal("solana_signAndSendTransaction"),params:N.object({transaction:N.string(),options:N.object({skipPreflight:N.boolean().optional(),preflightCommitment:N.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:N.number().optional(),minContextSlot:N.number().optional()}).optional()})}),GP=N.object({method:N.literal("wallet_sendCalls"),params:N.array(N.object({chainId:N.string().or(N.number()).optional(),from:N.string().optional(),version:N.string().optional(),capabilities:N.any().optional(),calls:N.array(N.object({to:N.string().startsWith("0x"),data:N.string().startsWith("0x").optional(),value:N.string().optional()}))}))}),YP=N.object({method:N.literal("wallet_getCallsStatus"),params:N.array(N.string())}),ZP=N.object({method:N.literal("wallet_getCapabilities"),params:N.array(N.string().or(N.number()).optional()).optional()}),JP=N.object({method:N.literal("wallet_grantPermissions"),params:N.array(N.any())}),XP=N.object({method:N.literal("wallet_revokePermissions"),params:N.any()}),QP=N.object({method:N.literal("wallet_getAssets"),params:N.any()}),Yw=N.object({token:N.string()}),he=N.object({id:N.string().optional()}),Np={appEvent:he.extend({type:fe("APP_SWITCH_NETWORK"),payload:D3}).or(he.extend({type:fe("APP_CONNECT_EMAIL"),payload:U3})).or(he.extend({type:fe("APP_CONNECT_DEVICE")})).or(he.extend({type:fe("APP_CONNECT_OTP"),payload:B3})).or(he.extend({type:fe("APP_CONNECT_SOCIAL"),payload:M3})).or(he.extend({type:fe("APP_GET_FARCASTER_URI")})).or(he.extend({type:fe("APP_CONNECT_FARCASTER")})).or(he.extend({type:fe("APP_GET_USER"),payload:N.optional(L3)})).or(he.extend({type:fe("APP_GET_SOCIAL_REDIRECT_URI"),payload:F3})).or(he.extend({type:fe("APP_SIGN_OUT")})).or(he.extend({type:fe("APP_IS_CONNECTED"),payload:N.optional(Yw)})).or(he.extend({type:fe("APP_GET_CHAIN_ID")})).or(he.extend({type:fe("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(he.extend({type:fe("APP_INIT_SMART_ACCOUNT")})).or(he.extend({type:fe("APP_SET_PREFERRED_ACCOUNT"),payload:V3})).or(he.extend({type:fe("APP_RPC_REQUEST"),payload:Gw.or(QP).or(cP).or(uP).or(lP).or(dP).or(fP).or(hP).or(pP).or(gP).or(mP).or(yP).or(bP).or(wP).or(EP).or(vP).or(CP).or(_P).or(AP).or(SP).or(IP).or(TP).or(NP).or(xP).or(PP).or(OP).or(RP).or(kP).or($P).or(DP).or(UP).or(BP).or(MP).or(LP).or(FP).or(jP).or(Gw).or(qP).or(zP).or(HP).or(WP).or(VP).or(KP).or(YP).or(GP).or(ZP).or(JP).or(XP).and(N.object({chainId:N.string().or(N.number()).optional(),chainNamespace:N.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:N.string().optional()}))})).or(he.extend({type:fe("APP_UPDATE_EMAIL"),payload:j3})).or(he.extend({type:fe("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:q3})).or(he.extend({type:fe("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:z3})).or(he.extend({type:fe("APP_SYNC_THEME"),payload:H3})).or(he.extend({type:fe("APP_SYNC_DAPP_DATA"),payload:W3})).or(he.extend({type:fe("APP_RELOAD")})).or(he.extend({type:fe("APP_RPC_ABORT")})),frameEvent:he.extend({type:fe("FRAME_SWITCH_NETWORK_ERROR"),payload:pt}).or(he.extend({type:fe("FRAME_SWITCH_NETWORK_SUCCESS"),payload:nP})).or(he.extend({type:fe("FRAME_CONNECT_EMAIL_SUCCESS"),payload:K3})).or(he.extend({type:fe("FRAME_CONNECT_EMAIL_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:G3})).or(he.extend({type:fe("FRAME_GET_FARCASTER_URI_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:Y3})).or(he.extend({type:fe("FRAME_CONNECT_FARCASTER_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_CONNECT_OTP_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_CONNECT_OTP_SUCCESS")})).or(he.extend({type:fe("FRAME_CONNECT_DEVICE_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_CONNECT_DEVICE_SUCCESS")})).or(he.extend({type:fe("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:Z3})).or(he.extend({type:fe("FRAME_CONNECT_SOCIAL_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_GET_USER_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_GET_USER_SUCCESS"),payload:X3})).or(he.extend({type:fe("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:Q3})).or(he.extend({type:fe("FRAME_SIGN_OUT_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_SIGN_OUT_SUCCESS")})).or(he.extend({type:fe("FRAME_IS_CONNECTED_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_IS_CONNECTED_SUCCESS"),payload:eP})).or(he.extend({type:fe("FRAME_GET_CHAIN_ID_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_GET_CHAIN_ID_SUCCESS"),payload:tP})).or(he.extend({type:fe("FRAME_RPC_REQUEST_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_RPC_REQUEST_SUCCESS"),payload:aP})).or(he.extend({type:fe("FRAME_SESSION_UPDATE"),payload:Yw})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_SUCCESS"),payload:J3})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:rP})).or(he.extend({type:fe("FRAME_SYNC_THEME_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_SYNC_THEME_SUCCESS")})).or(he.extend({type:fe("FRAME_SYNC_DAPP_DATA_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(he.extend({type:fe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:sP})).or(he.extend({type:fe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:oP})).or(he.extend({type:fe("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_READY"),payload:iP})).or(he.extend({type:fe("FRAME_RELOAD_ERROR"),payload:pt})).or(he.extend({type:fe("FRAME_RELOAD_SUCCESS")}))};function xp(t,e={}){return typeof e?.type=="string"&&e?.type?.includes(t)}function eO({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=z.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL($x);i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",Ux),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r);const o=Rt.get("dapp_smart_account_version");return o&&(o==="v6"||o==="v7")&&(console.warn(">> AppKit - Forcing smart account version",o),i.searchParams.set("smartAccountVersion",o)),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class tO{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=z.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,u)=>{function l({data:d}){if(!xp(ge.FRAME_EVENT_KEY,d))return;const f=Np.frameEvent.safeParse(d);if(!f.success){console.warn("W3mFrame: invalid frame event",f.error.message);return}f.data?.id===a&&(c(f.data),window.removeEventListener("message",l))}rr.isClient&&(window.addEventListener("message",l),u.addEventListener("abort",()=>{window.removeEventListener("message",l)}))},onFrameEvent:a=>{rr.isClient&&window.addEventListener("message",({data:c})=>{if(!xp(ge.FRAME_EVENT_KEY,c))return;const u=Np.frameEvent.safeParse(c);u.success?a(u.data):console.warn("W3mFrame: invalid frame event",u.error.message)})},onAppEvent:a=>{rr.isClient&&window.addEventListener("message",({data:c})=>{if(!xp(ge.APP_EVENT_KEY,c))return;const u=Np.appEvent.safeParse(c);u.success||console.warn("W3mFrame: invalid app event",u.error.message),a(c)})},postAppEvent:a=>{if(rr.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(rr.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),rr.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=eO({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}var Yc={exports:{}},Pp,Zw;function nO(){if(Zw)return Pp;Zw=1;function t(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}Pp=e;function e(n,r,s){var i=s&&s.stringify||t,o=1;if(typeof n=="object"&&n!==null){var a=r.length+o;if(a===1)return n;var c=new Array(a);c[0]=i(n);for(var u=1;u<a;u++)c[u]=i(r[u]);return c.join(" ")}if(typeof n!="string")return n;var l=r.length;if(l===0)return n;for(var d="",f=1-o,h=-1,g=n&&n.length||0,p=0;p<g;){if(n.charCodeAt(p)===37&&p+1<g){switch(h=h>-1?h:0,n.charCodeAt(p+1)){case 100:case 102:if(f>=l||r[f]==null)break;h<p&&(d+=n.slice(h,p)),d+=Number(r[f]),h=p+2,p++;break;case 105:if(f>=l||r[f]==null)break;h<p&&(d+=n.slice(h,p)),d+=Math.floor(Number(r[f])),h=p+2,p++;break;case 79:case 111:case 106:if(f>=l||r[f]===void 0)break;h<p&&(d+=n.slice(h,p));var y=typeof r[f];if(y==="string"){d+="'"+r[f]+"'",h=p+2,p++;break}if(y==="function"){d+=r[f].name||"<anonymous>",h=p+2,p++;break}d+=i(r[f]),h=p+2,p++;break;case 115:if(f>=l)break;h<p&&(d+=n.slice(h,p)),d+=String(r[f]),h=p+2,p++;break;case 37:h<p&&(d+=n.slice(h,p)),d+="%",h=p+2,p++,f--;break}++f}++p}return h===-1?n:(h<g&&(d+=n.slice(h)),d)}return Pp}var Jw;function rO(){if(Jw)return Yc.exports;Jw=1;const t=nO();Yc.exports=l;const e=O().console||{},n={mapHttpRequest:k,mapHttpResponse:k,wrapRequestSerializer:U,wrapResponseSerializer:U,wrapErrorSerializer:U,req:k,res:k,err:_,errWithCause:_};function r(m,b){return m==="silent"?1/0:b.levels.values[m]}const s=Symbol("pino.logFuncs"),i=Symbol("pino.hierarchy"),o={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function a(m,b){const v={logger:b,parent:m[i]};b[i]=v}function c(m,b,v){const S={};b.forEach(I=>{S[I]=v[I]?v[I]:e[I]||e[o[I]||"log"]||$}),m[s]=S}function u(m,b){return Array.isArray(m)?m.filter(function(S){return S!=="!stdSerializers.err"}):m===!0?Object.keys(b):!1}function l(m){m=m||{},m.browser=m.browser||{};const b=m.browser.transmit;if(b&&typeof b.send!="function")throw Error("pino: transmit option must have a send function");const v=m.browser.write||e;m.browser.write&&(m.browser.asObject=!0);const S=m.serializers||{},I=u(m.browser.serialize,S);let x=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(x=!1);const B=Object.keys(m.customLevels||{}),F=["error","fatal","warn","info","debug","trace"].concat(B);typeof v=="function"&&F.forEach(function(te){v[te]=v}),(m.enabled===!1||m.browser.disabled)&&(m.level="silent");const W=m.level||"info",j=Object.create(v);j.log||(j.log=$),c(j,F,v),a({},j),Object.defineProperty(j,"levelVal",{get:Y}),Object.defineProperty(j,"level",{get:Q,set:ue});const q={transmit:b,serialize:I,asObject:m.browser.asObject,asObjectBindingsOnly:m.browser.asObjectBindingsOnly,formatters:m.browser.formatters,levels:F,timestamp:P(m),messageKey:m.messageKey||"msg",onChild:m.onChild||$};j.levels=d(m),j.level=W,j.isLevelEnabled=function(te){return this.levels.values[te]?this.levels.values[te]>=this.levels.values[this.level]:!1},j.setMaxListeners=j.getMaxListeners=j.emit=j.addListener=j.on=j.prependListener=j.once=j.prependOnceListener=j.removeListener=j.removeAllListeners=j.listeners=j.listenerCount=j.eventNames=j.write=j.flush=$,j.serializers=S,j._serialize=I,j._stdErrSerialize=x,j.child=function(...te){return J.call(this,q,...te)},b&&(j._logEvent=C());function Y(){return r(this.level,this)}function Q(){return this._level}function ue(te){if(te!=="silent"&&!this.levels.values[te])throw Error("unknown level "+te);this._level=te,g(this,q,j,"error"),g(this,q,j,"fatal"),g(this,q,j,"warn"),g(this,q,j,"info"),g(this,q,j,"debug"),g(this,q,j,"trace"),B.forEach(Ae=>{g(this,q,j,Ae)})}function J(te,Ae,Oe){if(!Ae)throw new Error("missing bindings for child Pino");Oe=Oe||{},I&&Ae.serializers&&(Oe.serializers=Ae.serializers);const Be=Oe.serializers;if(I&&Be){var rt=Object.assign({},S,Be),St=m.browser.serialize===!0?Object.keys(rt):I;delete Ae.serializers,A([Ae],St,rt,this._stdErrSerialize)}function ns(va){this._childLevel=(va._childLevel|0)+1,this.bindings=Ae,rt&&(this.serializers=rt,this._serialize=St),b&&(this._logEvent=C([].concat(va._logEvent.bindings,Ae)))}ns.prototype=this;const po=new ns(this);return a(this,po),po.child=function(...va){return J.call(this,te,...va)},po.level=Oe.level||this.level,te.onChild(po),po}return j}function d(m){const b=m.customLevels||{},v=Object.assign({},l.levels.values,b),S=Object.assign({},l.levels.labels,f(b));return{values:v,labels:S}}function f(m){const b={};return Object.keys(m).forEach(function(v){b[m[v]]=v}),b}l.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},l.stdSerializers=n,l.stdTimeFunctions=Object.assign({},{nullTime:L,epochTime:M,unixTime:D,isoTime:T});function h(m){const b=[];m.bindings&&b.push(m.bindings);let v=m[i];for(;v.parent;)v=v.parent,v.logger.bindings&&b.push(v.logger.bindings);return b.reverse()}function g(m,b,v,S){if(Object.defineProperty(m,S,{value:r(m.level,v)>r(S,v)?$:v[s][S],writable:!0,enumerable:!0,configurable:!0}),m[S]===$){if(!b.transmit)return;const x=b.transmit.level||m.level,B=r(x,v);if(r(S,v)<B)return}m[S]=y(m,b,v,S);const I=h(m);I.length!==0&&(m[S]=p(I,m[S]))}function p(m,b){return function(){return b.apply(this,[...m,...arguments])}}function y(m,b,v,S){return(function(I){return function(){const B=b.timestamp(),F=new Array(arguments.length),W=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var j=0;j<F.length;j++)F[j]=arguments[j];var q=!1;if(b.serialize&&(A(F,this._serialize,this.serializers,this._stdErrSerialize),q=!0),b.asObject||b.formatters?I.call(W,...E(this,S,F,B,b)):I.apply(W,F),b.transmit){const Y=b.transmit.level||m._level,Q=r(Y,v),ue=r(S,v);if(ue<Q)return;w(this,{ts:B,methodLevel:S,methodValue:ue,transmitValue:v.levels.values[b.transmit.level||m._level],send:b.transmit.send,val:r(m._level,v)},F,q)}}})(m[s][S])}function E(m,b,v,S,I){const{level:x,log:B=Y=>Y}=I.formatters||{},F=v.slice();let W=F[0];const j={};let q=(m._childLevel|0)+1;if(q<1&&(q=1),S&&(j.time=S),x){const Y=x(b,m.levels.values[b]);Object.assign(j,Y)}else j.level=m.levels.values[b];if(I.asObjectBindingsOnly){if(W!==null&&typeof W=="object")for(;q--&&typeof F[0]=="object";)Object.assign(j,F.shift());return[B(j),...F]}else{if(W!==null&&typeof W=="object"){for(;q--&&typeof F[0]=="object";)Object.assign(j,F.shift());W=F.length?t(F.shift(),F):void 0}else typeof W=="string"&&(W=t(F.shift(),F));return W!==void 0&&(j[I.messageKey]=W),[B(j)]}}function A(m,b,v,S){for(const I in m)if(S&&m[I]instanceof Error)m[I]=l.stdSerializers.err(m[I]);else if(typeof m[I]=="object"&&!Array.isArray(m[I])&&b)for(const x in m[I])b.indexOf(x)>-1&&x in v&&(m[I][x]=v[x](m[I][x]))}function w(m,b,v,S=!1){const I=b.send,x=b.ts,B=b.methodLevel,F=b.methodValue,W=b.val,j=m._logEvent.bindings;S||A(v,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=x,m._logEvent.messages=v.filter(function(q){return j.indexOf(q)===-1}),m._logEvent.level.label=B,m._logEvent.level.value=F,I(B,m._logEvent,W),m._logEvent=C(j)}function C(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function _(m){const b={type:m.constructor.name,msg:m.message,stack:m.stack};for(const v in m)b[v]===void 0&&(b[v]=m[v]);return b}function P(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?L:M}function k(){return{}}function U(m){return m}function $(){}function L(){return!1}function M(){return Date.now()}function D(){return Math.round(Date.now()/1e3)}function T(){return new Date(Date.now()).toISOString()}function O(){function m(b){return typeof b<"u"&&b}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return Yc.exports.default=l,Yc.exports.pino=l,Yc.exports}var Da=rO();const J_=aa(Da),sO=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),iO=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Yo(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return iO(t)}catch{return t}}function fi(t){return typeof t=="string"?t:sO(t)||""}const oO={level:"info"},fh="custom_context",_y=1e3*1024;var aO=Object.defineProperty,cO=(t,e,n)=>e in t?aO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Li=(t,e,n)=>cO(t,typeof e!="symbol"?e+"":e,n);let uO=class{constructor(e){Li(this,"nodeValue"),Li(this,"sizeInBytes"),Li(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Xw=class{constructor(e){Li(this,"lengthInNodes"),Li(this,"sizeInBytes"),Li(this,"head"),Li(this,"tail"),Li(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new uO(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}};var lO=Object.defineProperty,dO=(t,e,n)=>e in t?lO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,td=(t,e,n)=>dO(t,typeof e!="symbol"?e+"":e,n);let X_=class{constructor(e,n=_y){td(this,"logs"),td(this,"level"),td(this,"levelValue"),td(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Da.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new Xw(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Da.levels.values.error?console.error(e):n===Da.levels.values.warn?console.warn(e):n===Da.levels.values.debug?console.debug(e):n===Da.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(fi({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new Xw(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(fi({extraMetadata:e})),new Blob(n,{type:"application/json"})}};var fO=Object.defineProperty,hO=(t,e,n)=>e in t?fO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pO=(t,e,n)=>hO(t,e+"",n);let gO=class{constructor(e,n=_y){pO(this,"baseChunkLogger"),this.baseChunkLogger=new X_(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}};var mO=Object.defineProperty,yO=(t,e,n)=>e in t?mO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bO=(t,e,n)=>yO(t,e+"",n);let wO=class{constructor(e,n=_y){bO(this,"baseChunkLogger"),this.baseChunkLogger=new X_(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var EO=Object.defineProperty,vO=Object.defineProperties,CO=Object.getOwnPropertyDescriptors,Qw=Object.getOwnPropertySymbols,_O=Object.prototype.hasOwnProperty,AO=Object.prototype.propertyIsEnumerable,e1=(t,e,n)=>e in t?EO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mf=(t,e)=>{for(var n in e||(e={}))_O.call(e,n)&&e1(t,n,e[n]);if(Qw)for(var n of Qw(e))AO.call(e,n)&&e1(t,n,e[n]);return t},yf=(t,e)=>vO(t,CO(e));function Ay(t){return yf(mf({},t),{level:t?.level||oO.level})}function SO(t,e,n=fh){return t[n]=e,t}function Hn(t,e=fh){return t[e]||""}function IO(t,e,n=fh){const r=Hn(t,n);return r.trim()?`${r}/${e}`:e}function Wn(t,e,n=fh){const r=IO(t,e,n),s=t.child({context:r});return SO(s,r,n)}function TO(t){var e,n;const r=new gO((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:J_(yf(mf({},t.opts),{level:"trace",browser:yf(mf({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function NO(t){var e;const n=new wO((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:J_(yf(mf({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function hh(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?TO(t):NO(t)}class xO{constructor(e){const n=Ay({level:Dx}),{logger:r,chunkLoggerController:s}=hh({opts:n});this.logger=Wn(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class PO{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c,metadata:u,sdkVersion:l,sdkType:d}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new xO(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const f=this.getRpcUrl(n);this.projectId=e,this.sdkVersion=l,this.sdkType=d,this.metadata=u,this.w3mFrame=new tO({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:f,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,await this.syncDappData({metadata:this.metadata,projectId:this.projectId,sdkVersion:this.sdkVersion,sdkType:this.sdkType}),await this.getSmartAccountEnabledNetworks(),this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Rt.get(ge.EMAIL_LOGIN_USED_KEY)}getEmail(){return Rt.get(ge.EMAIL)}getUsername(){return Rt.get(ge.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:ge.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{rr.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:ge.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){try{return this.appEvent({type:ge.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:ge.APP_CONNECT_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:ge.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:ge.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:ge.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){try{const n=await this.appEvent({type:ge.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:ge.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){try{const n=await this.appEvent({type:ge.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){try{return this.appEvent({type:ge.APP_SYNC_THEME,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){try{return this.appEvent({type:ge.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:ge.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:ge.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){if(e?.socialUri)try{await this.init();const n=this.getRpcUrl(e.chainId),r=await this.appEvent({type:ge.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:n}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting social"),n}else try{const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:n,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(n)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async getUser(e){try{await this.init();const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:ge.APP_GET_USER,payload:{...e,chainId:n,rpcUrl:this.getRpcUrl(n)}});return this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){try{await this.init();const s=this.getRpcUrl(n),i=await this.appEvent({type:ge.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:s,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(s){throw this.w3mLogger?.logger.error({error:s},"Error connecting social"),s}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:ge.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:ge.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const n=this.getRpcUrl(e),r=await this.appEvent({type:ge.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:n}});return this.setLastUsedChainId(r.chainId),r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error switching network"),n}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const r=setTimeout(()=>{n()},3e3);await this.appEvent({type:ge.APP_SIGN_OUT}),clearTimeout(r),n()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const n=e;try{if(lt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",s=this.getActiveCaipNetwork(r)?.id;n.chainNamespace=r,n.chainId=s,n.rpcUrl=this.getRpcUrl(s),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:ge.APP_RPC_REQUEST,payload:n});return this.rpcSuccessHandler?.(i,n),i}catch(r){throw this.rpcErrorHandler?.(r,n),this.w3mLogger?.logger.error({error:r},"Error requesting"),r}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_IS_CONNECTED_ERROR&&e(),n.type===ge.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ge.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===ge.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:lt.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:e,method:n})=>{lt.SAFE_RPC_METHODS.includes(n)||e.abort(),await this.appEvent({type:ge.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[ge.APP_SYNC_DAPP_DATA,ge.APP_SYNC_THEME,ge.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[ge.APP_CONNECT_EMAIL,ge.APP_CONNECT_DEVICE,ge.APP_CONNECT_OTP,ge.APP_CONNECT_SOCIAL,ge.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,u)=>{const l=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:l},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:l});const d=new AbortController;if(o==="RPC_REQUEST"){const h=e;this.openRpcRequests.set(l,{...h.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?u(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&u(new Error("Something went wrong"))});const f=(h,g)=>{h.id===l&&(g?.logger.info?.({framEvent:h,id:l},"Received frame response"),this.openRpcRequests.delete(h.id),h.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in h&&c(h.payload),c(void 0)):h.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in h&&u(new Error(h.payload?.message||"An error occurred")),u(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(l,h=>f(h,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Rt.set(ge.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Rt.set(ge.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Rt.set(ge.EMAIL,e),Rt.set(ge.EMAIL_LOGIN_USED_KEY,"true"),Rt.delete(ge.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Rt.delete(ge.EMAIL_LOGIN_USED_KEY),Rt.delete(ge.EMAIL),Rt.delete(ge.LAST_USED_CHAIN_KEY),Rt.delete(ge.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Rt.set(ge.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Rt.get(ge.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Rt.set(ge.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=Dt.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n);return(e?r.find(i=>String(i.id)===String(e)||i.caipNetworkId===e):r[0])?.rpcUrls.default.http?.[0]}}const OO="1.1.0";let Vn=class Tg extends Error{constructor(e,n={}){const r=n.cause instanceof Tg?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof Tg&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${OO}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function bi(t,e){return t.exec(e)?.groups}const Q_=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,eA=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,tA=/^\(.+?\).*?$/,t1=/^tuple(?<array>(\[(\d*)\])*)$/;function Ng(t){let e=t.type;if(t1.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=Ng(i),s<n-1&&(e+=", ")}const r=bi(t1,t.type);return e+=`)${r?.array??""}`,Ng({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function Ua(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=Ng(s),r!==n-1&&(e+=", ")}return e}function bf(t){return t.type==="function"?`function ${t.name}(${Ua(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${t.outputs?.length?` returns (${Ua(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${Ua(t.inputs)})`:t.type==="error"?`error ${t.name}(${Ua(t.inputs)})`:t.type==="constructor"?`constructor(${Ua(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const nA=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function RO(t){return nA.test(t)}function kO(t){return bi(nA,t)}const rA=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function $O(t){return rA.test(t)}function DO(t){return bi(rA,t)}const sA=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function UO(t){return sA.test(t)}function BO(t){return bi(sA,t)}const iA=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function ph(t){return iA.test(t)}function MO(t){return bi(iA,t)}const oA=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function LO(t){return oA.test(t)}function FO(t){return bi(oA,t)}const aA=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function jO(t){return aA.test(t)}function qO(t){return bi(aA,t)}const zO=/^receive\(\) external payable$/;function HO(t){return zO.test(t)}const n1=new Set(["memory","indexed","storage","calldata"]),WO=new Set(["indexed"]),xg=new Set(["calldata","memory","storage"]);class cA extends Vn{constructor({signature:e}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class uA extends Vn{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class VO extends Vn{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class lA extends Vn{constructor({params:e}){super("Failed to parse ABI parameters.",{details:`parseAbiParameters(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameters-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParametersError"})}}class dA extends Vn{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class fA extends Vn{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class hA extends Vn{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class pA extends Vn{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class gA extends Vn{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class da extends Vn{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class mA extends Vn{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class yA extends Vn{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class bA extends Vn{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class wA extends Vn{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function KO(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:t}const Op=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function Pg(t,e={}){if(UO(t))return GO(t,e);if($O(t))return YO(t,e);if(RO(t))return ZO(t,e);if(LO(t))return JO(t,e);if(jO(t))return XO(t);if(HO(t))return{type:"receive",stateMutability:"payable"};throw new mA({signature:t})}function GO(t,e={}){const n=BO(t);if(!n)throw new da({signature:t,type:"function"});const r=sr(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(hi(r[a],{modifiers:xg,structs:e,type:"function"}));const o=[];if(n.returns){const a=sr(n.returns),c=a.length;for(let u=0;u<c;u++)o.push(hi(a[u],{modifiers:xg,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function YO(t,e={}){const n=DO(t);if(!n)throw new da({signature:t,type:"event"});const r=sr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(hi(r[o],{modifiers:WO,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function ZO(t,e={}){const n=kO(t);if(!n)throw new da({signature:t,type:"error"});const r=sr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(hi(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function JO(t,e={}){const n=FO(t);if(!n)throw new da({signature:t,type:"constructor"});const r=sr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(hi(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function XO(t){const e=qO(t);if(!e)throw new da({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const QO=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*(?:\spayable)?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,e8=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,t8=/^u?int$/;function hi(t,e){const n=KO(t,e?.type,e?.structs);if(Op.has(n))return Op.get(n);const r=tA.test(t),s=bi(r?e8:QO,t);if(!s)throw new dA({param:t});if(s.name&&r8(s.name))throw new fA({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,u={};if(r){c="tuple";const d=sr(s.type),f=[],h=d.length;for(let g=0;g<h;g++)f.push(hi(d[g],{structs:a}));u={components:f}}else if(s.type in a)c="tuple",u={components:a[s.type]};else if(t8.test(s.type))c=`${s.type}256`;else if(s.type==="address payable")c="address";else if(c=s.type,e?.type!=="struct"&&!EA(c))throw new VO({type:c});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new hA({param:t,type:e?.type,modifier:s.modifier});if(xg.has(s.modifier)&&!s8(c,!!s.array))throw new pA({param:t,type:e?.type,modifier:s.modifier})}const l={type:`${c}${s.array??""}`,...i,...o,...u};return Op.set(n,l),l}function sr(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?sr(a,[...e,n.trim()]):sr(a,e,`${n}${o}`,r);case"(":return sr(a,e,`${n}${o}`,r+1);case")":return sr(a,e,`${n}${o}`,r-1);default:return sr(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new wA({current:n,depth:r});return e.push(n.trim()),e}function EA(t){return t==="address"||t==="bool"||t==="function"||t==="string"||Q_.test(t)||eA.test(t)}const n8=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function r8(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||Q_.test(t)||eA.test(t)||n8.test(t)}function s8(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function Sy(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!ph(a))continue;const c=MO(a);if(!c)throw new da({signature:a,type:"struct"});const u=c.properties.split(";"),l=[],d=u.length;for(let f=0;f<d;f++){const g=u[f].trim();if(!g)continue;const p=hi(g,{type:"struct"});l.push(p)}if(!l.length)throw new yA({signature:a});e[c.name]=l}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=vA(c,e)}return r}const i8=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function vA(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(tA.test(o.type))r.push(o);else{const c=bi(i8,o.type);if(!c?.type)throw new gA({abiParameter:o});const{array:u,type:l}=c;if(l in e){if(n.has(l))throw new bA({type:l});r.push({...o,type:`tuple${u??""}`,components:vA(e[l]??[],e,new Set([...n,l]))})}else if(EA(l))r.push(o);else throw new uA({type:l})}}return r}function Iy(t){const e=Sy(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];ph(i)||n.push(Pg(i,e))}return n}function Og(t){let e;if(typeof t=="string")e=Pg(t);else{const n=Sy(t),r=t.length;for(let s=0;s<r;s++){const i=t[s];if(!ph(i)){e=Pg(i,n);break}}}if(!e)throw new cA({signature:t});return e}function Rg(t){const e=[];if(typeof t=="string"){const n=sr(t),r=n.length;for(let s=0;s<r;s++)e.push(hi(n[s],{modifiers:n1}))}else{const n=Sy(t),r=t.length;for(let s=0;s<r;s++){const i=t[s];if(ph(i))continue;const o=sr(i),a=o.length;for(let c=0;c<a;c++)e.push(hi(o[c],{modifiers:n1,structs:n}))}}if(e.length===0)throw new lA({params:t});return e}function ve(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Yr(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new RA(t.type);return`${t.name}(${gh(t.inputs,{includeName:e})})`}function gh(t,{includeName:e=!1}={}){return t?t.map(n=>o8(n,{includeName:e})).join(e?", ":","):""}function o8(t,{includeName:e}){return t.type.startsWith("tuple")?`(${gh(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function Ar(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function dt(t){return Ar(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const CA="2.39.0";let Rp={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${CA}`},K=class kg extends Error{constructor(e,n={}){const r=n.cause instanceof kg?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof kg&&n.cause.docsPath||n.docsPath,i=Rp.getDocsUrl?.({...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Rp.version?[`Version: ${Rp.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=CA}walk(e){return _A(this,e)}};function _A(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?_A(t.cause,e):e?null:t}class AA extends K{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class $g extends K{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class Ty extends K{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${gh(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class Bc extends K{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class SA extends K{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class IA extends K{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${dt(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class Ny extends K{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class TA extends K{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class Dg extends K{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class xy extends K{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class NA extends K{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class Py extends K{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class Ug extends K{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class Zo extends K{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class Oy extends K{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class xA extends K{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class a8 extends K{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Yr(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Yr(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}let Ry=class extends K{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}};class dc extends K{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${gh(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class Cl extends K{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Yr(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class PA extends K{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class OA extends K{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}let ky=class extends K{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}};class RA extends K{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class kA extends K{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}class $A extends K{constructor(e){super(`Filter type "${e}" is not supported.`,{name:"FilterTypeNotSupportedError"})}}let $y=class extends K{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}},Dy=class extends K{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class r1 extends K{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function ws(t,{dir:e,size:n=32}={}){return typeof t=="string"?si(t,{dir:e,size:n}):DA(t,{dir:e,size:n})}function si(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new Dy({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function DA(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new Dy({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let Uy=class extends K{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}},UA=class extends K{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}};class BA extends K{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let MA=class extends K{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function yn(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function Nr(t,{size:e}){if(dt(t)>e)throw new MA({givenSize:dt(t),maxSize:e})}function zt(t,e={}){const{signed:n}=e;e.size&&Nr(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function LA(t,e={}){let n=t;if(e.size&&(Nr(n,{size:e.size}),n=yn(n)),yn(n)==="0x00")return!1;if(yn(n)==="0x01")return!0;throw new BA(n)}function ar(t,e={}){return Number(zt(t,e))}function By(t,e={}){let n=cr(t);return e.size&&(Nr(n,{size:e.size}),n=yn(n,{dir:"right"})),new TextDecoder().decode(n)}const c8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Jt(t,e={}){return typeof t=="number"||typeof t=="bigint"?ee(t,e):typeof t=="string"?eo(t,e):typeof t=="boolean"?mh(t,e):Ct(t,e)}function mh(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Nr(n,{size:e.size}),ws(n,{size:e.size})):n}function Ct(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=c8[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Nr(r,{size:e.size}),ws(r,{dir:"right",size:e.size})):r}function ee(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new Uy({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?ws(a,{size:r}):a}const u8=new TextEncoder;function eo(t,e={}){const n=u8.encode(t);return Ct(n,e)}const l8=new TextEncoder;function fa(t,e={}){return typeof t=="number"||typeof t=="bigint"?jA(t,e):typeof t=="boolean"?FA(t,e):Ar(t)?cr(t,e):Ki(t,e)}function FA(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Nr(n,{size:e.size}),ws(n,{size:e.size})):n}const Os={zero:48,nine:57,A:65,F:70,a:97,f:102};function s1(t){if(t>=Os.zero&&t<=Os.nine)return t-Os.zero;if(t>=Os.A&&t<=Os.F)return t-(Os.A-10);if(t>=Os.a&&t<=Os.f)return t-(Os.a-10)}function cr(t,e={}){let n=t;e.size&&(Nr(n,{size:e.size}),n=ws(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=s1(r.charCodeAt(a++)),u=s1(r.charCodeAt(a++));if(c===void 0||u===void 0)throw new K(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+u}return i}function jA(t,e){const n=ee(t,e);return cr(n)}function Ki(t,e={}){const n=l8.encode(t);return typeof e.size=="number"?(Nr(n,{size:e.size}),ws(n,{dir:"right",size:e.size})):n}function Ht(t,e){const n=e||"hex",r=my(Ar(t,{strict:!1})?fa(t):t);return n==="bytes"?r:Jt(r)}const d8=t=>Ht(fa(t));function f8(t){return d8(t)}function h8(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new K("Unable to normalize signature.");return s}const Eu=t=>{const e=typeof t=="string"?t:bf(t);return h8(e)};function wf(t){return f8(Eu(t))}const fc=wf;let Xt=class extends K{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}},_l=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const kp=new _l(8192);function Mc(t,e){if(kp.has(`${t}.${e}`))return kp.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=Ht(Ki(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return kp.set(`${t}.${e}`,i),i}function ps(t,e){if(!_t(t,{strict:!1}))throw new Xt({address:t});return Mc(t,e)}const p8=/^0x[a-fA-F0-9]{40}$/,$p=new _l(8192);function _t(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if($p.has(r))return $p.get(r);const s=p8.test(t)?t.toLowerCase()===t?!0:n?Mc(t)===t:!0:!1;return $p.set(r,s),s}function Sr(t){return typeof t[0]=="string"?Sn(t):qA(t)}function qA(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Sn(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function to(t,e,n,{strict:r}={}){return Ar(t,{strict:!1})?Ef(t,e,n,{strict:r}):My(t,e,n,{strict:r})}function zA(t,e){if(typeof e=="number"&&e>0&&e>dt(t)-1)throw new $y({offset:e,position:"start",size:dt(t)})}function HA(t,e,n){if(typeof e=="number"&&typeof n=="number"&&dt(t)!==n-e)throw new $y({offset:n,position:"end",size:dt(t)})}function My(t,e,n,{strict:r}={}){zA(t,e);const s=t.slice(e,n);return r&&HA(s,e,n),s}function Ef(t,e,n,{strict:r}={}){zA(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&HA(s,e,n),s}const g8=/^(.*)\[([0-9]*)\]$/,WA=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Ly=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function xs(t,e){if(t.length!==e.length)throw new Ny({expectedLength:t.length,givenLength:e.length});const n=m8({params:t,values:e}),r=jy(n);return r.length===0?"0x":r}function m8({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(Fy({param:t[r],value:e[r]}));return n}function Fy({param:t,value:e}){const n=qy(t.type);if(n){const[r,s]=n;return b8(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return _8(e,{param:t});if(t.type==="address")return y8(e);if(t.type==="bool")return E8(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=Ly.exec(t.type)??[];return v8(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return w8(e,{param:t});if(t.type==="string")return C8(e);throw new PA(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function jy(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=dt(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(ee(e+s,{size:32})),r.push(a),s+=dt(a)):n.push(a)}return Sr([...n,...r])}function y8(t){if(!_t(t))throw new Xt({address:t});return{dynamic:!1,encoded:si(t.toLowerCase())}}function b8(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new ky(t);if(!r&&t.length!==e)throw new SA({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=Fy({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=jy(i);if(r){const a=ee(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?Sr([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:Sr(i.map(({encoded:o})=>o))}}function w8(t,{param:e}){const[,n]=e.type.split("bytes"),r=dt(t);if(!n){let s=t;return r%32!==0&&(s=si(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:Sr([si(ee(r,{size:32})),s])}}if(r!==Number.parseInt(n,10))throw new IA({expectedSize:Number.parseInt(n,10),value:t});return{dynamic:!1,encoded:si(t,{dir:"right"})}}function E8(t){if(typeof t!="boolean")throw new K(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:si(mh(t))}}function v8(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new Uy({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:ee(t,{size:32,signed:e})}}function C8(t){const e=eo(t),n=Math.ceil(dt(e)/32),r=[];for(let s=0;s<n;s++)r.push(si(to(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:Sr([si(ee(dt(e),{size:32})),...r])}}function _8(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=Fy({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?jy(r):Sr(r.map(({encoded:s})=>s))}}function qy(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const Jo=t=>to(wf(t),0,4);function co(t){const{abi:e,args:n=[],name:r}=t,s=Ar(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?Jo(a)===r:a.type==="event"?fc(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((u,l)=>{const d="inputs"in a&&a.inputs[l];return d?Bg(u,d):!1})){if(o&&"inputs"in o&&o.inputs){const u=VA(a.inputs,o.inputs,n);if(u)throw new a8({abiItem:a,type:u[0]},{abiItem:o,type:u[1]})}o=a}}return o||i[0]}function Bg(t,e){const n=typeof t,r=e.type;switch(r){case"address":return _t(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>Bg(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>Bg(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function VA(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return VA(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?_t(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?_t(n[r],{strict:!1}):!1)return o}}const i1="/docs/contract/encodeEventTopics";function Lc(t){const{abi:e,eventName:n,args:r}=t;let s=e[0];if(n){const c=co({abi:e,name:n});if(!c)throw new Ug(n,{docsPath:i1});s=c}if(s.type!=="event")throw new Ug(void 0,{docsPath:i1});const i=Yr(s),o=fc(i);let a=[];if(r&&"inputs"in s){const c=s.inputs?.filter(l=>"indexed"in l&&l.indexed),u=Array.isArray(r)?r:Object.values(r).length>0?c?.map(l=>r[l.name])??[]:[];u.length>0&&(a=c?.map((l,d)=>Array.isArray(u[d])?u[d].map((f,h)=>o1({param:l,value:u[d][h]})):typeof u[d]<"u"&&u[d]!==null?o1({param:l,value:u[d]}):null)??[])}return[o,...a]}function o1({param:t,value:e}){if(t.type==="string"||t.type==="bytes")return Ht(fa(e));if(t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/))throw new $A(t.type);return xs([t],[e])}function yh(t,{method:e}){const n={};return t.transport.type==="fallback"&&t.transport.onResponse?.(({method:r,response:s,status:i,transport:o})=>{i==="success"&&e===r&&(n[s]=o.request)}),(r=>n[r]||t.request)}async function KA(t,e){const{address:n,abi:r,args:s,eventName:i,fromBlock:o,strict:a,toBlock:c}=e,u=yh(t,{method:"eth_newFilter"}),l=i?Lc({abi:r,args:s,eventName:i}):void 0,d=await t.request({method:"eth_newFilter",params:[{address:n,fromBlock:typeof o=="bigint"?ee(o):o,toBlock:typeof c=="bigint"?ee(c):c,topics:l}]});return{abi:r,args:s,eventName:i,id:d,request:u(d),strict:!!a,type:"event"}}function Qt(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const a1="/docs/contract/encodeFunctionData";function GA(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=co({abi:e,args:n,name:r});if(!i)throw new Zo(r,{docsPath:a1});s=i}if(s.type!=="function")throw new Zo(void 0,{docsPath:a1});return{abi:[s],functionName:Jo(Yr(s))}}function lr(t){const{args:e}=t,{abi:n,functionName:r}=t.abi.length===1&&t.functionName?.startsWith("0x")?t:GA(t),s=n[0],i=r,o="inputs"in s&&s.inputs?xs(s.inputs,e??[]):void 0;return Sn([i,o??"0x"])}const A8={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},YA={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},S8={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};let c1=class extends K{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}},ZA=class extends K{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}},I8=class extends K{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}};const T8={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new I8({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new ZA({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new c1({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new c1({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function zy(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(T8);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function JA(t,e={}){typeof e.size<"u"&&Nr(t,{size:e.size});const n=Ct(t,e);return zt(n,e)}function XA(t,e={}){let n=t;if(typeof e.size<"u"&&(Nr(n,{size:e.size}),n=yn(n)),n.length>1||n[0]>1)throw new UA(n);return!!n[0]}function Es(t,e={}){typeof e.size<"u"&&Nr(t,{size:e.size});const n=Ct(t,e);return ar(n,e)}function QA(t,e={}){let n=t;return typeof e.size<"u"&&(Nr(n,{size:e.size}),n=yn(n,{dir:"right"})),new TextDecoder().decode(n)}function Fc(t,e){const n=typeof e=="string"?cr(e):e,r=zy(n);if(dt(n)===0&&t.length>0)throw new Bc;if(dt(e)&&dt(e)<32)throw new Ty({data:typeof e=="string"?e:Ct(e),params:t,size:dt(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,u]=Ja(r,a,{staticPosition:0});s+=u,i.push(c)}return i}function Ja(t,e,{staticPosition:n}){const r=qy(e.type);if(r){const[s,i]=r;return x8(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return k8(t,e,{staticPosition:n});if(e.type==="address")return N8(t);if(e.type==="bool")return P8(t);if(e.type.startsWith("bytes"))return O8(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return R8(t,e);if(e.type==="string")return $8(t,{staticPosition:n});throw new OA(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const u1=32,Mg=32;function N8(t){const e=t.readBytes(32);return[Mc(Ct(My(e,-20))),32]}function x8(t,e,{length:n,staticPosition:r}){if(!n){const o=Es(t.readBytes(Mg)),a=r+o,c=a+u1;t.setPosition(a);const u=Es(t.readBytes(u1)),l=el(e);let d=0;const f=[];for(let h=0;h<u;++h){t.setPosition(c+(l?h*32:d));const[g,p]=Ja(t,e,{staticPosition:c});d+=p,f.push(g)}return t.setPosition(r+32),[f,32]}if(el(e)){const o=Es(t.readBytes(Mg)),a=r+o,c=[];for(let u=0;u<n;++u){t.setPosition(a+u*32);const[l]=Ja(t,e,{staticPosition:a});c.push(l)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=Ja(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function P8(t){return[XA(t.readBytes(32),{size:32}),32]}function O8(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=Es(t.readBytes(32));t.setPosition(n+o);const a=Es(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[Ct(c),32]}return[Ct(t.readBytes(Number.parseInt(s,10),32)),32]}function R8(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256",10),s=t.readBytes(32);return[r>48?JA(s,{signed:n}):Es(s,{signed:n}),32]}function k8(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(el(e)){const o=Es(t.readBytes(Mg)),a=n+o;for(let c=0;c<e.components.length;++c){const u=e.components[c];t.setPosition(a+i);const[l,d]=Ja(t,u,{staticPosition:a});i+=d,s[r?c:u?.name]=l}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,u]=Ja(t,a,{staticPosition:n});s[r?o:a?.name]=c,i+=u}return[s,i]}function $8(t,{staticPosition:e}){const n=Es(t.readBytes(32)),r=e+n;t.setPosition(r);const s=Es(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=QA(yn(i));return t.setPosition(e+32),[o,32]}function el(t){const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return t.components?.some(el);const n=qy(t.type);return!!(n&&el({...t,type:n[1]}))}function Hy(t){const{abi:e,data:n}=t,r=to(n,0,4);if(r==="0x")throw new Bc;const i=[...e||[],YA,S8].find(o=>o.type==="error"&&r===Jo(Yr(o)));if(!i)throw new xy(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?Fc(i.inputs,to(n,4)):void 0,errorName:i.name}}const Et=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n);function e2({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?Et(e[i]):e[i]}`).join(", ")})`}const t2={gwei:9,wei:18},n2={ether:-9,wei:9},r2={ether:-18,gwei:-9};function uo(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function bh(t,e="wei"){return uo(t,t2[e])}function bn(t,e="wei"){return uo(t,n2[e])}class s2 extends K{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class i2 extends K{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function l1(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function D8(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=l1(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=l1(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function Al(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class o2 extends K{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class a2 extends K{constructor({v:e}){super(`Invalid \`v\` value "${e}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}}class c2 extends K{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Al(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class u2 extends K{constructor({storageKey:e}){super(`Size for storage key "${e}" is invalid. Expected 32 bytes. Got ${Math.floor((e.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}class l2 extends K{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:f}){const h=Al({chain:s&&`${s?.name} (id: ${s?.id})`,from:n?.address,to:d,value:typeof f<"u"&&`${bh(f)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${bn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${bn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${bn(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",h].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Wy extends K{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class Vy extends K{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class U8 extends K{constructor({receipt:e}){super(`Transaction with hash "${e.transactionHash}" reverted.`,{metaMessages:['The receipt marked the transaction as "reverted". This could mean that the function on the contract you are trying to call threw an error.'," ","You can attempt to extract the revert reason by:","- calling the `simulateContract` or `simulateCalls` Action with the `abi` and `functionName` of the contract","- using the `call` Action with raw `data`"],name:"TransactionReceiptRevertedError"}),Object.defineProperty(this,"receipt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.receipt=e}}class d2 extends K{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const B8=t=>t,Sl=t=>t;class Ky extends K{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:f,stateOverride:h}){const g=n?Qt(n):void 0;let p=Al({from:g?.address,to:d,value:typeof f<"u"&&`${bh(f)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${bn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${bn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${bn(u)} gwei`,nonce:l});h&&(p+=`
${D8(h)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",p].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class wh extends K{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=co({abi:n,args:r,name:o}),u=c?e2({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,l=c?Yr(c,{includeName:!0}):void 0,d=Al({address:s&&B8(s),function:l,args:u&&u!=="()"&&`${[...Array(o?.length??0).keys()].map(()=>" ").join("")}${u}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class vf extends K{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=Hy({abi:e,data:n});const{abiItem:l,errorName:d,args:f}=o;if(d==="Error")c=f[0];else if(d==="Panic"){const[h]=f;c=A8[h]}else{const h=l?Yr(l,{includeName:!0}):void 0,g=l&&f?e2({abiItem:l,args:f,includeFunctionName:!1,includeName:!1}):void 0;a=[h?`Error: ${h}`:"",g&&g!=="()"?`       ${[...Array(d?.length??0).keys()].map(()=>" ").join("")}${g}`:""]}}catch(l){i=l}else s&&(c=s);let u;i instanceof xy&&(u=i.signature,a=[`Unable to decode signature "${u}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${u}.`]),super(c&&c!=="execution reverted"||u?[`The contract function "${r}" reverted with the following ${u?"signature":"reason"}:`,c||u].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=u}}class f2 extends K{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class h2 extends K{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class Il extends K{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class Gi extends K{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${Sl(o)}`,e&&`Request body: ${Et(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class Eh extends K{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${Sl(r)}`,`Request body: ${Et(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class Lg extends K{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Sl(n)}`,`Request body: ${Et(e)}`],name:"TimeoutError"})}}const M8=-1;class In extends K{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||e?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof Eh?e.code:n??M8}}class Kn extends In{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class hc extends In{constructor(e){super(e,{code:hc.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(hc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class pc extends In{constructor(e){super(e,{code:pc.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(pc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class gc extends In{constructor(e,{method:n}={}){super(e,{code:gc.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(gc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class mc extends In{constructor(e){super(e,{code:mc.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class no extends In{constructor(e){super(e,{code:no.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(no,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class ro extends In{constructor(e){super(e,{code:ro.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(ro,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class yc extends In{constructor(e){super(e,{code:yc.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(yc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class ii extends In{constructor(e){super(e,{code:ii.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(ii,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Xo extends In{constructor(e){super(e,{code:Xo.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Xo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Hi extends In{constructor(e,{method:n}={}){super(e,{code:Hi.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(Hi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Qo extends In{constructor(e){super(e,{code:Qo.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Qo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class bc extends In{constructor(e){super(e,{code:bc.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(bc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class yt extends Kn{constructor(e){super(e,{code:yt.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(yt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class wc extends Kn{constructor(e){super(e,{code:wc.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(wc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Ec extends Kn{constructor(e,{method:n}={}){super(e,{code:Ec.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Ec,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class vc extends Kn{constructor(e){super(e,{code:vc.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(vc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Cc extends Kn{constructor(e){super(e,{code:Cc.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Cc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Zr extends Kn{constructor(e){super(e,{code:Zr.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Zr,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class _c extends Kn{constructor(e){super(e,{code:_c.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(_c,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Ac extends Kn{constructor(e){super(e,{code:Ac.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Ac,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Sc extends Kn{constructor(e){super(e,{code:Sc.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Sc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Ic extends Kn{constructor(e){super(e,{code:Ic.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Ic,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Tc extends Kn{constructor(e){super(e,{code:Tc.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Tc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Nc extends Kn{constructor(e){super(e,{code:Nc.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Nc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class xc extends Kn{constructor(e){super(e,{code:xc.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(xc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class p2 extends In{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const L8=3;function so(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof Il?t:t instanceof K?t.walk(g=>"data"in g)||t.walk():{},{code:c,data:u,details:l,message:d,shortMessage:f}=a,h=t instanceof Bc?new f2({functionName:i}):[L8,no.code].includes(c)&&(u||l||d||f)?new vf({abi:e,data:typeof u=="object"?u.data:u,functionName:i,message:a instanceof Eh?l:f??d}):t;return new wh(h,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function F8(t){const e=Ht(`0x${t.substring(4)}`).substring(26);return Mc(`0x${e}`)}async function g2({hash:t,signature:e}){const n=Ar(t)?t:Jt(t),{secp256k1:r}=await kt(async()=>{const{secp256k1:o}=await Promise.resolve().then(()=>n4);return{secp256k1:o}},void 0);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:d,yParity:f}=e,h=Number(f??d),g=d1(h);return new r.Signature(zt(u),zt(l)).addRecoveryBit(g)}const o=Ar(e)?e:Jt(e);if(dt(o)!==65)throw new Error("invalid signature length");const a=ar(`0x${o.slice(130)}`),c=d1(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function d1(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function Gy({hash:t,signature:e}){return F8(await g2({hash:t,signature:e}))}function pi(t,e="hex"){const n=m2(t),r=zy(new Uint8Array(n.length));return n.encode(r),e==="hex"?Ct(r.bytes):r.bytes}function m2(t){return Array.isArray(t)?j8(t.map(e=>m2(e))):q8(t)}function j8(t){const e=t.reduce((s,i)=>s+i.length,0),n=y2(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function q8(t){const e=typeof t=="string"?cr(t):t,n=y2(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function y2(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new K("Length is too large.")}function z8(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=Ht(Sn(["0x05",pi([e?ee(e):"0x",s,n?ee(n):"0x"])]));return r==="bytes"?cr(i):i}async function Yy(t){const{authorization:e,signature:n}=t;return Gy({hash:z8(e),signature:n??e})}class b2 extends K{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:f}){const h=Al({from:n?.address,to:d,value:typeof f<"u"&&`${bh(f)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${bn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${bn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${bn(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",h].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Wi extends K{constructor({cause:e,message:n}={}){const r=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Wi,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Wi,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class io extends K{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${bn(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(io,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Cf extends K{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${bn(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(Cf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class _f extends K{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(_f,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class Af extends K{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(Af,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class Sf extends K{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(Sf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class If extends K{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(If,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Tf extends K{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Tf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Nf extends K{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Nf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class xf extends K{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(xf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Pc extends K{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${bn(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${bn(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(Pc,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class jc extends K{constructor({cause:e}){super(`An error occurred while executing: ${e?.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function vh(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof K?t.walk(s=>s?.code===Wi.code):t;return r instanceof K?new Wi({cause:t,message:r.details}):Wi.nodeMessage.test(n)?new Wi({cause:t,message:t.details}):io.nodeMessage.test(n)?new io({cause:t,maxFeePerGas:e?.maxFeePerGas}):Cf.nodeMessage.test(n)?new Cf({cause:t,maxFeePerGas:e?.maxFeePerGas}):_f.nodeMessage.test(n)?new _f({cause:t,nonce:e?.nonce}):Af.nodeMessage.test(n)?new Af({cause:t,nonce:e?.nonce}):Sf.nodeMessage.test(n)?new Sf({cause:t,nonce:e?.nonce}):If.nodeMessage.test(n)?new If({cause:t}):Tf.nodeMessage.test(n)?new Tf({cause:t,gas:e?.gas}):Nf.nodeMessage.test(n)?new Nf({cause:t,gas:e?.gas}):xf.nodeMessage.test(n)?new xf({cause:t}):Pc.nodeMessage.test(n)?new Pc({cause:t,maxFeePerGas:e?.maxFeePerGas,maxPriorityFeePerGas:e?.maxPriorityFeePerGas}):new jc({cause:t})}function H8(t,{docsPath:e,...n}){const r=(()=>{const s=vh(t,n);return s instanceof jc?t:s})();return new b2(r,{docsPath:e,...n})}function Ch(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}function Zy(t,e){return({exclude:n,format:r})=>({exclude:n,format:(s,i)=>{const o=e(s,i);if(n)for(const a of n)delete o[a];return{...o,...r(s,i)}},type:t})}const w2={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function qc(t,e){const n={};return typeof t.authorizationList<"u"&&(n.authorizationList=W8(t.authorizationList)),typeof t.accessList<"u"&&(n.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(n.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?n.blobs=t.blobs.map(r=>Ct(r)):n.blobs=t.blobs),typeof t.data<"u"&&(n.data=t.data),t.account&&(n.from=t.account.address),typeof t.from<"u"&&(n.from=t.from),typeof t.gas<"u"&&(n.gas=ee(t.gas)),typeof t.gasPrice<"u"&&(n.gasPrice=ee(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(n.maxFeePerBlobGas=ee(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(n.maxFeePerGas=ee(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(n.maxPriorityFeePerGas=ee(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(n.nonce=ee(t.nonce)),typeof t.to<"u"&&(n.to=t.to),typeof t.type<"u"&&(n.type=w2[t.type]),typeof t.value<"u"&&(n.value=ee(t.value)),n}function W8(t){return t.map(e=>({address:e.address,r:e.r?ee(BigInt(e.r)):e.r,s:e.s?ee(BigInt(e.s)):e.s,chainId:ee(e.chainId),nonce:ee(e.nonce),...typeof e.yParity<"u"?{yParity:ee(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:ee(e.v)}:{}}))}function f1(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new r1({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new r1({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function V8(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=ee(e)),n!==void 0&&(o.nonce=ee(n)),r!==void 0&&(o.state=f1(r)),s!==void 0){if(o.state)throw new i2;o.stateDiff=f1(s)}return o}function Jy(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!_t(n,{strict:!1}))throw new Xt({address:n});if(e[n])throw new s2({address:n});e[n]=V8(r)}return e}const Tl=2n**256n-1n;function ha(t){const{account:e,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:i}=t,o=e?Qt(e):void 0;if(o&&!_t(o.address))throw new Xt({address:o.address});if(i&&!_t(i))throw new Xt({address:i});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new o2;if(r&&r>Tl)throw new io({maxFeePerGas:r});if(s&&r&&s>r)throw new Pc({maxFeePerGas:r,maxPriorityFeePerGas:s})}class E2 extends K{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class _h extends K{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class v2 extends K{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${bn(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class Xy extends K{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const Qy={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function Nl(t,e){const n={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?ar(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?ar(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?Qy[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(n.authorizationList=K8(t.authorizationList)),n.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof n.v=="bigint"){if(n.v===0n||n.v===27n)return 0;if(n.v===1n||n.v===28n)return 1;if(n.v>=35n)return n.v%2n===0n?1:0}})(),n.type==="legacy"&&(delete n.accessList,delete n.maxFeePerBlobGas,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.yParity),n.type==="eip2930"&&(delete n.maxFeePerBlobGas,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas),n.type==="eip1559"&&delete n.maxFeePerBlobGas,n}const C2=Zy("transaction",Nl);function K8(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function Ah(t,e){const n=(t.transactions??[]).map(r=>typeof r=="string"?r:Nl(r));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:n,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}const _2=Zy("block",Ah);async function gs(t,{blockHash:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest",includeTransactions:s}={}){const i=s??!1,o=n!==void 0?ee(n):void 0;let a=null;if(e?a=await t.request({method:"eth_getBlockByHash",params:[e,i]},{dedupe:!0}):a=await t.request({method:"eth_getBlockByNumber",params:[o||r,i]},{dedupe:!!o}),!a)throw new Xy({blockHash:e,blockNumber:n});return(t.chain?.formatters?.block?.format||Ah)(a,"getBlock")}async function eb(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function G8(t,e){return A2(t,e)}async function A2(t,e){const{block:n,chain:r=t.chain,request:s}=e||{};try{const i=r?.fees?.maxPriorityFeePerGas??r?.fees?.defaultPriorityFee;if(typeof i=="function"){const a=n||await ve(t,gs,"getBlock")({}),c=await i({block:a,client:t,request:s});if(c===null)throw new Error;return c}if(typeof i<"u")return i;const o=await t.request({method:"eth_maxPriorityFeePerGas"});return zt(o)}catch{const[i,o]=await Promise.all([n?Promise.resolve(n):ve(t,gs,"getBlock")({}),ve(t,eb,"getGasPrice")({})]);if(typeof i.baseFeePerGas!="bigint")throw new _h;const a=o-i.baseFeePerGas;return a<0n?0n:a}}async function Y8(t,e){return Fg(t,e)}async function Fg(t,e){const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>typeof r?.fees?.baseFeeMultiplier=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):r?.fees?.baseFeeMultiplier??1.2)();if(o<1)throw new E2;const c=10**(o.toString().split(".")[1]?.length??0),u=f=>f*BigInt(Math.ceil(o*c))/BigInt(c),l=n||await ve(t,gs,"getBlock")({});if(typeof r?.fees?.estimateFeesPerGas=="function"){const f=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:u,request:s,type:i});if(f!==null)return f}if(i==="eip1559"){if(typeof l.baseFeePerGas!="bigint")throw new _h;const f=typeof s?.maxPriorityFeePerGas=="bigint"?s.maxPriorityFeePerGas:await A2(t,{block:l,chain:r,request:s}),h=u(l.baseFeePerGas);return{maxFeePerGas:s?.maxFeePerGas??h+f,maxPriorityFeePerGas:f}}return{gasPrice:s?.gasPrice??u(await ve(t,eb,"getGasPrice")({}))}}async function tb(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?ee(r):n]},{dedupe:!!r});return ar(s)}function Sh(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>cr(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>Ct(i))}function Ih(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>cr(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>cr(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>Ct(o))}function Z8(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}function J8(t,e,n){return t&e^~t&n}function X8(t,e,n){return t&e^t&n^e&n}class S2 extends $_{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Ap(this.buffer)}update(e){rf(this),e=D_(e),yy(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ap(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){rf(this),kN(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,ac(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;Z8(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Ap(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Ei=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),rn=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),sn=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Q8=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),vi=new Uint32Array(64);class eR extends S2{constructor(e=32){super(64,e,8,!1),this.A=Ei[0]|0,this.B=Ei[1]|0,this.C=Ei[2]|0,this.D=Ei[3]|0,this.E=Ei[4]|0,this.F=Ei[5]|0,this.G=Ei[6]|0,this.H=Ei[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)vi[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=vi[d-15],h=vi[d-2],g=rs(f,7)^rs(f,18)^f>>>3,p=rs(h,17)^rs(h,19)^h>>>10;vi[d]=p+vi[d-7]+g+vi[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=rs(a,6)^rs(a,11)^rs(a,25),h=l+f+J8(a,c,u)+Q8[d]+vi[d]|0,p=(rs(r,2)^rs(r,13)^rs(r,22))+X8(r,s,i)|0;l=u,u=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,i,o,a,c,u,l)}roundClean(){ac(vi)}destroy(){this.set(0,0,0,0,0,0,0,0),ac(this.buffer)}}const I2=BN(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),tR=I2[0],nR=I2[1],Ci=new Uint32Array(80),_i=new Uint32Array(80);class T2 extends S2{constructor(e=64){super(128,e,16,!1),this.Ah=sn[0]|0,this.Al=sn[1]|0,this.Bh=sn[2]|0,this.Bl=sn[3]|0,this.Ch=sn[4]|0,this.Cl=sn[5]|0,this.Dh=sn[6]|0,this.Dl=sn[7]|0,this.Eh=sn[8]|0,this.El=sn[9]|0,this.Fh=sn[10]|0,this.Fl=sn[11]|0,this.Gh=sn[12]|0,this.Gl=sn[13]|0,this.Hh=sn[14]|0,this.Hl=sn[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:h,Gl:g,Hh:p,Hl:y}=this;return[e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y]}set(e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=g|0,this.Hh=p|0,this.Hl=y|0}process(e,n){for(let w=0;w<16;w++,n+=4)Ci[w]=e.getUint32(n),_i[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const C=Ci[w-15]|0,_=_i[w-15]|0,P=Ca(C,_,1)^Ca(C,_,8)^Rw(C,_,7),k=_a(C,_,1)^_a(C,_,8)^kw(C,_,7),U=Ci[w-2]|0,$=_i[w-2]|0,L=Ca(U,$,19)^Jl(U,$,61)^Rw(U,$,6),M=_a(U,$,19)^Xl(U,$,61)^kw(U,$,6),D=$N(k,M,_i[w-7],_i[w-16]),T=DN(D,P,L,Ci[w-7],Ci[w-16]);Ci[w]=T|0,_i[w]=D|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:h,Fl:g,Gh:p,Gl:y,Hh:E,Hl:A}=this;for(let w=0;w<80;w++){const C=Ca(d,f,14)^Ca(d,f,18)^Jl(d,f,41),_=_a(d,f,14)^_a(d,f,18)^Xl(d,f,41),P=d&h^~d&p,k=f&g^~f&y,U=UN(A,_,k,nR[w],_i[w]),$=MN(U,E,C,P,tR[w],Ci[w]),L=U|0,M=Ca(r,s,28)^Jl(r,s,34)^Jl(r,s,39),D=_a(r,s,28)^Xl(r,s,34)^Xl(r,s,39),T=r&i^r&a^i&a,O=s&o^s&c^o&c;E=p|0,A=y|0,p=h|0,y=g|0,h=d|0,g=f|0,{h:d,l:f}=Ps(u|0,l|0,$|0,L|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const m=FN(L,D,O);r=LN(m,$,M,T),s=m|0}({h:r,l:s}=Ps(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ps(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ps(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ps(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Ps(this.Eh|0,this.El|0,d|0,f|0),{h,l:g}=Ps(this.Fh|0,this.Fl|0,h|0,g|0),{h:p,l:y}=Ps(this.Gh|0,this.Gl|0,p|0,y|0),{h:E,l:A}=Ps(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,u,l,d,f,h,g,p,y,E,A)}roundClean(){ac(Ci,_i)}destroy(){ac(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class rR extends T2{constructor(){super(48),this.Ah=rn[0]|0,this.Al=rn[1]|0,this.Bh=rn[2]|0,this.Bl=rn[3]|0,this.Ch=rn[4]|0,this.Cl=rn[5]|0,this.Dh=rn[6]|0,this.Dl=rn[7]|0,this.Eh=rn[8]|0,this.El=rn[9]|0,this.Fh=rn[10]|0,this.Fl=rn[11]|0,this.Gh=rn[12]|0,this.Gl=rn[13]|0,this.Hh=rn[14]|0,this.Hl=rn[15]|0}}const nb=by(()=>new eR),Ute=by(()=>new T2),Bte=by(()=>new rR),sR=nb;function N2(t,e){return sR(Ar(t,{strict:!1})?fa(t):t)}function x2(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=N2(e);return s.set([n],0),r==="bytes"?s:Ct(s)}function rb(t){const{commitments:e,version:n}=t,r=t.to??(typeof e[0]=="string"?"hex":"bytes"),s=[];for(const i of e)s.push(x2({commitment:i,to:r,version:n}));return s}const h1=6,P2=32,sb=4096,O2=P2*sb,p1=O2*h1-1-1*sb*h1,R2=1;class iR extends K{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class k2 extends K{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}class oR extends K{constructor({hash:e,size:n}){super(`Versioned hash "${e}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${n}`],name:"InvalidVersionedHashSizeError"})}}class aR extends K{constructor({hash:e,version:n}){super(`Versioned hash "${e}" version is invalid.`,{metaMessages:[`Expected: ${R2}`,`Received: ${n}`],name:"InvalidVersionedHashVersionError"})}}function $2(t){const e=t.to??(typeof t.data=="string"?"hex":"bytes"),n=typeof t.data=="string"?cr(t.data):t.data,r=dt(n);if(!r)throw new k2;if(r>p1)throw new iR({maxSize:p1,size:r});const s=[];let i=!0,o=0;for(;i;){const a=zy(new Uint8Array(O2));let c=0;for(;c<sb;){const u=n.slice(o,o+(P2-1));if(a.pushByte(0),a.pushBytes(u),u.length<31){a.pushByte(128),i=!1;break}c++,o+=31}s.push(a)}return e==="bytes"?s.map(a=>a.bytes):s.map(a=>Ct(a.bytes))}function ib(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??$2({data:e,to:r}),i=t.commitments??Sh({blobs:s,kzg:n,to:r}),o=t.proofs??Ih({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function ob(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new c2({transaction:t})}async function Th(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return ar(e)}const D2=["blobVersionedHashes","chainId","fees","gas","nonce","type"],g1=new Map;async function Nh(t,e){const{account:n=t.account,blobs:r,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:u=D2,type:l}=e,d=n&&Qt(n),f={...e,...d?{from:d?.address}:{}};let h;async function g(){return h||(h=await ve(t,gs,"getBlock")({blockTag:"latest"}),h)}let p;async function y(){return p||(s?s.id:typeof e.chainId<"u"?e.chainId:(p=await ve(t,Th,"getChainId")({}),p))}if(u.includes("nonce")&&typeof a>"u"&&d)if(c){const E=await y();f.nonce=await c.consume({address:d.address,chainId:E,client:t})}else f.nonce=await ve(t,tb,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&r&&o){const E=Sh({blobs:r,kzg:o});if(u.includes("blobVersionedHashes")){const A=rb({commitments:E,to:"hex"});f.blobVersionedHashes=A}if(u.includes("sidecars")){const A=Ih({blobs:r,commitments:E,kzg:o}),w=ib({blobs:r,commitments:E,proofs:A,to:"hex"});f.sidecars=w}}if(u.includes("chainId")&&(f.chainId=await y()),(u.includes("fees")||u.includes("type"))&&typeof l>"u")try{f.type=ob(f)}catch{let E=g1.get(t.uid);typeof E>"u"&&(E=typeof(await g())?.baseFeePerGas=="bigint",g1.set(t.uid,E)),f.type=E?"eip1559":"legacy"}if(u.includes("fees"))if(f.type!=="legacy"&&f.type!=="eip2930"){if(typeof f.maxFeePerGas>"u"||typeof f.maxPriorityFeePerGas>"u"){const E=await g(),{maxFeePerGas:A,maxPriorityFeePerGas:w}=await Fg(t,{block:E,chain:s,request:f});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<w)throw new v2({maxPriorityFeePerGas:w});f.maxPriorityFeePerGas=w,f.maxFeePerGas=A}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new _h;if(typeof e.gasPrice>"u"){const E=await g(),{gasPrice:A}=await Fg(t,{block:E,chain:s,request:f,type:"legacy"});f.gasPrice=A}}return u.includes("gas")&&typeof i>"u"&&(f.gas=await ve(t,xh,"estimateGas")({...f,account:d,prepare:d?.type==="local"?[]:["blobVersionedHashes"]})),ha(f),delete f.parameters,f}async function xh(t,e){const{account:n=t.account,prepare:r=!0}=e,s=n?Qt(n):void 0,i=(()=>{if(Array.isArray(r))return r;if(s?.type!=="local")return["blobVersionedHashes"]})();try{const{accessList:o,authorizationList:a,blobs:c,blobVersionedHashes:u,blockNumber:l,blockTag:d,data:f,gas:h,gasPrice:g,maxFeePerBlobGas:p,maxFeePerGas:y,maxPriorityFeePerGas:E,nonce:A,value:w,stateOverride:C,..._}=r?await Nh(t,{...e,parameters:i}):e,k=(typeof l=="bigint"?ee(l):void 0)||d,U=Jy(C),$=await(async()=>{if(_.to)return _.to;if(a&&a.length>0)return await Yy({authorization:a[0]}).catch(()=>{throw new K("`to` is required. Could not infer from `authorizationList`")})})();ha(e);const L=t.chain?.formatters?.transactionRequest?.format,D=(L||qc)({...Ch(_,{format:L}),account:s,accessList:o,authorizationList:a,blobs:c,blobVersionedHashes:u,data:f,gas:h,gasPrice:g,maxFeePerBlobGas:p,maxFeePerGas:y,maxPriorityFeePerGas:E,nonce:A,to:$,value:w},"estimateGas");return BigInt(await t.request({method:"eth_estimateGas",params:U?[D,k??t.experimental_blockTag??"latest",U]:k?[D,k]:[D]}))}catch(o){throw H8(o,{...e,account:s,chain:t.chain})}}async function cR(t,e){const{abi:n,address:r,args:s,functionName:i,dataSuffix:o,...a}=e,c=lr({abi:n,args:s,functionName:i});try{return await ve(t,xh,"estimateGas")({data:`${c}${o?o.replace("0x",""):""}`,to:r,...a})}catch(u){const l=a.account?Qt(a.account):void 0;throw so(u,{abi:n,address:r,args:s,docsPath:"/docs/contract/estimateContractGas",functionName:i,sender:l?.address})}}function pa(t,e){if(!_t(t,{strict:!1}))throw new Xt({address:t});if(!_t(e,{strict:!1}))throw new Xt({address:e});return t.toLowerCase()===e.toLowerCase()}const m1="/docs/contract/decodeEventLog";function Ph(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new NA({docsPath:m1});const c=e.find(p=>p.type==="event"&&o===fc(Yr(p)));if(!(c&&"name"in c)||c.type!=="event")throw new Py(o,{docsPath:m1});const{name:u,inputs:l}=c,d=l?.some(p=>!("name"in p&&p.name)),f=d?[]:{},h=l.map((p,y)=>[p,y]).filter(([p])=>"indexed"in p&&p.indexed);for(let p=0;p<h.length;p++){const[y,E]=h[p],A=a[p];if(!A)throw new Cl({abiItem:c,param:y});f[d?E:y.name||E]=uR({param:y,value:A})}const g=l.filter(p=>!("indexed"in p&&p.indexed));if(g.length>0){if(n&&n!=="0x")try{const p=Fc(g,n);if(p)if(d)for(let y=0;y<l.length;y++)f[y]=f[y]??p.shift();else for(let y=0;y<g.length;y++)f[g[y].name]=p[y]}catch(p){if(i)throw p instanceof Ty||p instanceof ZA?new dc({abiItem:c,data:n,params:g,size:dt(n)}):p}else if(i)throw new dc({abiItem:c,data:"0x",params:g,size:0})}return{eventName:u,args:Object.values(f).length>0?f:void 0}}function uR({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(Fc([t],e)||[])[0]}function Oh(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{try{const a=e.find(u=>u.type==="event"&&o.topics[0]===fc(u));if(!a)return null;const c=Ph({...o,abi:[a],strict:s});return i&&!i.includes(c.eventName)||!lR({args:c.args,inputs:a.inputs,matchArgs:n})?null:{...c,...o}}catch(a){let c,u;if(a instanceof Py)return null;if(a instanceof dc||a instanceof Cl){if(s)return null;c=a.abiItem.name,u=a.abiItem.inputs?.some(l=>!("name"in l&&l.name))}return{...o,args:u?[]:{},eventName:c}}}).filter(Boolean)}function lR(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?pa(o,a):i.type==="string"||i.type==="bytes"?Ht(fa(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(u=>s(a,u,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(u=>u.name===i);return a?(Array.isArray(o)?o:[o]).some(u=>s(a,u,e[i])):!1}):!1}function Is(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}async function ab(t,{address:e,blockHash:n,fromBlock:r,toBlock:s,event:i,events:o,args:a,strict:c}={}){const u=c??!1,l=o??(i?[i]:void 0);let d=[];l&&(d=[l.flatMap(p=>Lc({abi:[p],eventName:p.name,args:o?void 0:a}))],i&&(d=d[0]));let f;n?f=await t.request({method:"eth_getLogs",params:[{address:e,topics:d,blockHash:n}]}):f=await t.request({method:"eth_getLogs",params:[{address:e,topics:d,fromBlock:typeof r=="bigint"?ee(r):r,toBlock:typeof s=="bigint"?ee(s):s}]});const h=f.map(g=>Is(g));return l?Oh({abi:l,args:a,logs:h,strict:u}):h}async function U2(t,e){const{abi:n,address:r,args:s,blockHash:i,eventName:o,fromBlock:a,toBlock:c,strict:u}=e,l=o?co({abi:n,name:o}):void 0,d=l?void 0:n.filter(f=>f.type==="event");return ve(t,ab,"getLogs")({address:r,args:s,blockHash:i,event:l,events:d,fromBlock:a,toBlock:c,strict:u})}const Dp="/docs/contract/decodeFunctionResult";function lo(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=co({abi:e,args:n,name:r});if(!a)throw new Zo(r,{docsPath:Dp});i=a}if(i.type!=="function")throw new Zo(void 0,{docsPath:Dp});if(!i.outputs)throw new Oy(i.name,{docsPath:Dp});const o=Fc(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const cb=BigInt(0),jg=BigInt(1);function xl(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ub(t){if(!xl(t))throw new Error("Uint8Array expected")}function tl(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function nd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function B2(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?cb:BigInt("0x"+t)}const M2=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",dR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function nl(t){if(ub(t),M2)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=dR[t[n]];return e}const Rs={_0:48,_9:57,A:65,F:70,a:97,f:102};function y1(t){if(t>=Rs._0&&t<=Rs._9)return t-Rs._0;if(t>=Rs.A&&t<=Rs.F)return t-(Rs.A-10);if(t>=Rs.a&&t<=Rs.f)return t-(Rs.a-10)}function Pf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(M2)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=y1(t.charCodeAt(i)),a=y1(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function qo(t){return B2(nl(t))}function L2(t){return ub(t),B2(nl(Uint8Array.from(t).reverse()))}function Pl(t,e){return Pf(t.toString(16).padStart(e*2,"0"))}function F2(t,e){return Pl(t,e).reverse()}function br(t,e,n){let r;if(typeof e=="string")try{r=Pf(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(xl(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Of(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];ub(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const Up=t=>typeof t=="bigint"&&cb<=t;function lb(t,e,n){return Up(t)&&Up(e)&&Up(n)&&e<=t&&t<n}function Xa(t,e,n,r){if(!lb(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function fR(t){let e;for(e=0;t>cb;t>>=jg,e+=1);return e}const Rh=t=>(jg<<BigInt(t))-jg,Bp=t=>new Uint8Array(t),b1=t=>Uint8Array.from(t);function hR(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Bp(t),s=Bp(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=Bp(0))=>{s=a(b1([0]),d),r=a(),d.length!==0&&(s=a(b1([1]),d),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const f=[];for(;d<e;){r=a();const h=r.slice();f.push(h),d+=r.length}return Of(...f)};return(d,f)=>{o(),c(d);let h;for(;!(h=f(u()));)c();return o(),h}}const pR={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||xl(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function kh(t,e,n={}){const r=(s,i,o)=>{const a=pR[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function w1(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const gR="0.1.1";function mR(){return gR}let Fe=class qg extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof qg){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof qg&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${mR()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return j2(this,e)}};function j2(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?j2(t.cause,e):e?null:t}function Ol(t,e){if(ja(t)>e)throw new kR({givenSize:ja(t),maxSize:e})}const ks={zero:48,nine:57,A:65,F:70,a:97,f:102};function E1(t){if(t>=ks.zero&&t<=ks.nine)return t-ks.zero;if(t>=ks.A&&t<=ks.F)return t-(ks.A-10);if(t>=ks.a&&t<=ks.f)return t-(ks.a-10)}function yR(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new $R({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function q2(t,e={}){const{dir:n="left"}=e;let r=t,s=0;for(let i=0;i<r.length-1&&r[n==="left"?i:r.length-i-1].toString()==="0";i++)s++;return r=n==="left"?r.slice(s):r.slice(0,r.length-s),r}function $h(t,e){if(ur(t)>e)throw new FR({givenSize:ur(t),maxSize:e})}function bR(t,e){if(typeof e=="number"&&e>0&&e>ur(t)-1)throw new J2({offset:e,position:"start",size:ur(t)})}function wR(t,e,n){if(typeof e=="number"&&typeof n=="number"&&ur(t)!==n-e)throw new J2({offset:n,position:"end",size:ur(t)})}function z2(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new jR({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const ER="#__bigint";function H2(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+ER:s,n)}const vR=new TextDecoder,CR=new TextEncoder;function _R(t){return t instanceof Uint8Array?t:typeof t=="string"?W2(t):AR(t)}function AR(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function W2(t,e={}){const{size:n}=e;let r=t;n&&($h(t,n),r=ta(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const u=E1(s.charCodeAt(c++)),l=E1(s.charCodeAt(c++));if(u===void 0||l===void 0)throw new Fe(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=u*16+l}return o}function SR(t,e={}){const{size:n}=e,r=CR.encode(t);return typeof n=="number"?(Ol(r,n),IR(r,n)):r}function IR(t,e){return yR(t,{dir:"right",size:e})}function ja(t){return t.length}function TR(t,e,n,r={}){const{strict:s}=r;return t.slice(e,n)}function NR(t,e={}){const{size:n}=e;typeof n<"u"&&Ol(t,n);const r=Xr(t,e);return G2(r,e)}function xR(t,e={}){const{size:n}=e;let r=t;if(typeof n<"u"&&(Ol(r,n),r=V2(r)),r.length>1||r[0]>1)throw new RR(r);return!!r[0]}function oi(t,e={}){const{size:n}=e;typeof n<"u"&&Ol(t,n);const r=Xr(t,e);return Y2(r,e)}function PR(t,e={}){const{size:n}=e;let r=t;return typeof n<"u"&&(Ol(r,n),r=OR(r)),vR.decode(r)}function V2(t){return q2(t,{dir:"left"})}function OR(t){return q2(t,{dir:"right"})}class RR extends Fe{constructor(e){super(`Bytes value \`${e}\` is not a valid boolean.`,{metaMessages:["The bytes array must contain a single byte of either a `0` or `1` value."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesBooleanError"})}}let kR=class extends Fe{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}},$R=class extends Fe{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}};const DR=new TextEncoder,UR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function BR(t,e={}){const{strict:n=!1}=e;if(!t)throw new v1(t);if(typeof t!="string")throw new v1(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new C1(t);if(!t.startsWith("0x"))throw new C1(t)}function Jr(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function MR(t){return t instanceof Uint8Array?Xr(t):Array.isArray(t)?Xr(new Uint8Array(t)):t}function K2(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?($h(n,e.size),ea(n,e.size)):n}function Xr(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=UR[t[s]];const r=`0x${n}`;return typeof e.size=="number"?($h(r,e.size),ta(r,e.size)):r}function mn(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const u=typeof t=="bigint"?"n":"";throw new Z2({max:i?`${i}${u}`:void 0,min:`${o}${u}`,signed:n,size:r,value:`${t}${u}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?ea(c,r):c}function db(t,e={}){return Xr(DR.encode(t),e)}function ea(t,e){return z2(t,{dir:"left",size:e})}function ta(t,e){return z2(t,{dir:"right",size:e})}function vs(t,e,n,r={}){const{strict:s}=r;bR(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&wR(i,e,n),i}function ur(t){return Math.ceil((t.length-2)/2)}function G2(t,e={}){const{signed:n}=e;e.size&&$h(t,e.size);const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n)-1n,o=i>>1n;return r<=o?r:r-i-1n}function Y2(t,e={}){const{signed:n,size:r}=e;return Number(!n&&!r?t:G2(t,e))}function LR(t,e={}){const{strict:n=!1}=e;try{return BR(t,{strict:n}),!0}catch{return!1}}let Z2=class extends Fe{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}},v1=class extends Fe{constructor(e){super(`Value \`${typeof e=="object"?H2(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}},C1=class extends Fe{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}},FR=class extends Fe{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},J2=class extends Fe{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}},jR=class extends Fe{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function qR(t){return{address:t.address,amount:mn(t.amount),index:mn(t.index),validatorIndex:mn(t.validatorIndex)}}function X2(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:mn(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:mn(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:mn(t.gasLimit)},...typeof t.number=="bigint"&&{number:mn(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:mn(t.prevRandao)},...typeof t.time=="bigint"&&{time:mn(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(qR)}}}const rl=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],zg=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],Q2=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],eS=[...Q2,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],zR=[...Q2,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],_1=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],A1=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],tS=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],Rf=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],vu=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],HR="0x82ad56cb",fb="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",nS="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",Hg="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572",hb="0x608060405234801561001057600080fd5b506115b9806100206000396000f3fe6080604052600436106100f35760003560e01c80634d2301cc1161008a578063a8b0574e11610059578063a8b0574e14610325578063bce38bd714610350578063c3077fa914610380578063ee82ac5e146103b2576100f3565b80634d2301cc1461026257806372425d9d1461029f57806382ad56cb146102ca57806386d516e8146102fa576100f3565b80633408e470116100c65780633408e470146101af578063399542e9146101da5780633e64a6961461020c57806342cbb15c14610237576100f3565b80630f28c97d146100f8578063174dea7114610123578063252dba421461015357806327e86d6e14610184575b600080fd5b34801561010457600080fd5b5061010d6103ef565b60405161011a9190610c0a565b60405180910390f35b61013d60048036038101906101389190610c94565b6103f7565b60405161014a9190610e94565b60405180910390f35b61016d60048036038101906101689190610f0c565b610615565b60405161017b92919061101b565b60405180910390f35b34801561019057600080fd5b506101996107ab565b6040516101a69190611064565b60405180910390f35b3480156101bb57600080fd5b506101c46107b7565b6040516101d19190610c0a565b60405180910390f35b6101f460048036038101906101ef91906110ab565b6107bf565b6040516102039392919061110b565b60405180910390f35b34801561021857600080fd5b506102216107e1565b60405161022e9190610c0a565b60405180910390f35b34801561024357600080fd5b5061024c6107e9565b6040516102599190610c0a565b60405180910390f35b34801561026e57600080fd5b50610289600480360381019061028491906111a7565b6107f1565b6040516102969190610c0a565b60405180910390f35b3480156102ab57600080fd5b506102b4610812565b6040516102c19190610c0a565b60405180910390f35b6102e460048036038101906102df919061122a565b61081a565b6040516102f19190610e94565b60405180910390f35b34801561030657600080fd5b5061030f6109e4565b60405161031c9190610c0a565b60405180910390f35b34801561033157600080fd5b5061033a6109ec565b6040516103479190611286565b60405180910390f35b61036a600480360381019061036591906110ab565b6109f4565b6040516103779190610e94565b60405180910390f35b61039a60048036038101906103959190610f0c565b610ba6565b6040516103a99392919061110b565b60405180910390f35b3480156103be57600080fd5b506103d960048036038101906103d491906112cd565b610bca565b6040516103e69190611064565b60405180910390f35b600042905090565b60606000808484905090508067ffffffffffffffff81111561041c5761041b6112fa565b5b60405190808252806020026020018201604052801561045557816020015b610442610bd5565b81526020019060019003908161043a5790505b5092503660005b828110156105c957600085828151811061047957610478611329565b5b6020026020010151905087878381811061049657610495611329565b5b90506020028101906104a89190611367565b925060008360400135905080860195508360000160208101906104cb91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16818580606001906104f2919061138f565b604051610500929190611431565b60006040518083038185875af1925050503d806000811461053d576040519150601f19603f3d011682016040523d82523d6000602084013e610542565b606091505b5083600001846020018290528215151515815250505081516020850135176105bc577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260846000fd5b826001019250505061045c565b5082341461060c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610603906114a7565b60405180910390fd5b50505092915050565b6000606043915060008484905090508067ffffffffffffffff81111561063e5761063d6112fa565b5b60405190808252806020026020018201604052801561067157816020015b606081526020019060019003908161065c5790505b5091503660005b828110156107a157600087878381811061069557610694611329565b5b90506020028101906106a791906114c7565b92508260000160208101906106bc91906111a7565b73ffffffffffffffffffffffffffffffffffffffff168380602001906106e2919061138f565b6040516106f0929190611431565b6000604051808303816000865af19150503d806000811461072d576040519150601f19603f3d011682016040523d82523d6000602084013e610732565b606091505b5086848151811061074657610745611329565b5b60200260200101819052819250505080610795576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161078c9061153b565b60405180910390fd5b81600101915050610678565b5050509250929050565b60006001430340905090565b600046905090565b6000806060439250434091506107d68686866109f4565b905093509350939050565b600048905090565b600043905090565b60008173ffffffffffffffffffffffffffffffffffffffff16319050919050565b600044905090565b606060008383905090508067ffffffffffffffff81111561083e5761083d6112fa565b5b60405190808252806020026020018201604052801561087757816020015b610864610bd5565b81526020019060019003908161085c5790505b5091503660005b828110156109db57600084828151811061089b5761089a611329565b5b602002602001015190508686838181106108b8576108b7611329565b5b90506020028101906108ca919061155b565b92508260000160208101906108df91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060400190610905919061138f565b604051610913929190611431565b6000604051808303816000865af19150503d8060008114610950576040519150601f19603f3d011682016040523d82523d6000602084013e610955565b606091505b5082600001836020018290528215151515815250505080516020840135176109cf577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260646000fd5b8160010191505061087e565b50505092915050565b600045905090565b600041905090565b606060008383905090508067ffffffffffffffff811115610a1857610a176112fa565b5b604051908082528060200260200182016040528015610a5157816020015b610a3e610bd5565b815260200190600190039081610a365790505b5091503660005b82811015610b9c576000848281518110610a7557610a74611329565b5b60200260200101519050868683818110610a9257610a91611329565b5b9050602002810190610aa491906114c7565b9250826000016020810190610ab991906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060200190610adf919061138f565b604051610aed929190611431565b6000604051808303816000865af19150503d8060008114610b2a576040519150601f19603f3d011682016040523d82523d6000602084013e610b2f565b606091505b508260000183602001829052821515151581525050508715610b90578060000151610b8f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b869061153b565b60405180910390fd5b5b81600101915050610a58565b5050509392505050565b6000806060610bb7600186866107bf565b8093508194508295505050509250925092565b600081409050919050565b6040518060400160405280600015158152602001606081525090565b6000819050919050565b610c0481610bf1565b82525050565b6000602082019050610c1f6000830184610bfb565b92915050565b600080fd5b600080fd5b600080fd5b600080fd5b600080fd5b60008083601f840112610c5457610c53610c2f565b5b8235905067ffffffffffffffff811115610c7157610c70610c34565b5b602083019150836020820283011115610c8d57610c8c610c39565b5b9250929050565b60008060208385031215610cab57610caa610c25565b5b600083013567ffffffffffffffff811115610cc957610cc8610c2a565b5b610cd585828601610c3e565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60008115159050919050565b610d2281610d0d565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610d62578082015181840152602081019050610d47565b83811115610d71576000848401525b50505050565b6000601f19601f8301169050919050565b6000610d9382610d28565b610d9d8185610d33565b9350610dad818560208601610d44565b610db681610d77565b840191505092915050565b6000604083016000830151610dd96000860182610d19565b5060208301518482036020860152610df18282610d88565b9150508091505092915050565b6000610e0a8383610dc1565b905092915050565b6000602082019050919050565b6000610e2a82610ce1565b610e348185610cec565b935083602082028501610e4685610cfd565b8060005b85811015610e825784840389528151610e638582610dfe565b9450610e6e83610e12565b925060208a01995050600181019050610e4a565b50829750879550505050505092915050565b60006020820190508181036000830152610eae8184610e1f565b905092915050565b60008083601f840112610ecc57610ecb610c2f565b5b8235905067ffffffffffffffff811115610ee957610ee8610c34565b5b602083019150836020820283011115610f0557610f04610c39565b5b9250929050565b60008060208385031215610f2357610f22610c25565b5b600083013567ffffffffffffffff811115610f4157610f40610c2a565b5b610f4d85828601610eb6565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b6000610f918383610d88565b905092915050565b6000602082019050919050565b6000610fb182610f59565b610fbb8185610f64565b935083602082028501610fcd85610f75565b8060005b858110156110095784840389528151610fea8582610f85565b9450610ff583610f99565b925060208a01995050600181019050610fd1565b50829750879550505050505092915050565b60006040820190506110306000830185610bfb565b81810360208301526110428184610fa6565b90509392505050565b6000819050919050565b61105e8161104b565b82525050565b60006020820190506110796000830184611055565b92915050565b61108881610d0d565b811461109357600080fd5b50565b6000813590506110a58161107f565b92915050565b6000806000604084860312156110c4576110c3610c25565b5b60006110d286828701611096565b935050602084013567ffffffffffffffff8111156110f3576110f2610c2a565b5b6110ff86828701610eb6565b92509250509250925092565b60006060820190506111206000830186610bfb565b61112d6020830185611055565b818103604083015261113f8184610e1f565b9050949350505050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061117482611149565b9050919050565b61118481611169565b811461118f57600080fd5b50565b6000813590506111a18161117b565b92915050565b6000602082840312156111bd576111bc610c25565b5b60006111cb84828501611192565b91505092915050565b60008083601f8401126111ea576111e9610c2f565b5b8235905067ffffffffffffffff81111561120757611206610c34565b5b60208301915083602082028301111561122357611222610c39565b5b9250929050565b6000806020838503121561124157611240610c25565b5b600083013567ffffffffffffffff81111561125f5761125e610c2a565b5b61126b858286016111d4565b92509250509250929050565b61128081611169565b82525050565b600060208201905061129b6000830184611277565b92915050565b6112aa81610bf1565b81146112b557600080fd5b50565b6000813590506112c7816112a1565b92915050565b6000602082840312156112e3576112e2610c25565b5b60006112f1848285016112b8565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600080fd5b600080fd5b600080fd5b60008235600160800383360303811261138357611382611358565b5b80830191505092915050565b600080833560016020038436030381126113ac576113ab611358565b5b80840192508235915067ffffffffffffffff8211156113ce576113cd61135d565b5b6020830192506001820236038313156113ea576113e9611362565b5b509250929050565b600081905092915050565b82818337600083830152505050565b600061141883856113f2565b93506114258385846113fd565b82840190509392505050565b600061143e82848661140c565b91508190509392505050565b600082825260208201905092915050565b7f4d756c746963616c6c333a2076616c7565206d69736d61746368000000000000600082015250565b6000611491601a8361144a565b915061149c8261145b565b602082019050919050565b600060208201905081810360008301526114c081611484565b9050919050565b6000823560016040038336030381126114e3576114e2611358565b5b80830191505092915050565b7f4d756c746963616c6c333a2063616c6c206661696c6564000000000000000000600082015250565b600061152560178361144a565b9150611530826114ef565b602082019050919050565b6000602082019050818103600083015261155481611518565b9050919050565b60008235600160600383360303811261157757611576611358565b5b8083019150509291505056fea264697066735822122020c1bc9aacf8e4a6507193432a895a8e77094f45a1395583f07b24e860ef06cd64736f6c634300080c0033";class kf extends K{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class rS extends K{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id} â€“ ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id} â€“ ${e.name}`],name:"ChainMismatchError"})}}class sS extends K{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class pb extends K{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}class Rl extends K{constructor({chainId:e}){super(typeof e=="number"?`Chain ID "${e}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}const Mp="/docs/contract/encodeDeployData";function Dh(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new AA({docsPath:Mp});if(!("inputs"in s))throw new $g({docsPath:Mp});if(!s.inputs||s.inputs.length===0)throw new $g({docsPath:Mp});const i=xs(s.inputs,n);return Sn([r,i])}function ga({blockNumber:t,chain:e,contract:n}){const r=e?.contracts?.[n];if(!r)throw new kf({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new kf({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function iS(t,{docsPath:e,...n}){const r=(()=>{const s=vh(t,n);return s instanceof jc?t:s})();return new Ky(r,{docsPath:e,...n})}function gb(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const Lp=new Map;function oS({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const l=c();o();const d=l.map(({args:f})=>f);d.length!==0&&t(d).then(f=>{s&&Array.isArray(f)&&f.sort(s);for(let h=0;h<l.length;h++){const{resolve:g}=l[h];g?.([f[h],f])}}).catch(f=>{for(let h=0;h<l.length;h++){const{reject:g}=l[h];g?.(f)}})},o=()=>Lp.delete(e),a=()=>c().map(({args:l})=>l),c=()=>Lp.get(e)||[],u=l=>Lp.set(e,[...c(),l]);return{flush:o,async schedule(l){const{promise:d,resolve:f,reject:h}=gb();return n?.([...a(),l])&&i(),c().length>0?(u({args:l,resolve:f,reject:h}),d):(u({args:l,resolve:f,reject:h}),setTimeout(i,r),d)}}}async function zc(t,e){const{account:n=t.account,authorizationList:r,batch:s=!!t.batch?.multicall,blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",accessList:a,blobs:c,blockOverrides:u,code:l,data:d,factory:f,factoryData:h,gas:g,gasPrice:p,maxFeePerBlobGas:y,maxFeePerGas:E,maxPriorityFeePerGas:A,nonce:w,to:C,value:_,stateOverride:P,...k}=e,U=n?Qt(n):void 0;if(l&&(f||h))throw new K("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(l&&C)throw new K("Cannot provide both `code` & `to` as parameters.");const $=l&&d,L=f&&h&&C&&d,M=$||L,D=$?aS({code:l,data:d}):L?KR({data:d,factory:f,factoryData:h,to:C}):d;try{ha(e);const O=(typeof i=="bigint"?ee(i):void 0)||o,m=u?X2(u):void 0,b=Jy(P),v=t.chain?.formatters?.transactionRequest?.format,I=(v||qc)({...Ch(k,{format:v}),accessList:a,account:U,authorizationList:r,blobs:c,data:D,gas:g,gasPrice:p,maxFeePerBlobGas:y,maxFeePerGas:E,maxPriorityFeePerGas:A,nonce:w,to:M?void 0:C,value:_},"call");if(s&&WR({request:I})&&!b&&!m)try{return await VR(t,{...I,blockNumber:i,blockTag:o})}catch(F){if(!(F instanceof pb)&&!(F instanceof kf))throw F}const x=(()=>{const F=[I,O];return b&&m?[...F,b,m]:b?[...F,b]:m?[...F,{},m]:F})(),B=await t.request({method:"eth_call",params:x});return B==="0x"?{data:void 0}:{data:B}}catch(T){const O=GR(T),{offchainLookup:m,offchainLookupSignature:b}=await kt(async()=>{const{offchainLookup:v,offchainLookupSignature:S}=await Promise.resolve().then(()=>Gk);return{offchainLookup:v,offchainLookupSignature:S}},void 0);if(t.ccipRead!==!1&&O?.slice(0,10)===b&&C)return{data:await m(t,{data:O,to:C})};throw M&&O?.slice(0,10)==="0x101bb98d"?new h2({factory:f}):iS(T,{...e,account:U,chain:t.chain})}}function WR({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(HR)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function VR(t,e){const{batchSize:n=1024,deployless:r=!1,wait:s=0}=typeof t.batch?.multicall=="object"?t.batch.multicall:{},{blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",data:a,to:c}=e,u=(()=>{if(r)return null;if(e.multicallAddress)return e.multicallAddress;if(t.chain)return ga({blockNumber:i,chain:t.chain,contract:"multicall3"});throw new pb})(),d=(typeof i=="bigint"?ee(i):void 0)||o,{schedule:f}=oS({id:`${t.uid}.${d}`,wait:s,shouldSplitBatch(p){return p.reduce((E,{data:A})=>E+(A.length-2),0)>n*2},fn:async p=>{const y=p.map(w=>({allowFailure:!0,callData:w.data,target:w.to})),E=lr({abi:rl,args:[y],functionName:"aggregate3"}),A=await t.request({method:"eth_call",params:[{...u===null?{data:aS({code:hb,data:E})}:{to:u,data:E}},d]});return lo({abi:rl,args:[y],functionName:"aggregate3",data:A||"0x"})}}),[{returnData:h,success:g}]=await f({data:a,to:c});if(!g)throw new Il({data:h});return h==="0x"?{data:void 0}:{data:h}}function aS(t){const{code:e,data:n}=t;return Dh({abi:Iy(["constructor(bytes, bytes)"]),bytecode:fb,args:[e,n]})}function KR(t){const{data:e,factory:n,factoryData:r,to:s}=t;return Dh({abi:Iy(["constructor(address, bytes, address, bytes)"]),bytecode:nS,args:[s,e,n,r]})}function GR(t){if(!(t instanceof K))return;const e=t.walk();return typeof e?.data=="object"?e.data?.data:e.data}async function Ir(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=lr({abi:n,args:s,functionName:i});try{const{data:c}=await ve(t,zc,"call")({...o,data:a,to:r});return lo({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw so(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}async function YR(t,e){const{abi:n,address:r,args:s,dataSuffix:i,functionName:o,...a}=e,c=a.account?Qt(a.account):t.account,u=lr({abi:n,args:s,functionName:o});try{const{data:l}=await ve(t,zc,"call")({batch:!1,data:`${u}${i?i.replace("0x",""):""}`,to:r,...a,account:c}),d=lo({abi:n,args:s,functionName:o,data:l||"0x"}),f=n.filter(h=>"name"in h&&h.name===e.functionName);return{result:d,request:{abi:f,address:r,args:s,dataSuffix:i,functionName:o,...a,account:c}}}catch(l){throw so(l,{abi:n,address:r,args:s,docsPath:"/docs/contract/simulateContract",functionName:o,sender:c?.address})}}const Fp=new Map,S1=new Map;let ZR=0;function gi(t,e,n){const r=++ZR,s=()=>Fp.get(t)||[],i=()=>{const l=s();Fp.set(t,l.filter(d=>d.id!==r))},o=()=>{const l=s();if(!l.some(f=>f.id===r))return;const d=S1.get(t);if(l.length===1&&d){const f=d();f instanceof Promise&&f.catch(()=>{})}i()},a=s();if(Fp.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const l in e)c[l]=((...d)=>{const f=s();if(f.length!==0)for(const h of f)h.fns[l]?.(...d)});const u=n(c);return typeof u=="function"&&S1.set(t,u),o}async function $f(t){return new Promise(e=>setTimeout(e,t))}function Hc(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await n?.(a)??r;await $f(c);const u=async()=>{s&&(await t({unpoll:i}),await $f(r),u())};u()})(),i}const JR=new Map,XR=new Map;function QR(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,JR),r=e(t,XR);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function cS(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=QR(e),s=r.response.get();if(s&&n>0&&Date.now()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const ek=t=>`blockNumber.${t}`;async function kl(t,{cacheTime:e=t.cacheTime}={}){const n=await cS(()=>t.request({method:"eth_blockNumber"}),{cacheKey:ek(t.uid),cacheTime:e});return BigInt(n)}async function Uh(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>Is(i));return!("abi"in e)||!e.abi?s:Oh({abi:e.abi,logs:s,strict:n})}async function Bh(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}function tk(t,e){const{abi:n,address:r,args:s,batch:i=!0,eventName:o,fromBlock:a,onError:c,onLogs:u,poll:l,pollingInterval:d=t.pollingInterval,strict:f}=e;return(typeof l<"u"?l:typeof a=="bigint"?!0:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc")))?(()=>{const y=f??!1,E=Et(["watchContractEvent",r,s,i,t.uid,o,d,y,a]);return gi(E,{onLogs:u,onError:c},A=>{let w;a!==void 0&&(w=a-1n);let C,_=!1;const P=Hc(async()=>{if(!_){try{C=await ve(t,KA,"createContractEventFilter")({abi:n,address:r,args:s,eventName:o,strict:y,fromBlock:a})}catch{}_=!0;return}try{let k;if(C)k=await ve(t,Uh,"getFilterChanges")({filter:C});else{const U=await ve(t,kl,"getBlockNumber")({});w&&w<U?k=await ve(t,U2,"getContractEvents")({abi:n,address:r,args:s,eventName:o,fromBlock:w+1n,toBlock:U,strict:y}):k=[],w=U}if(k.length===0)return;if(i)A.onLogs(k);else for(const U of k)A.onLogs([U])}catch(k){C&&k instanceof ro&&(_=!1),A.onError?.(k)}},{emitOnBegin:!0,interval:d});return async()=>{C&&await ve(t,Bh,"uninstallFilter")({filter:C}),P()}})})():(()=>{const y=f??!1,E=Et(["watchContractEvent",r,s,i,t.uid,o,d,y]);let A=!0,w=()=>A=!1;return gi(E,{onLogs:u,onError:c},C=>((async()=>{try{const _=(()=>{if(t.transport.type==="fallback"){const U=t.transport.transports.find($=>$.config.type==="webSocket"||$.config.type==="ipc");return U?U.value:t.transport}return t.transport})(),P=o?Lc({abi:n,eventName:o,args:s}):[],{unsubscribe:k}=await _.subscribe({params:["logs",{address:r,topics:P}],onData(U){if(!A)return;const $=U.result;try{const{eventName:L,args:M}=Ph({abi:n,data:$.data,topics:$.topics,strict:f}),D=Is($,{args:M,eventName:L});C.onLogs([D])}catch(L){let M,D;if(L instanceof dc||L instanceof Cl){if(f)return;M=L.abiItem.name,D=L.abiItem.inputs?.some(O=>!("name"in O&&O.name))}const T=Is($,{args:D?[]:{},eventName:M});C.onLogs([T])}},onError(U){C.onError?.(U)}});w=k,A||w()}catch(_){c?.(_)}})(),()=>w()))})()}class Mh extends K{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class jp extends K{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function uS({chain:t,currentChainId:e}){if(!t)throw new sS;if(e!==t.id)throw new rS({chain:t,currentChainId:e})}function nk(t,{docsPath:e,...n}){const r=(()=>{const s=vh(t,n);return s instanceof jc?t:s})();return new l2(r,{docsPath:e,...n})}async function lS(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const qp=new _l(128);async function dS(t,e){const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,type:g,value:p,...y}=e;if(typeof n>"u")throw new Mh({docsPath:"/docs/actions/wallet/sendTransaction"});const E=n?Qt(n):null;try{ha(e);const A=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await Yy({authorization:i[0]}).catch(()=>{throw new K("`to` is required. Could not infer from `authorizationList`.")})})();if(E?.type==="json-rpc"||E===null){let w;r!==null&&(w=await ve(t,Th,"getChainId")({}),uS({currentChainId:w,chain:r}));const C=t.chain?.formatters?.transactionRequest?.format,P=(C||qc)({...Ch(y,{format:C}),accessList:s,account:E,authorizationList:i,blobs:o,chainId:w,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,to:A,type:g,value:p},"sendTransaction"),k=qp.get(t.uid),U=k?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:U,params:[P]},{retryCount:0})}catch($){if(k===!1)throw $;const L=$;if(L.name==="InvalidInputRpcError"||L.name==="InvalidParamsRpcError"||L.name==="MethodNotFoundRpcError"||L.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[P]},{retryCount:0}).then(M=>(qp.set(t.uid,!0),M)).catch(M=>{const D=M;throw D.name==="MethodNotFoundRpcError"||D.name==="MethodNotSupportedRpcError"?(qp.set(t.uid,!1),L):D});throw L}}if(E?.type==="local"){const w=await ve(t,Nh,"prepareTransactionRequest")({account:E,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,nonceManager:E.nonceManager,parameters:[...D2,"sidecars"],type:g,value:p,...y,to:A}),C=r?.serializers?.transaction,_=await E.signTransaction(w,{serializer:C});return await ve(t,lS,"sendRawTransaction")({serializedTransaction:_})}throw E?.type==="smart"?new jp({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new jp({docsPath:"/docs/actions/wallet/sendTransaction",type:E?.type})}catch(A){throw A instanceof jp?A:nk(A,{...e,account:E,chain:e.chain||void 0})}}async function Df(t,e){return Df.internal(t,dS,"sendTransaction",e)}(function(t){async function e(n,r,s,i){const{abi:o,account:a=n.account,address:c,args:u,dataSuffix:l,functionName:d,...f}=i;if(typeof a>"u")throw new Mh({docsPath:"/docs/contract/writeContract"});const h=a?Qt(a):null,g=lr({abi:o,args:u,functionName:d});try{return await ve(n,r,s)({data:`${g}${l?l.replace("0x",""):""}`,to:c,account:h,...f})}catch(p){throw so(p,{abi:o,address:c,args:u,docsPath:"/docs/contract/writeContract",functionName:d,sender:h?.address})}}t.internal=e})(Df||(Df={}));class fS extends K{constructor(e){super(`Call bundle failed with status: ${e.statusCode}`,{name:"BundleFailedError"}),Object.defineProperty(this,"result",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.result=e}}function Oc(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:u})=>{const l=typeof e=="function"?e({count:a,error:u}):e;l&&await $f(l),o({count:a+1})};try{const u=await t();s(u)}catch(u){if(a<n&&await r({count:a,error:u}))return c({error:u});i(u)}};o()})}const hS={"0x0":"reverted","0x1":"success"};function Lh(t,e){const n={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(r=>Is(r)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?ar(t.transactionIndex):null,status:t.status?hS[t.status]:null,type:t.type?Qy[t.type]||t.type:null};return t.blobGasPrice&&(n.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(n.blobGasUsed=BigInt(t.blobGasUsed)),n}const pS=Zy("transactionReceipt",Lh),rk="0x5792579257925792579257925792579257925792579257925792579257925792",sk=ee(0,{size:32});async function ik(t,e){async function n(l){if(l.endsWith(rk.slice(2))){const f=yn(Ef(l,-64,-32)),h=Ef(l,0,-64).slice(2).match(/.{1,64}/g),g=await Promise.all(h.map(y=>sk.slice(2)!==y?t.request({method:"eth_getTransactionReceipt",params:[`0x${y}`]},{dedupe:!0}):void 0)),p=g.some(y=>y===null)?100:g.every(y=>y?.status==="0x1")?200:g.every(y=>y?.status==="0x0")?500:600;return{atomic:!1,chainId:ar(f),receipts:g.filter(Boolean),status:p,version:"2.0.0"}}return t.request({method:"wallet_getCallsStatus",params:[l]})}const{atomic:r=!1,chainId:s,receipts:i,version:o="2.0.0",...a}=await n(e.id),[c,u]=(()=>{const l=a.status;return l>=100&&l<200?["pending",l]:l>=200&&l<300?["success",l]:l>=300&&l<700?["failure",l]:l==="CONFIRMED"?["success",200]:l==="PENDING"?["pending",100]:[void 0,l]})();return{...a,atomic:r,chainId:s?ar(s):void 0,receipts:i?.map(l=>({...l,blockNumber:zt(l.blockNumber),gasUsed:zt(l.gasUsed),status:hS[l.status]}))??[],statusCode:u,status:c,version:o}}async function Vte(t,e){const{id:n,pollingInterval:r=t.pollingInterval,status:s=({statusCode:p})=>p===200||p>=300,retryCount:i=4,retryDelay:o=({count:p})=>~~(1<<p)*200,timeout:a=6e4,throwOnFailure:c=!1}=e,u=Et(["waitForCallsStatus",t.uid,n]),{promise:l,resolve:d,reject:f}=gb();let h;const g=gi(u,{resolve:d,reject:f},p=>{const y=Hc(async()=>{const E=A=>{clearTimeout(h),y(),A(),g()};try{const A=await Oc(async()=>{const w=await ve(t,ik,"getCallsStatus")({id:n});if(c&&w.status==="failure")throw new fS(w);return w},{retryCount:i,delay:o});if(!s(A))return;E(()=>p.resolve(A))}catch(A){E(()=>p.reject(A))}},{interval:r,emitOnBegin:!0});return y});return h=a?setTimeout(()=>{g(),clearTimeout(h),f(new gS({id:n}))},a):void 0,await l}class gS extends K{constructor({id:e}){super(`Timed out while waiting for call bundle with id "${e}" to be confirmed.`,{name:"WaitForCallsStatusTimeoutError"})}}const Wg=256;let rd=Wg,sd;function mS(t=11){if(!sd||rd+t>Wg*2){sd="",rd=0;for(let e=0;e<Wg;e++)sd+=(256+Math.random()*256|0).toString(16).substring(1)}return sd.substring(rd,rd+++t)}function Fh(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=t.experimental_blockTag??(typeof n?.experimental_preconfirmationTime=="number"?"pending":void 0),c=n?.blockTime??12e3,u=Math.min(Math.max(Math.floor(c/2),500),4e3),l=t.pollingInterval??u,d=t.cacheTime??l,f=t.account?Qt(t.account):void 0,{config:h,request:g,value:p}=t.transport({chain:n,pollingInterval:l}),y={...h,...p},E={account:f,batch:e,cacheTime:d,ccipRead:r,chain:n,key:s,name:i,pollingInterval:l,request:g,transport:y,type:o,uid:mS(),...a?{experimental_blockTag:a}:{}};function A(w){return C=>{const _=C(w);for(const k in E)delete _[k];const P={...w,..._};return Object.assign(P,{extend:A(P)})}}return Object.assign(E,{extend:A(E)})}function mb(t){if(!(t instanceof K))return!1;const e=t.walk(n=>n instanceof vf);return e instanceof vf?e.data?.errorName==="HttpError"||e.data?.errorName==="ResolverError"||e.data?.errorName==="ResolverNotContract"||e.data?.errorName==="ResolverNotFound"||e.data?.errorName==="ReverseAddressMismatch"||e.data?.errorName==="UnsupportedResolverProfile":!1}function yS(t){const{abi:e,data:n}=t,r=to(n,0,4),s=e.find(i=>i.type==="function"&&r===Jo(Yr(i)));if(!s)throw new xA(r,{docsPath:"/docs/contract/decodeFunctionData"});return{functionName:s.name,args:"inputs"in s&&s.inputs&&s.inputs.length>0?Fc(s.inputs,to(n,4)):void 0}}const zp="/docs/contract/encodeErrorResult";function Vg(t){const{abi:e,errorName:n,args:r}=t;let s=e[0];if(n){const c=co({abi:e,args:r,name:n});if(!c)throw new Dg(n,{docsPath:zp});s=c}if(s.type!=="error")throw new Dg(void 0,{docsPath:zp});const i=Yr(s),o=Jo(i);let a="0x";if(r&&r.length>0){if(!s.inputs)throw new TA(s.name,{docsPath:zp});a=xs(s.inputs,r)}return Sn([o,a])}const Hp="/docs/contract/encodeFunctionResult";function bS(t){const{abi:e,functionName:n,result:r}=t;let s=e[0];if(n){const o=co({abi:e,name:n});if(!o)throw new Zo(n,{docsPath:Hp});s=o}if(s.type!=="function")throw new Zo(void 0,{docsPath:Hp});if(!s.outputs)throw new Oy(s.name,{docsPath:Hp});const i=(()=>{if(s.outputs.length===0)return[];if(s.outputs.length===1)return[r];if(Array.isArray(r))return r;throw new ky(r)})();return xs(s.outputs,i)}const $l="x-batch-gateway:true";async function wS(t){const{data:e,ccipRequest:n}=t,{args:[r]}=yS({abi:zg,data:e}),s=[],i=[];return await Promise.all(r.map(async(o,a)=>{try{i[a]=o.urls.includes($l)?await wS({data:o.data,ccipRequest:n}):await n(o),s[a]=!1}catch(c){s[a]=!0,i[a]=ok(c)}})),bS({abi:zg,functionName:"query",result:[s,i]})}function ok(t){return t.name==="HttpRequestError"&&t.status?Vg({abi:zg,errorName:"HttpError",args:[t.status,t.shortMessage]}):Vg({abi:[YA],errorName:"Error",args:["shortMessage"in t?t.shortMessage:t.message]})}function ES(t){if(t.length!==66||t.indexOf("[")!==0||t.indexOf("]")!==65)return null;const e=`0x${t.slice(1,65)}`;return Ar(e)?e:null}function Uf(t){let e=new Uint8Array(32).fill(0);if(!t)return Ct(e);const n=t.split(".");for(let r=n.length-1;r>=0;r-=1){const s=ES(n[r]),i=s?fa(s):Ht(Ki(n[r]),"bytes");e=Ht(Sr([e,i]),"bytes")}return Ct(e)}function ak(t){return`[${t.slice(2)}]`}function vS(t){const e=new Uint8Array(32).fill(0);return t?ES(t)||Ht(Ki(t)):Ct(e)}function yb(t){const e=t.replace(/^\.|\.$/gm,"");if(e.length===0)return new Uint8Array(1);const n=new Uint8Array(Ki(e).byteLength+2);let r=0;const s=e.split(".");for(let i=0;i<s.length;i++){let o=Ki(s[i]);o.byteLength>255&&(o=Ki(ak(vS(s[i])))),n[r]=o.length,n.set(o,r+1),r+=o.length+1}return n.byteLength!==r+1?n.slice(0,r+1):n}async function ck(t,e){const{blockNumber:n,blockTag:r,coinType:s,name:i,gatewayUrls:o,strict:a}=e,{chain:c}=t,u=(()=>{if(e.universalResolverAddress)return e.universalResolverAddress;if(!c)throw new Error("client chain not configured. universalResolverAddress is required.");return ga({blockNumber:n,chain:c,contract:"ensUniversalResolver"})})(),l=c?.ensTlds;if(l&&!l.some(f=>i.endsWith(f)))return null;const d=s!=null?[Uf(i),BigInt(s)]:[Uf(i)];try{const f=lr({abi:A1,functionName:"addr",args:d}),h={address:u,abi:eS,functionName:"resolveWithGateways",args:[Jt(yb(i)),f,o??[$l]],blockNumber:n,blockTag:r},p=await ve(t,Ir,"readContract")(h);if(p[0]==="0x")return null;const y=lo({abi:A1,args:d,functionName:"addr",data:p[0]});return y==="0x"||yn(y)==="0x00"?null:y}catch(f){if(a)throw f;if(mb(f))return null;throw f}}class uk extends K{constructor({data:e}){super("Unable to extract image from metadata. The metadata may be malformed or invalid.",{metaMessages:["- Metadata must be a JSON object with at least an `image`, `image_url` or `image_data` property.","",`Provided data: ${JSON.stringify(e)}`],name:"EnsAvatarInvalidMetadataError"})}}class Ba extends K{constructor({reason:e}){super(`ENS NFT avatar URI is invalid. ${e}`,{name:"EnsAvatarInvalidNftUriError"})}}class jh extends K{constructor({uri:e}){super(`Unable to resolve ENS avatar URI "${e}". The URI may be malformed, invalid, or does not respond with a valid image.`,{name:"EnsAvatarUriResolutionError"})}}class CS extends K{constructor({namespace:e}){super(`ENS NFT avatar namespace "${e}" is not supported. Must be "erc721" or "erc1155".`,{name:"EnsAvatarUnsupportedNamespaceError"})}}const lk=/(?<protocol>https?:\/\/[^/]*|ipfs:\/|ipns:\/|ar:\/)?(?<root>\/)?(?<subpath>ipfs\/|ipns\/)?(?<target>[\w\-.]+)(?<subtarget>\/.*)?/,dk=/^(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})(\/(?<target>[\w\-.]+))?(?<subtarget>\/.*)?$/,fk=/^data:([a-zA-Z\-/+]*);base64,([^"].*)/,hk=/^data:([a-zA-Z\-/+]*)?(;[a-zA-Z0-9].*?)?(,)/;async function pk(t){try{const e=await fetch(t,{method:"HEAD"});return e.status===200?e.headers.get("content-type")?.startsWith("image/"):!1}catch(e){return typeof e=="object"&&typeof e.response<"u"||!Object.hasOwn(globalThis,"Image")?!1:new Promise(n=>{const r=new Image;r.onload=()=>{n(!0)},r.onerror=()=>{n(!1)},r.src=t})}}function I1(t,e){return t?t.endsWith("/")?t.slice(0,-1):t:e}function _S({uri:t,gatewayUrls:e}){const n=fk.test(t);if(n)return{uri:t,isOnChain:!0,isEncoded:n};const r=I1(e?.ipfs,"https://ipfs.io"),s=I1(e?.arweave,"https://arweave.net"),i=t.match(lk),{protocol:o,subpath:a,target:c,subtarget:u=""}=i?.groups||{},l=o==="ipns:/"||a==="ipns/",d=o==="ipfs:/"||a==="ipfs/"||dk.test(t);if(t.startsWith("http")&&!l&&!d){let h=t;return e?.arweave&&(h=t.replace(/https:\/\/arweave.net/g,e?.arweave)),{uri:h,isOnChain:!1,isEncoded:!1}}if((l||d)&&c)return{uri:`${r}/${l?"ipns":"ipfs"}/${c}${u}`,isOnChain:!1,isEncoded:!1};if(o==="ar:/"&&c)return{uri:`${s}/${c}${u||""}`,isOnChain:!1,isEncoded:!1};let f=t.replace(hk,"");if(f.startsWith("<svg")&&(f=`data:image/svg+xml;base64,${btoa(f)}`),f.startsWith("data:")||f.startsWith("{"))return{uri:f,isOnChain:!0,isEncoded:!1};throw new jh({uri:t})}function AS(t){if(typeof t!="object"||!("image"in t)&&!("image_url"in t)&&!("image_data"in t))throw new uk({data:t});return t.image||t.image_url||t.image_data}async function gk({gatewayUrls:t,uri:e}){try{const n=await fetch(e).then(s=>s.json());return await bb({gatewayUrls:t,uri:AS(n)})}catch{throw new jh({uri:e})}}async function bb({gatewayUrls:t,uri:e}){const{uri:n,isOnChain:r}=_S({uri:e,gatewayUrls:t});if(r||await pk(n))return n;throw new jh({uri:e})}function mk(t){let e=t;e.startsWith("did:nft:")&&(e=e.replace("did:nft:","").replace(/_/g,"/"));const[n,r,s]=e.split("/"),[i,o]=n.split(":"),[a,c]=r.split(":");if(!i||i.toLowerCase()!=="eip155")throw new Ba({reason:"Only EIP-155 supported"});if(!o)throw new Ba({reason:"Chain ID not found"});if(!c)throw new Ba({reason:"Contract address not found"});if(!s)throw new Ba({reason:"Token ID not found"});if(!a)throw new Ba({reason:"ERC namespace not found"});return{chainID:Number.parseInt(o,10),namespace:a.toLowerCase(),contractAddress:c,tokenID:s}}async function yk(t,{nft:e}){if(e.namespace==="erc721")return Ir(t,{address:e.contractAddress,abi:[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"tokenURI",args:[BigInt(e.tokenID)]});if(e.namespace==="erc1155")return Ir(t,{address:e.contractAddress,abi:[{name:"uri",type:"function",stateMutability:"view",inputs:[{name:"_id",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"uri",args:[BigInt(e.tokenID)]});throw new CS({namespace:e.namespace})}async function bk(t,{gatewayUrls:e,record:n}){return/eip155:/i.test(n)?wk(t,{gatewayUrls:e,record:n}):bb({uri:n,gatewayUrls:e})}async function wk(t,{gatewayUrls:e,record:n}){const r=mk(n),s=await yk(t,{nft:r}),{uri:i,isOnChain:o,isEncoded:a}=_S({uri:s,gatewayUrls:e});if(o&&(i.includes("data:application/json;base64,")||i.startsWith("{"))){const u=a?atob(i.replace("data:application/json;base64,","")):i,l=JSON.parse(u);return bb({uri:AS(l),gatewayUrls:e})}let c=r.tokenID;return r.namespace==="erc1155"&&(c=c.replace("0x","").padStart(64,"0")),gk({gatewayUrls:e,uri:i.replace(/(?:0x)?{id}/,c)})}async function SS(t,e){const{blockNumber:n,blockTag:r,key:s,name:i,gatewayUrls:o,strict:a}=e,{chain:c}=t,u=(()=>{if(e.universalResolverAddress)return e.universalResolverAddress;if(!c)throw new Error("client chain not configured. universalResolverAddress is required.");return ga({blockNumber:n,chain:c,contract:"ensUniversalResolver"})})(),l=c?.ensTlds;if(l&&!l.some(d=>i.endsWith(d)))return null;try{const d={address:u,abi:eS,args:[Jt(yb(i)),lr({abi:_1,functionName:"text",args:[Uf(i),s]}),o??[$l]],functionName:"resolveWithGateways",blockNumber:n,blockTag:r},h=await ve(t,Ir,"readContract")(d);if(h[0]==="0x")return null;const g=lo({abi:_1,functionName:"text",data:h[0]});return g===""?null:g}catch(d){if(a)throw d;if(mb(d))return null;throw d}}async function Ek(t,{blockNumber:e,blockTag:n,assetGatewayUrls:r,name:s,gatewayUrls:i,strict:o,universalResolverAddress:a}){const c=await ve(t,SS,"getEnsText")({blockNumber:e,blockTag:n,key:"avatar",name:s,universalResolverAddress:a,gatewayUrls:i,strict:o});if(!c)return null;try{return await bk(t,{record:c,gatewayUrls:r})}catch{return null}}async function vk(t,e){const{address:n,blockNumber:r,blockTag:s,coinType:i=60n,gatewayUrls:o,strict:a}=e,{chain:c}=t,u=(()=>{if(e.universalResolverAddress)return e.universalResolverAddress;if(!c)throw new Error("client chain not configured. universalResolverAddress is required.");return ga({blockNumber:r,chain:c,contract:"ensUniversalResolver"})})();try{const l={address:u,abi:zR,args:[n,i,o??[$l]],functionName:"reverseWithGateways",blockNumber:r,blockTag:s},d=ve(t,Ir,"readContract"),[f]=await d(l);return f||null}catch(l){if(a)throw l;if(mb(l))return null;throw l}}async function Ck(t,e){const{blockNumber:n,blockTag:r,name:s}=e,{chain:i}=t,o=(()=>{if(e.universalResolverAddress)return e.universalResolverAddress;if(!i)throw new Error("client chain not configured. universalResolverAddress is required.");return ga({blockNumber:n,chain:i,contract:"ensUniversalResolver"})})(),a=i?.ensTlds;if(a&&!a.some(u=>s.endsWith(u)))throw new Error(`${s} is not a valid ENS TLD (${a?.join(", ")}) for chain "${i.name}" (id: ${i.id}).`);const[c]=await ve(t,Ir,"readContract")({address:o,abi:[{inputs:[{type:"bytes"}],name:"findResolver",outputs:[{type:"address"},{type:"bytes32"},{type:"uint256"}],stateMutability:"view",type:"function"}],functionName:"findResolver",args:[Jt(yb(s))],blockNumber:n,blockTag:r});return c}async function IS(t,e){const{account:n=t.account,blockNumber:r,blockTag:s="latest",blobs:i,data:o,gas:a,gasPrice:c,maxFeePerBlobGas:u,maxFeePerGas:l,maxPriorityFeePerGas:d,to:f,value:h,...g}=e,p=n?Qt(n):void 0;try{ha(e);const E=(typeof r=="bigint"?ee(r):void 0)||s,A=t.chain?.formatters?.transactionRequest?.format,C=(A||qc)({...Ch(g,{format:A}),account:p,blobs:i,data:o,gas:a,gasPrice:c,maxFeePerBlobGas:u,maxFeePerGas:l,maxPriorityFeePerGas:d,to:f,value:h},"createAccessList"),_=await t.request({method:"eth_createAccessList",params:[C,E]});return{accessList:_.accessList,gasUsed:BigInt(_.gasUsed)}}catch(y){throw iS(y,{...e,account:p,chain:t.chain})}}async function _k(t){const e=yh(t,{method:"eth_newBlockFilter"}),n=await t.request({method:"eth_newBlockFilter"});return{id:n,request:e(n),type:"block"}}async function TS(t,{address:e,args:n,event:r,events:s,fromBlock:i,strict:o,toBlock:a}={}){const c=s??(r?[r]:void 0),u=yh(t,{method:"eth_newFilter"});let l=[];c&&(l=[c.flatMap(h=>Lc({abi:[h],eventName:h.name,args:n}))],r&&(l=l[0]));const d=await t.request({method:"eth_newFilter",params:[{address:e,fromBlock:typeof i=="bigint"?ee(i):i,toBlock:typeof a=="bigint"?ee(a):a,...l.length?{topics:l}:{}}]});return{abi:c,args:n,eventName:r?r.name:void 0,fromBlock:i,id:d,request:u(d),strict:!!o,toBlock:a,type:"event"}}async function NS(t){const e=yh(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}async function xS(t,{address:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest"}){const s=typeof n=="bigint"?ee(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}async function Ak(t){const e=await t.request({method:"eth_blobBaseFee"});return BigInt(e)}async function Sk(t,{blockHash:e,blockNumber:n,blockTag:r="latest"}={}){const s=n!==void 0?ee(n):void 0;let i;return e?i=await t.request({method:"eth_getBlockTransactionCountByHash",params:[e]},{dedupe:!0}):i=await t.request({method:"eth_getBlockTransactionCountByNumber",params:[s||r]},{dedupe:!!s}),ar(i)}async function Kg(t,{address:e,blockNumber:n,blockTag:r="latest"}){const s=n!==void 0?ee(n):void 0,i=await t.request({method:"eth_getCode",params:[e,s||r]},{dedupe:!!s});if(i!=="0x")return i}class Ik extends K{constructor({address:e}){super(`No EIP-712 domain found on contract "${e}".`,{metaMessages:["Ensure that:",`- The contract is deployed at the address "${e}".`,"- `eip712Domain()` function exists on the contract.","- `eip712Domain()` function matches signature to ERC-5267 specification."],name:"Eip712DomainNotFoundError"})}}async function Tk(t,e){const{address:n,factory:r,factoryData:s}=e;try{const[i,o,a,c,u,l,d]=await ve(t,Ir,"readContract")({abi:Nk,address:n,functionName:"eip712Domain",factory:r,factoryData:s});return{domain:{name:o,version:a,chainId:Number(c),verifyingContract:u,salt:l},extensions:d,fields:i}}catch(i){const o=i;throw o.name==="ContractFunctionExecutionError"&&o.cause.name==="ContractFunctionZeroDataError"?new Ik({address:n}):o}}const Nk=[{inputs:[],name:"eip712Domain",outputs:[{name:"fields",type:"bytes1"},{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"},{name:"salt",type:"bytes32"},{name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"}];function xk(t){return{baseFeePerGas:t.baseFeePerGas.map(e=>BigInt(e)),gasUsedRatio:t.gasUsedRatio,oldestBlock:BigInt(t.oldestBlock),reward:t.reward?.map(e=>e.map(n=>BigInt(n)))}}async function Pk(t,{blockCount:e,blockNumber:n,blockTag:r="latest",rewardPercentiles:s}){const i=typeof n=="bigint"?ee(n):void 0,o=await t.request({method:"eth_feeHistory",params:[ee(e),i||r,s]},{dedupe:!!i});return xk(o)}async function Ok(t,{filter:e}){const n=e.strict??!1,s=(await e.request({method:"eth_getFilterLogs",params:[e.id]})).map(i=>Is(i));return e.abi?Oh({abi:e.abi,logs:s,strict:n}):s}function Rk(t,e){if(t.length!==e.length)throw new Ny({expectedLength:t.length,givenLength:e.length});const n=[];for(let r=0;r<t.length;r++){const s=t[r],i=e[r];n.push(PS(s,i))}return Sn(n)}function PS(t,e,n=!1){if(t==="address"){const o=e;if(!_t(o))throw new Xt({address:o});return ws(o.toLowerCase(),{size:n?32:null})}if(t==="string")return eo(e);if(t==="bytes")return e;if(t==="bool")return ws(mh(e),{size:n?32:1});const r=t.match(Ly);if(r){const[o,a,c="256"]=r,u=Number.parseInt(c,10)/8;return ee(e,{size:n?32:u,signed:a==="int"})}const s=t.match(WA);if(s){const[o,a]=s;if(Number.parseInt(a,10)!==(e.length-2)/2)throw new Ry({expectedSize:Number.parseInt(a,10),givenSize:(e.length-2)/2});return ws(e,{dir:"right",size:n?32:null})}const i=t.match(g8);if(i&&Array.isArray(e)){const[o,a]=i,c=[];for(let u=0;u<e.length;u++)c.push(PS(a,e[u],!0));return c.length===0?"0x":Sn(c)}throw new kA(t)}function kk(t){const{authorizationList:e}=t;if(e)for(const n of e){const{chainId:r}=n,s=n.address;if(!_t(s))throw new Xt({address:s});if(r<0)throw new Rl({chainId:r})}qh(t)}function $k(t){const{blobVersionedHashes:e}=t;if(e){if(e.length===0)throw new k2;for(const n of e){const r=dt(n),s=ar(to(n,0,1));if(r!==32)throw new oR({hash:n,size:r});if(s!==R2)throw new aR({hash:n,version:s})}}qh(t)}function qh(t){const{chainId:e,maxPriorityFeePerGas:n,maxFeePerGas:r,to:s}=t;if(e<=0)throw new Rl({chainId:e});if(s&&!_t(s))throw new Xt({address:s});if(r&&r>Tl)throw new io({maxFeePerGas:r});if(n&&r&&n>r)throw new Pc({maxFeePerGas:r,maxPriorityFeePerGas:n})}function OS(t){const{chainId:e,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:i}=t;if(e<=0)throw new Rl({chainId:e});if(i&&!_t(i))throw new Xt({address:i});if(n||s)throw new K("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(r&&r>Tl)throw new io({maxFeePerGas:r})}function RS(t){const{chainId:e,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:i}=t;if(i&&!_t(i))throw new Xt({address:i});if(typeof e<"u"&&e<=0)throw new Rl({chainId:e});if(n||s)throw new K("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(r&&r>Tl)throw new io({maxFeePerGas:r})}function Dl(t){if(!t||t.length===0)return[];const e=[];for(let n=0;n<t.length;n++){const{address:r,storageKeys:s}=t[n];for(let i=0;i<s.length;i++)if(s[i].length-2!==64)throw new u2({storageKey:s[i]});if(!_t(r,{strict:!1}))throw new Xt({address:r});e.push([r,s])}return e}function kS(t,e){const n=ob(t);return n==="eip1559"?Bk(t,e):n==="eip2930"?Mk(t,e):n==="eip4844"?Uk(t,e):n==="eip7702"?Dk(t,e):Lk(t,e)}function Dk(t,e){const{authorizationList:n,chainId:r,gas:s,nonce:i,to:o,value:a,maxFeePerGas:c,maxPriorityFeePerGas:u,accessList:l,data:d}=t;kk(t);const f=Dl(l),h=Fk(n);return Sn(["0x04",pi([ee(r),i?ee(i):"0x",u?ee(u):"0x",c?ee(c):"0x",s?ee(s):"0x",o??"0x",a?ee(a):"0x",d??"0x",f,h,...Ul(t,e)])])}function Uk(t,e){const{chainId:n,gas:r,nonce:s,to:i,value:o,maxFeePerBlobGas:a,maxFeePerGas:c,maxPriorityFeePerGas:u,accessList:l,data:d}=t;$k(t);let f=t.blobVersionedHashes,h=t.sidecars;if(t.blobs&&(typeof f>"u"||typeof h>"u")){const w=typeof t.blobs[0]=="string"?t.blobs:t.blobs.map(P=>Ct(P)),C=t.kzg,_=Sh({blobs:w,kzg:C});if(typeof f>"u"&&(f=rb({commitments:_})),typeof h>"u"){const P=Ih({blobs:w,commitments:_,kzg:C});h=ib({blobs:w,commitments:_,proofs:P})}}const g=Dl(l),p=[ee(n),s?ee(s):"0x",u?ee(u):"0x",c?ee(c):"0x",r?ee(r):"0x",i??"0x",o?ee(o):"0x",d??"0x",g,a?ee(a):"0x",f??[],...Ul(t,e)],y=[],E=[],A=[];if(h)for(let w=0;w<h.length;w++){const{blob:C,commitment:_,proof:P}=h[w];y.push(C),E.push(_),A.push(P)}return Sn(["0x03",pi(h?[p,y,E,A]:p)])}function Bk(t,e){const{chainId:n,gas:r,nonce:s,to:i,value:o,maxFeePerGas:a,maxPriorityFeePerGas:c,accessList:u,data:l}=t;qh(t);const d=Dl(u),f=[ee(n),s?ee(s):"0x",c?ee(c):"0x",a?ee(a):"0x",r?ee(r):"0x",i??"0x",o?ee(o):"0x",l??"0x",d,...Ul(t,e)];return Sn(["0x02",pi(f)])}function Mk(t,e){const{chainId:n,gas:r,data:s,nonce:i,to:o,value:a,accessList:c,gasPrice:u}=t;OS(t);const l=Dl(c),d=[ee(n),i?ee(i):"0x",u?ee(u):"0x",r?ee(r):"0x",o??"0x",a?ee(a):"0x",s??"0x",l,...Ul(t,e)];return Sn(["0x01",pi(d)])}function Lk(t,e){const{chainId:n=0,gas:r,data:s,nonce:i,to:o,value:a,gasPrice:c}=t;RS(t);let u=[i?ee(i):"0x",c?ee(c):"0x",r?ee(r):"0x",o??"0x",a?ee(a):"0x",s??"0x"];if(e){const l=(()=>{if(e.v>=35n)return(e.v-35n)/2n>0?e.v:27n+(e.v===35n?0n:1n);if(n>0)return BigInt(n*2)+BigInt(35n+e.v-27n);const h=27n+(e.v===27n?0n:1n);if(e.v!==h)throw new a2({v:e.v});return h})(),d=yn(e.r),f=yn(e.s);u=[...u,ee(l),d==="0x00"?"0x":d,f==="0x00"?"0x":f]}else n>0&&(u=[...u,ee(n),"0x","0x"]);return pi(u)}function Ul(t,e){const n=e??t,{v:r,yParity:s}=n;if(typeof n.r>"u")return[];if(typeof n.s>"u")return[];if(typeof r>"u"&&typeof s>"u")return[];const i=yn(n.r),o=yn(n.s);return[typeof s=="number"?s?ee(1):"0x":r===0n?"0x":r===1n?ee(1):r===27n?"0x":ee(1),i==="0x00"?"0x":i,o==="0x00"?"0x":o]}function Fk(t){if(!t||t.length===0)return[];const e=[];for(const n of t){const{chainId:r,nonce:s,...i}=n,o=n.address;e.push([r?Jt(r):"0x",o,s?Jt(s):"0x",...Ul({},i)])}return e}async function jk({address:t,authorization:e,signature:n}){return pa(ps(t),await Yy({authorization:e,signature:n}))}const id=new _l(8192);function qk(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(id.get(n))return id.get(n);const r=t().finally(()=>id.delete(n));return id.set(n,r),r}function zk(t,e={}){return async(n,r={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:u}=n;if(i?.exclude?.includes(u))throw new Hi(new Error("method not supported"),{method:u});if(i?.include&&!i.include.includes(u))throw new Hi(new Error("method not supported"),{method:u});const l=s?eo(`${c}.${Et(n)}`):void 0;return qk(()=>Oc(async()=>{try{return await t(n)}catch(d){const f=d;switch(f.code){case hc.code:throw new hc(f);case pc.code:throw new pc(f);case gc.code:throw new gc(f,{method:n.method});case mc.code:throw new mc(f);case no.code:throw new no(f);case ro.code:throw new ro(f);case yc.code:throw new yc(f);case ii.code:throw new ii(f);case Xo.code:throw new Xo(f);case Hi.code:throw new Hi(f,{method:n.method});case Qo.code:throw new Qo(f);case bc.code:throw new bc(f);case yt.code:throw new yt(f);case wc.code:throw new wc(f);case Ec.code:throw new Ec(f);case vc.code:throw new vc(f);case Cc.code:throw new Cc(f);case Zr.code:throw new Zr(f);case _c.code:throw new _c(f);case Ac.code:throw new Ac(f);case Sc.code:throw new Sc(f);case Ic.code:throw new Ic(f);case Tc.code:throw new Tc(f);case Nc.code:throw new Nc(f);case xc.code:throw new xc(f);case 5e3:throw new yt(f);default:throw d instanceof K?d:new p2(f)}}},{delay:({count:d,error:f})=>{if(f&&f instanceof Gi){const h=f?.headers?.get("Retry-After");if(h?.match(/\d/))return Number.parseInt(h,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>Hk(d)}),{enabled:s,id:l})}}function Hk(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Qo.code||t.code===no.code:t instanceof Gi&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}class Wk extends K{constructor({callbackSelector:e,cause:n,data:r,extraData:s,sender:i,urls:o}){super(n.shortMessage||"An error occurred while fetching for an offchain result.",{cause:n,metaMessages:[...n.metaMessages||[],n.metaMessages?.length?"":[],"Offchain Gateway Call:",o&&["  Gateway URL(s):",...o.map(a=>`    ${Sl(a)}`)],`  Sender: ${i}`,`  Data: ${r}`,`  Callback selector: ${e}`,`  Extra data: ${s}`].flat(),name:"OffchainLookupError"})}}class Vk extends K{constructor({result:e,url:n}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${Sl(n)}`,`Response: ${Et(e)}`],name:"OffchainLookupResponseMalformedError"})}}class Kk extends K{constructor({sender:e,to:n}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${n}`,`OffchainLookup sender address: ${e}`],name:"OffchainLookupSenderMismatchError"})}}const $S="0x556f1830",wb={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function DS(t,{blockNumber:e,blockTag:n,data:r,to:s}){const{args:i}=Hy({data:r,abi:[wb]}),[o,a,c,u,l]=i,{ccipRead:d}=t,f=d&&typeof d?.request=="function"?d.request:Bf;try{if(!pa(s,o))throw new Kk({sender:o,to:s});const h=a.includes($l)?await wS({data:c,ccipRequest:f}):await f({data:c,sender:o,urls:a}),{data:g}=await zc(t,{blockNumber:e,blockTag:n,data:Sr([u,xs([{type:"bytes"},{type:"bytes"}],[h,l])]),to:s});return g}catch(h){throw new Wk({callbackSelector:u,cause:h,data:r,extraData:l,sender:o,urls:a})}}async function Bf({data:t,sender:e,urls:n}){let r=new Error("An unknown error occurred.");for(let s=0;s<n.length;s++){const i=n[s],o=i.includes("{data}")?"GET":"POST",a=o==="POST"?{data:t,sender:e}:void 0,c=o==="POST"?{"Content-Type":"application/json"}:{};try{const u=await fetch(i.replace("{sender}",e.toLowerCase()).replace("{data}",t),{body:JSON.stringify(a),headers:c,method:o});let l;if(u.headers.get("Content-Type")?.startsWith("application/json")?l=(await u.json()).data:l=await u.text(),!u.ok){r=new Gi({body:a,details:l?.error?Et(l.error):u.statusText,headers:u.headers,status:u.status,url:i});continue}if(!Ar(l)){r=new Vk({result:l,url:i});continue}return l}catch(u){r=new Gi({body:a,details:u.message,url:i})}}throw r}const Gk=Object.freeze(Object.defineProperty({__proto__:null,ccipRequest:Bf,offchainLookup:DS,offchainLookupAbiItem:wb,offchainLookupSignature:$S},Symbol.toStringTag,{value:"Module"}));function Gn(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function Yk(t){const{source:e}=t,n=new Map,r=new _l(8192),s=new Map,i=({address:o,chainId:a})=>`${o}.${a}`;return{async consume({address:o,chainId:a,client:c}){const u=i({address:o,chainId:a}),l=this.get({address:o,chainId:a,client:c});this.increment({address:o,chainId:a});const d=await l;return await e.set({address:o,chainId:a},d),r.set(u,d),d},async increment({address:o,chainId:a}){const c=i({address:o,chainId:a}),u=n.get(c)??0;n.set(c,u+1)},async get({address:o,chainId:a,client:c}){const u=i({address:o,chainId:a});let l=s.get(u);return l||(l=(async()=>{try{const f=await e.get({address:o,chainId:a,client:c}),h=r.get(u)??0;return h>0&&f<=h?h+1:(r.delete(u),f)}finally{this.reset({address:o,chainId:a})}})(),s.set(u,l)),(n.get(u)??0)+await l},reset({address:o,chainId:a}){const c=i({address:o,chainId:a});n.delete(c),s.delete(c)}}}function Eb(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function Zk(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const T1=Zk();function Jk(t,e={}){return{async request(n){const{body:r,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:a=e.timeout??1e4}=n,c={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:u,method:l,signal:d}=c;try{const f=await Eb(async({signal:g})=>{const p={...c,body:Array.isArray(r)?Et(r.map(w=>({jsonrpc:"2.0",id:w.id??T1.take(),...w}))):Et({jsonrpc:"2.0",id:r.id??T1.take(),...r}),headers:{"Content-Type":"application/json",...u},method:l||"POST",signal:d||(a>0?g:null)},y=new Request(t,p),E=await i?.(y,p)??{...p,url:t};return await s(E.url??t,E)},{errorInstance:new Lg({body:r,url:t}),timeout:a,signal:!0});o&&await o(f);let h;if(f.headers.get("Content-Type")?.startsWith("application/json"))h=await f.json();else{h=await f.text();try{h=JSON.parse(h||"{}")}catch(g){if(f.ok)throw g;h={error:h}}}if(!f.ok)throw new Gi({body:r,details:Et(h.error)||f.statusText,headers:f.headers,status:f.status,url:t});return h}catch(f){throw f instanceof Gi||f instanceof Lg?f:new Gi({body:r,cause:f,url:t})}}}}const US=`Ethereum Signed Message:
`;function BS(t){const e=typeof t=="string"?eo(t):typeof t.raw=="string"?t.raw:Ct(t.raw),n=eo(`${US}${dt(e)}`);return Sr([n,e])}function vb(t,e){return Ht(BS(t),e)}class MS extends K{constructor({domain:e}){super(`Invalid domain "${Et(e)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class LS extends K{constructor({primaryType:e,types:n}){super(`Invalid primary type \`${e}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class FS extends K{constructor({type:e}){super(`Struct type "${e}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function jS(t){const{domain:e,message:n,primaryType:r,types:s}=t,i=(o,a)=>{for(const c of o){const{name:u,type:l}=c,d=a[u],f=l.match(Ly);if(f&&(typeof d=="number"||typeof d=="bigint")){const[p,y,E]=f;ee(d,{signed:y==="int",size:Number.parseInt(E,10)/8})}if(l==="address"&&typeof d=="string"&&!_t(d))throw new Xt({address:d});const h=l.match(WA);if(h){const[p,y]=h;if(y&&dt(d)!==Number.parseInt(y,10))throw new Ry({expectedSize:Number.parseInt(y,10),givenSize:dt(d)})}const g=s[l];g&&(Xk(l),i(g,d))}};if(s.EIP712Domain&&e){if(typeof e!="object")throw new MS({domain:e});i(s.EIP712Domain,e)}if(r!=="EIP712Domain")if(s[r])i(s[r],n);else throw new LS({primaryType:r,types:s})}function qS({domain:t}){return[typeof t?.name=="string"&&{name:"name",type:"string"},t?.version&&{name:"version",type:"string"},(typeof t?.chainId=="number"||typeof t?.chainId=="bigint")&&{name:"chainId",type:"uint256"},t?.verifyingContract&&{name:"verifyingContract",type:"address"},t?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function Xk(t){if(t==="address"||t==="bool"||t==="string"||t.startsWith("bytes")||t.startsWith("uint")||t.startsWith("int"))throw new FS({type:t})}function zS(t){const{domain:e={},message:n,primaryType:r}=t,s={EIP712Domain:qS({domain:e}),...t.types};jS({domain:e,message:n,primaryType:r,types:s});const i=["0x1901"];return e&&i.push(HS({domain:e,types:s})),r!=="EIP712Domain"&&i.push(Cb({data:n,primaryType:r,types:s})),Ht(Sr(i))}function HS({domain:t,types:e}){return Cb({data:t,primaryType:"EIP712Domain",types:e})}function Cb({data:t,primaryType:e,types:n}){const r=WS({data:t,primaryType:e,types:n});return Ht(r)}function WS({data:t,primaryType:e,types:n}){const r=[{type:"bytes32"}],s=[Qk({primaryType:e,types:n})];for(const i of n[e]){const[o,a]=KS({types:n,name:i.name,type:i.type,value:t[i.name]});r.push(o),s.push(a)}return xs(r,s)}function Qk({primaryType:t,types:e}){const n=Jt(e$({primaryType:t,types:e}));return Ht(n)}function e$({primaryType:t,types:e}){let n="";const r=VS({primaryType:t,types:e});r.delete(t);const s=[t,...Array.from(r).sort()];for(const i of s)n+=`${i}(${e[i].map(({name:o,type:a})=>`${a} ${o}`).join(",")})`;return n}function VS({primaryType:t,types:e},n=new Set){const s=t.match(/^\w*/u)?.[0];if(n.has(s)||e[s]===void 0)return n;n.add(s);for(const i of e[s])VS({primaryType:i.type,types:e},n);return n}function KS({types:t,name:e,type:n,value:r}){if(t[n]!==void 0)return[{type:"bytes32"},Ht(WS({data:r,primaryType:n,types:t}))];if(n==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},Ht(r)];if(n==="string")return[{type:"bytes32"},Ht(Jt(r))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),i=r.map(o=>KS({name:e,type:s,types:t,value:o}));return[{type:"bytes32"},Ht(xs(i.map(([o])=>o),i.map(([,o])=>o)))]}return[{type:n},r]}const t$="0x6492649264926492649264926492649264926492649264926492649264926492";let n$=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const r$={checksum:new n$(8192)},Wp=r$.checksum;function GS(t,e={}){const{as:n=typeof t=="string"?"Hex":"Bytes"}=e,r=my(_R(t));return n==="Bytes"?r:Xr(r)}const s$=/^0x[a-fA-F0-9]{40}$/;function zh(t,e={}){const{strict:n=!0}=e;if(!s$.test(t))throw new N1({address:t,cause:new i$});if(n){if(t.toLowerCase()===t)return;if(YS(t)!==t)throw new N1({address:t,cause:new o$})}}function YS(t){if(Wp.has(t))return Wp.get(t);zh(t,{strict:!1});const e=t.substring(2).toLowerCase(),n=GS(SR(e),{as:"Bytes"}),r=e.split("");for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&r[i]&&(r[i]=r[i].toUpperCase()),(n[i>>1]&15)>=8&&r[i+1]&&(r[i+1]=r[i+1].toUpperCase());const s=`0x${r.join("")}`;return Wp.set(t,s),s}function Gg(t,e={}){const{strict:n=!0}=e??{};try{return zh(t,{strict:n}),!0}catch{return!1}}let N1=class extends Fe{constructor({address:e,cause:n}){super(`Address "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}},i$=class extends Fe{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}},o$=class extends Fe{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}};const a$=/^(.*)\[([0-9]*)\]$/,c$=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,ZS=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,x1=2n**256n-1n;function Qa(t,e,n){const{checksumAddress:r,staticPosition:s}=n,i=Sb(e.type);if(i){const[o,a]=i;return l$(t,{...e,type:a},{checksumAddress:r,length:o,staticPosition:s})}if(e.type==="tuple")return p$(t,e,{checksumAddress:r,staticPosition:s});if(e.type==="address")return u$(t,{checksum:r});if(e.type==="bool")return d$(t);if(e.type.startsWith("bytes"))return f$(t,e,{staticPosition:s});if(e.type.startsWith("uint")||e.type.startsWith("int"))return h$(t,e);if(e.type==="string")return g$(t,{staticPosition:s});throw new Tb(e.type)}const P1=32,Yg=32;function u$(t,e={}){const{checksum:n=!1}=e,r=t.readBytes(32);return[(i=>n?YS(i):i)(Xr(TR(r,-20))),32]}function l$(t,e,n){const{checksumAddress:r,length:s,staticPosition:i}=n;if(!s){const c=oi(t.readBytes(Yg)),u=i+c,l=u+P1;t.setPosition(u);const d=oi(t.readBytes(P1)),f=sl(e);let h=0;const g=[];for(let p=0;p<d;++p){t.setPosition(l+(f?p*32:h));const[y,E]=Qa(t,e,{checksumAddress:r,staticPosition:l});h+=E,g.push(y)}return t.setPosition(i+32),[g,32]}if(sl(e)){const c=oi(t.readBytes(Yg)),u=i+c,l=[];for(let d=0;d<s;++d){t.setPosition(u+d*32);const[f]=Qa(t,e,{checksumAddress:r,staticPosition:u});l.push(f)}return t.setPosition(i+32),[l,32]}let o=0;const a=[];for(let c=0;c<s;++c){const[u,l]=Qa(t,e,{checksumAddress:r,staticPosition:i+o});o+=l,a.push(u)}return[a,o]}function d$(t){return[xR(t.readBytes(32),{size:32}),32]}function f$(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=oi(t.readBytes(32));t.setPosition(n+o);const a=oi(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[Xr(c),32]}return[Xr(t.readBytes(Number.parseInt(s,10),32)),32]}function h$(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256",10),s=t.readBytes(32);return[r>48?NR(s,{signed:n}):oi(s,{signed:n}),32]}function p$(t,e,n){const{checksumAddress:r,staticPosition:s}=n,i=e.components.length===0||e.components.some(({name:c})=>!c),o=i?[]:{};let a=0;if(sl(e)){const c=oi(t.readBytes(Yg)),u=s+c;for(let l=0;l<e.components.length;++l){const d=e.components[l];t.setPosition(u+a);const[f,h]=Qa(t,d,{checksumAddress:r,staticPosition:u});a+=h,o[i?l:d?.name]=f}return t.setPosition(s+32),[o,32]}for(let c=0;c<e.components.length;++c){const u=e.components[c],[l,d]=Qa(t,u,{checksumAddress:r,staticPosition:s});o[i?c:u?.name]=l,a+=d}return[o,a]}function g$(t,{staticPosition:e}){const n=oi(t.readBytes(32)),r=e+n;t.setPosition(r);const s=oi(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=PR(V2(i));return t.setPosition(e+32),[o,32]}function m$({checksumAddress:t,parameters:e,values:n}){const r=[];for(let s=0;s<e.length;s++)r.push(_b({checksumAddress:t,parameter:e[s],value:n[s]}));return r}function _b({checksumAddress:t=!1,parameter:e,value:n}){const r=e,s=Sb(r.type);if(s){const[i,o]=s;return b$(n,{checksumAddress:t,length:i,parameter:{...r,type:o}})}if(r.type==="tuple")return _$(n,{checksumAddress:t,parameter:r});if(r.type==="address")return y$(n,{checksum:t});if(r.type==="bool")return E$(n);if(r.type.startsWith("uint")||r.type.startsWith("int")){const i=r.type.startsWith("int"),[,,o="256"]=ZS.exec(r.type)??[];return v$(n,{signed:i,size:Number(o)})}if(r.type.startsWith("bytes"))return w$(n,{type:r.type});if(r.type==="string")return C$(n);throw new Tb(r.type)}function Ab(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=ur(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(mn(e+s,{size:32})),r.push(a),s+=ur(a)):n.push(a)}return Jr(...n,...r)}function y$(t,e){const{checksum:n=!1}=e;return zh(t,{strict:n}),{dynamic:!1,encoded:ea(t.toLowerCase())}}function b$(t,e){const{checksumAddress:n,length:r,parameter:s}=e,i=r===null;if(!Array.isArray(t))throw new R$(t);if(!i&&t.length!==r)throw new O$({expectedLength:r,givenLength:t.length,type:`${s.type}[${r}]`});let o=!1;const a=[];for(let c=0;c<t.length;c++){const u=_b({checksumAddress:n,parameter:s,value:t[c]});u.dynamic&&(o=!0),a.push(u)}if(i||o){const c=Ab(a);if(i){const u=mn(a.length,{size:32});return{dynamic:!0,encoded:a.length>0?Jr(u,c):u}}if(o)return{dynamic:!0,encoded:c}}return{dynamic:!1,encoded:Jr(...a.map(({encoded:c})=>c))}}function w$(t,{type:e}){const[,n]=e.split("bytes"),r=ur(t);if(!n){let s=t;return r%32!==0&&(s=ta(s,Math.ceil((t.length-2)/2/32)*32)),{dynamic:!0,encoded:Jr(ea(mn(r,{size:32})),s)}}if(r!==Number.parseInt(n,10))throw new XS({expectedSize:Number.parseInt(n,10),value:t});return{dynamic:!1,encoded:ta(t)}}function E$(t){if(typeof t!="boolean")throw new Fe(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:ea(K2(t))}}function v$(t,{signed:e,size:n}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new Z2({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:mn(t,{size:32,signed:e})}}function C$(t){const e=db(t),n=Math.ceil(ur(e)/32),r=[];for(let s=0;s<n;s++)r.push(ta(vs(e,s*32,(s+1)*32)));return{dynamic:!0,encoded:Jr(ta(mn(ur(e),{size:32})),...r)}}function _$(t,e){const{checksumAddress:n,parameter:r}=e;let s=!1;const i=[];for(let o=0;o<r.components.length;o++){const a=r.components[o],c=Array.isArray(t)?o:a.name,u=_b({checksumAddress:n,parameter:a,value:t[c]});i.push(u),u.dynamic&&(s=!0)}return{dynamic:s,encoded:s?Ab(i):Jr(...i.map(({encoded:o})=>o))}}function Sb(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}function sl(t){const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return t.components?.some(sl);const n=Sb(t.type);return!!(n&&sl({...t,type:n[1]}))}const A$={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new T$({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new I$({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new O1({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new O1({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function S$(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(A$);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}class O1 extends Fe{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Cursor.NegativeOffsetError"})}}class I$ extends Fe{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Cursor.PositionOutOfBoundsError"})}}class T$ extends Fe{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Cursor.RecursiveReadLimitExceededError"})}}function N$(t,e,n={}){const{as:r="Array",checksumAddress:s=!1}=n,i=typeof e=="string"?W2(e):e,o=S$(i);if(ja(i)===0&&t.length>0)throw new P$;if(ja(i)&&ja(i)<32)throw new x$({data:typeof e=="string"?e:Xr(e),parameters:t,size:ja(i)});let a=0;const c=r==="Array"?[]:{};for(let u=0;u<t.length;++u){const l=t[u];o.setPosition(a);const[d,f]=Qa(o,l,{checksumAddress:s,staticPosition:0});a+=f,r==="Array"?c.push(d):c[l.name??u]=d}return c}function Ib(t,e,n){const{checksumAddress:r=!1}={};if(t.length!==e.length)throw new QS({expectedLength:t.length,givenLength:e.length});const s=m$({checksumAddress:r,parameters:t,values:e}),i=Ab(s);return i.length===0?"0x":i}function Zg(t,e){if(t.length!==e.length)throw new QS({expectedLength:t.length,givenLength:e.length});const n=[];for(let r=0;r<t.length;r++){const s=t[r],i=e[r];n.push(Zg.encode(s,i))}return Jr(...n)}(function(t){function e(n,r,s=!1){if(n==="address"){const c=r;return zh(c),ea(c.toLowerCase(),s?32:0)}if(n==="string")return db(r);if(n==="bytes")return r;if(n==="bool")return ea(K2(r),s?32:1);const i=n.match(ZS);if(i){const[c,u,l="256"]=i,d=Number.parseInt(l,10)/8;return mn(r,{size:s?32:d,signed:u==="int"})}const o=n.match(c$);if(o){const[c,u]=o;if(Number.parseInt(u,10)!==(r.length-2)/2)throw new XS({expectedSize:Number.parseInt(u,10),value:r});return ta(r,s?32:0)}const a=n.match(a$);if(a&&Array.isArray(r)){const[c,u]=a,l=[];for(let d=0;d<r.length;d++)l.push(e(u,r[d],!0));return l.length===0?"0x":Jr(...l)}throw new Tb(n)}t.encode=e})(Zg||(Zg={}));function JS(t){return Array.isArray(t)&&typeof t[0]=="string"||typeof t=="string"?Rg(t):t}class x$ extends Fe{constructor({data:e,parameters:n,size:r}){super(`Data size of ${r} bytes is too small for given parameters.`,{metaMessages:[`Params: (${Ua(n)})`,`Data:   ${e} (${r} bytes)`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.DataSizeTooSmallError"})}}class P$ extends Fe{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.'),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.ZeroDataError"})}}class O$ extends Fe{constructor({expectedLength:e,givenLength:n,type:r}){super(`Array length mismatch for type \`${r}\`. Expected: \`${e}\`. Given: \`${n}\`.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.ArrayLengthMismatchError"})}}class XS extends Fe{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${ur(n)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class QS extends Fe{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${e}`,`Given length (values): ${n}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class R$ extends Fe{constructor(e){super(`Value \`${e}\` is not a valid array.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidArrayError"})}}class Tb extends Fe{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class eI extends $_{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,U_(e);const r=D_(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),ac(i)}update(e){return rf(this),this.iHash.update(e),this}digestInto(e){rf(this),yy(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Hh=(t,e,n)=>new eI(t,e).update(n).digest();Hh.create=(t,e)=>new eI(t,e);const Fn=BigInt(0),wn=BigInt(1),Po=BigInt(2),k$=BigInt(3),tI=BigInt(4),nI=BigInt(5),rI=BigInt(8);function Dn(t,e){const n=t%e;return n>=Fn?n:e+n}function dr(t,e,n){let r=t;for(;e-- >Fn;)r*=r,r%=n;return r}function Jg(t,e){if(t===Fn)throw new Error("invert: expected non-zero number");if(e<=Fn)throw new Error("invert: expected positive modulus, got "+e);let n=Dn(t,e),r=e,s=Fn,i=wn;for(;n!==Fn;){const a=r/n,c=r%n,u=s-i*a;r=n,n=c,s=i,i=u}if(r!==wn)throw new Error("invert: does not exist");return Dn(s,e)}function sI(t,e){const n=(t.ORDER+wn)/tI,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function $$(t,e){const n=(t.ORDER-nI)/rI,r=t.mul(e,Po),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Po),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function D$(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-wn,n=0;for(;e%Po===Fn;)e/=Po,n++;let r=Po;const s=Nb(t);for(;R1(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return sI;let i=s.pow(r,e);const o=(e+wn)/Po;return function(c,u){if(c.is0(u))return u;if(R1(c,u)!==1)throw new Error("Cannot find square root");let l=n,d=c.mul(c.ONE,i),f=c.pow(u,e),h=c.pow(u,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let g=1,p=c.sqr(f);for(;!c.eql(p,c.ONE);)if(g++,p=c.sqr(p),g===l)throw new Error("Cannot find square root");const y=wn<<BigInt(l-g-1),E=c.pow(d,y);l=g,d=c.sqr(E),f=c.mul(f,d),h=c.mul(h,E)}return h}}function U$(t){return t%tI===k$?sI:t%rI===nI?$$:D$(t)}const B$=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function M$(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=B$.reduce((r,s)=>(r[s]="function",r),e);return kh(t,n)}function L$(t,e,n){if(n<Fn)throw new Error("invalid exponent, negatives unsupported");if(n===Fn)return t.ONE;if(n===wn)return e;let r=t.ONE,s=e;for(;n>Fn;)n&wn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=wn;return r}function iI(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function R1(t,e){const n=(t.ORDER-wn)/Po,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function oI(t,e){e!==void 0&&wy(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Nb(t,e,n=!1,r={}){if(t<=Fn)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=oI(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:Rh(s),ZERO:Fn,ONE:wn,create:c=>Dn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Fn<=c&&c<t},is0:c=>c===Fn,isOdd:c=>(c&wn)===wn,neg:c=>Dn(-c,t),eql:(c,u)=>c===u,sqr:c=>Dn(c*c,t),add:(c,u)=>Dn(c+u,t),sub:(c,u)=>Dn(c-u,t),mul:(c,u)=>Dn(c*u,t),pow:(c,u)=>L$(a,c,u),div:(c,u)=>Dn(c*Jg(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Jg(c,t),sqrt:r.sqrt||(c=>(o||(o=U$(t)),o(a,c))),toBytes:c=>n?F2(c,i):Pl(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?L2(c):qo(c)},invertBatch:c=>iI(a,c),cmov:(c,u,l)=>l?u:c});return Object.freeze(a)}function aI(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function cI(t){const e=aI(t);return e+Math.ceil(e/2)}function F$(t,e,n=!1){const r=t.length,s=aI(e),i=cI(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?L2(t):qo(t),a=Dn(o,e-wn)+wn;return n?F2(a,s):Pl(a,s)}const k1=BigInt(0),Xg=BigInt(1);function Vp(t,e){const n=e.negate();return t?n:e}function uI(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Kp(t,e){uI(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Rh(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function $1(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Xg);const u=e*r,l=u+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:u}}function j$(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function q$(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Gp=new WeakMap,lI=new WeakMap;function Yp(t){return lI.get(t)||1}function z$(t,e){return{constTimeNegate:Vp,hasPrecomputes(n){return Yp(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>k1;)r&Xg&&(s=s.add(i)),i=i.double(),r>>=Xg;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Kp(r,e),o=[];let a=n,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=Kp(n,e);for(let c=0;c<a.windows;c++){const{nextN:u,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:g}=$1(s,c,a);s=u,d?o=o.add(Vp(h,r[g])):i=i.add(Vp(f,r[l]))}return{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=Kp(n,e);for(let a=0;a<o.windows&&s!==k1;a++){const{nextN:c,offset:u,isZero:l,isNeg:d}=$1(s,a,o);if(s=c,!l){const f=r[u];i=i.add(d?f.negate():f)}}return i},getPrecomputes(n,r,s){let i=Gp.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&Gp.set(r,s(i))),i},wNAFCached(n,r,s){const i=Yp(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Yp(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){uI(r,e),lI.set(n,r),Gp.delete(n)}}}function H$(t,e,n,r){j$(n,t),q$(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=fR(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=Rh(c),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){l.fill(o);for(let p=0;p<i;p++){const y=r[p],E=Number(y>>BigInt(h)&u);l[E]=l[E].add(n[p])}let g=o;for(let p=l.length-1,y=o;p>0;p--)y=y.add(l[p]),g=g.add(y);if(f=f.add(g),h!==0)for(let p=0;p<c;p++)f=f.double()}return f}function dI(t){return M$(t.Fp),kh(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...oI(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function D1(t){t.lowS!==void 0&&tl("lowS",t.lowS),t.prehash!==void 0&&tl("prehash",t.prehash)}function W$(t){const e=dI(t);kh(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}let V$=class extends Error{constructor(e=""){super(e)}};const Gs={Err:V$,_tlv:{encode:(t,e)=>{const{Err:n}=Gs;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=nd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?nd(s.length/2|128):"";return nd(t)+i+s+e},decode(t,e){const{Err:n}=Gs;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const u=e.subarray(r,r+c);if(u.length!==c)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Gs;if(t<Xs)throw new e("integer: negative integers are not allowed");let n=nd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Gs;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return qo(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Gs,s=br("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:u,l}=r.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(u)}},hexFromSig(t){const{_tlv:e,_int:n}=Gs,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}};function Zp(t,e){return nl(Pl(t,e))}const Xs=BigInt(0),Lt=BigInt(1);BigInt(2);const Jp=BigInt(3),K$=BigInt(4);function G$(t){const e=W$(t),{Fp:n}=e,r=Nb(e.n,e.nBitLength),s=e.toBytes||((w,C,_)=>{const P=C.toAffine();return Of(Uint8Array.from([4]),n.toBytes(P.x),n.toBytes(P.y))}),i=e.fromBytes||(w=>{const C=w.subarray(1),_=n.fromBytes(C.subarray(0,n.BYTES)),P=n.fromBytes(C.subarray(n.BYTES,2*n.BYTES));return{x:_,y:P}});function o(w){const{a:C,b:_}=e,P=n.sqr(w),k=n.mul(P,w);return n.add(n.add(k,n.mul(w,C)),_)}function a(w,C){const _=n.sqr(C),P=o(w);return n.eql(_,P)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(e.a,Jp),K$),u=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(c,u)))throw new Error("bad curve params: a or b");function l(w){return lb(w,Lt,e.n)}function d(w){const{allowedPrivateKeyLengths:C,nByteLength:_,wrapPrivateKey:P,n:k}=e;if(C&&typeof w!="bigint"){if(xl(w)&&(w=nl(w)),typeof w!="string"||!C.includes(w.length))throw new Error("invalid private key");w=w.padStart(_*2,"0")}let U;try{U=typeof w=="bigint"?w:qo(br("private key",w,_))}catch{throw new Error("invalid private key, expected hex or "+_+" bytes, got "+typeof w)}return P&&(U=Dn(U,k)),Xa("private key",U,Lt,k),U}function f(w){if(!(w instanceof p))throw new Error("ProjectivePoint expected")}const h=w1((w,C)=>{const{px:_,py:P,pz:k}=w;if(n.eql(k,n.ONE))return{x:_,y:P};const U=w.is0();C==null&&(C=U?n.ONE:n.inv(k));const $=n.mul(_,C),L=n.mul(P,C),M=n.mul(k,C);if(U)return{x:n.ZERO,y:n.ZERO};if(!n.eql(M,n.ONE))throw new Error("invZ was invalid");return{x:$,y:L}}),g=w1(w=>{if(w.is0()){if(e.allowInfinityPoint&&!n.is0(w.py))return;throw new Error("bad point: ZERO")}const{x:C,y:_}=w.toAffine();if(!n.isValid(C)||!n.isValid(_))throw new Error("bad point: x or y not FE");if(!a(C,_))throw new Error("bad point: equation left != right");if(!w.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(C,_,P){if(C==null||!n.isValid(C))throw new Error("x required");if(_==null||!n.isValid(_)||n.is0(_))throw new Error("y required");if(P==null||!n.isValid(P))throw new Error("z required");this.px=C,this.py=_,this.pz=P,Object.freeze(this)}static fromAffine(C){const{x:_,y:P}=C||{};if(!C||!n.isValid(_)||!n.isValid(P))throw new Error("invalid affine point");if(C instanceof p)throw new Error("projective point not allowed");const k=U=>n.eql(U,n.ZERO);return k(_)&&k(P)?p.ZERO:new p(_,P,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(C){const _=iI(n,C.map(P=>P.pz));return C.map((P,k)=>P.toAffine(_[k])).map(p.fromAffine)}static fromHex(C){const _=p.fromAffine(i(br("pointHex",C)));return _.assertValidity(),_}static fromPrivateKey(C){return p.BASE.multiply(d(C))}static msm(C,_){return H$(p,r,C,_)}_setWindowSize(C){A.setWindowSize(this,C)}assertValidity(){g(this)}hasEvenY(){const{y:C}=this.toAffine();if(n.isOdd)return!n.isOdd(C);throw new Error("Field doesn't support isOdd")}equals(C){f(C);const{px:_,py:P,pz:k}=this,{px:U,py:$,pz:L}=C,M=n.eql(n.mul(_,L),n.mul(U,k)),D=n.eql(n.mul(P,L),n.mul($,k));return M&&D}negate(){return new p(this.px,n.neg(this.py),this.pz)}double(){const{a:C,b:_}=e,P=n.mul(_,Jp),{px:k,py:U,pz:$}=this;let L=n.ZERO,M=n.ZERO,D=n.ZERO,T=n.mul(k,k),O=n.mul(U,U),m=n.mul($,$),b=n.mul(k,U);return b=n.add(b,b),D=n.mul(k,$),D=n.add(D,D),L=n.mul(C,D),M=n.mul(P,m),M=n.add(L,M),L=n.sub(O,M),M=n.add(O,M),M=n.mul(L,M),L=n.mul(b,L),D=n.mul(P,D),m=n.mul(C,m),b=n.sub(T,m),b=n.mul(C,b),b=n.add(b,D),D=n.add(T,T),T=n.add(D,T),T=n.add(T,m),T=n.mul(T,b),M=n.add(M,T),m=n.mul(U,$),m=n.add(m,m),T=n.mul(m,b),L=n.sub(L,T),D=n.mul(m,O),D=n.add(D,D),D=n.add(D,D),new p(L,M,D)}add(C){f(C);const{px:_,py:P,pz:k}=this,{px:U,py:$,pz:L}=C;let M=n.ZERO,D=n.ZERO,T=n.ZERO;const O=e.a,m=n.mul(e.b,Jp);let b=n.mul(_,U),v=n.mul(P,$),S=n.mul(k,L),I=n.add(_,P),x=n.add(U,$);I=n.mul(I,x),x=n.add(b,v),I=n.sub(I,x),x=n.add(_,k);let B=n.add(U,L);return x=n.mul(x,B),B=n.add(b,S),x=n.sub(x,B),B=n.add(P,k),M=n.add($,L),B=n.mul(B,M),M=n.add(v,S),B=n.sub(B,M),T=n.mul(O,x),M=n.mul(m,S),T=n.add(M,T),M=n.sub(v,T),T=n.add(v,T),D=n.mul(M,T),v=n.add(b,b),v=n.add(v,b),S=n.mul(O,S),x=n.mul(m,x),v=n.add(v,S),S=n.sub(b,S),S=n.mul(O,S),x=n.add(x,S),b=n.mul(v,x),D=n.add(D,b),b=n.mul(B,x),M=n.mul(I,M),M=n.sub(M,b),b=n.mul(I,v),T=n.mul(B,T),T=n.add(T,b),new p(M,D,T)}subtract(C){return this.add(C.negate())}is0(){return this.equals(p.ZERO)}wNAF(C){return A.wNAFCached(this,C,p.normalizeZ)}multiplyUnsafe(C){const{endo:_,n:P}=e;Xa("scalar",C,Xs,P);const k=p.ZERO;if(C===Xs)return k;if(this.is0()||C===Lt)return this;if(!_||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,C,p.normalizeZ);let{k1neg:U,k1:$,k2neg:L,k2:M}=_.splitScalar(C),D=k,T=k,O=this;for(;$>Xs||M>Xs;)$&Lt&&(D=D.add(O)),M&Lt&&(T=T.add(O)),O=O.double(),$>>=Lt,M>>=Lt;return U&&(D=D.negate()),L&&(T=T.negate()),T=new p(n.mul(T.px,_.beta),T.py,T.pz),D.add(T)}multiply(C){const{endo:_,n:P}=e;Xa("scalar",C,Lt,P);let k,U;if(_){const{k1neg:$,k1:L,k2neg:M,k2:D}=_.splitScalar(C);let{p:T,f:O}=this.wNAF(L),{p:m,f:b}=this.wNAF(D);T=A.constTimeNegate($,T),m=A.constTimeNegate(M,m),m=new p(n.mul(m.px,_.beta),m.py,m.pz),k=T.add(m),U=O.add(b)}else{const{p:$,f:L}=this.wNAF(C);k=$,U=L}return p.normalizeZ([k,U])[0]}multiplyAndAddUnsafe(C,_,P){const k=p.BASE,U=(L,M)=>M===Xs||M===Lt||!L.equals(k)?L.multiplyUnsafe(M):L.multiply(M),$=U(this,_).add(U(C,P));return $.is0()?void 0:$}toAffine(C){return h(this,C)}isTorsionFree(){const{h:C,isTorsionFree:_}=e;if(C===Lt)return!0;if(_)return _(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:C,clearCofactor:_}=e;return C===Lt?this:_?_(p,this):this.multiplyUnsafe(e.h)}toRawBytes(C=!0){return tl("isCompressed",C),this.assertValidity(),s(p,this,C)}toHex(C=!0){return tl("isCompressed",C),nl(this.toRawBytes(C))}}p.BASE=new p(e.Gx,e.Gy,n.ONE),p.ZERO=new p(n.ZERO,n.ONE,n.ZERO);const{endo:y,nBitLength:E}=e,A=z$(p,y?Math.ceil(E/2):E);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:l}}function Y$(t){const e=dI(t);return kh(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Z$(t){const e=Y$(t),{Fp:n,n:r,nByteLength:s,nBitLength:i}=e,o=n.BYTES+1,a=2*n.BYTES+1;function c(m){return Dn(m,r)}function u(m){return Jg(m,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:h}=G$({...e,toBytes(m,b,v){const S=b.toAffine(),I=n.toBytes(S.x),x=Of;return tl("isCompressed",v),v?x(Uint8Array.from([b.hasEvenY()?2:3]),I):x(Uint8Array.from([4]),I,n.toBytes(S.y))},fromBytes(m){const b=m.length,v=m[0],S=m.subarray(1);if(b===o&&(v===2||v===3)){const I=qo(S);if(!lb(I,Lt,n.ORDER))throw new Error("Point is not on curve");const x=f(I);let B;try{B=n.sqrt(x)}catch(j){const q=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+q)}const F=(B&Lt)===Lt;return(v&1)===1!==F&&(B=n.neg(B)),{x:I,y:B}}else if(b===a&&v===4){const I=n.fromBytes(S.subarray(0,n.BYTES)),x=n.fromBytes(S.subarray(n.BYTES,2*n.BYTES));return{x:I,y:x}}else{const I=o,x=a;throw new Error("invalid Point, expected length of "+I+", or uncompressed "+x+", got "+b)}}});function g(m){const b=r>>Lt;return m>b}function p(m){return g(m)?c(-m):m}const y=(m,b,v)=>qo(m.slice(b,v));class E{constructor(b,v,S){Xa("r",b,Lt,r),Xa("s",v,Lt,r),this.r=b,this.s=v,S!=null&&(this.recovery=S),Object.freeze(this)}static fromCompact(b){const v=s;return b=br("compactSignature",b,v*2),new E(y(b,0,v),y(b,v,2*v))}static fromDER(b){const{r:v,s:S}=Gs.toSig(br("DER",b));return new E(v,S)}assertValidity(){}addRecoveryBit(b){return new E(this.r,this.s,b)}recoverPublicKey(b){const{r:v,s:S,recovery:I}=this,x=k(br("msgHash",b));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const B=I===2||I===3?v+e.n:v;if(B>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const F=(I&1)===0?"02":"03",W=l.fromHex(F+Zp(B,n.BYTES)),j=u(B),q=c(-x*j),Y=c(S*j),Q=l.BASE.multiplyAndAddUnsafe(W,q,Y);if(!Q)throw new Error("point at infinify");return Q.assertValidity(),Q}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Pf(this.toDERHex())}toDERHex(){return Gs.hexFromSig(this)}toCompactRawBytes(){return Pf(this.toCompactHex())}toCompactHex(){const b=s;return Zp(this.r,b)+Zp(this.s,b)}}const A={isValidPrivateKey(m){try{return d(m),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const m=cI(e.n);return F$(e.randomBytes(m),e.n)},precompute(m=8,b=l.BASE){return b._setWindowSize(m),b.multiply(BigInt(3)),b}};function w(m,b=!0){return l.fromPrivateKey(m).toRawBytes(b)}function C(m){if(typeof m=="bigint")return!1;if(m instanceof l)return!0;const v=br("key",m).length,S=n.BYTES,I=S+1,x=2*S+1;if(!(e.allowedPrivateKeyLengths||s===I))return v===I||v===x}function _(m,b,v=!0){if(C(m)===!0)throw new Error("first arg must be private key");if(C(b)===!1)throw new Error("second arg must be public key");return l.fromHex(b).multiply(d(m)).toRawBytes(v)}const P=e.bits2int||function(m){if(m.length>8192)throw new Error("input is too large");const b=qo(m),v=m.length*8-i;return v>0?b>>BigInt(v):b},k=e.bits2int_modN||function(m){return c(P(m))},U=Rh(i);function $(m){return Xa("num < 2^"+i,m,Xs,U),Pl(m,s)}function L(m,b,v=M){if(["recovered","canonical"].some(J=>J in v))throw new Error("sign() legacy options not supported");const{hash:S,randomBytes:I}=e;let{lowS:x,prehash:B,extraEntropy:F}=v;x==null&&(x=!0),m=br("msgHash",m),D1(v),B&&(m=br("prehashed msgHash",S(m)));const W=k(m),j=d(b),q=[$(j),$(W)];if(F!=null&&F!==!1){const J=F===!0?I(n.BYTES):F;q.push(br("extraEntropy",J))}const Y=Of(...q),Q=W;function ue(J){const te=P(J);if(!h(te))return;const Ae=u(te),Oe=l.BASE.multiply(te).toAffine(),Be=c(Oe.x);if(Be===Xs)return;const rt=c(Ae*c(Q+Be*j));if(rt===Xs)return;let St=(Oe.x===Be?0:2)|Number(Oe.y&Lt),ns=rt;return x&&g(rt)&&(ns=p(rt),St^=1),new E(Be,ns,St)}return{seed:Y,k2sig:ue}}const M={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function T(m,b,v=M){const{seed:S,k2sig:I}=L(m,b,v),x=e;return hR(x.hash.outputLen,x.nByteLength,x.hmac)(S,I)}l.BASE._setWindowSize(8);function O(m,b,v,S=D){const I=m;b=br("msgHash",b),v=br("publicKey",v);const{lowS:x,prehash:B,format:F}=S;if(D1(S),"strict"in S)throw new Error("options.strict was renamed to lowS");if(F!==void 0&&F!=="compact"&&F!=="der")throw new Error("format must be compact or der");const W=typeof I=="string"||xl(I),j=!W&&!F&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!W&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,Y;try{if(j&&(q=new E(I.r,I.s)),W){try{F!=="compact"&&(q=E.fromDER(I))}catch(St){if(!(St instanceof Gs.Err))throw St}!q&&F!=="der"&&(q=E.fromCompact(I))}Y=l.fromHex(v)}catch{return!1}if(!q||x&&q.hasHighS())return!1;B&&(b=e.hash(b));const{r:Q,s:ue}=q,J=k(b),te=u(ue),Ae=c(J*te),Oe=c(Q*te),Be=l.BASE.multiplyAndAddUnsafe(Y,Ae,Oe)?.toAffine();return Be?c(Be.x)===Q:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:_,sign:T,verify:O,ProjectivePoint:l,Signature:E,utils:A}}function J$(t){return{hash:t,hmac:(e,...n)=>Hh(t,e,fs(...n)),randomBytes:ch}}function X$(t,e){const n=r=>Z$({...t,...J$(r)});return{...n(e),create:n}}const fI=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),U1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Q$=BigInt(0),e4=BigInt(1),Qg=BigInt(2),B1=(t,e)=>(t+e/Qg)/e;function t4(t){const e=fI,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,d=dr(l,n,e)*l%e,f=dr(d,n,e)*l%e,h=dr(f,Qg,e)*u%e,g=dr(h,s,e)*h%e,p=dr(g,i,e)*g%e,y=dr(p,a,e)*p%e,E=dr(y,c,e)*y%e,A=dr(E,a,e)*p%e,w=dr(A,n,e)*l%e,C=dr(w,o,e)*g%e,_=dr(C,r,e)*u%e,P=dr(_,Qg,e);if(!em.eql(em.sqr(P),t))throw new Error("Cannot find square root");return P}const em=Nb(fI,void 0,void 0,{sqrt:t4}),xb=X$({a:Q$,b:BigInt(7),Fp:em,n:U1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=U1,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-e4*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=B1(i*t,e),c=B1(-r*t,e);let u=Dn(t-a*n-c*s,e),l=Dn(-a*r-c*i,e);const d=u>o,f=l>o;if(d&&(u=e-u),f&&(l=e-l),u>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:l}}}},nb),n4=Object.freeze(Object.defineProperty({__proto__:null,secp256k1:xb},Symbol.toStringTag,{value:"Module"}));function hI(t,e={}){const{recovered:n}=e;if(typeof t.r>"u")throw new Xp({signature:t});if(typeof t.s>"u")throw new Xp({signature:t});if(n&&typeof t.yParity>"u")throw new Xp({signature:t});if(t.r<0n||t.r>x1)throw new u4({value:t.r});if(t.s<0n||t.s>x1)throw new l4({value:t.s});if(typeof t.yParity=="number"&&t.yParity!==0&&t.yParity!==1)throw new Ob({value:t.yParity})}function r4(t){return pI(Xr(t))}function pI(t){if(t.length!==130&&t.length!==132)throw new c4({signature:t});const e=BigInt(vs(t,0,32)),n=BigInt(vs(t,32,64)),r=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return Pb(s)}catch{throw new Ob({value:s})}})();return typeof r>"u"?{r:e,s:n}:{r:e,s:n,yParity:r}}function s4(t){if(!(typeof t.r>"u")&&!(typeof t.s>"u"))return i4(t)}function i4(t){const e=typeof t=="string"?pI(t):t instanceof Uint8Array?r4(t):typeof t.r=="string"?a4(t):t.v?o4(t):{r:t.r,s:t.s,...typeof t.yParity<"u"?{yParity:t.yParity}:{}};return hI(e),e}function o4(t){return{r:t.r,s:t.s,yParity:Pb(t.v)}}function a4(t){const e=(()=>{const n=t.v?Number(t.v):void 0;let r=t.yParity?Number(t.yParity):void 0;if(typeof n=="number"&&typeof r!="number"&&(r=Pb(n)),typeof r!="number")throw new Ob({value:t.yParity});return r})();return{r:BigInt(t.r),s:BigInt(t.s),yParity:e}}function Pb(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new d4({value:t})}let c4=class extends Fe{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${ur(MR(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}};class Xp extends Fe{constructor({signature:e}){super(`Signature \`${H2(e)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class u4 extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class l4 extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}let Ob=class extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}},d4=class extends Fe{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}};function f4(t,e={}){return typeof t.chainId=="string"?h4(t):{...t,...e.signature}}function h4(t){const{address:e,chainId:n,nonce:r}=t,s=s4(t);return{address:e,chainId:Number(n),nonce:BigInt(r),...s}}const p4="0x8010801080108010801080108010801080108010801080108010801080108010",g4=JS("(uint256 chainId, address delegation, uint256 nonce, uint8 yParity, uint256 r, uint256 s), address to, bytes data");function gI(t){if(typeof t=="string"){if(vs(t,-32)!==p4)throw new b4(t)}else hI(t.authorization)}function m4(t){gI(t);const e=Y2(vs(t,-64,-32)),n=vs(t,-e-64,-64),r=vs(t,0,-e-64),[s,i,o]=N$(g4,n);return{authorization:f4({address:s.delegation,chainId:Number(s.chainId),nonce:s.nonce,yParity:s.yParity,r:s.r,s:s.s}),signature:r,...o&&o!=="0x"?{data:o,to:i}:{}}}function y4(t){try{return gI(t),!0}catch{return!1}}let b4=class extends Fe{constructor(e){super(`Value \`${e}\` is an invalid ERC-8010 wrapped signature.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SignatureErc8010.InvalidWrappedSignatureError"})}};function w4(t){const{address:e,data:n,signature:r,to:s="hex"}=t,i=Sn([xs([{type:"address"},{type:"bytes"},{type:"bytes"}],[e,n,r]),t$]);return s==="hex"?i:cr(i)}class mI extends K{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function yI(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new mI({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}function E4(t){return t.map(e=>({...e,value:BigInt(e.value)}))}function v4(t){return{...t,balance:t.balance?BigInt(t.balance):void 0,nonce:t.nonce?ar(t.nonce):void 0,storageProof:t.storageProof?E4(t.storageProof):void 0}}async function C4(t,{address:e,blockNumber:n,blockTag:r,storageKeys:s}){const i=r??"latest",o=n!==void 0?ee(n):void 0,a=await t.request({method:"eth_getProof",params:[e,s,o||i]});return v4(a)}async function _4(t,{address:e,blockNumber:n,blockTag:r="latest",slot:s}){const i=n!==void 0?ee(n):void 0;return await t.request({method:"eth_getStorageAt",params:[e,s,i||r]})}async function Wh(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i,sender:o,nonce:a}){const c=r||"latest",u=n!==void 0?ee(n):void 0;let l=null;if(s?l=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?l=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,ee(i)]},{dedupe:!0}):typeof i=="number"?l=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[u||c,ee(i)]},{dedupe:!!u}):o&&typeof a=="number"&&(l=await t.request({method:"eth_getTransactionBySenderAndNonce",params:[o,ee(a)]},{dedupe:!0})),!l)throw new Wy({blockHash:e,blockNumber:n,blockTag:c,hash:s,index:i});return(t.chain?.formatters?.transaction?.format||Nl)(l,"getTransaction")}async function A4(t,{hash:e,transactionReceipt:n}){const[r,s]=await Promise.all([ve(t,kl,"getBlockNumber")({}),e?ve(t,Wh,"getTransaction")({hash:e}):void 0]),i=n?.blockNumber||s?.blockNumber;return i?r-i+1n:0n}async function zd(t,{hash:e}){const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new Vy({hash:e});return(t.chain?.formatters?.transactionReceipt?.format||Lh)(n,"getTransactionReceipt")}async function bI(t,e){const{account:n,authorizationList:r,allowFailure:s=!0,blockNumber:i,blockOverrides:o,blockTag:a,stateOverride:c}=e,u=e.contracts,{batchSize:l=e.batchSize??1024,deployless:d=e.deployless??!1}=typeof t.batch?.multicall=="object"?t.batch.multicall:{},f=(()=>{if(e.multicallAddress)return e.multicallAddress;if(d)return null;if(t.chain)return ga({blockNumber:i,chain:t.chain,contract:"multicall3"});throw new Error("client chain not configured. multicallAddress is required.")})(),h=[[]];let g=0,p=0;for(let A=0;A<u.length;A++){const{abi:w,address:C,args:_,functionName:P}=u[A];try{const k=lr({abi:w,args:_,functionName:P});p+=(k.length-2)/2,l>0&&p>l&&h[g].length>0&&(g++,p=(k.length-2)/2,h[g]=[]),h[g]=[...h[g],{allowFailure:!0,callData:k,target:C}]}catch(k){const U=so(k,{abi:w,address:C,args:_,docsPath:"/docs/contract/multicall",functionName:P,sender:n});if(!s)throw U;h[g]=[...h[g],{allowFailure:!0,callData:"0x",target:C}]}}const y=await Promise.allSettled(h.map(A=>ve(t,Ir,"readContract")({...f===null?{code:hb}:{address:f},abi:rl,account:n,args:[A],authorizationList:r,blockNumber:i,blockOverrides:o,blockTag:a,functionName:"aggregate3",stateOverride:c}))),E=[];for(let A=0;A<y.length;A++){const w=y[A];if(w.status==="rejected"){if(!s)throw w.reason;for(let _=0;_<h[A].length;_++)E.push({status:"failure",error:w.reason,result:void 0});continue}const C=w.value;for(let _=0;_<C.length;_++){const{returnData:P,success:k}=C[_],{callData:U}=h[A][_],{abi:$,address:L,functionName:M,args:D}=u[E.length];try{if(U==="0x")throw new Bc;if(!k)throw new Il({data:P});const T=lo({abi:$,args:D,data:P,functionName:M});E.push(s?{result:T,status:"success"}:T)}catch(T){const O=so(T,{abi:$,address:L,args:D,docsPath:"/docs/contract/multicall",functionName:M});if(!s)throw O;E.push({error:O,result:void 0,status:"failure"})}}}if(E.length!==u.length)throw new K("multicall results mismatch");return E}async function tm(t,e){const{blockNumber:n,blockTag:r=t.experimental_blockTag??"latest",blocks:s,returnFullTransactions:i,traceTransfers:o,validation:a}=e;try{const c=[];for(const f of s){const h=f.blockOverrides?X2(f.blockOverrides):void 0,g=f.calls.map(y=>{const E=y,A=E.account?Qt(E.account):void 0,w=E.abi?lr(E):E.data,C={...E,account:A,data:E.dataSuffix?Sr([w||"0x",E.dataSuffix]):w,from:E.from??A?.address};return ha(C),qc(C)}),p=f.stateOverrides?Jy(f.stateOverrides):void 0;c.push({blockOverrides:h,calls:g,stateOverrides:p})}const l=(typeof n=="bigint"?ee(n):void 0)||r;return(await t.request({method:"eth_simulateV1",params:[{blockStateCalls:c,returnFullTransactions:i,traceTransfers:o,validation:a},l]})).map((f,h)=>({...Ah(f),calls:f.calls.map((g,p)=>{const{abi:y,args:E,functionName:A,to:w}=s[h].calls[p],C=g.error?.data??g.returnData,_=BigInt(g.gasUsed),P=g.logs?.map(L=>Is(L)),k=g.status==="0x1"?"success":"failure",U=y&&k==="success"&&C!=="0x"?lo({abi:y,data:C,functionName:A}):null,$=(()=>{if(k==="success")return;let L;if(g.error?.data==="0x"?L=new Bc:g.error&&(L=new Il(g.error)),!!L)return so(L,{abi:y??[],address:w??"0x",args:E,functionName:A??"<unknown>"})})();return{data:C,gasUsed:_,logs:P,status:k,...k==="success"?{result:U}:{error:$}}})}))}catch(c){const u=c,l=vh(u,{});throw l instanceof jc?u:l}}function nm(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function","error",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new Fe("Unable to normalize signature.");return s}function rm(t,e){const n=typeof t,r=e.type;switch(r){case"address":return Gg(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>rm(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>rm(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function wI(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return wI(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?Gg(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?Gg(n[r],{strict:!1}):!1)return o}}function EI(t,e={}){const{prepare:n=!0}=e,r=Array.isArray(t)||typeof t=="string"?Og(t):t;return{...r,...n?{hash:qa(r)}:{}}}function Vh(t,e,n){const{args:r=[],prepare:s=!0}=n??{},i=LR(e,{strict:!1}),o=t.filter(u=>i?u.type==="function"||u.type==="error"?vI(u)===vs(e,0,4):u.type==="event"?qa(u)===e:!1:"name"in u&&u.name===e);if(o.length===0)throw new Mf({name:e});if(o.length===1)return{...o[0],...s?{hash:qa(o[0])}:{}};let a;for(const u of o){if(!("inputs"in u))continue;if(!r||r.length===0){if(!u.inputs||u.inputs.length===0)return{...u,...s?{hash:qa(u)}:{}};continue}if(!u.inputs||u.inputs.length===0||u.inputs.length!==r.length)continue;if(r.every((d,f)=>{const h="inputs"in u&&u.inputs[f];return h?rm(d,h):!1})){if(a&&"inputs"in a&&a.inputs){const d=wI(u.inputs,a.inputs,r);if(d)throw new I4({abiItem:u,type:d[0]},{abiItem:a,type:d[1]})}a=u}}const c=(()=>{if(a)return a;const[u,...l]=o;return{...u,overloads:l}})();if(!c)throw new Mf({name:e});return{...c,...s?{hash:qa(c)}:{}}}function vI(...t){const e=(()=>{if(Array.isArray(t[0])){const[n,r]=t;return Vh(n,r)}return t[0]})();return vs(qa(e),0,4)}function S4(...t){const e=(()=>{if(Array.isArray(t[0])){const[r,s]=t;return Vh(r,s)}return t[0]})(),n=typeof e=="string"?e:bf(e);return nm(n)}function qa(...t){const e=(()=>{if(Array.isArray(t[0])){const[n,r]=t;return Vh(n,r)}return t[0]})();return typeof e!="string"&&"hash"in e&&e.hash?e.hash:GS(db(S4(e)))}class I4 extends Fe{constructor(e,n){super("Found ambiguous types in overloaded ABI Items.",{metaMessages:[`\`${e.type}\` in \`${nm(bf(e.abiItem))}\`, and`,`\`${n.type}\` in \`${nm(bf(n.abiItem))}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiItem.AmbiguityError"})}}class Mf extends Fe{constructor({name:e,data:n,type:r="item"}){const s=e?` with name "${e}"`:n?` with data "${n}"`:"";super(`ABI ${r}${s} not found.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiItem.NotFoundError"})}}function T4(...t){const[e,n]=(()=>{if(Array.isArray(t[0])){const[i,o]=t;return[x4(i),o]}return t})(),{bytecode:r,args:s}=n;return Jr(r,e.inputs?.length&&s?.length?Ib(e.inputs,s):"0x")}function N4(t){return EI(t)}function x4(t){const e=t.find(n=>n.type==="constructor");if(!e)throw new Mf({name:"constructor"});return e}function P4(...t){const[e,n=[]]=(()=>{if(Array.isArray(t[0])){const[u,l,d]=t;return[M1(u,l,{args:d}),d]}const[a,c]=t;return[a,c]})(),{overloads:r}=e,s=r?M1([e,...r],e.name,{args:n}):e,i=O4(s),o=n.length>0?Ib(s.inputs,n):void 0;return o?Jr(i,o):i}function Aa(t,e={}){return EI(t,e)}function M1(t,e,n){const r=Vh(t,e,n);if(r.type!=="function")throw new Mf({name:e,type:"function"});return r}function O4(t){return vI(t)}const CI="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",$r="0x0000000000000000000000000000000000000000",R4="0x6080604052348015600e575f80fd5b5061016d8061001c5f395ff3fe608060405234801561000f575f80fd5b5060043610610029575f3560e01c8063f8b2cb4f1461002d575b5f80fd5b610047600480360381019061004291906100db565b61005d565b604051610054919061011e565b60405180910390f35b5f8173ffffffffffffffffffffffffffffffffffffffff16319050919050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100aa82610081565b9050919050565b6100ba816100a0565b81146100c4575f80fd5b50565b5f813590506100d5816100b1565b92915050565b5f602082840312156100f0576100ef61007d565b5b5f6100fd848285016100c7565b91505092915050565b5f819050919050565b61011881610106565b82525050565b5f6020820190506101315f83018461010f565b9291505056fea26469706673582212203b9fe929fe995c7cf9887f0bdba8a36dd78e8b73f149b17d2d9ad7cd09d2dc6264736f6c634300081a0033";async function k4(t,e){const{blockNumber:n,blockTag:r,calls:s,stateOverrides:i,traceAssetChanges:o,traceTransfers:a,validation:c}=e,u=e.account?Qt(e.account):void 0;if(o&&!u)throw new K("`account` is required when `traceAssetChanges` is true");const l=u?T4(N4("constructor(bytes, bytes)"),{bytecode:fb,args:[R4,P4(Aa("function getBalance(address)"),[u.address])]}):void 0,d=o?await Promise.all(e.calls.map(async S=>{if(!S.data&&!S.abi)return;const{accessList:I}=await IS(t,{account:u.address,...S,data:S.abi?lr(S):S.data});return I.map(({address:x,storageKeys:B})=>B.length>0?x:null)})).then(S=>S.flat().filter(Boolean)):[],f=await tm(t,{blockNumber:n,blockTag:r,blocks:[...o?[{calls:[{data:l}],stateOverrides:i},{calls:d.map((S,I)=>({abi:[Aa("function balanceOf(address) returns (uint256)")],functionName:"balanceOf",args:[u.address],to:S,from:$r,nonce:I})),stateOverrides:[{address:$r,nonce:0}]}]:[],{calls:[...s,{}].map(S=>({...S,from:u?.address})),stateOverrides:i},...o?[{calls:[{data:l}]},{calls:d.map((S,I)=>({abi:[Aa("function balanceOf(address) returns (uint256)")],functionName:"balanceOf",args:[u.address],to:S,from:$r,nonce:I})),stateOverrides:[{address:$r,nonce:0}]},{calls:d.map((S,I)=>({to:S,abi:[Aa("function decimals() returns (uint256)")],functionName:"decimals",from:$r,nonce:I})),stateOverrides:[{address:$r,nonce:0}]},{calls:d.map((S,I)=>({to:S,abi:[Aa("function tokenURI(uint256) returns (string)")],functionName:"tokenURI",args:[0n],from:$r,nonce:I})),stateOverrides:[{address:$r,nonce:0}]},{calls:d.map((S,I)=>({to:S,abi:[Aa("function symbol() returns (string)")],functionName:"symbol",from:$r,nonce:I})),stateOverrides:[{address:$r,nonce:0}]}]:[]],traceTransfers:a,validation:c}),h=o?f[2]:f[0],[g,p,,y,E,A,w,C]=o?f:[],{calls:_,...P}=h,k=_.slice(0,-1)??[],U=g?.calls??[],$=p?.calls??[],L=[...U,...$].map(S=>S.status==="success"?zt(S.data):null),M=y?.calls??[],D=E?.calls??[],T=[...M,...D].map(S=>S.status==="success"?zt(S.data):null),O=(A?.calls??[]).map(S=>S.status==="success"?S.result:null),m=(C?.calls??[]).map(S=>S.status==="success"?S.result:null),b=(w?.calls??[]).map(S=>S.status==="success"?S.result:null),v=[];for(const[S,I]of T.entries()){const x=L[S];if(typeof I!="bigint"||typeof x!="bigint")continue;const B=O[S-1],F=m[S-1],W=b[S-1],j=S===0?{address:CI,decimals:18,symbol:"ETH"}:{address:d[S-1],decimals:W||B?Number(B??1):void 0,symbol:F??void 0};v.some(q=>q.token.address===j.address)||v.push({token:j,value:{pre:x,post:I,diff:I-x}})}return{assetChanges:v,block:P,results:k}}const _I="0x6492649264926492649264926492649264926492649264926492649264926492";function $4(t){if(vs(t,-32)!==_I)throw new B4(t)}function D4(t){const{data:e,signature:n,to:r}=t;return Jr(Ib(JS("address, bytes, bytes"),[r,e,n]),_I)}function U4(t){try{return $4(t),!0}catch{return!1}}class B4 extends Fe{constructor(e){super(`Value \`${e}\` is an invalid ERC-6492 wrapped signature.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SignatureErc6492.InvalidWrappedSignatureError"})}}function sm({r:t,s:e,to:n="hex",v:r,yParity:s}){const i=(()=>{if(s===0||s===1)return s;if(r&&(r===27n||r===28n||r>=35n))return r%2n===0n?1:0;throw new Error("Invalid `v` or `yParity` value")})(),o=`0x${new xb.Signature(zt(t),zt(e)).toCompactHex()}${i===0?"1b":"1c"}`;return n==="hex"?o:cr(o)}async function Kh(t,e){const{address:n,hash:r,erc6492VerifierAddress:s=e.universalSignatureVerifierAddress??t.chain?.contracts?.erc6492Verifier?.address,multicallAddress:i=e.multicallAddress??t.chain?.contracts?.multicall3?.address}=e,o=(()=>{const a=e.signature;return Ar(a)?a:typeof a=="object"&&"r"in a&&"s"in a?sm(a):Ct(a)})();try{return y4(o)?await M4(t,{...e,multicallAddress:i,signature:o}):await L4(t,{...e,verifierAddress:s,signature:o})}catch(a){try{if(pa(ps(n),await Gy({hash:r,signature:o})))return!0}catch{}if(a instanceof na)return!1;throw a}}async function M4(t,e){const{address:n,blockNumber:r,blockTag:s,hash:i,multicallAddress:o}=e,{authorization:a,data:c,signature:u,to:l}=m4(e.signature);if(await Kg(t,{address:n,blockNumber:r,blockTag:s})===Sn(["0xef0100",a.address]))return await F4(t,{address:n,blockNumber:r,blockTag:s,hash:i,signature:u});const f={address:a.address,chainId:Number(a.chainId),nonce:Number(a.nonce),r:ee(a.r,{size:32}),s:ee(a.s,{size:32}),yParity:a.yParity};if(!await jk({address:n,authorization:f}))throw new na;const g=await ve(t,Ir,"readContract")({...o?{address:o}:{code:hb},authorizationList:[f],abi:rl,blockNumber:r,blockTag:"pending",functionName:"aggregate3",args:[[...c?[{allowFailure:!0,target:l??n,callData:c}]:[],{allowFailure:!0,target:n,callData:lr({abi:tS,functionName:"isValidSignature",args:[i,u]})}]]});if(g[g.length-1]?.returnData?.startsWith("0x1626ba7e"))return!0;throw new na}async function L4(t,e){const{address:n,factory:r,factoryData:s,hash:i,signature:o,verifierAddress:a,...c}=e,u=await(async()=>!r&&!s||U4(o)?o:D4({data:s,signature:o,to:r}))(),l=a?{to:a,data:lr({abi:Rf,functionName:"isValidSig",args:[n,i,u]}),...c}:{data:Dh({abi:Rf,args:[n,i,u],bytecode:Hg}),...c},{data:d}=await ve(t,zc,"call")(l).catch(f=>{throw f instanceof Ky?new na:f});if(LA(d??"0x0"))return!0;throw new na}async function F4(t,e){const{address:n,blockNumber:r,blockTag:s,hash:i,signature:o}=e;if((await ve(t,Ir,"readContract")({address:n,abi:tS,args:[i,o],blockNumber:r,blockTag:s,functionName:"isValidSignature"}).catch(c=>{throw c instanceof wh?new na:c})).startsWith("0x1626ba7e"))return!0;throw new na}class na extends Error{}async function j4(t,{address:e,message:n,factory:r,factoryData:s,signature:i,...o}){const a=vb(n);return Kh(t,{address:e,factory:r,factoryData:s,hash:a,signature:i,...o})}async function q4(t,e){const{address:n,factory:r,factoryData:s,signature:i,message:o,primaryType:a,types:c,domain:u,...l}=e,d=zS({message:o,primaryType:a,types:c,domain:u});return Kh(t,{address:n,factory:r,factoryData:s,hash:d,signature:i,...l})}function AI(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=Et(["watchBlockNumber",t.uid,e,n,o]);return gi(d,{onBlockNumber:r,onError:s},f=>Hc(async()=>{try{const h=await ve(t,kl,"getBlockNumber")({cacheTime:0});if(c!==void 0){if(h===c)return;if(h-c>1&&n)for(let g=c+1n;g<h;g++)f.onBlockNumber(g,c),c=g}(c===void 0||h>c)&&(f.onBlockNumber(h,c),c=h)}catch(h){f.onError?.(h)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=Et(["watchBlockNumber",t.uid,e,n]);return gi(d,{onBlockNumber:r,onError:s},f=>{let h=!0,g=()=>h=!1;return(async()=>{try{const p=(()=>{if(t.transport.type==="fallback"){const E=t.transport.transports.find(A=>A.config.type==="webSocket"||A.config.type==="ipc");return E?E.value:t.transport}return t.transport})(),{unsubscribe:y}=await p.subscribe({params:["newHeads"],onData(E){if(!h)return;const A=zt(E.result?.number);f.onBlockNumber(A,c),c=A},onError(E){f.onError?.(E)}});g=y,h||g()}catch(p){s?.(p)}})(),()=>g()})})()}async function SI(t,e){const{checkReplacement:n=!0,confirmations:r=1,hash:s,onReplaced:i,retryCount:o=6,retryDelay:a=({count:_})=>~~(1<<_)*200,timeout:c=18e4}=e,u=Et(["waitForTransactionReceipt",t.uid,s]),l=e.pollingInterval?e.pollingInterval:t.chain?.experimental_preconfirmationTime?t.chain.experimental_preconfirmationTime:t.pollingInterval;let d,f,h,g=!1,p,y;const{promise:E,resolve:A,reject:w}=gb(),C=c?setTimeout(()=>{y?.(),p?.(),w(new d2({hash:s}))},c):void 0;return p=gi(u,{onReplaced:i,resolve:A,reject:w},async _=>{if(h=await ve(t,zd,"getTransactionReceipt")({hash:s}).catch(()=>{}),h&&r<=1){clearTimeout(C),_.resolve(h),p?.();return}y=ve(t,AI,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:l,async onBlockNumber(P){const k=$=>{clearTimeout(C),y?.(),$(),p?.()};let U=P;if(!g)try{if(h){if(r>1&&(!h.blockNumber||U-h.blockNumber+1n<r))return;k(()=>_.resolve(h));return}if(n&&!d&&(g=!0,await Oc(async()=>{d=await ve(t,Wh,"getTransaction")({hash:s}),d.blockNumber&&(U=d.blockNumber)},{delay:a,retryCount:o}),g=!1),h=await ve(t,zd,"getTransactionReceipt")({hash:s}),r>1&&(!h.blockNumber||U-h.blockNumber+1n<r))return;k(()=>_.resolve(h))}catch($){if($ instanceof Wy||$ instanceof Vy){if(!d){g=!1;return}try{f=d,g=!0;const L=await Oc(()=>ve(t,gs,"getBlock")({blockNumber:U,includeTransactions:!0}),{delay:a,retryCount:o,shouldRetry:({error:T})=>T instanceof Xy});g=!1;const M=L.transactions.find(({from:T,nonce:O})=>T===f.from&&O===f.nonce);if(!M||(h=await ve(t,zd,"getTransactionReceipt")({hash:M.hash}),r>1&&(!h.blockNumber||U-h.blockNumber+1n<r)))return;let D="replaced";M.to===f.to&&M.value===f.value&&M.input===f.input?D="repriced":M.from===M.to&&M.value===0n&&(D="cancelled"),k(()=>{_.onReplaced?.({reason:D,replacedTransaction:f,transaction:M,transactionReceipt:h}),_.resolve(h)})}catch(L){k(()=>_.reject(L))}}else k(()=>_.reject($))}}})}),E}function z4(t,{blockTag:e=t.experimental_blockTag??"latest",emitMissed:n=!1,emitOnBegin:r=!1,onBlock:s,onError:i,includeTransactions:o,poll:a,pollingInterval:c=t.pollingInterval}){const u=typeof a<"u"?a:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc")),l=o??!1;let d;return u?(()=>{const g=Et(["watchBlocks",t.uid,e,n,r,l,c]);return gi(g,{onBlock:s,onError:i},p=>Hc(async()=>{try{const y=await ve(t,gs,"getBlock")({blockTag:e,includeTransactions:l});if(y.number!==null&&d?.number!=null){if(y.number===d.number)return;if(y.number-d.number>1&&n)for(let E=d?.number+1n;E<y.number;E++){const A=await ve(t,gs,"getBlock")({blockNumber:E,includeTransactions:l});p.onBlock(A,d),d=A}}(d?.number==null||e==="pending"&&y?.number==null||y.number!==null&&y.number>d.number)&&(p.onBlock(y,d),d=y)}catch(y){p.onError?.(y)}},{emitOnBegin:r,interval:c}))})():(()=>{let g=!0,p=!0,y=()=>g=!1;return(async()=>{try{r&&ve(t,gs,"getBlock")({blockTag:e,includeTransactions:l}).then(w=>{g&&p&&(s(w,void 0),p=!1)}).catch(i);const E=(()=>{if(t.transport.type==="fallback"){const w=t.transport.transports.find(C=>C.config.type==="webSocket"||C.config.type==="ipc");return w?w.value:t.transport}return t.transport})(),{unsubscribe:A}=await E.subscribe({params:["newHeads"],async onData(w){if(!g)return;const C=await ve(t,gs,"getBlock")({blockNumber:w.result?.number,includeTransactions:l}).catch(()=>{});g&&(s(C,d),p=!1,d=C)},onError(w){i?.(w)}});y=A,g||y()}catch(E){i?.(E)}})(),()=>y()})()}function H4(t,{address:e,args:n,batch:r=!0,event:s,events:i,fromBlock:o,onError:a,onLogs:c,poll:u,pollingInterval:l=t.pollingInterval,strict:d}){const f=typeof u<"u"?u:typeof o=="bigint"?!0:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc")),h=d??!1;return f?(()=>{const y=Et(["watchEvent",e,n,r,t.uid,s,l,o]);return gi(y,{onLogs:c,onError:a},E=>{let A;o!==void 0&&(A=o-1n);let w,C=!1;const _=Hc(async()=>{if(!C){try{w=await ve(t,TS,"createEventFilter")({address:e,args:n,event:s,events:i,strict:h,fromBlock:o})}catch{}C=!0;return}try{let P;if(w)P=await ve(t,Uh,"getFilterChanges")({filter:w});else{const k=await ve(t,kl,"getBlockNumber")({});A&&A!==k?P=await ve(t,ab,"getLogs")({address:e,args:n,event:s,events:i,fromBlock:A+1n,toBlock:k}):P=[],A=k}if(P.length===0)return;if(r)E.onLogs(P);else for(const k of P)E.onLogs([k])}catch(P){w&&P instanceof ro&&(C=!1),E.onError?.(P)}},{emitOnBegin:!0,interval:l});return async()=>{w&&await ve(t,Bh,"uninstallFilter")({filter:w}),_()}})})():(()=>{let y=!0,E=()=>y=!1;return(async()=>{try{const A=(()=>{if(t.transport.type==="fallback"){const P=t.transport.transports.find(k=>k.config.type==="webSocket"||k.config.type==="ipc");return P?P.value:t.transport}return t.transport})(),w=i??(s?[s]:void 0);let C=[];w&&(C=[w.flatMap(k=>Lc({abi:[k],eventName:k.name,args:n}))],s&&(C=C[0]));const{unsubscribe:_}=await A.subscribe({params:["logs",{address:e,topics:C}],onData(P){if(!y)return;const k=P.result;try{const{eventName:U,args:$}=Ph({abi:w??[],data:k.data,topics:k.topics,strict:h}),L=Is(k,{args:$,eventName:U});c([L])}catch(U){let $,L;if(U instanceof dc||U instanceof Cl){if(d)return;$=U.abiItem.name,L=U.abiItem.inputs?.some(D=>!("name"in D&&D.name))}const M=Is(k,{args:L?[]:{},eventName:$});c([M])}},onError(P){a?.(P)}});E=_,y||E()}catch(A){a?.(A)}})(),()=>E()})()}function II(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const u=Et(["watchPendingTransactions",t.uid,e,i]);return gi(u,{onTransactions:r,onError:n},l=>{let d;const f=Hc(async()=>{try{if(!d)try{d=await ve(t,NS,"createPendingTransactionFilter")({});return}catch(g){throw f(),g}const h=await ve(t,Uh,"getFilterChanges")({filter:d});if(h.length===0)return;if(e)l.onTransactions(h);else for(const g of h)l.onTransactions([g])}catch(h){l.onError?.(h)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await ve(t,Bh,"uninstallFilter")({filter:d}),f()}})})():(()=>{let u=!0,l=()=>u=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(f){if(!u)return;const h=f.result;r([h])},onError(f){n?.(f)}});l=d,u||l()}catch(d){n?.(d)}})(),()=>l()})()}function W4(t){const{scheme:e,statement:n,...r}=t.match(V4)?.groups??{},{chainId:s,expirationTime:i,issuedAt:o,notBefore:a,requestId:c,...u}=t.match(K4)?.groups??{},l=t.split("Resources:")[1]?.split(`
- `).slice(1);return{...r,...u,...s?{chainId:Number(s)}:{},...i?{expirationTime:new Date(i)}:{},...o?{issuedAt:new Date(o)}:{},...a?{notBefore:new Date(a)}:{},...c?{requestId:c}:{},...l?{resources:l}:{},...e?{scheme:e}:{},...n?{statement:n}:{}}}const V4=/^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\/\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\n)(?<address>0x[a-fA-F0-9]{40})\n\n(?:(?<statement>.*)\n\n)?/,K4=/(?:URI: (?<uri>.+))\n(?:Version: (?<version>.+))\n(?:Chain ID: (?<chainId>\d+))\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\n(?:Issued At: (?<issuedAt>.+))(?:\nExpiration Time: (?<expirationTime>.+))?(?:\nNot Before: (?<notBefore>.+))?(?:\nRequest ID: (?<requestId>.+))?/;function G4(t){const{address:e,domain:n,message:r,nonce:s,scheme:i,time:o=new Date}=t;if(n&&r.domain!==n||s&&r.nonce!==s||i&&r.scheme!==i||r.expirationTime&&o>=r.expirationTime||r.notBefore&&o<r.notBefore)return!1;try{if(!r.address||!_t(r.address,{strict:!1})||e&&!pa(r.address,e))return!1}catch{return!1}return!0}async function Y4(t,e){const{address:n,domain:r,message:s,nonce:i,scheme:o,signature:a,time:c=new Date,...u}=e,l=W4(s);if(!l.address||!G4({address:n,domain:r,message:l,nonce:i,scheme:o,time:c}))return!1;const f=vb(s);return Kh(t,{address:l.address,hash:f,signature:a,...u})}async function Z4(t,{serializedTransaction:e,throwOnReceiptRevert:n,timeout:r}){const s=await t.request({method:"eth_sendRawTransactionSync",params:r?[e,ee(r)]:[e]},{retryCount:0}),o=(t.chain?.formatters?.transactionReceipt?.format||Lh)(s);if(o.status==="reverted"&&n)throw new U8({receipt:o});return o}function TI(t){return{call:e=>zc(t,e),createAccessList:e=>IS(t,e),createBlockFilter:()=>_k(t),createContractEventFilter:e=>KA(t,e),createEventFilter:e=>TS(t,e),createPendingTransactionFilter:()=>NS(t),estimateContractGas:e=>cR(t,e),estimateGas:e=>xh(t,e),getBalance:e=>xS(t,e),getBlobBaseFee:()=>Ak(t),getBlock:e=>gs(t,e),getBlockNumber:e=>kl(t,e),getBlockTransactionCount:e=>Sk(t,e),getBytecode:e=>Kg(t,e),getChainId:()=>Th(t),getCode:e=>Kg(t,e),getContractEvents:e=>U2(t,e),getEip712Domain:e=>Tk(t,e),getEnsAddress:e=>ck(t,e),getEnsAvatar:e=>Ek(t,e),getEnsName:e=>vk(t,e),getEnsResolver:e=>Ck(t,e),getEnsText:e=>SS(t,e),getFeeHistory:e=>Pk(t,e),estimateFeesPerGas:e=>Y8(t,e),getFilterChanges:e=>Uh(t,e),getFilterLogs:e=>Ok(t,e),getGasPrice:()=>eb(t),getLogs:e=>ab(t,e),getProof:e=>C4(t,e),estimateMaxPriorityFeePerGas:e=>G8(t,e),getStorageAt:e=>_4(t,e),getTransaction:e=>Wh(t,e),getTransactionConfirmations:e=>A4(t,e),getTransactionCount:e=>tb(t,e),getTransactionReceipt:e=>zd(t,e),multicall:e=>bI(t,e),prepareTransactionRequest:e=>Nh(t,e),readContract:e=>Ir(t,e),sendRawTransaction:e=>lS(t,e),sendRawTransactionSync:e=>Z4(t,e),simulate:e=>tm(t,e),simulateBlocks:e=>tm(t,e),simulateCalls:e=>k4(t,e),simulateContract:e=>YR(t,e),verifyHash:e=>Kh(t,e),verifyMessage:e=>j4(t,e),verifySiweMessage:e=>Y4(t,e),verifyTypedData:e=>q4(t,e),uninstallFilter:e=>Bh(t,e),waitForTransactionReceipt:e=>SI(t,e),watchBlocks:e=>z4(t,e),watchBlockNumber:e=>AI(t,e),watchContractEvent:e=>tk(t,e),watchEvent:e=>H4(t,e),watchPendingTransactions:e=>II(t,e)}}function J4(t){const{key:e="public",name:n="Public Client"}=t;return Fh({...t,key:e,name:n,type:"publicClient"}).extend(TI)}async function nne(t,e){const{account:n=t.account,chainId:r,nonce:s}=e;if(!n)throw new Mh({docsPath:"/docs/eip7702/prepareAuthorization"});const i=Qt(n),o=(()=>{if(e.executor)return e.executor==="self"?e.executor:Qt(e.executor)})(),a={address:e.contractAddress??e.address,chainId:r,nonce:s};return typeof a.chainId>"u"&&(a.chainId=t.chain?.id??await ve(t,Th,"getChainId")({})),typeof a.nonce>"u"&&(a.nonce=await ve(t,tb,"getTransactionCount")({address:i.address,blockTag:"pending"}),(o==="self"||o?.address&&pa(o.address,i.address))&&(a.nonce+=1)),a}async function X4(t,{account:e=t.account,message:n}){if(!e)throw new Mh({docsPath:"/docs/actions/wallet/signMessage"});const r=Qt(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?eo(n):n.raw instanceof Uint8Array?Jt(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}function Gh({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const u=mS();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:zk(r,{methods:e,retryCount:s,retryDelay:i,uid:u}),value:c}}function NI(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>Gh({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function im(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=xI,retryCount:o,retryDelay:a}=e;return(({chain:c,pollingInterval:u=4e3,timeout:l,...d})=>{let f=t,h=()=>{};const g=Gh({key:n,name:r,async request({method:p,params:y}){let E;const A=async(w=0)=>{const C=f[w]({...d,chain:c,retryCount:0,timeout:l});try{const _=await C.request({method:p,params:y});return h({method:p,params:y,response:_,transport:C,status:"success"}),_}catch(_){if(h({error:_,method:p,params:y,transport:C,status:"error"}),i(_)||w===f.length-1||(E??=f.slice(w+1).some(P=>{const{include:k,exclude:U}=P({chain:c}).config.methods||{};return k?k.includes(p):U?!U.includes(p):!0}),!E))throw _;return A(w+1)}};return A()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:p=>h=p,transports:f.map(p=>p({chain:c,retryCount:0}))});if(s){const p=typeof s=="object"?s:{};Q4({chain:c,interval:p.interval??u,onTransports:y=>f=y,ping:p.ping,sampleCount:p.sampleCount,timeout:p.timeout,transports:f,weights:p.weights})}return g})}function xI(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===Xo.code||t.code===yt.code||Wi.nodeMessage.test(t.message)||t.code===5e3))}function Q4({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:u=.3}=a,l=[],d=async()=>{const f=await Promise.all(o.map(async p=>{const y=p({chain:t,retryCount:0,timeout:i}),E=Date.now();let A,w;try{await(r?r({transport:y}):y.request({method:"net_listening"})),w=1}catch{w=0}finally{A=Date.now()}return{latency:A-E,success:w}}));l.push(f),l.length>s&&l.shift();const h=Math.max(...l.map(p=>Math.max(...p.map(({latency:y})=>y)))),g=o.map((p,y)=>{const E=l.map(P=>P[y].latency),w=1-E.reduce((P,k)=>P+k,0)/E.length/h,C=l.map(P=>P[y].success),_=C.reduce((P,k)=>P+k,0)/C.length;return _===0?[0,y]:[u*w+c*_,y]}).sort((p,y)=>y[0]-p[0]);n(g.map(([,p])=>o[p])),await $f(e),d()};d()}class PI extends K{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function Cu(t,e={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:u,retryDelay:l,raw:d}=e;return({chain:f,retryCount:h,timeout:g})=>{const{batchSize:p=1e3,wait:y=0}=typeof n=="object"?n:{},E=e.retryCount??h,A=g??e.timeout??1e4,w=t||f?.rpcUrls.default.http[0];if(!w)throw new PI;const C=Jk(w,{fetchFn:r,fetchOptions:s,onRequest:c,onResponse:u,timeout:A});return Gh({key:i,methods:o,name:a,async request({method:_,params:P}){const k={method:_,params:P},{schedule:U}=oS({id:w,wait:y,shouldSplitBatch(D){return D.length>p},fn:D=>C.request({body:D}),sort:(D,T)=>D.id-T.id}),$=async D=>n?U(D):[await C.request({body:D})],[{error:L,result:M}]=await $(k);if(d)return{error:L,result:M};if(L)throw new Eh({body:k,error:L,url:w});return M},retryCount:E,retryDelay:l,timeout:A,type:"http"},{fetchOptions:s,url:w})}}function L1(t){const{r:e,s:n}=xb.Signature.fromCompact(t.slice(2,130)),r=+`0x${t.slice(130)}`,[s,i]=(()=>{if(r===0||r===1)return[void 0,r];if(r===27)return[BigInt(r),0];if(r===28)return[BigInt(r),1];throw new Error("Invalid yParityOrV value")})();return typeof s<"u"?{r:ee(e,{size:32}),s:ee(n,{size:32}),v:s,yParity:i}:{r:ee(e,{size:32}),s:ee(n,{size:32}),yParity:i}}const eD=Object.freeze(Object.defineProperty({__proto__:null,AbiConstructorNotFoundError:AA,AbiConstructorParamsNotFoundError:$g,AbiDecodingDataSizeTooSmallError:Ty,AbiDecodingZeroDataError:Bc,AbiEncodingArrayLengthMismatchError:SA,AbiEncodingBytesSizeMismatchError:IA,AbiEncodingLengthMismatchError:Ny,AbiErrorInputsNotFoundError:TA,AbiErrorNotFoundError:Dg,AbiErrorSignatureNotFoundError:xy,AbiEventNotFoundError:Ug,AbiEventSignatureEmptyTopicsError:NA,AbiEventSignatureNotFoundError:Py,AbiFunctionNotFoundError:Zo,AbiFunctionOutputsNotFoundError:Oy,AbiFunctionSignatureNotFoundError:xA,AccountStateConflictError:s2,AtomicReadyWalletRejectedUpgradeError:Nc,AtomicityNotSupportedError:xc,BaseError:K,BaseFeeScalarError:E2,BlockNotFoundError:Xy,BundleFailedError:fS,BundleTooLargeError:Tc,BytesSizeMismatchError:Ry,CallExecutionError:Ky,ChainDisconnectedError:Cc,ChainDoesNotSupportContract:kf,ChainMismatchError:rS,ChainNotFoundError:sS,CircularReferenceError:bA,ClientChainNotConfiguredError:pb,ContractFunctionExecutionError:wh,ContractFunctionRevertedError:vf,ContractFunctionZeroDataError:f2,CounterfactualDeploymentFailedError:h2,DecodeLogDataMismatch:dc,DecodeLogTopicsMismatch:Cl,DuplicateIdError:Sc,Eip1559FeesNotSupportedError:_h,EnsAvatarInvalidNftUriError:Ba,EnsAvatarUnsupportedNamespaceError:CS,EnsAvatarUriResolutionError:jh,EstimateGasExecutionError:b2,ExecutionRevertedError:Wi,FeeCapTooHighError:io,FeeCapTooLowError:Cf,FeeConflictError:o2,FilterTypeNotSupportedError:$A,HttpRequestError:Gi,InsufficientFundsError:If,IntegerOutOfRangeError:Uy,InternalRpcError:no,IntrinsicGasTooHighError:Tf,IntrinsicGasTooLowError:Nf,InvalidAbiDecodingTypeError:OA,InvalidAbiEncodingTypeError:PA,InvalidAbiItemError:cA,InvalidAbiParametersError:lA,InvalidAbiTypeParameterError:gA,InvalidAddressError:Xt,InvalidArrayError:ky,InvalidBytesBooleanError:UA,InvalidChainIdError:Rl,InvalidDecimalNumberError:mI,InvalidDefinitionTypeError:RA,InvalidDomainError:MS,InvalidFunctionModifierError:pA,InvalidHexBooleanError:BA,InvalidInputRpcError:ro,InvalidLegacyVError:a2,InvalidModifierError:hA,InvalidParameterError:dA,InvalidParamsRpcError:mc,InvalidParenthesisError:wA,InvalidPrimaryTypeError:LS,InvalidRequestRpcError:pc,InvalidSerializableTransactionError:c2,InvalidSignatureError:da,InvalidStorageKeySizeError:u2,InvalidStructSignatureError:yA,InvalidStructTypeError:FS,JsonRpcVersionUnsupportedError:bc,LimitExceededRpcError:Qo,MaxFeePerGasTooLowError:v2,MethodNotFoundRpcError:gc,MethodNotSupportedRpcError:Hi,NonceMaxValueError:Sf,NonceTooHighError:_f,NonceTooLowError:Af,ParseRpcError:hc,ProviderDisconnectedError:vc,ProviderRpcError:Kn,RawContractError:Il,ResourceNotFoundRpcError:yc,ResourceUnavailableRpcError:ii,RpcError:In,RpcRequestError:Eh,SizeExceedsPaddingSizeError:Dy,SizeOverflowError:MA,SliceOffsetOutOfBoundsError:$y,SolidityProtectedKeywordError:fA,StateAssignmentConflictError:i2,SwitchChainError:Zr,TimeoutError:Lg,TipAboveFeeCapError:Pc,TransactionExecutionError:l2,TransactionNotFoundError:Wy,TransactionReceiptNotFoundError:Vy,TransactionRejectedRpcError:Xo,TransactionTypeNotSupportedError:xf,UnauthorizedProviderError:wc,UnknownBundleIdError:Ic,UnknownNodeError:jc,UnknownRpcError:p2,UnknownSignatureError:mA,UnknownTypeError:uA,UnsupportedChainIdError:Ac,UnsupportedNonOptionalCapabilityError:_c,UnsupportedPackedAbiType:kA,UnsupportedProviderMethodError:Ec,UrlRequiredError:PI,UserRejectedRequestError:yt,WaitForCallsStatusTimeoutError:gS,WaitForTransactionReceiptTimeoutError:d2,assertCurrentChain:uS,assertRequest:ha,assertTransactionEIP1559:qh,assertTransactionEIP2930:OS,assertTransactionLegacy:RS,blobsToCommitments:Sh,blobsToProofs:Ih,boolToBytes:FA,boolToHex:mh,bytesToBigInt:JA,bytesToBool:XA,bytesToHex:Ct,bytesToNumber:Es,bytesToString:QA,ccipFetch:Bf,ccipRequest:Bf,checksumAddress:Mc,commitmentToVersionedHash:x2,commitmentsToVersionedHashes:rb,concat:Sr,concatBytes:qA,concatHex:Sn,createClient:Fh,createNonceManager:Yk,createPublicClient:J4,createTransport:Gh,custom:NI,decodeAbiParameters:Fc,decodeErrorResult:Hy,decodeEventLog:Ph,decodeFunctionData:yS,decodeFunctionResult:lo,defineBlock:_2,defineChain:Gn,defineTransaction:C2,defineTransactionReceipt:pS,deploylessCallViaBytecodeBytecode:fb,deploylessCallViaFactoryBytecode:nS,encodeAbiParameters:xs,encodeDeployData:Dh,encodeErrorResult:Vg,encodeEventTopics:Lc,encodeFunctionData:lr,encodeFunctionResult:bS,encodePacked:Rk,erc20Abi:vu,erc6492SignatureValidatorAbi:Rf,erc6492SignatureValidatorByteCode:Hg,ethAddress:CI,etherUnits:t2,fallback:im,formatBlock:Ah,formatEther:bh,formatGwei:bn,formatLog:Is,formatTransaction:Nl,formatTransactionReceipt:Lh,formatTransactionRequest:qc,formatUnits:uo,getAbiItem:co,getAddress:ps,getChainContractAddress:ga,getContractError:so,getEventSelector:fc,getEventSignature:Eu,getFunctionSelector:Jo,getFunctionSignature:Eu,getTransactionType:ob,getTypesForEIP712Domain:qS,gweiUnits:n2,hashDomain:HS,hashMessage:vb,hashStruct:Cb,hashTypedData:zS,hexToBigInt:zt,hexToBool:LA,hexToBytes:cr,hexToNumber:ar,hexToSignature:L1,hexToString:By,http:Cu,isAddress:_t,isAddressEqual:pa,isHex:Ar,keccak256:Ht,labelhash:vS,maxUint256:Tl,multicall3Abi:rl,namehash:Uf,numberToBytes:jA,numberToHex:ee,offchainLookup:DS,offchainLookupAbiItem:wb,offchainLookupSignature:$S,pad:ws,padBytes:DA,padHex:si,parseAbi:Iy,parseAbiItem:Og,parseAbiParameters:Rg,parseEventLogs:Oh,parseSignature:L1,parseUnits:yI,prepareEncodeFunctionData:GA,presignMessagePrefix:US,publicActions:TI,recoverAddress:Gy,recoverPublicKey:g2,rpcTransactionType:w2,serializeAccessList:Dl,serializeErc6492Signature:w4,serializeSignature:sm,serializeTransaction:kS,sha256:N2,shouldThrow:xI,signatureToHex:sm,size:dt,slice:to,sliceBytes:My,sliceHex:Ef,stringToBytes:Ki,stringToHex:eo,stringify:Et,toBlobSidecars:ib,toBlobs:$2,toBytes:fa,toEventHash:wf,toEventSelector:fc,toEventSignature:Eu,toFunctionHash:wf,toFunctionSelector:Jo,toFunctionSignature:Eu,toHex:Jt,toPrefixedMessage:BS,toRlp:pi,transactionType:Qy,trim:yn,universalSignatureValidatorAbi:Rf,universalSignatureValidatorByteCode:Hg,validateTypedData:jS,weiUnits:r2,withCache:cS,withRetry:Oc,withTimeout:Eb,zeroAddress:$r},Symbol.toStringTag,{value:"Module"}));async function Zc(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Bl{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Zc(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await Zc(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Zc(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Zc(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Zc(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const om={getFeatureValue(t,e){const n=e?.[t];return n===void 0?De.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;let e=t;return oe.isTelegram()&&(oe.isIos()&&(e=e.filter(n=>n!=="google")),oe.isMac()&&(e=e.filter(n=>n!=="x")),oe.isAndroid()&&(e=e.filter(n=>!["facebook","x"].includes(n)))),oe.isMobile()&&(e=e.filter(n=>n!=="facebook")),e},isSocialsEnabled(){return Array.isArray(V.state.features?.socials)&&V.state.features?.socials.length>0||Array.isArray(V.state.remoteFeatures?.socials)&&V.state.remoteFeatures?.socials.length>0},isEmailEnabled(){return!!(V.state.features?.email||V.state.remoteFeatures?.email)}},we=Je({features:De.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:De.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1,coinbasePreference:"all"}),V={state:we,subscribeKey(t,e){return bt(we,t,e)},setOptions(t){Object.assign(we,t)},setRemoteFeatures(t){if(!t)return;const e={...we.remoteFeatures,...t};we.remoteFeatures=e,we.remoteFeatures?.socials&&(we.remoteFeatures.socials=om.filterSocialsByPlatform(we.remoteFeatures.socials)),we.features?.pay&&(we.remoteFeatures.email=!1,we.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;we.features||(we.features=De.DEFAULT_FEATURES);const e={...we.features,...t};we.features=e,we.features?.pay&&we.remoteFeatures&&(we.remoteFeatures.email=!1,we.remoteFeatures.socials=!1)},setProjectId(t){we.projectId=t},setCustomRpcUrls(t){we.customRpcUrls=t},setAllWallets(t){we.allWallets=t},setIncludeWalletIds(t){we.includeWalletIds=t},setExcludeWalletIds(t){we.excludeWalletIds=t},setFeaturedWalletIds(t){we.featuredWalletIds=t},setTokens(t){we.tokens=t},setTermsConditionsUrl(t){we.termsConditionsUrl=t},setPrivacyPolicyUrl(t){we.privacyPolicyUrl=t},setCustomWallets(t){we.customWallets=t},setIsSiweEnabled(t){we.isSiweEnabled=t},setIsUniversalProvider(t){we.isUniversalProvider=t},setSdkVersion(t){we.sdkVersion=t},setMetadata(t){we.metadata=t},setDisableAppend(t){we.disableAppend=t},setEIP6963Enabled(t){we.enableEIP6963=t},setDebug(t){we.debug=t},setEnableWalletGuide(t){we.enableWalletGuide=t},setEnableAuthLogger(t){we.enableAuthLogger=t},setEnableWallets(t){we.enableWallets=t},setPreferUniversalLinks(t){we.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(De.SIWX_DEFAULTS))t[e]??=n;we.siwx=t},setConnectMethodsOrder(t){we.features={...we.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){we.features={...we.features,walletFeaturesOrder:t}},setSocialsOrder(t){we.remoteFeatures={...we.remoteFeatures,socials:t}},setCollapseWallets(t){we.features={...we.features,collapseWallets:t}},setEnableEmbedded(t){we.enableEmbedded=t},setAllowUnsupportedChain(t){we.allowUnsupportedChain=t},setManualWCControl(t){we.manualWCControl=t},setEnableNetworkSwitch(t){we.enableNetworkSwitch=t},setEnableMobileFullScreen(t){we.enableMobileFullScreen=oe.isMobile()&&t},setEnableReconnect(t){we.enableReconnect=t},setCoinbasePreference(t){we.coinbasePreference=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(we.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){we.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return we.universalProviderConfigOverride},getSnapshot(){return Mu(we)}},Ao=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Pt=Je({...Ao}),tD={state:Pt,subscribeKey(t,e){return bt(Pt,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=oe.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Pt.message=Ao.message,Pt.variant=Ao.variant,Pt.svg=Ao.svg,Pt.open=Ao.open,Pt.autoClose=Ao.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Ao.autoClose}){Pt.open?(Pt.open=!1,setTimeout(()=>{Pt.message=t,Pt.variant=n,Pt.svg=e,Pt.open=!0,Pt.autoClose=r},150)):(Pt.message=t,Pt.variant=n,Pt.svg=e,Pt.open=!0,Pt.autoClose=r)}},at=tD,nD={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},OI=oe.getBlockchainApiUrl(),hn=Je({clientId:null,api:new Bl({baseUrl:OI,clientId:null}),supportedChains:{http:[],ws:[]}}),Ee={state:hn,async get(t){const{st:e,sv:n}=Ee.getSdkProperties(),r=V.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return hn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=V.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{hn.supportedChains.http.length||await Ee.getSupportedNetworks()}catch{return!1}return hn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await Ee.get({path:"v1/supported-chains"});return hn.supportedChains=t,t}catch{return hn.supportedChains}},async fetchIdentity({address:t}){const e=G.getIdentityFromCacheForAddress(t);if(e)return e;const n=await Ee.get({path:`/v1/identity/${t}`,params:{sender:R.state.activeCaipAddress?oe.getPlainAddress(R.state.activeCaipAddress):void 0}});return G.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=G.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await Ee.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return G.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async getAddressBalance({caipNetworkId:t,address:e}){return hn.api.post({path:`/v1?chainId=${t}&projectId=${V.state.projectId}`,body:{id:"1",jsonrpc:"2.0",method:"getAddressBalance",params:{address:e}}}).then(n=>n.result)},async fetchTokenPrice({addresses:t}){if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=G.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await hn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:V.state.projectId},headers:{"Content-Type":"application/json"}});return G.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:n}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ee.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return hn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:De.CONVERT_SLIPPAGE_TOLERANCE},projectId:V.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){const{st:r,sv:s}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Ee.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){const{st:r,sv:s}=Ee.getSdkProperties();if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))return at.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=G.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ee.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return G.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))return[];const n=R.getAccountData()?.address;return Ee.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?(await hn.api.post({path:"/v1/generators/onrampurl",params:{projectId:V.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ee.get({path:"/v1/onramp/options"})}catch{return nD}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){try{return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?await hn.api.post({path:"/v1/onramp/quote",params:{projectId:V.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?Ee.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){return await Ee.isNetworkSupported(R.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:V.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){hn.clientId=t,hn.api=new Bl({baseUrl:OI,clientId:t})}},mr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},rD={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===mr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${mr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===mr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${mr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===z.CHAIN.SOLANA&&t===mr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${mr.COINBASE.url}/dapp?cb_url=${r}`),e===z.CHAIN.BITCOIN&&t===mr.BINANCE.id&&!("binancew3w"in window)){const s=R.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${s?.id??1}`),a=new URL(mr.BINANCE.deeplink);a.searchParams.set("appId",mr.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(mr.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},sD=Object.freeze({enabled:!0,events:[]}),iD=new Bl({baseUrl:oe.getAnalyticsUrl(),clientId:null}),oD=5,aD=60*1e3,Ai=Je({...sD}),cD={state:Ai,subscribeKey(t,e){return bt(Ai,t,e)},async sendError(t,e){if(!Ai.enabled)return;const n=Date.now();if(Ai.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<aD}).length>=oD)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Ai.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=V.state;await iD.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:oe.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Ai.enabled=!0},disable(){Ai.enabled=!1},clearEvents(){Ai.events=[]}};class ra extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,ra.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,ra):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function F1(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=t?.message||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof ra?t:new ra(n,e,t);throw cD.sendError(r,r.category),r}function Yn(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return F1(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return F1(a,e)}},n[r]=i}else n[r]=s}),n}const Zn=Je({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),uD={state:Zn,subscribeNetworkImages(t){return vt(Zn.networkImages,()=>t(Zn.networkImages))},subscribeKey(t,e){return bt(Zn,t,e)},subscribe(t){return vt(Zn,()=>t(Zn))},setWalletImage(t,e){Zn.walletImages[t]=e},setNetworkImage(t,e){Zn.networkImages[t]=e},setChainImage(t,e){Zn.chainImages[t]=e},setConnectorImage(t,e){Zn.connectorImages={...Zn.connectorImages,[t]:e}},setTokenImage(t,e){Zn.tokenImages[t]=e},setCurrencyImage(t,e){Zn.currencyImages[t]=e}},nr=Yn(uD),lD={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:"",ton:"20f673c0-095e-49b2-07cf-eb5049dcf600"},Qp=Je({networkImagePromises:{}}),RI={async fetchWalletImage(t){if(t)return await ye._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(Qp.networkImagePromises[t]||(Qp.networkImagePromises[t]=ye._fetchNetworkImage(t)),await Qp.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return nr.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return nr.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return nr.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return nr.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return nr.state.connectorImages[t.imageId]},getChainImage(t){return nr.state.networkImages[lD[t]]},getTokenImage(t){if(t)return nr.state.tokenImages[t]}},dD=oe.getAnalyticsUrl(),fD=new Bl({baseUrl:dD,clientId:null}),hD=["MODAL_CREATED"],pD=45,j1=1e3*10,gt=Je({timestamp:Date.now(),lastFlush:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1,walletImpressions:[]}),Te={state:gt,subscribe(t){return vt(gt,()=>t(gt))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=V.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},shouldFlushEvents(){const t=JSON.stringify(gt.pendingEvents).length/1024>pD,e=gt.lastFlush+j1<Date.now();return t||e},_setPendingEvent(t){try{let e=R.getAccountData()?.address;if("address"in t.data&&t.data.address&&(e=t.data.address),hD.includes(t.data.event)||typeof window>"u")return;const n=R.getActiveCaipNetwork()?.caipNetworkId;this.state.pendingEvents.push({eventId:oe.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:n}}}),gt.reportedErrors.FORBIDDEN=!1,Te.shouldFlushEvents()&&Te._submitPendingEvents()}catch(e){console.warn("_setPendingEvent",e)}},sendEvent(t){gt.timestamp=Date.now(),gt.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(V.state.features?.analytics||e.includes(t.event))&&Te._setPendingEvent(gt),this.subscribeToFlushTriggers()},sendWalletImpressionEvent(t){gt.walletImpressions.push(t)},_transformPendingEventsForBatch(t){try{return t.filter(e=>e.props.event!=="WALLET_IMPRESSION_V2")}catch{return t}},_submitPendingEvents(){if(gt.lastFlush=Date.now(),!(gt.pendingEvents.length===0&&gt.walletImpressions.length===0))try{const t=Te._transformPendingEventsForBatch(gt.pendingEvents);gt.walletImpressions.length&&t.push({eventId:oe.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:Date.now(),props:{type:"track",event:"WALLET_IMPRESSION_V2",items:[...gt.walletImpressions]}}),fD.sendBeacon({path:"/batch",params:Te.getSdkProperties(),body:t}),gt.reportedErrors.FORBIDDEN=!1,gt.pendingEvents=[],gt.walletImpressions=[]}catch{gt.reportedErrors.FORBIDDEN=!0}},subscribeToFlushTriggers(){gt.subscribedToVisibilityChange||typeof document>"u"||(gt.subscribedToVisibilityChange=!0,document?.addEventListener?.("visibilitychange",()=>{document.visibilityState==="hidden"&&Te._submitPendingEvents()}),document?.addEventListener?.("freeze",()=>{Te._submitPendingEvents()}),window?.addEventListener?.("pagehide",()=>{Te._submitPendingEvents()}),setInterval(()=>{Te._submitPendingEvents()},j1))}},gD=oe.getApiUrl(),pn=new Bl({baseUrl:gD,clientId:null}),mD=40,q1=4,yD=20,Ne=Je({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[],plan:{tier:"none",hasExceededUsageLimit:!1,limits:{isAboveRpcLimit:!1,isAboveMauLimit:!1}}}),ye={state:Ne,subscribeKey(t,e){return bt(Ne,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=V.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return V.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${pn.baseUrl}/getWalletImage/${t}`,n=await pn.getBlob({path:e,params:ye._getSdkProperties()});nr.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${pn.baseUrl}/public/getAssetImage/${t}`,n=await pn.getBlob({path:e,params:ye._getSdkProperties()});nr.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${pn.baseUrl}/public/getAssetImage/${t}`,n=await pn.getBlob({path:e,params:ye._getSdkProperties()});nr.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${pn.baseUrl}/public/getCurrencyImage/${t}`,n=await pn.getBlob({path:e,params:ye._getSdkProperties()});nr.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${pn.baseUrl}/public/getTokenImage/${t}`,n=await pn.getBlob({path:e,params:ye._getSdkProperties()});nr.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=oe.isMobile()?t?.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(mr).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await pn.get({path:"/appkit/v1/config",params:ye._getSdkProperties()})).features},async fetchUsage(){try{const t=await pn.get({path:"/appkit/v1/project-limits",params:ye._getSdkProperties()}),{tier:e,isAboveMauLimit:n,isAboveRpcLimit:r}=t.planLimits,s=e==="starter",i=n||r;ye.state.plan={tier:e,hasExceededUsageLimit:s&&i,limits:{isAboveRpcLimit:r,isAboveMauLimit:n}}}catch(t){console.warn("Failed to fetch usage",t)}},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await pn.get({path:"/projects/v1/origins",params:ye._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===z.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=z.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=R.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!RI.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>ye._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=X.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>ye._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>ye._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>ye._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];ye._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(mr).map(o=>o.id));const r=await pn.get({path:"/getWallets",params:{...ye._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=ye._filterWalletsByPlatform(r?.data);return{data:s||[],count:r?.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=X.state.connectors;if(!t?.length)return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),R.state.activeChain===z.CHAIN.EVM){const s=[...t.flatMap(i=>i.connectors?.map(o=>o.info?.rdns)||[]),...t.map(i=>i.info?.rdns)].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await ye.fetchWallets(e);Ne.explorerWallets=n,X.extendConnectorsWithExplorerWallets(n);const r=R.getRequestedCaipNetworkIds().join(",");Ne.explorerFilteredWallets=n.filter(s=>s.chains?.some(i=>r.includes(i)))},async fetchFeaturedWallets(){const{featuredWalletIds:t}=V.state;if(t?.length){const e={...ye._getSdkProperties(),page:1,entries:t?.length??q1,include:t},{data:n}=await ye.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>ye._fetchWalletImage(i))),Ne.featured=r,Ne.allFeatured=r}},async fetchRecommendedWallets(){try{Ne.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=V.state,r=[...e??[],...n??[]].filter(Boolean),s=R.getRequestedCaipNetworkIds().join(","),i={page:1,entries:q1,include:t,exclude:r,chains:s},{data:o,count:a}=await ye.fetchWallets(i),c=G.getRecentWallets(),u=o.map(d=>d.image_id).filter(Boolean),l=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...u,...l].map(d=>ye._fetchWalletImage(d))),Ne.recommended=o,Ne.allRecommended=o,Ne.count=a??0}catch{}finally{Ne.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=V.state,s=R.getRequestedCaipNetworkIds().join(","),i=[...Ne.recommended.map(({id:d})=>d),...n??[],...r??[]].filter(Boolean),o={page:t,entries:mD,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:u}=await ye.fetchWallets(o);Ne.mobileFilteredOutWalletsLength=u+(Ne.mobileFilteredOutWalletsLength??0);const l=a.slice(0,yD).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(l.map(d=>ye._fetchWalletImage(d))),Ne.wallets=oe.uniqueBy([...Ne.wallets,...ye._filterOutExtensions(a)],"id").filter(d=>d.chains?.some(f=>s.includes(f))),Ne.count=c>Ne.count?c:Ne.count,Ne.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await ye.fetchWallets(e);n&&n.forEach(r=>{Ne.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=V.state,s=R.getRequestedCaipNetworkIds().join(",");Ne.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await ye.fetchWallets(i);Te.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>ye._fetchWalletImage(c)),oe.wait(300)]),Ne.search=ye._filterOutExtensions(o)},initPromise(t,e){const n=Ne.promises[t];return n||(Ne.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&ye.initPromise("connectorImages",ye.fetchConnectorImages),e&&ye.initPromise("featuredWallets",ye.fetchFeaturedWallets),n&&ye.initPromise("recommendedWallets",ye.fetchRecommendedWallets),r&&ye.initPromise("networkImages",ye.fetchNetworkImages),s&&ye.initPromise("walletRanks",ye.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){V.state.features?.analytics&&ye.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await pn.get({path:"/getAnalyticsConfig",params:ye._getSdkProperties()});V.setFeatures({analytics:t})}catch{V.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){Ne.featured=Ne.allFeatured,Ne.recommended=Ne.allRecommended;return}const e=R.getRequestedCaipNetworkIds().join(",");Ne.featured=Ne.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.recommended=Ne.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.filteredWallets=Ne.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))},clearFilterByNamespaces(){Ne.filteredWallets=[]},setFilterByNamespace(t){if(!t){Ne.featured=Ne.allFeatured,Ne.recommended=Ne.allRecommended;return}const e=R.getRequestedCaipNetworkIds().join(",");Ne.featured=Ne.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.recommended=Ne.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ne.filteredWallets=Ne.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))}},bD=["ConnectingExternal","ConnectingMultiChain","ConnectingSocial","ConnectingFarcaster"],Ze=Je({view:"Connect",history:["Connect"],transactionStack:[]}),wD={state:Ze,subscribeKey(t,e){return bt(Ze,t,e)},pushTransactionStack(t){Ze.transactionStack.push(t)},popTransactionStack(t){const e=Ze.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n?.();break;case"error":r?.(),de.goBack();break;case"cancel":s?.(),de.goBack();break}},push(t,e){let n=t,r=e;ye.state.plan.hasExceededUsageLimit&&bD.includes(t)&&(n="UsageExceeded",r=void 0),n!==Ze.view&&(Ze.view=n,Ze.history.push(n),Ze.data=r)},reset(t,e){Ze.view=t,Ze.history=[t],Ze.data=e},replace(t,e){Ze.history.at(-1)===t||(Ze.view=t,Ze.history[Ze.history.length-1]=t,Ze.data=e)},goBack(){const t=R.state.activeCaipAddress,e=de.state.view==="ConnectingFarcaster",n=!t&&e;if(Ze.history.length>1){Ze.history.pop();const[r]=Ze.history.slice(-1);r&&(t&&r==="Connect"?Ze.view="Account":Ze.view=r)}else Ue.close();Ze.data?.wallet&&(Ze.data.wallet=void 0),Ze.data?.redirectView&&(Ze.data.redirectView=void 0),setTimeout(()=>{if(n){R.setAccountProp("farcasterUrl",void 0,R.state.activeChain);const r=X.getAuthConnector();r?.provider?.reload();const s=Mu(V.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(Ze.history.length>1){Ze.history=Ze.history.slice(0,t+1);const[e]=Ze.history.slice(-1);e&&(Ze.view=e)}},goBackOrCloseModal(){de.state.history.length>1?de.goBack():Ue.close()}},de=Yn(wD),$s=Je({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),am={state:$s,subscribe(t){return vt($s,()=>t($s))},setThemeMode(t){$s.themeMode=t;try{const e=X.getAuthConnector();if(e){const n=am.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:ju(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){$s.themeVariables={...$s.themeVariables,...t};try{const e=X.getAuthConnector();if(e){const n=am.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:ju($s.themeVariables,$s.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Mu($s)}},$n=Yn(am),kI=Object.fromEntries(L_.map(t=>[t,void 0])),ED=Object.fromEntries(L_.map(t=>[t,!0])),je=Je({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:kI,filterByNamespaceMap:ED}),vD={state:je,subscribe(t){return vt(je,()=>{t(je)})},subscribeKey(t,e){return bt(je,t,e)},initialize(t){t.forEach(e=>{const n=G.getConnectedConnectorId(e);n&&X.setConnectorId(n,e)})},setActiveConnector(t){t&&(je.activeConnector=Lu(t))},setConnectors(t){t.filter(s=>!je.allConnectors.some(i=>i.id===s.id&&X.getConnectorName(i.name)===X.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&je.allConnectors.push(Lu(s))});const n=X.getEnabledNamespaces(),r=X.getEnabledConnectors(n);je.connectors=X.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(je.filterByNamespaceMap).forEach(e=>{je.filterByNamespaceMap[e]=!1}),t.forEach(e=>{je.filterByNamespaceMap[e]=!0}),X.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){je.filterByNamespaceMap[t]=e,X.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=X.getEnabledNamespaces(),e=X.getEnabledConnectors(t),n=X.areAllNamespacesEnabled();je.connectors=X.mergeMultiChainConnectors(e),n?ye.clearFilterByNamespaces():ye.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(je.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return je.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(je.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=X.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=s?.id===z.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=X.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){if(t.id===z.CONNECTOR_ID.AUTH){const e=t,n=Mu(V.state),r=$n.getSnapshot().themeMode,s=$n.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:ju(s,r)}),X.setConnectors([t])}else X.setConnectors([t])},getAuthConnector(t){const e=t||R.state.activeChain,n=je.connectors.find(r=>r.id===z.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===e):n},getAnnouncedConnectorRdns(){return je.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return je.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:n}){const r=n||R.state.activeChain;return je.allConnectors.filter(i=>i.chain===r).find(i=>i.explorerId===t||i.info?.rdns===e)},syncIfAuthConnector(t){if(t.id!=="AUTH")return;const e=t,n=Mu(V.state),r=$n.getSnapshot().themeMode,s=$n.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:ju(s,r)})},getConnectorsByNamespace(t){const e=je.allConnectors.filter(n=>n.chain===t);return X.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return R.checkIfSmartAccountEnabled()&&Wt(t)===lt.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=de.state.data?.redirectView,n=X.getConnector({id:t.id,rdns:t.rdns});rD.handleMobileDeeplinkRedirect(n?.explorerId||t.id,R.state.activeChain),n?de.push("ConnectingExternal",{connector:n,wallet:t,redirectView:e}):de.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?X.getConnectorsByNamespace(t):X.mergeMultiChainConnectors(je.allConnectors)},setFilterByNamespace(t){je.filterByNamespace=t,je.connectors=X.getConnectors(t),ye.setFilterByNamespace(t)},setConnectorId(t,e){t&&(je.activeConnectorIds={...je.activeConnectorIds,[e]:t},G.setConnectedConnectorId(e,t))},removeConnectorId(t){je.activeConnectorIds={...je.activeConnectorIds,[t]:void 0},G.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return je.activeConnectorIds[t]},isConnected(t){return t?!!je.activeConnectorIds[t]:Object.values(je.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){je.activeConnectorIds={...kI}},extendConnectorsWithExplorerWallets(t){je.allConnectors.forEach(r=>{const s=t.find(i=>i.id===r.id||i.rdns&&i.rdns===r.info?.rdns);s&&(r.explorerWallet=s)});const e=X.getEnabledNamespaces(),n=X.getEnabledConnectors(e);je.connectors=X.mergeMultiChainConnectors(n)}},X=Yn(vD),CD=1e3,Jc={checkNamespaceConnectorId(t,e){return X.getConnectorId(t)===e},isSocialProvider(t){return De.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&X.setActiveConnector(e),s?.(oe.isMobile()&&t),r){const u=Ue.subscribeKey("open",l=>{l||(de.state.view!==r&&de.replace(r),u(),a(new Error("Modal closed")))})}const c=R.subscribeKey("activeCaipAddress",u=>{u&&(i?.(),n&&Ue.close(),c(),o(Dt.parseCaipAddress(u)))})})},connectExternal(t){return new Promise((e,n)=>{const r=R.subscribeKey("activeCaipAddress",s=>{s&&(Ue.close(),r(),e(Dt.parseCaipAddress(s)))});ie.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i,o=!1,a=null;const c=e||R.state.activeChain,u=R.subscribeKey("activeCaipAddress",l=>{l&&(n&&Ue.close(),u())});return new Promise((l,d)=>{async function f(g){if(g.data?.resultUri)if(g.origin===z.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",f,!1);try{const p=X.getAuthConnector(c);if(p&&!o){i&&i.close(),o=!0;const y=g.data.resultUri;Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:t}}),G.setConnectedSocialProvider(t),await ie.connectExternal({id:p.id,type:p.type,socialUri:y},p.chain);const E=R.state.activeCaipAddress;if(!E){d(new Error("Failed to connect"));return}l(Dt.parseCaipAddress(E)),Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}})}}catch(p){Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:oe.parseError(p)}}),d(new Error("Failed to connect"))}}else Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:"Untrusted Origin"}})}async function h(){if(Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"){r?.();const g=Ue.subscribeKey("open",y=>{!y&&t==="farcaster"&&(d(new Error("Popup closed")),s?.(),g())}),p=X.getAuthConnector();if(p&&!R.getAccountData(c)?.farcasterUrl)try{const{url:E}=await p.provider.getFarcasterUri();R.setAccountProp("farcasterUrl",E,c)}catch{d(new Error("Failed to connect to farcaster"))}}else{const g=X.getAuthConnector();a=oe.returnOpenHref(`${z.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(g){const{uri:p}=await g.provider.getSocialRedirectUri({provider:t});if(a&&p){a.location.href=p,i=a;const y=setInterval(()=>{i?.closed&&!o&&(d(new Error("Popup closed")),clearInterval(y))},1e3);window.addEventListener("message",f,!1)}else a?.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),a?.close()}}}h()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),e){const a=Ue.subscribeKey("open",c=>{c||(de.state.view!==e&&de.replace(e),a(),i(new Error("Modal closed")))})}const o=R.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),t&&Ue.close(),o(),s(Dt.parseCaipAddress(a)))})})},async updateEmail(){const t=G.getConnectedConnectorId(R.state.activeChain),e=X.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==z.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await Ue.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(Ue.close(),clearInterval(i),o(),r({email:a}))},CD),o=Ue.subscribeKey("open",a=>{a||(de.state.view!=="Connect"&&de.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return R.checkIfSmartAccountEnabled()&&Wt(t)===lt.ACCOUNT_TYPES.EOA}};function il(){const t=R.state.activeCaipNetwork?.chainNamespace||"eip155",e=R.state.activeCaipNetwork?.id||1,n=De.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function Wt(t){return R.getAccountData(t)?.preferredAccountType}function ei(t){return t?R.state.chains.get(t)?.networkState?.caipNetwork:R.state.activeCaipNetwork}const Lf={getConnectionStatus(t,e){const n=X.state.activeConnectorIds[e],r=ie.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!V.state.remoteFeatures?.multiWallet,n=X.state.activeConnectorIds[t],r=ie.getConnections(t),i=(ie.state.recentConnections.get(t)??[]).filter(a=>X.getConnectorById(a.connectorId)),o=Lf.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}}},ot=Je({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),_D={state:ot,subscribe(t){return vt(ot,()=>t(ot))},setLastNetworkInView(t){ot.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");ot.loading=!0;try{const e=await Ee.fetchTransactions({account:t,cursor:ot.next,chainId:R.state.activeCaipNetwork?.caipNetworkId}),n=Hd.filterSpamTransactions(e.data),r=Hd.filterByConnectedChain(n),s=[...ot.transactions,...r];ot.loading=!1,ot.transactions=s,ot.transactionsByYear=Hd.groupTransactionsByYearAndMonth(ot.transactionsByYear,r),ot.empty=s.length===0,ot.next=e.next?e.next:void 0}catch{const n=R.state.activeChain;Te.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:V.state.projectId,cursor:ot.next,isSmartAccount:Wt(n)===lt.ACCOUNT_TYPES.SMART_ACCOUNT}}),at.showError("Failed to fetch transactions"),ot.loading=!1,ot.empty=!0,ot.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(u=>u.id!==r.id);n[s]={...o,[i]:[...c,r].sort((u,l)=>new Date(l.metadata.minedAt).getTime()-new Date(u.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=R.state.activeCaipNetwork?.caipNetworkId;return t.filter(r=>r.metadata.chain===e)},clearCursor(){ot.next=void 0},resetTransactions(){ot.transactions=[],ot.transactionsByYear={},ot.lastNetworkInView=void 0,ot.loading=!1,ot.empty=!1,ot.next=void 0}},Hd=Yn(_D,"API_ERROR"),He=Je({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let go;const AD={state:He,subscribe(t){return vt(He,()=>t(He))},subscribeKey(t,e){return bt(He,t,e)},_getClient(){return He._client},setClient(t){He._client=Lu(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);ie.syncStorageConnections(e)},syncStorageConnections(t){const e=G.getConnections(),n=t??Array.from(R.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(He.recentConnections);i.set(r,s),He.recentConnections=i}},getConnections(t){return t?He.connections.get(t)??[]:[]},hasAnyConnection(t){const e=ie.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){const e=oe.isTelegram()||oe.isSafari()&&oe.isIos();if(t==="always"||t==="auto"&&e){if(go){await go,go=void 0;return}if(!oe.isPairingExpired(He?.wcPairingExpiry)){const n=He.wcUri;He.wcUri=n;return}go=ie._getClient()?.connectWalletConnect?.().catch(()=>{}),ie.state.status="connecting",await go,go=void 0,He.wcPairingExpiry=void 0,ie.state.status="connected"}else await ie._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,n=!0){const r=await ie._getClient()?.connectExternal?.(t);n&&R.setActiveNamespace(e);const s=X.state.allConnectors.find(o=>o.id===t?.id),i=t.type==="AUTH"?"email":"browser";return Te.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:i,name:s?.name||"Unknown",view:de.state.view,walletRank:s?.explorerWallet?.order}}),r},async reconnectExternal(t){await ie._getClient()?.reconnectExternal?.(t);const e=t.chain||R.state.activeChain;e&&X.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;Ue.setLoading(!0,R.state.activeChain);const n=X.getAuthConnector();n&&(R.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),G.setPreferredAccountTypes(Object.entries(R.state.chains).reduce((r,[s,i])=>{const o=s,a=Wt(o);return a!==void 0&&(r[o]=a),r},{})),await ie.reconnectExternal(n),Ue.setLoading(!1,R.state.activeChain),Te.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:R.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return ie._getClient()?.signMessage(t)},parseUnits(t,e){return ie._getClient()?.parseUnits(t,e)},formatUnits(t,e){return ie._getClient()?.formatUnits(t,e)},updateBalance(t){return ie._getClient()?.updateBalance(t)},async sendTransaction(t){return ie._getClient()?.sendTransaction(t)},async getCapabilities(t){return ie._getClient()?.getCapabilities(t)},async grantPermissions(t){return ie._getClient()?.grantPermissions(t)},async walletGetAssets(t){return ie._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return ie._getClient()?.estimateGas(t)},async writeContract(t){return ie._getClient()?.writeContract(t)},async getEnsAddress(t){return ie._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return ie._getClient()?.getEnsAvatar(t)},checkInstalled(t){return ie._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){He.wcUri=void 0,He.wcPairingExpiry=void 0,He.wcLinking=void 0,He.recentWallet=void 0,He.status="disconnected",Hd.resetTransactions(),G.deleteWalletConnectDeepLink(),G.deleteRecentWallet()},resetUri(){He.wcUri=void 0,He.wcPairingExpiry=void 0,go=void 0},finalizeWcConnection(t){const{wcLinking:e,recentWallet:n}=ie.state;e&&G.setWalletConnectDeepLink(e),n&&G.setAppKitRecent(n),t&&Te.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:de.state.data?.wallet?.name||"Unknown",view:de.state.view,walletRank:n?.order}})},setWcBasic(t){He.wcBasic=t},setUri(t){He.wcUri=t,He.wcPairingExpiry=oe.getPairingExpiry()},setWcLinking(t){He.wcLinking=t},setWcError(t){He.wcError=t,He.buffering=!1},setRecentWallet(t){He.recentWallet=t},setBuffering(t){He.buffering=t},setStatus(t){He.status=t},setIsSwitchingConnection(t){He.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){try{await ie._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:n})}catch(r){throw new ra("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},async disconnectConnector({id:t,namespace:e}){try{await ie._getClient()?.disconnectConnector({id:t,namespace:e})}catch(n){throw new ra("Failed to disconnect connector","INTERNAL_SDK_ERROR",n)}},setConnections(t,e){const n=new Map(He.connections);n.set(e,t),He.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){const r=R.getAccountData(e)?.user?.accounts?.find(i=>i.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&Jc.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await ie.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=X.getConnectorById(t.connectorId),s=t.connectorId===z.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)n&&await ie.handleAuthAccountSwitch({address:n,namespace:e});else return(await ie.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e))?.address;return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){const s=X.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===z.CONNECTOR_ID.AUTH,a=t.connectorId===z.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Jc.isSocialProvider(i)){const{address:u}=await Jc.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Ue.open({view:"ConnectingFarcaster"})},onConnect(){de.replace("ProfileWallets")}});c=u}else{const{address:u}=await Jc.connectEmail({closeModalOnConnect:r,onOpen(){Ue.open({view:"EmailLogin"})},onConnect(){de.replace("ProfileWallets")}});c=u}else if(a){const{address:u}=await Jc.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(l){const d=l?"AllWallets":"ConnectingWalletConnect";Ue.state.open?de.push(d):Ue.open({view:d})},onConnect(){de.replace("ProfileWallets")}});c=u}else{const u=await ie.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);u&&(c=u.address)}return o&&n&&await ie.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=R.getAccountData(n)?.caipAddress;if(o){const{address:c}=Dt.parseCaipAddress(o);i=c}const a=Lf.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await ie.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const u=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:u,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await ie.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},ie=Yn(AD),e0={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return uo(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let t0;async function z1(){if(!t0){const{createPublicClient:t,http:e,defineChain:n}=await kt(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await Promise.resolve().then(()=>eD);return{createPublicClient:r,http:s,defineChain:i}},void 0);t0={createPublicClient:t,http:e,defineChain:n}}return t0}const cm={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await z1(),{chainId:n}=Dt.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await z1(),r=V.state.projectId,s=await cm.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(cm.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},Yh={async getMyTokensWithBalance(t){const e=R.getAccountData()?.address,n=R.state.activeCaipNetwork,r=X.getConnectorId("eip155")===z.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=G.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===z.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await Ee.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){try{const n=e0.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await ie.getCapabilities(t))?.[n]?.assetDiscovery?.supported)return null;const s=await ie.walletGetAssets({account:t,chainFilter:[n]});if(!e0.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>e0.createBalance(a,e.caipNetworkId));return G.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await cm.createViemPublicClient(n),{address:s}=Dt.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:vu},{address:e,functionName:"symbol",args:[],abi:vu},{address:e,functionName:"balanceOf",args:[s],abi:vu},{address:e,functionName:"decimals",args:[],abi:vu}]});return{name:i,symbol:o,decimals:c,balance:a&&c?uo(a,c):"0"}}},n0={adapters:{}},$I={state:n0,initialize(t){n0.adapters={...t}},get(t){return n0.adapters[t]}},Ff={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0,ton:void 0},Tn=Je({providers:{...Ff},providerIds:{...Ff}}),nt={state:Tn,subscribeKey(t,e){return bt(Tn,t,e)},subscribe(t){return vt(Tn,()=>{t(Tn)})},subscribeProviders(t){return vt(Tn.providers,()=>t(Tn.providers))},setProvider(t,e){t&&e&&(Tn.providers[t]=Lu(e))},getProvider(t){if(t)return Tn.providers[t]},setProviderId(t,e){e&&(Tn.providerIds[t]=e)},getProviderId(t){if(t)return Tn.providerIds[t]},reset(){Tn.providers={...Ff},Tn.providerIds={...Ff}},resetChain(t){Tn.providers[t]=void 0,Tn.providerIds[t]=void 0}},Sa=Je({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),zr={state:Sa,subscribe(t){return vt(Sa,()=>t(Sa))},subscribeOpen(t){return bt(Sa,"open",t)},set(t){Object.assign(Sa,{...Sa,...t})}},Ma={async getTokenList(t){return(await Ee.fetchSwapTokens({chainId:t}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=R.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await ie?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await Ee.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await Ee.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&n&&r){const i=ie.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await Yh.getMyTokensWithBalance(t);return R.setAccountProp("tokenBalance",e,R.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:il(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]},async handleSwapError(t){try{const e=t?.cause;return e?.json&&(await e.json())?.reasons?.[0]?.description?.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},qe=Je({tokenBalances:[],loading:!1}),SD={state:qe,subscribe(t){return vt(qe,()=>t(qe))},subscribeKey(t,e){return bt(qe,t,e)},setToken(t){t&&(qe.token=Lu(t))},setTokenAmount(t){qe.sendTokenAmount=t},setReceiverAddress(t){qe.receiverAddress=t},setReceiverProfileImageUrl(t){qe.receiverProfileImageUrl=t},setReceiverProfileName(t){qe.receiverProfileName=t},setNetworkBalanceInUsd(t){qe.networkBalanceInUSD=t},setLoading(t){qe.loading=t},getSdkEventProperties(t){return{message:oe.parseError(t),isSmartAccount:Wt(R.state.activeChain)===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:qe.token?.symbol||"",amount:qe.sendTokenAmount??0,network:R.state.activeCaipNetwork?.caipNetworkId||""}},async sendToken(){try{switch(ke.setLoading(!0),R.state.activeCaipNetwork?.chainNamespace){case"eip155":await ke.sendEvmToken();return;case"solana":await ke.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(t){throw Fr.isUserRejectedRequestError(t)?new Fa(t):t}finally{ke.setLoading(!1)}},async sendEvmToken(){const t=R.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=Wt(t);if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!ke.state.token)throw new Error("A token is required");if(ke.state.token?.address){Te.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.address,amount:ke.state.sendTokenAmount,network:R.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await ke.sendERC20Token({receiverAddress:ke.state.receiverAddress,tokenAddress:ke.state.token.address,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals});n&&(qe.hash=n)}else{Te.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.symbol||"",amount:ke.state.sendTokenAmount,network:R.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await ke.sendNativeToken({receiverAddress:ke.state.receiverAddress,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals});n&&(qe.hash=n)}},async fetchTokenBalance(t){qe.loading=!0;const e=R.state.activeChain,n=R.state.activeCaipNetwork?.caipNetworkId,r=R.state.activeCaipNetwork?.chainNamespace,s=R.getAccountData(e)?.caipAddress??R.state.activeCaipAddress,i=s?oe.getPlainAddress(s):void 0;if(qe.lastRetry&&!oe.isAllowedRetry(qe.lastRetry,30*De.ONE_SEC_MS))return qe.loading=!1,[];try{if(i&&n&&r){const o=await Yh.getMyTokensWithBalance();return qe.tokenBalances=o,qe.lastRetry=void 0,o}}catch(o){qe.lastRetry=Date.now(),t?.(o),at.showError("Token Balance Unavailable")}finally{qe.loading=!1}return[]},fetchNetworkBalance(){if(qe.tokenBalances.length===0)return;const t=Ma.mapBalancesToSwapTokens(qe.tokenBalances);if(!t)return;const e=t.find(n=>n.address===il());e&&(qe.networkBalanceInUSD=e?mt.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){de.pushTransactionStack({});const e=t.receiverAddress,n=R.getAccountData()?.address,r=ie.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await ie.sendTransaction({chainNamespace:z.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return Te.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Wt("eip155")===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token?.symbol||"",amount:t.sendTokenAmount,network:R.state.activeCaipNetwork?.caipNetworkId||"",hash:i||""}}),ie._getClient()?.updateBalance("eip155"),ke.resetSend(),{hash:i}},async sendERC20Token(t){de.pushTransactionStack({onSuccess(){de.replace("Account")}});const e=ie.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=R.getAccountData()?.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=oe.getPlainAddress(t.tokenAddress);if(!r)throw new Error("SendController:sendERC20Token - tokenAddress is required");const s=await ie.writeContract({fromAddress:n,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:Px.getERC20Abi(r),chainNamespace:z.CHAIN.EVM});return Te.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Wt("eip155")===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token?.symbol||"",amount:t.sendTokenAmount,network:R.state.activeCaipNetwork?.caipNetworkId||"",hash:s||""}}),ke.resetSend(),{hash:s}}return{hash:void 0}},async sendSolanaToken(){if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");de.pushTransactionStack({onSuccess(){de.replace("Account")}});let t;ke.state.token&&ke.state.token.address!==De.SOLANA_NATIVE_TOKEN_ADDRESS&&(oe.isCaipAddress(ke.state.token.address)?t=oe.getPlainAddress(ke.state.token.address):t=ke.state.token.address);const e=await ie.sendTransaction({chainNamespace:"solana",tokenMint:t,to:ke.state.receiverAddress,value:ke.state.sendTokenAmount});e&&(qe.hash=e),ie._getClient()?.updateBalance("solana"),Te.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:!1,token:ke.state.token?.symbol||"",amount:ke.state.sendTokenAmount,network:R.state.activeCaipNetwork?.caipNetworkId||"",hash:e||""}}),ke.resetSend()},resetSend(){qe.token=void 0,qe.sendTokenAmount=void 0,qe.receiverAddress=void 0,qe.receiverProfileImageUrl=void 0,qe.receiverProfileName=void 0,qe.loading=!1,qe.tokenBalances=[]}},ke=Yn(SD),r0={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},od={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ae=Je({chains:tx(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{connectionControllerClient:void 0},isSwitchingNamespace:!1}),DI={state:ae,subscribe(t){return vt(ae,()=>{t(ae)})},subscribeKey(t,e){return bt(ae,t,e)},subscribeAccountStateProp(t,e,n){const r=n||ae.activeChain;return r?bt(ae.chains.get(r)?.accountState||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return vt(ae.chains,()=>{const s=n||ae.activeChain;if(s){const i=ae.chains.get(s)?.[t];r!==i&&(r=i,e(i))}})},initialize(t,e,n){const{chainId:r,namespace:s}=G.getActiveNetworkProps(),i=e?.find(l=>l.id.toString()===r?.toString()),a=t.find(l=>l?.namespace===s)||t?.[0],c=t.map(l=>l.namespace).filter(l=>l!==void 0),u=V.state.enableEmbedded?new Set([...c]):new Set([...e?.map(l=>l.chainNamespace)??[]]);(t?.length===0||!a)&&(ae.noAdapters=!0),ae.noAdapters||(ae.activeChain=a?.namespace,ae.activeCaipNetwork=i,R.setChainNetworkData(a?.namespace,{caipNetwork:i}),ae.activeChain&&zr.set({activeChain:a?.namespace})),u.forEach(l=>{const d=e?.filter(g=>g.chainNamespace===l),f=G.getPreferredAccountTypes()||{},h={...V.state.defaultAccountTypes,...f};R.state.chains.set(l,{namespace:l,networkState:Je({...od,caipNetwork:d?.[0]}),accountState:Je({...r0,preferredAccountType:h[l]}),caipNetworks:d??[],...n}),R.setRequestedCaipNetworks(d??[],l)})},removeAdapter(t){if(ae.activeChain===t){const e=Array.from(ae.chains.entries()).find(([n])=>n!==t);if(e){const n=e[1]?.caipNetworks?.[0];n&&R.setActiveCaipNetwork(n)}}ae.chains.delete(t)},addAdapter(t,{connectionControllerClient:e},n){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");ae.chains.set(t.namespace,{namespace:t.namespace,networkState:{...od,caipNetwork:n[0]},accountState:{...r0},caipNetworks:n,connectionControllerClient:e}),R.setRequestedCaipNetworks(n?.filter(r=>r.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=ae.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];e.caipNetworks?.find(r=>r.id===t.id)||n.push(t),ae.chains.set(t.chainNamespace,{...e,caipNetworks:n}),R.setRequestedCaipNetworks(n,t.chainNamespace),X.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const n=ae.chains.get(t);if(n){const r=ae.activeCaipNetwork?.id===e,s=[...n.caipNetworks?.filter(i=>i.id!==e)||[]];r&&n?.caipNetworks?.[0]&&R.setActiveCaipNetwork(n.caipNetworks[0]),ae.chains.set(t,{...n,caipNetworks:s}),R.setRequestedCaipNetworks(s||[],t),s.length===0&&X.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=ae.chains.get(t);n&&(n.networkState={...n.networkState||od,...e},ae.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=ae.chains.get(t);if(r){const s={...r.accountState||r0,...e};ae.chains.set(t,{...r,accountState:s}),(ae.chains.size===1||ae.activeChain===t)&&e.caipAddress&&(ae.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=ae.chains.get(t);if(n){const r={...n.networkState||od,...e};ae.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){R.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){ae.activeChain=t;const e=t?ae.chains.get(t):void 0,n=e?.networkState?.caipNetwork;n?.id&&t&&(ae.activeCaipAddress=e?.accountState?.caipAddress,ae.activeCaipNetwork=n,R.setChainNetworkData(t,{caipNetwork:n}),G.setActiveCaipNetworkId(n?.caipNetworkId),zr.set({activeChain:t,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;const e=ae.activeChain===t.chainNamespace;e||R.setIsSwitchingNamespace(!0);const n=ae.chains.get(t.chainNamespace);ae.activeChain=t.chainNamespace,ae.activeCaipNetwork=t,R.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=n?.accountState?.address;if(r)ae.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&ae.activeCaipAddress){const{address:i}=Dt.parseCaipAddress(ae.activeCaipAddress);r=i,ae.activeCaipAddress=`${t.caipNetworkId}:${r}`}else ae.activeCaipAddress=void 0;R.setChainAccountData(t.chainNamespace,{address:r,caipAddress:ae.activeCaipAddress}),ke.resetSend(),zr.set({activeChain:ae.activeChain,selectedNetworkId:ae.activeCaipNetwork?.caipNetworkId}),G.setActiveCaipNetworkId(t.caipNetworkId),!R.checkIfSupportedNetwork(t.chainNamespace)&&V.state.enableNetworkSwitch&&!V.state.allowUnsupportedChain&&!ie.state.wcBasic&&R.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=ae.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==R.state.activeChain,n=R.getNetworkData(t)?.caipNetwork,r=R.getCaipNetworkByNamespace(t,n?.id);e&&r&&await R.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){const n=R.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=nt.getProviderId(ae.activeChain)==="AUTH",s=R.getAccountData(n)?.address,i=z.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t.chainNamespace);try{if(s&&t.chainNamespace===n||r&&i){const o=$I.get(t.chainNamespace);if(!o)throw new Error("Adapter not found");await o.switchNetwork({caipNetwork:t})}R.setActiveCaipNetwork(t)}catch(o){if(e)throw o}Te.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})},getConnectionControllerClient(t){const e=t||ae.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=ae.chains.get(e);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){const n=ae.chains.get(e)?.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=ae.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=e?.networkState||{};return oe.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return ae.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=R.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){R.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=R.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));X.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return ae.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=R.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){return t?ae.chains.get(t)?.networkState?.caipNetwork:ae.activeCaipNetwork},getActiveCaipAddress(){return ae.activeCaipAddress},getApprovedCaipNetworkIds(t){return ae.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},setApprovedCaipNetworksData(t,e){R.setAdapterNetworkState(t,e)},checkIfSupportedNetwork(t,e){const n=e||ae.activeCaipNetwork?.caipNetworkId,r=R.getRequestedCaipNetworks(t);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(t){return ae.activeChain?R.getRequestedCaipNetworks(ae.activeChain)?.some(n=>n.id===t):!0},checkIfSmartAccountEnabled(){const t=Fu.caipNetworkIdToNumber(ae.activeCaipNetwork?.caipNetworkId);return!ae.activeChain||!t?!1:!!(Rt.get(ge.SMART_ACCOUNT_ENABLED_NETWORKS)?.split(",")||[])?.includes(t.toString())},showUnsupportedChainUI(){Ue.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=ae.activeCaipNetwork;return!!(t?.chainNamespace&&De.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){R.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=R.state.chains.get(e)?.accountState?.preferredAccountType,r=V.state.defaultAccountTypes[e];ae.activeCaipAddress=void 0,R.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),X.removeConnectorId(e)},setIsSwitchingNamespace(t){ae.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(ae.chains.forEach(n=>{z.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&t.push(n.namespace)}),t.length>0){const n=t[0];return e=n?ae.chains.get(n)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||ae.activeChain;if(e)return R.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||ae.activeChain;if(e)return R.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const n=R.state.chains.get(t),r=n?.caipNetworks?.find(s=>s.id.toString()===e?.toString());return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=X.state.filterByNamespace;return(t?[ae.chains.get(t)]:Array.from(ae.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?R.getRequestedCaipNetworks(t):R.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return DI.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){ae.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return ae.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){const e=R.getAccountData();if(!e)return[];const n=R.state.activeCaipNetwork?.caipNetworkId,r=R.state.activeCaipNetwork?.chainNamespace,s=R.state.activeCaipAddress,i=s?oe.getPlainAddress(s):void 0;if(R.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!oe.isAllowedRetry(e.lastRetry,30*De.ONE_SEC_MS))return R.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const o=await Yh.getMyTokensWithBalance();return R.setAccountProp("tokenBalance",o,r),R.setAccountProp("lastRetry",void 0,r),R.setAccountProp("balanceLoading",!1,r),o}}catch(o){R.setAccountProp("lastRetry",Date.now(),r),t?.(o),at.showError("Token Balance Unavailable")}finally{R.setAccountProp("balanceLoading",!1,r)}return[]},isCaipNetworkDisabled(t){const e=t.chainNamespace,n=!!R.getAccountData(e)?.caipAddress,r=R.getAllApprovedCaipNetworkIds(),s=R.getNetworkProp("supportsAllNetworks",e)!==!1,i=X.getConnectorId(e),o=X.getAuthConnector(),a=i===z.CONNECTOR_ID.AUTH&&o;return!n||s||a?!1:!r?.includes(t.caipNetworkId)}},R=Yn(DI),ID={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=R.state.activeCaipNetwork,r=R.state.activeChain,s=de.state.data;if(t.id===n?.id)return;const o=!!R.getAccountData(r)?.address,a=!!R.getAccountData(t.chainNamespace)?.address,c=t.chainNamespace!==r,l=X.getConnectorId(r)===z.CONNECTOR_ID.AUTH,d=z.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(f=>f===t.chainNamespace);e||l&&d?de.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?de.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):de.push("SwitchNetwork",{...s,network:t})}},Nn=Je({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),TD={state:Nn,subscribe(t){return vt(Nn,()=>t(Nn))},subscribeKey(t,e){return bt(Nn,t,e)},async open(t){const e=t?.namespace,n=R.state.activeChain,r=e&&e!==n,s=R.getAccountData(t?.namespace)?.caipAddress,i=R.state.noAdapters;if(ie.state.wcBasic?ye.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await ye.prefetch(),X.setFilterByNamespace(t?.namespace),Ue.setLoading(!0,e),e&&r){const o=R.getNetworkData(e)?.caipNetwork||R.getRequestedCaipNetworks(e)[0];o&&(i?(await R.switchActiveNetwork(o),de.push("ConnectingWalletConnectBasic")):ID.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else V.state.manualWCControl||i&&!s?oe.isMobile()?de.reset("AllWallets"):de.reset("ConnectingWalletConnectBasic"):t?.view?de.reset(t.view,t.data):s?de.reset("Account"):de.reset("Connect");Nn.open=!0,zr.set({open:!0}),Te.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=V.state.enableEmbedded,e=!!R.state.activeCaipAddress;Nn.open&&Te.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),Nn.open=!1,de.reset("Connect"),Ue.clearLoading(),t?e?de.replace("Account"):de.push("Connect"):zr.set({open:!1}),ie.resetUri()},setLoading(t,e){e&&Nn.loadingNamespaceMap.set(e,t),Nn.loading=t,zr.set({loading:t})},clearLoading(){Nn.loadingNamespaceMap.clear(),Nn.loading=!1,zr.set({loading:!1})},shake(){Nn.shake||(Nn.shake=!0,setTimeout(()=>{Nn.shake=!1},500))}},Ue=Yn(TD),Tu={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},um={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},ND={providers:q_,selectedProvider:null,error:null,purchaseCurrency:Tu,paymentCurrency:um,purchaseCurrencies:[Tu],paymentCurrencies:[],quotesLoading:!1},ze=Je(ND),xD={state:ze,subscribe(t){return vt(ze,()=>t(ze))},subscribeKey(t,e){return bt(ze,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=R.state.activeChain,n=e===z.CHAIN.SOLANA?"SOL":"USDC",r=e?R.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",Rx),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",V.state.projectId),ze.selectedProvider={...t,url:s.toString()}}else ze.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=q_.filter(r=>e.includes(r.name));ze.providers=n}else ze.providers=[]},setPurchaseCurrency(t){ze.purchaseCurrency=t},setPaymentCurrency(t){ze.paymentCurrency=t},setPurchaseAmount(t){lm.state.purchaseAmount=t},setPaymentAmount(t){lm.state.paymentAmount=t},async getAvailableCurrencies(){const t=await Ee.getOnrampOptions();ze.purchaseCurrencies=t.purchaseCurrencies,ze.paymentCurrencies=t.paymentCurrencies,ze.paymentCurrency=t.paymentCurrencies[0]||um,ze.purchaseCurrency=t.purchaseCurrencies[0]||Tu,await ye.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await ye.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){ze.quotesLoading=!0;try{const t=await Ee.getOnrampQuote({purchaseCurrency:ze.purchaseCurrency,paymentCurrency:ze.paymentCurrency,amount:ze.paymentAmount?.toString()||"0",network:ze.purchaseCurrency?.symbol});return ze.quotesLoading=!1,ze.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return ze.error=t.message,ze.quotesLoading=!1,null}finally{ze.quotesLoading=!1}},resetState(){ze.selectedProvider=null,ze.error=null,ze.purchaseCurrency=Tu,ze.paymentCurrency=um,ze.purchaseCurrencies=[Tu],ze.paymentCurrencies=[],ze.paymentAmount=void 0,ze.purchaseAmount=void 0,ze.quotesLoading=!1}},lm=Yn(xD);var s0={};var dm=function(t,e){return dm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},dm(t,e)};function PD(t,e){dm(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var fm=function(){return fm=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fm.apply(this,arguments)};function OD(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function RD(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function kD(t,e){return function(n,r){e(n,r,t)}}function $D(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function DD(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})}function UD(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function BD(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function MD(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function hm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function UI(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function LD(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(UI(arguments[e]));return t}function FD(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function ol(t){return this instanceof ol?(this.v=t,this):new ol(t)}function jD(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(h){return new Promise(function(g,p){i.push([f,h,g,p])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(g){d(i[0][3],g)}}function c(f){f.value instanceof ol?Promise.resolve(f.value.v).then(u,l):d(i[0][2],f)}function u(f){a("next",f)}function l(f){a("throw",f)}function d(f,h){f(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function qD(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:ol(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function zD(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof hm=="function"?hm(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function HD(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function WD(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function VD(t){return t&&t.__esModule?t:{default:t}}function KD(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function GD(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const YD=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return fm},__asyncDelegator:qD,__asyncGenerator:jD,__asyncValues:zD,__await:ol,__awaiter:DD,__classPrivateFieldGet:KD,__classPrivateFieldSet:GD,__createBinding:BD,__decorate:RD,__exportStar:MD,__extends:PD,__generator:UD,__importDefault:VD,__importStar:WD,__makeTemplateObject:HD,__metadata:$D,__param:kD,__read:UI,__rest:OD,__spread:LD,__spreadArrays:FD,__values:hm},Symbol.toStringTag,{value:"Module"})),Zh=B_(YD);var i0={},Xc={},H1;function ZD(){if(H1)return Xc;H1=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Xc.delay=t,Xc}var mo={},o0={},yo={},W1;function JD(){return W1||(W1=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.ONE_THOUSAND=yo.ONE_HUNDRED=void 0,yo.ONE_HUNDRED=100,yo.ONE_THOUSAND=1e3),yo}var a0={},V1;function XD(){return V1||(V1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(a0)),a0}var K1;function BI(){return K1||(K1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zh;e.__exportStar(JD(),t),e.__exportStar(XD(),t)})(o0)),o0}var G1;function QD(){if(G1)return mo;G1=1,Object.defineProperty(mo,"__esModule",{value:!0}),mo.fromMiliseconds=mo.toMiliseconds=void 0;const t=BI();function e(r){return r*t.ONE_THOUSAND}mo.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return mo.fromMiliseconds=n,mo}var Y1;function eU(){return Y1||(Y1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zh;e.__exportStar(ZD(),t),e.__exportStar(QD(),t)})(i0)),i0}var Ia={},Z1;function tU(){if(Z1)return Ia;Z1=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Ia.Watch=t,Ia.default=t,Ia}var c0={},Qc={},J1;function nU(){if(J1)return Qc;J1=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.IWatch=void 0;class t{}return Qc.IWatch=t,Qc}var X1;function rU(){return X1||(X1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Zh.__exportStar(nU(),t)})(c0)),c0}var Q1;function sU(){return Q1||(Q1=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zh;e.__exportStar(eU(),t),e.__exportStar(tU(),t),e.__exportStar(rU(),t),e.__exportStar(BI(),t)})(s0)),s0}var re=sU();class ma{}let iU=class extends ma{constructor(e){super()}};const eE=re.FIVE_SECONDS,ya={pulse:"heartbeat_pulse"};let oU=class MI extends iU{constructor(e){super(e),this.events=new ts.EventEmitter,this.interval=eE,this.interval=e?.interval||eE}static async init(e){const n=new MI(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),re.toMiliseconds(this.interval))}pulse(){this.events.emit(ya.pulse)}};const aU=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,cU=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,uU=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function lU(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){dU(t);return}return e}function dU(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ad(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!uU.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(aU.test(t)||cU.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,lU)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function fU(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Mt(t,...e){try{return fU(t(...e))}catch(n){return Promise.reject(n)}}function hU(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function pU(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Wd(t){if(hU(t))return String(t);if(pU(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Wd(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const pm="base64:";function gU(t){return typeof t=="string"?t:pm+bU(t)}function mU(t){return typeof t!="string"||!t.startsWith(pm)?t:yU(t.slice(pm.length))}function yU(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function bU(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function On(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function wU(...t){return On(t.join(":"))}function cd(t){return t=On(t),t?t+":":""}function EU(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function vU(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const CU="memory",_U=()=>{const t=new Map;return{name:CU,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function AU(t={}){const e={mounts:{"":t.driver||_U()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},r=(u,l)=>e.mountpoints.filter(d=>d.startsWith(u)||l&&u.startsWith(d)).map(d=>({relativeBase:u.length>d.length?u.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(u,l)=>{if(e.watching){l=On(l);for(const d of e.watchListeners)d(u,l)}},i=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await tE(e.mounts[u],s,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,d)=>{const f=new Map,h=g=>{let p=f.get(g.base);return p||(p={driver:g.driver,base:g.base,items:[]},f.set(g.base,p)),p};for(const g of u){const p=typeof g=="string",y=On(p?g:g.key),E=p?void 0:g.value,A=p||!g.options?l:{...l,...g.options},w=n(y);h(w).items.push({key:y,value:E,relativeKey:w.relativeKey,options:A})}return Promise.all([...f.values()].map(g=>d(g))).then(g=>g.flat())},c={hasItem(u,l={}){u=On(u);const{relativeKey:d,driver:f}=n(u);return Mt(f.hasItem,d,l)},getItem(u,l={}){u=On(u);const{relativeKey:d,driver:f}=n(u);return Mt(f.getItem,d,l).then(h=>ad(h))},getItems(u,l={}){return a(u,l,d=>d.driver.getItems?Mt(d.driver.getItems,d.items.map(f=>({key:f.relativeKey,options:f.options})),l).then(f=>f.map(h=>({key:wU(d.base,h.key),value:ad(h.value)}))):Promise.all(d.items.map(f=>Mt(d.driver.getItem,f.relativeKey,f.options).then(h=>({key:f.key,value:ad(h)})))))},getItemRaw(u,l={}){u=On(u);const{relativeKey:d,driver:f}=n(u);return f.getItemRaw?Mt(f.getItemRaw,d,l):Mt(f.getItem,d,l).then(h=>mU(h))},async setItem(u,l,d={}){if(l===void 0)return c.removeItem(u);u=On(u);const{relativeKey:f,driver:h}=n(u);h.setItem&&(await Mt(h.setItem,f,Wd(l),d),h.watch||s("update",u))},async setItems(u,l){await a(u,l,async d=>{if(d.driver.setItems)return Mt(d.driver.setItems,d.items.map(f=>({key:f.relativeKey,value:Wd(f.value),options:f.options})),l);d.driver.setItem&&await Promise.all(d.items.map(f=>Mt(d.driver.setItem,f.relativeKey,Wd(f.value),f.options)))})},async setItemRaw(u,l,d={}){if(l===void 0)return c.removeItem(u,d);u=On(u);const{relativeKey:f,driver:h}=n(u);if(h.setItemRaw)await Mt(h.setItemRaw,f,l,d);else if(h.setItem)await Mt(h.setItem,f,gU(l),d);else return;h.watch||s("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=On(u);const{relativeKey:d,driver:f}=n(u);f.removeItem&&(await Mt(f.removeItem,d,l),(l.removeMeta||l.removeMata)&&await Mt(f.removeItem,d+"$",l),f.watch||s("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=On(u);const{relativeKey:d,driver:f}=n(u),h=Object.create(null);if(f.getMeta&&Object.assign(h,await Mt(f.getMeta,d,l)),!l.nativeOnly){const g=await Mt(f.getItem,d+"$",l).then(p=>ad(p));g&&typeof g=="object"&&(typeof g.atime=="string"&&(g.atime=new Date(g.atime)),typeof g.mtime=="string"&&(g.mtime=new Date(g.mtime)),Object.assign(h,g))}return h},setMeta(u,l,d={}){return this.setItem(u+"$",l,d)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){u=cd(u);const d=r(u,!0);let f=[];const h=[];let g=!0;for(const y of d){y.driver.flags?.maxDepth||(g=!1);const E=await Mt(y.driver.getKeys,y.relativeBase,l);for(const A of E){const w=y.mountpoint+On(A);f.some(C=>w.startsWith(C))||h.push(w)}f=[y.mountpoint,...f.filter(A=>!A.startsWith(y.mountpoint))]}const p=l.maxDepth!==void 0&&!g;return h.filter(y=>(!p||EU(y,l.maxDepth))&&vU(y,u))},async clear(u,l={}){u=cd(u),await Promise.all(r(u,!1).map(async d=>{if(d.driver.clear)return Mt(d.driver.clear,d.relativeBase,l);if(d.driver.removeItem){const f=await d.driver.getKeys(d.relativeBase||"",l);return Promise.all(f.map(h=>d.driver.removeItem(h,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>nE(u)))},async watch(u){return await i(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=cd(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((d,f)=>f.length-d.length)),e.mounts[u]=l,e.watching&&Promise.resolve(tE(l,s,u)).then(d=>{e.unwatch[u]=d}).catch(console.error),c},async unmount(u,l=!0){u=cd(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u]?.(),delete e.unwatch[u]),l&&await nE(e.mounts[u]),e.mountpoints=e.mountpoints.filter(d=>d!==u),delete e.mounts[u])},getMount(u=""){u=On(u)+":";const l=n(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=On(u),r(u,l.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,d={})=>c.setItem(u,l,d),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function tE(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function nE(t){typeof t.dispose=="function"&&await Mt(t.dispose)}function ba(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function LI(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const r=ba(n);return(s,i)=>r.then(o=>i(o.transaction(e,s).objectStore(e)))}let u0;function Ml(){return u0||(u0=LI("keyval-store","keyval")),u0}function rE(t,e=Ml()){return e("readonly",n=>ba(n.get(t)))}function SU(t,e,n=Ml()){return n("readwrite",r=>(r.put(e,t),ba(r.transaction)))}function IU(t,e=Ml()){return e("readwrite",n=>(n.delete(t),ba(n.transaction)))}function TU(t=Ml()){return t("readwrite",e=>(e.clear(),ba(e.transaction)))}function NU(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},ba(t.transaction)}function xU(t=Ml()){return t("readonly",e=>{if(e.getAllKeys)return ba(e.getAllKeys());const n=[];return NU(e,r=>n.push(r.key)).then(()=>n)})}const PU="idb-keyval";var OU=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=LI(t.dbName,t.storeName)),{name:PU,options:t,async hasItem(s){return!(typeof await rE(n(s),r)>"u")},async getItem(s){return await rE(n(s),r)??null},setItem(s,i){return SU(n(s),i,r)},removeItem(s){return IU(n(s),r)},getKeys(){return xU(r)},clear(){return TU(r)}}};const RU="WALLET_CONNECT_V2_INDEXED_DB",kU="keyvaluestorage";let $U=class{constructor(){this.indexedDb=AU({driver:OU({dbName:RU,storeName:kU})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,fi(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var l0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Vd={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof l0<"u"&&l0.localStorage?Vd.exports=l0.localStorage:typeof window<"u"&&window.localStorage?Vd.exports=window.localStorage:Vd.exports=new e})();function DU(t){var e;return[t[0],Yo((e=t[1])!=null?e:"")]}let UU=class{constructor(){this.localStorage=Vd.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(DU)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return Yo(n)}async setItem(e,n){this.localStorage.setItem(e,fi(n))}async removeItem(e){this.localStorage.removeItem(e)}};const BU="wc_storage_version",sE=1,MU=async(t,e,n)=>{const r=BU,s=await e.getItem(r);if(s&&s>=sE){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(r,sE),n(e),LU(t,o)},LU=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let FU=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new UU;this.storage=e;try{const n=new $U;MU(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var jU=Object.defineProperty,qU=(t,e,n)=>e in t?jU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iE=(t,e,n)=>qU(t,typeof e!="symbol"?e+"":e,n);let zU=class extends ma{constructor(e){super(),this.opts=e,iE(this,"protocol","wc"),iE(this,"version",2)}};var HU=Object.defineProperty,WU=(t,e,n)=>e in t?HU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,VU=(t,e,n)=>WU(t,e+"",n);let KU=class extends ma{constructor(e,n){super(),this.core=e,this.logger=n,VU(this,"records",new Map)}},GU=class{constructor(e,n){this.logger=e,this.core=n}},YU=class extends ma{constructor(e,n){super(),this.relayer=e,this.logger=n}},ZU=class extends ma{constructor(e){super()}},JU=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},XU=class extends ma{constructor(e,n){super(),this.relayer=e,this.logger=n}},QU=class extends ma{constructor(e,n){super(),this.core=e,this.logger=n}},e9=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},t9=class{constructor(e,n){this.projectId=e,this.logger=n}},n9=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var r9=Object.defineProperty,s9=(t,e,n)=>e in t?r9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oE=(t,e,n)=>s9(t,typeof e!="symbol"?e+"":e,n);let i9=class{constructor(e){this.opts=e,oE(this,"protocol","wc"),oE(this,"version",2)}},o9=class{constructor(e){this.client=e}};function a9(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function FI(t,...e){if(!a9(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function aE(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function c9(t,e){FI(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Ta=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const d0=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function u9(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function jI(t){return typeof t=="string"&&(t=u9(t)),FI(t),t}let l9=class{clone(){return this._cloneInto()}};function d9(t){const e=r=>t().update(jI(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function qI(t=32){if(Ta&&typeof Ta.getRandomValues=="function")return Ta.getRandomValues(new Uint8Array(t));if(Ta&&typeof Ta.randomBytes=="function")return Ta.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function f9(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}let h9=class extends l9{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=d0(this.buffer)}update(e){aE(this);const{view:n,buffer:r,blockLen:s}=this;e=jI(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=d0(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){aE(this),c9(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;f9(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=d0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const ud=BigInt(2**32-1),gm=BigInt(32);function zI(t,e=!1){return e?{h:Number(t&ud),l:Number(t>>gm&ud)}:{h:Number(t>>gm&ud)|0,l:Number(t&ud)|0}}function p9(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=zI(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const g9=(t,e)=>BigInt(t>>>0)<<gm|BigInt(e>>>0),m9=(t,e,n)=>t>>>n,y9=(t,e,n)=>t<<32-n|e>>>n,b9=(t,e,n)=>t>>>n|e<<32-n,w9=(t,e,n)=>t<<32-n|e>>>n,E9=(t,e,n)=>t<<64-n|e>>>n-32,v9=(t,e,n)=>t>>>n-32|e<<64-n,C9=(t,e)=>e,_9=(t,e)=>t,A9=(t,e,n)=>t<<n|e>>>32-n,S9=(t,e,n)=>e<<n|t>>>32-n,I9=(t,e,n)=>e<<n-32|t>>>64-n,T9=(t,e,n)=>t<<n-32|e>>>64-n;function N9(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const x9=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),P9=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,O9=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),R9=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,k9=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),$9=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Re={fromBig:zI,split:p9,toBig:g9,shrSH:m9,shrSL:y9,rotrSH:b9,rotrSL:w9,rotrBH:E9,rotrBL:v9,rotr32H:C9,rotr32L:_9,rotlSH:A9,rotlSL:S9,rotlBH:I9,rotlBL:T9,add:N9,add3L:x9,add3H:P9,add4L:O9,add4H:R9,add5H:$9,add5L:k9},[D9,U9]=Re.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Si=new Uint32Array(80),Ii=new Uint32Array(80);let B9=class extends h9{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:h,Gl:g,Hh:p,Hl:y}=this;return[e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y]}set(e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=g|0,this.Hh=p|0,this.Hl=y|0}process(e,n){for(let w=0;w<16;w++,n+=4)Si[w]=e.getUint32(n),Ii[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const C=Si[w-15]|0,_=Ii[w-15]|0,P=Re.rotrSH(C,_,1)^Re.rotrSH(C,_,8)^Re.shrSH(C,_,7),k=Re.rotrSL(C,_,1)^Re.rotrSL(C,_,8)^Re.shrSL(C,_,7),U=Si[w-2]|0,$=Ii[w-2]|0,L=Re.rotrSH(U,$,19)^Re.rotrBH(U,$,61)^Re.shrSH(U,$,6),M=Re.rotrSL(U,$,19)^Re.rotrBL(U,$,61)^Re.shrSL(U,$,6),D=Re.add4L(k,M,Ii[w-7],Ii[w-16]),T=Re.add4H(D,P,L,Si[w-7],Si[w-16]);Si[w]=T|0,Ii[w]=D|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:h,Fl:g,Gh:p,Gl:y,Hh:E,Hl:A}=this;for(let w=0;w<80;w++){const C=Re.rotrSH(d,f,14)^Re.rotrSH(d,f,18)^Re.rotrBH(d,f,41),_=Re.rotrSL(d,f,14)^Re.rotrSL(d,f,18)^Re.rotrBL(d,f,41),P=d&h^~d&p,k=f&g^~f&y,U=Re.add5L(A,_,k,U9[w],Ii[w]),$=Re.add5H(U,E,C,P,D9[w],Si[w]),L=U|0,M=Re.rotrSH(r,s,28)^Re.rotrBH(r,s,34)^Re.rotrBH(r,s,39),D=Re.rotrSL(r,s,28)^Re.rotrBL(r,s,34)^Re.rotrBL(r,s,39),T=r&i^r&a^i&a,O=s&o^s&c^o&c;E=p|0,A=y|0,p=h|0,y=g|0,h=d|0,g=f|0,{h:d,l:f}=Re.add(u|0,l|0,$|0,L|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const m=Re.add3L(L,D,O);r=Re.add3H(m,$,M,T),s=m|0}({h:r,l:s}=Re.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Re.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Re.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Re.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Re.add(this.Eh|0,this.El|0,d|0,f|0),{h,l:g}=Re.add(this.Fh|0,this.Fl|0,h|0,g|0),{h:p,l:y}=Re.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:E,l:A}=Re.add(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,u,l,d,f,h,g,p,y,E,A)}roundClean(){Si.fill(0),Ii.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const M9=d9(()=>new B9);const Rb=BigInt(0),HI=BigInt(1),L9=BigInt(2);function kb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function $b(t){if(!kb(t))throw new Error("Uint8Array expected")}function f0(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const F9=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Db(t){$b(t);let e="";for(let n=0;n<t.length;n++)e+=F9[t[n]];return e}function WI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Rb:BigInt("0x"+t)}const Ds={_0:48,_9:57,A:65,F:70,a:97,f:102};function cE(t){if(t>=Ds._0&&t<=Ds._9)return t-Ds._0;if(t>=Ds.A&&t<=Ds.F)return t-(Ds.A-10);if(t>=Ds.a&&t<=Ds.f)return t-(Ds.a-10)}function VI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=cE(t.charCodeAt(i)),a=cE(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function j9(t){return WI(Db(t))}function Kd(t){return $b(t),WI(Db(Uint8Array.from(t).reverse()))}function KI(t,e){return VI(t.toString(16).padStart(e*2,"0"))}function mm(t,e){return KI(t,e).reverse()}function Us(t,e,n){let r;if(typeof e=="string")try{r=VI(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(kb(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function uE(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];$b(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const h0=t=>typeof t=="bigint"&&Rb<=t;function q9(t,e,n){return h0(t)&&h0(e)&&h0(n)&&e<=t&&t<n}function eu(t,e,n,r){if(!q9(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function z9(t){let e;for(e=0;t>Rb;t>>=HI,e+=1);return e}const H9=t=>(L9<<BigInt(t-1))-HI,W9={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||kb(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ub(t,e,n={}){const r=(s,i,o)=>{const a=W9[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function lE(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Vt=BigInt(0),wt=BigInt(1),Io=BigInt(2),V9=BigInt(3),ym=BigInt(4),dE=BigInt(5),fE=BigInt(8);function $t(t,e){const n=t%e;return n>=Vt?n:e+n}function K9(t,e,n){if(e<Vt)throw new Error("invalid exponent, negatives unsupported");if(n<=Vt)throw new Error("invalid modulus");if(n===wt)return Vt;let r=wt;for(;e>Vt;)e&wt&&(r=r*t%n),t=t*t%n,e>>=wt;return r}function ss(t,e,n){let r=t;for(;e-- >Vt;)r*=r,r%=n;return r}function hE(t,e){if(t===Vt)throw new Error("invert: expected non-zero number");if(e<=Vt)throw new Error("invert: expected positive modulus, got "+e);let n=$t(t,e),r=e,s=Vt,i=wt;for(;n!==Vt;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==wt)throw new Error("invert: does not exist");return $t(s,e)}function G9(t){const e=(t-wt)/Io;let n,r,s;for(n=t-wt,r=0;n%Io===Vt;n/=Io,r++);for(s=Io;s<t&&K9(s,e,t)!==t-wt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+wt)/ym;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(n+wt)/Io;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,u=o.pow(o.mul(o.ONE,s),n),l=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let f=1;for(let g=o.sqr(d);f<c&&!o.eql(g,o.ONE);f++)g=o.sqr(g);const h=o.pow(u,wt<<BigInt(c-f-1));u=o.sqr(h),l=o.mul(l,h),d=o.mul(d,u),c=f}return l}}function Y9(t){if(t%ym===V9){const e=(t+wt)/ym;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%fE===dE){const e=(t-dE)/fE;return function(n,r){const s=n.mul(r,Io),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,Io),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return G9(t)}const Z9=(t,e)=>($t(t,e)&wt)===wt,J9=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function X9(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=J9.reduce((r,s)=>(r[s]="function",r),e);return Ub(t,n)}function Q9(t,e,n){if(n<Vt)throw new Error("invalid exponent, negatives unsupported");if(n===Vt)return t.ONE;if(n===wt)return e;let r=t.ONE,s=e;for(;n>Vt;)n&wt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=wt;return r}function eB(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function GI(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function YI(t,e,n=!1,r={}){if(t<=Vt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=GI(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:H9(s),ZERO:Vt,ONE:wt,create:c=>$t(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Vt<=c&&c<t},is0:c=>c===Vt,isOdd:c=>(c&wt)===wt,neg:c=>$t(-c,t),eql:(c,u)=>c===u,sqr:c=>$t(c*c,t),add:(c,u)=>$t(c+u,t),sub:(c,u)=>$t(c-u,t),mul:(c,u)=>$t(c*u,t),pow:(c,u)=>Q9(a,c,u),div:(c,u)=>$t(c*hE(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>hE(c,t),sqrt:r.sqrt||(c=>(o||(o=Y9(t)),o(a,c))),invertBatch:c=>eB(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>n?mm(c,i):KI(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Kd(c):j9(c)}});return Object.freeze(a)}const pE=BigInt(0),ld=BigInt(1);function p0(t,e){const n=e.negate();return t?n:e}function ZI(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function g0(t,e){ZI(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function tB(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function nB(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const m0=new WeakMap,JI=new WeakMap;function y0(t){return JI.get(t)||1}function rB(t,e){return{constTimeNegate:p0,hasPrecomputes(n){return y0(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>pE;)r&ld&&(s=s.add(i)),i=i.double(),r>>=ld;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=g0(r,e),o=[];let a=n,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=g0(n,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**n-1),l=2**n,d=BigInt(n);for(let f=0;f<i;f++){const h=f*o;let g=Number(s&u);s>>=d,g>o&&(g-=l,s+=ld);const p=h,y=h+Math.abs(g)-1,E=f%2!==0,A=g<0;g===0?c=c.add(p0(E,r[p])):a=a.add(p0(A,r[y]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=g0(n,e),c=BigInt(2**n-1),u=2**n,l=BigInt(n);for(let d=0;d<o;d++){const f=d*a;if(s===pE)break;let h=Number(s&c);if(s>>=l,h>a&&(h-=u,s+=ld),h===0)continue;let g=r[f+Math.abs(h)-1];h<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(n,r,s){let i=m0.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&m0.set(r,s(i))),i},wNAFCached(n,r,s){const i=y0(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=y0(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){ZI(r,e),JI.set(n,r),m0.delete(n)}}}function sB(t,e,n,r){if(tB(n,t),nB(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=z9(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let d=u;d>=0;d-=o){c.fill(s);for(let h=0;h<r.length;h++){const g=r[h],p=Number(g>>BigInt(d)&BigInt(a));c[p]=c[p].add(n[h])}let f=s;for(let h=c.length-1,g=s;h>0;h--)g=g.add(c[h]),f=f.add(g);if(l=l.add(f),d!==0)for(let h=0;h<o;h++)l=l.double()}return l}function iB(t){return X9(t.Fp),Ub(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...GI(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const xr=BigInt(0),xn=BigInt(1),dd=BigInt(2),oB=BigInt(8),aB={zip215:!0};function cB(t){const e=iB(t);return Ub(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function uB(t){const e=cB(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,u=dd<<BigInt(a*8)-xn,l=n.create,d=YI(e.n,e.nBitLength),f=e.uvRatio||((m,b)=>{try{return{isValid:!0,value:n.sqrt(m*n.inv(b))}}catch{return{isValid:!1,value:xr}}}),h=e.adjustScalarBytes||(m=>m),g=e.domain||((m,b,v)=>{if(f0("phflag",v),b.length||v)throw new Error("Contexts/pre-hash are not supported");return m});function p(m,b){eu("coordinate "+m,b,xr,u)}function y(m){if(!(m instanceof w))throw new Error("ExtendedPoint expected")}const E=lE((m,b)=>{const{ex:v,ey:S,ez:I}=m,x=m.is0();b==null&&(b=x?oB:n.inv(I));const B=l(v*b),F=l(S*b),W=l(I*b);if(x)return{x:xr,y:xn};if(W!==xn)throw new Error("invZ was invalid");return{x:B,y:F}}),A=lE(m=>{const{a:b,d:v}=e;if(m.is0())throw new Error("bad point: ZERO");const{ex:S,ey:I,ez:x,et:B}=m,F=l(S*S),W=l(I*I),j=l(x*x),q=l(j*j),Y=l(F*b),Q=l(j*l(Y+W)),ue=l(q+l(v*l(F*W)));if(Q!==ue)throw new Error("bad point: equation left != right (1)");const J=l(S*I),te=l(x*B);if(J!==te)throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(b,v,S,I){this.ex=b,this.ey=v,this.ez=S,this.et=I,p("x",b),p("y",v),p("z",S),p("t",I),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(b){if(b instanceof w)throw new Error("extended point not allowed");const{x:v,y:S}=b||{};return p("x",v),p("y",S),new w(v,S,xn,l(v*S))}static normalizeZ(b){const v=n.invertBatch(b.map(S=>S.ez));return b.map((S,I)=>S.toAffine(v[I])).map(w.fromAffine)}static msm(b,v){return sB(w,d,b,v)}_setWindowSize(b){P.setWindowSize(this,b)}assertValidity(){A(this)}equals(b){y(b);const{ex:v,ey:S,ez:I}=this,{ex:x,ey:B,ez:F}=b,W=l(v*F),j=l(x*I),q=l(S*F),Y=l(B*I);return W===j&&q===Y}is0(){return this.equals(w.ZERO)}negate(){return new w(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:b}=e,{ex:v,ey:S,ez:I}=this,x=l(v*v),B=l(S*S),F=l(dd*l(I*I)),W=l(b*x),j=v+S,q=l(l(j*j)-x-B),Y=W+B,Q=Y-F,ue=W-B,J=l(q*Q),te=l(Y*ue),Ae=l(q*ue),Oe=l(Q*Y);return new w(J,te,Oe,Ae)}add(b){y(b);const{a:v,d:S}=e,{ex:I,ey:x,ez:B,et:F}=this,{ex:W,ey:j,ez:q,et:Y}=b;if(v===BigInt(-1)){const Sw=l((x-I)*(j+W)),Iw=l((x+I)*(j-W)),_p=l(Iw-Sw);if(_p===xr)return this.double();const Tw=l(B*dd*Y),Nw=l(F*dd*q),xw=Nw+Tw,Pw=Iw+Sw,Ow=Nw-Tw,NN=l(xw*_p),xN=l(Pw*Ow),PN=l(xw*Ow),ON=l(_p*Pw);return new w(NN,xN,ON,PN)}const Q=l(I*W),ue=l(x*j),J=l(F*S*Y),te=l(B*q),Ae=l((I+x)*(W+j)-Q-ue),Oe=te-J,Be=te+J,rt=l(ue-v*Q),St=l(Ae*Oe),ns=l(Be*rt),po=l(Ae*rt),va=l(Oe*Be);return new w(St,ns,va,po)}subtract(b){return this.add(b.negate())}wNAF(b){return P.wNAFCached(this,b,w.normalizeZ)}multiply(b){const v=b;eu("scalar",v,xn,r);const{p:S,f:I}=this.wNAF(v);return w.normalizeZ([S,I])[0]}multiplyUnsafe(b,v=w.ZERO){const S=b;return eu("scalar",S,xr,r),S===xr?_:this.is0()||S===xn?this:P.wNAFCachedUnsafe(this,S,w.normalizeZ,v)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return P.unsafeLadder(this,r).is0()}toAffine(b){return E(this,b)}clearCofactor(){const{h:b}=e;return b===xn?this:this.multiplyUnsafe(b)}static fromHex(b,v=!1){const{d:S,a:I}=e,x=n.BYTES;b=Us("pointHex",b,x),f0("zip215",v);const B=b.slice(),F=b[x-1];B[x-1]=F&-129;const W=Kd(B),j=v?u:n.ORDER;eu("pointHex.y",W,xr,j);const q=l(W*W),Y=l(q-xn),Q=l(S*q-I);let{isValid:ue,value:J}=f(Y,Q);if(!ue)throw new Error("Point.fromHex: invalid y coordinate");const te=(J&xn)===xn,Ae=(F&128)!==0;if(!v&&J===xr&&Ae)throw new Error("Point.fromHex: x=0 and x_0=1");return Ae!==te&&(J=l(-J)),w.fromAffine({x:J,y:W})}static fromPrivateKey(b){return $(b).point}toRawBytes(){const{x:b,y:v}=this.toAffine(),S=mm(v,n.BYTES);return S[S.length-1]|=b&xn?128:0,S}toHex(){return Db(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,xn,l(e.Gx*e.Gy)),w.ZERO=new w(xr,xn,xn,xr);const{BASE:C,ZERO:_}=w,P=rB(w,a*8);function k(m){return $t(m,r)}function U(m){return k(Kd(m))}function $(m){const b=n.BYTES;m=Us("private key",m,b);const v=Us("hashed private key",i(m),2*b),S=h(v.slice(0,b)),I=v.slice(b,2*b),x=U(S),B=C.multiply(x),F=B.toRawBytes();return{head:S,prefix:I,scalar:x,point:B,pointBytes:F}}function L(m){return $(m).pointBytes}function M(m=new Uint8Array,...b){const v=uE(...b);return U(i(g(v,Us("context",m),!!s)))}function D(m,b,v={}){m=Us("message",m),s&&(m=s(m));const{prefix:S,scalar:I,pointBytes:x}=$(b),B=M(v.context,S,m),F=C.multiply(B).toRawBytes(),W=M(v.context,F,x,m),j=k(B+W*I);eu("signature.s",j,xr,r);const q=uE(F,mm(j,n.BYTES));return Us("result",q,n.BYTES*2)}const T=aB;function O(m,b,v,S=T){const{context:I,zip215:x}=S,B=n.BYTES;m=Us("signature",m,2*B),b=Us("message",b),v=Us("publicKey",v,B),x!==void 0&&f0("zip215",x),s&&(b=s(b));const F=Kd(m.slice(B,2*B));let W,j,q;try{W=w.fromHex(v,x),j=w.fromHex(m.slice(0,B),x),q=C.multiplyUnsafe(F)}catch{return!1}if(!x&&W.isSmallOrder())return!1;const Y=M(I,j.toRawBytes(),W.toRawBytes(),b);return j.add(W.multiplyUnsafe(Y)).subtract(q).clearCofactor().equals(w.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:L,sign:D,verify:O,ExtendedPoint:w,utils:{getExtendedPublicKey:$,randomPrivateKey:()=>o(n.BYTES),precompute(m=8,b=w.BASE){return b._setWindowSize(m),b.multiply(BigInt(3)),b}}}}BigInt(0),BigInt(1);const Bb=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),gE=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const lB=BigInt(1),mE=BigInt(2);BigInt(3);const dB=BigInt(5),fB=BigInt(8);function hB(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Bb,o=t*t%i*t%i,a=ss(o,mE,i)*o%i,c=ss(a,lB,i)*t%i,u=ss(c,dB,i)*c%i,l=ss(u,e,i)*u%i,d=ss(l,n,i)*l%i,f=ss(d,r,i)*d%i,h=ss(f,s,i)*f%i,g=ss(h,s,i)*f%i,p=ss(g,e,i)*u%i;return{pow_p_5_8:ss(p,mE,i)*t%i,b2:o}}function pB(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function gB(t,e){const n=Bb,r=$t(e*e*e,n),s=$t(r*r*e,n),i=hB(t*s).pow_p_5_8;let o=$t(t*r*i,n);const a=$t(e*o*o,n),c=o,u=$t(o*gE,n),l=a===t,d=a===$t(-t,n),f=a===$t(-t*gE,n);return l&&(o=c),(d||f)&&(o=u),Z9(o,n)&&(o=$t(-o,n)),{isValid:l||d,value:o}}const mB=YI(Bb,void 0,!0),yB={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:mB,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:fB,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:M9,randomBytes:qI,adjustScalarBytes:pB,uvRatio:gB},XI=uB(yB),bB="EdDSA",wB="JWT",jf=".",Jh="base64url",QI="utf8",e5="utf8",EB=":",vB="did",CB="key",yE="base58btc",_B="z",AB="K36",SB=32;function Mb(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function t5(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Mb(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function n5(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=t5(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Mb(n)}function IB(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,y=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var w=(A-E)*l+1>>>0,C=new Uint8Array(w);E!==A;){for(var _=g[E],P=0,k=w-1;(_!==0||P<y)&&k!==-1;k--,P++)_+=256*C[k]>>>0,C[k]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");y=P,E++}for(var U=w-y;U!==w&&C[U]===0;)U++;for(var $=c.repeat(p);U<w;++U)$+=t.charAt(C[U]);return $}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var y=0,E=0;g[p]===c;)y++,p++;for(var A=(g.length-p)*u+1>>>0,w=new Uint8Array(A);g[p];){var C=n[g.charCodeAt(p)];if(C===255)return;for(var _=0,P=A-1;(C!==0||_<E)&&P!==-1;P--,_++)C+=a*w[P]>>>0,w[P]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");E=_,p++}if(g[p]!==" "){for(var k=A-E;k!==A&&w[k]===0;)k++;for(var U=new Uint8Array(y+(A-k)),$=y;k!==A;)U[$++]=w[k++];return U}}}function h(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var TB=IB,NB=TB;const r5=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},xB=t=>new TextEncoder().encode(t),PB=t=>new TextDecoder().decode(t);let OB=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},RB=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return s5(this,e)}},kB=class{constructor(e){this.decoders=e}or(e){return s5(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const s5=(t,e)=>new kB({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let $B=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new OB(e,n,r),this.decoder=new RB(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Xh=({name:t,prefix:e,encode:n,decode:r})=>new $B(t,e,n,r),Ll=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=NB(n,e);return Xh({prefix:t,name:e,encode:r,decode:i=>r5(s(i))})},DB=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},UB=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},en=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Xh({prefix:e,name:t,encode(s){return UB(s,r,n)},decode(s){return DB(s,r,n,t)}}),BB=Xh({prefix:"\0",name:"identity",encode:t=>PB(t),decode:t=>xB(t)});var MB=Object.freeze({__proto__:null,identity:BB});const LB=en({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var FB=Object.freeze({__proto__:null,base2:LB});const jB=en({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var qB=Object.freeze({__proto__:null,base8:jB});const zB=Ll({prefix:"9",name:"base10",alphabet:"0123456789"});var HB=Object.freeze({__proto__:null,base10:zB});const WB=en({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),VB=en({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var KB=Object.freeze({__proto__:null,base16:WB,base16upper:VB});const GB=en({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),YB=en({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ZB=en({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),JB=en({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),XB=en({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),QB=en({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eM=en({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),tM=en({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nM=en({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var rM=Object.freeze({__proto__:null,base32:GB,base32upper:YB,base32pad:ZB,base32padupper:JB,base32hex:XB,base32hexupper:QB,base32hexpad:eM,base32hexpadupper:tM,base32z:nM});const sM=Ll({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iM=Ll({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var oM=Object.freeze({__proto__:null,base36:sM,base36upper:iM});const aM=Ll({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cM=Ll({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var uM=Object.freeze({__proto__:null,base58btc:aM,base58flickr:cM});const lM=en({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dM=en({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),fM=en({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hM=en({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var pM=Object.freeze({__proto__:null,base64:lM,base64pad:dM,base64url:fM,base64urlpad:hM});const i5=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),gM=i5.reduce((t,e,n)=>(t[n]=e,t),[]),mM=i5.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function yM(t){return t.reduce((e,n)=>(e+=gM[n],e),"")}function bM(t){const e=[];for(const n of t){const r=mM[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const wM=Xh({prefix:"ðŸš€",name:"base256emoji",encode:yM,decode:bM});var EM=Object.freeze({__proto__:null,base256emoji:wM}),vM=o5,bE=128,CM=-128,_M=Math.pow(2,31);function o5(t,e,n){e=e||[],n=n||0;for(var r=n;t>=_M;)e[n++]=t&255|bE,t/=128;for(;t&CM;)e[n++]=t&255|bE,t>>>=7;return e[n]=t|0,o5.bytes=n-r+1,e}var AM=bm,SM=128,wE=127;function bm(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw bm.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&wE)<<s:(o&wE)*Math.pow(2,s),s+=7}while(o>=SM);return bm.bytes=i-r,n}var IM=Math.pow(2,7),TM=Math.pow(2,14),NM=Math.pow(2,21),xM=Math.pow(2,28),PM=Math.pow(2,35),OM=Math.pow(2,42),RM=Math.pow(2,49),kM=Math.pow(2,56),$M=Math.pow(2,63),DM=function(t){return t<IM?1:t<TM?2:t<NM?3:t<xM?4:t<PM?5:t<OM?6:t<RM?7:t<kM?8:t<$M?9:10},UM={encode:vM,decode:AM,encodingLength:DM},a5=UM;const EE=(t,e,n=0)=>(a5.encode(t,e,n),e),vE=t=>a5.encodingLength(t),wm=(t,e)=>{const n=e.byteLength,r=vE(t),s=r+vE(n),i=new Uint8Array(s+n);return EE(t,i,0),EE(n,i,r),i.set(e,s),new BM(t,n,e,i)};let BM=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const c5=({name:t,code:e,encode:n})=>new MM(t,e,n);let MM=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?wm(this.code,n):n.then(r=>wm(this.code,r))}else throw Error("Unknown type, must be binary type")}};const u5=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),LM=c5({name:"sha2-256",code:18,encode:u5("SHA-256")}),FM=c5({name:"sha2-512",code:19,encode:u5("SHA-512")});var jM=Object.freeze({__proto__:null,sha256:LM,sha512:FM});const l5=0,qM="identity",d5=r5,zM=t=>wm(l5,d5(t)),HM={code:l5,name:qM,encode:d5,digest:zM};var WM=Object.freeze({__proto__:null,identity:HM});new TextEncoder,new TextDecoder;const CE={...MB,...FB,...qB,...HB,...KB,...rM,...oM,...uM,...pM,...EM};({...jM,...WM});function f5(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const _E=f5("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),b0=f5("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=t5(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),h5={utf8:_E,"utf-8":_E,hex:CE.base16,latin1:b0,ascii:b0,binary:b0,...CE};function Qh(t,e="utf8"){const n=h5[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Wc(t,e="utf8"){const n=h5[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mb(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function AE(t){return Yo(Qh(Wc(t,Jh),QI))}function qf(t){return Qh(Wc(fi(t),QI),Jh)}function p5(t){const e=Wc(AB,yE),n=_B+Qh(n5([e,t]),yE);return[vB,CB,n].join(EB)}function VM(t){return Qh(t,Jh)}function KM(t){return Wc(t,Jh)}function GM(t){return Wc([qf(t.header),qf(t.payload)].join(jf),e5)}function YM(t){return[qf(t.header),qf(t.payload),VM(t.signature)].join(jf)}function Em(t){const e=t.split(jf),n=AE(e[0]),r=AE(e[1]),s=KM(e[2]),i=Wc(e.slice(0,2).join(jf),e5);return{header:n,payload:r,signature:s,data:i}}function SE(t=qI(SB)){const e=XI.getPublicKey(t);return{secretKey:n5([t,e]),publicKey:e}}async function ZM(t,e,n,r,s=re.fromMiliseconds(Date.now())){const i={alg:bB,typ:wB},o=p5(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},u=GM({header:i,payload:c}),l=XI.sign(u,r.secretKey.slice(0,32));return YM({header:i,payload:c,signature:l})}var et={},IE;function g5(){if(IE)return et;IE=1,Object.defineProperty(et,"__esModule",{value:!0}),et.getLocalStorage=et.getLocalStorageOrThrow=et.getCrypto=et.getCryptoOrThrow=et.getLocation=et.getLocationOrThrow=et.getNavigator=et.getNavigatorOrThrow=et.getDocument=et.getDocumentOrThrow=et.getFromWindowOrThrow=et.getFromWindow=void 0;function t(f){let h;return typeof window<"u"&&typeof window[f]<"u"&&(h=window[f]),h}et.getFromWindow=t;function e(f){const h=t(f);if(!h)throw new Error(`${f} is not defined in Window`);return h}et.getFromWindowOrThrow=e;function n(){return e("document")}et.getDocumentOrThrow=n;function r(){return t("document")}et.getDocument=r;function s(){return e("navigator")}et.getNavigatorOrThrow=s;function i(){return t("navigator")}et.getNavigator=i;function o(){return e("location")}et.getLocationOrThrow=o;function a(){return t("location")}et.getLocation=a;function c(){return e("crypto")}et.getCryptoOrThrow=c;function u(){return t("crypto")}et.getCrypto=u;function l(){return e("localStorage")}et.getLocalStorageOrThrow=l;function d(){return t("localStorage")}return et.getLocalStorage=d,et}var mi=g5(),tu={},TE;function JM(){if(TE)return tu;TE=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.getWindowMetadata=void 0;const t=g5();function e(){let n,r;try{n=t.getDocumentOrThrow(),r=t.getLocationOrThrow()}catch{return null}function s(){const h=n.getElementsByTagName("link"),g=[];for(let p=0;p<h.length;p++){const y=h[p],E=y.getAttribute("rel");if(E&&E.toLowerCase().indexOf("icon")>-1){const A=y.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let w=r.protocol+"//"+r.host;if(A.indexOf("/")===0)w+=A;else{const C=r.pathname.split("/");C.pop();const _=C.join("/");w+=_+"/"+A}g.push(w)}else if(A.indexOf("//")===0){const w=r.protocol+A;g.push(w)}else g.push(A)}}return g}function i(...h){const g=n.getElementsByTagName("meta");for(let p=0;p<g.length;p++){const y=g[p],E=["itemprop","property","name"].map(A=>y.getAttribute(A)).filter(A=>A?h.includes(A):!1);if(E.length&&E){const A=y.getAttribute("content");if(A)return A}}return""}function o(){let h=i("name","og:site_name","og:title","twitter:title");return h||(h=n.title),h}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),u=a(),l=r.origin,d=s();return{description:u,url:l,icons:d,name:c}}return tu.getWindowMetadata=e,tu}var XM=JM();const QM="0.1.1";function eL(){return QM}let At=class vm extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof vm){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof vm&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${eL()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return m5(this,e)}};function m5(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?m5(t.cause,e):e?null:t}const Lb=BigInt(0),Cm=BigInt(1);function Fl(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fb(t){if(!Fl(t))throw new Error("Uint8Array expected")}function al(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function fd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function y5(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Lb:BigInt("0x"+t)}const b5=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",tL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function cl(t){if(Fb(t),b5)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=tL[t[n]];return e}const Bs={_0:48,_9:57,A:65,F:70,a:97,f:102};function NE(t){if(t>=Bs._0&&t<=Bs._9)return t-Bs._0;if(t>=Bs.A&&t<=Bs.F)return t-(Bs.A-10);if(t>=Bs.a&&t<=Bs.f)return t-(Bs.a-10)}function zf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(b5)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=NE(t.charCodeAt(i)),a=NE(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function zo(t){return y5(cl(t))}function w5(t){return Fb(t),y5(cl(Uint8Array.from(t).reverse()))}function jl(t,e){return zf(t.toString(16).padStart(e*2,"0"))}function E5(t,e){return jl(t,e).reverse()}function wr(t,e,n){let r;if(typeof e=="string")try{r=zf(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Fl(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Hf(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Fb(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const w0=t=>typeof t=="bigint"&&Lb<=t;function jb(t,e,n){return w0(t)&&w0(e)&&w0(n)&&e<=t&&t<n}function ec(t,e,n,r){if(!jb(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function nL(t){let e;for(e=0;t>Lb;t>>=Cm,e+=1);return e}const ep=t=>(Cm<<BigInt(t))-Cm,E0=t=>new Uint8Array(t),xE=t=>Uint8Array.from(t);function rL(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=E0(t),s=E0(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=E0(0))=>{s=a(xE([0]),d),r=a(),d.length!==0&&(s=a(xE([1]),d),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const f=[];for(;d<e;){r=a();const h=r.slice();f.push(h),d+=r.length}return Hf(...f)};return(d,f)=>{o(),c(d);let h;for(;!(h=f(u()));)c();return o(),h}}const sL={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Fl(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function tp(t,e,n={}){const r=(s,i,o)=>{const a=sL[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function PE(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}function iL(t,e){if($E(t)>e)throw new IL({givenSize:$E(t),maxSize:e})}const Ms={zero:48,nine:57,A:65,F:70,a:97,f:102};function OE(t){if(t>=Ms.zero&&t<=Ms.nine)return t-Ms.zero;if(t>=Ms.A&&t<=Ms.F)return t-(Ms.A-10);if(t>=Ms.a&&t<=Ms.f)return t-(Ms.a-10)}function oL(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new TL({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function v5(t,e){if(oo(t)>e)throw new mL({givenSize:oo(t),maxSize:e})}function aL(t,e){if(typeof e=="number"&&e>0&&e>oo(t)-1)throw new A5({offset:e,position:"start",size:oo(t)})}function cL(t,e,n){if(typeof e=="number"&&typeof n=="number"&&oo(t)!==n-e)throw new A5({offset:n,position:"end",size:oo(t)})}function C5(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new yL({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const uL="#__bigint";function qb(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+uL:s,n)}const lL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function dL(t,e={}){const{strict:n=!1}=e;if(!t)throw new RE(t);if(typeof t!="string")throw new RE(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new kE(t);if(!t.startsWith("0x"))throw new kE(t)}function fL(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function zb(t){return t instanceof Uint8Array?Wf(t):Array.isArray(t)?Wf(new Uint8Array(t)):t}function Wf(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=lL[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(v5(r,e.size),_5(r,e.size)):r}function v0(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const u=typeof t=="bigint"?"n":"";throw new gL({max:i?`${i}${u}`:void 0,min:`${o}${u}`,signed:n,size:r,value:`${t}${u}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?hL(c,r):c}function hL(t,e){return C5(t,{dir:"left",size:e})}function _5(t,e){return C5(t,{dir:"right",size:e})}function Vs(t,e,n,r={}){const{strict:s}=r;aL(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&cL(i,e,n),i}function oo(t){return Math.ceil((t.length-2)/2)}function pL(t,e={}){const{strict:n=!1}=e;try{return dL(t,{strict:n}),!0}catch{return!1}}class gL extends At{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class RE extends At{constructor(e){super(`Value \`${typeof e=="object"?qb(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class kE extends At{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let mL=class extends At{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class A5 extends At{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let yL=class extends At{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const bL=new TextEncoder;function wL(t){if(!(t instanceof Uint8Array)){if(!t)throw new hd(t);if(typeof t!="object")throw new hd(t);if(!("BYTES_PER_ELEMENT"in t))throw new hd(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new hd(t)}}function EL(t){return t instanceof Uint8Array?t:typeof t=="string"?CL(t):vL(t)}function vL(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function CL(t,e={}){const{size:n}=e;let r=t;n&&(v5(t,n),r=_5(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const u=OE(s.charCodeAt(c++)),l=OE(s.charCodeAt(c++));if(u===void 0||l===void 0)throw new At(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=u*16+l}return o}function _L(t,e={}){const{size:n}=e,r=bL.encode(t);return typeof n=="number"?(iL(r,n),AL(r,n)):r}function AL(t,e){return oL(t,{dir:"right",size:e})}function $E(t){return t.length}function SL(t){try{return wL(t),!0}catch{return!1}}class hd extends At{constructor(e){super(`Value \`${typeof e=="object"?qb(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class IL extends At{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class TL extends At{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function S5(t,e={}){const{as:n=typeof t=="string"?"Hex":"Bytes"}=e,r=my(EL(t));return n==="Bytes"?r:Wf(r)}class NL extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const xL={checksum:new NL(8192)},C0=xL.checksum;function I5(t,e={}){const{compressed:n}=e,{prefix:r,x:s,y:i}=t;if(n===!1||typeof s=="bigint"&&typeof i=="bigint"){if(r!==4)throw new DE({prefix:r,cause:new DL});return}if(n===!0||typeof s=="bigint"&&typeof i>"u"){if(r!==3&&r!==2)throw new DE({prefix:r,cause:new $L});return}throw new kL({publicKey:t})}function PL(t){const e=(()=>{if(pL(t))return T5(t);if(SL(t))return OL(t);const{prefix:n,x:r,y:s}=t;return typeof r=="bigint"&&typeof s=="bigint"?{prefix:n??4,x:r,y:s}:{prefix:n,x:r}})();return I5(e),e}function OL(t){return T5(Wf(t))}function T5(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new UL({publicKey:t});if(t.length===130){const r=BigInt(Vs(t,0,32)),s=BigInt(Vs(t,32,64));return{prefix:4,x:r,y:s}}if(t.length===132){const r=Number(Vs(t,0,1)),s=BigInt(Vs(t,1,33)),i=BigInt(Vs(t,33,65));return{prefix:r,x:s,y:i}}const e=Number(Vs(t,0,1)),n=BigInt(Vs(t,1,33));return{prefix:e,x:n}}function RL(t,e={}){I5(t);const{prefix:n,x:r,y:s}=t,{includePrefix:i=!0}=e;return fL(i?v0(n,{size:1}):"0x",v0(r,{size:32}),typeof s=="bigint"?v0(s,{size:32}):"0x")}class kL extends At{constructor({publicKey:e}){super(`Value \`${qb(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class DE extends At{constructor({prefix:e,cause:n}){super(`Prefix "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class $L extends At{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class DL extends At{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let UL=class extends At{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${oo(zb(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const BL=/^0x[a-fA-F0-9]{40}$/;function N5(t,e={}){const{strict:n=!0}=e;if(!BL.test(t))throw new UE({address:t,cause:new FL});if(n){if(t.toLowerCase()===t)return;if(x5(t)!==t)throw new UE({address:t,cause:new jL})}}function x5(t){if(C0.has(t))return C0.get(t);N5(t,{strict:!1});const e=t.substring(2).toLowerCase(),n=S5(_L(e),{as:"Bytes"}),r=e.split("");for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&r[i]&&(r[i]=r[i].toUpperCase()),(n[i>>1]&15)>=8&&r[i+1]&&(r[i+1]=r[i+1].toUpperCase());const s=`0x${r.join("")}`;return C0.set(t,s),s}function ML(t,e={}){const{checksum:n=!1}=e;return N5(t),n?x5(t):t}function LL(t,e={}){const n=S5(`0x${RL(t).slice(4)}`).substring(26);return ML(`0x${n}`,e)}class UE extends At{constructor({address:e,cause:n}){super(`Address "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class FL extends At{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class jL extends At{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const jn=BigInt(0),En=BigInt(1),Oo=BigInt(2),qL=BigInt(3),P5=BigInt(4),O5=BigInt(5),R5=BigInt(8);function Un(t,e){const n=t%e;return n>=jn?n:e+n}function fr(t,e,n){let r=t;for(;e-- >jn;)r*=r,r%=n;return r}function _m(t,e){if(t===jn)throw new Error("invert: expected non-zero number");if(e<=jn)throw new Error("invert: expected positive modulus, got "+e);let n=Un(t,e),r=e,s=jn,i=En;for(;n!==jn;){const a=r/n,c=r%n,u=s-i*a;r=n,n=c,s=i,i=u}if(r!==En)throw new Error("invert: does not exist");return Un(s,e)}function k5(t,e){const n=(t.ORDER+En)/P5,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function zL(t,e){const n=(t.ORDER-O5)/R5,r=t.mul(e,Oo),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Oo),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function HL(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-En,n=0;for(;e%Oo===jn;)e/=Oo,n++;let r=Oo;const s=Hb(t);for(;BE(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return k5;let i=s.pow(r,e);const o=(e+En)/Oo;return function(c,u){if(c.is0(u))return u;if(BE(c,u)!==1)throw new Error("Cannot find square root");let l=n,d=c.mul(c.ONE,i),f=c.pow(u,e),h=c.pow(u,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let g=1,p=c.sqr(f);for(;!c.eql(p,c.ONE);)if(g++,p=c.sqr(p),g===l)throw new Error("Cannot find square root");const y=En<<BigInt(l-g-1),E=c.pow(d,y);l=g,d=c.sqr(E),f=c.mul(f,d),h=c.mul(h,E)}return h}}function WL(t){return t%P5===qL?k5:t%R5===O5?zL:HL(t)}const VL=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function KL(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=VL.reduce((r,s)=>(r[s]="function",r),e);return tp(t,n)}function GL(t,e,n){if(n<jn)throw new Error("invalid exponent, negatives unsupported");if(n===jn)return t.ONE;if(n===En)return e;let r=t.ONE,s=e;for(;n>jn;)n&En&&(r=t.mul(r,s)),s=t.sqr(s),n>>=En;return r}function $5(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function BE(t,e){const n=(t.ORDER-En)/Oo,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function D5(t,e){e!==void 0&&wy(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Hb(t,e,n=!1,r={}){if(t<=jn)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=D5(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:ep(s),ZERO:jn,ONE:En,create:c=>Un(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return jn<=c&&c<t},is0:c=>c===jn,isOdd:c=>(c&En)===En,neg:c=>Un(-c,t),eql:(c,u)=>c===u,sqr:c=>Un(c*c,t),add:(c,u)=>Un(c+u,t),sub:(c,u)=>Un(c-u,t),mul:(c,u)=>Un(c*u,t),pow:(c,u)=>GL(a,c,u),div:(c,u)=>Un(c*_m(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>_m(c,t),sqrt:r.sqrt||(c=>(o||(o=WL(t)),o(a,c))),toBytes:c=>n?E5(c,i):jl(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?w5(c):zo(c)},invertBatch:c=>$5(a,c),cmov:(c,u,l)=>l?u:c});return Object.freeze(a)}function U5(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function B5(t){const e=U5(t);return e+Math.ceil(e/2)}function YL(t,e,n=!1){const r=t.length,s=U5(e),i=B5(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?w5(t):zo(t),a=Un(o,e-En)+En;return n?E5(a,s):jl(a,s)}const ME=BigInt(0),Am=BigInt(1);function _0(t,e){const n=e.negate();return t?n:e}function M5(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function A0(t,e){M5(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=ep(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function LE(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Am);const u=e*r,l=u+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:u}}function ZL(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function JL(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const S0=new WeakMap,L5=new WeakMap;function I0(t){return L5.get(t)||1}function XL(t,e){return{constTimeNegate:_0,hasPrecomputes(n){return I0(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>ME;)r&Am&&(s=s.add(i)),i=i.double(),r>>=Am;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=A0(r,e),o=[];let a=n,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=A0(n,e);for(let c=0;c<a.windows;c++){const{nextN:u,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:g}=LE(s,c,a);s=u,d?o=o.add(_0(h,r[g])):i=i.add(_0(f,r[l]))}return{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=A0(n,e);for(let a=0;a<o.windows&&s!==ME;a++){const{nextN:c,offset:u,isZero:l,isNeg:d}=LE(s,a,o);if(s=c,!l){const f=r[u];i=i.add(d?f.negate():f)}}return i},getPrecomputes(n,r,s){let i=S0.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&S0.set(r,s(i))),i},wNAFCached(n,r,s){const i=I0(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=I0(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){M5(r,e),L5.set(n,r),S0.delete(n)}}}function QL(t,e,n,r){ZL(n,t),JL(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=nL(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=ep(c),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){l.fill(o);for(let p=0;p<i;p++){const y=r[p],E=Number(y>>BigInt(h)&u);l[E]=l[E].add(n[p])}let g=o;for(let p=l.length-1,y=o;p>0;p--)y=y.add(l[p]),g=g.add(y);if(f=f.add(g),h!==0)for(let p=0;p<c;p++)f=f.double()}return f}function F5(t){return KL(t.Fp),tp(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...D5(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function FE(t){t.lowS!==void 0&&al("lowS",t.lowS),t.prehash!==void 0&&al("prehash",t.prehash)}function e7(t){const e=F5(t);tp(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}let t7=class extends Error{constructor(e=""){super(e)}};const Ys={Err:t7,_tlv:{encode:(t,e)=>{const{Err:n}=Ys;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=fd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?fd(s.length/2|128):"";return fd(t)+i+s+e},decode(t,e){const{Err:n}=Ys;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const u=e.subarray(r,r+c);if(u.length!==c)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Ys;if(t<Qs)throw new e("integer: negative integers are not allowed");let n=fd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Ys;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return zo(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Ys,s=wr("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:u,l}=r.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(u)}},hexFromSig(t){const{_tlv:e,_int:n}=Ys,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}};function T0(t,e){return cl(jl(t,e))}const Qs=BigInt(0),Ft=BigInt(1);BigInt(2);const N0=BigInt(3),n7=BigInt(4);function r7(t){const e=e7(t),{Fp:n}=e,r=Hb(e.n,e.nBitLength),s=e.toBytes||((w,C,_)=>{const P=C.toAffine();return Hf(Uint8Array.from([4]),n.toBytes(P.x),n.toBytes(P.y))}),i=e.fromBytes||(w=>{const C=w.subarray(1),_=n.fromBytes(C.subarray(0,n.BYTES)),P=n.fromBytes(C.subarray(n.BYTES,2*n.BYTES));return{x:_,y:P}});function o(w){const{a:C,b:_}=e,P=n.sqr(w),k=n.mul(P,w);return n.add(n.add(k,n.mul(w,C)),_)}function a(w,C){const _=n.sqr(C),P=o(w);return n.eql(_,P)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(e.a,N0),n7),u=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(c,u)))throw new Error("bad curve params: a or b");function l(w){return jb(w,Ft,e.n)}function d(w){const{allowedPrivateKeyLengths:C,nByteLength:_,wrapPrivateKey:P,n:k}=e;if(C&&typeof w!="bigint"){if(Fl(w)&&(w=cl(w)),typeof w!="string"||!C.includes(w.length))throw new Error("invalid private key");w=w.padStart(_*2,"0")}let U;try{U=typeof w=="bigint"?w:zo(wr("private key",w,_))}catch{throw new Error("invalid private key, expected hex or "+_+" bytes, got "+typeof w)}return P&&(U=Un(U,k)),ec("private key",U,Ft,k),U}function f(w){if(!(w instanceof p))throw new Error("ProjectivePoint expected")}const h=PE((w,C)=>{const{px:_,py:P,pz:k}=w;if(n.eql(k,n.ONE))return{x:_,y:P};const U=w.is0();C==null&&(C=U?n.ONE:n.inv(k));const $=n.mul(_,C),L=n.mul(P,C),M=n.mul(k,C);if(U)return{x:n.ZERO,y:n.ZERO};if(!n.eql(M,n.ONE))throw new Error("invZ was invalid");return{x:$,y:L}}),g=PE(w=>{if(w.is0()){if(e.allowInfinityPoint&&!n.is0(w.py))return;throw new Error("bad point: ZERO")}const{x:C,y:_}=w.toAffine();if(!n.isValid(C)||!n.isValid(_))throw new Error("bad point: x or y not FE");if(!a(C,_))throw new Error("bad point: equation left != right");if(!w.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(C,_,P){if(C==null||!n.isValid(C))throw new Error("x required");if(_==null||!n.isValid(_)||n.is0(_))throw new Error("y required");if(P==null||!n.isValid(P))throw new Error("z required");this.px=C,this.py=_,this.pz=P,Object.freeze(this)}static fromAffine(C){const{x:_,y:P}=C||{};if(!C||!n.isValid(_)||!n.isValid(P))throw new Error("invalid affine point");if(C instanceof p)throw new Error("projective point not allowed");const k=U=>n.eql(U,n.ZERO);return k(_)&&k(P)?p.ZERO:new p(_,P,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(C){const _=$5(n,C.map(P=>P.pz));return C.map((P,k)=>P.toAffine(_[k])).map(p.fromAffine)}static fromHex(C){const _=p.fromAffine(i(wr("pointHex",C)));return _.assertValidity(),_}static fromPrivateKey(C){return p.BASE.multiply(d(C))}static msm(C,_){return QL(p,r,C,_)}_setWindowSize(C){A.setWindowSize(this,C)}assertValidity(){g(this)}hasEvenY(){const{y:C}=this.toAffine();if(n.isOdd)return!n.isOdd(C);throw new Error("Field doesn't support isOdd")}equals(C){f(C);const{px:_,py:P,pz:k}=this,{px:U,py:$,pz:L}=C,M=n.eql(n.mul(_,L),n.mul(U,k)),D=n.eql(n.mul(P,L),n.mul($,k));return M&&D}negate(){return new p(this.px,n.neg(this.py),this.pz)}double(){const{a:C,b:_}=e,P=n.mul(_,N0),{px:k,py:U,pz:$}=this;let L=n.ZERO,M=n.ZERO,D=n.ZERO,T=n.mul(k,k),O=n.mul(U,U),m=n.mul($,$),b=n.mul(k,U);return b=n.add(b,b),D=n.mul(k,$),D=n.add(D,D),L=n.mul(C,D),M=n.mul(P,m),M=n.add(L,M),L=n.sub(O,M),M=n.add(O,M),M=n.mul(L,M),L=n.mul(b,L),D=n.mul(P,D),m=n.mul(C,m),b=n.sub(T,m),b=n.mul(C,b),b=n.add(b,D),D=n.add(T,T),T=n.add(D,T),T=n.add(T,m),T=n.mul(T,b),M=n.add(M,T),m=n.mul(U,$),m=n.add(m,m),T=n.mul(m,b),L=n.sub(L,T),D=n.mul(m,O),D=n.add(D,D),D=n.add(D,D),new p(L,M,D)}add(C){f(C);const{px:_,py:P,pz:k}=this,{px:U,py:$,pz:L}=C;let M=n.ZERO,D=n.ZERO,T=n.ZERO;const O=e.a,m=n.mul(e.b,N0);let b=n.mul(_,U),v=n.mul(P,$),S=n.mul(k,L),I=n.add(_,P),x=n.add(U,$);I=n.mul(I,x),x=n.add(b,v),I=n.sub(I,x),x=n.add(_,k);let B=n.add(U,L);return x=n.mul(x,B),B=n.add(b,S),x=n.sub(x,B),B=n.add(P,k),M=n.add($,L),B=n.mul(B,M),M=n.add(v,S),B=n.sub(B,M),T=n.mul(O,x),M=n.mul(m,S),T=n.add(M,T),M=n.sub(v,T),T=n.add(v,T),D=n.mul(M,T),v=n.add(b,b),v=n.add(v,b),S=n.mul(O,S),x=n.mul(m,x),v=n.add(v,S),S=n.sub(b,S),S=n.mul(O,S),x=n.add(x,S),b=n.mul(v,x),D=n.add(D,b),b=n.mul(B,x),M=n.mul(I,M),M=n.sub(M,b),b=n.mul(I,v),T=n.mul(B,T),T=n.add(T,b),new p(M,D,T)}subtract(C){return this.add(C.negate())}is0(){return this.equals(p.ZERO)}wNAF(C){return A.wNAFCached(this,C,p.normalizeZ)}multiplyUnsafe(C){const{endo:_,n:P}=e;ec("scalar",C,Qs,P);const k=p.ZERO;if(C===Qs)return k;if(this.is0()||C===Ft)return this;if(!_||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,C,p.normalizeZ);let{k1neg:U,k1:$,k2neg:L,k2:M}=_.splitScalar(C),D=k,T=k,O=this;for(;$>Qs||M>Qs;)$&Ft&&(D=D.add(O)),M&Ft&&(T=T.add(O)),O=O.double(),$>>=Ft,M>>=Ft;return U&&(D=D.negate()),L&&(T=T.negate()),T=new p(n.mul(T.px,_.beta),T.py,T.pz),D.add(T)}multiply(C){const{endo:_,n:P}=e;ec("scalar",C,Ft,P);let k,U;if(_){const{k1neg:$,k1:L,k2neg:M,k2:D}=_.splitScalar(C);let{p:T,f:O}=this.wNAF(L),{p:m,f:b}=this.wNAF(D);T=A.constTimeNegate($,T),m=A.constTimeNegate(M,m),m=new p(n.mul(m.px,_.beta),m.py,m.pz),k=T.add(m),U=O.add(b)}else{const{p:$,f:L}=this.wNAF(C);k=$,U=L}return p.normalizeZ([k,U])[0]}multiplyAndAddUnsafe(C,_,P){const k=p.BASE,U=(L,M)=>M===Qs||M===Ft||!L.equals(k)?L.multiplyUnsafe(M):L.multiply(M),$=U(this,_).add(U(C,P));return $.is0()?void 0:$}toAffine(C){return h(this,C)}isTorsionFree(){const{h:C,isTorsionFree:_}=e;if(C===Ft)return!0;if(_)return _(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:C,clearCofactor:_}=e;return C===Ft?this:_?_(p,this):this.multiplyUnsafe(e.h)}toRawBytes(C=!0){return al("isCompressed",C),this.assertValidity(),s(p,this,C)}toHex(C=!0){return al("isCompressed",C),cl(this.toRawBytes(C))}}p.BASE=new p(e.Gx,e.Gy,n.ONE),p.ZERO=new p(n.ZERO,n.ONE,n.ZERO);const{endo:y,nBitLength:E}=e,A=XL(p,y?Math.ceil(E/2):E);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:l}}function s7(t){const e=F5(t);return tp(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function i7(t){const e=s7(t),{Fp:n,n:r,nByteLength:s,nBitLength:i}=e,o=n.BYTES+1,a=2*n.BYTES+1;function c(m){return Un(m,r)}function u(m){return _m(m,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:h}=r7({...e,toBytes(m,b,v){const S=b.toAffine(),I=n.toBytes(S.x),x=Hf;return al("isCompressed",v),v?x(Uint8Array.from([b.hasEvenY()?2:3]),I):x(Uint8Array.from([4]),I,n.toBytes(S.y))},fromBytes(m){const b=m.length,v=m[0],S=m.subarray(1);if(b===o&&(v===2||v===3)){const I=zo(S);if(!jb(I,Ft,n.ORDER))throw new Error("Point is not on curve");const x=f(I);let B;try{B=n.sqrt(x)}catch(j){const q=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+q)}const F=(B&Ft)===Ft;return(v&1)===1!==F&&(B=n.neg(B)),{x:I,y:B}}else if(b===a&&v===4){const I=n.fromBytes(S.subarray(0,n.BYTES)),x=n.fromBytes(S.subarray(n.BYTES,2*n.BYTES));return{x:I,y:x}}else{const I=o,x=a;throw new Error("invalid Point, expected length of "+I+", or uncompressed "+x+", got "+b)}}});function g(m){const b=r>>Ft;return m>b}function p(m){return g(m)?c(-m):m}const y=(m,b,v)=>zo(m.slice(b,v));class E{constructor(b,v,S){ec("r",b,Ft,r),ec("s",v,Ft,r),this.r=b,this.s=v,S!=null&&(this.recovery=S),Object.freeze(this)}static fromCompact(b){const v=s;return b=wr("compactSignature",b,v*2),new E(y(b,0,v),y(b,v,2*v))}static fromDER(b){const{r:v,s:S}=Ys.toSig(wr("DER",b));return new E(v,S)}assertValidity(){}addRecoveryBit(b){return new E(this.r,this.s,b)}recoverPublicKey(b){const{r:v,s:S,recovery:I}=this,x=k(wr("msgHash",b));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const B=I===2||I===3?v+e.n:v;if(B>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const F=(I&1)===0?"02":"03",W=l.fromHex(F+T0(B,n.BYTES)),j=u(B),q=c(-x*j),Y=c(S*j),Q=l.BASE.multiplyAndAddUnsafe(W,q,Y);if(!Q)throw new Error("point at infinify");return Q.assertValidity(),Q}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return zf(this.toDERHex())}toDERHex(){return Ys.hexFromSig(this)}toCompactRawBytes(){return zf(this.toCompactHex())}toCompactHex(){const b=s;return T0(this.r,b)+T0(this.s,b)}}const A={isValidPrivateKey(m){try{return d(m),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const m=B5(e.n);return YL(e.randomBytes(m),e.n)},precompute(m=8,b=l.BASE){return b._setWindowSize(m),b.multiply(BigInt(3)),b}};function w(m,b=!0){return l.fromPrivateKey(m).toRawBytes(b)}function C(m){if(typeof m=="bigint")return!1;if(m instanceof l)return!0;const v=wr("key",m).length,S=n.BYTES,I=S+1,x=2*S+1;if(!(e.allowedPrivateKeyLengths||s===I))return v===I||v===x}function _(m,b,v=!0){if(C(m)===!0)throw new Error("first arg must be private key");if(C(b)===!1)throw new Error("second arg must be public key");return l.fromHex(b).multiply(d(m)).toRawBytes(v)}const P=e.bits2int||function(m){if(m.length>8192)throw new Error("input is too large");const b=zo(m),v=m.length*8-i;return v>0?b>>BigInt(v):b},k=e.bits2int_modN||function(m){return c(P(m))},U=ep(i);function $(m){return ec("num < 2^"+i,m,Qs,U),jl(m,s)}function L(m,b,v=M){if(["recovered","canonical"].some(J=>J in v))throw new Error("sign() legacy options not supported");const{hash:S,randomBytes:I}=e;let{lowS:x,prehash:B,extraEntropy:F}=v;x==null&&(x=!0),m=wr("msgHash",m),FE(v),B&&(m=wr("prehashed msgHash",S(m)));const W=k(m),j=d(b),q=[$(j),$(W)];if(F!=null&&F!==!1){const J=F===!0?I(n.BYTES):F;q.push(wr("extraEntropy",J))}const Y=Hf(...q),Q=W;function ue(J){const te=P(J);if(!h(te))return;const Ae=u(te),Oe=l.BASE.multiply(te).toAffine(),Be=c(Oe.x);if(Be===Qs)return;const rt=c(Ae*c(Q+Be*j));if(rt===Qs)return;let St=(Oe.x===Be?0:2)|Number(Oe.y&Ft),ns=rt;return x&&g(rt)&&(ns=p(rt),St^=1),new E(Be,ns,St)}return{seed:Y,k2sig:ue}}const M={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function T(m,b,v=M){const{seed:S,k2sig:I}=L(m,b,v),x=e;return rL(x.hash.outputLen,x.nByteLength,x.hmac)(S,I)}l.BASE._setWindowSize(8);function O(m,b,v,S=D){const I=m;b=wr("msgHash",b),v=wr("publicKey",v);const{lowS:x,prehash:B,format:F}=S;if(FE(S),"strict"in S)throw new Error("options.strict was renamed to lowS");if(F!==void 0&&F!=="compact"&&F!=="der")throw new Error("format must be compact or der");const W=typeof I=="string"||Fl(I),j=!W&&!F&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!W&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,Y;try{if(j&&(q=new E(I.r,I.s)),W){try{F!=="compact"&&(q=E.fromDER(I))}catch(St){if(!(St instanceof Ys.Err))throw St}!q&&F!=="der"&&(q=E.fromCompact(I))}Y=l.fromHex(v)}catch{return!1}if(!q||x&&q.hasHighS())return!1;B&&(b=e.hash(b));const{r:Q,s:ue}=q,J=k(b),te=u(ue),Ae=c(J*te),Oe=c(Q*te),Be=l.BASE.multiplyAndAddUnsafe(Y,Ae,Oe)?.toAffine();return Be?c(Be.x)===Q:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:_,sign:T,verify:O,ProjectivePoint:l,Signature:E,utils:A}}function o7(t){return{hash:t,hmac:(e,...n)=>Hh(t,e,fs(...n)),randomBytes:ch}}function a7(t,e){const n=r=>i7({...t,...o7(r)});return{...n(e),create:n}}const j5=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),jE=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),c7=BigInt(0),u7=BigInt(1),Sm=BigInt(2),qE=(t,e)=>(t+e/Sm)/e;function l7(t){const e=j5,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,d=fr(l,n,e)*l%e,f=fr(d,n,e)*l%e,h=fr(f,Sm,e)*u%e,g=fr(h,s,e)*h%e,p=fr(g,i,e)*g%e,y=fr(p,a,e)*p%e,E=fr(y,c,e)*y%e,A=fr(E,a,e)*p%e,w=fr(A,n,e)*l%e,C=fr(w,o,e)*g%e,_=fr(C,r,e)*u%e,P=fr(_,Sm,e);if(!Im.eql(Im.sqr(P),t))throw new Error("Cannot find square root");return P}const Im=Hb(j5,void 0,void 0,{sqrt:l7}),d7=a7({a:c7,b:BigInt(7),Fp:Im,n:jE,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=jE,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-u7*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=qE(i*t,e),c=qE(-r*t,e);let u=Un(t-a*n-c*s,e),l=Un(-a*r-c*i,e);const d=u>o,f=l>o;if(d&&(u=e-u),f&&(l=e-l),u>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:l}}}},nb);function f7(t){if(t.length!==130&&t.length!==132)throw new p7({signature:t});const e=BigInt(Vs(t,0,32)),n=BigInt(Vs(t,32,64)),r=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return h7(s)}catch{throw new g7({value:s})}})();return typeof r>"u"?{r:e,s:n}:{r:e,s:n,yParity:r}}function h7(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new m7({value:t})}class p7 extends At{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${oo(zb(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class g7 extends At{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class m7 extends At{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}const Wb=BigInt(0),Tm=BigInt(1);function Vf(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function Ro(t,e,n=""){const r=Ey(t),s=t?.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,a=i?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function pd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function q5(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Wb:BigInt("0x"+t)}function np(t){return q5(Ga(t))}function z5(t){return yy(t),q5(Ga(Uint8Array.from(t).reverse()))}function Vb(t,e){return sf(t.toString(16).padStart(e*2,"0"))}function H5(t,e){return Vb(t,e).reverse()}function kn(t,e,n){let r;if(typeof e=="string")try{r=sf(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Ey(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");return r.length,r}const x0=t=>typeof t=="bigint"&&Wb<=t;function y7(t,e,n){return x0(t)&&x0(e)&&x0(n)&&e<=t&&t<n}function b7(t,e,n,r){if(!y7(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function W5(t){let e;for(e=0;t>Wb;t>>=Tm,e+=1);return e}const ql=t=>(Tm<<BigInt(t))-Tm;function w7(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},u=(...h)=>n(o,i,...h),l=(h=r(0))=>{o=u(s(0),h),i=u(),h.length!==0&&(o=u(s(1),h),i=u())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const g=[];for(;h<e;){i=u();const p=i.slice();g.push(p),h+=i.length}return fs(...g)};return(h,g)=>{c(),l(h);let p;for(;!(p=g(d()));)l();return c(),p}}function Kb(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function zE(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const ir=BigInt(0),vn=BigInt(1),ko=BigInt(2),V5=BigInt(3),K5=BigInt(4),G5=BigInt(5),E7=BigInt(7),Y5=BigInt(8),v7=BigInt(9),Z5=BigInt(16);function Br(t,e){const n=t%e;return n>=ir?n:e+n}function HE(t,e){if(t===ir)throw new Error("invert: expected non-zero number");if(e<=ir)throw new Error("invert: expected positive modulus, got "+e);let n=Br(t,e),r=e,s=ir,i=vn;for(;n!==ir;){const a=r/n,c=r%n,u=s-i*a;r=n,n=c,s=i,i=u}if(r!==vn)throw new Error("invert: does not exist");return Br(s,e)}function Gb(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function J5(t,e){const n=(t.ORDER+vn)/K5,r=t.pow(e,n);return Gb(t,r,e),r}function C7(t,e){const n=(t.ORDER-G5)/Y5,r=t.mul(e,ko),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,ko),s),a=t.mul(i,t.sub(o,t.ONE));return Gb(t,a,e),a}function _7(t){const e=rp(t),n=X5(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+E7)/Z5;return(a,c)=>{let u=a.pow(c,o),l=a.mul(u,r);const d=a.mul(u,s),f=a.mul(u,i),h=a.eql(a.sqr(l),c),g=a.eql(a.sqr(d),c);u=a.cmov(u,l,h),l=a.cmov(f,d,g);const p=a.eql(a.sqr(l),c),y=a.cmov(u,l,p);return Gb(a,y,c),y}}function X5(t){if(t<V5)throw new Error("sqrt is not defined for small field");let e=t-vn,n=0;for(;e%ko===ir;)e/=ko,n++;let r=ko;const s=rp(t);for(;WE(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return J5;let i=s.pow(r,e);const o=(e+vn)/ko;return function(c,u){if(c.is0(u))return u;if(WE(c,u)!==1)throw new Error("Cannot find square root");let l=n,d=c.mul(c.ONE,i),f=c.pow(u,e),h=c.pow(u,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let g=1,p=c.sqr(f);for(;!c.eql(p,c.ONE);)if(g++,p=c.sqr(p),g===l)throw new Error("Cannot find square root");const y=vn<<BigInt(l-g-1),E=c.pow(d,y);l=g,d=c.sqr(E),f=c.mul(f,d),h=c.mul(h,E)}return h}}function A7(t){return t%K5===V5?J5:t%Y5===G5?C7:t%Z5===v7?_7(t):X5(t)}const S7=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function I7(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=S7.reduce((r,s)=>(r[s]="function",r),e);return Kb(t,n),t}function T7(t,e,n){if(n<ir)throw new Error("invalid exponent, negatives unsupported");if(n===ir)return t.ONE;if(n===vn)return e;let r=t.ONE,s=e;for(;n>ir;)n&vn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=vn;return r}function Q5(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function WE(t,e){const n=(t.ORDER-vn)/ko,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function e6(t,e){e!==void 0&&wy(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function rp(t,e,n=!1,r={}){if(t<=ir)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(s=f.BITS),f.sqrt&&(i=f.sqrt),typeof f.isLE=="boolean"&&(n=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),a=f.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:c,nByteLength:u}=e6(t,s);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const d=Object.freeze({ORDER:t,isLE:n,BITS:c,BYTES:u,MASK:ql(c),ZERO:ir,ONE:vn,allowedLengths:a,create:f=>Br(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return ir<=f&&f<t},is0:f=>f===ir,isValidNot0:f=>!d.is0(f)&&d.isValid(f),isOdd:f=>(f&vn)===vn,neg:f=>Br(-f,t),eql:(f,h)=>f===h,sqr:f=>Br(f*f,t),add:(f,h)=>Br(f+h,t),sub:(f,h)=>Br(f-h,t),mul:(f,h)=>Br(f*h,t),pow:(f,h)=>T7(d,f,h),div:(f,h)=>Br(f*HE(h,t),t),sqrN:f=>f*f,addN:(f,h)=>f+h,subN:(f,h)=>f-h,mulN:(f,h)=>f*h,inv:f=>HE(f,t),sqrt:i||(f=>(l||(l=A7(t)),l(d,f))),toBytes:f=>n?H5(f,u):Vb(f,u),fromBytes:(f,h=!0)=>{if(a){if(!a.includes(f.length)||f.length>u)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);const p=new Uint8Array(u);p.set(f,n?0:p.length-f.length),f=p}if(f.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+f.length);let g=n?z5(f):np(f);if(o&&(g=Br(g,t)),!h&&!d.isValid(g))throw new Error("invalid field element: outside of range 0..ORDER");return g},invertBatch:f=>Q5(d,f),cmov:(f,h,g)=>g?h:f});return Object.freeze(d)}function t6(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function n6(t){const e=t6(t);return e+Math.ceil(e/2)}function N7(t,e,n=!1){const r=t.length,s=t6(e),i=n6(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?z5(t):np(t),a=Br(o,e-vn)+vn;return n?H5(a,s):Vb(a,s)}const Rc=BigInt(0),$o=BigInt(1);function Kf(t,e){const n=e.negate();return t?n:e}function P0(t,e){const n=Q5(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function r6(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function O0(t,e){r6(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=ql(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function VE(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=$o);const u=e*r,l=u+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:u}}function x7(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function P7(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const R0=new WeakMap,s6=new WeakMap;function k0(t){return s6.get(t)||1}function KE(t){if(t!==Rc)throw new Error("invalid wNAF")}class O7{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>Rc;)n&$o&&(r=r.add(s)),s=s.double(),n>>=$o;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=O0(n,this.bits),i=[];let o=e,a=o;for(let c=0;c<r;c++){a=o,i.push(a);for(let u=1;u<s;u++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=O0(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:u,isZero:l,isNeg:d,isNegF:f,offsetF:h}=VE(r,a,o);r=c,l?i=i.add(Kf(f,n[h])):s=s.add(Kf(d,n[u]))}return KE(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=O0(e,this.bits);for(let o=0;o<i.windows&&r!==Rc;o++){const{nextN:a,offset:c,isZero:u,isNeg:l}=VE(r,o,i);if(r=a,!u){const d=n[c];s=s.add(l?d.negate():d)}}return KE(r),s}getPrecomputes(e,n,r){let s=R0.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),R0.set(n,s))),s}cached(e,n,r){const s=k0(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=k0(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){r6(n,this.bits),s6.set(e,n),R0.delete(e)}hasCache(e){return k0(e)!==1}}function R7(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Rc||r>Rc;)n&$o&&(i=i.add(s)),r&$o&&(o=o.add(s)),s=s.double(),n>>=$o,r>>=$o;return{p1:i,p2:o}}function k7(t,e,n,r){x7(n,t),P7(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=W5(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=ql(c),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){l.fill(o);for(let p=0;p<i;p++){const y=r[p],E=Number(y>>BigInt(h)&u);l[E]=l[E].add(n[p])}let g=o;for(let p=l.length-1,y=o;p>0;p--)y=y.add(l[p]),g=g.add(y);if(f=f.add(g),h!==0)for(let p=0;p<c;p++)f=f.double()}return f}function GE(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return I7(e),e}else return rp(t,{isLE:n})}function $7(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const c of["p","n","h"]){const u=e[c];if(!(typeof u=="bigint"&&u>Rc))throw new Error(`CURVE.${c} must be positive bigint`)}const s=GE(e.p,n.Fp,r),i=GE(e.n,n.Fn,r),a=["Gx","Gy","a","b"];for(const c of a)if(!s.isValid(e[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}const YE=(t,e)=>(t+(t>=0?e:-e)/i6)/e;function D7(t,e,n){const[[r,s],[i,o]]=e,a=YE(o*t,n),c=YE(-s*t,n);let u=t-a*r-c*i,l=-a*s-c*o;const d=u<ti,f=l<ti;d&&(u=-u),f&&(l=-l);const h=ql(Math.ceil(W5(n)/2))+tc;if(u<ti||u>=h||l<ti||l>=h)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:l}}function Nm(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function $0(t,e){const n={};for(let r of Object.keys(e))n[r]=t[r]===void 0?e[r]:t[r];return Vf(n.lowS,"lowS"),Vf(n.prehash,"prehash"),n.format!==void 0&&Nm(n.format),n}class U7 extends Error{constructor(e=""){super(e)}}const Zs={Err:U7,_tlv:{encode:(t,e)=>{const{Err:n}=Zs;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=pd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?pd(s.length/2|128):"";return pd(t)+i+s+e},decode(t,e){const{Err:n}=Zs;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const u=e.subarray(r,r+c);if(u.length!==c)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Zs;if(t<ti)throw new e("integer: negative integers are not allowed");let n=pd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Zs;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return np(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Zs,s=kn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:u,l}=r.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(u)}},hexFromSig(t){const{_tlv:e,_int:n}=Zs,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},ti=BigInt(0),tc=BigInt(1),i6=BigInt(2),gd=BigInt(3),B7=BigInt(4);function za(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=kn("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function M7(t,e={}){const n=$7("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:a}=i;Kb(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=a6(r,s);function l(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(D,T,O){const{x:m,y:b}=T.toAffine(),v=r.toBytes(m);if(Vf(O,"isCompressed"),O){l();const S=!r.isOdd(b);return fs(o6(S),v)}else return fs(Uint8Array.of(4),v,r.toBytes(b))}function f(D){Ro(D,void 0,"Point");const{publicKey:T,publicKeyUncompressed:O}=u,m=D.length,b=D[0],v=D.subarray(1);if(m===T&&(b===2||b===3)){const S=r.fromBytes(v);if(!r.isValid(S))throw new Error("bad point: is not on curve, wrong x");const I=p(S);let x;try{x=r.sqrt(I)}catch(W){const j=W instanceof Error?": "+W.message:"";throw new Error("bad point: is not on curve, sqrt error"+j)}l();const B=r.isOdd(x);return(b&1)===1!==B&&(x=r.neg(x)),{x:S,y:x}}else if(m===O&&b===4){const S=r.BYTES,I=r.fromBytes(v.subarray(0,S)),x=r.fromBytes(v.subarray(S,S*2));if(!y(I,x))throw new Error("bad point: is not on curve");return{x:I,y:x}}else throw new Error(`bad point: got length ${m}, expected compressed=${T} or uncompressed=${O}`)}const h=e.toBytes||d,g=e.fromBytes||f;function p(D){const T=r.sqr(D),O=r.mul(T,D);return r.add(r.add(O,r.mul(D,i.a)),i.b)}function y(D,T){const O=r.sqr(T),m=p(D);return r.eql(O,m)}if(!y(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const E=r.mul(r.pow(i.a,gd),B7),A=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(E,A)))throw new Error("bad curve params: a or b");function w(D,T,O=!1){if(!r.isValid(T)||O&&r.is0(T))throw new Error(`bad point coordinate ${D}`);return T}function C(D){if(!(D instanceof $))throw new Error("ProjectivePoint expected")}function _(D){if(!c||!c.basises)throw new Error("no endo");return D7(D,c.basises,s.ORDER)}const P=zE((D,T)=>{const{X:O,Y:m,Z:b}=D;if(r.eql(b,r.ONE))return{x:O,y:m};const v=D.is0();T==null&&(T=v?r.ONE:r.inv(b));const S=r.mul(O,T),I=r.mul(m,T),x=r.mul(b,T);if(v)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:S,y:I}}),k=zE(D=>{if(D.is0()){if(e.allowInfinityPoint&&!r.is0(D.Y))return;throw new Error("bad point: ZERO")}const{x:T,y:O}=D.toAffine();if(!r.isValid(T)||!r.isValid(O))throw new Error("bad point: x or y not field elements");if(!y(T,O))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(D,T,O,m,b){return O=new $(r.mul(O.X,D),O.Y,O.Z),T=Kf(m,T),O=Kf(b,O),T.add(O)}class ${constructor(T,O,m){this.X=w("x",T),this.Y=w("y",O,!0),this.Z=w("z",m),Object.freeze(this)}static CURVE(){return i}static fromAffine(T){const{x:O,y:m}=T||{};if(!T||!r.isValid(O)||!r.isValid(m))throw new Error("invalid affine point");if(T instanceof $)throw new Error("projective point not allowed");return r.is0(O)&&r.is0(m)?$.ZERO:new $(O,m,r.ONE)}static fromBytes(T){const O=$.fromAffine(g(Ro(T,void 0,"point")));return O.assertValidity(),O}static fromHex(T){return $.fromBytes(kn("pointHex",T))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(T=8,O=!0){return M.createCache(this,T),O||this.multiply(gd),this}assertValidity(){k(this)}hasEvenY(){const{y:T}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(T)}equals(T){C(T);const{X:O,Y:m,Z:b}=this,{X:v,Y:S,Z:I}=T,x=r.eql(r.mul(O,I),r.mul(v,b)),B=r.eql(r.mul(m,I),r.mul(S,b));return x&&B}negate(){return new $(this.X,r.neg(this.Y),this.Z)}double(){const{a:T,b:O}=i,m=r.mul(O,gd),{X:b,Y:v,Z:S}=this;let I=r.ZERO,x=r.ZERO,B=r.ZERO,F=r.mul(b,b),W=r.mul(v,v),j=r.mul(S,S),q=r.mul(b,v);return q=r.add(q,q),B=r.mul(b,S),B=r.add(B,B),I=r.mul(T,B),x=r.mul(m,j),x=r.add(I,x),I=r.sub(W,x),x=r.add(W,x),x=r.mul(I,x),I=r.mul(q,I),B=r.mul(m,B),j=r.mul(T,j),q=r.sub(F,j),q=r.mul(T,q),q=r.add(q,B),B=r.add(F,F),F=r.add(B,F),F=r.add(F,j),F=r.mul(F,q),x=r.add(x,F),j=r.mul(v,S),j=r.add(j,j),F=r.mul(j,q),I=r.sub(I,F),B=r.mul(j,W),B=r.add(B,B),B=r.add(B,B),new $(I,x,B)}add(T){C(T);const{X:O,Y:m,Z:b}=this,{X:v,Y:S,Z:I}=T;let x=r.ZERO,B=r.ZERO,F=r.ZERO;const W=i.a,j=r.mul(i.b,gd);let q=r.mul(O,v),Y=r.mul(m,S),Q=r.mul(b,I),ue=r.add(O,m),J=r.add(v,S);ue=r.mul(ue,J),J=r.add(q,Y),ue=r.sub(ue,J),J=r.add(O,b);let te=r.add(v,I);return J=r.mul(J,te),te=r.add(q,Q),J=r.sub(J,te),te=r.add(m,b),x=r.add(S,I),te=r.mul(te,x),x=r.add(Y,Q),te=r.sub(te,x),F=r.mul(W,J),x=r.mul(j,Q),F=r.add(x,F),x=r.sub(Y,F),F=r.add(Y,F),B=r.mul(x,F),Y=r.add(q,q),Y=r.add(Y,q),Q=r.mul(W,Q),J=r.mul(j,J),Y=r.add(Y,Q),Q=r.sub(q,Q),Q=r.mul(W,Q),J=r.add(J,Q),q=r.mul(Y,J),B=r.add(B,q),q=r.mul(te,J),x=r.mul(ue,x),x=r.sub(x,q),q=r.mul(ue,Y),F=r.mul(te,F),F=r.add(F,q),new $(x,B,F)}subtract(T){return this.add(T.negate())}is0(){return this.equals($.ZERO)}multiply(T){const{endo:O}=e;if(!s.isValidNot0(T))throw new Error("invalid scalar: out of range");let m,b;const v=S=>M.cached(this,S,I=>P0($,I));if(O){const{k1neg:S,k1:I,k2neg:x,k2:B}=_(T),{p:F,f:W}=v(I),{p:j,f:q}=v(B);b=W.add(q),m=U(O.beta,F,j,S,x)}else{const{p:S,f:I}=v(T);m=S,b=I}return P0($,[m,b])[0]}multiplyUnsafe(T){const{endo:O}=e,m=this;if(!s.isValid(T))throw new Error("invalid scalar: out of range");if(T===ti||m.is0())return $.ZERO;if(T===tc)return m;if(M.hasCache(this))return this.multiply(T);if(O){const{k1neg:b,k1:v,k2neg:S,k2:I}=_(T),{p1:x,p2:B}=R7($,m,v,I);return U(O.beta,x,B,b,S)}else return M.unsafe(m,T)}multiplyAndAddUnsafe(T,O,m){const b=this.multiplyUnsafe(O).add(T.multiplyUnsafe(m));return b.is0()?void 0:b}toAffine(T){return P(this,T)}isTorsionFree(){const{isTorsionFree:T}=e;return o===tc?!0:T?T($,this):M.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:T}=e;return o===tc?this:T?T($,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(T=!0){return Vf(T,"isCompressed"),this.assertValidity(),h($,this,T)}toHex(T=!0){return Ga(this.toBytes(T))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(T=!0){return this.toBytes(T)}_setWindowSize(T){this.precompute(T)}static normalizeZ(T){return P0($,T)}static msm(T,O){return k7($,s,T,O)}static fromPrivateKey(T){return $.BASE.multiply(za(s,T))}}$.BASE=new $(i.Gx,i.Gy,r.ONE),$.ZERO=new $(r.ZERO,r.ONE,r.ZERO),$.Fp=r,$.Fn=s;const L=s.BITS,M=new O7($,e.endo?Math.ceil(L/2):L);return $.BASE.precompute(8),$}function o6(t){return Uint8Array.of(t?2:3)}function a6(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function L7(t,e={}){const{Fn:n}=t,r=e.randomBytes||ch,s=Object.assign(a6(t.Fp,n),{seed:n6(n.ORDER)});function i(h){try{return!!za(n,h)}catch{return!1}}function o(h,g){const{publicKey:p,publicKeyUncompressed:y}=s;try{const E=h.length;return g===!0&&E!==p||g===!1&&E!==y?!1:!!t.fromBytes(h)}catch{return!1}}function a(h=r(s.seed)){return N7(Ro(h,s.seed,"seed"),n.ORDER)}function c(h,g=!0){return t.BASE.multiply(za(n,h)).toBytes(g)}function u(h){const g=a(h);return{secretKey:g,publicKey:c(g)}}function l(h){if(typeof h=="bigint")return!1;if(h instanceof t)return!0;const{secretKey:g,publicKey:p,publicKeyUncompressed:y}=s;if(n.allowedLengths||g===p)return;const E=kn("key",h).length;return E===p||E===y}function d(h,g,p=!0){if(l(h)===!0)throw new Error("first arg must be private key");if(l(g)===!1)throw new Error("second arg must be public key");const y=za(n,h);return t.fromHex(g).multiply(y).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:u,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>za(n,h),precompute(h=8,g=t.BASE){return g.precompute(h,!1)}},lengths:s})}function F7(t,e,n={}){U_(e),Kb(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||ch,s=n.hmac||((O,...m)=>Hh(e,O,fs(...m))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:u,getPublicKey:l,getSharedSecret:d,utils:f,lengths:h}=L7(t,n),g={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},p="compact";function y(O){const m=a>>tc;return O>m}function E(O,m){if(!o.isValidNot0(m))throw new Error(`invalid signature ${O}: out of range 1..Point.Fn.ORDER`);return m}function A(O,m){Nm(m);const b=h.signature,v=m==="compact"?b:m==="recovered"?b+1:void 0;return Ro(O,v,`${m} signature`)}class w{constructor(m,b,v){this.r=E("r",m),this.s=E("s",b),v!=null&&(this.recovery=v),Object.freeze(this)}static fromBytes(m,b=p){A(m,b);let v;if(b==="der"){const{r:B,s:F}=Zs.toSig(Ro(m));return new w(B,F)}b==="recovered"&&(v=m[0],b="compact",m=m.subarray(1));const S=o.BYTES,I=m.subarray(0,S),x=m.subarray(S,S*2);return new w(o.fromBytes(I),o.fromBytes(x),v)}static fromHex(m,b){return this.fromBytes(sf(m),b)}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){const b=i.ORDER,{r:v,s:S,recovery:I}=this;if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");if(a*i6<b&&I>1)throw new Error("recovery id is ambiguous for h>1 curve");const B=I===2||I===3?v+a:v;if(!i.isValid(B))throw new Error("recovery id 2 or 3 invalid");const F=i.toBytes(B),W=t.fromBytes(fs(o6((I&1)===0),F)),j=o.inv(B),q=_(kn("msgHash",m)),Y=o.create(-q*j),Q=o.create(S*j),ue=t.BASE.multiplyUnsafe(Y).add(W.multiplyUnsafe(Q));if(ue.is0())throw new Error("point at infinify");return ue.assertValidity(),ue}hasHighS(){return y(this.s)}toBytes(m=p){if(Nm(m),m==="der")return sf(Zs.hexFromSig(this));const b=o.toBytes(this.r),v=o.toBytes(this.s);if(m==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return fs(Uint8Array.of(this.recovery),b,v)}return fs(b,v)}toHex(m){return Ga(this.toBytes(m))}assertValidity(){}static fromCompact(m){return w.fromBytes(kn("sig",m),"compact")}static fromDER(m){return w.fromBytes(kn("sig",m),"der")}normalizeS(){return this.hasHighS()?new w(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Ga(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Ga(this.toBytes("compact"))}}const C=n.bits2int||function(m){if(m.length>8192)throw new Error("input is too large");const b=np(m),v=m.length*8-c;return v>0?b>>BigInt(v):b},_=n.bits2int_modN||function(m){return o.create(C(m))},P=ql(c);function k(O){return b7("num < 2^"+c,O,ti,P),o.toBytes(O)}function U(O,m){return Ro(O,void 0,"message"),m?Ro(e(O),void 0,"prehashed message"):O}function $(O,m,b){if(["recovered","canonical"].some(Y=>Y in b))throw new Error("sign() legacy options not supported");const{lowS:v,prehash:S,extraEntropy:I}=$0(b,g);O=U(O,S);const x=_(O),B=za(o,m),F=[k(B),k(x)];if(I!=null&&I!==!1){const Y=I===!0?r(h.secretKey):I;F.push(kn("extraEntropy",Y))}const W=fs(...F),j=x;function q(Y){const Q=C(Y);if(!o.isValidNot0(Q))return;const ue=o.inv(Q),J=t.BASE.multiply(Q).toAffine(),te=o.create(J.x);if(te===ti)return;const Ae=o.create(ue*o.create(j+te*B));if(Ae===ti)return;let Oe=(J.x===te?0:2)|Number(J.y&tc),Be=Ae;return v&&y(Ae)&&(Be=o.neg(Ae),Oe^=1),new w(te,Be,Oe)}return{seed:W,k2sig:q}}function L(O,m,b={}){O=kn("message",O);const{seed:v,k2sig:S}=$(O,m,b);return w7(e.outputLen,o.BYTES,s)(v,S)}function M(O){let m;const b=typeof O=="string"||Ey(O),v=!b&&O!==null&&typeof O=="object"&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!b&&!v)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(v)m=new w(O.r,O.s);else if(b){try{m=w.fromBytes(kn("sig",O),"der")}catch(S){if(!(S instanceof Zs.Err))throw S}if(!m)try{m=w.fromBytes(kn("sig",O),"compact")}catch{return!1}}return m||!1}function D(O,m,b,v={}){const{lowS:S,prehash:I,format:x}=$0(v,g);if(b=kn("publicKey",b),m=U(kn("message",m),I),"strict"in v)throw new Error("options.strict was renamed to lowS");const B=x===void 0?M(O):w.fromBytes(kn("sig",O),x);if(B===!1)return!1;try{const F=t.fromBytes(b);if(S&&B.hasHighS())return!1;const{r:W,s:j}=B,q=_(m),Y=o.inv(j),Q=o.create(q*Y),ue=o.create(W*Y),J=t.BASE.multiplyUnsafe(Q).add(F.multiplyUnsafe(ue));return J.is0()?!1:o.create(J.x)===W}catch{return!1}}function T(O,m,b={}){const{prehash:v}=$0(b,g);return m=U(m,v),w.fromBytes(O,"recovered").recoverPublicKey(m).toBytes()}return Object.freeze({keygen:u,getPublicKey:l,getSharedSecret:d,utils:f,lengths:h,Point:t,sign:L,verify:D,recoverPublicKey:T,Signature:w,hash:e})}function j7(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=rp(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function q7(t){const{CURVE:e,curveOpts:n}=j7(t),r={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,hash:t.hash,ecdsaOpts:r}}function z7(t,e){const n=e.Point;return Object.assign({},e,{ProjectivePoint:n,CURVE:Object.assign({},t,e6(n.Fn.ORDER,n.Fn.BITS))})}function H7(t){const{CURVE:e,curveOpts:n,hash:r,ecdsaOpts:s}=q7(t),i=M7(e,n),o=F7(i,r,s);return z7(t,o)}function kne(t,e){const n=r=>H7({...t,hash:r});return{...n(e),create:n}}function W7(t){return LL(V7(t))}function V7(t){const{payload:e,signature:n}=t,{r,s,yParity:i}=n,a=new d7.Signature(BigInt(r),BigInt(s)).addRecoveryBit(i).recoverPublicKey(zb(e).substring(2));return PL(a)}var D0={exports:{}},ZE;function K7(){return ZE||(ZE=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function i(c,u,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var h=new s(l,d||c,f),g=n?n+u:u;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],h]:c._events[g].push(h):(c._events[g]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,g=new Array(h);f<h;f++)g[f]=d[f].fn;return g},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,f,h,g){var p=n?n+u:u;if(!this._events[p])return!1;var y=this._events[p],E=arguments.length,A,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),E){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,d),!0;case 4:return y.fn.call(y.context,l,d,f),!0;case 5:return y.fn.call(y.context,l,d,f,h),!0;case 6:return y.fn.call(y.context,l,d,f,h,g),!0}for(w=1,A=new Array(E-1);w<E;w++)A[w-1]=arguments[w];y.fn.apply(y.context,A)}else{var C=y.length,_;for(w=0;w<C;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),E){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,l);break;case 3:y[w].fn.call(y[w].context,l,d);break;case 4:y[w].fn.call(y[w].context,l,d,f);break;default:if(!A)for(_=1,A=new Array(E-1);_<E;_++)A[_-1]=arguments[_];y[w].fn.apply(y[w].context,A)}}return!0},a.prototype.on=function(u,l,d){return i(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return i(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,f){var h=n?n+u:u;if(!this._events[h])return this;if(!l)return o(this,h),this;var g=this._events[h];if(g.fn)g.fn===l&&(!f||g.once)&&(!d||g.context===d)&&o(this,h);else{for(var p=0,y=[],E=g.length;p<E;p++)(g[p].fn!==l||f&&!g[p].once||d&&g[p].context!==d)&&y.push(g[p]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(D0)),D0.exports}var G7=K7();const Y7=aa(G7);function Z7(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<t.length;u++){const l=t.charAt(u),d=l.charCodeAt(0);if(e[d]!==255)throw new TypeError(l+" is ambiguous");e[d]=u}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,d=0,f=0;const h=u.length;for(;f!==h&&u[f]===0;)f++,l++;const g=(h-f)*i+1>>>0,p=new Uint8Array(g);for(;f!==h;){let A=u[f],w=0;for(let C=g-1;(A!==0||w<d)&&C!==-1;C--,w++)A+=256*p[C]>>>0,p[C]=A%n>>>0,A=A/n>>>0;if(A!==0)throw new Error("Non-zero carry");d=w,f++}let y=g-d;for(;y!==g&&p[y]===0;)y++;let E=r.repeat(l);for(;y<g;++y)E+=t.charAt(p[y]);return E}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,d=0,f=0;for(;u[l]===r;)d++,l++;const h=(u.length-l)*s+1>>>0,g=new Uint8Array(h);for(;l<u.length;){const A=u.charCodeAt(l);if(A>255)return;let w=e[A];if(w===255)return;let C=0;for(let _=h-1;(w!==0||C<f)&&_!==-1;_--,C++)w+=n*g[_]>>>0,g[_]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");f=C,l++}let p=h-f;for(;p!==h&&g[p]===0;)p++;const y=new Uint8Array(d+(h-p));let E=d;for(;p!==h;)y[E++]=g[p++];return y}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var J7="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Vc=Z7(J7);function X7(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if((s&4294967168)===0){n++;continue}else if((s&4294965248)===0)n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?n+=3:n+=4}}return n}function Q7(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const eF=new TextEncoder,tF=50;function nF(t,e,n){eF.encodeInto(t,e.subarray(n))}function rF(t,e,n){t.length>tF?nF(t,e,n):Q7(t,e,n)}const sF=4096;function c6(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,u=t[r++]&63;i.push((a&31)<<12|c<<6|u)}else if((a&248)===240){const c=t[r++]&63,u=t[r++]&63,l=t[r++]&63;let d=(a&7)<<18|c<<12|u<<6|l;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=sF&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const iF=new TextDecoder,oF=200;function aF(t,e,n){const r=t.subarray(e,e+n);return iF.decode(r)}function cF(t,e,n){return n>oF?aF(t,e,n):c6(t,e,n)}class md{constructor(e,n){this.type=e,this.data=n}}class er extends Error{constructor(e){super(e);const n=Object.create(er.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:er.name})}}const nu=4294967295;function uF(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function u6(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function l6(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function lF(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const dF=-1,fF=4294967296-1,hF=17179869184-1;function pF({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=hF)if(e===0&&t<=fF){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),u6(r,4,t),n}}function gF(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function mF(t){if(t instanceof Date){const e=gF(t);return pF(e)}else return null}function yF(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=l6(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new er(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function bF(t){const e=yF(t);return new Date(e.sec*1e3+e.nsec/1e6)}const wF={type:dF,encode:mF,decode:bF};class Gf{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(wF)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new md(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new md(o,i)}}}return e instanceof md?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new md(n,e)}}Gf.defaultCodec=new Gf;function EF(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function xm(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):EF(t)?new Uint8Array(t):Uint8Array.from(t)}const vF=100,CF=2048;let _F=class d6{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Gf.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??vF,this.initialBufferSize=e?.initialBufferSize??CF,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new d6({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=X7(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),rF(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=xm(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),uF(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),u6(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function AF(t,e){return new _F(e).encodeSharedRef(t)}function U0(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const SF=16,IF=16;class TF{constructor(e=SF,n=IF){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=c6(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const Pm="array",Nu="map_key",f6="map_value",NF=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new er("The type of key must be string or number but "+typeof t)};class xF{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Pm,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Nu,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Pm){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Nu||e.type===f6){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const ru=-1,Yb=new DataView(new ArrayBuffer(0)),PF=new Uint8Array(Yb.buffer);try{Yb.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const JE=new RangeError("Insufficient data"),OF=new TF;let RF=class h6{constructor(e){this.totalPos=0,this.pos=0,this.view=Yb,this.bytes=PF,this.headByte=ru,this.stack=new xF,this.entered=!1,this.extensionCodec=e?.extensionCodec??Gf.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??nu,this.maxBinLength=e?.maxBinLength??nu,this.maxArrayLength=e?.maxArrayLength??nu,this.maxMapLength=e?.maxMapLength??nu,this.maxExtLength=e?.maxExtLength??nu,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:OF,this.mapKeyConverter=e?.mapKeyConverter??NF}clone(){return new h6({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=ru,this.stack.reset()}setBuffer(e){const n=xm(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===ru&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=xm(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${U0(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new er(`Unrecognized type byte: ${U0(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===Pm)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Nu){if(n==="__proto__")throw new er("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=f6;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Nu;continue e}}return n}}readHeadByte(){return this.headByte===ru&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=ru}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new er(`Unrecognized array type byte: ${U0(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new er(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new er(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new er(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw JE;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,r,e):s=cF(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Nu:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new er(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw JE;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new er(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=lF(this.view,this.pos);return this.pos+=8,e}readI64(){const e=l6(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function kF(t,e){return new RF(e).decode(t)}function Zb(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function p6(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zb(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function xu(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=p6(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Zb(n)}function $F(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,y=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var w=(A-E)*l+1>>>0,C=new Uint8Array(w);E!==A;){for(var _=g[E],P=0,k=w-1;(_!==0||P<y)&&k!==-1;k--,P++)_+=256*C[k]>>>0,C[k]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");y=P,E++}for(var U=w-y;U!==w&&C[U]===0;)U++;for(var $=c.repeat(p);U<w;++U)$+=t.charAt(C[U]);return $}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var y=0,E=0;g[p]===c;)y++,p++;for(var A=(g.length-p)*u+1>>>0,w=new Uint8Array(A);g[p];){var C=n[g.charCodeAt(p)];if(C===255)return;for(var _=0,P=A-1;(C!==0||_<E)&&P!==-1;P--,_++)C+=a*w[P]>>>0,w[P]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");E=_,p++}if(g[p]!==" "){for(var k=A-E;k!==A&&w[k]===0;)k++;for(var U=new Uint8Array(y+(A-k)),$=y;k!==A;)U[$++]=w[k++];return U}}}function h(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var DF=$F,UF=DF;const BF=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},MF=t=>new TextEncoder().encode(t),LF=t=>new TextDecoder().decode(t);class FF{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class jF{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return g6(this,e)}}class qF{constructor(e){this.decoders=e}or(e){return g6(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const g6=(t,e)=>new qF({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class zF{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new FF(e,n,r),this.decoder=new jF(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const sp=({name:t,prefix:e,encode:n,decode:r})=>new zF(t,e,n,r),zl=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=UF(n,e);return sp({prefix:t,name:e,encode:r,decode:i=>BF(s(i))})},HF=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},WF=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},tn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>sp({prefix:e,name:t,encode(s){return WF(s,r,n)},decode(s){return HF(s,r,n,t)}}),VF=sp({prefix:"\0",name:"identity",encode:t=>LF(t),decode:t=>MF(t)}),KF=Object.freeze(Object.defineProperty({__proto__:null,identity:VF},Symbol.toStringTag,{value:"Module"})),GF=tn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),YF=Object.freeze(Object.defineProperty({__proto__:null,base2:GF},Symbol.toStringTag,{value:"Module"})),ZF=tn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),JF=Object.freeze(Object.defineProperty({__proto__:null,base8:ZF},Symbol.toStringTag,{value:"Module"})),XF=zl({prefix:"9",name:"base10",alphabet:"0123456789"}),QF=Object.freeze(Object.defineProperty({__proto__:null,base10:XF},Symbol.toStringTag,{value:"Module"})),ej=tn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tj=tn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),nj=Object.freeze(Object.defineProperty({__proto__:null,base16:ej,base16upper:tj},Symbol.toStringTag,{value:"Module"})),rj=tn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sj=tn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ij=tn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oj=tn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),aj=tn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),cj=tn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),uj=tn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lj=tn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dj=tn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),fj=Object.freeze(Object.defineProperty({__proto__:null,base32:rj,base32hex:aj,base32hexpad:uj,base32hexpadupper:lj,base32hexupper:cj,base32pad:ij,base32padupper:oj,base32upper:sj,base32z:dj},Symbol.toStringTag,{value:"Module"})),hj=zl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pj=zl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),gj=Object.freeze(Object.defineProperty({__proto__:null,base36:hj,base36upper:pj},Symbol.toStringTag,{value:"Module"})),mj=zl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yj=zl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bj=Object.freeze(Object.defineProperty({__proto__:null,base58btc:mj,base58flickr:yj},Symbol.toStringTag,{value:"Module"})),wj=tn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ej=tn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),vj=tn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Cj=tn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_j=Object.freeze(Object.defineProperty({__proto__:null,base64:wj,base64pad:Ej,base64url:vj,base64urlpad:Cj},Symbol.toStringTag,{value:"Module"})),m6=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Aj=m6.reduce((t,e,n)=>(t[n]=e,t),[]),Sj=m6.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Ij(t){return t.reduce((e,n)=>(e+=Aj[n],e),"")}function Tj(t){const e=[];for(const n of t){const r=Sj[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Nj=sp({prefix:"ðŸš€",name:"base256emoji",encode:Ij,decode:Tj}),xj=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Nj},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const XE={...KF,...YF,...JF,...QF,...nj,...fj,...gj,...bj,..._j,...xj};function y6(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const QE=y6("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),B0=y6("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=p6(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),b6={utf8:QE,"utf-8":QE,hex:XE.base16,latin1:B0,ascii:B0,binary:B0,...XE};function Cr(t,e="utf8"){const n=b6[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zb(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function zn(t,e="utf8"){const n=b6[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const Pj={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var M0,ev;function w6(){if(ev)return M0;ev=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function n(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function r(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let u=`
`+o+" = ";for(let l=0;l<a.length;l+=2){if(c===32)u+=r(a[l]).toUpperCase(),u+=" ",u+=r(a[l+1]).toUpperCase();else if(c===64)u+=r(a[l+1]).toUpperCase(),u+=r(a[l]).toUpperCase();else throw new Error("Invalid size "+c);l%6===4?u+=`
`+new Array(o.length+4).join(" "):l<a.length-2&&(u+=" ")}console.log(u)}function i(o,a,c){let u=new Date().getTime();const l=new Uint8Array(a);for(let f=0;f<a;f++)l[f]=f%256;const d=new Date().getTime();console.log("Generated random input in "+(d-u)+"ms"),u=d;for(let f=0;f<c;f++){const h=o(l),g=new Date().getTime(),p=g-u;u=g,console.log("Hashed in "+p+"ms: "+h.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(p/1e3)*100)/100+" MB PER SECOND")}}return M0={normalizeInput:e,toHex:n,debugPrint:s,testSpeed:i},M0}var L0,tv;function Oj(){if(tv)return L0;tv=1;const t=w6();function e(E,A,w){const C=E[A]+E[w];let _=E[A+1]+E[w+1];C>=4294967296&&_++,E[A]=C,E[A+1]=_}function n(E,A,w,C){let _=E[A]+w;w<0&&(_+=4294967296);let P=E[A+1]+C;_>=4294967296&&P++,E[A]=_,E[A+1]=P}function r(E,A){return E[A]^E[A+1]<<8^E[A+2]<<16^E[A+3]<<24}function s(E,A,w,C,_,P){const k=u[_],U=u[_+1],$=u[P],L=u[P+1];e(c,E,A),n(c,E,k,U);let M=c[C]^c[E],D=c[C+1]^c[E+1];c[C]=D,c[C+1]=M,e(c,w,C),M=c[A]^c[w],D=c[A+1]^c[w+1],c[A]=M>>>24^D<<8,c[A+1]=D>>>24^M<<8,e(c,E,A),n(c,E,$,L),M=c[C]^c[E],D=c[C+1]^c[E+1],c[C]=M>>>16^D<<16,c[C+1]=D>>>16^M<<16,e(c,w,C),M=c[A]^c[w],D=c[A+1]^c[w+1],c[A]=D>>>31^M<<1,c[A+1]=M>>>31^D<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(E){return E*2})),c=new Uint32Array(32),u=new Uint32Array(32);function l(E,A){let w=0;for(w=0;w<16;w++)c[w]=E.h[w],c[w+16]=i[w];for(c[24]=c[24]^E.t,c[25]=c[25]^E.t/4294967296,A&&(c[28]=~c[28],c[29]=~c[29]),w=0;w<32;w++)u[w]=r(E.b,4*w);for(w=0;w<12;w++)s(0,8,16,24,a[w*16+0],a[w*16+1]),s(2,10,18,26,a[w*16+2],a[w*16+3]),s(4,12,20,28,a[w*16+4],a[w*16+5]),s(6,14,22,30,a[w*16+6],a[w*16+7]),s(0,10,20,30,a[w*16+8],a[w*16+9]),s(2,12,22,24,a[w*16+10],a[w*16+11]),s(4,14,16,26,a[w*16+12],a[w*16+13]),s(6,8,18,28,a[w*16+14],a[w*16+15]);for(w=0;w<16;w++)E.h[w]=E.h[w]^c[w]^c[w+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function f(E,A,w,C){if(E===0||E>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(A&&A.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(w&&w.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(C&&C.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const _={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:E};d.fill(0),d[0]=E,A&&(d[1]=A.length),d[2]=1,d[3]=1,w&&d.set(w,32),C&&d.set(C,48);for(let P=0;P<16;P++)_.h[P]=i[P]^r(d,P*4);return A&&(h(_,A),_.c=128),_}function h(E,A){for(let w=0;w<A.length;w++)E.c===128&&(E.t+=E.c,l(E,!1),E.c=0),E.b[E.c++]=A[w]}function g(E){for(E.t+=E.c;E.c<128;)E.b[E.c++]=0;l(E,!0);const A=new Uint8Array(E.outlen);for(let w=0;w<E.outlen;w++)A[w]=E.h[w>>2]>>8*(w&3);return A}function p(E,A,w,C,_){w=w||64,E=t.normalizeInput(E),C&&(C=t.normalizeInput(C)),_&&(_=t.normalizeInput(_));const P=f(w,A,C,_);return h(P,E),g(P)}function y(E,A,w,C,_){const P=p(E,A,w,C,_);return t.toHex(P)}return L0={blake2b:p,blake2bHex:y,blake2bInit:f,blake2bUpdate:h,blake2bFinal:g},L0}var F0,nv;function Rj(){if(nv)return F0;nv=1;const t=w6();function e(g,p){return g[p]^g[p+1]<<8^g[p+2]<<16^g[p+3]<<24}function n(g,p,y,E,A,w){o[g]=o[g]+o[p]+A,o[E]=r(o[E]^o[g],16),o[y]=o[y]+o[E],o[p]=r(o[p]^o[y],12),o[g]=o[g]+o[p]+w,o[E]=r(o[E]^o[g],8),o[y]=o[y]+o[E],o[p]=r(o[p]^o[y],7)}function r(g,p){return g>>>p^g<<32-p}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(g,p){let y=0;for(y=0;y<8;y++)o[y]=g.h[y],o[y+8]=s[y];for(o[12]^=g.t,o[13]^=g.t/4294967296,p&&(o[14]=~o[14]),y=0;y<16;y++)a[y]=e(g.b,4*y);for(y=0;y<10;y++)n(0,4,8,12,a[i[y*16+0]],a[i[y*16+1]]),n(1,5,9,13,a[i[y*16+2]],a[i[y*16+3]]),n(2,6,10,14,a[i[y*16+4]],a[i[y*16+5]]),n(3,7,11,15,a[i[y*16+6]],a[i[y*16+7]]),n(0,5,10,15,a[i[y*16+8]],a[i[y*16+9]]),n(1,6,11,12,a[i[y*16+10]],a[i[y*16+11]]),n(2,7,8,13,a[i[y*16+12]],a[i[y*16+13]]),n(3,4,9,14,a[i[y*16+14]],a[i[y*16+15]]);for(y=0;y<8;y++)g.h[y]^=o[y]^o[y+8]}function u(g,p){if(!(g>0&&g<=32))throw new Error("Incorrect output length, should be in [1, 32]");const y=p?p.length:0;if(p&&!(y>0&&y<=32))throw new Error("Incorrect key length, should be in [1, 32]");const E={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:g};return E.h[0]^=16842752^y<<8^g,y>0&&(l(E,p),E.c=64),E}function l(g,p){for(let y=0;y<p.length;y++)g.c===64&&(g.t+=g.c,c(g,!1),g.c=0),g.b[g.c++]=p[y]}function d(g){for(g.t+=g.c;g.c<64;)g.b[g.c++]=0;c(g,!0);const p=new Uint8Array(g.outlen);for(let y=0;y<g.outlen;y++)p[y]=g.h[y>>2]>>8*(y&3)&255;return p}function f(g,p,y){y=y||32,g=t.normalizeInput(g);const E=u(y,p);return l(E,g),d(E)}function h(g,p,y){const E=f(g,p,y);return t.toHex(E)}return F0={blake2s:f,blake2sHex:h,blake2sInit:u,blake2sUpdate:l,blake2sFinal:d},F0}var j0,rv;function kj(){if(rv)return j0;rv=1;const t=Oj(),e=Rj();return j0={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},j0}var $j=kj(),Dj={};const Uj=":";function ai(t){const[e,n]=t.split(Uj);return{namespace:e,reference:n}}function E6(t,e){return t.includes(":")?[t]:e.chains||[]}var Bj=Object.defineProperty,Mj=Object.defineProperties,Lj=Object.getOwnPropertyDescriptors,sv=Object.getOwnPropertySymbols,Fj=Object.prototype.hasOwnProperty,jj=Object.prototype.propertyIsEnumerable,Om=(t,e,n)=>e in t?Bj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iv=(t,e)=>{for(var n in e||(e={}))Fj.call(e,n)&&Om(t,n,e[n]);if(sv)for(var n of sv(e))jj.call(e,n)&&Om(t,n,e[n]);return t},qj=(t,e)=>Mj(t,Lj(e)),ov=(t,e,n)=>Om(t,typeof e!="symbol"?e+"":e,n);const zj="ReactNative",or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Hj="js";function Yf(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function fo(){return!mi.getDocument()&&!!mi.getNavigator()&&navigator.product===zj}function Wj(){return fo()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="android"}function Vj(){return fo()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="ios"}function Kc(){return!Yf()&&!!mi.getNavigator()&&!!mi.getDocument()}function Hl(){return fo()?or.reactNative:Yf()?or.node:Kc()?or.browser:or.unknown}function av(){var t;try{return fo()&&typeof globalThis<"u"&&typeof globalThis?.Application<"u"?(t=globalThis.Application)==null?void 0:t.applicationId:void 0}catch{return}}function Kj(t,e){const n=new URLSearchParams(t);return Object.entries(e).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!=null&&n.set(r,String(s))}),n.toString()}function Gj(t){var e,n;const r=v6();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),qj(iv(iv({},r),t),{url:t?.url||r.url,name:t?.name||r.name,description:t?.description||r.description,icons:(n=t?.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function v6(){return XM.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Yj(){if(Hl()===or.reactNative&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"){const{OS:n,Version:r}=globalThis.Platform;return[n,r].join("-")}const t=jN();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Zj(){var t;const e=Hl();return e===or.browser?[e,((t=mi.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function C6(t,e,n){const r=Yj(),s=Zj();return[[t,e].join("-"),[Hj,n].join("-"),r,s].join("/")}function Jj({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=n.split("?"),l=C6(t,e,r),d={auth:s,ua:l,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},f=Kj(u[1]||"",d);return u[0]+"?"+f}function Do(t,e){return t.filter(n=>e.includes(n)).length===t.length}function Rm(t){return Object.fromEntries(t.entries())}function km(t){return new Map(Object.entries(t))}function So(t=re.FIVE_MINUTES,e){const n=re.toMiliseconds(t||re.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},n),r=a,s=c})}}function ms(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function _6(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Xj(t){return _6("topic",t)}function Qj(t){return _6("id",t)}function A6(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function Tt(t,e){return re.fromMiliseconds(Date.now()+re.toMiliseconds(t))}function ds(t){return Date.now()>=re.toMiliseconds(t)}function Xe(t,e){return`${t}${e?`:${e}`:""}`}function Cs(t=[],e=[]){return[...new Set([...t,...e])]}async function eq({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=tq(i,t,e),a=Hl();if(a===or.browser){if(!((r=mi.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}nq(o)}else a===or.reactNative&&typeof globalThis?.Linking<"u"&&await globalThis.Linking.openURL(o)}catch(s){console.error(s)}}function tq(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${oq(r,!0)}`}else s=`${s}/wc?${r}`;return s}function nq(t){let e="_self";iq()?e="_top":(sq()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function rq(t,e){let n="";try{if(Kc()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function cv(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function uv(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Jb(){return typeof process<"u"&&Dj.IS_VITEST==="true"}function sq(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function iq(){try{return window.self!==window.top}catch{return!1}}function oq(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function S6(t){return Buffer.from(t,"base64").toString("utf-8")}function aq(t){return new Promise(e=>setTimeout(e,t))}let cq=class{constructor({limit:e}){ov(this,"limit"),ov(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const yd=BigInt(2**32-1),lv=BigInt(32);function I6(t,e=!1){return e?{h:Number(t&yd),l:Number(t>>lv&yd)}:{h:Number(t>>lv&yd)|0,l:Number(t&yd)|0}}function T6(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=I6(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const dv=(t,e,n)=>t>>>n,fv=(t,e,n)=>t<<32-n|e>>>n,$i=(t,e,n)=>t>>>n|e<<32-n,Di=(t,e,n)=>t<<32-n|e>>>n,_u=(t,e,n)=>t<<64-n|e>>>n-32,Au=(t,e,n)=>t>>>n-32|e<<64-n,uq=(t,e)=>e,lq=(t,e)=>t,dq=(t,e,n)=>t<<n|e>>>32-n,fq=(t,e,n)=>e<<n|t>>>32-n,hq=(t,e,n)=>e<<n-32|t>>>64-n,pq=(t,e,n)=>t<<n-32|e>>>64-n;function Ur(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Xb=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Qb=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,gq=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),mq=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,yq=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),bq=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Na=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ip(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function yi(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Qr(t,...e){if(!ip(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function op(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");yi(t.outputLen),yi(t.blockLen)}function ao(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ew(t,e){Qr(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ul(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Tr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function q0(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function is(t,e){return t<<32-e|t>>>e}const N6=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function x6(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const qs=N6?t=>t:t=>x6(t);function wq(t){for(let e=0;e<t.length;e++)t[e]=x6(t[e]);return t}const Ui=N6?t=>t:wq,P6=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Eq=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function nc(t){if(Qr(t),P6)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=Eq[t[n]];return e}const Ls={_0:48,_9:57,A:65,F:70,a:97,f:102};function hv(t){if(t>=Ls._0&&t<=Ls._9)return t-Ls._0;if(t>=Ls.A&&t<=Ls.F)return t-(Ls.A-10);if(t>=Ls.a&&t<=Ls.f)return t-(Ls.a-10)}function Zf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(P6)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=hv(t.charCodeAt(i)),a=hv(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function O6(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Kr(t){return typeof t=="string"&&(t=O6(t)),Qr(t),t}function Fi(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Qr(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let ap=class{};function Wl(t){const e=r=>t().update(Kr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function vq(t){const e=(r,s)=>t(s).update(Kr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function wa(t=32){if(Na&&typeof Na.getRandomValues=="function")return Na.getRandomValues(new Uint8Array(t));if(Na&&typeof Na.randomBytes=="function")return Uint8Array.from(Na.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const Cq=BigInt(0),su=BigInt(1),_q=BigInt(2),Aq=BigInt(7),Sq=BigInt(256),Iq=BigInt(113),R6=[],k6=[],$6=[];for(let t=0,e=su,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],R6.push(2*(5*r+n)),k6.push((t+1)*(t+2)/2%64);let s=Cq;for(let i=0;i<7;i++)e=(e<<su^(e>>Aq)*Iq)%Sq,e&_q&&(s^=su<<(su<<BigInt(i))-su);$6.push(s)}const D6=T6($6,!0),Tq=D6[0],Nq=D6[1],pv=(t,e,n)=>n>32?hq(t,e,n):dq(t,e,n),gv=(t,e,n)=>n>32?pq(t,e,n):fq(t,e,n);function xq(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=n[c],l=n[c+1],d=pv(u,l,1)^n[a],f=gv(u,l,1)^n[a+1];for(let h=0;h<50;h+=10)t[o+h]^=d,t[o+h+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=k6[o],c=pv(s,i,a),u=gv(s,i,a),l=R6[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Tq[r],t[1]^=Nq[r]}Tr(n)}let Pq=class U6 extends ap{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,yi(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=ul(this.state)}clone(){return this._cloneInto()}keccak(){Ui(this.state32),xq(this.state32,this.rounds),Ui(this.state32),this.posOut=0,this.pos=0}update(e){ao(this),e=Kr(e),Qr(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){ao(this,!1),Qr(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return yi(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ew(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Tr(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new U6(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Oq=(t,e,n)=>Wl(()=>new Pq(e,t,n)),Rq=Oq(1,136,256/8);function kq(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}function $q(t,e,n){return t&e^~t&n}function Dq(t,e,n){return t&e^t&n^e&n}let B6=class extends ap{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=q0(this.buffer)}update(e){ao(this),e=Kr(e),Qr(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=q0(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ao(this),ew(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Tr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;kq(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=q0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Ti=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),on=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),an=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Uq=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ni=new Uint32Array(64);class Bq extends B6{constructor(e=32){super(64,e,8,!1),this.A=Ti[0]|0,this.B=Ti[1]|0,this.C=Ti[2]|0,this.D=Ti[3]|0,this.E=Ti[4]|0,this.F=Ti[5]|0,this.G=Ti[6]|0,this.H=Ti[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Ni[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=Ni[d-15],h=Ni[d-2],g=is(f,7)^is(f,18)^f>>>3,p=is(h,17)^is(h,19)^h>>>10;Ni[d]=p+Ni[d-7]+g+Ni[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=is(a,6)^is(a,11)^is(a,25),h=l+f+$q(a,c,u)+Uq[d]+Ni[d]|0,g=(is(r,2)^is(r,13)^is(r,22))+Dq(r,s,i)|0;l=u,u=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,i,o,a,c,u,l)}roundClean(){Tr(Ni)}destroy(){this.set(0,0,0,0,0,0,0,0),Tr(this.buffer)}}const M6=T6(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Mq=M6[0],Lq=M6[1],xi=new Uint32Array(80),Pi=new Uint32Array(80);let tw=class extends B6{constructor(e=64){super(128,e,16,!1),this.Ah=an[0]|0,this.Al=an[1]|0,this.Bh=an[2]|0,this.Bl=an[3]|0,this.Ch=an[4]|0,this.Cl=an[5]|0,this.Dh=an[6]|0,this.Dl=an[7]|0,this.Eh=an[8]|0,this.El=an[9]|0,this.Fh=an[10]|0,this.Fl=an[11]|0,this.Gh=an[12]|0,this.Gl=an[13]|0,this.Hh=an[14]|0,this.Hl=an[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:f,Gh:h,Gl:g,Hh:p,Hl:y}=this;return[e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y]}set(e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=g|0,this.Hh=p|0,this.Hl=y|0}process(e,n){for(let w=0;w<16;w++,n+=4)xi[w]=e.getUint32(n),Pi[w]=e.getUint32(n+=4);for(let w=16;w<80;w++){const C=xi[w-15]|0,_=Pi[w-15]|0,P=$i(C,_,1)^$i(C,_,8)^dv(C,_,7),k=Di(C,_,1)^Di(C,_,8)^fv(C,_,7),U=xi[w-2]|0,$=Pi[w-2]|0,L=$i(U,$,19)^_u(U,$,61)^dv(U,$,6),M=Di(U,$,19)^Au(U,$,61)^fv(U,$,6),D=gq(k,M,Pi[w-7],Pi[w-16]),T=mq(D,P,L,xi[w-7],xi[w-16]);xi[w]=T|0,Pi[w]=D|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:f,Fh:h,Fl:g,Gh:p,Gl:y,Hh:E,Hl:A}=this;for(let w=0;w<80;w++){const C=$i(d,f,14)^$i(d,f,18)^_u(d,f,41),_=Di(d,f,14)^Di(d,f,18)^Au(d,f,41),P=d&h^~d&p,k=f&g^~f&y,U=yq(A,_,k,Lq[w],Pi[w]),$=bq(U,E,C,P,Mq[w],xi[w]),L=U|0,M=$i(r,s,28)^_u(r,s,34)^_u(r,s,39),D=Di(r,s,28)^Au(r,s,34)^Au(r,s,39),T=r&i^r&a^i&a,O=s&o^s&c^o&c;E=p|0,A=y|0,p=h|0,y=g|0,h=d|0,g=f|0,{h:d,l:f}=Ur(u|0,l|0,$|0,L|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const m=Xb(L,D,O);r=Qb(m,$,M,T),s=m|0}({h:r,l:s}=Ur(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ur(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ur(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ur(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:f}=Ur(this.Eh|0,this.El|0,d|0,f|0),{h,l:g}=Ur(this.Fh|0,this.Fl|0,h|0,g|0),{h:p,l:y}=Ur(this.Gh|0,this.Gl|0,p|0,y|0),{h:E,l:A}=Ur(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,u,l,d,f,h,g,p,y,E,A)}roundClean(){Tr(xi,Pi)}destroy(){Tr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class Fq extends tw{constructor(){super(48),this.Ah=on[0]|0,this.Al=on[1]|0,this.Bh=on[2]|0,this.Bl=on[3]|0,this.Ch=on[4]|0,this.Cl=on[5]|0,this.Dh=on[6]|0,this.Dl=on[7]|0,this.Eh=on[8]|0,this.El=on[9]|0,this.Fh=on[10]|0,this.Fl=on[11]|0,this.Gh=on[12]|0,this.Gl=on[13]|0,this.Hh=on[14]|0,this.Hl=on[15]|0}}const cn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class jq extends tw{constructor(){super(32),this.Ah=cn[0]|0,this.Al=cn[1]|0,this.Bh=cn[2]|0,this.Bl=cn[3]|0,this.Ch=cn[4]|0,this.Cl=cn[5]|0,this.Dh=cn[6]|0,this.Dl=cn[7]|0,this.Eh=cn[8]|0,this.El=cn[9]|0,this.Fh=cn[10]|0,this.Fl=cn[11]|0,this.Gh=cn[12]|0,this.Gl=cn[13]|0,this.Hh=cn[14]|0,this.Hl=cn[15]|0}}const cp=Wl(()=>new Bq),qq=Wl(()=>new tw),zq=Wl(()=>new Fq),Hq=Wl(()=>new jq),Wq=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ot=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ce=new Uint32Array(32);function Oi(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ce[2*t],u=ce[2*t+1],l=ce[2*e],d=ce[2*e+1],f=ce[2*n],h=ce[2*n+1],g=ce[2*r],p=ce[2*r+1],y=Xb(c,l,o);u=Qb(y,u,d,a),c=y|0,{Dh:p,Dl:g}={Dh:p^u,Dl:g^c},{Dh:p,Dl:g}={Dh:uq(p,g),Dl:lq(p)},{h,l:f}=Ur(h,f,p,g),{Bh:d,Bl:l}={Bh:d^h,Bl:l^f},{Bh:d,Bl:l}={Bh:$i(d,l,24),Bl:Di(d,l,24)},ce[2*t]=c,ce[2*t+1]=u,ce[2*e]=l,ce[2*e+1]=d,ce[2*n]=f,ce[2*n+1]=h,ce[2*r]=g,ce[2*r+1]=p}function Ri(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ce[2*t],u=ce[2*t+1],l=ce[2*e],d=ce[2*e+1],f=ce[2*n],h=ce[2*n+1],g=ce[2*r],p=ce[2*r+1],y=Xb(c,l,o);u=Qb(y,u,d,a),c=y|0,{Dh:p,Dl:g}={Dh:p^u,Dl:g^c},{Dh:p,Dl:g}={Dh:$i(p,g,16),Dl:Di(p,g,16)},{h,l:f}=Ur(h,f,p,g),{Bh:d,Bl:l}={Bh:d^h,Bl:l^f},{Bh:d,Bl:l}={Bh:_u(d,l,63),Bl:Au(d,l,63)},ce[2*t]=c,ce[2*t+1]=u,ce[2*e]=l,ce[2*e+1]=d,ce[2*n]=f,ce[2*n+1]=h,ce[2*r]=g,ce[2*r+1]=p}function Vq(t,e={},n,r,s){if(yi(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class Kq extends ap{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,yi(e),yi(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=ul(this.buffer)}update(e){ao(this),e=Kr(e),Qr(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(Ui(s),this.compress(s,0,!1),Ui(s),this.pos=0);const u=Math.min(n-this.pos,i-c),l=o+c;if(u===n&&!(l%4)&&c+u<i){const d=new Uint32Array(a,l,Math.floor((i-c)/4));Ui(d);for(let f=0;c+n<i;f+=s.length,c+=n)this.length+=n,this.compress(d,f,!1);Ui(d);continue}r.set(e.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(e){ao(this),ew(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Tr(this.buffer.subarray(n)),Ui(r),this.compress(r,0,!0),Ui(r);const s=ul(e);this.get().forEach((i,o)=>s[o]=qs(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class Gq extends Kq{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=Ot[0]|0,this.v0h=Ot[1]|0,this.v1l=Ot[2]|0,this.v1h=Ot[3]|0,this.v2l=Ot[4]|0,this.v2h=Ot[5]|0,this.v3l=Ot[6]|0,this.v3h=Ot[7]|0,this.v4l=Ot[8]|0,this.v4h=Ot[9]|0,this.v5l=Ot[10]|0,this.v5h=Ot[11]|0,this.v6l=Ot[12]|0,this.v6h=Ot[13]|0,this.v7l=Ot[14]|0,this.v7h=Ot[15]|0,Vq(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=Kr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Kr(i);const a=ul(i);this.v4l^=qs(a[0]),this.v4h^=qs(a[1]),this.v5l^=qs(a[2]),this.v5h^=qs(a[3])}if(s!==void 0){s=Kr(s);const a=ul(s);this.v6l^=qs(a[0]),this.v6h^=qs(a[1]),this.v7l^=qs(a[2]),this.v7h^=qs(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:u,v4h:l,v5l:d,v5h:f,v6l:h,v6h:g,v7l:p,v7h:y}=this;return[e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y]}set(e,n,r,s,i,o,a,c,u,l,d,f,h,g,p,y){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=l|0,this.v5l=d|0,this.v5h=f|0,this.v6l=h|0,this.v6h=g|0,this.v7l=p|0,this.v7h=y|0}compress(e,n,r){this.get().forEach((c,u)=>ce[u]=c),ce.set(Ot,16);let{h:s,l:i}=I6(BigInt(this.length));ce[24]=Ot[8]^i,ce[25]=Ot[9]^s,r&&(ce[28]=~ce[28],ce[29]=~ce[29]);let o=0;const a=Wq;for(let c=0;c<12;c++)Oi(0,4,8,12,e,n+2*a[o++]),Ri(0,4,8,12,e,n+2*a[o++]),Oi(1,5,9,13,e,n+2*a[o++]),Ri(1,5,9,13,e,n+2*a[o++]),Oi(2,6,10,14,e,n+2*a[o++]),Ri(2,6,10,14,e,n+2*a[o++]),Oi(3,7,11,15,e,n+2*a[o++]),Ri(3,7,11,15,e,n+2*a[o++]),Oi(0,5,10,15,e,n+2*a[o++]),Ri(0,5,10,15,e,n+2*a[o++]),Oi(1,6,11,12,e,n+2*a[o++]),Ri(1,6,11,12,e,n+2*a[o++]),Oi(2,7,8,13,e,n+2*a[o++]),Ri(2,7,8,13,e,n+2*a[o++]),Oi(3,4,9,14,e,n+2*a[o++]),Ri(3,4,9,14,e,n+2*a[o++]);this.v0l^=ce[0]^ce[16],this.v0h^=ce[1]^ce[17],this.v1l^=ce[2]^ce[18],this.v1h^=ce[3]^ce[19],this.v2l^=ce[4]^ce[20],this.v2h^=ce[5]^ce[21],this.v3l^=ce[6]^ce[22],this.v3h^=ce[7]^ce[23],this.v4l^=ce[8]^ce[24],this.v4h^=ce[9]^ce[25],this.v5l^=ce[10]^ce[26],this.v5h^=ce[11]^ce[27],this.v6l^=ce[12]^ce[28],this.v6h^=ce[13]^ce[29],this.v7l^=ce[14]^ce[30],this.v7h^=ce[15]^ce[31],Tr(ce)}destroy(){this.destroyed=!0,Tr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Yq=vq(t=>new Gq(t)),Zq="https://rpc.walletconnect.org/v1";function L6(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(Rq(n)).toString("hex")}async function Jq(t,e,n,r,s,i){switch(n.t){case"eip191":return await Xq(t,e,n.s);case"eip1271":return await Qq(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}function Xq(t,e,n){const r=f7(n);return W7({payload:L6(e),signature:r}).toLowerCase()===t.toLowerCase()}async function Qq(t,e,n,r,s,i){const o=ai(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u=n.substring(2),l=(u.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:L6(e)).substring(2),f=a+d+c+l+u,h=await fetch(`${i||Zq}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:ez(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:f},"latest"]})}),{result:g}=await h.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function ez(){return Date.now()+Math.floor(Math.random()*1e3)}function tz(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Vc.encode(i)}function nz(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=Yq(r,{dkLen:32});return Vc.encode(s)}function mv(t){const e=new Uint8Array(cp(rz(t)));return Vc.encode(e)}function rz(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function yv(t){const e=Buffer.from(t,"base64"),n=kF(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=AF(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=Hq(i);return qN.encode(o).replace(/=+$/,"")}function z0(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function sz(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(z0(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(z0(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(z0(r.length)),s.push(r);const i=Buffer.concat(s),o=cp(i);return Buffer.from(o).toString("hex").toUpperCase()}function iz(t){var e,n;const r=[];try{if(typeof t=="string")return r.push(t),r;if(typeof t!="object")return r;t!=null&&t.id&&r.push(t.id);const s=(n=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:n.transactionHashes;s&&r.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return r}var oz=Object.defineProperty,az=Object.defineProperties,cz=Object.getOwnPropertyDescriptors,bv=Object.getOwnPropertySymbols,uz=Object.prototype.hasOwnProperty,lz=Object.prototype.propertyIsEnumerable,wv=(t,e,n)=>e in t?oz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dz=(t,e)=>{for(var n in e||(e={}))uz.call(e,n)&&wv(t,n,e[n]);if(bv)for(var n of bv(e))lz.call(e,n)&&wv(t,n,e[n]);return t},fz=(t,e)=>az(t,cz(e));const F6="did:pkh:",hz={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},pz=t=>t?hz[t]||t:"",up=t=>t?.split(":"),gz=t=>{const e=t&&up(t);if(e)return t.includes(F6)?e[3]:e[1]},mz=t=>{const e=t&&up(t);if(e)return t.includes(F6)?e[2]:e[0]},$m=t=>{const e=t&&up(t);if(e)return e[2]+":"+e[3]},Jf=t=>{const e=t&&up(t);if(e)return e.pop()};async function Ev(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=j6(s,s.iss),o=Jf(s.iss);return await Jq(o,i,r,$m(s.iss),n)}const j6=(t,e)=>{const n=mz(e);if(!n)throw new Error("Invalid issuer: "+e);const r=`${t.domain} wants you to sign in with your ${pz(n)} account:`,s=Jf(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${gz(e)}`,u=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,d=t.exp?`Expiration Time: ${t.exp}`:void 0,f=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,g=t.resources?`Resources:${t.resources.map(y=>`
- ${y}`).join("")}`:void 0,p=Gd(t.resources);if(p){const y=ll(p);i=Sz(i,y)}return[r,s,"",i,"",o,a,c,u,l,d,f,h,g].filter(y=>y!=null).join(`
`)};function yz(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function bz(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function sa(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function wz(t,e,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:Ez(e,n,r)}}}function Ez(t,e,n={}){e=e?.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function q6(t){return sa(t),`urn:recap:${yz(t).replace(/=/g,"")}`}function ll(t){const e=bz(t.replace("urn:recap:",""));return sa(e),e}function vz(t,e,n){const r=wz(t,e,n);return q6(r)}function Cz(t){return t&&t.includes("urn:recap:")}function _z(t,e){const n=ll(t),r=ll(e),s=Az(n,r);return q6(s)}function Az(t,e){sa(t),sa(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;r.att[s]=fz(dz({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((u=e.att[s])==null?void 0:u[a])})})}),r}function Sz(t="",e){sa(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,f)=>d.action.localeCompare(f.action));const u={};c.forEach(d=>{u[d.ability]||(u[d.ability]=[]),u[d.ability].push(d.action)});const l=Object.keys(u).map(d=>(s++,`(${s}) '${d}': '${u[d].join("', '")}' for '${a}'.`));r.push(l.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function vv(t){var e;const n=ll(t);sa(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function Cv(t){const e=ll(t);sa(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function Gd(t){if(!t)return;const e=t?.[t.length-1];return Cz(e)?e:void 0}function z6(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Dm(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function H0(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Bn(t,...e){if(!z6(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function _v(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Iz(t,e){Bn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Yi(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function kc(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Tz(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Nz=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function xz(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Um(t){if(typeof t=="string")t=xz(t);else if(z6(t))t=Bm(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Pz(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Oz(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Rz=(t,e)=>{function n(r,...s){if(Bn(r),!Nz)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const u=s[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?Bn(u):Bn(u,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&Bn(s[1]);const o=e(r,...s),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");Bn(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Bn(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(Bn(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(n,t),n};function Av(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!$z(e))throw new Error("invalid output, must be aligned");return e}function Sv(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function kz(t,e,n){Dm(n);const r=new Uint8Array(16),s=Tz(r);return Sv(s,0,BigInt(e),n),Sv(s,8,BigInt(t),n),r}function $z(t){return t.byteOffset%4===0}function Bm(t){return Uint8Array.from(t)}const H6=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Dz=H6("expand 16-byte k"),Uz=H6("expand 32-byte k"),Bz=Yi(Dz),Mz=Yi(Uz);function We(t,e){return t<<e|t>>>32-e}function Mm(t){return t.byteOffset%4===0}const bd=64,Lz=16,W6=2**32-1,Iv=new Uint32Array;function Fz(t,e,n,r,s,i,o,a){const c=s.length,u=new Uint8Array(bd),l=Yi(u),d=Mm(s)&&Mm(i),f=d?Yi(s):Iv,h=d?Yi(i):Iv;for(let g=0;g<c;o++){if(t(e,n,r,l,o,a),o>=W6)throw new Error("arx: counter overflow");const p=Math.min(bd,c-g);if(d&&p===bd){const y=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let E=0,A;E<Lz;E++)A=y+E,h[A]=f[A]^l[E];g+=bd;continue}for(let y=0,E;y<p;y++)E=g+y,i[E]=s[E]^u[y];g+=p}}function jz(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=Pz({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return H0(s),H0(o),Dm(i),Dm(n),(a,c,u,l,d=0)=>{Bn(a),Bn(c),Bn(u);const f=u.length;if(l===void 0&&(l=new Uint8Array(f)),Bn(l),H0(d),d<0||d>=W6)throw new Error("arx: counter overflow");if(l.length<f)throw new Error(`arx: output (${l.length}) is shorter than data (${f})`);const h=[];let g=a.length,p,y;if(g===32)h.push(p=Bm(a)),y=Mz;else if(g===16&&n)p=new Uint8Array(32),p.set(a),p.set(a,16),y=Bz,h.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);Mm(c)||h.push(c=Bm(c));const E=Yi(p);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(y,E,Yi(c.subarray(0,16)),E),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const C=new Uint8Array(12);C.set(c,i?0:12-c.length),c=C,h.push(c)}const w=Yi(c);return Fz(t,y,E,w,u,l,d,o),kc(...h),l}}const Kt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class qz{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Um(e),Bn(e,32);const n=Kt(e,0),r=Kt(e,2),s=Kt(e,4),i=Kt(e,6),o=Kt(e,8),a=Kt(e,10),c=Kt(e,12),u=Kt(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=Kt(e,16+2*l)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],d=o[4],f=o[5],h=o[6],g=o[7],p=o[8],y=o[9],E=Kt(e,n+0),A=Kt(e,n+2),w=Kt(e,n+4),C=Kt(e,n+6),_=Kt(e,n+8),P=Kt(e,n+10),k=Kt(e,n+12),U=Kt(e,n+14);let $=i[0]+(E&8191),L=i[1]+((E>>>13|A<<3)&8191),M=i[2]+((A>>>10|w<<6)&8191),D=i[3]+((w>>>7|C<<9)&8191),T=i[4]+((C>>>4|_<<12)&8191),O=i[5]+(_>>>1&8191),m=i[6]+((_>>>14|P<<2)&8191),b=i[7]+((P>>>11|k<<5)&8191),v=i[8]+((k>>>8|U<<8)&8191),S=i[9]+(U>>>5|s),I=0,x=I+$*a+L*(5*y)+M*(5*p)+D*(5*g)+T*(5*h);I=x>>>13,x&=8191,x+=O*(5*f)+m*(5*d)+b*(5*l)+v*(5*u)+S*(5*c),I+=x>>>13,x&=8191;let B=I+$*c+L*a+M*(5*y)+D*(5*p)+T*(5*g);I=B>>>13,B&=8191,B+=O*(5*h)+m*(5*f)+b*(5*d)+v*(5*l)+S*(5*u),I+=B>>>13,B&=8191;let F=I+$*u+L*c+M*a+D*(5*y)+T*(5*p);I=F>>>13,F&=8191,F+=O*(5*g)+m*(5*h)+b*(5*f)+v*(5*d)+S*(5*l),I+=F>>>13,F&=8191;let W=I+$*l+L*u+M*c+D*a+T*(5*y);I=W>>>13,W&=8191,W+=O*(5*p)+m*(5*g)+b*(5*h)+v*(5*f)+S*(5*d),I+=W>>>13,W&=8191;let j=I+$*d+L*l+M*u+D*c+T*a;I=j>>>13,j&=8191,j+=O*(5*y)+m*(5*p)+b*(5*g)+v*(5*h)+S*(5*f),I+=j>>>13,j&=8191;let q=I+$*f+L*d+M*l+D*u+T*c;I=q>>>13,q&=8191,q+=O*a+m*(5*y)+b*(5*p)+v*(5*g)+S*(5*h),I+=q>>>13,q&=8191;let Y=I+$*h+L*f+M*d+D*l+T*u;I=Y>>>13,Y&=8191,Y+=O*c+m*a+b*(5*y)+v*(5*p)+S*(5*g),I+=Y>>>13,Y&=8191;let Q=I+$*g+L*h+M*f+D*d+T*l;I=Q>>>13,Q&=8191,Q+=O*u+m*c+b*a+v*(5*y)+S*(5*p),I+=Q>>>13,Q&=8191;let ue=I+$*p+L*g+M*h+D*f+T*d;I=ue>>>13,ue&=8191,ue+=O*l+m*u+b*c+v*a+S*(5*y),I+=ue>>>13,ue&=8191;let J=I+$*y+L*p+M*g+D*h+T*f;I=J>>>13,J&=8191,J+=O*d+m*l+b*u+v*c+S*a,I+=J>>>13,J&=8191,I=(I<<2)+I|0,I=I+x|0,x=I&8191,I=I>>>13,B+=I,i[0]=x,i[1]=B,i[2]=F,i[3]=W,i[4]=j,i[5]=q,i[6]=Y,i[7]=Q,i[8]=ue,i[9]=J}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;kc(r)}update(e){_v(this),e=Um(e),Bn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){kc(this.h,this.r,this.buffer,this.pad)}digestInto(e){_v(this),Iz(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function zz(t){const e=(r,s)=>t(s).update(Um(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const Hz=zz(t=>new qz(t));function Wz(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],u=t[3],l=e[0],d=e[1],f=e[2],h=e[3],g=e[4],p=e[5],y=e[6],E=e[7],A=s,w=n[0],C=n[1],_=n[2],P=o,k=a,U=c,$=u,L=l,M=d,D=f,T=h,O=g,m=p,b=y,v=E,S=A,I=w,x=C,B=_;for(let W=0;W<i;W+=2)P=P+L|0,S=We(S^P,16),O=O+S|0,L=We(L^O,12),P=P+L|0,S=We(S^P,8),O=O+S|0,L=We(L^O,7),k=k+M|0,I=We(I^k,16),m=m+I|0,M=We(M^m,12),k=k+M|0,I=We(I^k,8),m=m+I|0,M=We(M^m,7),U=U+D|0,x=We(x^U,16),b=b+x|0,D=We(D^b,12),U=U+D|0,x=We(x^U,8),b=b+x|0,D=We(D^b,7),$=$+T|0,B=We(B^$,16),v=v+B|0,T=We(T^v,12),$=$+T|0,B=We(B^$,8),v=v+B|0,T=We(T^v,7),P=P+M|0,B=We(B^P,16),b=b+B|0,M=We(M^b,12),P=P+M|0,B=We(B^P,8),b=b+B|0,M=We(M^b,7),k=k+D|0,S=We(S^k,16),v=v+S|0,D=We(D^v,12),k=k+D|0,S=We(S^k,8),v=v+S|0,D=We(D^v,7),U=U+T|0,I=We(I^U,16),O=O+I|0,T=We(T^O,12),U=U+T|0,I=We(I^U,8),O=O+I|0,T=We(T^O,7),$=$+L|0,x=We(x^$,16),m=m+x|0,L=We(L^m,12),$=$+L|0,x=We(x^$,8),m=m+x|0,L=We(L^m,7);let F=0;r[F++]=o+P|0,r[F++]=a+k|0,r[F++]=c+U|0,r[F++]=u+$|0,r[F++]=l+L|0,r[F++]=d+M|0,r[F++]=f+D|0,r[F++]=h+T|0,r[F++]=g+O|0,r[F++]=p+m|0,r[F++]=y+b|0,r[F++]=E+v|0,r[F++]=A+S|0,r[F++]=w+I|0,r[F++]=C+x|0,r[F++]=_+B|0}const Vz=jz(Wz,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Kz=new Uint8Array(16),Tv=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(Kz.subarray(n))},Gz=new Uint8Array(32);function Nv(t,e,n,r,s){const i=t(e,n,Gz),o=Hz.create(i);s&&Tv(o,s),Tv(o,r);const a=kz(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return kc(i,a),c}const Yz=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=Av(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=Nv(t,e,n,a,r);return i.set(c,o),kc(c),i},decrypt(s,i){i=Av(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Nv(t,e,n,o,r);if(!Oz(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),kc(c),i}}),V6=Rz({blockSize:64,nonceLength:12,tagLength:16},Yz(Vz));let K6=class extends ap{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,op(e);const r=Kr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Tr(i)}update(e){return ao(this),this.iHash.update(e),this}digestInto(e){ao(this),Qr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const lp=(t,e,n)=>new K6(t,e).update(n).digest();lp.create=(t,e)=>new K6(t,e);function Zz(t,e,n){return op(t),n===void 0&&(n=new Uint8Array(t.outputLen)),lp(t,Kr(n),Kr(e))}const W0=Uint8Array.from([0]),xv=Uint8Array.of();function Jz(t,e,n,r=32){op(t),yi(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=xv);const o=new Uint8Array(i*s),a=lp.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let l=0;l<i;l++)W0[0]=l+1,c.update(l===0?xv:u).update(n).update(W0).digestInto(u),o.set(u,s*l),a._cloneInto(c);return a.destroy(),c.destroy(),Tr(u,W0),o.slice(0,r)}const Xz=(t,e,n,r,s)=>Jz(t,Zz(t,e,n),r,s),dp=cp,nw=BigInt(0),Lm=BigInt(1);function Xf(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function Uo(t,e,n=""){const r=ip(t),s=t?.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,a=i?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function wd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function G6(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?nw:BigInt("0x"+t)}function fp(t){return G6(nc(t))}function Qf(t){return Qr(t),G6(nc(Uint8Array.from(t).reverse()))}function rw(t,e){return Zf(t.toString(16).padStart(e*2,"0"))}function sw(t,e){return rw(t,e).reverse()}function dn(t,e,n){let r;if(typeof e=="string")try{r=Zf(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(ip(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const V0=t=>typeof t=="bigint"&&nw<=t;function Qz(t,e,n){return V0(t)&&V0(e)&&V0(n)&&e<=t&&t<n}function Fm(t,e,n,r){if(!Qz(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function Y6(t){let e;for(e=0;t>nw;t>>=Lm,e+=1);return e}const Vl=t=>(Lm<<BigInt(t))-Lm;function eH(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=f=>new Uint8Array(f),s=f=>Uint8Array.of(f);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},u=(...f)=>n(o,i,...f),l=(f=r(0))=>{o=u(s(0),f),i=u(),f.length!==0&&(o=u(s(1),f),i=u())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const h=[];for(;f<e;){i=u();const g=i.slice();h.push(g),f+=i.length}return Fi(...h)};return(f,h)=>{c(),l(f);let g;for(;!(g=h(d()));)l();return c(),g}}function hp(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function Pv(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const qn=BigInt(0),Cn=BigInt(1),Bo=BigInt(2),Z6=BigInt(3),J6=BigInt(4),X6=BigInt(5),tH=BigInt(7),Q6=BigInt(8),nH=BigInt(9),eT=BigInt(16);function tr(t,e){const n=t%e;return n>=qn?n:e+n}function Dr(t,e,n){let r=t;for(;e-- >qn;)r*=r,r%=n;return r}function Ov(t,e){if(t===qn)throw new Error("invert: expected non-zero number");if(e<=qn)throw new Error("invert: expected positive modulus, got "+e);let n=tr(t,e),r=e,s=qn,i=Cn;for(;n!==qn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Cn)throw new Error("invert: does not exist");return tr(s,e)}function iw(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function tT(t,e){const n=(t.ORDER+Cn)/J6,r=t.pow(e,n);return iw(t,r,e),r}function rH(t,e){const n=(t.ORDER-X6)/Q6,r=t.mul(e,Bo),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Bo),s),a=t.mul(i,t.sub(o,t.ONE));return iw(t,a,e),a}function sH(t){const e=ho(t),n=nT(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+tH)/eT;return(a,c)=>{let u=a.pow(c,o),l=a.mul(u,r);const d=a.mul(u,s),f=a.mul(u,i),h=a.eql(a.sqr(l),c),g=a.eql(a.sqr(d),c);u=a.cmov(u,l,h),l=a.cmov(f,d,g);const p=a.eql(a.sqr(l),c),y=a.cmov(u,l,p);return iw(a,y,c),y}}function nT(t){if(t<Z6)throw new Error("sqrt is not defined for small field");let e=t-Cn,n=0;for(;e%Bo===qn;)e/=Bo,n++;let r=Bo;const s=ho(t);for(;Rv(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return tT;let i=s.pow(r,e);const o=(e+Cn)/Bo;return function(a,c){if(a.is0(c))return c;if(Rv(a,c)!==1)throw new Error("Cannot find square root");let u=n,l=a.mul(a.ONE,i),d=a.pow(c,e),f=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let h=1,g=a.sqr(d);for(;!a.eql(g,a.ONE);)if(h++,g=a.sqr(g),h===u)throw new Error("Cannot find square root");const p=Cn<<BigInt(u-h-1),y=a.pow(l,p);u=h,l=a.sqr(y),d=a.mul(d,l),f=a.mul(f,y)}return f}}function iH(t){return t%J6===Z6?tT:t%Q6===X6?rH:t%eT===nH?sH(t):nT(t)}const oH=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function aH(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=oH.reduce((r,s)=>(r[s]="function",r),e);return hp(t,n),t}function cH(t,e,n){if(n<qn)throw new Error("invalid exponent, negatives unsupported");if(n===qn)return t.ONE;if(n===Cn)return e;let r=t.ONE,s=e;for(;n>qn;)n&Cn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Cn;return r}function rT(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function Rv(t,e){const n=(t.ORDER-Cn)/Bo,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function sT(t,e){e!==void 0&&yi(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function ho(t,e,n=!1,r={}){if(t<=qn)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(s=f.BITS),f.sqrt&&(i=f.sqrt),typeof f.isLE=="boolean"&&(n=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),a=f.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:c,nByteLength:u}=sT(t,s);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const d=Object.freeze({ORDER:t,isLE:n,BITS:c,BYTES:u,MASK:Vl(c),ZERO:qn,ONE:Cn,allowedLengths:a,create:f=>tr(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return qn<=f&&f<t},is0:f=>f===qn,isValidNot0:f=>!d.is0(f)&&d.isValid(f),isOdd:f=>(f&Cn)===Cn,neg:f=>tr(-f,t),eql:(f,h)=>f===h,sqr:f=>tr(f*f,t),add:(f,h)=>tr(f+h,t),sub:(f,h)=>tr(f-h,t),mul:(f,h)=>tr(f*h,t),pow:(f,h)=>cH(d,f,h),div:(f,h)=>tr(f*Ov(h,t),t),sqrN:f=>f*f,addN:(f,h)=>f+h,subN:(f,h)=>f-h,mulN:(f,h)=>f*h,inv:f=>Ov(f,t),sqrt:i||(f=>(l||(l=iH(t)),l(d,f))),toBytes:f=>n?sw(f,u):rw(f,u),fromBytes:(f,h=!0)=>{if(a){if(!a.includes(f.length)||f.length>u)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);const p=new Uint8Array(u);p.set(f,n?0:p.length-f.length),f=p}if(f.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+f.length);let g=n?Qf(f):fp(f);if(o&&(g=tr(g,t)),!h&&!d.isValid(g))throw new Error("invalid field element: outside of range 0..ORDER");return g},invertBatch:f=>rT(d,f),cmov:(f,h,g)=>g?h:f});return Object.freeze(d)}function iT(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function oT(t){const e=iT(t);return e+Math.ceil(e/2)}function uH(t,e,n=!1){const r=t.length,s=iT(e),i=oT(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Qf(t):fp(t),a=tr(o,e-Cn)+Cn;return n?sw(a,s):rw(a,s)}const $c=BigInt(0),Mo=BigInt(1);function eh(t,e){const n=e.negate();return t?n:e}function K0(t,e){const n=rT(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function aT(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function G0(t,e){aT(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Vl(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function kv(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Mo);const u=e*r,l=u+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:f,isNegF:h,offsetF:u}}function lH(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function dH(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Y0=new WeakMap,cT=new WeakMap;function Z0(t){return cT.get(t)||1}function $v(t){if(t!==$c)throw new Error("invalid wNAF")}class fH{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>$c;)n&Mo&&(r=r.add(s)),s=s.double(),n>>=Mo;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=G0(n,this.bits),i=[];let o=e,a=o;for(let c=0;c<r;c++){a=o,i.push(a);for(let u=1;u<s;u++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=G0(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:u,isZero:l,isNeg:d,isNegF:f,offsetF:h}=kv(r,a,o);r=c,l?i=i.add(eh(f,n[h])):s=s.add(eh(d,n[u]))}return $v(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=G0(e,this.bits);for(let o=0;o<i.windows&&r!==$c;o++){const{nextN:a,offset:c,isZero:u,isNeg:l}=kv(r,o,i);if(r=a,!u){const d=n[c];s=s.add(l?d.negate():d)}}return $v(r),s}getPrecomputes(e,n,r){let s=Y0.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),Y0.set(n,s))),s}cached(e,n,r){const s=Z0(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=Z0(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){aT(n,this.bits),cT.set(e,n),Y0.delete(e)}hasCache(e){return Z0(e)!==1}}function hH(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>$c||r>$c;)n&Mo&&(i=i.add(s)),r&Mo&&(o=o.add(s)),s=s.double(),n>>=Mo,r>>=Mo;return{p1:i,p2:o}}function pH(t,e,n,r){lH(n,t),dH(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=Y6(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=Vl(c),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){l.fill(o);for(let p=0;p<i;p++){const y=r[p],E=Number(y>>BigInt(h)&u);l[E]=l[E].add(n[p])}let g=o;for(let p=l.length-1,y=o;p>0;p--)y=y.add(l[p]),g=g.add(y);if(f=f.add(g),h!==0)for(let p=0;p<c;p++)f=f.double()}return f}function Dv(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return aH(e),e}else return ho(t,{isLE:n})}function gH(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>$c))throw new Error(`CURVE.${a} must be positive bigint`)}const s=Dv(e.p,n.Fp,r),i=Dv(e.n,n.Fn,r),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),O6("HashToScalar-");const iu=BigInt(0),xa=BigInt(1),Ed=BigInt(2);function mH(t){return hp(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function yH(t){const e=mH(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||wa,u=a?255:448,l=a?32:56,d=BigInt(a?9:5),f=BigInt(a?121665:39081),h=a?Ed**BigInt(254):Ed**BigInt(447),g=a?BigInt(8)*Ed**BigInt(251)-xa:BigInt(4)*Ed**BigInt(445)-xa,p=h+g+xa,y=D=>tr(D,n),E=A(d);function A(D){return sw(y(D),l)}function w(D){const T=dn("u coordinate",D,l);return a&&(T[31]&=127),y(Qf(T))}function C(D){return Qf(s(dn("scalar",D,l)))}function _(D,T){const O=U(w(T),C(D));if(O===iu)throw new Error("invalid private or public key received");return A(O)}function P(D){return _(D,E)}function k(D,T,O){const m=y(D*(T-O));return T=y(T-m),O=y(O+m),{x_2:T,x_3:O}}function U(D,T){Fm("u",D,iu,n),Fm("scalar",T,h,p);const O=T,m=D;let b=xa,v=iu,S=D,I=xa,x=iu;for(let F=BigInt(u-1);F>=iu;F--){const W=O>>F&xa;x^=W,{x_2:b,x_3:S}=k(x,b,S),{x_2:v,x_3:I}=k(x,v,I),x=W;const j=b+v,q=y(j*j),Y=b-v,Q=y(Y*Y),ue=q-Q,J=S+I,te=S-I,Ae=y(te*j),Oe=y(J*Y),Be=Ae+Oe,rt=Ae-Oe;S=y(Be*Be),I=y(m*y(rt*rt)),b=y(q*Q),v=y(ue*(q+y(f*ue)))}({x_2:b,x_3:S}=k(x,b,S)),{x_2:v,x_3:I}=k(x,v,I);const B=i(v);return y(b*B)}const $={secretKey:l,publicKey:l,seed:l},L=(D=c(l))=>(Qr(D,$.seed),D);function M(D){const T=L(D);return{secretKey:T,publicKey:P(T)}}return{keygen:M,getSharedSecret:(D,T)=>_(D,T),getPublicKey:D=>P(D),scalarMult:_,scalarMultBase:P,utils:{randomSecretKey:L,randomPrivateKey:L},GuBytes:E.slice(),lengths:$}}const bH=BigInt(1),Uv=BigInt(2),wH=BigInt(3),EH=BigInt(5);BigInt(8);const uT=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),vH={p:uT,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function CH(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=uT,o=t*t%i*t%i,a=Dr(o,Uv,i)*o%i,c=Dr(a,bH,i)*t%i,u=Dr(c,EH,i)*c%i,l=Dr(u,e,i)*u%i,d=Dr(l,n,i)*l%i,f=Dr(d,r,i)*d%i,h=Dr(f,s,i)*f%i,g=Dr(h,s,i)*f%i,p=Dr(g,e,i)*u%i;return{pow_p_5_8:Dr(p,Uv,i)*t%i,b2:o}}function _H(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const AH=ho(vH.p,{isLE:!0}),jm=(()=>{const t=AH.ORDER;return yH({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=CH(e);return tr(Dr(n,wH,t)*r,t)},adjustScalarBytes:_H})})(),Bv=(t,e)=>(t+(t>=0?e:-e)/lT)/e;function SH(t,e,n){const[[r,s],[i,o]]=e,a=Bv(o*t,n),c=Bv(-s*t,n);let u=t-a*r-c*i,l=-a*s-c*o;const d=u<ni,f=l<ni;d&&(u=-u),f&&(l=-l);const h=Vl(Math.ceil(Y6(n)/2))+rc;if(u<ni||u>=h||l<ni||l>=h)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:u,k2neg:f,k2:l}}function qm(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function J0(t,e){const n={};for(let r of Object.keys(e))n[r]=t[r]===void 0?e[r]:t[r];return Xf(n.lowS,"lowS"),Xf(n.prehash,"prehash"),n.format!==void 0&&qm(n.format),n}class IH extends Error{constructor(e=""){super(e)}}const Js={Err:IH,_tlv:{encode:(t,e)=>{const{Err:n}=Js;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=wd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?wd(s.length/2|128):"";return wd(t)+i+s+e},decode(t,e){const{Err:n}=Js;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const u=e.subarray(r,r+c);if(u.length!==c)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Js;if(t<ni)throw new e("integer: negative integers are not allowed");let n=wd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Js;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return fp(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Js,s=dn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:u,l}=r.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(u)}},hexFromSig(t){const{_tlv:e,_int:n}=Js,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},ni=BigInt(0),rc=BigInt(1),lT=BigInt(2),vd=BigInt(3),TH=BigInt(4);function Ha(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=dn("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function NH(t,e={}){const n=gH("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:a}=i;hp(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=fT(r,s);function l(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(D,T,O){const{x:m,y:b}=T.toAffine(),v=r.toBytes(m);if(Xf(O,"isCompressed"),O){l();const S=!r.isOdd(b);return Fi(dT(S),v)}else return Fi(Uint8Array.of(4),v,r.toBytes(b))}function f(D){Uo(D,void 0,"Point");const{publicKey:T,publicKeyUncompressed:O}=u,m=D.length,b=D[0],v=D.subarray(1);if(m===T&&(b===2||b===3)){const S=r.fromBytes(v);if(!r.isValid(S))throw new Error("bad point: is not on curve, wrong x");const I=p(S);let x;try{x=r.sqrt(I)}catch(F){const W=F instanceof Error?": "+F.message:"";throw new Error("bad point: is not on curve, sqrt error"+W)}l();const B=r.isOdd(x);return(b&1)===1!==B&&(x=r.neg(x)),{x:S,y:x}}else if(m===O&&b===4){const S=r.BYTES,I=r.fromBytes(v.subarray(0,S)),x=r.fromBytes(v.subarray(S,S*2));if(!y(I,x))throw new Error("bad point: is not on curve");return{x:I,y:x}}else throw new Error(`bad point: got length ${m}, expected compressed=${T} or uncompressed=${O}`)}const h=e.toBytes||d,g=e.fromBytes||f;function p(D){const T=r.sqr(D),O=r.mul(T,D);return r.add(r.add(O,r.mul(D,i.a)),i.b)}function y(D,T){const O=r.sqr(T),m=p(D);return r.eql(O,m)}if(!y(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const E=r.mul(r.pow(i.a,vd),TH),A=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(E,A)))throw new Error("bad curve params: a or b");function w(D,T,O=!1){if(!r.isValid(T)||O&&r.is0(T))throw new Error(`bad point coordinate ${D}`);return T}function C(D){if(!(D instanceof $))throw new Error("ProjectivePoint expected")}function _(D){if(!c||!c.basises)throw new Error("no endo");return SH(D,c.basises,s.ORDER)}const P=Pv((D,T)=>{const{X:O,Y:m,Z:b}=D;if(r.eql(b,r.ONE))return{x:O,y:m};const v=D.is0();T==null&&(T=v?r.ONE:r.inv(b));const S=r.mul(O,T),I=r.mul(m,T),x=r.mul(b,T);if(v)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:S,y:I}}),k=Pv(D=>{if(D.is0()){if(e.allowInfinityPoint&&!r.is0(D.Y))return;throw new Error("bad point: ZERO")}const{x:T,y:O}=D.toAffine();if(!r.isValid(T)||!r.isValid(O))throw new Error("bad point: x or y not field elements");if(!y(T,O))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function U(D,T,O,m,b){return O=new $(r.mul(O.X,D),O.Y,O.Z),T=eh(m,T),O=eh(b,O),T.add(O)}class ${constructor(T,O,m){this.X=w("x",T),this.Y=w("y",O,!0),this.Z=w("z",m),Object.freeze(this)}static CURVE(){return i}static fromAffine(T){const{x:O,y:m}=T||{};if(!T||!r.isValid(O)||!r.isValid(m))throw new Error("invalid affine point");if(T instanceof $)throw new Error("projective point not allowed");return r.is0(O)&&r.is0(m)?$.ZERO:new $(O,m,r.ONE)}static fromBytes(T){const O=$.fromAffine(g(Uo(T,void 0,"point")));return O.assertValidity(),O}static fromHex(T){return $.fromBytes(dn("pointHex",T))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(T=8,O=!0){return M.createCache(this,T),O||this.multiply(vd),this}assertValidity(){k(this)}hasEvenY(){const{y:T}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(T)}equals(T){C(T);const{X:O,Y:m,Z:b}=this,{X:v,Y:S,Z:I}=T,x=r.eql(r.mul(O,I),r.mul(v,b)),B=r.eql(r.mul(m,I),r.mul(S,b));return x&&B}negate(){return new $(this.X,r.neg(this.Y),this.Z)}double(){const{a:T,b:O}=i,m=r.mul(O,vd),{X:b,Y:v,Z:S}=this;let I=r.ZERO,x=r.ZERO,B=r.ZERO,F=r.mul(b,b),W=r.mul(v,v),j=r.mul(S,S),q=r.mul(b,v);return q=r.add(q,q),B=r.mul(b,S),B=r.add(B,B),I=r.mul(T,B),x=r.mul(m,j),x=r.add(I,x),I=r.sub(W,x),x=r.add(W,x),x=r.mul(I,x),I=r.mul(q,I),B=r.mul(m,B),j=r.mul(T,j),q=r.sub(F,j),q=r.mul(T,q),q=r.add(q,B),B=r.add(F,F),F=r.add(B,F),F=r.add(F,j),F=r.mul(F,q),x=r.add(x,F),j=r.mul(v,S),j=r.add(j,j),F=r.mul(j,q),I=r.sub(I,F),B=r.mul(j,W),B=r.add(B,B),B=r.add(B,B),new $(I,x,B)}add(T){C(T);const{X:O,Y:m,Z:b}=this,{X:v,Y:S,Z:I}=T;let x=r.ZERO,B=r.ZERO,F=r.ZERO;const W=i.a,j=r.mul(i.b,vd);let q=r.mul(O,v),Y=r.mul(m,S),Q=r.mul(b,I),ue=r.add(O,m),J=r.add(v,S);ue=r.mul(ue,J),J=r.add(q,Y),ue=r.sub(ue,J),J=r.add(O,b);let te=r.add(v,I);return J=r.mul(J,te),te=r.add(q,Q),J=r.sub(J,te),te=r.add(m,b),x=r.add(S,I),te=r.mul(te,x),x=r.add(Y,Q),te=r.sub(te,x),F=r.mul(W,J),x=r.mul(j,Q),F=r.add(x,F),x=r.sub(Y,F),F=r.add(Y,F),B=r.mul(x,F),Y=r.add(q,q),Y=r.add(Y,q),Q=r.mul(W,Q),J=r.mul(j,J),Y=r.add(Y,Q),Q=r.sub(q,Q),Q=r.mul(W,Q),J=r.add(J,Q),q=r.mul(Y,J),B=r.add(B,q),q=r.mul(te,J),x=r.mul(ue,x),x=r.sub(x,q),q=r.mul(ue,Y),F=r.mul(te,F),F=r.add(F,q),new $(x,B,F)}subtract(T){return this.add(T.negate())}is0(){return this.equals($.ZERO)}multiply(T){const{endo:O}=e;if(!s.isValidNot0(T))throw new Error("invalid scalar: out of range");let m,b;const v=S=>M.cached(this,S,I=>K0($,I));if(O){const{k1neg:S,k1:I,k2neg:x,k2:B}=_(T),{p:F,f:W}=v(I),{p:j,f:q}=v(B);b=W.add(q),m=U(O.beta,F,j,S,x)}else{const{p:S,f:I}=v(T);m=S,b=I}return K0($,[m,b])[0]}multiplyUnsafe(T){const{endo:O}=e,m=this;if(!s.isValid(T))throw new Error("invalid scalar: out of range");if(T===ni||m.is0())return $.ZERO;if(T===rc)return m;if(M.hasCache(this))return this.multiply(T);if(O){const{k1neg:b,k1:v,k2neg:S,k2:I}=_(T),{p1:x,p2:B}=hH($,m,v,I);return U(O.beta,x,B,b,S)}else return M.unsafe(m,T)}multiplyAndAddUnsafe(T,O,m){const b=this.multiplyUnsafe(O).add(T.multiplyUnsafe(m));return b.is0()?void 0:b}toAffine(T){return P(this,T)}isTorsionFree(){const{isTorsionFree:T}=e;return o===rc?!0:T?T($,this):M.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:T}=e;return o===rc?this:T?T($,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(T=!0){return Xf(T,"isCompressed"),this.assertValidity(),h($,this,T)}toHex(T=!0){return nc(this.toBytes(T))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(T=!0){return this.toBytes(T)}_setWindowSize(T){this.precompute(T)}static normalizeZ(T){return K0($,T)}static msm(T,O){return pH($,s,T,O)}static fromPrivateKey(T){return $.BASE.multiply(Ha(s,T))}}$.BASE=new $(i.Gx,i.Gy,r.ONE),$.ZERO=new $(r.ZERO,r.ONE,r.ZERO),$.Fp=r,$.Fn=s;const L=s.BITS,M=new fH($,e.endo?Math.ceil(L/2):L);return $.BASE.precompute(8),$}function dT(t){return Uint8Array.of(t?2:3)}function fT(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function xH(t,e={}){const{Fn:n}=t,r=e.randomBytes||wa,s=Object.assign(fT(t.Fp,n),{seed:oT(n.ORDER)});function i(f){try{return!!Ha(n,f)}catch{return!1}}function o(f,h){const{publicKey:g,publicKeyUncompressed:p}=s;try{const y=f.length;return h===!0&&y!==g||h===!1&&y!==p?!1:!!t.fromBytes(f)}catch{return!1}}function a(f=r(s.seed)){return uH(Uo(f,s.seed,"seed"),n.ORDER)}function c(f,h=!0){return t.BASE.multiply(Ha(n,f)).toBytes(h)}function u(f){const h=a(f);return{secretKey:h,publicKey:c(h)}}function l(f){if(typeof f=="bigint")return!1;if(f instanceof t)return!0;const{secretKey:h,publicKey:g,publicKeyUncompressed:p}=s;if(n.allowedLengths||h===g)return;const y=dn("key",f).length;return y===g||y===p}function d(f,h,g=!0){if(l(f)===!0)throw new Error("first arg must be private key");if(l(h)===!1)throw new Error("second arg must be public key");const p=Ha(n,f);return t.fromHex(h).multiply(p).toBytes(g)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:u,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:f=>Ha(n,f),precompute(f=8,h=t.BASE){return h.precompute(f,!1)}},lengths:s})}function PH(t,e,n={}){op(e),hp(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||wa,s=n.hmac||((O,...m)=>lp(e,O,Fi(...m))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:u,getPublicKey:l,getSharedSecret:d,utils:f,lengths:h}=xH(t,n),g={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},p="compact";function y(O){const m=a>>rc;return O>m}function E(O,m){if(!o.isValidNot0(m))throw new Error(`invalid signature ${O}: out of range 1..Point.Fn.ORDER`);return m}function A(O,m){qm(m);const b=h.signature,v=m==="compact"?b:m==="recovered"?b+1:void 0;return Uo(O,v,`${m} signature`)}class w{constructor(m,b,v){this.r=E("r",m),this.s=E("s",b),v!=null&&(this.recovery=v),Object.freeze(this)}static fromBytes(m,b=p){A(m,b);let v;if(b==="der"){const{r:B,s:F}=Js.toSig(Uo(m));return new w(B,F)}b==="recovered"&&(v=m[0],b="compact",m=m.subarray(1));const S=o.BYTES,I=m.subarray(0,S),x=m.subarray(S,S*2);return new w(o.fromBytes(I),o.fromBytes(x),v)}static fromHex(m,b){return this.fromBytes(Zf(m),b)}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){const b=i.ORDER,{r:v,s:S,recovery:I}=this;if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");if(a*lT<b&&I>1)throw new Error("recovery id is ambiguous for h>1 curve");const x=I===2||I===3?v+a:v;if(!i.isValid(x))throw new Error("recovery id 2 or 3 invalid");const B=i.toBytes(x),F=t.fromBytes(Fi(dT((I&1)===0),B)),W=o.inv(x),j=_(dn("msgHash",m)),q=o.create(-j*W),Y=o.create(S*W),Q=t.BASE.multiplyUnsafe(q).add(F.multiplyUnsafe(Y));if(Q.is0())throw new Error("point at infinify");return Q.assertValidity(),Q}hasHighS(){return y(this.s)}toBytes(m=p){if(qm(m),m==="der")return Zf(Js.hexFromSig(this));const b=o.toBytes(this.r),v=o.toBytes(this.s);if(m==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Fi(Uint8Array.of(this.recovery),b,v)}return Fi(b,v)}toHex(m){return nc(this.toBytes(m))}assertValidity(){}static fromCompact(m){return w.fromBytes(dn("sig",m),"compact")}static fromDER(m){return w.fromBytes(dn("sig",m),"der")}normalizeS(){return this.hasHighS()?new w(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return nc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return nc(this.toBytes("compact"))}}const C=n.bits2int||function(O){if(O.length>8192)throw new Error("input is too large");const m=fp(O),b=O.length*8-c;return b>0?m>>BigInt(b):m},_=n.bits2int_modN||function(O){return o.create(C(O))},P=Vl(c);function k(O){return Fm("num < 2^"+c,O,ni,P),o.toBytes(O)}function U(O,m){return Uo(O,void 0,"message"),m?Uo(e(O),void 0,"prehashed message"):O}function $(O,m,b){if(["recovered","canonical"].some(Y=>Y in b))throw new Error("sign() legacy options not supported");const{lowS:v,prehash:S,extraEntropy:I}=J0(b,g);O=U(O,S);const x=_(O),B=Ha(o,m),F=[k(B),k(x)];if(I!=null&&I!==!1){const Y=I===!0?r(h.secretKey):I;F.push(dn("extraEntropy",Y))}const W=Fi(...F),j=x;function q(Y){const Q=C(Y);if(!o.isValidNot0(Q))return;const ue=o.inv(Q),J=t.BASE.multiply(Q).toAffine(),te=o.create(J.x);if(te===ni)return;const Ae=o.create(ue*o.create(j+te*B));if(Ae===ni)return;let Oe=(J.x===te?0:2)|Number(J.y&rc),Be=Ae;return v&&y(Ae)&&(Be=o.neg(Ae),Oe^=1),new w(te,Be,Oe)}return{seed:W,k2sig:q}}function L(O,m,b={}){O=dn("message",O);const{seed:v,k2sig:S}=$(O,m,b);return eH(e.outputLen,o.BYTES,s)(v,S)}function M(O){let m;const b=typeof O=="string"||ip(O),v=!b&&O!==null&&typeof O=="object"&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!b&&!v)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(v)m=new w(O.r,O.s);else if(b){try{m=w.fromBytes(dn("sig",O),"der")}catch(S){if(!(S instanceof Js.Err))throw S}if(!m)try{m=w.fromBytes(dn("sig",O),"compact")}catch{return!1}}return m||!1}function D(O,m,b,v={}){const{lowS:S,prehash:I,format:x}=J0(v,g);if(b=dn("publicKey",b),m=U(dn("message",m),I),"strict"in v)throw new Error("options.strict was renamed to lowS");const B=x===void 0?M(O):w.fromBytes(dn("sig",O),x);if(B===!1)return!1;try{const F=t.fromBytes(b);if(S&&B.hasHighS())return!1;const{r:W,s:j}=B,q=_(m),Y=o.inv(j),Q=o.create(q*Y),ue=o.create(W*Y),J=t.BASE.multiplyUnsafe(Q).add(F.multiplyUnsafe(ue));return J.is0()?!1:o.create(J.x)===W}catch{return!1}}function T(O,m,b={}){const{prehash:v}=J0(b,g);return m=U(m,v),w.fromBytes(O,"recovered").recoverPublicKey(m).toBytes()}return Object.freeze({keygen:u,getPublicKey:l,getSharedSecret:d,utils:f,lengths:h,Point:t,sign:L,verify:D,recoverPublicKey:T,Signature:w,hash:e})}function OH(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=ho(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function RH(t){const{CURVE:e,curveOpts:n}=OH(t),r={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,hash:t.hash,ecdsaOpts:r}}function kH(t,e){const n=e.Point;return Object.assign({},e,{ProjectivePoint:n,CURVE:Object.assign({},t,sT(n.Fn.ORDER,n.Fn.BITS))})}function $H(t){const{CURVE:e,curveOpts:n,hash:r,ecdsaOpts:s}=RH(t),i=NH(e,n),o=PH(i,r,s);return kH(t,o)}function zm(t,e){const n=r=>$H({...t,hash:r});return{...n(e),create:n}}const hT={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},pT={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},gT={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},DH=ho(hT.p),UH=ho(pT.p),BH=ho(gT.p),MH=zm({...hT,Fp:DH,lowS:!1},cp);zm({...pT,Fp:UH,lowS:!1},zq),zm({...gT,Fp:BH,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},qq);const LH=MH,mT="base10",_n="base16",Mn="base64pad",ji="base64url",Kl="utf8",yT=0,ci=1,Gl=2,FH=0,Mv=1,Pu=12,ow=32;function jH(){const t=jm.utils.randomPrivateKey(),e=jm.getPublicKey(t);return{privateKey:zn(t,_n),publicKey:zn(e,_n)}}function Hm(){const t=wa(ow);return zn(t,_n)}function qH(t,e){const n=jm.getSharedSecret(Cr(t,_n),Cr(e,_n)),r=Xz(dp,n,void 0,void 0,ow);return zn(r,_n)}function Yd(t){const e=dp(Cr(t,_n));return zn(e,_n)}function Er(t){const e=dp(Cr(t,Kl));return zn(e,_n)}function bT(t){return Cr(`${t}`,mT)}function ia(t){return Number(zn(t,mT))}function wT(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ET(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function zH(t){const e=bT(typeof t.type<"u"?t.type:yT);if(ia(e)===ci&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Cr(t.senderPublicKey,_n):void 0,r=typeof t.iv<"u"?Cr(t.iv,_n):wa(Pu),s=Cr(t.symKey,_n),i=V6(s,r).encrypt(Cr(t.message,Kl)),o=vT({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===ji?wT(o):o}function HH(t){const e=Cr(t.symKey,_n),{sealed:n,iv:r}=dl({encoded:t.encoded,encoding:t.encoding}),s=V6(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return zn(s,Kl)}function WH(t,e){const n=bT(Gl),r=wa(Pu),s=Cr(t,Kl),i=vT({type:n,sealed:s,iv:r});return e===ji?wT(i):i}function VH(t,e){const{sealed:n}=dl({encoded:t,encoding:e});return zn(n,Kl)}function vT(t){if(ia(t.type)===Gl)return zn(xu([t.type,t.sealed]),Mn);if(ia(t.type)===ci){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return zn(xu([t.type,t.senderPublicKey,t.iv,t.sealed]),Mn)}return zn(xu([t.type,t.iv,t.sealed]),Mn)}function dl(t){const e=(t.encoding||Mn)===ji?ET(t.encoded):t.encoded,n=Cr(e,Mn),r=n.slice(FH,Mv),s=Mv;if(ia(r)===ci){const c=s+ow,u=c+Pu,l=n.slice(s,c),d=n.slice(c,u),f=n.slice(u);return{type:r,sealed:f,iv:d,senderPublicKey:l}}if(ia(r)===Gl){const c=n.slice(s),u=wa(Pu);return{type:r,sealed:c,iv:u}}const i=s+Pu,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function KH(t,e){const n=dl({encoded:t,encoding:e?.encoding});return CT({type:ia(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?zn(n.senderPublicKey,_n):void 0,receiverPublicKey:e?.receiverPublicKey})}function CT(t){const e=t?.type||yT;if(e===ci){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Lv(t){return t.type===ci&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Fv(t){return t.type===Gl}function GH(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return xu([new Uint8Array([4]),e,n])}function YH(t,e){const[n,r,s]=t.split("."),i=Buffer.from(ET(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,u=dp(c),l=GH(e);if(!LH.verify(xu([o,a]),u,l))throw new Error("Invalid signature");return Em(t).payload}const ZH="irn";function th(t){return t?.relay||{protocol:ZH}}function Wa(t){const e=Pj[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var JH=Object.defineProperty,XH=Object.defineProperties,QH=Object.getOwnPropertyDescriptors,jv=Object.getOwnPropertySymbols,eW=Object.prototype.hasOwnProperty,tW=Object.prototype.propertyIsEnumerable,qv=(t,e,n)=>e in t?JH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X0=(t,e)=>{for(var n in e||(e={}))eW.call(e,n)&&qv(t,n,e[n]);if(jv)for(var n of jv(e))tW.call(e,n)&&qv(t,n,e[n]);return t},nW=(t,e)=>XH(t,QH(e));function rW(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function zv(t){if(!t.includes("wc:")){const u=S6(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:sW(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:rW(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function sW(t){return t.startsWith("//")?t.substring(2):t}function iW(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function Hv(t){const e=new URLSearchParams,n=X0(X0(nW(X0({},iW(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(n).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!==void 0&&e.append(r,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function Cd(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var oW=Object.defineProperty,aW=Object.defineProperties,cW=Object.getOwnPropertyDescriptors,Wv=Object.getOwnPropertySymbols,uW=Object.prototype.hasOwnProperty,lW=Object.prototype.propertyIsEnumerable,Vv=(t,e,n)=>e in t?oW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dW=(t,e)=>{for(var n in e||(e={}))uW.call(e,n)&&Vv(t,n,e[n]);if(Wv)for(var n of Wv(e))lW.call(e,n)&&Vv(t,n,e[n]);return t},fW=(t,e)=>aW(t,cW(e));function Gc(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function _T(t){const e=[];return Object.values(t).forEach(n=>{e.push(...Gc(n.accounts))}),[...new Set(e)]}function hW(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.methods)}),[...new Set(e)]}function pW(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.events)}),[...new Set(e)]}function gW(t,e){const n=[];return Object.values(t).forEach(r=>{Gc(r.accounts).includes(e)&&n.push(...r.methods)}),n}function mW(t,e){const n=[];return Object.values(t).forEach(r=>{Gc(r.accounts).includes(e)&&n.push(...r.events)}),n}function pp(t){return t.includes(":")}function Va(t){return pp(t)?t.split(":")[0]:t}function Kv(t){var e,n,r;const s={};if(!_s(t))return s;for(const[i,o]of Object.entries(t)){const a=pp(i)?[i]:o.chains,c=o.methods||[],u=o.events||[],l=Va(i);s[l]=fW(dW({},s[l]),{chains:Cs(a,(e=s[l])==null?void 0:e.chains),methods:Cs(c,(n=s[l])==null?void 0:n.methods),events:Cs(u,(r=s[l])==null?void 0:r.events)})}return s}function yW(t){const e={};return t?.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function Gv(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=yW(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=Cs(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function bW(t,e){var n,r,s,i,o,a;const c=Kv(t),u=Kv(e),l={},d=Object.keys(c).concat(Object.keys(u));for(const f of d)l[f]={chains:Cs((n=c[f])==null?void 0:n.chains,(r=u[f])==null?void 0:r.chains),methods:Cs((s=c[f])==null?void 0:s.methods,(i=u[f])==null?void 0:i.methods),events:Cs((o=c[f])==null?void 0:o.events,(a=u[f])==null?void 0:a.events)};return l}const wW={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},EW={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function se(t,e){const{message:n,code:r}=EW[t];return{message:e?`${n} ${e}`:n,code:r}}function ct(t,e){const{message:n,code:r}=wW[t];return{message:e?`${n} ${e}`:n,code:r}}function ui(t,e){return!!Array.isArray(t)}function _s(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function jt(t){return typeof t>"u"}function xt(t,e){return e&&jt(t)?!0:typeof t=="string"&&!!t.trim().length}function aw(t,e){return typeof t=="number"&&!isNaN(t)}function vW(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Do(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:u}=t.namespaces[o],l=Gc(a),d=n[o];(!Do(E6(o,d),l)||!Do(d.methods,c)||!Do(d.events,u))&&(i=!1)}),i):!1}function nh(t){return xt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function CW(t){if(xt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&nh(n)}}return!1}function _W(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(xt(t,!1)){if(e(t))return!0;const n=S6(t);return e(n)}}catch{}return!1}function AW(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function SW(t){return t?.topic}function IW(t,e){let n=null;return xt(t?.publicKey,!1)||(n=se("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function Yv(t){let e=!0;return ui(t)?t.length&&(e=t.every(n=>xt(n,!1))):e=!1,e}function TW(t,e,n){let r=null;return ui(e)&&e.length?e.forEach(s=>{r||nh(s)||(r=ct("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):nh(t)||(r=ct("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function NW(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=TW(s,E6(s,i),`${e} ${n}`);o&&(r=o)}),r}function xW(t,e){let n=null;return ui(t)?t.forEach(r=>{n||CW(r)||(n=ct("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=ct("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function PW(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=xW(r?.accounts,`${e} namespace`);s&&(n=s)}),n}function OW(t,e){let n=null;return Yv(t?.methods)?Yv(t?.events)||(n=ct("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=ct("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function AT(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=OW(r,`${e}, namespace`);s&&(n=s)}),n}function RW(t,e,n){let r=null;if(t&&_s(t)){const s=AT(t,e);s&&(r=s);const i=NW(t,e,n);i&&(r=i)}else r=se("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Q0(t,e){let n=null;if(t&&_s(t)){const r=AT(t,e);r&&(n=r);const s=PW(t,e);s&&(n=s)}else n=se("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function ST(t){return xt(t.protocol,!0)}function kW(t,e){let n=!1;return t?t&&ui(t)&&t.length&&t.forEach(r=>{n=ST(r)}):n=!0,n}function $W(t){return typeof t=="number"}function Rn(t){return typeof t<"u"&&typeof t!==null}function DW(t){return!(!t||typeof t!="object"||!t.code||!aw(t.code)||!t.message||!xt(t.message,!1))}function UW(t){return!(jt(t)||!xt(t.method,!1))}function BW(t){return!(jt(t)||jt(t.result)&&jt(t.error)||!aw(t.id)||!xt(t.jsonrpc,!1))}function MW(t){return!(jt(t)||!xt(t.name,!1))}function Zv(t,e){return!(!nh(e)||!_T(t).includes(e))}function LW(t,e,n){return xt(n,!1)?gW(t,e).includes(n):!1}function FW(t,e,n){return xt(n,!1)?mW(t,e).includes(n):!1}function Jv(t,e,n){let r=null;const s=jW(t),i=qW(e),o=Object.keys(s),a=Object.keys(i),c=Xv(Object.keys(t)),u=Xv(Object.keys(e)),l=c.filter(d=>!u.includes(d));return l.length&&(r=se("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),Do(o,a)||(r=se("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const f=Gc(e[d].accounts);f.includes(d)||(r=se("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${f.toString()}`))}),o.forEach(d=>{r||(Do(s[d].methods,i[d].methods)?Do(s[d].events,i[d].events)||(r=se("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=se("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function jW(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function Xv(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function qW(t){const e={};return Object.keys(t).forEach(n=>{n.includes(":")?e[n]=t[n]:Gc(t[n].accounts)?.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}),e}function zW(t,e){return aw(t)&&t<=e.max&&t>=e.min}function Qv(){const t=Hl();return new Promise(e=>{switch(t){case or.browser:e(HW());break;case or.reactNative:e(WW());break;case or.node:e(VW());break;default:e(!0)}})}function HW(){return Kc()&&navigator?.onLine}async function WW(){return fo()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo?(await globalThis?.NetInfo.fetch())?.isConnected:!0}function VW(){return!0}function KW(t){switch(Hl()){case or.browser:GW(t);break;case or.reactNative:YW(t);break}}function GW(t){!fo()&&Kc()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function YW(t){fo()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo&&globalThis?.NetInfo.addEventListener(e=>t(e?.isConnected))}function ZW(){var t;return Kc()&&mi.getDocument()?((t=mi.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const eg={};class ou{static get(e){return eg[e]}static set(e,n){eg[e]=n}static delete(e){delete eg[e]}}function JW(t){const e=Vc.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function XW({publicKey:t,signature:e,payload:n}){var r;const s=Wm(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=tV(n.address),a=n.era==="00"?new Uint8Array([0]):Wm(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),u=new Uint8Array([c&255,c>>8&255]),l=BigInt(`0x${eV(n.tip)}`),d=rV(l),f=new Uint8Array([0,...t,o,...e,...a,...u,...d,...s]),h=nV(f.length+1);return new Uint8Array([...h,i,...f])}function QW(t){const e=Wm(t),n=$j.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function Wm(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function eV(t){return t.startsWith("0x")?t.slice(2):t}function tV(t){const e=Vc.decode(t)[0];return e===42?0:e===60?2:1}function nV(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function rV(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function sV(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=JW(t.transaction.address),r=XW({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return QW(s)}function cw({logger:t,name:e}){const n=typeof t=="string"?hh({opts:{level:t,name:e}}).logger:t;return n.level=typeof t=="string"?t:t.level,n}const iV="PARSE_ERROR",oV="INVALID_REQUEST",aV="METHOD_NOT_FOUND",cV="INVALID_PARAMS",IT="INTERNAL_ERROR",uw="SERVER_ERROR",uV=[-32700,-32600,-32601,-32602,-32603],Ou={[iV]:{code:-32700,message:"Parse error"},[oV]:{code:-32600,message:"Invalid Request"},[aV]:{code:-32601,message:"Method not found"},[cV]:{code:-32602,message:"Invalid params"},[IT]:{code:-32603,message:"Internal error"},[uw]:{code:-32e3,message:"Server error"}},TT=uw;function lV(t){return uV.includes(t)}function eC(t){return Object.keys(Ou).includes(t)?Ou[t]:Ou[TT]}function dV(t){const e=Object.values(Ou).find(n=>n.code===t);return e||Ou[TT]}function NT(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var tg={};var Vm=function(t,e){return Vm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Vm(t,e)};function fV(t,e){Vm(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Km=function(){return Km=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Km.apply(this,arguments)};function hV(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function pV(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function gV(t,e){return function(n,r){e(n,r,t)}}function mV(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function yV(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})}function bV(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function wV(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function EV(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Gm(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xT(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function vV(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xT(arguments[e]));return t}function CV(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function fl(t){return this instanceof fl?(this.v=t,this):new fl(t)}function _V(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(h){return new Promise(function(g,p){i.push([f,h,g,p])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(g){d(i[0][3],g)}}function c(f){f.value instanceof fl?Promise.resolve(f.value.v).then(u,l):d(i[0][2],f)}function u(f){a("next",f)}function l(f){a("throw",f)}function d(f,h){f(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function AV(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:fl(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function SV(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Gm=="function"?Gm(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function IV(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function TV(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function NV(t){return t&&t.__esModule?t:{default:t}}function xV(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function PV(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const OV=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Km},__asyncDelegator:AV,__asyncGenerator:_V,__asyncValues:SV,__await:fl,__awaiter:yV,__classPrivateFieldGet:xV,__classPrivateFieldSet:PV,__createBinding:wV,__decorate:pV,__exportStar:EV,__extends:fV,__generator:bV,__importDefault:NV,__importStar:TV,__makeTemplateObject:IV,__metadata:mV,__param:gV,__read:xT,__rest:hV,__spread:vV,__spreadArrays:CV,__values:Gm},Symbol.toStringTag,{value:"Module"})),RV=B_(OV);var Fs={},tC;function kV(){if(tC)return Fs;tC=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.isBrowserCryptoAvailable=Fs.getSubtleCrypto=Fs.getBrowerCrypto=void 0;function t(){return globalThis?.crypto||globalThis?.msCrypto||{}}Fs.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Fs.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Fs.isBrowserCryptoAvailable=n,Fs}var js={},nC;function $V(){if(nC)return js;nC=1,Object.defineProperty(js,"__esModule",{value:!0}),js.isBrowser=js.isNode=js.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}js.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}js.isNode=e;function n(){return!t()&&!e()}return js.isBrowser=n,js}var rC;function DV(){return rC||(rC=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=RV;e.__exportStar(kV(),t),e.__exportStar($V(),t)})(tg)),tg}var UV=DV();function us(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function Vi(t=6){return BigInt(us(t))}function Lr(t,e,n){return{id:n||us(),jsonrpc:"2.0",method:t,params:e}}function hl(t,e){return{id:t,jsonrpc:"2.0",result:e}}function gp(t,e,n){return{id:t,jsonrpc:"2.0",error:BV(e)}}function BV(t,e){return typeof t>"u"?eC(IT):(typeof t=="string"&&(t=Object.assign(Object.assign({},eC(uw)),{message:t})),lV(t.code)&&(t=dV(t.code)),t)}let MV=class{},LV=class extends MV{constructor(){super()}},FV=class extends LV{constructor(e){super()}};const jV="^https?:",qV="^wss?:";function zV(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function PT(t,e){const n=zV(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function sC(t){return PT(t,jV)}function iC(t){return PT(t,qV)}function HV(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function OT(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function lw(t){return OT(t)&&"method"in t}function mp(t){return OT(t)&&(ls(t)||vr(t))}function ls(t){return"result"in t}function vr(t){return"error"in t}let dw=class extends FV{constructor(e){super(e),this.events=new ts.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(Lr(e.method,e.params||[],e.id||Vi().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{vr(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),mp(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const WV=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),VV=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",oC=t=>t.split("?")[0],aC=10,KV=WV();let GV=class{constructor(e){if(this.url=e,this.events=new ts.EventEmitter,this.registering=!1,!iC(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(fi(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!iC(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=UV.isReactNative()?void 0:{rejectUnauthorized:!HV(e)},i=new KV(e,[],s);VV()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?Yo(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=gp(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return NT(e,oC(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>aC&&this.events.setMaxListeners(aC)}emitError(e){const n=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${oC(this.url)}`));return this.events.emit("register_error",n),n}};var YV={};const RT="wc",kT=2,Ym="core",Ts=`${RT}@2:${Ym}:`,ZV={logger:"error"},JV={database:":memory:"},XV="crypto",cC="client_ed25519_seed",QV=re.ONE_DAY,eK="keychain",tK="0.3",nK="messages",rK="0.3",sK=re.SIX_HOURS,iK="publisher",$T="irn",oK="error",DT="wss://relay.walletconnect.org",aK="relayer",Nt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},cK="_subscription",hr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},uK=.1,Zm="2.23.0",it={link_mode:"link_mode",relay:"relay"},Zd={inbound:"inbound",outbound:"outbound"},lK="0.3",dK="WALLETCONNECT_CLIENT_ID",uC="WALLETCONNECT_LINK_MODE_APPS",Qn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},fK="subscription",hK="0.3",pK="pairing",gK="0.3",au={wc_pairingDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:re.ONE_DAY,prompt:!1,tag:0},res:{ttl:re.ONE_DAY,prompt:!1,tag:0}}},To={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Pr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},mK="history",yK="0.3",bK="expirer",yr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},wK="0.3",EK="verify-api",vK="https://verify.walletconnect.com",UT="https://verify.walletconnect.org",Ru=UT,CK=`${Ru}/v3`,_K=[vK,UT],AK="echo",SK="https://echo.walletconnect.com",cs={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},zs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Or={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},bo={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},wo={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},cu={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},IK=.1,TK="event-client",NK=86400,xK="https://pulse.walletconnect.org/batch";function PK(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,y=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var w=(A-E)*l+1>>>0,C=new Uint8Array(w);E!==A;){for(var _=g[E],P=0,k=w-1;(_!==0||P<y)&&k!==-1;k--,P++)_+=256*C[k]>>>0,C[k]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");y=P,E++}for(var U=w-y;U!==w&&C[U]===0;)U++;for(var $=c.repeat(p);U<w;++U)$+=t.charAt(C[U]);return $}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var y=0,E=0;g[p]===c;)y++,p++;for(var A=(g.length-p)*u+1>>>0,w=new Uint8Array(A);g[p];){var C=n[g.charCodeAt(p)];if(C===255)return;for(var _=0,P=A-1;(C!==0||_<E)&&P!==-1;P--,_++)C+=a*w[P]>>>0,w[P]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");E=_,p++}if(g[p]!==" "){for(var k=A-E;k!==A&&w[k]===0;)k++;for(var U=new Uint8Array(y+(A-k)),$=y;k!==A;)U[$++]=w[k++];return U}}}function h(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var OK=PK,RK=OK;const BT=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},kK=t=>new TextEncoder().encode(t),$K=t=>new TextDecoder().decode(t);class DK{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class UK{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return MT(this,e)}}class BK{constructor(e){this.decoders=e}or(e){return MT(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const MT=(t,e)=>new BK({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class MK{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new DK(e,n,r),this.decoder=new UK(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yp=({name:t,prefix:e,encode:n,decode:r})=>new MK(t,e,n,r),Yl=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=RK(n,e);return yp({prefix:t,name:e,encode:r,decode:i=>BT(s(i))})},LK=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},FK=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},nn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>yp({prefix:e,name:t,encode(s){return FK(s,r,n)},decode(s){return LK(s,r,n,t)}}),jK=yp({prefix:"\0",name:"identity",encode:t=>$K(t),decode:t=>kK(t)});var qK=Object.freeze({__proto__:null,identity:jK});const zK=nn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var HK=Object.freeze({__proto__:null,base2:zK});const WK=nn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var VK=Object.freeze({__proto__:null,base8:WK});const KK=Yl({prefix:"9",name:"base10",alphabet:"0123456789"});var GK=Object.freeze({__proto__:null,base10:KK});const YK=nn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ZK=nn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var JK=Object.freeze({__proto__:null,base16:YK,base16upper:ZK});const XK=nn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),QK=nn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),eG=nn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),tG=nn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nG=nn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rG=nn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sG=nn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),iG=nn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),oG=nn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var aG=Object.freeze({__proto__:null,base32:XK,base32upper:QK,base32pad:eG,base32padupper:tG,base32hex:nG,base32hexupper:rG,base32hexpad:sG,base32hexpadupper:iG,base32z:oG});const cG=Yl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),uG=Yl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var lG=Object.freeze({__proto__:null,base36:cG,base36upper:uG});const dG=Yl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),fG=Yl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var hG=Object.freeze({__proto__:null,base58btc:dG,base58flickr:fG});const pG=nn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gG=nn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mG=nn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yG=nn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var bG=Object.freeze({__proto__:null,base64:pG,base64pad:gG,base64url:mG,base64urlpad:yG});const LT=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),wG=LT.reduce((t,e,n)=>(t[n]=e,t),[]),EG=LT.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function vG(t){return t.reduce((e,n)=>(e+=wG[n],e),"")}function CG(t){const e=[];for(const n of t){const r=EG[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const _G=yp({prefix:"ðŸš€",name:"base256emoji",encode:vG,decode:CG});var AG=Object.freeze({__proto__:null,base256emoji:_G}),SG=FT,lC=128,IG=-128,TG=Math.pow(2,31);function FT(t,e,n){e=e||[],n=n||0;for(var r=n;t>=TG;)e[n++]=t&255|lC,t/=128;for(;t&IG;)e[n++]=t&255|lC,t>>>=7;return e[n]=t|0,FT.bytes=n-r+1,e}var NG=Jm,xG=128,dC=127;function Jm(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw Jm.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&dC)<<s:(o&dC)*Math.pow(2,s),s+=7}while(o>=xG);return Jm.bytes=i-r,n}var PG=Math.pow(2,7),OG=Math.pow(2,14),RG=Math.pow(2,21),kG=Math.pow(2,28),$G=Math.pow(2,35),DG=Math.pow(2,42),UG=Math.pow(2,49),BG=Math.pow(2,56),MG=Math.pow(2,63),LG=function(t){return t<PG?1:t<OG?2:t<RG?3:t<kG?4:t<$G?5:t<DG?6:t<UG?7:t<BG?8:t<MG?9:10},FG={encode:SG,decode:NG,encodingLength:LG},jT=FG;const fC=(t,e,n=0)=>(jT.encode(t,e,n),e),hC=t=>jT.encodingLength(t),Xm=(t,e)=>{const n=e.byteLength,r=hC(t),s=r+hC(n),i=new Uint8Array(s+n);return fC(t,i,0),fC(n,i,r),i.set(e,s),new jG(t,n,e,i)};class jG{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const qT=({name:t,code:e,encode:n})=>new qG(t,e,n);class qG{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Xm(this.code,n):n.then(r=>Xm(this.code,r))}else throw Error("Unknown type, must be binary type")}}const zT=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),zG=qT({name:"sha2-256",code:18,encode:zT("SHA-256")}),HG=qT({name:"sha2-512",code:19,encode:zT("SHA-512")});var WG=Object.freeze({__proto__:null,sha256:zG,sha512:HG});const HT=0,VG="identity",WT=BT,KG=t=>Xm(HT,WT(t)),GG={code:HT,name:VG,encode:WT,digest:KG};var YG=Object.freeze({__proto__:null,identity:GG});new TextEncoder,new TextDecoder;const pC={...qK,...HK,...VK,...GK,...JK,...aG,...lG,...hG,...bG,...AG};({...WG,...YG});function VT(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ZG(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?VT(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function KT(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const gC=KT("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ng=KT("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=ZG(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),JG={utf8:gC,"utf-8":gC,hex:pC.base16,latin1:ng,ascii:ng,binary:ng,...pC};function XG(t,e="utf8"){const n=JG[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?VT(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var QG=Object.defineProperty,eY=(t,e,n)=>e in t?QG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,os=(t,e,n)=>eY(t,typeof e!="symbol"?e+"":e,n);class tY{constructor(e,n){this.core=e,this.logger=n,os(this,"keychain",new Map),os(this,"name",eK),os(this,"version",tK),os(this,"initialized",!1),os(this,"storagePrefix",Ts),os(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),os(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),os(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),os(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=se("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),os(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Wn(n,this.name)}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Rm(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?km(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var nY=Object.defineProperty,rY=(t,e,n)=>e in t?nY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ut=(t,e,n)=>rY(t,typeof e!="symbol"?e+"":e,n);class sY{constructor(e,n,r){this.core=e,this.logger=n,Ut(this,"name",XV),Ut(this,"keychain"),Ut(this,"randomSessionIdentifier",Hm()),Ut(this,"initialized",!1),Ut(this,"clientId"),Ut(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Ut(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Ut(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=SE(s),o=p5(i.publicKey);return this.clientId=o,o}),Ut(this,"generateKeyPair",()=>{this.isInitialized();const s=jH();return this.setPrivateKey(s.publicKey,s.privateKey)}),Ut(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=SE(i),a=this.randomSessionIdentifier;return await ZM(a,s,QV,o)}),Ut(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=qH(a,i);return this.setSymKey(c,o)}),Ut(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Yd(s);return await this.keychain.set(o,s),o}),Ut(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Ut(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Ut(this,"encode",async(s,i,o)=>{this.isInitialized();const a=CT(o),c=fi(i);if(Fv(a))return WH(c,o?.encoding);if(Lv(a)){const f=a.senderPublicKey,h=a.receiverPublicKey;s=await this.generateSharedKey(f,h)}const u=this.getSymKey(s),{type:l,senderPublicKey:d}=a;return zH({type:l,symKey:u,message:c,senderPublicKey:d,encoding:o?.encoding})}),Ut(this,"decode",async(s,i,o)=>{this.isInitialized();const a=KH(i,o);if(Fv(a)){const c=VH(i,o?.encoding);return Yo(c)}if(Lv(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;s=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(s),u=HH({symKey:c,encoded:i,encoding:o?.encoding});return Yo(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Ut(this,"getPayloadType",(s,i=Mn)=>{const o=dl({encoded:s,encoding:i});return ia(o.type)}),Ut(this,"getPayloadSenderPublicKey",(s,i=Mn)=>{const o=dl({encoded:s,encoding:i});return o.senderPublicKey?zn(o.senderPublicKey,_n):void 0}),this.core=e,this.logger=Wn(n,this.name),this.keychain=r||new tY(this.core,this.logger)}get context(){return Hn(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(cC)}catch{e=Hm(),await this.keychain.set(cC,e)}return XG(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var iY=Object.defineProperty,oY=Object.defineProperties,aY=Object.getOwnPropertyDescriptors,mC=Object.getOwnPropertySymbols,cY=Object.prototype.hasOwnProperty,uY=Object.prototype.propertyIsEnumerable,Qm=(t,e,n)=>e in t?iY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lY=(t,e)=>{for(var n in e||(e={}))cY.call(e,n)&&Qm(t,n,e[n]);if(mC)for(var n of mC(e))uY.call(e,n)&&Qm(t,n,e[n]);return t},dY=(t,e)=>oY(t,aY(e)),Jn=(t,e,n)=>Qm(t,typeof e!="symbol"?e+"":e,n);class fY extends GU{constructor(e,n){super(e,n),this.logger=e,this.core=n,Jn(this,"messages",new Map),Jn(this,"messagesWithoutClientAck",new Map),Jn(this,"name",nK),Jn(this,"version",rK),Jn(this,"initialized",!1),Jn(this,"storagePrefix",Ts),Jn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Jn(this,"set",async(r,s,i)=>{this.isInitialized();const o=Er(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===Zd.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,dY(lY({},c),{[o]:s}))}return await this.persist(),o}),Jn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Jn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Jn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Er(s);return typeof i[o]<"u"}),Jn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Er(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Jn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Wn(e,this.name),this.core=n}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Rm(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Rm(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?km(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?km(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var hY=Object.defineProperty,pY=Object.defineProperties,gY=Object.getOwnPropertyDescriptors,yC=Object.getOwnPropertySymbols,mY=Object.prototype.hasOwnProperty,yY=Object.prototype.propertyIsEnumerable,ey=(t,e,n)=>e in t?hY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pa=(t,e)=>{for(var n in e||(e={}))mY.call(e,n)&&ey(t,n,e[n]);if(yC)for(var n of yC(e))yY.call(e,n)&&ey(t,n,e[n]);return t},bC=(t,e)=>pY(t,gY(e)),pr=(t,e,n)=>ey(t,typeof e!="symbol"?e+"":e,n);class bY extends YU{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,pr(this,"events",new ts.EventEmitter),pr(this,"name",iK),pr(this,"queue",new Map),pr(this,"publishTimeout",re.toMiliseconds(re.ONE_MINUTE)),pr(this,"initialPublishTimeout",re.toMiliseconds(re.ONE_SECOND*15)),pr(this,"needsTransportRestart",!1),pr(this,"publish",async(r,s,i)=>{var o,a,c,u,l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const d=i?.ttl||sK,f=i?.prompt||!1,h=i?.tag||0,g=i?.id||Vi().toString(),p=Wa(th().protocol),y={id:g,method:i?.publishMethod||p.publish,params:Pa({topic:r,message:s,ttl:d,prompt:f,tag:h,attestation:i?.attestation},i?.tvf)},E=`Failed to publish payload, please try again. id:${g} tag:${h}`;try{jt((o=y.params)==null?void 0:o.prompt)&&((a=y.params)==null||delete a.prompt),jt((c=y.params)==null?void 0:c.tag)&&((u=y.params)==null||delete u.tag);const A=new Promise(async w=>{const C=({id:P})=>{var k;((k=y.id)==null?void 0:k.toString())===P.toString()&&(this.removeRequestFromQueue(P),this.relayer.events.removeListener(Nt.publish,C),w())};this.relayer.events.on(Nt.publish,C);const _=ms(new Promise((P,k)=>{this.rpcPublish(y,i).then(P).catch(U=>{this.logger.warn(U,U?.message),k(U)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${g} tag:${h}`);try{await _,this.events.removeListener(Nt.publish,C)}catch(P){this.queue.set(g,{request:y,opts:i,attempt:1}),this.logger.warn(P,P?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:g,topic:r,message:s,opts:i}}),await ms(A,this.publishTimeout,E)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(l=i?.internal)!=null&&l.throwOnFailedPublish)throw A}finally{this.queue.delete(g)}}),pr(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:u,opts:l={}}=r,{attestation:d,tvf:f,publishMethod:h,prompt:g,tag:p,ttl:y=re.FIVE_MINUTES}=l,E=l.id||Vi().toString(),A=Wa(th().protocol),w=h||A.publish,C={id:E,method:w,params:Pa(bC(Pa({},u),{ttl:y,prompt:g,tag:p,attestation:d}),f)},_=`Failed to publish custom payload, please try again. id:${E} tag:${p}`;try{jt((s=C.params)==null?void 0:s.prompt)&&((i=C.params)==null||delete i.prompt),jt((o=C.params)==null?void 0:o.tag)&&((a=C.params)==null||delete a.tag);const P=new Promise(async k=>{const U=({id:L})=>{var M;((M=C.id)==null?void 0:M.toString())===L.toString()&&(this.removeRequestFromQueue(L),this.relayer.events.removeListener(Nt.publish,U),k())};this.relayer.events.on(Nt.publish,U);const $=ms(new Promise((L,M)=>{this.rpcPublish(C,l).then(L).catch(D=>{this.logger.warn(D,D?.message),M(D)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${w} id:${E} tag:${p}`);try{await $,this.events.removeListener(Nt.publish,U)}catch(L){this.queue.set(E,{request:C,opts:l,attempt:1}),this.logger.warn(L,L?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:E,payload:u,opts:l}}),await ms(P,this.publishTimeout,_)}catch(P){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(P),(c=l?.internal)!=null&&c.throwOnFailedPublish)throw P}finally{this.queue.delete(E)}}),pr(this,"on",(r,s)=>{this.events.on(r,s)}),pr(this,"once",(r,s)=>{this.events.once(r,s)}),pr(this,"off",(r,s)=>{this.events.off(r,s)}),pr(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=Wn(n,this.name),this.registerEventListeners()}get context(){return Hn(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(Nt.publish,Pa(Pa({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,bC(Pa({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(ya.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Nt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Nt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var wY=Object.defineProperty,EY=(t,e,n)=>e in t?wY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oa=(t,e,n)=>EY(t,typeof e!="symbol"?e+"":e,n);class vY{constructor(){Oa(this,"map",new Map),Oa(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),Oa(this,"get",e=>this.map.get(e)||[]),Oa(this,"exists",(e,n)=>this.get(e).includes(n)),Oa(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Oa(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var CY=Object.defineProperty,_Y=Object.defineProperties,AY=Object.getOwnPropertyDescriptors,wC=Object.getOwnPropertySymbols,SY=Object.prototype.hasOwnProperty,IY=Object.prototype.propertyIsEnumerable,ty=(t,e,n)=>e in t?CY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,uu=(t,e)=>{for(var n in e||(e={}))SY.call(e,n)&&ty(t,n,e[n]);if(wC)for(var n of wC(e))IY.call(e,n)&&ty(t,n,e[n]);return t},rg=(t,e)=>_Y(t,AY(e)),tt=(t,e,n)=>ty(t,typeof e!="symbol"?e+"":e,n);class TY extends XU{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,tt(this,"subscriptions",new Map),tt(this,"topicMap",new vY),tt(this,"events",new ts.EventEmitter),tt(this,"name",fK),tt(this,"version",hK),tt(this,"pending",new Map),tt(this,"cached",[]),tt(this,"initialized",!1),tt(this,"storagePrefix",Ts),tt(this,"subscribeTimeout",re.toMiliseconds(re.ONE_MINUTE)),tt(this,"initialSubscribeTimeout",re.toMiliseconds(re.ONE_SECOND*15)),tt(this,"clientId"),tt(this,"batchSubscribeTopicsLimit",500),tt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),tt(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=th(s),a={topic:r,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),tt(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),tt(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),tt(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),tt(this,"on",(r,s)=>{this.events.on(r,s)}),tt(this,"once",(r,s)=>{this.events.once(r,s)}),tt(this,"off",(r,s)=>{this.events.off(r,s)}),tt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),tt(this,"start",async()=>{await this.onConnect()}),tt(this,"stop",async()=>{await this.onDisconnect()}),tt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),tt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),tt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(ya.pulse,async()=>{await this.checkPending()}),this.events.on(Qn.created,async r=>{const s=Qn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Qn.deleted,async r=>{const s=Qn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=Wn(n,this.name),this.clientId=""}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=th(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=ct("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r?.internal)!=null&&s.skipSubscribe)return o;(!r||r?.transportType===it.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:Wa(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r?.internal)==null?void 0:i.throwOnFailedPublish;try{if(r?.transportType===it.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},re.toMiliseconds(re.ONE_SECOND)),o;const u=new Promise(async d=>{const f=h=>{h.topic===e&&(this.events.removeListener(Qn.created,f),d(h.id))};this.events.on(Qn.created,f);try{const h=await ms(new Promise((g,p)=>{this.relayer.request(a).catch(y=>{this.logger.warn(y,y?.message),p(y)}).then(g)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Qn.created,f),d(h)}catch{}}),l=await ms(u,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return l?o:null}catch(u){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Nt.connection_stalled),c)throw u}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Wa(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await ms(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Nt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Wa(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await ms(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Nt.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Wa(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,rg(uu({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,uu({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,uu({},n)),this.topicMap.set(n.topic,e),this.events.emit(Qn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Qn.deleted,rg(uu({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Qn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Qn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>rg(uu({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await aq(re.toMiliseconds(re.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Er(e+await this.getClientId())}}var NY=Object.defineProperty,EC=Object.getOwnPropertySymbols,xY=Object.prototype.hasOwnProperty,PY=Object.prototype.propertyIsEnumerable,ny=(t,e,n)=>e in t?NY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vC=(t,e)=>{for(var n in e||(e={}))xY.call(e,n)&&ny(t,n,e[n]);if(EC)for(var n of EC(e))PY.call(e,n)&&ny(t,n,e[n]);return t},Ve=(t,e,n)=>ny(t,typeof e!="symbol"?e+"":e,n);class OY extends ZU{constructor(e){var n;super(e),Ve(this,"protocol","wc"),Ve(this,"version",2),Ve(this,"core"),Ve(this,"logger"),Ve(this,"events",new ts.EventEmitter),Ve(this,"provider"),Ve(this,"messages"),Ve(this,"subscriber"),Ve(this,"publisher"),Ve(this,"name",aK),Ve(this,"transportExplicitlyClosed",!1),Ve(this,"initialized",!1),Ve(this,"connectionAttemptInProgress",!1),Ve(this,"relayUrl"),Ve(this,"projectId"),Ve(this,"packageName"),Ve(this,"bundleId"),Ve(this,"hasExperiencedNetworkDisruption",!1),Ve(this,"pingTimeout"),Ve(this,"heartBeatTimeout",re.toMiliseconds(re.THIRTY_SECONDS+re.FIVE_SECONDS)),Ve(this,"reconnectTimeout"),Ve(this,"connectPromise"),Ve(this,"reconnectInProgress",!1),Ve(this,"requestsInFlight",[]),Ve(this,"connectTimeout",re.toMiliseconds(re.ONE_SECOND*15)),Ve(this,"request",async r=>{var s,i;this.logger.debug("Publishing Request Payload");const o=r.id||Vi().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(s=r.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(u=>u!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),Ve(this,"resetPingTimeout",()=>{Yf()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),Ve(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Ve(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected ðŸ›œ"),this.startPingTimeout(),this.events.emit(Nt.connect)}),Ve(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected ðŸ›‘"),this.requestsInFlight=[],this.onProviderDisconnect()}),Ve(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(Nt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Ve(this,"registerProviderListeners",()=>{this.provider.on(hr.payload,this.onPayloadHandler),this.provider.on(hr.connect,this.onConnectHandler),this.provider.on(hr.disconnect,this.onDisconnectHandler),this.provider.on(hr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=cw({logger:(n=e.logger)!=null?n:oK,name:this.name}),this.messages=new fY(this.logger,e.core),this.subscriber=new TY(this,this.logger),this.publisher=new bY(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||DT,Wj()?this.packageName=av():Vj()&&(this.bundleId=av()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return Hn(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:it.relay},Zd.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(Qn.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(Qn.created,u)}),new Promise(async(l,d)=>{a=await this.subscriber.subscribe(e,vC({internal:{throwOnFailedPublish:o}},n)).catch(f=>{o&&d(f)})||a,l()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ms(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Qv())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=Tt(re.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(Nt.message,e),await this.recordMessageEvent(e,Zd.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(hr.disconnect,i),await ms(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(hr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(hr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(hr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,re.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(Yf())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new dw(new GV(Jj({sdkVersion:Zm,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),lw(e)){if(!e.method.endsWith(cK))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:it.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vC({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else mp(e)&&this.events.emit(Nt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Zd.inbound),this.events.emit(Nt.message,e))}async acknowledgePayload(e){const n=hl(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(hr.payload,this.onPayloadHandler),this.provider.off(hr.connect,this.onConnectHandler),this.provider.off(hr.disconnect,this.onDisconnectHandler),this.provider.off(hr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Qv();KW(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(ya.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&ZW())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Nt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},re.toMiliseconds(uK)))))}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function RY(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function CC(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function _C(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const kY="[object RegExp]",$Y="[object String]",DY="[object Number]",UY="[object Boolean]",AC="[object Arguments]",BY="[object Symbol]",MY="[object Date]",LY="[object Map]",FY="[object Set]",jY="[object Array]",qY="[object Function]",zY="[object ArrayBuffer]",sg="[object Object]",HY="[object Error]",WY="[object DataView]",VY="[object Uint8Array]",KY="[object Uint8ClampedArray]",GY="[object Uint16Array]",YY="[object Uint32Array]",ZY="[object BigUint64Array]",JY="[object Int8Array]",XY="[object Int16Array]",QY="[object Int32Array]",eZ="[object BigInt64Array]",tZ="[object Float32Array]",nZ="[object Float64Array]";function rZ(){}function SC(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function sZ(t,e,n){return Su(t,e,void 0,void 0,void 0,void 0,n)}function Su(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return ku(t,e,i,o)}return ku(t,e,i,o)}function ku(t,e,n,r){if(Object.is(t,e))return!0;let s=_C(t),i=_C(e);if(s===AC&&(s=sg),i===AC&&(i=sg),s!==i)return!1;switch(s){case $Y:return t.toString()===e.toString();case DY:{const c=t.valueOf(),u=e.valueOf();return RY(c,u)}case UY:case MY:case BY:return Object.is(t.valueOf(),e.valueOf());case kY:return t.source===e.source&&t.flags===e.flags;case qY:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case LY:{if(t.size!==e.size)return!1;for(const[c,u]of t.entries())if(!e.has(c)||!Su(u,e.get(c),c,t,e,n,r))return!1;return!0}case FY:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const d=c[l],f=u.findIndex(h=>Su(d,h,void 0,t,e,n,r));if(f===-1)return!1;u.splice(f,1)}return!0}case jY:case VY:case KY:case GY:case YY:case ZY:case JY:case XY:case QY:case eZ:case tZ:case nZ:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!Su(t[c],e[c],c,t,e,n,r))return!1;return!0}case zY:return t.byteLength!==e.byteLength?!1:ku(new Uint8Array(t),new Uint8Array(e),n,r);case WY:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:ku(new Uint8Array(t),new Uint8Array(e),n,r);case HY:return t.name===e.name&&t.message===e.message;case sg:{if(!(ku(t.constructor,e.constructor,n,r)||SC(t)&&SC(e)))return!1;const c=[...Object.keys(t),...CC(t)],u=[...Object.keys(e),...CC(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const d=c[l],f=t[d];if(!Object.hasOwn(e,d))return!1;const h=e[d];if(!Su(f,h,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function iZ(t,e){return sZ(t,e,rZ)}var oZ=Object.defineProperty,IC=Object.getOwnPropertySymbols,aZ=Object.prototype.hasOwnProperty,cZ=Object.prototype.propertyIsEnumerable,ry=(t,e,n)=>e in t?oZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,TC=(t,e)=>{for(var n in e||(e={}))aZ.call(e,n)&&ry(t,n,e[n]);if(IC)for(var n of IC(e))cZ.call(e,n)&&ry(t,n,e[n]);return t},Pn=(t,e,n)=>ry(t,typeof e!="symbol"?e+"":e,n);class Ea extends JU{constructor(e,n,r,s=Ts,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,Pn(this,"map",new Map),Pn(this,"version",lK),Pn(this,"cached",[]),Pn(this,"initialized",!1),Pn(this,"getKey"),Pn(this,"storagePrefix",Ts),Pn(this,"recentlyDeleted",[]),Pn(this,"recentlyDeletedLimit",200),Pn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!jt(o)?this.map.set(this.getKey(o),o):AW(o)?this.map.set(o.id,o):SW(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Pn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Pn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Pn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>iZ(a[c],o[c]))):this.values)),Pn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=TC(TC({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Pn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Wn(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=se("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var uZ=Object.defineProperty,lZ=(t,e,n)=>e in t?uZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Me=(t,e,n)=>lZ(t,typeof e!="symbol"?e+"":e,n);class dZ{constructor(e,n){this.core=e,this.logger=n,Me(this,"name",pK),Me(this,"version",gK),Me(this,"events",new vy),Me(this,"pairings"),Me(this,"initialized",!1),Me(this,"storagePrefix",Ts),Me(this,"ignoredPayloadTypes",[ci]),Me(this,"registeredMethods",[]),Me(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Me(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Me(this,"create",async r=>{this.isInitialized();const s=Hm(),i=await this.core.crypto.setSymKey(s),o=Tt(re.FIVE_MINUTES),a={protocol:$T},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},u=Hv({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(To.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType,internal:r?.internal}),{topic:i,uri:u}}),Me(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[cs.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:u}=zv(r.uri);s.props.properties.topic=i,s.addTrace(cs.pairing_uri_validation_success),s.addTrace(cs.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(i)){if(l=this.pairings.get(i),s.addTrace(cs.existing_pairing),l.active)throw s.setError(zs.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(cs.pairing_not_expired)}const d=c||Tt(re.FIVE_MINUTES),f={topic:i,relay:a,expiry:d,active:!1,methods:u};this.core.expirer.set(i,d),await this.pairings.set(i,f),s.addTrace(cs.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(To.create,f),s.addTrace(cs.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(cs.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(zs.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(h){throw s.setError(zs.subscribe_pairing_topic_failure),h}return s.addTrace(cs.subscribe_pairing_topic_success),f}),Me(this,"activate",async({topic:r})=>{this.isInitialized();const s=Tt(re.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Me(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=So();this.events.once(Xe("pairing_ping",i),({error:u})=>{u?c(u):a()}),await o()}}),Me(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Me(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Me(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Me(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",ct("USER_DISCONNECTED")),await this.deletePairing(s))}),Me(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return Hv({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Me(this,"sendRequest",async(r,s,i)=>{const o=Lr(s,i),a=await this.core.crypto.encode(r,o),c=au[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Me(this,"sendResult",async(r,s,i)=>{const o=hl(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,u=au[c].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),Me(this,"sendError",async(r,s,i)=>{const o=gp(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,u=au[c]?au[c].res:au.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),Me(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,ct("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Me(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>ds(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Me(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Me(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Me(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(To.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Me(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{ls(s)?this.events.emit(Xe("pairing_ping",i),{}):vr(s)&&this.events.emit(Xe("pairing_ping",i),{error:s.error})},500)}),Me(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(To.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Me(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=ct("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Me(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(ct("WC_METHOD_UNSUPPORTED",r))}),Me(this,"isValidPair",(r,s)=>{var i;if(!Rn(r)){const{message:a}=se("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(zs.malformed_pairing_uri),new Error(a)}if(!_W(r.uri)){const{message:a}=se("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(zs.malformed_pairing_uri),new Error(a)}const o=zv(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=se("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(zs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=se("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(zs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&re.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(zs.pairing_expired);const{message:a}=se("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Me(this,"isValidPing",async r=>{if(!Rn(r)){const{message:i}=se("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Me(this,"isValidDisconnect",async r=>{if(!Rn(r)){const{message:i}=se("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Me(this,"isValidPairingTopic",async r=>{if(!xt(r,!1)){const{message:s}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(ds(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=se("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=Wn(n,this.name),this.pairings=new Ea(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Hn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Nt.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==it.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);lw(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):mp(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(yr.expired,async e=>{const{topic:n}=A6(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(To.expire,{topic:n}))})}}var fZ=Object.defineProperty,hZ=(t,e,n)=>e in t?fZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gt=(t,e,n)=>hZ(t,typeof e!="symbol"?e+"":e,n);class pZ extends KU{constructor(e,n){super(e,n),this.core=e,this.logger=n,Gt(this,"records",new Map),Gt(this,"events",new ts.EventEmitter),Gt(this,"name",mK),Gt(this,"version",yK),Gt(this,"cached",[]),Gt(this,"initialized",!1),Gt(this,"storagePrefix",Ts),Gt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Gt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:Tt(re.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Pr.created,o)}),Gt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=vr(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Pr.updated,s))}),Gt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Gt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Pr.deleted,i)}}),this.persist()}),Gt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Gt(this,"on",(r,s)=>{this.events.on(r,s)}),Gt(this,"once",(r,s)=>{this.events.once(r,s)}),Gt(this,"off",(r,s)=>{this.events.off(r,s)}),Gt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Wn(n,this.name)}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:Lr(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Pr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Pr.created,e=>{const n=Pr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Pr.updated,e=>{const n=Pr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Pr.deleted,e=>{const n=Pr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(ya.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{re.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Pr.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var gZ=Object.defineProperty,mZ=(t,e,n)=>e in t?gZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,un=(t,e,n)=>mZ(t,typeof e!="symbol"?e+"":e,n);class yZ extends QU{constructor(e,n){super(e,n),this.core=e,this.logger=n,un(this,"expirations",new Map),un(this,"events",new ts.EventEmitter),un(this,"name",bK),un(this,"version",wK),un(this,"cached",[]),un(this,"initialized",!1),un(this,"storagePrefix",Ts),un(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),un(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),un(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(yr.created,{target:i,expiration:o})}),un(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),un(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(yr.deleted,{target:s,expiration:i})}}),un(this,"on",(r,s)=>{this.events.on(r,s)}),un(this,"once",(r,s)=>{this.events.once(r,s)}),un(this,"off",(r,s)=>{this.events.off(r,s)}),un(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Wn(n,this.name)}get context(){return Hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Xj(e);if(typeof e=="number")return Qj(e);const{message:n}=se("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=se("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;re.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(yr.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(ya.pulse,()=>this.checkExpirations()),this.events.on(yr.created,e=>{const n=yr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(yr.expired,e=>{const n=yr.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(yr.deleted,e=>{const n=yr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}}var bZ=Object.defineProperty,wZ=(t,e,n)=>e in t?bZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,It=(t,e,n)=>wZ(t,typeof e!="symbol"?e+"":e,n);class EZ extends e9{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,It(this,"name",EK),It(this,"abortController"),It(this,"isDevEnv"),It(this,"verifyUrlV3",CK),It(this,"storagePrefix",Ts),It(this,"version",kT),It(this,"publicKey"),It(this,"fetchPromise"),It(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&re.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),It(this,"register",async s=>{if(!Kc()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const u=mi.getDocument(),l=this.startAbortTimer(re.ONE_SECOND*5),d=await new Promise((f,h)=>{const g=()=>{window.removeEventListener("message",y),u.body.removeChild(p),h("attestation aborted")};this.abortController.signal.addEventListener("abort",g);const p=u.createElement("iframe");p.src=c,p.style.display="none",p.addEventListener("error",g,{signal:this.abortController.signal});const y=E=>{if(E.data&&typeof E.data=="string")try{const A=JSON.parse(E.data);if(A.type==="verify_attestation"){if(Em(A.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(p),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",y),f(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};u.body.appendChild(p),window.addEventListener("message",y,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(u){this.logger.warn(u)}return""}),It(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Em(i).payload.id!==a)return;const u=await this.isValidJwtAttestation(i);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),It(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(re.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),It(this,"getVerifyUrl",s=>{let i=s||Ru;return _K.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Ru}`),i=Ru),i}),It(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(re.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),It(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),It(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),It(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),It(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),It(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),It(this,"validateAttestation",(s,i)=>{const o=YH(s,i.publicKey),a={hasExpired:re.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Wn(n,this.name),this.abortController=new AbortController,this.isDevEnv=Jb(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Hn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),re.toMiliseconds(e))}}var vZ=Object.defineProperty,CZ=(t,e,n)=>e in t?vZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,NC=(t,e,n)=>CZ(t,typeof e!="symbol"?e+"":e,n);class _Z extends t9{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,NC(this,"context",AK),NC(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${SK}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Wn(n,this.context)}}var AZ=Object.defineProperty,xC=Object.getOwnPropertySymbols,SZ=Object.prototype.hasOwnProperty,IZ=Object.prototype.propertyIsEnumerable,sy=(t,e,n)=>e in t?AZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lu=(t,e)=>{for(var n in e||(e={}))SZ.call(e,n)&&sy(t,n,e[n]);if(xC)for(var n of xC(e))IZ.call(e,n)&&sy(t,n,e[n]);return t},Bt=(t,e,n)=>sy(t,typeof e!="symbol"?e+"":e,n);class TZ extends n9{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,Bt(this,"context",TK),Bt(this,"storagePrefix",Ts),Bt(this,"storageVersion",IK),Bt(this,"events",new Map),Bt(this,"shouldPersist",!1),Bt(this,"init",async()=>{if(!Jb())try{const s={eventId:uv(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:C6(this.core.relayer.protocol,this.core.relayer.version,Zm)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Bt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,u=uv(),l=this.core.projectId||"",d=Date.now(),f=lu({eventId:u,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,f),this.shouldPersist=!0),f}),Bt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return lu(lu({},a),this.setMethods(a.eventId))}),Bt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Bt(this,"setEventListeners",()=>{this.core.heartbeat.on(ya.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{re.fromMiliseconds(Date.now())-re.fromMiliseconds(s.timestamp)>NK&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Bt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Bt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Bt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Bt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Bt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,lu(lu({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Bt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Bt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${xK}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Zm}${i}`,{method:"POST",body:JSON.stringify(s)})}),Bt(this,"getAppDomain",()=>v6().url),this.logger=Wn(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var NZ=Object.defineProperty,PC=Object.getOwnPropertySymbols,xZ=Object.prototype.hasOwnProperty,PZ=Object.prototype.propertyIsEnumerable,iy=(t,e,n)=>e in t?NZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,OC=(t,e)=>{for(var n in e||(e={}))xZ.call(e,n)&&iy(t,n,e[n]);if(PC)for(var n of PC(e))PZ.call(e,n)&&iy(t,n,e[n]);return t},st=(t,e,n)=>iy(t,typeof e!="symbol"?e+"":e,n);let OZ=class GT extends zU{constructor(e){var n;super(e),st(this,"protocol",RT),st(this,"version",kT),st(this,"name",Ym),st(this,"relayUrl"),st(this,"projectId"),st(this,"customStoragePrefix"),st(this,"events",new ts.EventEmitter),st(this,"logger"),st(this,"heartbeat"),st(this,"relayer"),st(this,"crypto"),st(this,"storage"),st(this,"history"),st(this,"expirer"),st(this,"pairing"),st(this,"verify"),st(this,"echoClient"),st(this,"linkModeSupportedApps"),st(this,"eventClient"),st(this,"initialized",!1),st(this,"logChunkController"),st(this,"on",(a,c)=>this.events.on(a,c)),st(this,"once",(a,c)=>this.events.once(a,c)),st(this,"off",(a,c)=>this.events.off(a,c)),st(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),st(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:it.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||DT,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Ay({level:typeof e?.logger=="string"&&e.logger?e.logger:ZV.logger,name:Ym}),{logger:i,chunkLoggerController:o}=hh({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Wn(i,this.name),this.heartbeat=new oU,this.crypto=new sY(this,this.logger,e?.keychain),this.history=new pZ(this,this.logger),this.expirer=new yZ(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new FU(OC(OC({},JV),e?.storageOptions)),this.relayer=new OY({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new dZ(this,this.logger),this.verify=new EZ(this,this.logger,this.storage),this.echoClient=new _Z(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new TZ(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new GT(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(dK,r),n}get context(){return Hn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(uC,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(uC)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&YV.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const RZ=OZ,YT="wc",ZT=2,JT="client",fw=`${YT}@${ZT}:${JT}:`,ig={name:JT,logger:"error"},RC="WALLETCONNECT_DEEPLINK_CHOICE",kZ="proposal",kC="Proposal expired",$Z="session",Ra=re.SEVEN_DAYS,DZ="engine",Yt={wc_sessionPropose:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1114},res:{ttl:re.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:re.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:re.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1119}}},og={min:re.FIVE_MINUTES,max:re.SEVEN_DAYS},as={idle:"IDLE",active:"ACTIVE"},UZ={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},BZ="request",MZ=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],LZ="wc",FZ="auth",jZ="authKeys",qZ="pairingTopics",zZ="requests",bp=`${LZ}@${1.5}:${FZ}:`,Jd=`${bp}:PUB_KEY`;var HZ=Object.defineProperty,WZ=Object.defineProperties,VZ=Object.getOwnPropertyDescriptors,$C=Object.getOwnPropertySymbols,KZ=Object.prototype.hasOwnProperty,GZ=Object.prototype.propertyIsEnumerable,oy=(t,e,n)=>e in t?HZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ye=(t,e)=>{for(var n in e||(e={}))KZ.call(e,n)&&oy(t,n,e[n]);if($C)for(var n of $C(e))GZ.call(e,n)&&oy(t,n,e[n]);return t},Zt=(t,e)=>WZ(t,VZ(e)),Z=(t,e,n)=>oy(t,typeof e!="symbol"?e+"":e,n);class YZ extends o9{constructor(e){super(e),Z(this,"name",DZ),Z(this,"events",new vy),Z(this,"initialized",!1),Z(this,"requestQueue",{state:as.idle,queue:[]}),Z(this,"sessionRequestQueue",{state:as.idle,queue:[]}),Z(this,"emittedSessionRequests",new cq({limit:500})),Z(this,"requestQueueDelay",re.ONE_SECOND),Z(this,"expectedPairingMethodMap",new Map),Z(this,"recentlyDeletedMap",new Map),Z(this,"recentlyDeletedLimit",200),Z(this,"relayMessageCache",[]),Z(this,"pendingSessions",new Map),Z(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Yt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay)))}),Z(this,"connect",async n=>{var r;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=Zt(Ye({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=bW(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:u,relays:l,authentication:d,walletPay:f}=s,h=((r=d?.[0])==null?void 0:r.ttl)||Yt.wc_sessionPropose.req.ttl||re.FIVE_MINUTES;this.validateRequestExpiry(h);let g=i,p,y=!1;try{if(g){const $=this.client.core.pairing.pairings.get(g);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),y=$.active}}catch($){throw this.client.logger.error(`connect() -> pairing.get(${g}) failed`),$}if(!g||!y){const{topic:$,uri:L}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});g=$,p=L}if(!g){const{message:$}=se("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error($)}const E=await this.client.core.crypto.generateKeyPair(),A=Tt(h),w=Ye(Zt(Ye(Ye({requiredNamespaces:o,optionalNamespaces:a,relays:l??[{protocol:$T}],proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:A,pairingTopic:g},c&&{sessionProperties:c}),u&&{scopedProperties:u}),{id:us()}),(d||f)&&{requests:{authentication:d?.map($=>{const{domain:L,chains:M,nonce:D,uri:T,exp:O,nbf:m,type:b,statement:v,requestId:S,resources:I,signatureTypes:x}=$;return{domain:L,chains:M,nonce:D,type:b??"caip122",aud:T,version:"1",iat:new Date().toISOString(),exp:O,nbf:m,statement:v,requestId:S,resources:I,signatureTypes:x}}),walletPay:f}}),C=Xe("session_connect",w.id),{reject:_,resolve:P,done:k}=So(h,kC),U=({id:$})=>{$===w.id&&(this.client.events.off("proposal_expire",U),this.pendingSessions.delete(w.id),this.events.emit(C,{error:{message:kC,code:0}}))};return this.client.events.on("proposal_expire",U),this.events.once(C,({error:$,session:L})=>{this.client.events.off("proposal_expire",U),$?_($):L&&P(L)}),await this.setProposal(w.id,w),await this.sendProposeSession({proposal:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:w.id}}}).catch($=>{throw this.deleteProposal(w.id),$}),{uri:p,approval:k}}),Z(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),Z(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[Or.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(L){throw o.setError(bo.no_internet_connection),L}try{await this.isValidProposalId(n?.id)}catch(L){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(bo.proposal_not_found),L}try{await this.isValidApprove(n)}catch(L){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(bo.session_approve_namespace_validation_failure),L}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:f,proposalRequestsResponses:h}=n,g=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:y,requiredNamespaces:E,optionalNamespaces:A}=g;let w=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});w||(w=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Or.session_approve_started,properties:{topic:p,trace:[Or.session_approve_started,Or.session_namespaces_validation_success]}}));const C=await this.client.core.crypto.generateKeyPair(),_=y.publicKey,P=await this.client.core.crypto.generateSharedKey(C,_),k=Zt(Ye(Ye(Ye({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:C,metadata:this.client.metadata},expiry:Tt(Ra)},l&&{sessionProperties:l}),d&&{scopedProperties:d}),f&&{sessionConfig:f}),{proposalRequestsResponses:h}),U=it.relay;w.addTrace(Or.subscribing_session_topic);try{await this.client.core.relayer.subscribe(P,{transportType:U,internal:{skipSubscribe:!0}})}catch(L){throw w.setError(bo.subscribe_session_topic_failure),L}w.addTrace(Or.subscribe_session_topic_success);const $=Zt(Ye({},k),{topic:P,requiredNamespaces:E,optionalNamespaces:A,pairingTopic:p,acknowledged:!1,self:k.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:C,transportType:it.relay,authentication:h?.authentication,walletPayResult:h?.walletPay});await this.client.session.set(P,$),w.addTrace(Or.store_session);try{await this.sendApproveSession({sessionTopic:P,proposal:g,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:C},sessionSettleRequest:k,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:Ye({correlationId:a},this.getTVFApproveParams($))}}),w.addTrace(Or.session_approve_publish_success)}catch(L){throw this.client.logger.error(L),this.client.session.delete(P,ct("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(P),L}return this.client.core.eventClient.deleteEvent({eventId:w.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:y.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(P,Tt(Ra)),{topic:P,acknowledged:()=>Promise.resolve(this.client.session.get(P))}}),Z(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Yt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Z(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=So(re.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=us(),u=Vi().toString(),l=this.client.session.get(r).namespaces;return this.events.once(Xe("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:l}),a(d)}),{acknowledged:i}}),Z(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=us(),{done:i,resolve:o,reject:a}=So(re.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(Xe("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,Tt(Ra)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),Z(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(y){throw this.client.logger.error("request() -> isValidRequest() failed"),y}const{chainId:r,request:s,topic:i,expiry:o=Yt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===it.relay&&await this.confirmOnlineStateOrThrow();const c=us(),u=Vi().toString(),{done:l,resolve:d,reject:f}=So(o,"Request expired. Please try again.");this.events.once(Xe("session_request",c),({error:y,result:E})=>{y?f(y):d(E)});const h="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:h,params:{request:Zt(Ye({},s),{expiryTimestamp:Tt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(y=>f(y)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await l();const p={request:Zt(Ye({},s),{expiryTimestamp:Tt(o)}),chainId:r};return await Promise.all([new Promise(async y=>{await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:h,params:p,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,p)}).catch(E=>f(E)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),y()}),new Promise(async y=>{var E;if(!((E=a.sessionConfig)!=null&&E.disableDeepLink)){const A=await rq(this.client.core.storage,RC);await eq({id:c,topic:i,wcDeepLink:A})}y()}),l()]).then(y=>y[2])}),Z(this,"respond",async n=>{var r,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:n?.topic||((s=(r=n?.response)==null?void 0:r.id)==null?void 0:s.toString()),trace:[Or.session_request_response_started]}});try{await this.isValidRespond(n)}catch(d){throw i.addTrace(d?.message),i.setError(bo.session_request_response_validation_failure),d}i.addTrace(Or.session_request_response_validation_success);const{topic:o,response:a}=n,{id:c}=a,u=this.client.session.get(o);u.transportType===it.relay&&await this.confirmOnlineStateOrThrow();const l=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);try{i.addTrace(Or.session_request_response_publish_started),ls(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:l}):vr(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:l}),this.cleanupAfterResponse(n)}catch(d){throw i.addTrace(d?.message),i.setError(bo.session_request_response_publish_failure),d}}),Z(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=us(),i=Vi().toString(),{done:o,resolve:a,reject:c}=So(re.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(Xe("session_ping",s),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),Z(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Vi().toString(),a=us();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),Z(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:ct("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=se("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),Z(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>vW(r,n)))),Z(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Z(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?it.link_mode:it.relay;o===it.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:d,type:f,exp:h,nbf:g,methods:p=[],expiry:y}=n,E=[...n.resources||[]],{topic:A,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:w}});const C=await this.client.core.crypto.generateKeyPair(),_=Yd(C);if(await Promise.all([this.client.auth.authKeys.set(Jd,{responseTopic:_,publicKey:C}),this.client.auth.pairingTopics.set(_,{topic:_,pairingTopic:A})]),await this.client.core.relayer.subscribe(_,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),p.length>0){const{namespace:I}=ai(a[0]);let x=vz(I,"request",p);Gd(E)&&(x=_z(x,E.pop())),E.push(x)}const P=y&&y>Yt.wc_sessionAuthenticate.req.ttl?y:Yt.wc_sessionAuthenticate.req.ttl,k={authPayload:{type:f??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:d,iat:new Date().toISOString(),exp:h,nbf:g,resources:E},requester:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:Tt(P)},U={eip155:{chains:a,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},$={requiredNamespaces:{},optionalNamespaces:U,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:Tt(Yt.wc_sessionPropose.req.ttl),id:us()},{done:L,resolve:M,reject:D}=So(P,"Request expired"),T=us(),O=Xe("session_connect",$.id),m=Xe("session_request",T),b=async({error:I,session:x})=>{this.events.off(m,v),I?D(I):x&&M({session:x})},v=async I=>{var x,B,F;if(await this.deletePendingAuthRequest(T,{message:"fulfilled",code:0}),I.error){const J=ct("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return I.error.code===J.code?void 0:(this.events.off(O,b),D(I.error.message))}await this.deleteProposal($.id),this.events.off(O,b);const{cacaos:W,responder:j}=I.result,q=[],Y=[];for(const J of W){await Ev({cacao:J,projectId:this.client.core.projectId})||(this.client.logger.error(J,"Signature verification failed"),D(ct("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:te}=J,Ae=Gd(te.resources),Oe=[$m(te.iss)],Be=Jf(te.iss);if(Ae){const rt=vv(Ae),St=Cv(Ae);q.push(...rt),Oe.push(...St)}for(const rt of Oe)Y.push(`${rt}:${Be}`)}const Q=await this.client.core.crypto.generateSharedKey(C,j.publicKey);let ue;q.length>0&&(ue={topic:Q,acknowledged:!0,self:{publicKey:C,metadata:this.client.metadata},peer:j,controller:j.publicKey,expiry:Tt(Ra),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:Gv([...new Set(q)],[...new Set(Y)]),transportType:o},await this.client.core.relayer.subscribe(Q,{transportType:o}),await this.client.session.set(Q,ue),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:j.metadata}),ue=this.client.session.get(Q)),(x=this.client.metadata.redirect)!=null&&x.linkMode&&(B=j.metadata.redirect)!=null&&B.linkMode&&(F=j.metadata.redirect)!=null&&F.universal&&r&&(this.client.core.addLinkModeSupportedApp(j.metadata.redirect.universal),this.client.session.update(Q,{transportType:it.link_mode})),M({auths:W,session:ue})};this.events.once(O,b),this.events.once(m,v);let S;try{if(i){const I=Lr("wc_sessionAuthenticate",k,T);this.client.core.history.set(A,I);const x=await this.client.core.crypto.encode("",I,{type:Gl,encoding:ji});S=Cd(r,A,x)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:k,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:T}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:$,expiry:Yt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:$.id})])}catch(I){throw this.events.off(O,b),this.events.off(m,v),I}return await this.setProposal($.id,$),await this.setAuthRequest(T,{request:Zt(Ye({},k),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:S??w,response:L}}),Z(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[wo.authenticated_session_approve_started]}});try{this.isInitialized()}catch(y){throw i.setError(cu.no_internet_connection),y}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(cu.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||it.relay;a===it.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=Yd(c),d={type:ci,receiverPublicKey:c,senderPublicKey:u},f=[],h=[];for(const y of s){if(!await Ev({cacao:y,projectId:this.client.core.projectId})){i.setError(cu.invalid_cacao);const _=ct("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:_,encodeOpts:d}),new Error(_.message)}i.addTrace(wo.cacaos_verified);const{p:E}=y,A=Gd(E.resources),w=[$m(E.iss)],C=Jf(E.iss);if(A){const _=vv(A),P=Cv(A);f.push(..._),w.push(...P)}for(const _ of w)h.push(`${_}:${C}`)}const g=await this.client.core.crypto.generateSharedKey(u,c);i.addTrace(wo.create_authenticated_session_topic);let p;if(f?.length>0){p={topic:g,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Tt(Ra),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Gv([...new Set(f)],[...new Set(h)]),transportType:a},i.addTrace(wo.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(y){throw i.setError(cu.subscribe_authenticated_session_topic_failure),y}i.addTrace(wo.subscribe_authenticated_session_topic_success),await this.client.session.set(g,p),i.addTrace(wo.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(wo.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:s,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(y){throw i.setError(cu.authenticated_session_approve_publish_failure),y}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}}),Z(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===it.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Yd(o),u={type:ci,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:u,rpcOpts:Yt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),Z(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return j6(r,s)}),Z(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),Z(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),Z(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,ct("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(RC).catch(u=>this.client.logger.warn(u)),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=as.idle),await Promise.all(this.getPendingSessionRequests().filter(u=>u.topic===s).map(u=>this.deletePendingSessionRequest(u.id,ct("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),Z(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(bo.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,ct("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),Z(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=as.idle,this.client.events.emit("session_request_expire",{id:n}))}),Z(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),Z(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),Z(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,Tt(Yt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),Z(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=it.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),Z(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||Tt(Yt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),Z(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:d,publishOpts:f={}}=n,h=Lr(s,i,c);let g;const p=!!l;try{const A=p?ji:Mn;g=await this.client.core.crypto.encode(r,h,{encoding:A})}catch(A){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),A}let y;if(MZ.includes(s)){const A=Er(JSON.stringify(h)),w=Er(g);y=await this.client.core.verify.register({id:w,decryptedId:A})}const E=Ye(Ye({},Yt[s].req),f);if(E.attestation=y,o&&(E.ttl=o),a&&(E.id=a),this.client.core.history.set(r,h),p){const A=Cd(l,r,g);await globalThis.Linking.openURL(A,this.client.name)}else E.tvf=Zt(Ye({},d),{correlationId:h.id}),u?(E.internal=Zt(Ye({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,g,E)):this.client.core.relayer.publish(r,g,E).catch(A=>this.client.logger.error(A));return h.id}),Z(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=Lr("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:Mn}),a=Er(JSON.stringify(i)),c=Er(o),u=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Zt(Ye({},s),{publishMethod:"wc_proposeSession",attestation:u})})}),Z(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,c=hl(i.id,s),u=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:Mn}),l=Lr("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,l,{encoding:Mn});this.client.core.history.set(r,l),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:u,sessionSettlementRequest:d},opts:Zt(Ye({},a),{publishMethod:"wc_approveSession"})})}),Z(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,u=hl(r,i);let l;const d=c&&typeof globalThis?.Linking<"u";try{const g=d?ji:Mn;l=await this.client.core.crypto.encode(s,u,Zt(Ye({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),g}let f,h;try{f=await this.client.core.history.get(s,r);const g=f.request;try{h=this.getTVFParams(r,g.params,i)}catch(p){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${p?.message}`)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),g}if(d){const g=Cd(c,s,l);await globalThis.Linking.openURL(g,this.client.name)}else{const g=f.request.method,p=Yt[g].res;p.tvf=Zt(Ye({},h),{correlationId:r}),o?(p.internal=Zt(Ye({},p.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,l,p)):this.client.core.relayer.publish(s,l,p).catch(y=>this.client.logger.error(y))}await this.client.core.history.resolve(u)}),Z(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,u=gp(r,i);let l;const d=c&&typeof globalThis?.Linking<"u";try{const h=d?ji:Mn;l=await this.client.core.crypto.encode(s,u,Zt(Ye({},o||{}),{encoding:h}))}catch(h){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),h}let f;try{f=await this.client.core.history.get(s,r)}catch(h){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),h}if(d){const h=Cd(c,s,l);await globalThis.Linking.openURL(h,this.client.name)}else{const h=f.request.method,g=a||Yt[h].res;this.client.core.relayer.publish(s,l,g)}await this.client.core.history.resolve(u)}),Z(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;ds(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ds(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),Z(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),Z(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),Z(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===as.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=as.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=as.idle}),Z(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),Z(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),Z(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=se("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),Z(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Z(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const u=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u?.setError(zs.proposal_listener_not_found)),this.isValidConnect(Ye({},s.params));const l=a.expiryTimestamp||Tt(Yt.wc_sessionPropose.req.ttl),d=Ye({id:c,pairingTopic:r,expiryTimestamp:l,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const f=await this.getVerifyContext({attestationId:i,hash:Er(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});u?.addTrace(cs.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:f})}catch(u){await this.sendError({id:c,topic:r,error:u,rpcOpts:Yt.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),Z(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(ls(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(l,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(vr(r)){await this.deleteProposal(i);const o=Xe("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),Z(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:f,proposalRequestsResponses:h}=r.params,g=[...this.pendingSessions.values()].find(E=>E.sessionTopic===n);if(!g)return this.client.logger.error(`Pending session not found for topic ${n}`);const p=this.client.proposal.get(g.proposalId),y=Zt(Ye(Ye(Ye({topic:n,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:g.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:g.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),d&&{scopedProperties:d}),f&&{sessionConfig:f}),{transportType:it.relay,authentication:h?.authentication,walletPayResult:h?.walletPay});await this.client.session.set(y.topic,y),await this.setExpiry(y.topic,y.expiry),await this.client.core.pairing.updateMetadata({topic:g.pairingTopic,metadata:y.peer.metadata}),this.pendingSessions.delete(g.proposalId),this.deleteProposal(g.proposalId,!1),this.cleanupDuplicatePairings(y),await this.sendResult({id:r.id,topic:n,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:y}),this.events.emit(Xe("session_connect",g.proposalId),{session:y})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Z(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;ls(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Xe("session_approve",s),{})):vr(r)&&(await this.client.session.delete(n,ct("USER_DISCONNECTED")),this.events.emit(Xe("session_approve",s),{error:r.error}))}),Z(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=ou.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:ct("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ye({topic:n},s));try{ou.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw ou.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),Z(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),Z(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=Xe("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ls(r)?this.events.emit(Xe("session_update",s),{}):vr(r)&&this.events.emit(Xe("session_update",s),{error:r.error})}),Z(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,Tt(Ra)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Z(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=Xe("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ls(r)?this.events.emit(Xe("session_extend",s),{}):vr(r)&&this.events.emit(Xe("session_extend",s),{error:r.error})}),Z(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Z(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=Xe("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);ls(r)?this.events.emit(Xe("session_ping",s),{}):vr(r)&&this.events.emit(Xe("session_ping",s),{error:r.error})},500)}),Z(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{await this.isValidDisconnect({topic:n,reason:r.params}),this.cleanupPendingSentRequestsForTopic({topic:n,error:ct("USER_DISCONNECTED")}),await this.deleteSession({topic:n,id:s})}catch(i){this.client.logger.error(i)}}),Z(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=n,{id:d,params:f}=a;try{await this.isValidRequest(Ye({topic:o},f));const h=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:Er(JSON.stringify(Lr("wc_sessionRequest",f,d))),encryptedId:u,metadata:h.peer.metadata,transportType:l}),p={id:d,topic:o,params:f,verifyContext:g};await this.setPendingSessionRequest(p),l===it.link_mode&&(r=h.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=h.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(p):(this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue())}catch(h){await this.sendError({id:d,topic:o,error:h}),this.client.logger.error(h)}}),Z(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=Xe("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);ls(r)?this.events.emit(Xe("session_request",s),{result:r.result}):vr(r)&&this.events.emit(Xe("session_request",s),{error:r.error})}),Z(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=ou.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Ye({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),ou.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Z(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),ls(r)?this.events.emit(Xe("session_request",s),{result:r.result}):vr(r)&&this.events.emit(Xe("session_request",s),{error:r.error})}),Z(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:u,authPayload:l,expiryTimestamp:d}=i.params,f=await this.getVerifyContext({attestationId:o,hash:Er(JSON.stringify(i)),encryptedId:a,metadata:u.metadata,transportType:c}),h={requester:u,pairingTopic:s,id:i.id,authPayload:l,verifyContext:f,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:h,pairingTopic:s,transportType:c}),c===it.link_mode&&(r=u.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(u){this.client.logger.error(u);const l=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,c),h={type:ci,receiverPublicKey:l,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:u,encodeOpts:h,rpcOpts:Yt.wc_sessionAuthenticate.autoReject,appLink:f})}}),Z(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),Z(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=as.idle,this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay))}),Z(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(Xe("session_request",i.request.id),{error:r})})}),Z(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===as.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),Z(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=as.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),Z(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:Lr("wc_sessionPropose",Zt(Ye({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),Z(this,"isValidConnect",async n=>{if(!Rn(n)){const{message:u}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(u)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(jt(r)||await this.isValidPairingTopic(r),!kW(c)){const{message:u}=se("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(s&&!jt(s)&&_s(s)!==0){const u="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(u):this.client.logger.warn(u),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!jt(i)&&_s(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!jt(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!jt(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(l=>u.includes(l.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),Z(this,"validateNamespaces",(n,r)=>{const s=RW(n,"connect()",r);if(s)throw new Error(s.message)}),Z(this,"isValidApprove",async n=>{if(!Rn(n))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),u=Q0(s,"approve()");if(u)throw new Error(u.message);const l=Jv(c.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!xt(i,!0)){const{message:d}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!jt(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!jt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(f=>d.has(f.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),Z(this,"isValidReject",async n=>{if(!Rn(n)){const{message:i}=se("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!DW(s)){const{message:i}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),Z(this,"isValidSessionSettleRequest",n=>{if(!Rn(n)){const{message:u}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(u)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!ST(r)){const{message:u}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=IW(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Q0(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ds(o)){const{message:u}=se("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),Z(this,"isValidUpdate",async n=>{if(!Rn(n)){const{message:c}=se("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Q0(s,"update()");if(o)throw new Error(o.message);const a=Jv(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),Z(this,"isValidExtend",async n=>{if(!Rn(n)){const{message:s}=se("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),Z(this,"isValidRequest",async n=>{if(!Rn(n)){const{message:c}=se("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!Zv(a,i)){const{message:c}=se("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!UW(s)){const{message:c}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!LW(a,i,s.method)){const{message:c}=se("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),Z(this,"isValidRespond",async n=>{var r;if(!Rn(n)){const{message:a}=se("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(a)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(a){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),a}if(!BW(i)){const{message:a}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=se("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),Z(this,"isValidPing",async n=>{if(!Rn(n)){const{message:s}=se("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Z(this,"isValidEmit",async n=>{if(!Rn(n)){const{message:a}=se("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!Zv(o,i)){const{message:a}=se("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!MW(s)){const{message:a}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!FW(o,i,s.name)){const{message:a}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),Z(this,"isValidDisconnect",async n=>{if(!Rn(n)){const{message:s}=se("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Z(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!xt(s,!1))throw new Error("uri is required parameter");if(!xt(i,!1))throw new Error("domain is required parameter");if(!xt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>ai(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ai(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Z(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Ru,validation:"UNKNOWN",origin:o.url||""}};try{if(a===it.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),Z(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=se("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),Z(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),Z(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),Z(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=se("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),Z(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,u,l,d,f;return!n||r!==it.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=n?.redirect)==null?void 0:l.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((f=n?.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof globalThis?.Linking<"u"}),Z(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),Z(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=cv(n,"topic")||"",s=decodeURIComponent(cv(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:it.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),Z(this,"registerLinkModeListeners",async()=>{var n;if(Jb()||fo()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=globalThis?.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),Z(this,"getTVFApproveParams",n=>{try{const r=_T(n.namespaces),s=hW(n.namespaces),i=pW(n.namespaces),o=n.sessionProperties,a=n.scopedProperties;return{approvedChains:r,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(r){return this.client.logger.warn(r,"Error getting TVF approve params"),{}}}),Z(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const u=this.extractTxHashesFromResult(r.request,s);c.txHashes=u,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(u){this.client.logger.warn(u,"Error getting TVF params")}return c}),Z(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),Z(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=UZ[i];if(i==="sui_signTransaction")return[nz(r.transactionBytes)];if(i==="near_signTransaction")return[mv(r)];if(i==="near_signTransactions")return r.map(c=>mv(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[sV({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return ui(r)?r.map(c=>yv(c)):[yv(r)];if(i==="cosmos_signDirect")return[sz(r)];if(i==="wallet_sendCalls")return iz(r);if(typeof r=="string")return[r];const a=r[o.key];if(ui(a))return i==="solana_signAllTransactions"?a.map(c=>tz(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=se("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Nt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Jd)?this.client.auth.authKeys.get(Jd):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===it.link_mode?ji:Mn});lw(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:Er(r)})):mp(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${r}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(yr.expired,async e=>{const{topic:n,id:r}=A6(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,se("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,se("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(To.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(To.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!xt(e,!1)){const{message:n}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(ds(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=se("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!xt(e,!1)){const{message:n}=se("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(ds(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=se("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=se("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(xt(e,!1)){const{message:n}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!$W(e)){const{message:n}=se("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(ds(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=se("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}validateRequestExpiry(e){if(e&&!zW(e,og)){const{message:n}=se("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${og.min} and ${og.max}`);throw new Error(n)}}}class ZZ extends Ea{constructor(e,n){super(e,n,kZ,fw),this.core=e,this.logger=n}}let JZ=class extends Ea{constructor(e,n){super(e,n,$Z,fw),this.core=e,this.logger=n}};class XZ extends Ea{constructor(e,n){super(e,n,BZ,fw,r=>r.id),this.core=e,this.logger=n}}class QZ extends Ea{constructor(e,n){super(e,n,jZ,bp,()=>Jd),this.core=e,this.logger=n}}class eJ extends Ea{constructor(e,n){super(e,n,qZ,bp),this.core=e,this.logger=n}}class tJ extends Ea{constructor(e,n){super(e,n,zZ,bp,r=>r.id),this.core=e,this.logger=n}}var nJ=Object.defineProperty,rJ=(t,e,n)=>e in t?nJ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ag=(t,e,n)=>rJ(t,typeof e!="symbol"?e+"":e,n);class sJ{constructor(e,n){this.core=e,this.logger=n,ag(this,"authKeys"),ag(this,"pairingTopics"),ag(this,"requests"),this.authKeys=new QZ(this.core,this.logger),this.pairingTopics=new eJ(this.core,this.logger),this.requests=new tJ(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var iJ=Object.defineProperty,oJ=(t,e,n)=>e in t?iJ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Le=(t,e,n)=>oJ(t,typeof e!="symbol"?e+"":e,n);class hw extends i9{constructor(e){super(e),Le(this,"protocol",YT),Le(this,"version",ZT),Le(this,"name",ig.name),Le(this,"metadata"),Le(this,"core"),Le(this,"logger"),Le(this,"events",new ts.EventEmitter),Le(this,"engine"),Le(this,"session"),Le(this,"proposal"),Le(this,"pendingRequest"),Le(this,"auth"),Le(this,"signConfig"),Le(this,"on",(r,s)=>this.events.on(r,s)),Le(this,"once",(r,s)=>this.events.once(r,s)),Le(this,"off",(r,s)=>this.events.off(r,s)),Le(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Le(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Le(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Le(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Le(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Le(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||ig.name,this.metadata=Gj(e?.metadata),this.signConfig=e?.signConfig;const n=cw({logger:e?.logger||ig.logger,name:this.name});this.logger=n,this.core=e?.core||new RZ(e),this.session=new JZ(this.core,this.logger),this.proposal=new ZZ(this.core,this.logger),this.pendingRequest=new XZ(this.core,this.logger),this.engine=new YZ(this),this.auth=new sJ(this.core,this.logger)}static async init(e){const n=new hw(e);return await n.initialize(),n}get context(){return Hn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const aJ=hw;var _d={exports:{}},DC;function cJ(){return DC||(DC=1,(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof globalThis<"u"&&globalThis,r=(function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof i<"u"&&i||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(m){return m&&DataView.prototype.isPrototypeOf(m)}if(c.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(m){return m&&l.indexOf(Object.prototype.toString.call(m))>-1};function f(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(m)||m==="")throw new TypeError('Invalid character in header field name: "'+m+'"');return m.toLowerCase()}function h(m){return typeof m!="string"&&(m=String(m)),m}function g(m){var b={next:function(){var v=m.shift();return{done:v===void 0,value:v}}};return c.iterable&&(b[Symbol.iterator]=function(){return b}),b}function p(m){this.map={},m instanceof p?m.forEach(function(b,v){this.append(v,b)},this):Array.isArray(m)?m.forEach(function(b){if(b.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+b.length);this.append(b[0],b[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(b){this.append(b,m[b])},this)}p.prototype.append=function(m,b){m=f(m),b=h(b);var v=this.map[m];this.map[m]=v?v+", "+b:b},p.prototype.delete=function(m){delete this.map[f(m)]},p.prototype.get=function(m){return m=f(m),this.has(m)?this.map[m]:null},p.prototype.has=function(m){return this.map.hasOwnProperty(f(m))},p.prototype.set=function(m,b){this.map[f(m)]=h(b)},p.prototype.forEach=function(m,b){for(var v in this.map)this.map.hasOwnProperty(v)&&m.call(b,this.map[v],v,this)},p.prototype.keys=function(){var m=[];return this.forEach(function(b,v){m.push(v)}),g(m)},p.prototype.values=function(){var m=[];return this.forEach(function(b){m.push(b)}),g(m)},p.prototype.entries=function(){var m=[];return this.forEach(function(b,v){m.push([v,b])}),g(m)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function y(m){if(!m._noBody){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}}function E(m){return new Promise(function(b,v){m.onload=function(){b(m.result)},m.onerror=function(){v(m.error)}})}function A(m){var b=new FileReader,v=E(b);return b.readAsArrayBuffer(m),v}function w(m){var b=new FileReader,v=E(b),S=/charset=([A-Za-z0-9_-]+)/.exec(m.type),I=S?S[1]:"utf-8";return b.readAsText(m,I),v}function C(m){for(var b=new Uint8Array(m),v=new Array(b.length),S=0;S<b.length;S++)v[S]=String.fromCharCode(b[S]);return v.join("")}function _(m){if(m.slice)return m.slice(0);var b=new Uint8Array(m.byteLength);return b.set(new Uint8Array(m)),b.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(m){this.bodyUsed=this.bodyUsed,this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:c.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:c.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():c.arrayBuffer&&c.blob&&u(m)?(this._bodyArrayBuffer=_(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||d(m))?this._bodyArrayBuffer=_(m):this._bodyText=m=Object.prototype.toString.call(m):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var m=y(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var m=y(this);return m||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var m=y(this);if(m)return m;if(this._bodyBlob)return w(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(C(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}var k=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function U(m){var b=m.toUpperCase();return k.indexOf(b)>-1?b:m}function $(m,b){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');b=b||{};var v=b.body;if(m instanceof $){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,b.headers||(this.headers=new p(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!v&&m._bodyInit!=null&&(v=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new p(b.headers)),this.method=U(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal||(function(){if("AbortController"in a){var x=new AbortController;return x.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&v)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(v),(this.method==="GET"||this.method==="HEAD")&&(b.cache==="no-store"||b.cache==="no-cache")){var S=/([?&])_=[^&]*/;if(S.test(this.url))this.url=this.url.replace(S,"$1_="+new Date().getTime());else{var I=/\?/;this.url+=(I.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}$.prototype.clone=function(){return new $(this,{body:this._bodyInit})};function L(m){var b=new FormData;return m.trim().split("&").forEach(function(v){if(v){var S=v.split("="),I=S.shift().replace(/\+/g," "),x=S.join("=").replace(/\+/g," ");b.append(decodeURIComponent(I),decodeURIComponent(x))}}),b}function M(m){var b=new p,v=m.replace(/\r?\n[\t ]+/g," ");return v.split("\r").map(function(S){return S.indexOf(`
`)===0?S.substr(1,S.length):S}).forEach(function(S){var I=S.split(":"),x=I.shift().trim();if(x){var B=I.join(":").trim();try{b.append(x,B)}catch(F){console.warn("Response "+F.message)}}}),b}P.call($.prototype);function D(m,b){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=b.statusText===void 0?"":""+b.statusText,this.headers=new p(b.headers),this.url=b.url||"",this._initBody(m)}P.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},D.error=function(){var m=new D(null,{status:200,statusText:""});return m.ok=!1,m.status=0,m.type="error",m};var T=[301,302,303,307,308];D.redirect=function(m,b){if(T.indexOf(b)===-1)throw new RangeError("Invalid status code");return new D(null,{status:b,headers:{location:m}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,v){this.message=b,this.name=v;var S=Error(b);this.stack=S.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function O(m,b){return new Promise(function(v,S){var I=new $(m,b);if(I.signal&&I.signal.aborted)return S(new o.DOMException("Aborted","AbortError"));var x=new XMLHttpRequest;function B(){x.abort()}x.onload=function(){var j={statusText:x.statusText,headers:M(x.getAllResponseHeaders()||"")};I.url.indexOf("file://")===0&&(x.status<200||x.status>599)?j.status=200:j.status=x.status,j.url="responseURL"in x?x.responseURL:j.headers.get("X-Request-URL");var q="response"in x?x.response:x.responseText;setTimeout(function(){v(new D(q,j))},0)},x.onerror=function(){setTimeout(function(){S(new TypeError("Network request failed"))},0)},x.ontimeout=function(){setTimeout(function(){S(new TypeError("Network request timed out"))},0)},x.onabort=function(){setTimeout(function(){S(new o.DOMException("Aborted","AbortError"))},0)};function F(j){try{return j===""&&a.location.href?a.location.href:j}catch{return j}}if(x.open(I.method,F(I.url),!0),I.credentials==="include"?x.withCredentials=!0:I.credentials==="omit"&&(x.withCredentials=!1),"responseType"in x&&(c.blob?x.responseType="blob":c.arrayBuffer&&(x.responseType="arraybuffer")),b&&typeof b.headers=="object"&&!(b.headers instanceof p||a.Headers&&b.headers instanceof a.Headers)){var W=[];Object.getOwnPropertyNames(b.headers).forEach(function(j){W.push(f(j)),x.setRequestHeader(j,h(b.headers[j]))}),I.headers.forEach(function(j,q){W.indexOf(q)===-1&&x.setRequestHeader(q,j)})}else I.headers.forEach(function(j,q){x.setRequestHeader(q,j)});I.signal&&(I.signal.addEventListener("abort",B),x.onreadystatechange=function(){x.readyState===4&&I.signal.removeEventListener("abort",B)}),x.send(typeof I._bodyInit>"u"?null:I._bodyInit)})}return O.polyfill=!0,a.fetch||(a.fetch=O,a.Headers=p,a.Request=$,a.Response=D),o.Headers=p,o.Request=$,o.Response=D,o.fetch=O,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(_d,_d.exports)),_d.exports}var uJ=cJ();const UC=aa(uJ);var lJ=Object.defineProperty,dJ=Object.defineProperties,fJ=Object.getOwnPropertyDescriptors,BC=Object.getOwnPropertySymbols,hJ=Object.prototype.hasOwnProperty,pJ=Object.prototype.propertyIsEnumerable,MC=(t,e,n)=>e in t?lJ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,LC=(t,e)=>{for(var n in e||(e={}))hJ.call(e,n)&&MC(t,n,e[n]);if(BC)for(var n of BC(e))pJ.call(e,n)&&MC(t,n,e[n]);return t},FC=(t,e)=>dJ(t,fJ(e));const gJ={Accept:"application/json","Content-Type":"application/json"},mJ="POST",jC={headers:gJ,method:mJ},qC=10;let XT=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new ts.EventEmitter,this.isAvailable=!1,this.registering=!1,!sC(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=fi(e),r=await(await UC(this.url,FC(LC({},jC),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!sC(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=fi({id:1,jsonrpc:"2.0",method:"test",params:[]});await UC(e,FC(LC({},jC),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?Yo(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=gp(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return NT(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>qC&&this.events.setMaxListeners(qC)}};function pw(t){return t==null||typeof t!="object"&&typeof t!="function"}function QT(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function eN(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const yJ="[object RegExp]",tN="[object String]",nN="[object Number]",rN="[object Boolean]",sN="[object Arguments]",bJ="[object Symbol]",wJ="[object Date]",EJ="[object Map]",vJ="[object Set]",CJ="[object Array]",_J="[object ArrayBuffer]",AJ="[object Object]",SJ="[object DataView]",IJ="[object Uint8Array]",TJ="[object Uint8ClampedArray]",NJ="[object Uint16Array]",xJ="[object Uint32Array]",PJ="[object Int8Array]",OJ="[object Int16Array]",RJ="[object Int32Array]",kJ="[object Float32Array]",$J="[object Float64Array]";function gw(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function DJ(t,e){return Ka(t,void 0,t,new Map,e)}function Ka(t,e,n,r=new Map,s=void 0){const i=s?.(t,e,n,r);if(i!=null)return i;if(pw(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Ka(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,Ka(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(Ka(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(gw(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Ka(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),No(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),No(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),No(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,No(o,t,n,r,s),o}if(typeof t=="object"&&UJ(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),No(o,t,n,r,s),o}return t}function No(t,e,n=t,r,s){const i=[...Object.keys(e),...QT(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Ka(e[a],a,n,r,s))}}function UJ(t){switch(eN(t)){case sN:case CJ:case _J:case SJ:case rN:case wJ:case kJ:case $J:case PJ:case OJ:case RJ:case EJ:case nN:case AJ:case yJ:case vJ:case tN:case bJ:case IJ:case TJ:case NJ:case xJ:return!0;default:return!1}}function BJ(t,e){return DJ(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case nN:case tN:case rN:{const o=new t.constructor(t?.valueOf());return No(o,t),o}case sN:{const o={};return No(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function zC(t){return BJ(t)}function HC(t){return t!==null&&typeof t=="object"&&eN(t)==="[object Arguments]"}function WC(t){return typeof t=="object"&&t!==null}function MJ(){}function LJ(t){return gw(t)}function FJ(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function jJ(t){if(pw(t))return t;if(Array.isArray(t)||gw(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function qJ(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=ay(s,o,r,new Map)}return s}function ay(t,e,n,r){if(pw(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return jJ(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...QT(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(HC(a)&&(a={...a}),HC(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=zC(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const l=[],d=Reflect.ownKeys(c);for(let f=0;f<d.length;f++){const h=d[f];l[h]=c[h]}c=l}else c=[];const u=n(c,a,o,t,e,r);u!=null?t[o]=u:Array.isArray(a)||WC(c)&&WC(a)?t[o]=ay(c,a,n,r):c==null&&FJ(a)?t[o]=ay({},a,n,r):c==null&&LJ(a)?t[o]=zC(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function zJ(t,...e){return qJ(t,...e,MJ)}const VC="error",HJ="wss://relay.walletconnect.org",WJ="wc",iN="universal_provider",Ad=`${WJ}@2:${iN}:`,oN="https://rpc.walletconnect.org/v1/",aN="generic",VJ=`${oN}bundler`,sc="call_status",KJ=86400,mw={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var GJ=Object.defineProperty,YJ=Object.defineProperties,ZJ=Object.getOwnPropertyDescriptors,KC=Object.getOwnPropertySymbols,JJ=Object.prototype.hasOwnProperty,XJ=Object.prototype.propertyIsEnumerable,GC=(t,e,n)=>e in t?GJ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sd=(t,e)=>{for(var n in e||(e={}))JJ.call(e,n)&&GC(t,n,e[n]);if(KC)for(var n of KC(e))XJ.call(e,n)&&GC(t,n,e[n]);return t},QJ=(t,e)=>YJ(t,ZJ(e));function cN(t,e,n){var r;const s=ai(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${oN}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function eX(t){return t.includes(":")?t.split(":")[1]:t}function uN(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function tX(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function YC(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function Id(t={},e={}){const n=YC(ZC(t)),r=YC(ZC(e));return zJ(n,r)}function ZC(t){var e,n,r,s,i;const o={};if(!_s(t))return o;for(const[a,c]of Object.entries(t)){const u=pp(a)?[a]:c.chains,l=c.methods||[],d=c.events||[],f=c.rpcMap||{},h=Va(a);o[h]=QJ(Sd(Sd({},o[h]),c),{chains:Cs(u,(e=o[h])==null?void 0:e.chains),methods:Cs(l,(n=o[h])==null?void 0:n.methods),events:Cs(d,(r=o[h])==null?void 0:r.events)}),(_s(f)||_s(((s=o[h])==null?void 0:s.rpcMap)||{}))&&(o[h].rpcMap=Sd(Sd({},f),(i=o[h])==null?void 0:i.rpcMap))}return o}function JC(t){return t.includes(":")?t.split(":")[2]:t}function XC(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=pp(n)?[n]:r.chains?r.chains:uN(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function cg(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function nX(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const lN={},ic=t=>lN[t],ug=(t,e)=>{lN[t]=e};var rX=Object.defineProperty,QC=Object.getOwnPropertySymbols,sX=Object.prototype.hasOwnProperty,iX=Object.prototype.propertyIsEnumerable,e_=(t,e,n)=>e in t?rX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,t_=(t,e)=>{for(var n in e||(e={}))sX.call(e,n)&&e_(t,n,e[n]);if(QC)for(var n of QC(e))iX.call(e,n)&&e_(t,n,e[n]);return t};const n_="eip155",oX=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],aX=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,lg=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,r_=t=>Object.keys(t).filter(e=>oX.includes(e)).reduce((e,n)=>(e[n]=cX(t[n]),e),{}),cX=t=>typeof t=="string"&&nX(t)?JSON.parse(t):t,uX=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!_s(s)&&!_s(r))return;const o=r_(r);for(const a of n){const c=aX(a);if(!c)continue;i[lg(c)]=o;const u=s?.[`${n_}:${c}`];if(u){const l=u?.[`${n_}:${c}:${e}`];i[lg(c)]=t_(t_({},i[lg(c)]),r_(l||u))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var lX=Object.defineProperty,dX=(t,e,n)=>e in t?lX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fX=(t,e,n)=>dX(t,e+"",n);let dg;class yw{constructor(e){fX(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,n){return await this.storage.setItem(e,n)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return dg||(dg=new yw(e)),dg}}var hX=Object.defineProperty,pX=Object.defineProperties,gX=Object.getOwnPropertyDescriptors,s_=Object.getOwnPropertySymbols,mX=Object.prototype.hasOwnProperty,yX=Object.prototype.propertyIsEnumerable,i_=(t,e,n)=>e in t?hX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bX=(t,e)=>{for(var n in e||(e={}))mX.call(e,n)&&i_(t,n,e[n]);if(s_)for(var n of s_(e))yX.call(e,n)&&i_(t,n,e[n]);return t},wX=(t,e)=>pX(t,gX(e));async function EX(t,e){const n=ai(t.result.capabilities.caip345.caip2),r=t.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(r.map(d=>vX(n.reference,d,e))),i=s.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);s.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));const o=!i.length||i.some(d=>!d),a=i.every(d=>d?.status==="0x1"),c=i.every(d=>d?.status==="0x0"),u=i.some(d=>d?.status==="0x0");let l;return o?l=100:a?l=200:c?l=500:u&&(l=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:i,status:l}}async function vX(t,e,n){return await n(parseInt(t)).request(Lr("eth_getTransactionReceipt",[e]))}async function CX({sendCalls:t,storage:e}){const n=await e.getItem(sc);await e.setItem(sc,wX(bX({},n),{[t.result.id]:{request:t.request,result:t.result,expiry:Tt(KJ)}}))}async function _X({resultId:t,storage:e}){const n=await e.getItem(sc);if(n){delete n[t],await e.setItem(sc,n);for(const r in n)ds(n[r].expiry)&&delete n[r];await e.setItem(sc,n)}}async function AX({resultId:t,storage:e}){const n=await e.getItem(sc),r=n?.[t];if(r&&!ds(r.expiry))return r;await _X({resultId:t,storage:e})}var SX=Object.defineProperty,IX=Object.defineProperties,TX=Object.getOwnPropertyDescriptors,o_=Object.getOwnPropertySymbols,NX=Object.prototype.hasOwnProperty,xX=Object.prototype.propertyIsEnumerable,cy=(t,e,n)=>e in t?SX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fg=(t,e)=>{for(var n in e||(e={}))NX.call(e,n)&&cy(t,n,e[n]);if(o_)for(var n of o_(e))xX.call(e,n)&&cy(t,n,e[n]);return t},hg=(t,e)=>IX(t,TX(e)),Eo=(t,e,n)=>cy(t,typeof e!="symbol"?e+"":e,n);class PX{constructor(e){Eo(this,"name","eip155"),Eo(this,"client"),Eo(this,"chainId"),Eo(this,"namespace"),Eo(this,"httpProviders"),Eo(this,"events"),Eo(this,"storage"),this.namespace=e.namespace,this.events=ic("events"),this.client=ic("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=yw.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n);const r=this.chainId;this.chainId=parseInt(e),this.events.emit(mw.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||cN(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new dw(new XT(r,ic("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(eX(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(e){const n=e||this.chainId;return this.httpProviders[n]||(this.httpProviders=hg(fg({},this.httpProviders),{[n]:this.createHttpProvider(n)}),this.httpProviders[n])}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const u=this.client.session.get(e.topic),l=((o=u?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,f=l?.[d];if(f)return f;let h;try{h=uX(u,a,c)}catch(p){console.warn("Failed to extract capabilities from session",p)}if(h)return h;const g=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:hg(fg({},u.sessionProperties||{}),{capabilities:hg(fg({},l||{}),{[d]:g})})})}catch(p){console.warn("Failed to update session with capabilities",p)}return g}async getCallStatus(e){var n,r,s;const i=this.client.session.get(e.topic),o=(n=i.sessionProperties)==null?void 0:n.bundler_name;if(o){const u=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(u,e)}catch(l){console.warn("Failed to fetch call status from bundler",l,u)}}const a=(r=i.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(u){console.warn("Failed to fetch call status from custom bundler",u,a)}const c=await AX({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await EX(c,this.getHttpProvider.bind(this))}catch(u){console.warn("Failed to fetch call status from stored send calls",u,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Lr("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${VJ}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}async sendCalls(e){var n,r,s;const i=await this.client.request(e),o=(n=e.request.params)==null?void 0:n[0],a=i?.id,c=i?.capabilities||{},u=(r=c?.caip345)==null?void 0:r.caip2,l=(s=c?.caip345)==null?void 0:s.transactionHashes;return!a||!u||!(l!=null&&l.length)||await CX({sendCalls:{request:o,result:i},storage:this.storage}),i}}var OX=Object.defineProperty,RX=(t,e,n)=>e in t?OX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ka=(t,e,n)=>RX(t,typeof e!="symbol"?e+"":e,n);class kX{constructor(e){ka(this,"name",aN),ka(this,"client"),ka(this,"httpProviders"),ka(this,"events"),ka(this,"namespace"),ka(this,"chainId"),this.namespace=e.namespace,this.events=ic("events"),this.client=ic("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n);const r=this.chainId;this.chainId=e,this.events.emit(mw.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return ai(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{var i,o;const a=ai(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(s,c)}),r}getHttpProvider(e){const n=ai(e).reference,r=this.httpProviders[n];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||cN(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new dw(new XT(r,ic("disableProviderPing")))}}var $X=Object.defineProperty,DX=Object.defineProperties,UX=Object.getOwnPropertyDescriptors,a_=Object.getOwnPropertySymbols,BX=Object.prototype.hasOwnProperty,MX=Object.prototype.propertyIsEnumerable,uy=(t,e,n)=>e in t?$X(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,du=(t,e)=>{for(var n in e||(e={}))BX.call(e,n)&&uy(t,n,e[n]);if(a_)for(var n of a_(e))MX.call(e,n)&&uy(t,n,e[n]);return t},Td=(t,e)=>DX(t,UX(e)),Xn=(t,e,n)=>uy(t,typeof e!="symbol"?e+"":e,n);let LX=class dN{constructor(e){Xn(this,"client"),Xn(this,"namespaces"),Xn(this,"optionalNamespaces"),Xn(this,"sessionProperties"),Xn(this,"scopedProperties"),Xn(this,"events",new vy),Xn(this,"rpcProviders",{}),Xn(this,"session"),Xn(this,"providerOpts"),Xn(this,"logger"),Xn(this,"uri"),Xn(this,"disableProviderPing",!1),Xn(this,"connectParams");var n,r;this.providerOpts=e,this.logger=cw({logger:(n=e.logger)!=null?n:VC,name:(r=this.providerOpts.name)!=null?r:iN}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const n=new dN(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:du({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,hl(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:ct("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=XC(this.session.namespaces);this.namespaces=Id(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){var n,r;const{uri:s,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(n=this.connectParams)==null?void 0:n.authentication,walletPay:(r=this.connectParams)==null?void 0:r.walletPay});s&&(this.uri=s,this.events.emit("display_uri",s));const o=await i();this.session=o;const a=XC(o.namespaces);return this.namespaces=Id(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!ui(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn(n,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await aJ.init({core:this.providerOpts.core,logger:this.providerOpts.logger||VC,relayUrl:this.providerOpts.relayUrl||HJ,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Va(n)))];ug("client",this.client),ug("events",this.events),ug("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=tX(n,this.session);if(r?.length===0)return;const s=uN(r),i=Id(this.namespaces,this.optionalNamespaces),o=Td(du({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new PX({namespace:o});break;default:this.rpcProviders[n]=new kX({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&ui(o)&&this.events.emit("accountsChanged",o.map(JC))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Va(o),u=cg(o)!==cg(a)?`${c}:${cg(a)}`:o;this.onChainChanged({currentCaipChainId:u})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Td(du({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Td(du({},ct("USER_DISCONNECTED")),{data:e.topic})))}),this.on(mw.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(Td(du({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[aN]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Id(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Va(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Va(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:n,internal:r=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),r?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:n})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:n,previousCaipChainId:r}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(JC);if(!ui(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Ad}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Ad}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Ad}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Ad)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn(n,"Failed to cleanup storage")}}};const c_=2147483648,FX={convertEVMChainIdToCoinType(t){if(t>=c_)throw new Error("Invalid chainId");return(c_|t)>>>0}},gr=Je({suggestions:[],loading:!1}),jX={state:gr,subscribe(t){return vt(gr,()=>t(gr))},subscribeKey(t,e){return bt(gr,t,e)},async resolveName(t){try{return await Ee.lookupEnsName(t)}catch(e){const n=e;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await Ee.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{gr.loading=!0,gr.suggestions=[];const e=await Ee.getEnsNameSuggestions(t);return gr.suggestions=e.suggestions||[],gr.suggestions}catch(e){const n=$u.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{gr.loading=!1}},async getNamesForAddress(t){try{if(!R.state.activeCaipNetwork)return[];const n=G.getEnsFromCacheForAddress(t);if(n)return n;const r=await Ee.reverseLookupEnsName({address:t});return G.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=$u.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=R.state.activeCaipNetwork,n=R.getAccountData(e?.chainNamespace)?.address,r=X.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");gr.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});de.pushTransactionStack({onCancel(){de.replace("RegisterAccountName")}});const i=await ie.signMessage(s);gr.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=FX.convertEVMChainIdToCoinType(Number(o));await Ee.registerEnsName({coinType:a,address:n,signature:i,message:s}),R.setAccountProp("profileName",t,e.chainNamespace),G.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),de.replace("RegisterAccountNameSuccess")}catch(s){const i=$u.parseEnsApiError(s,`Error registering name ${t}`);throw de.replace("RegisterAccountName"),new Error(i)}finally{gr.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},$u=Yn(jX);function ly(t){try{return new URL(t)}catch{return null}}function qX(t){const e=t.split("/"),n=e.length>0&&e[0]!==void 0?e[0]:"",r=n.lastIndexOf(":");return r===-1?{host:n}:{host:n.slice(0,r),port:n.slice(r+1)}}function zX(t){const e=t.indexOf("://");if(e===-1)return null;const n=t.slice(0,e),r=e+3;let s=t.indexOf("/",r);s===-1&&(s=t.length);const i=t.slice(r,s),o=i.lastIndexOf(":");return o===-1?{scheme:n,host:i}:{scheme:n,host:i.slice(0,o),port:i.slice(o+1)}}function HX(t,e){if(e.includes("://")){const o=ly(e);return o?o.origin===t:!1}const{host:n,port:r}=qX(e),s=t.indexOf("://");if(s!==-1){const o=s+3;let a=t.indexOf("/",o);a===-1&&(a=t.length);const c=t.slice(o,a);if(r!==void 0)return`${n}:${r}`===c;const u=c.split(":")[0];return n===u}const i=ly(t);return i?r!==void 0?n===i.hostname&&r===(i.port||void 0):n===i.hostname:!1}function WX(t,e,n){let r=n,s;const i=r.indexOf("://");i!==-1&&(s=r.slice(0,i),r=r.slice(i+3));const o=r.indexOf("/");o!==-1&&(r=r.slice(0,o));let a=r,c;const u=a.lastIndexOf(":");u!==-1&&(c=a.slice(u+1),a=a.slice(0,u));const l=a.split(".");for(const p of l)if(p.includes("*")&&p!=="*")return!1;const d=t.protocol.replace(/:$/u,"");if(s&&s!==d||c!==void 0&&c!=="*"&&c!==t.port)return!1;const f=zX(e),g=(f?f.host:t.hostname).split(".");if(l.length!==g.length)return!1;for(let p=l.length-1;p>=0;p-=1){const y=l[p],E=g[p];if(y!=="*"&&y!==E)return!1}return!0}const VX={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},li={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return VX[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const u=`${o}:${i}`,l=r[o];switch(l.chains.push(u),u){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":l.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":l.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break}return l?.rpcMap&&c&&(l.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{const e=await $u.resolveName(t);return(e?.addresses?Object.values(e.addresses):[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===li.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===li.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){const r=[...e,...n];if(e.length===0)return!0;const s=ly(t);if(!s)return r.some(i=>!i.includes("*")&&i===t);if(s.hostname==="localhost"||s.hostname==="127.0.0.1")return!0;for(const i of r)if(i.includes("*")){if(WX(s,t,i))return!0}else if(HX(t,i))return!0;return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=li.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{try{const c=t.session?.namespaces?.[e]?.accounts||[],u=t.rpcProviders?.[e]?.getDefaultChain(),l=a.map(d=>{const f=c.find(p=>p.includes(`${e}:${u}:${d}`));if(!f)return;const{chainId:h,chainNamespace:g}=Dt.parseCaipAddress(f);return{address:d,chainId:h,chainNamespace:g}}).filter(d=>d!==void 0);l.length>0&&s(l)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,c)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const n=new Set,r=t?.session?.namespaces?.[e]?.accounts?.map(s=>Dt.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}},KX=[z.CONNECTOR_ID.AUTH,z.CONNECTOR_ID.WALLET_CONNECT];class fN{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>R.getCaipNetworks(n),this.getConnectorId=n=>X.getConnectorId(n),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());e&&r&&this.addConnection({connectorId:z.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:z.CONNECTOR_ID.AUTH,type:"AUTH",name:z.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>n.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){R.setAccountProp("status",e,n)}on(e,n){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw li.isUserRejectedRequestError(n)?new Fa(n):n}}async switchNetwork(e){const{caipNetwork:n}=e,r=nt.getProviderId(n.chainNamespace),s=nt.getProvider(n.chainNamespace);if(!s)throw new Error("Provider not found");if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(r==="AUTH"){const i=X.getAuthConnector()?.provider;if(!i)throw new Error("Auth provider not found");const o=Wt(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n.id==="walletConnect");if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=oe.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=oe.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){if(e.length>0){const{address:s}=oe.getAccount(e[0]),i=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&this.getConnectorId(z.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:e.map(o=>{const{address:a}=oe.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),this.getConnectorId(z.CHAIN.EVM)?.toLowerCase()===e.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){const r=typeof e=="string"&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),s=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),this.getConnectorId(z.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(KX.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[n]=e.accounts;this.emit("accountChanged",{address:n?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(u=>u.connectorId.toLowerCase()===n.toLowerCase());if(!o)return null;const a=s.find(u=>u.id.toLowerCase()===o.connectorId.toLowerCase()),c=e?o.accounts.find(u=>u.address.toLowerCase()===e.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){const[o]=i.accounts,a=s.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}}let vo=null;const Ln={getSIWX(){return V.state.siwx},async initializeIfEnabled(t=R.getActiveCaipAddress()){const e=V.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(R.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(V.state.remoteFeatures?.emailCapture){const o=R.getAccountData(n)?.user;await Ue.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(vo&&await vo,(await e.getSessions(`${n}:${r}`,s)).length)return;await Ue.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),Te.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await ie._getClient()?.disconnect().catch(console.error),de.reset("Connect"),at.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(t=R.getActiveCaipAddress()){if(!V.state.siwx||!t)return!0;const{chainNamespace:n,chainId:r,address:s}=Dt.parseCaipAddress(t),i=`${n}:${r}`;return(await Ln.getSessions({address:s,caipNetworkId:i})).length>0},async requestSignMessage(){const t=V.state.siwx,e=oe.getPlainAddress(R.getActiveCaipAddress()),n=ei();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");try{const r=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),s=r.toString();let i="";t.signMessage?i=await t.signMessage({message:s,chainId:n.caipNetworkId,accountAddress:e}):(X.getConnectorId(n.chainNamespace)===z.CONNECTOR_ID.AUTH&&de.pushTransactionStack({}),i=await ie.signMessage(s)||""),await t.addSession({data:r,message:s,signature:i}),R.setLastConnectedSIWECaipNetwork(n),Ue.close(),Te.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(r){(!Ue.state.open||de.state.view==="ApproveTransaction")&&await Ue.open({view:"SIWXSignMessage"}),at.showError("Error signing message"),Te.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(r)}),console.error("SWIXUtil:requestSignMessage",r)}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const n=R.getLastConnectedSIWECaipNetwork();if(n){const r=await t?.getSessions(n?.caipNetworkId,oe.getPlainAddress(R.getActiveCaipAddress())||"");r&&r.length>0?await R.switchActiveNetwork(n):await ie.disconnect()}else await ie.disconnect()}else Ue.close();Ue.close(),Te.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getAllSessions(){const t=this.getSIWX(),e=R.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await t?.getSessions(r.caipNetworkId,oe.getPlainAddress(R.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(t){const e=V.state.siwx;let n=t?.address;if(!n){const s=R.getActiveCaipAddress();n=oe.getPlainAddress(s)}let r=t?.caipNetworkId;return r||(r=R.getActiveCaipNetwork()?.caipNetworkId),e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=de.state.view==="ApproveTransaction",n=de.state.view==="SIWXSignMessage";if(e||n)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=Ln.getSIWX(),o=ei();if(!i||!s.includes(z.CHAIN.EVM)||V.state.remoteFeatures?.emailCapture){const d=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),u={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},l=await t.connect({chainId:e,socialUri:n,siwxMessage:u,preferredAccountType:r});return u.accountAddress=l.address,u.serializedMessage=l.message||"",l.signature&&l.message&&await Ln.addEmbeddedWalletSession(u,l.message,l.signature),R.setLastConnectedSIWECaipNetwork(o),{address:l.address,chainId:l.chainId,accounts:l.accounts}},async addEmbeddedWalletSession(t,e,n){if(vo)return vo;const r=Ln.getSIWX();return r?(vo=r.addSession({data:t,message:e,signature:n}).finally(()=>{vo=null}),vo):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){const r=Ln.getSIWX(),s=ei(),i=new Set(e.map(u=>u.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:ei()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(u=>u!==o.chainId)]});at.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(R.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){const u=a.auths.map(l=>{const d=t.client.formatAuthMessage({request:l.p,iss:l.p.iss});return{data:{...l.p,accountAddress:l.p.iss.split(":").slice(-1).join(""),chainId:l.p.iss.split(":").slice(2,4).join(":"),uri:l.p.aud??"",version:l.p.version||o.version,expirationTime:l.p.exp,issuedAt:l.p.iat,notBefore:l.p.nbf},message:d,signature:l.s.s,cacao:l}});try{await r.setSessions(u),s&&R.setLastConnectedSIWECaipNetwork(s),Te.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Ln.getSIWXEventProperties()})}catch(l){throw console.error("SIWX:universalProviderAuth - failed to set sessions",l),Te.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Ln.getSIWXEventProperties(l)}),await t.disconnect().catch(console.error),l}finally{at.hide()}}return!0},getSIWXEventProperties(t){const e=R.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:R.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:Wt(e)===lt.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?oe.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}};class hN{constructor({provider:e,namespace:n}){this.id=z.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=R.getCaipNetworks.bind(R),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=V.state.universalProviderConfigOverride,s=li.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return Ln.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:GX})}}const GX=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],ki={getGasPriceInEther(t,e){const n=e*t;return Number(n)/1e18},getGasPriceInUSD(t,e,n){const r=ki.getGasPriceInEther(e,n);return mt.bigNumber(t).times(r).toNumber()},getPriceImpact({sourceTokenAmount:t,sourceTokenPriceInUSD:e,toTokenPriceInUSD:n,toTokenAmount:r}){const s=mt.bigNumber(t).times(e),i=mt.bigNumber(r).times(n);return s.minus(i).div(s).times(100).toNumber()},getMaxSlippage(t,e){const n=mt.bigNumber(t).div(100);return mt.multiply(e,n).toNumber()},getProviderFee(t,e=.0085){return mt.bigNumber(t).times(e).toString()},isInsufficientNetworkTokenForGas(t,e){const n=e||"0";return mt.bigNumber(t).eq(0)?!0:mt.bigNumber(mt.bigNumber(n)).gt(t)},isInsufficientSourceTokenForSwap(t,e,n){const r=n?.find(i=>i.address===e)?.quantity?.numeric;return mt.bigNumber(r||"0").lt(t)}},Rr=Je({message:"",variant:"info",open:!1}),YX={state:Rr,subscribeKey(t,e){return bt(Rr,t,e)},open(t,e){const{debug:n}=V.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(Rr.message=s,Rr.variant=e,Rr.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},warn(t,e,n){Rr.open=!0,Rr.message=t,Rr.variant="warning",e&&console.warn(e,n)},close(){Rr.open=!1,Rr.message="",Rr.variant="info"}},ft=Yn(YX),u_=15e4,ZX=6,ln={initializing:!1,initialized:!1,loadingPrices:!1,loadingQuote:!1,loadingApprovalTransaction:!1,loadingBuildTransaction:!1,loadingTransaction:!1,switchingTokens:!1,fetchError:!1,approvalTransaction:void 0,swapTransaction:void 0,transactionError:void 0,sourceToken:void 0,sourceTokenAmount:"",sourceTokenPriceInUSD:0,toToken:void 0,toTokenAmount:"",toTokenPriceInUSD:0,networkPrice:"0",networkBalanceInUSD:"0",networkTokenSymbol:"",inputError:void 0,slippage:De.CONVERT_SLIPPAGE_TOLERANCE,tokens:void 0,popularTokens:void 0,suggestedTokens:void 0,foundTokens:void 0,myTokensWithBalance:void 0,tokensPriceMap:{},gasFee:"0",gasPriceInUSD:0,priceImpact:void 0,maxSlippage:void 0,providerFee:void 0},H=Je({...ln}),Xd={state:H,subscribe(t){return vt(H,()=>t(H))},subscribeKey(t,e){return bt(H,t,e)},getParams(){const t=R.state.activeChain,e=R.getAccountData(t)?.caipAddress??R.state.activeCaipAddress,n=oe.getPlainAddress(e),r=il(),s=X.getConnectorId(R.state.activeChain);if(!n)throw new Error("No address found to swap the tokens from.");const i=!H.toToken?.address||!H.toToken?.decimals,o=!H.sourceToken?.address||!H.sourceToken?.decimals||!mt.bigNumber(H.sourceTokenAmount).gt(0),a=!H.sourceTokenAmount;return{networkAddress:r,fromAddress:n,fromCaipAddress:e,sourceTokenAddress:H.sourceToken?.address,toTokenAddress:H.toToken?.address,toTokenAmount:H.toTokenAmount,toTokenDecimals:H.toToken?.decimals,sourceTokenAmount:H.sourceTokenAmount,sourceTokenDecimals:H.sourceToken?.decimals,invalidToToken:i,invalidSourceToken:o,invalidSourceTokenAmount:a,availableToSwap:e&&!i&&!o&&!a,isAuthConnector:s===z.CONNECTOR_ID.AUTH}},async setSourceToken(t){if(!t){H.sourceToken=t,H.sourceTokenAmount="",H.sourceTokenPriceInUSD=0;return}H.sourceToken=t,await Se.setTokenPrice(t.address,"sourceToken")},setSourceTokenAmount(t){H.sourceTokenAmount=t},async setToToken(t){if(!t){H.toToken=t,H.toTokenAmount="",H.toTokenPriceInUSD=0;return}H.toToken=t,await Se.setTokenPrice(t.address,"toToken")},setToTokenAmount(t){H.toTokenAmount=t?mt.toFixed(t,ZX):""},async setTokenPrice(t,e){let n=H.tokensPriceMap[t]||0;n||(H.loadingPrices=!0,n=await Se.getAddressPrice(t)),e==="sourceToken"?H.sourceTokenPriceInUSD=n:e==="toToken"&&(H.toTokenPriceInUSD=n),H.loadingPrices&&(H.loadingPrices=!1),Se.getParams().availableToSwap&&!H.switchingTokens&&Se.swapTokens()},async switchTokens(){if(!(H.initializing||!H.initialized||H.switchingTokens)){H.switchingTokens=!0;try{const t=H.toToken?{...H.toToken}:void 0,e=H.sourceToken?{...H.sourceToken}:void 0,n=t&&H.toTokenAmount===""?"1":H.toTokenAmount;Se.setSourceTokenAmount(n),Se.setToTokenAmount(""),await Se.setSourceToken(t),await Se.setToToken(e),H.switchingTokens=!1,Se.swapTokens()}catch(t){throw H.switchingTokens=!1,t}}},resetState(){H.myTokensWithBalance=ln.myTokensWithBalance,H.tokensPriceMap=ln.tokensPriceMap,H.initialized=ln.initialized,H.initializing=ln.initializing,H.switchingTokens=ln.switchingTokens,H.sourceToken=ln.sourceToken,H.sourceTokenAmount=ln.sourceTokenAmount,H.sourceTokenPriceInUSD=ln.sourceTokenPriceInUSD,H.toToken=ln.toToken,H.toTokenAmount=ln.toTokenAmount,H.toTokenPriceInUSD=ln.toTokenPriceInUSD,H.networkPrice=ln.networkPrice,H.networkTokenSymbol=ln.networkTokenSymbol,H.networkBalanceInUSD=ln.networkBalanceInUSD,H.inputError=ln.inputError},resetValues(){const{networkAddress:t}=Se.getParams(),e=H.tokens?.find(n=>n.address===t);Se.setSourceToken(e),Se.setToToken(void 0)},getApprovalLoadingState(){return H.loadingApprovalTransaction},clearError(){H.transactionError=void 0},async initializeState(){if(!H.initializing){if(H.initializing=!0,!H.initialized)try{await Se.fetchTokens(),H.initialized=!0}catch{H.initialized=!1,at.showError("Failed to initialize swap"),de.goBack()}H.initializing=!1}},async fetchTokens(){const{networkAddress:t}=Se.getParams();await Se.getNetworkTokenPrice(),await Se.getMyTokensWithBalance();const e=H.myTokensWithBalance?.find(n=>n.address===t);e&&(H.networkTokenSymbol=e.symbol,Se.setSourceToken(e),Se.setSourceTokenAmount("0"))},async getTokenList(){const t=R.state.activeCaipNetwork?.caipNetworkId;if(!(H.caipNetworkId===t&&H.tokens))try{H.tokensLoading=!0;const e=await Ma.getTokenList(t);H.tokens=e,H.caipNetworkId=t,H.popularTokens=e.sort((o,a)=>o.symbol<a.symbol?-1:o.symbol>a.symbol?1:0);const r=(t&&De.SUGGESTED_TOKENS_BY_CHAIN?.[t]||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o),i=(De.SWAP_SUGGESTED_TOKENS||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o).filter(o=>!r.some(a=>a.address===o.address));H.suggestedTokens=[...r,...i]}catch{H.tokens=[],H.popularTokens=[],H.suggestedTokens=[]}finally{H.tokensLoading=!1}},async getAddressPrice(t){const e=H.tokensPriceMap[t];if(e)return e;const r=(await Ee.fetchTokenPrice({addresses:[t]}))?.fungibles||[],i=[...H.tokens||[],...H.myTokensWithBalance||[]]?.find(c=>c.address===t)?.symbol,o=r.find(c=>c.symbol.toLowerCase()===i?.toLowerCase())?.price||0,a=parseFloat(o.toString());return H.tokensPriceMap[t]=a,a},async getNetworkTokenPrice(){const{networkAddress:t}=Se.getParams(),n=(await Ee.fetchTokenPrice({addresses:[t]}).catch(()=>(at.showError("Failed to fetch network token price"),{fungibles:[]}))).fungibles?.[0],r=n?.price.toString()||"0";H.tokensPriceMap[t]=parseFloat(r),H.networkTokenSymbol=n?.symbol||"",H.networkPrice=r},async getMyTokensWithBalance(t){const e=await Yh.getMyTokensWithBalance(t),n=Ma.mapBalancesToSwapTokens(e);n&&(await Se.getInitialGasPrice(),Se.setBalances(n))},setBalances(t){const{networkAddress:e}=Se.getParams(),n=R.state.activeCaipNetwork;if(!n)return;const r=t.find(s=>s.address===e);t.forEach(s=>{H.tokensPriceMap[s.address]=s.price||0}),H.myTokensWithBalance=t.filter(s=>s.address.startsWith(n.caipNetworkId)),H.networkBalanceInUSD=r?mt.multiply(r.quantity.numeric,r.price).toString():"0"},async getInitialGasPrice(){const t=await Ma.fetchGasPrice();if(!t)return{gasPrice:null,gasPriceInUSD:null};switch(R.state?.activeCaipNetwork?.chainNamespace){case z.CHAIN.SOLANA:return H.gasFee=t.standard??"0",H.gasPriceInUSD=mt.multiply(t.standard,H.networkPrice).div(1e9).toNumber(),{gasPrice:BigInt(H.gasFee),gasPriceInUSD:Number(H.gasPriceInUSD)};case z.CHAIN.EVM:default:const e=t.standard??"0",n=BigInt(e),r=BigInt(u_),s=ki.getGasPriceInUSD(H.networkPrice,r,n);return H.gasFee=e,H.gasPriceInUSD=s,{gasPrice:n,gasPriceInUSD:s}}},async swapTokens(){const t=R.getAccountData()?.address,e=H.sourceToken,n=H.toToken,r=mt.bigNumber(H.sourceTokenAmount).gt(0);if(r||Se.setToTokenAmount(""),!n||!e||H.loadingPrices||!r||!t)return;H.loadingQuote=!0;const s=mt.bigNumber(H.sourceTokenAmount).times(10**e.decimals).round(0);try{const i=await Ee.fetchSwapQuote({userAddress:t,from:e.address,to:n.address,gasPrice:H.gasFee,amount:s.toString()});H.loadingQuote=!1;const o=i?.quotes?.[0]?.toAmount;if(!o){ft.open({displayMessage:"Incorrect amount",debugMessage:"Please enter a valid amount"},"error");return}const a=mt.bigNumber(o).div(10**n.decimals).toString();Se.setToTokenAmount(a),Se.hasInsufficientToken(H.sourceTokenAmount,e.address)?H.inputError="Insufficient balance":(H.inputError=void 0,Se.setTransactionDetails())}catch(i){const o=await Ma.handleSwapError(i);H.loadingQuote=!1,H.inputError=o||"Insufficient balance"}},async getTransaction(){const{fromCaipAddress:t,availableToSwap:e}=Se.getParams(),n=H.sourceToken,r=H.toToken;if(!(!t||!e||!n||!r||H.loadingQuote))try{H.loadingBuildTransaction=!0;const s=await Ma.fetchSwapAllowance({userAddress:t,tokenAddress:n.address,sourceTokenAmount:H.sourceTokenAmount,sourceTokenDecimals:n.decimals});let i;return s?i=await Se.createSwapTransaction():i=await Se.createAllowanceTransaction(),H.loadingBuildTransaction=!1,H.fetchError=!1,i}catch{de.goBack(),at.showError("Failed to check allowance"),H.loadingBuildTransaction=!1,H.approvalTransaction=void 0,H.swapTransaction=void 0,H.fetchError=!0;return}},async createAllowanceTransaction(){const{fromCaipAddress:t,sourceTokenAddress:e,toTokenAddress:n}=Se.getParams();if(!(!t||!n)){if(!e)throw new Error("createAllowanceTransaction - No source token address found.");try{const r=await Ee.generateApproveCalldata({from:e,to:n,userAddress:t}),s=oe.getPlainAddress(r.tx.from);if(!s)throw new Error("SwapController:createAllowanceTransaction - address is required");const i={data:r.tx.data,to:s,gasPrice:BigInt(r.tx.eip155.gasPrice),value:BigInt(r.tx.value),toAmount:H.toTokenAmount};return H.swapTransaction=void 0,H.approvalTransaction={data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount},{data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount}}catch{de.goBack(),at.showError("Failed to create approval transaction"),H.approvalTransaction=void 0,H.swapTransaction=void 0,H.fetchError=!0;return}}},async createSwapTransaction(){const{networkAddress:t,fromCaipAddress:e,sourceTokenAmount:n}=Se.getParams(),r=H.sourceToken,s=H.toToken;if(!e||!n||!r||!s)return;const i=ie.parseUnits(n,r.decimals)?.toString();try{const o=await Ee.generateSwapCalldata({userAddress:e,from:r.address,to:s.address,amount:i,disableEstimate:!0}),a=r.address===t,c=BigInt(o.tx.eip155.gas),u=BigInt(o.tx.eip155.gasPrice),l=oe.getPlainAddress(o.tx.to);if(!l)throw new Error("SwapController:createSwapTransaction - address is required");const d={data:o.tx.data,to:l,gas:c,gasPrice:u,value:BigInt(a?i??"0":"0"),toAmount:H.toTokenAmount};return H.gasPriceInUSD=ki.getGasPriceInUSD(H.networkPrice,c,u),H.approvalTransaction=void 0,H.swapTransaction=d,d}catch{de.goBack(),at.showError("Failed to create transaction"),H.approvalTransaction=void 0,H.swapTransaction=void 0,H.fetchError=!0;return}},onEmbeddedWalletApprovalSuccess(){at.showLoading("Approve limit increase in your wallet"),de.replace("SwapPreview")},async sendTransactionForApproval(t){const{fromAddress:e,isAuthConnector:n}=Se.getParams();H.loadingApprovalTransaction=!0,n?de.pushTransactionStack({onSuccess:Se.onEmbeddedWalletApprovalSuccess}):at.showLoading("Approve limit increase in your wallet");try{await ie.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:z.CHAIN.EVM}),await Se.swapTokens(),await Se.getTransaction(),H.approvalTransaction=void 0,H.loadingApprovalTransaction=!1}catch(s){const i=s;H.transactionError=i?.displayMessage,H.loadingApprovalTransaction=!1,at.showError(i?.displayMessage||"Transaction error"),Te.sendEvent({type:"track",event:"SWAP_APPROVAL_ERROR",properties:{message:i?.displayMessage||i?.message||"Unknown",network:R.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Se.state.sourceToken?.symbol||"",swapToToken:Se.state.toToken?.symbol||"",swapFromAmount:Se.state.sourceTokenAmount||"",swapToAmount:Se.state.toTokenAmount||"",isSmartAccount:Wt(z.CHAIN.EVM)===lt.ACCOUNT_TYPES.SMART_ACCOUNT}})}},async sendTransactionForSwap(t){if(!t)return;const{fromAddress:e,toTokenAmount:n,isAuthConnector:r}=Se.getParams();H.loadingTransaction=!0;const s=`Swapping ${H.sourceToken?.symbol} to ${mt.formatNumberToLocalString(n,3)} ${H.toToken?.symbol}`,i=`Swapped ${H.sourceToken?.symbol} to ${mt.formatNumberToLocalString(n,3)} ${H.toToken?.symbol}`;r?de.pushTransactionStack({onSuccess(){de.replace("Account"),at.showLoading(s),Xd.resetState()}}):at.showLoading("Confirm transaction in your wallet");try{const o=[H.sourceToken?.address,H.toToken?.address].join(","),a=await ie.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:z.CHAIN.EVM});return H.loadingTransaction=!1,at.showSuccess(i),Te.sendEvent({type:"track",event:"SWAP_SUCCESS",properties:{network:R.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Se.state.sourceToken?.symbol||"",swapToToken:Se.state.toToken?.symbol||"",swapFromAmount:Se.state.sourceTokenAmount||"",swapToAmount:Se.state.toTokenAmount||"",isSmartAccount:Wt(z.CHAIN.EVM)===lt.ACCOUNT_TYPES.SMART_ACCOUNT}}),Xd.resetState(),r||de.replace("Account"),Xd.getMyTokensWithBalance(o),a}catch(o){const a=o;H.transactionError=a?.displayMessage,H.loadingTransaction=!1,at.showError(a?.displayMessage||"Transaction error"),Te.sendEvent({type:"track",event:"SWAP_ERROR",properties:{message:a?.displayMessage||a?.message||"Unknown",network:R.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Se.state.sourceToken?.symbol||"",swapToToken:Se.state.toToken?.symbol||"",swapFromAmount:Se.state.sourceTokenAmount||"",swapToAmount:Se.state.toTokenAmount||"",isSmartAccount:Wt(z.CHAIN.EVM)===lt.ACCOUNT_TYPES.SMART_ACCOUNT}});return}},hasInsufficientToken(t,e){return ki.isInsufficientSourceTokenForSwap(t,e,H.myTokensWithBalance)},setTransactionDetails(){const{toTokenAddress:t,toTokenDecimals:e}=Se.getParams();!t||!e||(H.gasPriceInUSD=ki.getGasPriceInUSD(H.networkPrice,BigInt(H.gasFee),BigInt(u_)),H.priceImpact=ki.getPriceImpact({sourceTokenAmount:H.sourceTokenAmount,sourceTokenPriceInUSD:H.sourceTokenPriceInUSD,toTokenPriceInUSD:H.toTokenPriceInUSD,toTokenAmount:H.toTokenAmount}),H.maxSlippage=ki.getMaxSlippage(H.slippage,H.toTokenAmount),H.providerFee=ki.getProviderFee(H.sourceTokenAmount))}},Se=Yn(Xd),kr=Je({message:"",open:!1,triggerRect:{width:0,height:0,top:0,left:0},variant:"shade"}),JX={state:kr,subscribe(t){return vt(kr,()=>t(kr))},subscribeKey(t,e){return bt(kr,t,e)},showTooltip({message:t,triggerRect:e,variant:n}){kr.open=!0,kr.message=t,kr.triggerRect=e,kr.variant=n},hide(){kr.open=!1,kr.message="",kr.triggerRect={width:0,height:0,top:0,left:0}}},Vne=Yn(JX),fu=Je({isLegalCheckboxChecked:!1}),Kne={state:fu,subscribe(t){return vt(fu,()=>t(fu))},subscribeKey(t,e){return bt(fu,t,e)},setIsLegalCheckboxChecked(t){fu.isLegalCheckboxChecked=t}},XX={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class QX extends Error{}function eQ(){const{sdkType:t,sdkVersion:e,projectId:n}=V.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function bw(t,e){const n=eQ(),{projectId:r}=V.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new QX(o.error.message);return o}async function tQ(t){return(await bw("reown_getExchanges",t)).result}async function nQ(t){return(await bw("reown_getExchangePayUrl",t)).result}async function rQ(t){return(await bw("reown_getExchangeBuyStatus",t)).result}function l_(t,e){const{chainNamespace:n,chainId:r}=Dt.parseCaipNetworkId(t),s=XX[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const sQ={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},iQ={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},pN={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},oQ={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},aQ={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},cQ={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},uQ={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},lQ={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},dQ={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},fQ={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},hQ={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},pQ={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},gQ={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},mQ={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},yQ={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},bQ={ethereumETH:sQ,baseETH:iQ,baseUSDC:pN,baseSepoliaETH:aQ,ethereumUSDC:cQ,arbitrumUSDC:uQ,polygonUSDC:lQ,solanaUSDC:dQ,ethereumUSDT:fQ,optimismUSDT:hQ,arbitrumUSDT:pQ,polygonUSDT:gQ,solanaUSDT:mQ,solanaSOL:yQ};function wQ(t){return Object.values(bQ).filter(e=>e.network===t)}const EQ=0,gN={paymentAsset:null,amount:null,tokenAmount:0,priceLoading:!1,error:null,exchanges:[],isLoading:!1,currentPayment:void 0,isPaymentInProgress:!1,paymentId:"",assets:[]},Ce=Je(gN),Co={state:Ce,subscribe(t){return vt(Ce,()=>t(Ce))},subscribeKey(t,e){return bt(Ce,t,e)},resetState(){Object.assign(Ce,{...gN})},async getAssetsForNetwork(t){const e=wQ(t),n=await Co.getAssetsImageAndPrice(e),r=e.map(s=>{const i=s.asset==="native"?il():`${s.network}:${s.asset}`,o=n.find(a=>a.fungibles?.[0]?.address?.toLowerCase()===i.toLowerCase());return{...s,price:o?.fungibles?.[0]?.price||1,metadata:{...s.metadata,iconUrl:o?.fungibles?.[0]?.iconUrl}}});return Ce.assets=r,r},async getAssetsImageAndPrice(t){const e=t.map(r=>r.asset==="native"?il():`${r.network}:${r.asset}`);return await Promise.all(e.map(r=>Ee.fetchTokenPrice({addresses:[r]})))},getTokenAmount(){if(!Ce?.paymentAsset?.price)throw new Error("Cannot get token price");const t=mt.bigNumber(Ce.amount??0).round(8),e=mt.bigNumber(Ce.paymentAsset.price).round(8);return t.div(e).round(8).toNumber()},setAmount(t){Ce.amount=t,Ce.paymentAsset?.price&&(Ce.tokenAmount=Co.getTokenAmount())},setPaymentAsset(t){Ce.paymentAsset=t},isPayWithExchangeEnabled(){return V.state.remoteFeatures?.payWithExchange},isPayWithExchangeSupported(){return Co.isPayWithExchangeEnabled()&&R.state.activeCaipNetwork&&De.PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES.includes(R.state.activeCaipNetwork.chainNamespace)},async fetchExchanges(){try{const t=Co.isPayWithExchangeSupported();if(!Ce.paymentAsset||!t){Ce.exchanges=[],Ce.isLoading=!1;return}Ce.isLoading=!0;const e=await tQ({page:EQ,asset:l_(Ce.paymentAsset.network,Ce.paymentAsset.asset),amount:Ce.amount?.toString()??"0"});Ce.exchanges=e.exchanges.slice(0,2)}catch{throw at.showError("Unable to get exchanges"),new Error("Unable to get exchanges")}finally{Ce.isLoading=!1}},async getPayUrl(t,e){try{const n=Number(e.amount),r=await nQ({exchangeId:t,asset:l_(e.network,e.asset),amount:n.toString(),recipient:`${e.network}:${e.recipient}`});return Te.sendEvent({type:"track",event:"PAY_EXCHANGE_SELECTED",properties:{exchange:{id:t},configuration:{network:e.network,asset:e.asset,recipient:e.recipient,amount:n},currentPayment:{type:"exchange",exchangeId:t},source:"fund-from-exchange",headless:!1}}),r}catch(n){throw n instanceof Error&&n.message.includes("is not supported")?new Error("Asset not supported"):new Error(n.message)}},async handlePayWithExchange(t){try{const e=R.getAccountData()?.address;if(!e)throw new Error("No account connected");if(!Ce.paymentAsset)throw new Error("No payment asset selected");const n=oe.returnOpenHref("","popupWindow","scrollbar=yes,width=480,height=720");if(!n)throw new Error("Could not create popup window");Ce.isPaymentInProgress=!0,Ce.paymentId=crypto.randomUUID(),Ce.currentPayment={type:"exchange",exchangeId:t};const{network:r,asset:s}=Ce.paymentAsset,i={network:r,asset:s,amount:Ce.tokenAmount,recipient:e},o=await Co.getPayUrl(t,i);if(!o){try{n.close()}catch(a){console.error("Unable to close popup window",a)}throw new Error("Unable to initiate payment")}Ce.currentPayment.sessionId=o.sessionId,Ce.currentPayment.status="IN_PROGRESS",Ce.currentPayment.exchangeId=t,n.location.href=o.url}catch{Ce.error="Unable to initiate payment",at.showError(Ce.error)}},async waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r=20}){const s=await Co.getBuyStatus(t,e,n);if(s.status==="SUCCESS"||s.status==="FAILED")return s;if(r===0)throw new Error("Unable to get deposit status");return await new Promise(i=>{setTimeout(i,5e3)}),Co.waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r-1})},async getBuyStatus(t,e,n){try{if(!Ce.currentPayment)throw new Error("No current payment");const r=await rQ({sessionId:e,exchangeId:t});if(Ce.currentPayment.status=r.status,r.status==="SUCCESS"||r.status==="FAILED"){const s=R.getAccountData()?.address;Ce.currentPayment.result=r.txHash,Ce.isPaymentInProgress=!1,Te.sendEvent({type:"track",event:r.status==="SUCCESS"?"PAY_SUCCESS":"PAY_ERROR",properties:{message:r.status==="FAILED"?oe.parseError(Ce.error):void 0,source:"fund-from-exchange",paymentId:n,configuration:{network:Ce.paymentAsset?.network||"",asset:Ce.paymentAsset?.asset||"",recipient:s||"",amount:Ce.amount??0},currentPayment:{type:"exchange",exchangeId:Ce.currentPayment?.exchangeId,sessionId:Ce.currentPayment?.sessionId,result:r.txHash}}})}return r}catch{return{status:"UNKNOWN",txHash:""}}},reset(){Ce.currentPayment=void 0,Ce.isPaymentInProgress=!1,Ce.paymentId="",Ce.paymentAsset=null,Ce.amount=0,Ce.tokenAmount=0,Ce.priceLoading=!1,Ce.error=null,Ce.exchanges=[],Ce.isLoading=!1}},Gne={isUnsupportedChainView(){return de.state.view==="UnsupportedChain"||de.state.view==="SwitchNetwork"&&de.state.history.includes("UnsupportedChain")},async safeClose(){if(this.isUnsupportedChainView()){Ue.shake();return}if(await Ln.isSIWXCloseDisabled()){Ue.shake();return}(de.state.view==="DataCapture"||de.state.view==="DataCaptureOtpConfirm")&&ie.disconnect(),Ue.close()}},Ke={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:z.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},gn={ConnectorExplorerIds:{[z.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[z.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[z.CONNECTOR_ID.BASE_ACCOUNT]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[z.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[z.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[z.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Ke.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Ke.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Ke.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Ke.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Ke.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Ke.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Ke.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Ke.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Ke.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Ke.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Ke.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[Ke.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Ke.BINANCE_CONNECTOR_NAME]:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700","-239":"20f673c0-095e-49b2-07cf-eb5049dcf600","-3":"20f673c0-095e-49b2-07cf-eb5049dcf600"},ConnectorImageIds:{[z.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[z.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[z.CONNECTOR_ID.BASE_ACCOUNT]:"bba2c8be-7fd1-463e-42b1-796ecb0ad200",[z.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[z.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[z.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[z.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[z.CONNECTOR_ID.INJECTED]:"Browser Wallet",[z.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[z.CONNECTOR_ID.COINBASE]:"Coinbase",[z.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[z.CONNECTOR_ID.BASE_ACCOUNT]:"Base Account",[z.CONNECTOR_ID.LEDGER]:"Ledger",[z.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[z.CONNECTOR_ID.INJECTED]:"INJECTED",[z.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[z.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[z.CONNECTOR_ID.AUTH]:"AUTH",[Ke.CONNECTOR_TYPE_AUTH]:"AUTH"}},Hr={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${Ke.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=R.state.activeChain;return z.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>X.getConnectorId(e)===z.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return z.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?z.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=G.getConnections()[e]??[];return{hasDisconnected:G.isConnectorDisconnected(t,e),hasConnected:r.some(s=>Hr.isLowerCaseMatch(s.connectorId,t))}}},vQ=new AbortController,ut={EmbeddedWalletAbortController:vQ,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${wu()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com. [PID: ${V.state.projectId}]`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systemâ€™s date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},mN={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:pN.asset,84532:oQ.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(mN.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},CQ={createLogger(t,e="error"){const n=Ay({level:e}),{logger:r}=hh({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},_Q="rpc.walletconnect.org";function d_(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const pg=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],hs={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===_Q}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:z.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${z.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){const r=t.rpcUrls?.default?.http?.[0];return pg.includes(e)?d_(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,n),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,u=r?.[i]?.map(f=>f.url)||[],l=[...u,...a?[a]:[]],d=[...u];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:gn.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:l},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>hs.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){const r=[];return n?.forEach(s=>{r.push(Cu(s.url,s.config))}),pg.includes(t.caipNetworkId)&&r.push(Cu(d_(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{r.push(Cu(s))}),im(r)},extendWagmiTransports(t,e,n){if(pg.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return im([n,Cu(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:z.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=G.getActiveCaipNetworkId(),n=R.getAllRequestedCaipNetworks(),r=Array.from(R.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||n?.[0]}};class Ho{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){const{metadata:c,sdkVersion:u,sdkType:l}=V.getSnapshot();return Ho.instance||(Ho.instance=new PO({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!V.state.remoteFeatures?.emailCapture,metadata:c,sdkVersion:u,sdkType:l})),Ho.instance}}var f_={};const AQ={ACCOUNT_TABS:[{label:"Tokens"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof f_<"u"?f_.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},SQ=[gn.ConnectorExplorerIds[z.CONNECTOR_ID.COINBASE],gn.ConnectorExplorerIds[z.CONNECTOR_ID.COINBASE_SDK],gn.ConnectorExplorerIds[z.CONNECTOR_ID.BASE_ACCOUNT],gn.ConnectorExplorerIds[Ke.SOLFLARE_CONNECTOR_NAME],gn.ConnectorExplorerIds[Ke.PHANTOM_CONNECTOR_NAME],gn.ConnectorExplorerIds[Ke.BINANCE_CONNECTOR_NAME]],Iu={filterOutDuplicatesByRDNS(t){const e=V.state.enableEIP6963?X.state.connectors:[],n=G.getRecentWallets(),r=e.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&oe.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(u=>u.name===a.name)))},filterOutDuplicatesByIds(t){const e=X.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"||a.type==="MULTI_CHAIN"),n=G.getRecentWallets(),r=e.map(a=>a.explorerId||a.explorerWallet?.id||a.id),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=X.state,{featuredWalletIds:n}=V.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const u=n.indexOf(o.id),l=n.indexOf(a.id);if(u!==-1&&l!==-1)return u-l;if(u!==-1)return-1;if(l!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const n=t?.connectMethodsOrder||V.state.features?.connectMethodsOrder,r=e||X.state.connectors;if(n)return n;const{injected:s,announced:i}=gg.getConnectorsByType(r,ye.state.recommended,ye.state.featured),o=s.filter(gg.showConnector),a=i.filter(gg.showConnector);return o.length||a.length?["wallet","email","social"]:AQ.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&ye.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&ye.state.excludedWallets.some(r=>Hr.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))},filterWalletsByWcSupport(t){return ie.state.wcBasic?t.filter(e=>e.supports_wc):oe.isMobile()?t.filter(e=>e.supports_wc||SQ.includes(e.id)):t}},gg={getConnectorsByType(t,e,n){const{customWallets:r}=V.state,s=G.getRecentWallets(),i=Iu.filterOutDuplicateWallets(e),o=Iu.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),u=t.filter(d=>d.type==="INJECTED"),l=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:l,multiChain:a,announced:c,injected:u,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,n=!!e&&ye.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),r=!!t.name&&ye.state.excludedWallets.some(s=>Hr.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!oe.isMobile()||oe.isMobile()&&!e&&!ie.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(R.state.chains.values()).some(n=>X.getConnectorId(n.namespace)===z.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=V.state.features?.connectorTypeOrder??[]}){const l=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(g=>g.isEnabled),d=new Set(l.map(g=>g.type)),f=c.filter(g=>d.has(g)).map(g=>({type:g,isEnabled:!0})),h=l.filter(({type:g})=>!f.some(({type:y})=>y===g));return Array.from(new Set([...f,...h].map(({type:g})=>g)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!oe.isMobile())return{accounts:[],chainId:void 0};if(t.id===z.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,n]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:e,chainId:n}}catch(e){return console.warn(`Failed to fetch provider data for ${t.name}`,e),{accounts:[],chainId:void 0}}},getFilteredCustomWallets(t){const e=G.getRecentWallets(),n=X.state.connectors.map(o=>o.info?.rdns).filter(Boolean),r=e.map(o=>o.rdns).filter(Boolean),s=n.concat(r);if(s.includes("io.metamask.mobile")&&oe.isMobile()){const o=s.indexOf("io.metamask.mobile");s[o]="io.metamask"}return t.filter(o=>!s.includes(String(o?.rdns)))},hasWalletConnector(t){return X.state.connectors.some(e=>e.id===t.id||e.name===t.name)},isWalletCompatibleWithCurrentChain(t){const e=R.state.activeChain;return e&&t.chains?t.chains.some(n=>{const r=n.split(":")[0];return e===r}):!0},getFilteredRecentWallets(){return G.getRecentWallets().filter(n=>!Iu.isExcluded(n)).filter(n=>!this.hasWalletConnector(n)).filter(n=>this.isWalletCompatibleWithCurrentChain(n))},getCappedRecommendedWallets(t){const{connectors:e}=X.state,{customWallets:n,featuredWalletIds:r}=V.state,s=e.find(A=>A.id==="walletConnect"),i=e.filter(A=>A.type==="INJECTED"||A.type==="ANNOUNCED"||A.type==="MULTI_CHAIN");if(!s&&!i.length&&!n?.length)return[];const o=om.isEmailEnabled(),a=om.isSocialsEnabled(),c=i.filter(A=>A.name!=="Browser Wallet"&&A.name!=="WalletConnect"),u=r?.length||0,l=n?.length||0,d=c.length||0,f=o?1:0,h=a?1:0,g=u+l+d+f+h,y=Math.max(0,4-g);return y<=0?[]:Iu.filterOutDuplicateWallets(t).slice(0,y)}},Yne={interpolate(t,e,n){if(t.length!==2||e.length!==2)throw new Error("inputRange and outputRange must be an array of length 2");const r=t[0]||0,s=t[1]||0,i=e[0]||0,o=e[1]||0;return n<r?i:n>s?o:(o-i)/(s-r)*(n-r)+i}};const Qd=globalThis,ww=Qd.ShadowRoot&&(Qd.ShadyCSS===void 0||Qd.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Ew=Symbol(),h_=new WeakMap;let yN=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==Ew)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(ww&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=h_.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&h_.set(n,e))}return e}toString(){return this.cssText}};const Mr=t=>new yN(typeof t=="string"?t:t+"",void 0,Ew),qi=(t,...e)=>{const n=t.length===1?t[0]:e.reduce(((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1]),t[0]);return new yN(n,t,Ew)},IQ=(t,e)=>{if(ww)t.adoptedStyleSheets=e.map((n=>n instanceof CSSStyleSheet?n:n.styleSheet));else for(const n of e){const r=document.createElement("style"),s=Qd.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},p_=ww?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return Mr(n)})(t):t;const{is:TQ,defineProperty:NQ,getOwnPropertyDescriptor:xQ,getOwnPropertyNames:PQ,getOwnPropertySymbols:OQ,getPrototypeOf:RQ}=Object,wp=globalThis,g_=wp.trustedTypes,kQ=g_?g_.emptyScript:"",$Q=wp.reactiveElementPolyfillSupport,Du=(t,e)=>t,dy={toAttribute(t,e){switch(e){case Boolean:t=t?kQ:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},bN=(t,e)=>!TQ(t,e),m_={attribute:!0,type:String,converter:dy,reflect:!1,useDefault:!1,hasChanged:bN};Symbol.metadata??=Symbol("metadata"),wp.litPropertyMetadata??=new WeakMap;let La=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=m_){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&NQ(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=xQ(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??m_}static _$Ei(){if(this.hasOwnProperty(Du("elementProperties")))return;const e=RQ(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Du("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Du("properties"))){const n=this.properties,r=[...PQ(n),...OQ(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(p_(s))}else e!==void 0&&n.push(p_(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return IQ(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:dy).toAttribute(n,r.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,n){const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:dy;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,n,r){if(e!==void 0){const s=this.constructor,i=this[e];if(r??=s.getPropertyOptions(e),!((r.hasChanged??bN)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach((n=>n.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};La.elementStyles=[],La.shadowRootOptions={mode:"open"},La[Du("elementProperties")]=new Map,La[Du("finalized")]=new Map,$Q?.({ReactiveElement:La}),(wp.reactiveElementVersions??=[]).push("2.1.1");const vw=globalThis,rh=vw.trustedTypes,y_=rh?rh.createPolicy("lit-html",{createHTML:t=>t}):void 0,wN="$lit$",zi=`lit$${Math.random().toFixed(9).slice(2)}$`,EN="?"+zi,DQ=`<${EN}>`,oa=document,pl=()=>oa.createComment(""),gl=t=>t===null||typeof t!="object"&&typeof t!="function",Cw=Array.isArray,UQ=t=>Cw(t)||typeof t?.[Symbol.iterator]=="function",mg=`[ 	
\f\r]`,hu=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,b_=/-->/g,w_=/>/g,_o=RegExp(`>|${mg}(?:([^\\s"'>=/]+)(${mg}*=${mg}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),E_=/'/g,v_=/"/g,vN=/^(?:script|style|textarea|title)$/i,CN=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),Xne=CN(1),Qne=CN(2),Dc=Symbol.for("lit-noChange"),qt=Symbol.for("lit-nothing"),C_=new WeakMap,Lo=oa.createTreeWalker(oa,129);function _N(t,e){if(!Cw(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return y_!==void 0?y_.createHTML(e):e}const BQ=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=hu;for(let a=0;a<n;a++){const c=t[a];let u,l,d=-1,f=0;for(;f<c.length&&(o.lastIndex=f,l=o.exec(c),l!==null);)f=o.lastIndex,o===hu?l[1]==="!--"?o=b_:l[1]!==void 0?o=w_:l[2]!==void 0?(vN.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=_o):l[3]!==void 0&&(o=_o):o===_o?l[0]===">"?(o=s??hu,d=-1):l[1]===void 0?d=-2:(d=o.lastIndex-l[2].length,u=l[1],o=l[3]===void 0?_o:l[3]==='"'?v_:E_):o===v_||o===E_?o=_o:o===b_||o===w_?o=hu:(o=_o,s=void 0);const h=o===_o&&t[a+1].startsWith("/>")?" ":"";i+=o===hu?c+DQ:d>=0?(r.push(u),c.slice(0,d)+wN+c.slice(d)+zi+h):c+zi+(d===-2?a:h)}return[_N(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class ml{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[u,l]=BQ(e,n);if(this.el=ml.createElement(u,r),Lo.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Lo.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(wN)){const f=l[o++],h=s.getAttribute(d).split(zi),g=/([.?@])?(.*)/.exec(f);c.push({type:1,index:i,name:g[2],strings:h,ctor:g[1]==="."?LQ:g[1]==="?"?FQ:g[1]==="@"?jQ:Ep}),s.removeAttribute(d)}else d.startsWith(zi)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(vN.test(s.tagName)){const d=s.textContent.split(zi),f=d.length-1;if(f>0){s.textContent=rh?rh.emptyScript:"";for(let h=0;h<f;h++)s.append(d[h],pl()),Lo.nextNode(),c.push({type:2,index:++i});s.append(d[f],pl())}}}else if(s.nodeType===8)if(s.data===EN)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(zi,d+1))!==-1;)c.push({type:7,index:i}),d+=zi.length-1}i++}}static createElement(e,n){const r=oa.createElement("template");return r.innerHTML=e,r}}function Uc(t,e,n=t,r){if(e===Dc)return e;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=gl(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(e=Uc(t,s._$AS(t,e.values),s,r)),e}class MQ{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=(e?.creationScope??oa).importNode(n,!0);Lo.currentNode=s;let i=Lo.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let u;c.type===2?u=new Zl(i,i.nextSibling,this,e):c.type===1?u=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(u=new qQ(i,this,e)),this._$AV.push(u),c=r[++a]}o!==c?.index&&(i=Lo.nextNode(),o++)}return Lo.currentNode=oa,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Zl{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=qt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Uc(this,e,n),gl(e)?e===qt||e==null||e===""?(this._$AH!==qt&&this._$AR(),this._$AH=qt):e!==this._$AH&&e!==Dc&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):UQ(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==qt&&gl(this._$AH)?this._$AA.nextSibling.data=e:this.T(oa.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=ml.createElement(_N(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new MQ(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(e){let n=C_.get(e.strings);return n===void 0&&C_.set(e.strings,n=new ml(e)),n}k(e){Cw(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Zl(this.O(pl()),this.O(pl()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Ep{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=qt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=qt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Uc(this,e,n,0),o=!gl(e)||e!==this._$AH&&e!==Dc,o&&(this._$AH=e);else{const a=e;let c,u;for(e=i[0],c=0;c<i.length-1;c++)u=Uc(this,a[r+c],n,c),u===Dc&&(u=this._$AH[c]),o||=!gl(u)||u!==this._$AH[c],u===qt?e=qt:e!==qt&&(e+=(u??"")+i[c+1]),this._$AH[c]=u}o&&!s&&this.j(e)}j(e){e===qt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class LQ extends Ep{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===qt?void 0:e}}class FQ extends Ep{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==qt)}}class jQ extends Ep{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Uc(this,e,n,0)??qt)===Dc)return;const r=this._$AH,s=e===qt&&r!==qt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==qt&&(r===qt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class qQ{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Uc(this,e)}}const zQ=vw.litHtmlPolyfillSupport;zQ?.(ml,Zl),(vw.litHtmlVersions??=[]).push("3.3.1");const HQ=(t,e,n)=>{const r=n?.renderBefore??e;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new Zl(e.insertBefore(pl(),i),i,void 0,n??{})}return s._$AI(t),s};const _w=globalThis;class ef extends La{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=HQ(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Dc}}ef._$litElement$=!0,ef.finalized=!0,_w.litElementHydrateSupport?.({LitElement:ef});const WQ=_w.litElementPolyfillSupport;WQ?.({LitElement:ef});(_w.litElementVersions??=[]).push("4.2.1");const VQ={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},sh={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},KQ={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},GQ={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},YQ={regular:"KHTeka",mono:"KHTekaMono"},ZQ={regular:"400",medium:"500"},JQ={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},XQ={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},QQ={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},eee={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},fy={colors:VQ,fontFamily:YQ,fontWeight:ZQ,textSize:JQ,typography:XQ,tokens:{core:sh.core,theme:sh.dark},borderRadius:KQ,spacing:GQ,durations:eee,easings:QQ},__="--apkt";function Nd(t){if(!t)return{};const e={};return e["font-family"]=t["--apkt-font-family"]??t["--w3m-font-family"]??"KHTeka",e.accent=t["--apkt-accent"]??t["--w3m-accent"]??"#0988F0",e["color-mix"]=t["--apkt-color-mix"]??t["--w3m-color-mix"]??"#000",e["color-mix-strength"]=t["--apkt-color-mix-strength"]??t["--w3m-color-mix-strength"]??0,e["font-size-master"]=t["--apkt-font-size-master"]??t["--w3m-font-size-master"]??"10px",e["border-radius-master"]=t["--apkt-border-radius-master"]??t["--w3m-border-radius-master"]??"4px",t["--apkt-z-index"]!==void 0?e["z-index"]=t["--apkt-z-index"]:t["--w3m-z-index"]!==void 0&&(e["z-index"]=t["--w3m-z-index"]),e}const Ks={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[c,u]of Object.entries(i)){const l=a?`${a}-${c}`:c;u&&typeof u=="object"&&Object.keys(u).length?(o[c]={},r(u,o[c],l)):typeof u=="string"&&(o[c]=`${__}-${l}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,c]of Object.entries(s)){const u=o?`${o}-${a}`:a,l=i[a];c&&typeof c=="object"?r(c,l,u):typeof l=="string"&&(n[`${__}-${u}`]=l)}}return r(t,e),n},createRootStyles(t,e){const n={...fy,tokens:{...fy.tokens,theme:t==="light"?sh.light:sh.dark}},{cssVariables:r}=Ks.createCSSVariables(n),s=Ks.assignCSSVariables(r,n),i=Ks.generateW3MVariables(e),o=Ks.generateW3MOverrides(e),a=Ks.generateScaledVariables(e),c=Ks.generateBaseVariables(s),u={...s,...c,...i,...o,...a},l=Ks.applyColorMixToVariables(e,u),d={...u,...l};return`:root {${Object.entries(d).map(([h,g])=>`${h}:${g.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e=Nd(t),n={};return n["--w3m-font-family"]=e["font-family"],n["--w3m-accent"]=e.accent,n["--w3m-color-mix"]=e["color-mix"],n["--w3m-color-mix-strength"]=`${e["color-mix-strength"]}%`,n["--w3m-font-size-master"]=e["font-size-master"],n["--w3m-border-radius-master"]=e["border-radius-master"],n},generateW3MOverrides(t){if(!t)return{};const e=Nd(t),n={};if(t["--apkt-accent"]||t["--w3m-accent"]){const r=e.accent;n["--apkt-tokens-core-iconAccentPrimary"]=r,n["--apkt-tokens-core-borderAccentPrimary"]=r,n["--apkt-tokens-core-textAccentPrimary"]=r,n["--apkt-tokens-core-backgroundAccentPrimary"]=r}return(t["--apkt-font-family"]||t["--w3m-font-family"])&&(n["--apkt-fontFamily-regular"]=e["font-family"]),e["z-index"]!==void 0&&(n["--apkt-tokens-core-zIndex"]=`${e["z-index"]}`),n},generateScaledVariables(t){if(!t)return{};const e=Nd(t),n={};if(t["--apkt-font-size-master"]||t["--w3m-font-size-master"]){const r=parseFloat(e["font-size-master"].replace("px",""));n["--apkt-textSize-h1"]=`${Number(r)*5}px`,n["--apkt-textSize-h2"]=`${Number(r)*4.4}px`,n["--apkt-textSize-h3"]=`${Number(r)*3.8}px`,n["--apkt-textSize-h4"]=`${Number(r)*3.2}px`,n["--apkt-textSize-h5"]=`${Number(r)*2.6}px`,n["--apkt-textSize-h6"]=`${Number(r)*2}px`,n["--apkt-textSize-large"]=`${Number(r)*1.6}px`,n["--apkt-textSize-medium"]=`${Number(r)*1.4}px`,n["--apkt-textSize-small"]=`${Number(r)*1.2}px`}if(t["--apkt-border-radius-master"]||t["--w3m-border-radius-master"]){const r=parseFloat(e["border-radius-master"].replace("px",""));n["--apkt-borderRadius-1"]=`${Number(r)}px`,n["--apkt-borderRadius-2"]=`${Number(r)*2}px`,n["--apkt-borderRadius-3"]=`${Number(r)*3}px`,n["--apkt-borderRadius-4"]=`${Number(r)*4}px`,n["--apkt-borderRadius-5"]=`${Number(r)*5}px`,n["--apkt-borderRadius-6"]=`${Number(r)*6}px`,n["--apkt-borderRadius-8"]=`${Number(r)*8}px`,n["--apkt-borderRadius-16"]=`${Number(r)*16}px`,n["--apkt-borderRadius-20"]=`${Number(r)*20}px`,n["--apkt-borderRadius-32"]=`${Number(r)*32}px`,n["--apkt-borderRadius-64"]=`${Number(r)*64}px`,n["--apkt-borderRadius-128"]=`${Number(r)*128}px`}return n},generateColorMixCSS(t,e){if(!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};e?.["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)");const r=Nd(t),s=r["color-mix"],i=r["color-mix-strength"];if(!i||i===0)return n;const o=Object.keys(e||{}).filter(a=>{const c=a.includes("-tokens-core-background")||a.includes("-tokens-core-text")||a.includes("-tokens-core-border")||a.includes("-tokens-core-foreground")||a.includes("-tokens-core-icon")||a.includes("-tokens-theme-background")||a.includes("-tokens-theme-text")||a.includes("-tokens-theme-border")||a.includes("-tokens-theme-foreground")||a.includes("-tokens-theme-icon")||a.includes("-tokens-theme-overlay"),u=a.includes("-borderRadius-")||a.includes("-spacing-")||a.includes("-textSize-")||a.includes("-fontFamily-")||a.includes("-fontWeight-")||a.includes("-typography-")||a.includes("-duration-")||a.includes("-ease-")||a.includes("-path-")||a.includes("-width-")||a.includes("-height-")||a.includes("-visual-size-")||a.includes("-modal-width")||a.includes("-cover");return c&&!u});return o.length===0||o.forEach(a=>{const c=e?.[a]||"";a.endsWith("-base")||(a==="--apkt-tokens-theme-backgroundPrimary"||a==="--apkt-tokens-core-backgroundAccentPrimary"?n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?n[a]=`color-mix(in srgb, ${s} ${i}%, ${c})`:n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base, ${c}))`)}),n}},{cssVariablesVarPrefix:tee}=Ks.createCSSVariables(fy);function ere(t,...e){return qi(t,...e.map(n=>Mr(typeof n=="function"?n(tee):n)))}let xo,Fo,ys,jr,ih;const Hs={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function oh(t,e="dark"){xo&&document.head.removeChild(xo),xo=document.createElement("style"),xo.textContent=Ks.createRootStyles(e,t),document.head.appendChild(xo)}function tre(t,e="dark"){if(ih=t,Fo=document.createElement("style"),ys=document.createElement("style"),jr=document.createElement("style"),Fo.textContent=oc(t).core.cssText,ys.textContent=oc(t).dark.cssText,jr.textContent=oc(t).light.cssText,document.head.appendChild(Fo),document.head.appendChild(ys),document.head.appendChild(jr),oh(t,e),hy(e),!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]))for(const[r,s]of Object.entries(Hs)){const i=document.createElement("link");i.rel="preload",i.href=s,i.as="font",i.type=r.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}hy(e)}function hy(t="dark"){ys&&jr&&xo&&(t==="light"?(oh(ih,t),ys.removeAttribute("media"),jr.media="enabled"):(oh(ih,t),jr.removeAttribute("media"),ys.media="enabled"))}function nee(t){if(ih=t,Fo&&ys&&jr){Fo.textContent=oc(t).core.cssText,ys.textContent=oc(t).dark.cssText,jr.textContent=oc(t).light.cssText;const e=t?.["--apkt-font-family"]||t?.["--w3m-font-family"];e&&(Fo.textContent=Fo.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),ys.textContent=ys.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),jr.textContent=jr.textContent?.replace("font-family: KHTeka",`font-family: ${e}`))}if(xo){const e=jr?.media==="enabled"?"light":"dark";oh(t,e)}}function oc(t){const e=!!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]);return{core:qi`
      ${e?qi``:qi`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Mr(Hs["KHTeka-400-woff2"])}) format('woff2'),
                url(${Mr(Hs["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Mr(Hs["KHTeka-300-woff2"])}) format('woff2'),
                url(${Mr(Hs["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${Mr(Hs["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${Mr(Hs["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Mr(Hs["KHTeka-400-woff2"])}) format('woff2'),
                url(${Mr(Hs["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:qi`
      :root {
      }
    `,light:qi`
      :root {
      }
    `}}const nre=qi`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,rre=qi`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,xd=".",A_={getSpacingStyles(t,e){if(Array.isArray(t))return t[e]?`var(--apkt-spacing-${t[e]})`:void 0;if(typeof t=="string")return`var(--apkt-spacing-${t})`},getFormattedDate(t){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(t)},formatCurrency(t=0,e={}){const n=Number(t);return isNaN(n)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2,...e}).format(n)},getHostName(t){try{return new URL(t).hostname}catch{return""}},getTruncateString({string:t,charsStart:e,charsEnd:n,truncate:r}){return t.length<=e+n?t:r==="end"?`${t.substring(0,e)}...`:r==="start"?`...${t.substring(t.length-n)}`:`${t.substring(0,Math.floor(e))}...${t.substring(t.length-Math.floor(n))}`},generateAvatarColors(t){const n=t.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),r=this.hexToRgb(n),s=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),o=100-3*Number(s?.replace("px","")),a=`${o}% ${o}% at 65% 40%`,c=[];for(let u=0;u<5;u+=1){const l=this.tintColor(r,.15*u);c.push(`rgb(${l[0]}, ${l[1]}, ${l[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${a}
   `},hexToRgb(t){const e=parseInt(t,16),n=e>>16&255,r=e>>8&255,s=e&255;return[n,r,s]},tintColor(t,e){const[n,r,s]=t,i=Math.round(n+(255-n)*e),o=Math.round(r+(255-r)*e),a=Math.round(s+(255-s)*e);return[i,o,a]},isNumber(t){return{number:/^[0-9]+$/u}.number.test(t)},getColorTheme(t){return t||(typeof window<"u"&&window.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark")},splitBalance(t){const e=t.split(".");return e.length===2?[e[0],e[1]]:["0","00"]},roundNumber(t,e,n){return t.toString().length>=e?Number(t).toFixed(n):t},cssDurationToNumber(t){return t.endsWith("s")?Number(t.replace("s",""))*1e3:t.endsWith("ms")?Number(t.replace("ms","")):0},maskInput({value:t,decimals:e,integers:n}){if(t=t.replace(",","."),t===xd)return`0${xd}`;const[r="",s]=t.split(xd).map(l=>l.replace(/[^0-9]/gu,"")),i=n?r.substring(0,n):r,o=i.length===2?String(Number(i)):i,a=typeof e=="number"?s?.substring(0,e):s,c=typeof e!="number"||e>0;return(typeof a=="string"&&c?[o,a].join(xd):o)??""},capitalize(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}},ree=3,Pd=.1,see=["receive","deposit","borrow","claim"],iee=["withdraw","repay","burn"],S_={getTransactionGroupTitle(t,e){const n=jw.getYear(),r=jw.getMonthNameByIndex(e);return t===n?r:`${r} ${t}`},getTransactionImages(t){const[e]=t;return t?.length>1?t.map(r=>this.getTransactionImage(r)):[this.getTransactionImage(e)]},getTransactionImage(t){return{type:S_.getTransactionTransferTokenType(t),url:S_.getTransactionImageURL(t)}},getTransactionImageURL(t){let e;const n=!!t?.nft_info,r=!!t?.fungible_info;return t&&n?e=t?.nft_info?.content?.preview?.url:t&&r&&(e=t?.fungible_info?.icon?.url),e},getTransactionTransferTokenType(t){if(t?.fungible_info)return"FUNGIBLE";if(t?.nft_info)return"NFT"},getTransactionDescriptions(t,e){const n=t?.metadata?.operationType,r=e||t?.transfers,s=r?.length>0,i=r?.length>1,o=s&&r?.every(f=>!!f?.fungible_info),[a,c]=r;let u=this.getTransferDescription(a),l=this.getTransferDescription(c);if(!s)return(n==="send"||n==="receive")&&o?(u=A_.getTruncateString({string:t?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),l=A_.getTruncateString({string:t?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[u,l]):[t.metadata.status];if(i)return r.map(f=>this.getTransferDescription(f));let d="";return see.includes(n)?d="+":iee.includes(n)&&(d="-"),u=d.concat(u),[u]},getTransferDescription(t){let e="";return t&&(t?.nft_info?e=t?.nft_info?.name||"-":t?.fungible_info&&(e=this.getFungibleTransferDescription(t)||"-")),e},getFungibleTransferDescription(t){return t?[this.getQuantityFixedValue(t?.quantity.numeric),t?.fungible_info?.symbol].join(" ").trim():null},mergeTransfers(t){if(t?.length<=1)return t;const n=this.filterGasFeeTransfers(t).reduce((s,i)=>{const o=i?.fungible_info?.name,a=s.find(({fungible_info:c,direction:u})=>o&&o===c?.name&&u===i.direction);if(a){const c=Number(a.quantity.numeric)+Number(i.quantity.numeric);a.quantity.numeric=c.toString(),a.value=(a.value||0)+(i.value||0)}else s.push(i);return s},[]);let r=n;return n.length>2&&(r=n.sort((s,i)=>(i.value||0)-(s.value||0)).slice(0,2)),r=r.sort((s,i)=>s.direction==="out"&&i.direction==="in"?-1:s.direction==="in"&&i.direction==="out"?1:0),r},filterGasFeeTransfers(t){const e=t.reduce((r,s)=>{const i=s?.fungible_info?.name;return i&&(r[i]||(r[i]=[]),r[i].push(s)),r},{}),n=[];return Object.values(e).forEach(r=>{if(r.length===1){const s=r[0];s&&n.push(s)}else{const s=r.filter(o=>o.direction==="in"),i=r.filter(o=>o.direction==="out");if(s.length===1&&i.length===1){const o=s[0],a=i[0];let c=!1;if(o&&a){const u=Number(o.quantity.numeric),l=Number(a.quantity.numeric);l<u*Pd?(n.push(o),c=!0):u<l*Pd&&(n.push(a),c=!0)}c||n.push(...r)}else{const o=this.filterGasFeesFromTokenGroup(r);n.push(...o)}}}),t.forEach(r=>{r?.fungible_info?.name||n.push(r)}),n},filterGasFeesFromTokenGroup(t){if(t.length<=1)return t;const e=t.map(a=>Number(a.quantity.numeric)),n=Math.max(...e),r=Math.min(...e),s=.01;if(r<n*s)return t.filter(c=>Number(c.quantity.numeric)>=n*s);const i=t.filter(a=>a.direction==="in"),o=t.filter(a=>a.direction==="out");if(i.length===1&&o.length===1){const a=i[0],c=o[0];if(a&&c){const u=Number(a.quantity.numeric),l=Number(c.quantity.numeric);if(l<u*Pd)return[a];if(u<l*Pd)return[c]}}return t},getQuantityFixedValue(t){return t?parseFloat(t).toFixed(ree):null}};function oee(t,e){const{kind:n,elements:r}=e;return{kind:n,elements:r,finisher(s){customElements.get(t)||customElements.define(t,s)}}}function aee(t,e){return customElements.get(t)||customElements.define(t,e),e}function sre(t){return function(n){return typeof n=="function"?aee(t,n):oee(t,n)}}const Od={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};class cee extends fN{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new hN({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const r=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>oe.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&De.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};const r=R.getAccountData();if(r?.balanceLoading&&e.chainId===R.state.activeCaipNetwork?.id)return{balance:r?.balance||"0.00",symbol:r?.balanceSymbol||""};const i=(await R.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return R.state.activeCaipNetwork?.chainNamespace===z.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Vc.encode(new TextEncoder().encode(r)),pubkey:s}},R.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},R.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===z.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:Jt(n.id)}]})}catch(s){if(s.code===Od.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Od.ERROR_INVALID_CHAIN_ID||s.code===Od.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Od.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:Jt(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const uee=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Rd={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?De.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?De.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?De.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?De.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>De.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>De.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>De.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?De.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t}},lee={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Rd[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Rd[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Rd[t].processApi(e)},processFallbackFeature(t,e){return Rd[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await ye.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?De.DEFAULT_REMOTE_FEATURES:De.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of uee){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),De.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;ft.open({debugMessage:ut.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class dee{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=R.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=R.getNetworkData(n)?.caipNetwork;return i||R.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return R.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>R.getCaipNetworks(n),this.getActiveChainNamespace=()=>R.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{R.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>R.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>R.state.activeChain===n||!n?R.state.activeCaipAddress:R.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{Ee.setClientId(n)},this.getProvider=n=>nt.getProvider(n),this.getProviderType=n=>nt.getProviderId(n),this.getPreferredAccountType=n=>Wt(n),this.setCaipAddress=(n,r,s=!1)=>{R.setAccountProp("caipAddress",n,r,s),R.setAccountProp("address",oe.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{R.setAccountProp("balance",n,s),R.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{R.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{R.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{R.setAccountProp("user",n,r)},this.resetAccount=n=>{R.resetAccount(n)},this.setCaipNetwork=n=>{R.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{R.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{R.setAccountProp("status",n,r),X.isConnected()?G.setConnectionStatus("connected"):G.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>R.getAccountData(n)?.address,this.setConnectors=n=>{const r=[...X.state.allConnectors,...n];X.setConnectors(r)},this.setConnections=(n,r)=>{G.setConnections(n,r),ie.setConnections(n,r)},this.fetchIdentity=n=>Ee.fetchIdentity(n),this.getReownName=n=>$u.getNamesForAddress(n),this.getConnectors=()=>X.getConnectors(),this.getConnectorImage=n=>RI.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Lf.getConnectionsData(n).connections:(ft.open(z.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Lf.getConnectionsData(n).recentConnections:(ft.open(z.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){ft.open(z.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await ie.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){ft.open(z.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}G.deleteAddressFromConnection(n),ie.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=nt.getProviderId(r),i=n?{...n,type:s}:void 0;R.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!R.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{const i=R.getAccountData(s)?.addressLabels||{};R.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{const s=R.getAccountData(r)?.addressLabels||{};R.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{const r=n||R.state.activeChain;return R.getAccountData(r)?.address},this.resetNetwork=n=>{R.resetNetwork(n)},this.addConnector=n=>{X.addConnector(n)},this.resetWcConnection=()=>{ie.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{R.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{R.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{R.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{V.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),V.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),!e.basic&&!e.manualWCControl&&(this.remoteFeatures=await lee.fetchRemoteFeatures(e)),await ye.fetchUsage(),V.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&lm.setOnrampProviders(this.remoteFeatures.onramp),(V.state.remoteFeatures?.email||Array.isArray(V.state.remoteFeatures?.socials)&&V.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),V.state.features?.reownAuthentication||V.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:n}=await kt(async()=>{const{ReownAuthentication:s}=await import("./features-D9a5eNDa.js");return{ReownAuthentication:s}},__vite__mapDeps([0,1,2,3,4,5])),r=V.state.siwx;r instanceof n||(r&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),V.setSIWX(new n))}}async openSend(e){const n=e.namespace||R.state.activeChain,r=this.getCaipAddress(n),s=this.getCaipNetwork(n)?.id;if(!r)throw new Error("openSend: caipAddress not found");if(s?.toString()!==e.chainId.toString()){const i=R.getCaipNetworkById(e.chainId,n);if(!i)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(i,{throwOnFailure:!0})}try{const i=mN.getTokenSymbolByAddress(e.assetAddress);i&&await ye.fetchTokenImages([i])}catch{}return await Ue.open({view:"WalletSend",data:{send:e}}),new Promise((i,o)=>{const a=ke.subscribeKey("hash",l=>{l&&(u(),i({hash:l}))}),c=Ue.subscribe(l=>{l.open||(u(),o(new Error("Modal closed")))}),u=this.createCleanupHandler([a,c])})}toModalOptions(){function e(r){return r?.view==="Swap"}function n(r){return r?.view==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await ye.fetchAllowedOrigins();if(!oe.isClient())return;const n=window.location.origin;li.isOriginAllowed(n,e,z.DEFAULT_ALLOWED_ANCESTORS)||ft.open(ut.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":ft.open(ut.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;ft.open({displayMessage:ut.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:ut.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){const{...n}=e;delete n.adapters,delete n.universalProvider,Te.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){$I.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&$n.setThemeMode(e.themeMode),e.themeVariables&&$n.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");R.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});const n=this.getDefaultNetwork();n&&R.setActiveCaipNetwork(n)}initializeConnectionController(e){ie.initialize(e.adapters??[]),ie.setWcBasic(e.basic??!1)}initializeConnectorController(){X.initialize(this.chainNamespaces)}initializeProjectSettings(e){V.setProjectId(e.projectId),V.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){V.setDebug(e.debug!==!1),V.setEnableWalletGuide(e.enableWalletGuide!==!1),V.setEnableWallets(e.enableWallets!==!1),V.setEIP6963Enabled(e.enableEIP6963!==!1),V.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),V.setEnableReconnect(e.enableReconnect!==!1),V.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),V.setCoinbasePreference(e.coinbasePreference),V.setEnableAuthLogger(e.enableAuthLogger!==!1),V.setCustomRpcUrls(e.customRpcUrls),V.setEnableEmbedded(e.enableEmbedded),V.setAllWallets(e.allWallets),V.setIncludeWalletIds(e.includeWalletIds),V.setExcludeWalletIds(e.excludeWalletIds),V.setFeaturedWalletIds(e.featuredWalletIds),V.setTokens(e.tokens),V.setTermsConditionsUrl(e.termsConditionsUrl),V.setPrivacyPolicyUrl(e.privacyPolicyUrl),V.setCustomWallets(e.customWallets),V.setFeatures(e.features),V.setAllowUnsupportedChain(e.allowUnsupportedChain),V.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),V.setPreferUniversalLinks(e.experimental_preferUniversalLinks),V.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),V.setMetadata(e.metadata),V.setDisableAppend(e.disableAppend),V.setEnableEmbedded(e.enableEmbedded),V.setSIWX(e.siwx),this.features=V.state.features??{},!e.projectId){ft.open(ut.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===z.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");V.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return oe.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=hs.getUnsupportedNetwork(`${n}:${e}`);R.setActiveCaipNetwork(r)}}getDefaultNetwork(){return hs.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return hs.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return hs.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>s.id===e.defaultNetwork?.id);return n?hs.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e);return(R.state.chains.get(e)?.accountState?.caipAddress||!V.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=R.state.activeChain,n=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,s=ie.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),G.setConnectedNamespaces([...R.state.chains.keys()]),await this.syncWalletConnectAccount(),await Ln.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{const i=R.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),G.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||R.state.activeChain,o=X.getConnectorId(i),a=n===z.CONNECTOR_ID.AUTH||o===z.CONNECTOR_ID.AUTH,c=n===z.CONNECTOR_ID.WALLET_CONNECT||o===z.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from(R.state.chains.keys());let l=r?[r]:u;(c||a)&&(l=u);const d=l.map(async g=>{const p=X.getConnectorId(g),y=n||p,E=await this.disconnectConnector(g,y);E&&(a&&G.deleteConnectedSocialProvider(),E.connections.forEach(A=>{G.addDisconnectedConnectorId(A.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),f=await Promise.allSettled(d);ke.resetSend(),ie.resetWcConnection(),Ln.getSIWX()?.signOutOnDisconnect&&await Ln.clearSessions(),X.setFilterByNamespace(void 0),ie.syncStorageConnections();const h=f.filter(g=>g.status==="rejected");if(h.length>0)throw new Error(h.map(g=>g.reason.message).join(", "));Te.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async e=>{const n=R.state.activeChain,r=this.getAdapter(R.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");return(await r?.signMessage({message:e,address:s,provider:nt.getProvider(n)}))?.signature||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(De.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=nt.getProvider(n);return(await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===z.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=nt.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=R.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:n,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),R.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await li.resolveReownName(e),writeContract:async e=>{const n=R.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=nt.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,n)=>{const r=this.getAdapter(R.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:n})??0n},formatUnits:(e,n)=>{const r=this.getAdapter(R.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:n})??"0"},getCapabilities:async e=>{const n=this.getAdapter(R.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(e)},grantPermissions:async e=>{const n=this.getAdapter(R.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(e)},revokePermissions:async e=>{const n=this.getAdapter(R.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(R.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(e)??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r?.id,e)}},ie.setClient(this.connectionControllerClient)}async onConnectExternal(e){const n=R.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===Ke.CONNECTOR_TYPE_AUTH&&z.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>X.getConnectorId(d)===z.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const u=this.getCaipNetworks().find(l=>l.chainNamespace===e.chain);u&&i&&this.setCaipNetwork(u)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return G.addConnectedNamespace(r),this.syncProvider({...c,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),G.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){const r=e.type===Ke.CONNECTOR_TYPE_AUTH,s=Hr.getOtherAuthNamespaces(n?.connectedCaipNetwork?.chainNamespace),i=R.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace);r&&(await Promise.all(s.map(async a=>{try{const c=nt.getProvider(a),u=this.getCaipNetwork(a);await this.getAdapter(a)?.connect({...e,provider:c,socialUri:void 0,chainId:u?.id,rpcUrl:u?.rpcUrls?.default?.http?.[0]})&&(G.addConnectedNamespace(a),G.removeDisconnectedConnectorId(e.id,a),this.setStatus("connected",a),this.syncConnectedWalletInfo(a))}catch(c){ft.warn(ut.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,ut.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(a,c instanceof Error?c.message:void 0),ut.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i}))}getApprovedCaipNetworksData(){if(nt.getProviderId(R.state.activeChain)===Ke.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=nt.getProviderId(n);if(e.chainNamespace===R.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:e});else if(this.setCaipNetwork(e),s===Ke.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(n);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Dt.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=e?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===r)}),n[r]=s):n[r]=new cee({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);const n=this.getAdapter(e);if(!n)throw new Error("adapter not found");await n.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=G.getConnectionStatus();V.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(G.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(u=>u.id.toString()===i.toString()||u.caipNetworkId.toString()===i.toString()),a=R.state.activeChain===e,c=R.state.chains.get(e)?.accountState?.address;if(o){const u=a&&s?s:c;u&&this.syncAccount({address:u,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(ie.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=R.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{this.handlePreviousConnectorConnection(o);const a=R.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=R.getNetworkData(e)?.caipNetwork?.id,u=i||c;a&&u?this.syncAccount({address:s,chainId:u,chainNamespace:e}):!a&&u?(this.syncAccountInfo(s,u,e),this.syncBalance({address:s,chainId:u,chainNamespace:e})):this.syncAccountInfo(s,i,e),G.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){const n=e?.chain,r=e?.id,s=X.getConnectorId(n),i=V.state.remoteFeatures?.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await ie.disconnect({id:s,namespace:n})}catch(c){console.warn("Error disconnecting previous connector",c)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>ie.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||G.deleteRecentWallet();const n=G.getRecentWallet();Te.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:oe.isMobile()?"mobile":"qrcode",name:n?.name||"Unknown",reconnect:!0,view:de.state.view,walletRank:n?.order}})}async syncNamespaceConnection(e){try{e===z.CHAIN.EVM&&oe.isSafeApp()&&X.setConnectorId(z.CONNECTOR_ID.SAFE,e);const n=X.getConnectorId(e);switch(this.setStatus("connecting",e),n){case z.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case z.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};R.resetAccount(n),R.resetNetwork(n),G.removeConnectedNamespace(n);const s=Array.from(R.state.chains.keys());(n?[n]:s).forEach(o=>G.addDisconnectedConnectorId(X.getConnectorId(o)||"",o)),X.removeConnectorId(n),nt.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&Ue.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n?.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=X.getConnectorId(e),o=X.getConnectors(e).find(a=>a.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),Te.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:de.state.view,walletRank:o?.explorerWallet?.order}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=R.state.activeCaipNetwork?.id,a=i.find(u=>{const{chainId:l}=Dt.parseCaipAddress(u);return l===o?.toString()})||i[0];if(a){const u=Dt.validateCaipAddress(a),{chainId:l,address:d}=Dt.parseCaipAddress(u);if(nt.setProviderId(r,Ke.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&R.state.activeCaipNetwork&&s.namespace!==z.CHAIN.EVM){const f=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:R.state.activeCaipNetwork});nt.setProvider(r,f)}else nt.setProvider(r,this.universalProvider);X.setConnectorId(z.CONNECTOR_ID.WALLET_CONNECT,r),G.addConnectedNamespace(r),await this.syncAccount({address:d,chainId:l,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);const c=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(r),R.setApprovedCaipNetworksData(r,{approvedCaipNetworkIds:c.approvedCaipNetworkIds,supportsAllNetworks:c.supportsAllNetworks})});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){nt.setProviderId(s,e),nt.setProvider(s,n),X.setConnectorId(r,s)}async syncAccount(e){const n=e.chainNamespace===R.state.activeChain,r=R.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=G.getActiveNetworkProps(),c=r?.id||a,u=R.state.activeCaipNetwork?.name===z.UNSUPPORTED_NETWORK_NAME,l=R.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(u&&!l)&&c){let d=this.getCaipNetworks().find(p=>p.id.toString()===c.toString()),f=this.getCaipNetworks().find(p=>p.chainNamespace===o);if(!l&&!d&&!f){const p=this.getApprovedCaipNetworkIds()||[],y=p.find(A=>Dt.parseCaipNetworkId(A)?.chainId===c.toString()),E=p.find(A=>Dt.parseCaipNetworkId(A)?.chainNamespace===o);d=this.getCaipNetworks().find(A=>A.caipNetworkId===y),f=this.getCaipNetworks().find(A=>A.caipNetworkId===E||"deprecatedCaipNetworkId"in A&&A.deprecatedCaipNetworkId===E)}const h=d||f;h?.chainNamespace===R.state.activeChain?V.state.enableNetworkSwitch&&!V.state.allowUnsupportedChain&&R.state.activeCaipNetwork?.name===z.UNSUPPORTED_NETWORK_NAME?R.showUnsupportedChainUI():this.setCaipNetwork(h):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const g=this.getAddress(o);Hr.isLowerCaseMatch(s,g)||this.syncAccountInfo(s,h?.id,o),n?await this.syncBalance({address:s,chainId:h?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){const n=X.getConnectorId(e),r=nt.getProviderId(e);if(r===Ke.CONNECTOR_TYPE_ANNOUNCED||r===Ke.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,u=o.connectors?.some(l=>l.id===n||l.info?.rdns===n);return a||c||!!u});if(i){const{info:o,name:a,imageUrl:c}=i,u=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:u,...o},e)}}}else if(r===Ke.CONNECTOR_TYPE_WALLET_CONNECT){const s=nt.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(n&&(n===z.CONNECTOR_ID.COINBASE_SDK||n===z.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!Fu.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=R.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const e=CQ.createLogger((s,...i)=>{s&&this.handleAlertError(s),console.error(...i)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};V.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await LX.init(n);const r=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await r()}catch(s){if(s instanceof Error&&s.message.includes("Missing or invalid. Record was recently deleted"))return;throw s}},V.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{li.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{ie.setUri(n)},onConnect:n=>{const{address:r}=oe.getAccount(n[0]);ie.finalizeWcConnection(r)},onDisconnect:()=>{R.state.noAdapters&&this.resetAccount(e),ie.resetWcConnection()},onChainChanged:n=>{const r=R.state.activeChain,s=r&&X.state.activeConnectorIds[r]===z.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(R.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=R.state.activeChain,s=r&&X.state.activeConnectorIds[r]===z.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(R.state.noAdapters||s)){const i=n?.[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&oe.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Te.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){const e=R.getAllApprovedCaipNetworkIds(),n=R.getAllRequestedCaipNetworks();return oe.sortRequestedNetworks(e,n).filter(s=>R.isCaipNetworkDisabled(s))}handleAlertError(e){const n=Object.entries(ut.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=ut.ALERT_ERRORS[o];a&&(ft.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e?.uri&&ie.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?Ue.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):Ue.open(e)}async close(){await this.injectModalUi(),Ue.close()}setLoading(e,n){Ue.setLoading(e,n)}async disconnect(e){await ie.disconnect({namespace:e})}getSIWX(){return V.state.siwx}getError(){return""}getChainId(){return R.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){ft.open(ut.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await R.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return R.state.activeChain?nt.state.providers[R.state.activeChain]:null}getWalletProviderType(){return nt.getProviderId(R.state.activeChain)}subscribeProviders(e){return nt.subscribeProviders(e)}getThemeMode(){return $n.state.themeMode}getThemeVariables(){return $n.state.themeVariables}setThemeMode(e){$n.setThemeMode(e),hy($n.state.themeMode)}setTermsConditionsUrl(e){V.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){V.setPrivacyPolicyUrl(e)}setThemeVariables(e){$n.setThemeVariables(e),nee($n.state.themeVariables)}subscribeTheme(e){return $n.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?ie.subscribe(e):(ft.open(z.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?R.state.chains.get(e)?.accountState?.connectedWalletInfo:R.getAccountData()?.connectedWalletInfo}getAccount(e){const n=e||R.state.activeChain,r=X.getAuthConnector(n),s=R.getAccountData(n),i=G.getConnectedConnectorId(R.state.activeChain),o=ie.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:u,type:l,publicKey:d})=>oe.createAccount(n,u,l||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:oe.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===z.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:G.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Wt(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?R.subscribeChainProp("accountState",r,n):R.subscribe(r),X.subscribe(r)}subscribeNetwork(e){return R.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(e,n){return n?R.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo),n):R.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){R.subscribeChainProp("accountState",n=>e(n?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){R.subscribeKey("activeCaipNetwork",e)}getState(){return zr.state}getRemoteFeatures(){return V.state.remoteFeatures}subscribeState(e){return zr.subscribe(e)}subscribeRemoteFeatures(e){return V.subscribeKey("remoteFeatures",e)}showErrorMessage(e){at.showError(e)}showSuccessMessage(e){at.showSuccess(e)}getEvent(){return{...Te.state}}subscribeEvents(e){return Te.subscribe(e)}replace(e){de.replace(e)}redirect(e){de.push(e)}popTransactionStack(e){de.popTransactionStack(e)}isOpen(){return Ue.state.open}isTransactionStackEmpty(){return de.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){V.setFeatures(e)}updateRemoteFeatures(e){V.setRemoteFeatures(e)}updateOptions(e){const r={...V.state||{},...e};V.setOptions(r)}setConnectMethodsOrder(e){V.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){V.setWalletFeaturesOrder(e)}setCollapseWallets(e){V.setCollapseWallets(e)}setSocialsOrder(e){V.setSocialsOrder(e)}getConnectMethodsOrder(){return Iu.getConnectOrderMethod(V.state.features,X.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||R.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&R.removeNetwork(e,n)}}let I_=!1;class fee extends dee{async onAuthProviderConnected(e){const n=Hr.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await Ln.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===z.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=V.state.defaultAccountTypes[n],i=Wt(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:u,...l}=e,d=R.getAccountData(n);this.setUser({...d?.user||{},...l},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),await Promise.all([this.syncAuthConnectorTheme(this.authProvider),this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:n})]),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{rr.checkIfRequestExists(n)?rr.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(lt.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(lt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=rr.checkIfRequestIsSafe(r),i=this.getAddress(),o=R.state.activeCaipNetwork;s||(i&&o?.id&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=R.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");X.getConnectorId(n)===z.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=R.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=$n.getSnapshot();await e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:ju(n.themeVariables,n.themeMode)})}async syncAuthConnector(e,n){const r=z.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===R.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),c=R.getAccountData(n)?.user||{};this.setUser({...c,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:u}=await e.isConnected();if(n&&r&&s)if(u&&this.connectionControllerClient?.connectExternal){await e.init(),await this.syncAuthConnectorTheme(e),await this.connectionControllerClient?.connectExternal({id:z.CONNECTOR_ID.AUTH,info:{name:z.CONNECTOR_ID.AUTH},type:Ke.CONNECTOR_TYPE_AUTH,provider:e,chainId:R.getNetworkData(n)?.caipNetwork?.id,chain:n}),this.setStatus("connected",n);const l=G.getConnectedSocialProvider();l?Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:l,reconnect:!0}}):Te.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0,view:de.state.view,walletRank:void 0}})}else X.getConnectorId(n)===z.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),G.removeConnectedNamespace(n));this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){try{if(!oe.isTelegram())return;const n=G.getTelegramSocialProvider();if(!n||!oe.isClient())return;const s=new URL(window.location.href).searchParams.get("result_uri");if(!s)return;n&&R.setAccountProp("socialProvider",n,e),await this.authProvider?.init();const i=X.getAuthConnector();n&&i&&(this.setLoading(!0,e),await ie.connectExternal({id:i.id,type:i.type,socialUri:s},i.chain),G.setConnectedSocialProvider(n),G.removeTelegramSocialProvider(),Te.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){if(!z.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=this.remoteFeatures?.email,s=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=Hr.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=Ho.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:ut.EmbeddedWalletAbortController,onTimeout:u=>{u==="iframe_load_failed"?ft.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):u==="iframe_request_timeout"?ft.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):u==="unverified_domain"&&ft.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:u=>ei(u),getCaipNetworks:u=>R.getCaipNetworks(u)}),zr.subscribeOpen(u=>{!u&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===R.state.activeChain&&V.state.enableReconnect;V.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&ye.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const n=R.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&R.getAccountData(r)?.caipAddress)await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e);else{const a=nt.getProviderId(n)===Ke.CONNECTOR_TYPE_AUTH,c=nt.getProviderId(r),u=c===Ke.CONNECTOR_TYPE_AUTH,l=z.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||u)&&l)try{R.state.activeChain=e.chainNamespace,s?await this.getAdapter(r)?.switchNetwork({caipNetwork:e}):await this.connectionControllerClient?.connectExternal?.({id:z.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:Ke.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(r)?.switchNetwork({caipNetwork:e})}else c===Ke.CONNECTOR_TYPE_WALLET_CONNECT?(R.state.noAdapters||await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r}))}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),zr.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){const s=`${r}:${n}`;if(this.caipNetworks?.find(a=>a.caipNetworkId===s)?.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=X.getConnectorId(r)===z.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e});!a&&o?await this.syncReownName(e,r):(this.setProfileName(a,r),this.setProfileImage(c,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=nt.getProviderId(e);if(n===Ke.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=G.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(oe.isClient()&&!I_)try{const e={...De.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),oe.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!V.state.disableAppend&&!V.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}I_=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!oe.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(kt(()=>import("./embedded-wallet-DsGHl2LI.js"),__vite__mapDeps([6,7,2,3,4,8,9,10,11,12,13,14,15,16,17,1,5]))),n.email&&r.push(kt(()=>import("./email-DWlaghZ0.js"),__vite__mapDeps([18,19,7,2,3,4,17,11,16,9,10,15,20,13,1,5]))),n.socials&&r.push(kt(()=>import("./socials-DDXz-Y7A.js"),__vite__mapDeps([21,7,2,3,4,9,22,10,23,16,24,15,11,25,8,5,26,1]))),n.swaps&&n.swaps.length>0&&r.push(kt(()=>import("./swaps-DmkWdRJu.js"),__vite__mapDeps([27,7,2,3,4,15,11,16,9,28,29,26,30,8,13,10,1,5]))),e.send&&r.push(kt(()=>import("./send-CQaMDvdb.js"),__vite__mapDeps([31,7,2,3,4,15,11,16,9,32,10,33,17,30,8,26,13,34,35,1,5]))),e.receive&&r.push(kt(()=>import("./receive-DqlfvApE.js"),__vite__mapDeps([36,7,2,3,4,9,8,25,5,1]))),n.onramp&&n.onramp.length>0&&r.push(kt(()=>import("./onramp-COl71srh.js"),__vite__mapDeps([37,7,2,3,4,9,38,11,22,10,8,39,40,17,15,16,24,13,1,5]))),n.payWithExchange&&r.push(kt(()=>import("./pay-with-exchange-BkVSq0uc.js"),__vite__mapDeps([41,7,2,3,4,9,8,14,38,11,26,15,33,10,17,16,13,34,32,1,5]))),n.activity&&r.push(kt(()=>import("./transactions-CaXXJlby.js"),__vite__mapDeps([42,7,2,3,4,43,16,9,17,8,26,1,5]))),(e.pay||n.payments)&&r.push(kt(()=>import("./index-OHmYjhGf.js"),__vite__mapDeps([44,7,2,3,4,9,15,11,45,14,8,38,46,32,47,16,24,1,5]))),n.emailCapture&&r.push(kt(()=>import("./data-capture-DyRWRugJ.js"),__vite__mapDeps([48,7,2,3,4,19,17,11,0,1,5]))),await Promise.all([...r,kt(()=>import("./index-DWvgfAU_.js"),__vite__mapDeps([49,7,2,3,4,9,8,11,35,16,50,40,17,12,47,14,38,15,43,26,34,28,29,32,10,13,46,20,22,23,24,25,5,39,1])),kt(()=>import("./w3m-modal-NEk6MaSi.js"),__vite__mapDeps([51,7,2,3,4,9,45,8,12,11,16,29,50,40,17,47,15,1,5]))])}}const hee="1.8.14";function ire(t){return new fee({...t,sdkVersion:oe.generateSdkVersion(t.adapters??[],"html",hee)})}function _r(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const tf="2.22.1",pee=()=>`@wagmi/core@${tf}`;var AN=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ah,SN;class es extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return pee()}constructor(e,n={}){super(),ah.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof es?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof es&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return AN(this,ah,"m",SN).call(this,this,e)}}ah=new WeakSet,SN=function t(e,n){return n?.(e)?e:e.cause?AN(this,ah,"m",t).call(this,e.cause,n):e};class yl extends es{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class gee extends es{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class mee extends es{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class yee extends es{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class bee extends es{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class wee extends es{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function yg(t,e){let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new gee;try{t.setState(o=>({...o,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:r,...s}=e,i=await n.connect(s);return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await t.storage?.setItem("recentConnectorId",n.id),t.setState(o=>({...o,connections:new Map(o.connections).set(n.uid,{accounts:s.withCapabilities?i.accounts.map(a=>typeof a=="object"?a.address:a):i.accounts,chainId:i.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:s.withCapabilities?i.accounts.map(o=>typeof o=="object"?o:{address:o,capabilities:{}}):i.accounts,chainId:i.chainId}}catch(r){throw t.setState(s=>({...s,status:s.current?"connected":"disconnected"})),r}}async function vp(t,e={}){const{assertChainId:n=!0}=e;let r;if(e.connector){const{connector:l}=e;if(t.state.status==="reconnecting"&&!l.getAccounts&&!l.getChainId)throw new wee({connector:l});const[d,f]=await Promise.all([l.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),l.getChainId()]);r={accounts:d,chainId:f,connector:l}}else r=t.state.connections.get(t.state.current);if(!r)throw new mee;const s=e.chainId??r.chainId,i=await r.connector.getChainId();if(n&&i!==s)throw new bee({connectionChainId:s,connectorChainId:i});const o=r.connector;if(o.getClient)return o.getClient({chainId:s});const a=Qt(e.account??r.accounts[0]);if(a&&(a.address=ps(a.address)),e.account&&!r.accounts.some(l=>l.toLowerCase()===a.address.toLowerCase()))throw new yee({address:a.address,connector:o});const c=t.chains.find(l=>l.id===s),u=await r.connector.getProvider({chainId:s});return Fh({account:a,chain:c,name:"Connector Client",transport:l=>NI(u)({...l,retryCount:0})})}async function T_(t,e={}){let n;if(e.connector)n=e.connector;else{const{connections:s,current:i}=t.state;n=s.get(i)?.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(s=>{if(r.size===0)return{...s,connections:new Map,current:null,status:"disconnected"};const i=r.values().next().value;return{...s,connections:new Map(r),current:i.connector.uid}});{const s=t.state.current;if(!s)return;const i=t.state.connections.get(s)?.connector;if(!i)return;await t.storage?.setItem("recentConnectorId",i.id)}}function IN(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(r2[t])}async function Eee(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await vp(t,{account:e.account,assertChainId:!1,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return _r(o,xh,"estimateGas")({...s,account:i})}function Uu(t){const e=t.state.current,n=t.state.connections.get(e),r=n?.accounts,s=r?.[0],i=t.chains.find(a=>a.id===n?.chainId),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function vee(t,e){const{allowFailure:n=!0,chainId:r,contracts:s,...i}=e,o=t.getClient({chainId:r});return _r(o,bI,"multicall")({allowFailure:n,contracts:s,...i})}function Cee(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return _r(s,Ir,"readContract")(r)}async function _ee(t,e){const{allowFailure:n=!0,blockNumber:r,blockTag:s,...i}=e,o=e.contracts;try{const a={};for(const[d,f]of o.entries()){const h=f.chainId??t.state.chainId;a[h]||(a[h]=[]),a[h]?.push({contract:f,index:d})}const c=()=>Object.entries(a).map(([d,f])=>vee(t,{...i,allowFailure:n,blockNumber:r,blockTag:s,chainId:Number.parseInt(d,10),contracts:f.map(({contract:h})=>h)})),u=(await Promise.all(c())).flat(),l=Object.values(a).flatMap(d=>d.map(({index:f})=>f));return u.reduce((d,f,h)=>(d&&(d[l[h]]=f),d),[])}catch(a){if(a instanceof wh)throw a;const c=()=>o.map(u=>Cee(t,{...u,blockNumber:r,blockTag:s}));return n?(await Promise.allSettled(c())).map(u=>u.status==="fulfilled"?{result:u.value,status:"success"}:{error:u.reason,result:void 0,status:"failure"}):await Promise.all(c())}}async function Aee(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await N_(t,{balanceAddress:n,chainId:i,symbolType:"string",tokenAddress:o})}catch(f){if(f.name==="ContractFunctionExecutionError"){const h=await N_(t,{balanceAddress:n,chainId:i,symbolType:"bytes32",tokenAddress:o}),g=By(yn(h.symbol,{dir:"right"}));return{...h,symbol:g}}throw f}const c=t.getClient({chainId:i}),l=await _r(c,xS,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),d=t.chains.find(f=>f.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:uo(l,IN(a)),symbol:d.nativeCurrency.symbol,value:l}}async function N_(t,e){const{balanceAddress:n,chainId:r,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,u,l]=await _ee(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[n],chainId:r},{...a,functionName:"decimals",chainId:r},{...a,functionName:"symbol",chainId:r}]}),d=uo(c??"0",IN(o??u));return{decimals:u,formatted:d,symbol:l,value:c}}function bl(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!bl(t[r],e[r]))return!1;return!0}if(typeof t.valueOf=="function"&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.hasOwn(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!bl(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let kd=[];function Ws(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||bl(kd,e)?kd:(kd=e,e)}async function See(t,e){const{account:n,chainId:r,...s}=e,i=n??Uu(t).address,o=t.getClient({chainId:r});return _r(o,Nh,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let bg=!1;async function wg(t,e={}){if(bg)return[];bg=!0,t.setState(u=>({...u,status:u.current?"reconnecting":"connecting"}));const n=[];if(e.connectors?.length)for(const u of e.connectors){let l;typeof u=="function"?l=t._internal.connectors.setup(u):l=u,n.push(l)}else n.push(...t.connectors);let r;try{r=await t.storage?.getItem("recentConnectorId")}catch{}const s={};for(const[,u]of t.state.connections)s[u.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((u,l)=>(s[u.id]??10)-(s[l.id]??10)):n;let o=!1;const a=[],c=[];for(const u of i){const l=await u.getProvider().catch(()=>{});if(!l||c.some(h=>h===l)||!await u.isAuthorized())continue;const f=await u.connect({isReconnecting:!0}).catch(()=>null);f&&(u.emitter.off("connect",t._internal.events.connect),u.emitter.on("change",t._internal.events.change),u.emitter.on("disconnect",t._internal.events.disconnect),t.setState(h=>{const g=new Map(o?h.connections:new Map).set(u.uid,{accounts:f.accounts,chainId:f.chainId,connector:u});return{...h,current:o?h.current:u.uid,connections:g}}),a.push({accounts:f.accounts,chainId:f.chainId,connector:u}),c.push(l),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(u=>({...u,status:"connected"})):t.setState(u=>({...u,connections:new Map,current:null,status:"disconnected"}))),bg=!1,a}async function Iee(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await vp(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await _r(o,dS,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function Tee(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await vp(t,{account:n,connector:r}),_r(i,X4,"signMessage")({...s,...n?{account:n}:{}})}class Bi extends es{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class Nee extends es{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function x_(t,e){const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(e.connector?.uid??t.state.current);if(s){const o=s.connector;if(!o.switchChain)throw new Nee({connector:o});return await o.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(o=>o.id===r);if(!i)throw new yl;return t.setState(o=>({...o,chainId:r})),i}async function xee(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await _r(i,SI,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const c=_r(i,Wh,"getTransaction"),{from:u,...l}=await c({hash:a.transactionHash}),f=await _r(i,zc,"call")({...l,account:u,data:l.input,gasPrice:l.type!=="eip1559"?l.gasPrice:void 0,maxFeePerGas:l.type==="eip1559"?l.maxFeePerGas:void 0,maxPriorityFeePerGas:l.type==="eip1559"?l.maxPriorityFeePerGas:void 0}),h=f?.data?By(`0x${f.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}function Pee(t,e){const{onChange:n}=e;return t.subscribe(()=>Uu(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return bl(o,c)&&i?.id===a?.id&&i?.uid===a?.uid}})}function Oee(t,e){const{onChange:n}=e;return t.subscribe(()=>Ws(t),n,{equalityFn:bl})}function Ree(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function kee(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const u=t.getClient({chainId:c});return s=_r(u,II,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o?.(),a?.()}}async function $ee(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await vp(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await _r(o,Df,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function ore(t){return t}Cp.type="injected";function Cp(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const u=c();if(u)return u}return typeof c=="object"?c:typeof c=="string"?{...Dee[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(u){return u?.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},get supportsSimulation(){return!0},type:Cp.type,async setup(){const u=await this.getProvider();u?.on&&t.target&&(o||(o=this.onConnect.bind(this),u.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),u.on("accountsChanged",s)))},async connect({chainId:u,isReconnecting:l,withCapabilities:d}={}){const f=await this.getProvider();if(!f)throw new Bi;let h=[];if(l)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(await f.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0]?.caveats?.[0]?.value?.map(p=>ps(p)),h.length>0&&(h=await this.getAccounts())}catch(g){const p=g;if(p.code===yt.code)throw new yt(p);if(p.code===ii.code)throw p}try{!h?.length&&!l&&(h=(await f.request({method:"eth_requestAccounts"})).map(y=>ps(y))),o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),f.on("disconnect",a));let g=await this.getChainId();return u&&g!==u&&(g=(await this.switchChain({chainId:u}).catch(y=>{if(y.code===yt.code)throw y;return{id:g}}))?.id??g),e&&await c.storage?.removeItem(`${this.id}.disconnected`),t.target||await c.storage?.setItem("injected.connected",!0),{accounts:d?h.map(p=>({address:p,capabilities:{}})):h,chainId:g}}catch(g){const p=g;throw p.code===yt.code?new yt(p):p.code===ii.code?new ii(p):p}},async disconnect(){const u=await this.getProvider();if(!u)throw new Bi;i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o));try{await Eb(()=>u.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await c.storage?.setItem(`${this.id}.disconnected`,!0),t.target||await c.storage?.removeItem("injected.connected")},async getAccounts(){const u=await this.getProvider();if(!u)throw new Bi;return(await u.request({method:"eth_accounts"})).map(d=>ps(d))},async getChainId(){const u=await this.getProvider();if(!u)throw new Bi;const l=await u.request({method:"eth_chainId"});return Number(l)},async getProvider(){if(typeof window>"u")return;let u;const l=r();return typeof l.provider=="function"?u=l.provider(window):typeof l.provider=="string"?u=nf(window,l.provider):u=l.provider,u&&!u.removeListener&&("off"in u&&typeof u.off=="function"?u.removeListener=u.off:u.removeListener=()=>{}),u},async isAuthorized(){try{if(e&&await c.storage?.getItem(`${this.id}.disconnected`)||!t.target&&!await c.storage?.getItem("injected.connected"))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const f=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",f),!!await this.getProvider()),h=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(p=>window.addEventListener("ethereum#initialized",()=>p(f()),{once:!0}))]:[],new Promise(p=>setTimeout(()=>p(f()),h))]))return!0}throw new Bi}return!!(await Oc(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:u,chainId:l}){const d=await this.getProvider();if(!d)throw new Bi;const f=c.chains.find(g=>g.id===l);if(!f)throw new Zr(new yl);const h=new Promise(g=>{const p=(y=>{"chainId"in y&&y.chainId===l&&(c.emitter.off("change",p),g())});c.emitter.on("change",p)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:ee(l)}]}).then(async()=>{await this.getChainId()===l&&c.emitter.emit("change",{chainId:l})}),h]),f}catch(g){const p=g;if(p.code===4902||p?.data?.originalError?.code===4902)try{const{default:y,...E}=f.blockExplorers??{};let A;u?.blockExplorerUrls?A=u.blockExplorerUrls:y&&(A=[y.url,...Object.values(E).map(_=>_.url)]);let w;u?.rpcUrls?.length?w=u.rpcUrls:w=[f.rpcUrls.default?.http[0]??""];const C={blockExplorerUrls:A,chainId:ee(l),chainName:u?.chainName??f.name,iconUrls:u?.iconUrls,nativeCurrency:u?.nativeCurrency??f.nativeCurrency,rpcUrls:w};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[C]}).then(async()=>{if(await this.getChainId()===l)c.emitter.emit("change",{chainId:l});else throw new yt(new Error("User rejected switch after adding network."))}),h]),f}catch(y){throw new yt(y)}throw p.code===yt.code?new yt(p):new Zr(p)}},async onAccountsChanged(u){if(u.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const l=(await this.getChainId()).toString();this.onConnect({chainId:l}),e&&await c.storage?.removeItem(`${this.id}.disconnected`)}else c.emitter.emit("change",{accounts:u.map(l=>ps(l))})},onChainChanged(u){const l=Number(u);c.emitter.emit("change",{chainId:l})},async onConnect(u){const l=await this.getAccounts();if(l.length===0)return;const d=Number(u.chainId);c.emitter.emit("connect",{accounts:l,chainId:d});const f=await this.getProvider();f&&(o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),f.on("disconnect",a)))},async onDisconnect(u){const l=await this.getProvider();u&&u.code===1013&&l&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),l&&(i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o))))}})}const Dee={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t?.coinbaseWalletExtension?t.coinbaseWalletExtension:nf(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return nf(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){return t?.phantom?.ethereum?t.phantom?.ethereum:nf(t,"isPhantom")}}};function nf(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r?.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function Uee(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function Bee(){const t=new Set;let e=[];const n=()=>Uee(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r?.()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r?.(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const Mee=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let u=o;if(a){const l=c?.equalityFn||Object.is;let d=o(r.getState());u=f=>{const h=o(f);if(!l(d,h)){const g=d;a(d=h,g)}},c?.fireImmediately&&a(d,d)}return s(u)},t(e,n,r)},Lee=Mee;function Fee(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const py=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return py(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return py(r)(n)}}}},jee=(t,e)=>(n,r,s)=>{let i={storage:Fee(()=>localStorage),partialize:p=>p,version:0,merge:(p,y)=>({...y,...p}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...p)},r,s);const l=()=>{const p=i.partialize({...r()});return u.setItem(i.name,{state:p,version:i.version})},d=s.setState;s.setState=(p,y)=>{d(p,y),l()};const f=t((...p)=>{n(...p),l()},r,s);s.getInitialState=()=>f;let h;const g=()=>{var p,y;if(!u)return;o=!1,a.forEach(A=>{var w;return A((w=r())!=null?w:f)});const E=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(p=r())!=null?p:f))||void 0;return py(u.getItem.bind(u))(i.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==i.version){if(i.migrate)return[!0,i.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var w;const[C,_]=A;if(h=i.merge(_,(w=r())!=null?w:f),n(h,!0),C)return l()}).then(()=>{E?.(h,void 0),h=r(),o=!0,c.forEach(A=>A(h))}).catch(A=>{E?.(void 0,A)})};return s.persist={setOptions:p=>{i={...i,...p},p.storage&&(u=p.storage)},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:p=>(a.add(p),()=>{a.delete(p)}),onFinishHydration:p=>(c.add(p),()=>{c.delete(p)})},i.skipHydration||g(),h||f},qee=jee,P_=t=>{let e;const n=new Set,r=(u,l)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const f=e;e=l??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(h=>h(e,f))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u))},c=e=t(r,s,a);return a},Eg=t=>t?P_(t):P_;class zee{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new Y7})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function Hee(t){return new zee(t)}function Wee(t,e){return JSON.parse(t,(n,r)=>{let s=r;return s?.__type==="bigint"&&(s=BigInt(s.value)),s?.__type==="Map"&&(s=new Map(s.value)),e?.(n,s)??s})}function O_(t,e){return t.slice(0,e).join(".")||"."}function R_(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function Vee(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const u=R_(s,this);u===0?s[s.length]=this:(s.splice(u),i.splice(u)),i[i.length]=a;const l=R_(s,c);if(l!==0)return r?e.call(this,a,c,O_(i,l)):`[ref=${O_(i,l)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function Kee(t,e,n,r){return JSON.stringify(t,Vee((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),e?.(s,o)??o},r),n??void 0)}function Gee(t){const{deserialize:e=Wee,key:n="wagmi",serialize:r=Kee,storage:s=TN}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),u=await i(c);return u?e(u)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const TN={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function Yee(){const t=typeof window<"u"&&window.localStorage?window.localStorage:TN;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const gy=256;let $d=gy,Dd;function Zee(t=11){if(!Dd||$d+t>gy*2){Dd="",$d=0;for(let e=0;e<gy;e++)Dd+=(256+Math.random()*256|0).toString(16).substring(1)}return Dd.substring($d,$d+++t)}function Jee(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=Gee({storage:Yee()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?Bee():void 0,a=Eg(()=>i.chains),c=Eg(()=>{const _=[],P=new Set;for(const k of i.connectors??[]){const U=u(k);if(_.push(U),!s&&U.rdns){const $=typeof U.rdns=="string"?[U.rdns]:U.rdns;for(const L of $)P.add(L)}}if(!s&&o){const k=o.getProviders();for(const U of k)P.has(U.info.rdns)||_.push(u(l(U)))}return _});function u(_){const P=Hee(Zee()),k={..._({emitter:P,chains:a.getState(),storage:n,transports:i.transports}),emitter:P,uid:P.uid};return P.on("connect",w),k.setup?.(),k}function l(_){const{info:P}=_,k=_.provider;return Cp({target:{...P,id:P.rdns,provider:k}})}const d=new Map;function f(_={}){const P=_.chainId??y.getState().chainId,k=a.getState().find($=>$.id===P);if(_.chainId&&!k)throw new yl;{const $=d.get(y.getState().chainId);if($&&!k)return $;if(!k)throw new yl}{const $=d.get(P);if($)return $}let U;if(i.client)U=i.client({chain:k});else{const $=k.id,L=a.getState().map(T=>T.id),M={},D=Object.entries(i);for(const[T,O]of D)if(!(T==="chains"||T==="client"||T==="connectors"||T==="transports"))if(typeof O=="object")if($ in O)M[T]=O[$];else{if(L.some(b=>b in O))continue;M[T]=O}else M[T]=O;U=Fh({...M,chain:k,batch:M.batch??{multicall:!0},transport:T=>i.transports[$]({...T,connectors:c})})}return d.set(P,U),U}function h(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let g;const p="0.0.0-canary-";tf.startsWith(p)?g=Number.parseInt(tf.replace(p,""),10):g=Number.parseInt(tf.split(".")[0]??"0",10);const y=Eg(Lee(n?qee(h,{migrate(_,P){if(P===g)return _;const k=h(),U=E(_,k.chainId);return{...k,chainId:U}},name:"store",partialize(_){return{connections:{__type:"Map",value:Array.from(_.connections.entries()).map(([P,k])=>{const{id:U,name:$,type:L,uid:M}=k.connector;return[P,{...k,connector:{id:U,name:$,type:L,uid:M}}]})},chainId:_.chainId,current:_.current}},merge(_,P){typeof _=="object"&&_&&"status"in _&&delete _.status;const k=E(_,P.chainId);return{...P,..._,chainId:k}},skipHydration:s,storage:n,version:g}):h));y.setState(h());function E(_,P){return _&&typeof _=="object"&&"chainId"in _&&typeof _.chainId=="number"&&a.getState().some(k=>k.id===_.chainId)?_.chainId:P}r&&y.subscribe(({connections:_,current:P})=>P?_.get(P)?.chainId:void 0,_=>{if(a.getState().some(k=>k.id===_))return y.setState(k=>({...k,chainId:_??k.chainId}))}),o?.subscribe(_=>{const P=new Set,k=new Set;for(const $ of c.getState())if(P.add($.id),$.rdns){const L=typeof $.rdns=="string"?[$.rdns]:$.rdns;for(const M of L)k.add(M)}const U=[];for(const $ of _){if(k.has($.info.rdns))continue;const L=u(l($));P.has(L.id)||U.push(L)}n&&!y.persist.hasHydrated()||c.setState($=>[...$,...U],!0)});function A(_){y.setState(P=>{const k=P.connections.get(_.uid);return k?{...P,connections:new Map(P.connections).set(_.uid,{accounts:_.accounts??k.accounts,chainId:_.chainId??k.chainId,connector:k.connector})}:P})}function w(_){y.getState().status==="connecting"||y.getState().status==="reconnecting"||y.setState(P=>{const k=c.getState().find(U=>U.uid===_.uid);return k?(k.emitter.listenerCount("connect")&&k.emitter.off("connect",A),k.emitter.listenerCount("change")||k.emitter.on("change",A),k.emitter.listenerCount("disconnect")||k.emitter.on("disconnect",C),{...P,connections:new Map(P.connections).set(_.uid,{accounts:_.accounts,chainId:_.chainId,connector:k}),current:_.uid,status:"connected"}):P})}function C(_){y.setState(P=>{const k=P.connections.get(_.uid);if(k){const $=k.connector;$.emitter.listenerCount("change")&&k.connector.emitter.off("change",A),$.emitter.listenerCount("disconnect")&&k.connector.emitter.off("disconnect",C),$.emitter.listenerCount("connect")||k.connector.emitter.on("connect",w)}if(P.connections.delete(_.uid),P.connections.size===0)return{...P,connections:new Map,current:null,status:"disconnected"};const U=P.connections.values().next().value;return{...P,connections:new Map(P.connections),current:U.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:f,get state(){return y.getState()},setState(_){let P;typeof _=="function"?P=_(y.getState()):P=_;const k=h();typeof P!="object"&&(P=k),Object.keys(k).some($=>!($ in P))&&(P=k),y.setState(P,!0)},subscribe(_,P,k){return y.subscribe(_,P,k?{...k,fireImmediately:k.emitImmediately}:void 0)},_internal:{mipd:o,async revalidate(){const _=y.getState(),P=_.connections;let k=_.current;for(const[,U]of P){const $=U.connector;$.isAuthorized&&await $.isAuthorized()||(P.delete($.uid),k===$.uid&&(k=null))}y.setState(U=>({...U,connections:P,current:k}))},store:y,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(_){const P=typeof _=="function"?_(a.getState()):_;if(P.length!==0)return a.setState(P,!0)},subscribe(_){return a.subscribe(_)}},connectors:{providerDetailToConnector:l,setup:u,setState(_){return c.setState(typeof _=="function"?_(c.getState()):_,!0)},subscribe(_){return c.subscribe(_)}},events:{change:A,connect:w,disconnect:C}}}}const Xee={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},Qee={block:_2({format(t){return{transactions:t.transactions?.map(n=>{if(typeof n=="string")return n;const r=Nl(n);return r.typeHex==="0x7e"&&(r.isSystemTx=n.isSystemTx,r.mint=n.mint?zt(n.mint):void 0,r.sourceHash=n.sourceHash,r.type="deposit"),r}),stateRoot:t.stateRoot}}}),transaction:C2({format(t){const e={};return t.type==="0x7e"&&(e.isSystemTx=t.isSystemTx,e.mint=t.mint?zt(t.mint):void 0,e.sourceHash=t.sourceHash,e.type="deposit"),e}}),transactionReceipt:pS({format(t){return{l1GasPrice:t.l1GasPrice?zt(t.l1GasPrice):null,l1GasUsed:t.l1GasUsed?zt(t.l1GasUsed):null,l1Fee:t.l1Fee?zt(t.l1Fee):null,l1FeeScalar:t.l1FeeScalar?Number(t.l1FeeScalar):null}}})};function ete(t,e){return rte(t)?nte(t):kS(t,e)}const tte={transaction:ete};function nte(t){ste(t);const{sourceHash:e,data:n,from:r,gas:s,isSystemTx:i,mint:o,to:a,value:c}=t,u=[e,r,a??"0x",o?Jt(o):"0x",c?Jt(c):"0x",s?Jt(s):"0x",i?"0x1":"0x",n??"0x"];return Sn(["0x7e",pi(u)])}function rte(t){return t.type==="deposit"||typeof t.sourceHash<"u"}function ste(t){const{from:e,to:n}=t;if(e&&!_t(e))throw new Xt({address:e});if(n&&!_t(n))throw new Xt({address:n})}const Ns={blockTime:2e3,contracts:Xee,formatters:Qee,serializers:tte},are=Gn({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:250,rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),cre=Gn({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:11907934}}}),pu=1,ite=Gn({...Ns,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...Ns.contracts,disputeGameFactory:{[pu]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[pu]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[pu]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[pu]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:pu});({...ite});const gu=11155111,ote=Gn({...Ns,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...Ns.contracts,disputeGameFactory:{[gu]:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{[gu]:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{[gu]:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{[gu]:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:gu});({...ote});const ure=Gn({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}}),lre=Gn({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),mu=1,dre=Gn({...Ns,id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.optimism.io"]}},blockExplorers:{default:{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io/api"}},contracts:{...Ns.contracts,disputeGameFactory:{[mu]:{address:"0xe5965Ab5962eDc7477C8520243A95517CD252fA9"}},l2OutputOracle:{[mu]:{address:"0xdfe97868233d1aa22e815a266982f2cf17685a27"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:4286263},portal:{[mu]:{address:"0xbEb5Fc579115071764c7423A4f12eDde41f106Ed"}},l1StandardBridge:{[mu]:{address:"0x99C9fc46f92E8a1c0deC1b1747d010903E884bE1"}}},sourceId:mu}),yu=11155111,fre=Gn({...Ns,id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.optimism.io"]}},blockExplorers:{default:{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}},contracts:{...Ns.contracts,disputeGameFactory:{[yu]:{address:"0x05F9613aDB30026FFd634f38e5C4dFd30a197Fa1"}},l2OutputOracle:{[yu]:{address:"0x90E9c4f8a994a250F6aEfd61CAFb4F2e895D458F"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1620204},portal:{[yu]:{address:"0x16Fc5058F25648194471939df75CF27A2fdC48BC"}},l1StandardBridge:{[yu]:{address:"0xFBb0621E0B23b5478B630BD55a5f21f67730B0F1"}}},testnet:!0,sourceId:yu}),hre=Gn({id:137,name:"Polygon",blockTime:2e3,nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:25770160}}}),pre=Gn({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://11155111.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:8928790}},testnet:!0}),Ud=1,gre=Gn({...Ns,id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.zora.energy"],webSocket:["wss://rpc.zora.energy"]}},blockExplorers:{default:{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}},contracts:{...Ns.contracts,l2OutputOracle:{[Ud]:{address:"0x9E6204F750cD866b299594e2aC9eA824E2e5f95c"}},multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:5882},portal:{[Ud]:{address:"0x1a0ad011913A150f69f6A19DF447A0CfD9551054"}},l1StandardBridge:{[Ud]:{address:"0x3e2Ea9B92B7E48A52296fD261dc26fd995284631"}}},sourceId:Ud});function ate(t){let e=[],n,r;function s(a){const c=R.getCaipNetworks(z.CHAIN.EVM);let u=Number(Fu.parseEvmChainId(a));if(!c.some(l=>String(l.id)===String(a))){const l=R.getActiveCaipNetwork(z.CHAIN.EVM)?.id||c[0]?.id;l&&Number.isInteger(Number(l))&&(u=Number(l))}if(!u)throw new Error("ChainId not found in networks");return u}function i(){return n||(n=Ho.getInstance({projectId:t.options.projectId,chainId:ei()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:a=>{a==="iframe_load_failed"?ft.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):a==="iframe_request_timeout"?ft.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):a==="unverified_domain"&&ft.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:ut.EmbeddedWalletAbortController,getActiveCaipNetwork:a=>ei(a),getCaipNetworks:a=>R.getCaipNetworks(a)})),n}async function o(a={}){const c=i();let u=a.chainId;if(a.isReconnecting){const p=Fu.parseEvmChainId(c.getLastUsedChainId()||""),y=t.chains?.[0].id;if(u=p||y,!u)throw new Error("ChainId not found in provider")}const l=Wt("eip155"),{address:d,chainId:f,accounts:h}=await Ln.authConnectorAuthenticate({authConnector:c,chainId:u,preferredAccountType:l,socialUri:a.socialUri,chainNamespace:z.CHAIN.EVM});e=h?.map(p=>p.address)||[d];const g=s(f);return{accounts:e,account:d,chainId:g,chain:{id:g,unsupported:!1}}}return a=>({id:z.CONNECTOR_ID.AUTH,name:z.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:z.CHAIN.EVM,async connect(c={}){if(r){const l=await r;return{accounts:c.withCapabilities?l.accounts.map(d=>({address:d,capabilities:{}})):l.accounts,chainId:l.chainId}}r||(r=new Promise(l=>{l(o(c))}));const u=await r;return r=void 0,{accounts:c.withCapabilities?u.accounts.map(l=>({address:l,capabilities:{}})):u.accounts,chainId:u.chainId}},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e?.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){return this.provider||(this.provider=Ho.getInstance({projectId:t.options.projectId,chainId:ei()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:ut.EmbeddedWalletAbortController,onTimeout:c=>{c==="iframe_load_failed"?ft.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?ft.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&ft.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:c=>ei(c),getCaipNetworks:c=>R.getCaipNetworks(c)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:u}=await c.getChainId();return s(u)},async isAuthorized(){const u=R.state.activeChain===z.CHAIN.EVM;if(z.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(f=>X.getConnectorId(f)===z.CONNECTOR_ID.AUTH)&&!u)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){try{const u=a.chains.find(h=>h.id===c);if(!u)throw new Zr(new Error("chain not found on connector."));const l=await this.getProvider(),d=Wt("eip155"),f=await l.connect({chainId:c,preferredAccountType:d});return e=f?.accounts?.map(h=>h.address)||[f.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),u}catch(u){throw u instanceof Error?new Zr(u):u}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(ps)})},onChainChanged(c){const u=Number(c);a.emitter.emit("change",{chainId:u})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}Aw.type="walletConnect";function Aw(t){const e=t.isNewChainsStale??!0;let n,r,s,i,o,a,c;return u=>({id:"walletConnect",name:"WalletConnect",type:Aw.type,provider:t.universalProvider,async setup(){const l=await this.getProvider().catch(()=>null);l&&(i||(i=this.onConnect.bind(this),l.on("connect",i)),a||(a=this.onSessionDelete.bind(this),l.on("session_delete",a)))},async connect({...l}={}){try{const d=R.getCaipNetworks(),f=await this.getProvider();if(!f)throw new Bi;o||(o=this.onDisplayUri,f.on("display_uri",o));const h=await this.isChainsStale();f.session&&h&&await f.disconnect();const g=V.state.universalProviderConfigOverride;if(!f.session||h){const _=li.createNamespaces(d,g);await f.connect({optionalNamespaces:_,..."pairingTopic"in l?{pairingTopic:l.pairingTopic}:{}}),this.setRequestedChainsIds(d.map(P=>Number(P.id)))}const p=await this.getAccounts(),y=await this.getChainId(),E=f.session?.namespaces?.eip155?.chains,A=E?.some(_=>Number(_.split(":")[1])===y);let w=1;A?w=y:E?.[0]&&(w=Number(E[0].split(":")[1])),o&&(f.removeListener("display_uri",o),o=void 0),i&&(f.removeListener("connect",i),i=void 0),r||(r=this.onAccountsChanged.bind(this),f.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),f.on("chainChanged",s)),c||(c=this.onDisconnect.bind(this),f.on("disconnect",c)),a||(a=this.onSessionDelete.bind(this),f.on("session_delete",a));const C=g?.defaultChain;return f.setDefaultChain(C??`eip155:${w}`),{accounts:p,chainId:w}}catch(d){throw/(user rejected|connection request reset)/i.test(d?.message)?new yt(d):d}},async disconnect(){const l=await this.getProvider();try{await l?.disconnect()}catch(d){if(!/No matching key/i.test(d.message))throw d}finally{s&&(l?.removeListener("chainChanged",s),s=void 0),c&&(l?.removeListener("disconnect",c),c=void 0),i||(i=this.onConnect.bind(this),l?.on("connect",i)),r&&(l?.removeListener("accountsChanged",r),r=void 0),a&&(l?.removeListener("session_delete",a),a=void 0),this.setRequestedChainsIds([])}},async getAccounts(){const l=await this.getProvider();if(!l?.session?.namespaces)return[];const f=l?.session?.namespaces[z.CHAIN.EVM]?.accounts?.map(p=>p.split(":")[2])??[],h=new Set;return f.filter(p=>{const y=p?.toLowerCase();return h.has(y)?!1:(h.add(y),!0)})},async getProvider({chainId:l}={}){n||(n=t.universalProvider,n?.events.setMaxListeners(Number.POSITIVE_INFINITY));const d=G.getActiveNamespace(),f=R.getActiveCaipNetwork()?.id;if(l&&f!==l&&d){const h=G.getStoredActiveCaipNetworkId(),p=(d?R.getCaipNetworks(d):[])?.find(y=>y.id===h);p&&p.chainNamespace===z.CHAIN.EVM&&await this.switchChain?.({chainId:Number(p.id)})}return n},async getChainId(){const l=R.getActiveCaipNetwork(z.CHAIN.EVM)?.id;if(l)return l;const f=(await this.getProvider()).session?.namespaces[z.CHAIN.EVM]?.chains?.[0];return R.getCaipNetworks().find(g=>g.id===f)?.id},async isAuthorized(){try{const[l,d]=await Promise.all([this.getAccounts(),this.getProvider()]);return l.length?await this.isChainsStale()&&d.session?(await d.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:l,chainId:d}){const f=await this.getProvider();if(!f)throw new Bi;const h=R.getCaipNetworks().find(g=>g.id===d);if(!h)throw new Zr(new yl);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:ee(d)}]}),h?.caipNetworkId&&f.setDefaultChain(h?.caipNetworkId),u.emitter.emit("change",{chainId:Number(d)});const g=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...g,d]),{...h,id:h.id}}catch(g){const p=g;if(/(?:user rejected)/iu.test(p.message))throw new yt(p);try{let y;l?.blockExplorerUrls?y=l.blockExplorerUrls:y=h.blockExplorers?.default.url?[h.blockExplorers?.default.url]:[];const E=h.rpcUrls?.chainDefault?.http||[],A={blockExplorerUrls:y,chainId:ee(d),chainName:h.name,iconUrls:l?.iconUrls,nativeCurrency:h.nativeCurrency,rpcUrls:E};await f.request({method:"wallet_addEthereumChain",params:[A]});const w=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...w,d]),{...h,id:h.id}}catch(y){throw new yt(y)}}},onAccountsChanged(l){l.length===0?this.onDisconnect():u.emitter.emit("change",{accounts:l.map(d=>ps(d))})},onChainChanged(l){const d=Number(l);u.emitter.emit("change",{chainId:d})},onConnect(l){this.setRequestedChainsIds(R.getCaipNetworks().map(d=>Number(d.id)))},async onDisconnect(l){this.setRequestedChainsIds([]),u.emitter.emit("disconnect");const d=await this.getProvider();r&&(d.removeListener("accountsChanged",r),r=void 0),s&&(d.removeListener("chainChanged",s),s=void 0),c&&(d.removeListener("disconnect",c),c=void 0),a&&(d.removeListener("session_delete",a),a=void 0),i||(i=this.onConnect.bind(this),d.on("connect",i))},onDisplayUri(l){u.emitter.emit("message",{type:"display_uri",data:l})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return n?.session?.namespaces?n?.session?.namespaces[z.CHAIN.EVM]?.accounts?.map(f=>Number.parseInt(f.split(":")[1]??""))??[]:[]},async getRequestedChainsIds(){const l=await u.storage?.getItem(this.requestedChainsStorageKey)??[];return[...new Set(l)]},async isChainsStale(){if(!e)return!1;const l=u.chains.map(h=>h.id),d=this.getNamespaceChainsIds();if(d.length&&!d.some(h=>l.includes(h)))return!1;const f=await this.getRequestedChainsIds();return!l.every(h=>f.includes(Number(h)))},async setRequestedChainsIds(l){await u.storage?.setItem(this.requestedChainsStorageKey,l)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const bu=Je({pendingTransactions:0}),k_={state:bu,subscribeKey(t,e){return bt(bu,t,e)},increase(t){bu[t]+=1},decrease(t){bu[t]-=1},reset(t){bu[t]=0}};async function cte(t){if(oe.isSafeApp()){const{safe:e}=await kt(async()=>{const{safe:n}=await import("./index-fTTV28Tp.js");return{safe:n}},__vite__mapDeps([52,2,3,4,53,5,1,54,55,56]));if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function ute(t){try{const{baseAccount:e}=await kt(async()=>{const{baseAccount:n}=await import("./index-fTTV28Tp.js");return{baseAccount:n}},__vite__mapDeps([52,2,3,4,53,5,1,54,55,56]));if(e&&!t.some(n=>n.id==="baseAccount"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const lte={enable:!1,pollingInterval:3e4};class mre extends fN{constructor(e){const n=hs.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=z.CHAIN.EVM,this.adapterType=z.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...lte,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===z.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!i?.user)return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>oe.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=Uu(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>oe.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=Uu(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===z.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{const i=e.transports?.[s.id],o=hs.getCaipNetworkId(s);i?n[s.id]=hs.extendWagmiTransports(s,e.projectId,i):n[s.id]=hs.getViemTransport(s,e.projectId,e.customRpcUrls?.[o])}),this.wagmiConfig=Jee({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=kee(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),k_.increase("pendingTransactions")}});const e=k_.subscribeKey("pendingTransactions",n=>{n>=z.LIMITS.PENDING_TRANSACTIONS&&(this.unwatchPendingTransactions?.(),e())})}setupWatchers(){Oee(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===z.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:this.toChecksummedAddress(i)})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:G.getConnectedSocialProvider(),username:G.getConnectedSocialUsername()}:void 0}}))}}),Pee(this.wagmiConfig,{onChange:(e,n)=>{if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e?.chainId&&e?.chainId!==n?.chainId&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const r=e.address!==n?.address,s=e.connector.id!==n.connector?.id,i=n.status!=="connected";(r||s||i)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}})}async addThirdPartyConnectors(){const e=[],{enableCoinbase:n}=V.state||{};if(n!==!1){const s=await ute(this.wagmiConfig.connectors);s&&e.push(s)}const r=await cte(this.wagmiConfig.connectors);r&&e.push(r),await Promise.all(e.map(s=>{const i=this.configureInternalConnector(s);return this.addWagmiConnector(i)}))}addWagmiConnectors(){const e=[];V.state.enableInjected!==!1&&e.push(Cp({shimDisconnect:!0}));const{features:n,remoteFeatures:r,projectId:s,enableAuthLogger:i}=V.state,o=r?.email??n?.email??!0,a=r?.socials??n?.socials,c=Array.isArray(a)&&a?.length>0;(o||c)&&e.push(ate({chains:this.wagmiChains,options:{projectId:s,enableAuthLogger:i}})),e.forEach(u=>{this.configureInternalConnector(u)})}configureInternalConnector(e){const n=this.wagmiConfig._internal.connectors.setup(e);return this.wagmiConfig._internal.connectors.setState(r=>[...r,n]),n}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:this.toChecksummedAddress(e),chainId:n,connector:{id:r.id,name:gn.ConnectorNamesMap[r.id]??r.name,imageId:gn.ConnectorImageIds[r.id],type:gn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===z.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await Tee(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=Uu(this.wagmiConfig),s=this.wagmiChains?.find(a=>a.id===n),i={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chain:s,type:"legacy",parameters:["nonce"]};await See(this.wagmiConfig,i);const o=await Iee(this.wagmiConfig,i);return await xee(this.wagmiConfig,{hash:o,timeout:25e3}),{hash:o}}async writeContract(e){const{caipNetwork:n,...r}=e,s=Number(Fu.caipNetworkIdToNumber(n.caipNetworkId)),i=this.wagmiChains?.find(a=>a.id===s);return{hash:await $ee(this.wagmiConfig,{chain:i,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await Eee(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return yI(e.value,e.decimals)}formatUnits(e){return uo(e.value,e.decimals)}async addWagmiConnector(e){if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");const{enableEIP6963:n}=V.state||{};if(e.type===z.CONNECTOR_ID.INJECTED&&n===!1||e.id===z.CONNECTOR_ID.AUTH||e.id===z.CONNECTOR_ID.WALLET_CONNECT)return;let r;e.id!==z.CONNECTOR_ID.BASE_ACCOUNT&&(r=await e.getProvider().catch(()=>{}));const s=nr.state.connectorImages;this.addConnector({id:e.id,explorerId:gn.ConnectorExplorerIds[e.id],imageUrl:s?.[e.id]??e.icon,name:gn.ConnectorNamesMap[e.id]??e.name,imageId:gn.ConnectorImageIds[e.id],type:gn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===z.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(){Ree(this.wagmiConfig,{onChange:e=>{e.forEach(n=>this.addWagmiConnector(n))}}),this.addWagmiConnectors(),await Promise.all(this.wagmiConfig.connectors.map(e=>this.addWagmiConnector(e))),await this.addThirdPartyConnectors()}async syncConnections(){const e=this.connectors.filter(n=>{const{hasDisconnected:r,hasConnected:s}=Hr.getConnectorStorageInfo(n.id,this.namespace);return!r&&s}).map(n=>this.getWagmiConnector(n.id)).filter(Boolean);await wg(this.wagmiConfig,{connectors:e})}async syncConnection(e){const{id:n,chainId:r}=e,i=Ws(this.wagmiConfig).find(u=>u.connector.id===n),a=await this.getWagmiConnector(n)?.getProvider();if(oe.isSafeApp()&&n===z.CONNECTOR_ID.SAFE&&!i?.accounts.length){const u=this.getWagmiConnector("safe");if(u){const l=await yg(this.wagmiConfig,{connector:u,chainId:Number(r)}),d=await u.getProvider();return{chainId:Number(r),address:this.toChecksummedAddress(l.accounts[0]),provider:d,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}}return{chainId:Number(i?.chainId),address:this.toChecksummedAddress(i?.accounts[0]),provider:a,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}async connectWalletConnect(e){try{const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await yg(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await x_(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}catch(n){throw n instanceof yt?new Fa(n):Fr.isUserRejectedRequestError(n)?new Fa(n):n}}async connect(e){try{const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,u=this.getWagmiConnector(n);if(!u)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&u.id===z.CONNECTOR_ID.EIP6963&&u.setEip6963Wallet?.({provider:s,info:o});const l=this.wagmiConfig.state?.connections?.get(u.uid);if(l){await this.wagmiConfig.storage?.setItem("recentConnectorId",u.id);const h=[...l.accounts].sort((g,p)=>Hr.isLowerCaseMatch(g,r)?-1:Hr.isLowerCaseMatch(p,r)?1:0);return this.wagmiConfig?.setState(g=>({...g,connections:new Map(g.connections).set(u.uid,{accounts:h,chainId:l.chainId,connector:l.connector}),current:u.uid,status:"connected"})),{address:this.toChecksummedAddress(h[0]),chainId:l.chainId,provider:s,type:i,id:n}}const d=await yg(this.wagmiConfig,{connector:u,chainId:a?Number(a):void 0,socialUri:c}),f=s??await u.getProvider();return{address:this.toChecksummedAddress(d.accounts[0]),chainId:d.chainId,provider:f,type:i,id:n}}catch(n){throw n instanceof yt?new Fa(n):Fr.isUserRejectedRequestError(n)?new Fa(n):n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:this.toChecksummedAddress(n)})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await wg(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=G.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{try{const c=Number(e.chainId),u=await Aee(this.wagmiConfig,{address:e.address,chainId:c,token:e.tokens?.[r.caipNetworkId]?.address});G.updateNativeBalanceCache({caipAddress:s,balance:u.formatted,symbol:u.symbol,timestamp:Date.now()}),a({balance:u.formatted,symbol:u.symbol})}catch(c){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",c),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){return this.getWagmiConnector("walletConnect")?.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=Ws(this.wagmiConfig).find(i=>Hr.isLowerCaseMatch(i.connector.id,e.id));return await T_(this.wagmiConfig,{connector:n}),V.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:this.toChecksummedAddress(i)})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=Ws(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await T_(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:this.toChecksummedAddress(s)})),connectorId:r.connector.id}))}}async switchNetwork(e){const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(h=>h.id.toString()===n.id.toString());if(!r)throw new Error("connectionControllerClient:switchNetwork - wagmiChain is undefined");const{name:s,nativeCurrency:i,rpcUrls:o,blockExplorers:a,id:c}=r,u=n.rpcUrls?.chainDefault?.http?.[0]??o.default.http[0]??"",l=a?.default.url??n.blockExplorers?.default?.url??"",d=i??n.nativeCurrency,f=s??n.name;await x_(this.wagmiConfig,{chainId:c,addEthereumChainParameter:{chainName:f,nativeCurrency:d,rpcUrls:[u],blockExplorerUrls:[l]}}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=Ws(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=Ws(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=Ws(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=Ws(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:z.CONNECTOR_ID.AUTH,type:"AUTH",name:z.CONNECTOR_NAMES.AUTH,provider:e,imageId:gn.ConnectorImageIds[z.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){e.on("connect",()=>{const r=Ws(this.wagmiConfig),s=this.getWagmiConnector("walletConnect");if(s&&!r.find(i=>i.connector.id===s.id)){if(R.state.activeChain==="eip155")return;wg(this.wagmiConfig,{connectors:[s]})}});const n=Aw({universalProvider:e});return this.configureInternalConnector(n),this.addConnector(new hN({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}toChecksummedAddress(e){return Mc(e.toLowerCase())}}export{Dt as $,RI as A,Qne as B,yl as C,rr as D,qt as E,Co as F,ie as G,me as H,be as I,Ke as J,ye as K,De as L,Ue as M,mt as N,V as O,Bi as P,PO as Q,de as R,Zr as S,Vne as T,A_ as U,ft as V,lt as W,ut as X,Hd as Y,S_ as Z,jw as _,sre as a,Ute as a$,nt as a0,Px as a1,Je as a2,bt as a3,vt as a4,ju as a5,Rt as a6,ke as a7,$u as a8,gte as a9,Ir as aA,Iy as aB,K as aC,Al as aD,bn as aE,Hy as aF,f2 as aG,vf as aH,wh as aI,zt as aJ,Mh as aK,Qt as aL,Y8 as aM,nne as aN,Th as aO,Jy as aP,Is as aQ,Lh as aR,Et as aS,gi as aT,Hc as aU,Fh as aV,sR as aW,kne as aX,rp as aY,nb as aZ,Bte as a_,lm as aa,nr as ab,Se as ac,pte as ad,Yne as ae,lr as af,vb as ag,zS as ah,Yh as ai,ra as aj,Fr as ak,Gne as al,tre as am,Ln as an,$I as ao,bN as ap,dy as aq,Dc as ar,Sr as as,ws as at,xs as au,Ht as av,Yk as aw,w4 as ax,ve as ay,Kg as az,qi as b,Y7 as b0,ite as b1,cre as b2,are as b3,hre as b4,lre as b5,ure as b6,gre as b7,dre as b8,ote as b9,vu as bA,gg as bB,Lf as bC,Hr as bD,Iu as bE,hs as bF,ID as bG,K7 as bH,mre as bI,ire as bJ,Uu as bK,bte as bL,Fu as bM,ei as bN,Ee as bO,pre as ba,fre as bb,J4 as bc,Cu as bd,Gn as be,_t as bf,Ar as bg,LI as bh,SU as bi,IU as bj,rE as bk,to as bl,Jt as bm,Vte as bn,Ki as bo,cr as bp,yn as bq,yS as br,eo as bs,dt as bt,L1 as bu,Rk as bv,By as bw,Fc as bx,ar as by,pa as bz,ere as c,ore as d,rre as e,yt as f,ps as g,Cp as h,ef as i,AQ as j,z as k,R as l,at as m,ee as n,$n as o,Wt as p,oe as q,nre as r,Kne as s,Te as t,X as u,tee as v,Eb as w,Xne as x,Lu as y,G as z};
