const Me=typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function t3(i,e){return e.forEach((function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach((function(t){if(t!=="default"&&!(t in i)){var n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return r[t]}})}}))})),Object.freeze(i)}const Yr=Symbol("doneWritingPromise"),Hc=Symbol("doneWritingResolve"),zc=Symbol("doneWritingReject"),Ai=Symbol("readingIndex");class nt extends Array{constructor(){super(),Object.setPrototypeOf(this,nt.prototype),this[Yr]=new Promise(((e,r)=>{this[Hc]=e,this[zc]=r})),this[Yr].catch((()=>{}))}}function Ee(i){return i&&i.getReader&&Array.isArray(i)}function Ci(i){if(!Ee(i)){const e=i.getWriter(),r=e.releaseLock;return e.releaseLock=()=>{e.closed.catch((function(){})),r.call(e)},e}this.stream=i}function Ze(i){if(Ee(i))return"array";if(Me.ReadableStream&&Me.ReadableStream.prototype.isPrototypeOf(i))return"web";if(i&&!(Me.ReadableStream&&i instanceof Me.ReadableStream)&&typeof i._read=="function"&&typeof i._readableState=="object")throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!i||!i.getReader)&&"web-like"}function Zn(i){return Uint8Array.prototype.isPrototypeOf(i)}function Gc(i){if(i.length===1)return i[0];let e=0;for(let n=0;n<i.length;n++){if(!Zn(i[n]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=i[n].length}const r=new Uint8Array(e);let t=0;return i.forEach((function(n){r.set(n,t),t+=n.length})),r}nt.prototype.getReader=function(){return this[Ai]===void 0&&(this[Ai]=0),{read:async()=>(await this[Yr],this[Ai]===this.length?{value:void 0,done:!0}:{value:this[this[Ai]++],done:!1})}},nt.prototype.readToEnd=async function(i){await this[Yr];const e=i(this.slice(this[Ai]));return this.length=0,e},nt.prototype.clone=function(){const i=new nt;return i[Yr]=this[Yr].then((()=>{i.push(...this)})),i},Ci.prototype.write=async function(i){this.stream.push(i)},Ci.prototype.close=async function(){this.stream[Hc]()},Ci.prototype.abort=async function(i){return this.stream[zc](i),i},Ci.prototype.releaseLock=function(){},typeof Me.process=="object"&&Me.process.versions;const so=new WeakSet,ce=Symbol("externalBuffer");function wt(i){if(this.stream=i,i[ce]&&(this[ce]=i[ce].slice()),Ee(i)){const r=i.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(Ze(i)){const r=i.getReader();return this._read=r.read.bind(r),this._releaseLock=()=>{r.closed.catch((function(){})),r.releaseLock()},void(this._cancel=r.cancel.bind(r))}let e=!1;this._read=async()=>e||so.has(i)?{value:void 0,done:!0}:(e=!0,{value:i,done:!1}),this._releaseLock=()=>{if(e)try{so.add(i)}catch{}}}function xa(i){return Ze(i)?i:new ReadableStream({start(e){e.enqueue(i),e.close()}})}function jc(i){if(Ze(i))return i;const e=new nt;return(async()=>{const r=et(e);await r.write(i),await r.close()})(),e}function Oe(i){return i.some((e=>Ze(e)&&!Ee(e)))?(function(e){e=e.map(xa);const r=qc((async function(s){await Promise.all(n.map((a=>Zs(a,s))))}));let t=Promise.resolve();const n=e.map(((s,a)=>_t(s,((o,c)=>(t=t.then((()=>pr(o,r.writable,{preventClose:a!==e.length-1}))),t)))));return r.readable})(i):i.some((e=>Ee(e)))?(function(e){const r=new nt;let t=Promise.resolve();return e.forEach(((n,s)=>(t=t.then((()=>pr(n,r,{preventClose:s!==e.length-1}))),t))),r})(i):typeof i[0]=="string"?i.join(""):Gc(i)}async function pr(i,e,{preventClose:r=!1,preventAbort:t=!1,preventCancel:n=!1}={}){if(Ze(i)&&!Ee(i)){i=xa(i);try{if(i[ce]){const o=et(e);for(let c=0;c<i[ce].length;c++)await o.ready,await o.write(i[ce][c]);o.releaseLock()}await i.pipeTo(e,{preventClose:r,preventAbort:t,preventCancel:n})}catch{}return}const s=Vt(i=jc(i)),a=et(e);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){r||await a.close();break}await a.write(c)}}catch(o){t||await a.abort(o)}finally{s.releaseLock(),a.releaseLock()}}function Vc(i,e){const r=new TransformStream(e);return pr(i,r.writable),r.readable}function qc(i){let e,r,t,n=!1,s=!1;return{readable:new ReadableStream({start(a){t=a},pull(){e?e():n=!0},async cancel(a){s=!0,i&&await i(a),r&&r(a)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(s)throw Error("Stream is cancelled");t.enqueue(a),n?n=!1:(await new Promise(((o,c)=>{e=o,r=c})),e=null,r=null)},close:t.close.bind(t),abort:t.error.bind(t)})}}function we(i,e=()=>{},r=()=>{}){if(Ee(i)){const s=new nt;return(async()=>{const a=et(s);try{const o=await ke(i),c=e(o),u=r();let f;f=c!==void 0&&u!==void 0?Oe([c,u]):c!==void 0?c:u,await a.write(f),await a.close()}catch(o){await a.abort(o)}})(),s}if(Ze(i))return Vc(i,{async transform(s,a){try{const o=await e(s);o!==void 0&&a.enqueue(o)}catch(o){a.error(o)}},async flush(s){try{const a=await r();a!==void 0&&s.enqueue(a)}catch(a){s.error(a)}}});const t=e(i),n=r();return t!==void 0&&n!==void 0?Oe([t,n]):t!==void 0?t:n}function _t(i,e){if(Ze(i)&&!Ee(i)){let t;const n=new TransformStream({start(o){t=o}}),s=pr(i,n.writable),a=qc((async function(o){t.error(o),await s,await new Promise(setTimeout)}));return e(n.readable,a.writable),a.readable}i=jc(i);const r=new nt;return e(i,r),r}function Jn(i,e){let r;const t=_t(i,((n,s)=>{const a=Vt(n);a.remainder=()=>(a.releaseLock(),pr(n,s),t),r=e(a)}));return r}function Qr(i){if(Ee(i))return i.clone();if(Ze(i)){const e=(function(r){if(Ee(r))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(Ze(r)){const t=xa(r).tee();return t[0][ce]=t[1][ce]=r[ce],t}return[xe(r),xe(r)]})(i);return _c(i,e[0]),e[1]}return xe(i)}function Ni(i){return Ee(i)?Qr(i):Ze(i)?new ReadableStream({start(e){const r=_t(i,(async(t,n)=>{const s=Vt(t),a=et(n);try{for(;;){await a.ready;const{done:o,value:c}=await s.read();if(o){try{e.close()}catch{}return void await a.close()}try{e.enqueue(c)}catch{}await a.write(c)}}catch(o){e.error(o),await a.abort(o)}}));_c(i,r)}}):xe(i)}function _c(i,e){Object.entries(Object.getOwnPropertyDescriptors(i.constructor.prototype)).forEach((([r,t])=>{r!=="constructor"&&(t.value?t.value=t.value.bind(e):t.get=t.get.bind(e),Object.defineProperty(i,r,t))}))}function xe(i,e=0,r=1/0){if(Ee(i))throw Error("Not implemented");if(Ze(i)){if(e>=0&&r>=0){let t=0;return Vc(i,{transform(n,s){t<r?(t+n.length>=e&&s.enqueue(xe(n,Math.max(e-t,0),r-t)),t+=n.length):s.terminate()}})}if(e<0&&(r<0||r===1/0)){let t=[];return we(i,(n=>{n.length>=-e?t=[n]:t.push(n)}),(()=>xe(Oe(t),e,r)))}if(e===0&&r<0){let t;return we(i,(n=>{const s=t?Oe([t,n]):n;if(s.length>=-r)return t=xe(s,r),xe(s,e,r);t=s}))}return console.warn(`stream.slice(input, ${e}, ${r}) not implemented efficiently.`),Yt((async()=>xe(await ke(i),e,r)))}return i[ce]&&(i=Oe(i[ce].concat([i]))),Zn(i)?i.subarray(e,r===1/0?i.length:r):i.slice(e,r)}async function ke(i,e=Oe){return Ee(i)?i.readToEnd(e):Ze(i)?Vt(i).readToEnd(e):i}async function Zs(i,e){if(Ze(i)){if(i.cancel){const r=await i.cancel(e);return await new Promise(setTimeout),r}if(i.destroy)return i.destroy(e),await new Promise(setTimeout),e}}function Yt(i){const e=new nt;return(async()=>{const r=et(e);try{await r.write(await i()),await r.close()}catch(t){await r.abort(t)}})(),e}function Vt(i){return new wt(i)}function et(i){return new Ci(i)}wt.prototype.read=async function(){return this[ce]&&this[ce].length?{done:!1,value:this[ce].shift()}:this._read()},wt.prototype.releaseLock=function(){this[ce]&&(this.stream[ce]=this[ce]),this._releaseLock()},wt.prototype.cancel=function(i){return this._cancel(i)},wt.prototype.readLine=async function(){let i,e=[];for(;!i;){let{done:r,value:t}=await this.read();if(t+="",r)return e.length?Oe(e):void 0;const n=t.indexOf(`
`)+1;n&&(i=Oe(e.concat(t.substr(0,n))),e=[]),n!==t.length&&e.push(t.substr(n))}return this.unshift(...e),i},wt.prototype.readByte=async function(){const{done:i,value:e}=await this.read();if(i)return;const r=e[0];return this.unshift(xe(e,1)),r},wt.prototype.readBytes=async function(i){const e=[];let r=0;for(;;){const{done:t,value:n}=await this.read();if(t)return e.length?Oe(e):void 0;if(e.push(n),r+=n.length,r>=i){const s=Oe(e);return this.unshift(xe(s,i)),xe(s,0,i)}}},wt.prototype.peekBytes=async function(i){const e=await this.readBytes(i);return this.unshift(e),e},wt.prototype.unshift=function(...i){this[ce]||(this[ce]=[]),i.length===1&&Zn(i[0])&&this[ce].length&&i[0].length&&this[ce][0].byteOffset>=i[0].length?this[ce][0]=new Uint8Array(this[ce][0].buffer,this[ce][0].byteOffset-i[0].length,this[ce][0].byteLength+i[0].length):this[ce].unshift(...i.filter((e=>e&&e.length)))},wt.prototype.readToEnd=async function(i=Oe){const e=[];for(;;){const{done:r,value:t}=await this.read();if(r)break;e.push(t)}return i(e)};const wi=Symbol("byValue");var l={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(i,e){if(typeof e=="number"&&(e=this.read(i,e)),i[e]!==void 0)return i[e];throw Error("Invalid enum value.")},read:function(i,e){if(i[wi]||(i[wi]=[],Object.entries(i).forEach((([r,t])=>{i[wi][t]=r}))),i[wi][e]!==void 0)return i[wi][e];throw Error("Invalid enum value.")}},G={preferredHashAlgorithm:l.hash.sha512,preferredSymmetricAlgorithm:l.symmetric.aes256,preferredCompressionAlgorithm:l.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:l.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:l.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([l.symmetric.aes128,l.symmetric.aes192,l.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd]),rejectMessageHashAlgorithms:new Set([l.hash.md5,l.hash.ripemd,l.hash.sha1]),rejectPublicKeyAlgorithms:new Set([l.publicKey.elgamal,l.publicKey.dsa]),rejectCurves:new Set([l.curve.secp256k1])};const ao=(()=>{try{return!1}catch{}return!1})(),d={isString:function(i){return typeof i=="string"||i instanceof String},nodeRequire:()=>{},isArray:function(i){return i instanceof Array},isUint8Array:Zn,isStream:Ze,getNobleCurve:async(i,e)=>{if(!G.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then((function(){return Yh}));switch(i){case l.publicKey.ecdh:case l.publicKey.ecdsa:{const t=r.get(e);if(!t)throw Error("Unsupported curve");return t}case l.publicKey.x448:return r.get("x448");case l.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(i){let e=0;for(let r=0;r<i.length;r++)e+=256**r*i[i.length-1-r];return e},writeNumber:function(i,e){const r=new Uint8Array(e);for(let t=0;t<e;t++)r[t]=i>>8*(e-t-1)&255;return r},readDate:function(i){const e=d.readNumber(i);return new Date(1e3*e)},writeDate:function(i){const e=Math.floor(i.getTime()/1e3);return d.writeNumber(e,4)},normalizeDate:function(i=Date.now()){return i===null||i===1/0?i:new Date(1e3*Math.floor(+i/1e3))},readMPI:function(i){const e=(i[0]<<8|i[1])+7>>>3;return d.readExactSubarray(i,2,2+e)},readExactSubarray:function(i,e,r){if(i.length<r-e)throw Error("Input array too short");return i.subarray(e,r)},leftPad(i,e){if(i.length>e)throw Error("Input array too long");const r=new Uint8Array(e),t=e-i.length;return r.set(i,t),r},uint8ArrayToMPI:function(i){const e=d.uint8ArrayBitLength(i);if(e===0)throw Error("Zero MPI");const r=i.subarray(i.length-Math.ceil(e/8)),t=new Uint8Array([(65280&e)>>8,255&e]);return d.concatUint8Array([t,r])},uint8ArrayBitLength:function(i){let e;for(e=0;e<i.length&&i[e]===0;e++);if(e===i.length)return 0;const r=i.subarray(e);return 8*(r.length-1)+d.nbits(r[0])},hexToUint8Array:function(i){const e=new Uint8Array(i.length>>1);for(let r=0;r<i.length>>1;r++)e[r]=parseInt(i.substr(r<<1,2),16);return e},uint8ArrayToHex:function(i){const e="0123456789abcdef";let r="";return i.forEach((t=>{r+=e[t>>4]+e[15&t]})),r},stringToUint8Array:function(i){return we(i,(e=>{if(!d.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}))},uint8ArrayToString:function(i){const e=[],t=(i=new Uint8Array(i)).length;for(let n=0;n<t;n+=16384)e.push(String.fromCharCode.apply(String,i.subarray(n,n+16384<t?n+16384:t)));return e.join("")},encodeUTF8:function(i){const e=new TextEncoder("utf-8");function r(t,n=!1){return e.encode(t,{stream:!n})}return we(i,r,(()=>r("",!0)))},decodeUTF8:function(i){const e=new TextDecoder("utf-8");function r(t,n=!1){return e.decode(t,{stream:!n})}return we(i,r,(()=>r(new Uint8Array,!0)))},concat:Oe,concatUint8Array:Gc,equalsUint8Array:function(i,e){if(!d.isUint8Array(i)||!d.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(i.length!==e.length)return!1;for(let r=0;r<i.length;r++)if(i[r]!==e[r])return!1;return!0},findLastIndex:function(i,e){for(let r=i.length;r>=0;r--)if(e(i[r],r,i))return r;return-1},writeChecksum:function(i){let e=0;for(let r=0;r<i.length;r++)e=e+i[r]&65535;return d.writeNumber(e,2)},printDebug:function(i){ao&&console.log("[OpenPGP.js debug]",i)},printDebugError:function(i){ao&&console.error("[OpenPGP.js debug]",i)},nbits:function(i){let e=1,r=i>>>16;return r!==0&&(i=r,e+=16),r=i>>8,r!==0&&(i=r,e+=8),r=i>>4,r!==0&&(i=r,e+=4),r=i>>2,r!==0&&(i=r,e+=2),r=i>>1,r!==0&&(i=r,e+=1),e},double:function(i){const e=new Uint8Array(i.length),r=i.length-1;for(let t=0;t<r;t++)e[t]=i[t]<<1^i[t+1]>>7;return e[r]=i[r]<<1^135*(i[0]>>7),e},shiftRight:function(i,e){if(e)for(let r=i.length-1;r>=0;r--)i[r]>>=e,r>0&&(i[r]|=i[r-1]<<8-e);return i},getWebCrypto:function(){const i=Me!==void 0&&Me.crypto&&Me.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!i)throw Error("The WebCrypto API is not available");return i},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(i){return d.isString(i)?/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(i):!1},canonicalizeEOL:function(i){let e=!1;return we(i,(r=>{let t;e&&(r=d.concatUint8Array([new Uint8Array([13]),r])),r[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;const n=[];for(let o=0;t=r.indexOf(10,o)+1,t;o=t)r[t-2]!==13&&n.push(t);if(!n.length)return r;const s=new Uint8Array(r.length+n.length);let a=0;for(let o=0;o<n.length;o++){const c=r.subarray(n[o-1]||0,n[o]);s.set(c,a),a+=c.length,s[a-1]=13,s[a]=10,a++}return s.set(r.subarray(n[n.length-1]||0),a),s}),(()=>e?new Uint8Array([13]):void 0))},nativeEOL:function(i){let e=!1;return we(i,(r=>{let t;(r=e&&r[0]!==10?d.concatUint8Array([new Uint8Array([13]),r]):new Uint8Array(r))[r.length-1]===13?(e=!0,r=r.subarray(0,-1)):e=!1;let n=0;for(let s=0;s!==r.length;s=t){t=r.indexOf(13,s)+1,t||(t=r.length);const a=t-(r[t]===10?1:0);s&&r.copyWithin(n,s,a),n+=a-s}return r.subarray(0,n)}),(()=>e?new Uint8Array([13]):void 0))},removeTrailingSpaces:function(i){return i.split(`
`).map((e=>{let r=e.length-1;for(;r>=0&&(e[r]===" "||e[r]==="	"||e[r]==="\r");r--);return e.substr(0,r+1)})).join(`
`)},wrapError:function(i,e){if(!e)return i instanceof Error?i:Error(i);if(i instanceof Error){try{i.message+=": "+e.message,i.cause=e}catch{}return i}return Error(i+": "+e.message,{cause:e})},constructAllowedPackets:function(i){const e={};return i.forEach((r=>{if(!r.tag)throw Error("Invalid input: expected a packet class");e[r.tag]=r})),e},anyPromise:function(i){return new Promise((async(e,r)=>{let t;await Promise.all(i.map((async n=>{try{e(await n)}catch(s){t=s}}))),r(t)}))},selectUint8Array:function(i,e,r){const t=Math.max(e.length,r.length),n=new Uint8Array(t);let s=0;for(let a=0;a<n.length;a++)n[a]=e[a]&256-i|r[a]&255+i,s+=i&a<e.length|1-i&a<r.length;return n.subarray(0,s)},selectUint8:function(i,e,r){return e&256-i|r&255+i},isAES:function(i){return i===l.symmetric.aes128||i===l.symmetric.aes192||i===l.symmetric.aes256}},ks=d.getNodeBuffer();let Pn,Dn;function Nt(i){let e=new Uint8Array;return we(i,(r=>{e=d.concatUint8Array([e,r]);const t=[],n=Math.floor(e.length/45),s=45*n,a=Pn(e.subarray(0,s));for(let o=0;o<n;o++)t.push(a.substr(60*o,60)),t.push(`
`);return e=e.subarray(s),t.join("")}),(()=>e.length?Pn(e)+`
`:""))}function Yc(i){let e="";return we(i,(r=>{e+=r;let t=0;const n=[" ","	","\r",`
`];for(let o=0;o<n.length;o++){const c=n[o];for(let u=e.indexOf(c);u!==-1;u=e.indexOf(c,u+1))t++}let s=e.length;for(;s>0&&(s-t)%4!=0;s--)n.includes(e[s])&&t--;const a=Dn(e.substr(0,s));return e=e.substr(s),a}),(()=>Dn(e)))}function Ve(i){return Yc(i.replace(/-/g,"+").replace(/_/g,"/"))}function De(i,e){let r=Nt(i).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function r3(i){const e=i.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?l.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?l.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?l.armor.signed:/MESSAGE/.test(e[1])?l.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?l.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?l.armor.privateKey:/SIGNATURE/.test(e[1])?l.armor.signature:void 0}function br(i,e){let r="";return e.showVersion&&(r+="Version: "+e.versionString+`
`),e.showComment&&(r+="Comment: "+e.commentString+`
`),i&&(r+="Comment: "+i+`
`),r+=`
`,r}function kr(i){const e=(function(r){let t=13501623;return we(r,(n=>{const s=i3?Math.floor(n.length/4):0,a=new Uint32Array(n.buffer,n.byteOffset,s);for(let o=0;o<s;o++)t^=a[o],t=Ce[0][t>>24&255]^Ce[1][t>>16&255]^Ce[2][t>>8&255]^Ce[3][255&t];for(let o=4*s;o<n.length;o++)t=t>>8^Ce[0][255&t^n[o]]}),(()=>new Uint8Array([t,t>>8,t>>16])))})(i);return Nt(e)}ks?(Pn=i=>ks.from(i).toString("base64"),Dn=i=>{const e=ks.from(i,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(Pn=i=>btoa(d.uint8ArrayToString(i)),Dn=i=>d.stringToUint8Array(atob(i)));const Ce=[Array(255),Array(255),Array(255),Array(255)];for(let i=0;i<=255;i++){let e=i<<16;for(let r=0;r<8;r++)e=e<<1^(8388608&e?8801531:0);Ce[0][i]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let i=0;i<=255;i++)Ce[1][i]=Ce[0][i]>>8^Ce[0][255&Ce[0][i]];for(let i=0;i<=255;i++)Ce[2][i]=Ce[1][i]>>8^Ce[0][255&Ce[1][i]];for(let i=0;i<=255;i++)Ce[3][i]=Ce[2][i]>>8^Ce[0][255&Ce[2][i]];const i3=(function(){const i=new ArrayBuffer(2);return new DataView(i).setInt16(0,255,!0),new Int16Array(i)[0]===255})();function oo(i){for(let e=0;e<i.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(i[e])||d.printDebugError(Error("Improperly formatted armor header: "+i[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(i[e])||d.printDebugError(Error("Unknown header: "+i[e]))}function n3(i){let e=i;const r=i.lastIndexOf("=");return r>=0&&r!==i.length-1&&(e=i.slice(0,r)),e}function Zt(i){return new Promise((async(e,r)=>{try{const t=/^-----[^-]+-----$/m,n=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,f=[];const h=Yc(_t(i,(async(y,g)=>{const p=Vt(y);try{for(;;){let A=await p.readLine();if(A===void 0)throw Error("Misformed armored text");if(A=d.removeTrailingSpaces(A.replace(/[\r\n]/g,"")),s)if(o)c||s!==l.armor.signed||(t.test(A)?(f=f.join(`\r
`),c=!0,oo(u),u=[],o=!1):f.push(A.replace(/^- /,"")));else if(t.test(A)&&r(Error("Mandatory blank line missing between armor headers and armor data")),n.test(A)){if(oo(u),o=!0,c||s!==l.armor.signed){e({text:f,data:h,headers:a,type:s});break}}else u.push(A);else t.test(A)&&(s=r3(A))}}catch(A){return void r(A)}const w=et(g);try{for(;;){await w.ready;const{done:A,value:m}=await p.read();if(A)throw Error("Misformed armored text");const v=m+"";if(v.indexOf("=")!==-1||v.indexOf("-")!==-1){let E=await p.readToEnd();E.length||(E=""),E=v+E,E=d.removeTrailingSpaces(E.replace(/\r/g,""));const k=E.split(t);if(k.length===1)throw Error("Misformed armored text");const U=n3(k[0].slice(0,-1));await w.write(U);break}await w.write(v)}await w.ready,await w.close()}catch(A){await w.abort(A)}})))}catch(t){r(t)}})).then((async e=>(Ee(e.data)&&(e.data=await ke(e.data)),e)))}function yi(i,e,r,t,n,s=!1,a=G){let o,c;i===l.armor.signed&&(o=e.text,c=e.hash,e=e.data);const u=s&&Ni(e),f=[];switch(i){case l.armor.multipartSection:f.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+t+`-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push("-----END PGP MESSAGE, PART "+r+"/"+t+`-----
`);break;case l.armor.multipartLast:f.push("-----BEGIN PGP MESSAGE, PART "+r+`-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push("-----END PGP MESSAGE, PART "+r+`-----
`);break;case l.armor.signed:f.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),f.push(c?`Hash: ${c}

`:`
`),f.push(o.replace(/^-/gm,"- -")),f.push(`
-----BEGIN PGP SIGNATURE-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push(`-----END PGP SIGNATURE-----
`);break;case l.armor.message:f.push(`-----BEGIN PGP MESSAGE-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push(`-----END PGP MESSAGE-----
`);break;case l.armor.publicKey:f.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case l.armor.privateKey:f.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case l.armor.signature:f.push(`-----BEGIN PGP SIGNATURE-----
`),f.push(br(n,a)),f.push(Nt(e)),u&&f.push("=",kr(u)),f.push(`-----END PGP SIGNATURE-----
`)}return d.concat(f)}const _e=BigInt(0),ti=BigInt(1);function Y(i){const e="0123456789ABCDEF";let r="";return i.forEach((t=>{r+=e[t>>4]+e[15&t]})),BigInt("0x0"+r)}function ee(i,e){const r=i%e;return r<_e?r+e:r}function Ue(i,e,r){if(r===_e)throw Error("Modulo cannot be zero");if(r===ti)return BigInt(0);if(e<_e)throw Error("Unsopported negative exponent");let t=e,n=i;n%=r;let s=BigInt(1);for(;t>_e;){const a=t&ti;t>>=ti,s=a?s*n%r:s,n=n*n%r}return s}function co(i){return i>=_e?i:-i}function ni(i,e){const{gcd:r,x:t}=(function(n,s){let a=BigInt(0),o=BigInt(1),c=BigInt(1),u=BigInt(0),f=co(n),h=co(s);const y=n<_e,g=s<_e;for(;h!==_e;){const p=f/h;let w=a;a=c-p*a,c=w,w=o,o=u-p*o,u=w,w=h,h=f%h,f=w}return{x:y?-c:c,y:g?-u:u,gcd:f}})(i,e);if(r!==ti)throw Error("Inverse does not exist");return ee(t+e,e)}function Js(i){const e=Number(i);if(e>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return e}function s3(i,e){return(i>>BigInt(e)&ti)===_e?0:1}function ri(i){const e=i<_e?BigInt(-1):_e;let r=1,t=i;for(;(t>>=ti)!==e;)r++;return r}function Ye(i){const e=i<_e?BigInt(-1):_e,r=BigInt(8);let t=1,n=i;for(;(n>>=r)!==e;)t++;return t}function be(i,e="be",r){let t=i.toString(16);t.length%2==1&&(t="0"+t);const n=t.length/2,s=new Uint8Array(r||n),a=r?r-n:0;let o=0;for(;o<n;)s[o+a]=parseInt(t.slice(2*o,2*o+2),16),o++;return e!=="be"&&s.reverse(),s}const a3=d.getNodeCrypto();function Pe(i){const e=typeof crypto<"u"?crypto:a3?.webcrypto;if(e?.getRandomValues){const r=new Uint8Array(i);return e.getRandomValues(r)}throw Error("No secure random number generator available.")}function yr(i,e){if(e<i)throw Error("Illegal parameter value: max <= min");const r=e-i;return ee(Y(Pe(Ye(r)+8)),r)+i}const bt=BigInt(1);function uo(i,e,r){const t=BigInt(30),n=bt<<BigInt(i-1),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2];let a=yr(n,n<<bt),o=Js(ee(a,t));do a+=BigInt(s[o]),o=(o+s[o])%s.length,ri(a)>i&&(a=ee(a,n<<bt),a+=n,o=Js(ee(a,t)));while(!Zc(a,e,r));return a}function Zc(i,e,r){return(!e||(function(t,n){let s=t,a=n;for(;a!==_e;){const o=a;a=s%a,s=o}return s})(i-bt,e)===bt)&&!!(function(t){const n=BigInt(0);return o3.every((s=>ee(t,s)!==n))})(i)&&!!(function(t,n=BigInt(2)){return Ue(n,t-bt,t)===bt})(i)&&!!(function(t,n){const s=ri(t);n||(n=Math.max(1,s/48|0));const a=t-bt;let o=0;for(;!s3(a,o);)o++;const c=t>>BigInt(o);for(;n>0;n--){let u,f=Ue(yr(BigInt(2),a),c,t);if(f!==bt&&f!==a){for(u=1;u<o;u++){if(f=ee(f*f,t),f===bt)return!1;if(f===a)break}if(u===o)return!1}}return!0})(i,r)}const o3=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map((i=>BigInt(i))),ho=d.getWebCrypto(),xn=d.getNodeCrypto(),c3=xn&&xn.getHashes();function Jt(i){if(xn&&c3.includes(i))return async function(e){const r=xn.createHash(i);return we(e,(t=>{r.update(t)}),(()=>new Uint8Array(r.digest())))}}function Xt(i,e){const r=async()=>{const{nobleHashes:t}=await Promise.resolve().then((function(){return u5})),n=t.get(i);if(!n)throw Error("Unsupported hash");return n};return async function(t){if(Ee(t)&&(t=await ke(t)),d.isStream(t)){const n=(await r()).create();return we(t,(s=>{n.update(s)}),(()=>n.digest()))}return ho&&e?new Uint8Array(await ho.digest(e,t)):(await r())(t)}}const u3=Jt("md5")||Xt("md5"),h3=Jt("sha1")||Xt("sha1","SHA-1"),f3=Jt("sha224")||Xt("sha224"),l3=Jt("sha256")||Xt("sha256","SHA-256"),y3=Jt("sha384")||Xt("sha384","SHA-384"),g3=Jt("sha512")||Xt("sha512","SHA-512"),p3=Jt("ripemd160")||Xt("ripemd160"),d3=Jt("sha3-256")||Xt("sha3_256"),A3=Jt("sha3-512")||Xt("sha3_512");function xt(i,e){switch(i){case l.hash.md5:return u3(e);case l.hash.sha1:return h3(e);case l.hash.ripemd:return p3(e);case l.hash.sha256:return l3(e);case l.hash.sha384:return y3(e);case l.hash.sha512:return g3(e);case l.hash.sha224:return f3(e);case l.hash.sha3_256:return d3(e);case l.hash.sha3_512:return A3(e);default:throw Error("Unsupported hash function")}}function ve(i){switch(i){case l.hash.md5:return 16;case l.hash.sha1:case l.hash.ripemd:return 20;case l.hash.sha256:return 32;case l.hash.sha384:return 48;case l.hash.sha512:return 64;case l.hash.sha224:return 28;case l.hash.sha3_256:return 32;case l.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const kt=[];function Jc(i,e){const r=i.length;if(r>e-11)throw Error("Message too long");const t=(function(s){const a=new Uint8Array(s);let o=0;for(;o<s;){const c=Pe(s-o);for(let u=0;u<c.length;u++)c[u]!==0&&(a[o++]=c[u])}return a})(e-r-3),n=new Uint8Array(e);return n[1]=2,n.set(t,2),n.set(i,e-r),n}function Xc(i,e){let r=2,t=1;for(let o=r;o<i.length;o++)t&=i[o]!==0,r+=t;const n=r-2,s=i.subarray(r+1),a=i[0]===0&i[1]===2&n>=8&!t;if(e)return d.selectUint8Array(a,s,e);if(a)return s;throw Error("Decryption error")}function Wc(i,e,r){let t;if(e.length!==ve(i))throw Error("Invalid hash length");const n=new Uint8Array(kt[i].length);for(t=0;t<kt[i].length;t++)n[t]=kt[i][t];const s=n.length+e.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(n,r-s),o.set(e,r-e.length),o}kt[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],kt[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],kt[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],kt[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],kt[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],kt[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],kt[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const si=d.getWebCrypto(),Rr=d.getNodeCrypto(),dr=BigInt(1);async function w3(i,e,r,t,n,s,a,o,c){if(ve(i)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(e&&!d.isStream(e)){if(d.getWebCrypto())try{return await(async function(u,f,h,y,g,p,w,A){const m=await Xs(h,y,g,p,w,A),v={name:"RSASSA-PKCS1-v1_5",hash:{name:u}},E=await si.importKey("jwk",m,v,!1,["sign"]);return new Uint8Array(await si.sign("RSASSA-PKCS1-v1_5",E,f))})(l.read(l.webHash,i),e,r,t,n,s,a,o)}catch(u){d.printDebugError(u)}else if(d.getNodeCrypto())return(async function(u,f,h,y,g,p,w,A){const m=Rr.createSign(l.read(l.hash,u));m.write(f),m.end();const v=await Xs(h,y,g,p,w,A);return new Uint8Array(m.sign({key:v,format:"jwk",type:"pkcs1"}))})(i,e,r,t,n,s,a,o)}return(async function(u,f,h,y){f=Y(f);const g=Y(Wc(u,y,Ye(f)));return h=Y(h),be(Ue(g,h,f),"be",Ye(f))})(i,r,n,c)}async function m3(i,e,r,t,n,s){if(e&&!d.isStream(e)){if(d.getWebCrypto())try{return await(async function(a,o,c,u,f){const h=Ws(u,f),y=await si.importKey("jwk",h,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return si.verify("RSASSA-PKCS1-v1_5",y,c,o)})(l.read(l.webHash,i),e,r,t,n)}catch(a){d.printDebugError(a)}else if(d.getNodeCrypto())return(async function(a,o,c,u,f){const h=Ws(u,f),y={key:h,format:"jwk",type:"pkcs1"},g=Rr.createVerify(l.read(l.hash,a));g.write(o),g.end();try{return g.verify(y,c)}catch{return!1}})(i,e,r,t,n)}return(async function(a,o,c,u,f){if(c=Y(c),o=Y(o),u=Y(u),o>=c)throw Error("Signature size cannot exceed modulus size");const h=be(Ue(o,u,c),"be",Ye(c)),y=Wc(a,f,Ye(c));return d.equalsUint8Array(h,y)})(i,r,t,n,s)}async function b3(i,e,r){return d.getNodeCrypto()?(async function(t,n,s){const a=Ws(n,s),o={key:a,format:"jwk",type:"pkcs1",padding:Rr.constants.RSA_PKCS1_PADDING};return new Uint8Array(Rr.publicEncrypt(o,t))})(i,e,r):(async function(t,n,s){if(n=Y(n),t=Y(Jc(t,Ye(n))),s=Y(s),t>=n)throw Error("Message size cannot exceed modulus size");return be(Ue(t,s,n),"be",Ye(n))})(i,e,r)}async function k3(i,e,r,t,n,s,a,o){if(d.getNodeCrypto()&&!o)try{return await(async function(c,u,f,h,y,g,p){const w=await Xs(u,f,h,y,g,p),A={key:w,format:"jwk",type:"pkcs1",padding:Rr.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Rr.privateDecrypt(A,c))}catch{throw Error("Decryption error")}})(i,e,r,t,n,s,a)}catch(c){d.printDebugError(c)}return(async function(c,u,f,h,y,g,p,w){if(c=Y(c),u=Y(u),f=Y(f),h=Y(h),y=Y(y),g=Y(g),p=Y(p),c>=u)throw Error("Data too large.");const A=ee(h,g-dr),m=ee(h,y-dr),v=yr(BigInt(2),u),E=Ue(ni(v,u),f,u);c=ee(c*E,u);const k=Ue(c,m,y),U=Ue(c,A,g);let P=ee(p*(U-k),g)*y+k;return P=ee(P*v,u),Xc(be(P,"be",Ye(u)),w)})(i,e,r,t,n,s,a,o)}async function Xs(i,e,r,t,n,s){const a=Y(t),o=Y(n),c=Y(r);let u=ee(c,o-dr),f=ee(c,a-dr);return f=be(f),u=be(u),{kty:"RSA",n:De(i),e:De(e),d:De(r),p:De(n),q:De(t),dp:De(u),dq:De(f),qi:De(s),ext:!0}}function Ws(i,e){return{kty:"RSA",n:De(i),e:De(e),ext:!0}}function fo(i,e){return{n:Ve(i.n),e:be(e),d:Ve(i.d),p:Ve(i.q),q:Ve(i.p),u:Ve(i.qi)}}const cr=BigInt(1),E3={"2a8648ce3d030107":l.curve.nistP256,"2b81040022":l.curve.nistP384,"2b81040023":l.curve.nistP521,"2b8104000a":l.curve.secp256k1,"2b06010401da470f01":l.curve.ed25519Legacy,"2b060104019755010501":l.curve.curve25519Legacy,"2b2403030208010107":l.curve.brainpoolP256r1,"2b240303020801010b":l.curve.brainpoolP384r1,"2b240303020801010d":l.curve.brainpoolP512r1};class Gt{constructor(e){if(e instanceof Gt)this.oid=e.oid;else if(d.isArray(e)||d.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.oid=e.subarray(1,1+r),1+this.oid.length}throw Error("Invalid oid")}write(){return d.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return d.uint8ArrayToHex(this.oid)}getName(){const e=E3[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function $c(i){let e,r=0;const t=i[0];return t<192?([r]=i,e=1):t<255?(r=(i[0]-192<<8)+i[1]+192,e=2):t===255&&(r=d.readNumber(i.subarray(1,5)),e=5),{len:r,offset:e}}function Xn(i){return i<192?new Uint8Array([i]):i>191&&i<8384?new Uint8Array([192+(i-192>>8),i-192&255]):d.concatUint8Array([new Uint8Array([255]),d.writeNumber(i,4)])}function v3(i){if(i<0||i>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+i])}function Qn(i){return new Uint8Array([192|i])}function lo(i,e){return d.concatUint8Array([Qn(i),Xn(e)])}function wn(i){return[l.packet.literalData,l.packet.compressedData,l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData].includes(i)}async function B3(i,e,r){let t,n;try{const s=await i.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await i.readByte();let o,c,u=-1,f=-1;f=0,64&a&&(f=1),f?u=63&a:(u=(63&a)>>2,c=3&a);const h=wn(u);let y,g=null;if(e&&h){if(e==="array"){const p=new nt;t=et(p),g=p}else{const p=new TransformStream;t=et(p.writable),g=p.readable}n=r({tag:u,packet:g})}else g=[];do{if(f){const p=await i.readByte();if(y=!1,p<192)o=p;else if(p>=192&&p<224)o=(p-192<<8)+await i.readByte()+192;else if(p>223&&p<255){if(o=1<<(31&p),y=!0,!h)throw new TypeError("This packet type does not support partial lengths.")}else o=await i.readByte()<<24|await i.readByte()<<16|await i.readByte()<<8|await i.readByte()}else switch(c){case 0:o=await i.readByte();break;case 1:o=await i.readByte()<<8|await i.readByte();break;case 2:o=await i.readByte()<<24|await i.readByte()<<16|await i.readByte()<<8|await i.readByte();break;default:o=1/0}if(o>0){let p=0;for(;;){t&&await t.ready;const{done:w,value:A}=await i.read();if(w){if(o===1/0)break;throw Error("Unexpected end of packet")}const m=o===1/0?A:A.subarray(0,o-p);if(t?await t.write(m):g.push(m),p+=A.length,p>=o){i.unshift(A.subarray(o-p+A.length));break}}}}while(y);t?(await t.ready,await t.close()):(g=d.concatUint8Array(g),await r({tag:u,packet:g}))}catch(s){if(t)return await t.abort(s),!0;throw s}finally{t&&await n}}class ne extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ne),this.name="UnsupportedError"}}class mn extends ne{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ne),this.name="UnknownPacketError"}}class Es extends ne{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,ne),this.name="MalformedPacketError"}}class $s{constructor(e,r){this.tag=e,this.rawContent=r}write(){return this.rawContent}}async function Qa(i){switch(i){case l.publicKey.ed25519:try{const e=d.getWebCrypto(),r=await e.generateKey("Ed25519",!0,["sign","verify"]).catch((s=>{if(s.name==="OperationError"){const a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s})),t=await e.exportKey("jwk",r.privateKey),n=await e.exportKey("jwk",r.publicKey);return{A:new Uint8Array(Ve(n.x)),seed:Ve(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;const{default:r}=await Promise.resolve().then((function(){return Hr})),t=Pe(Wn(i)),{publicKey:n}=r.sign.keyPair.fromSeed(t);return{A:n,seed:t}}case l.publicKey.ed448:{const e=await d.getNobleCurve(l.publicKey.ed448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,seed:r}}default:throw Error("Unsupported EdDSA algorithm")}}async function Ra(i,e,r,t,n,s){if(ve(e)<ve($n(i)))throw Error("Hash algorithm too weak for EdDSA.");switch(i){case l.publicKey.ed25519:try{const a=d.getWebCrypto(),o=e1(i,t,n),c=await a.importKey("jwk",o,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await a.sign("Ed25519",c,s))}}catch(a){if(a.name!=="NotSupportedError")throw a;const{default:o}=await Promise.resolve().then((function(){return Hr})),c=d.concatUint8Array([n,t]);return{RS:o.sign.detached(s,c)}}case l.publicKey.ed448:return{RS:(await d.getNobleCurve(l.publicKey.ed448)).sign(s,n)};default:throw Error("Unsupported EdDSA algorithm")}}async function Ta(i,e,{RS:r},t,n,s){if(ve(e)<ve($n(i)))throw Error("Hash algorithm too weak for EdDSA.");switch(i){case l.publicKey.ed25519:try{const a=d.getWebCrypto(),o=Fa(i,n),c=await a.importKey("jwk",o,"Ed25519",!1,["verify"]);return await a.verify("Ed25519",c,r,s)}catch(a){if(a.name!=="NotSupportedError")throw a;const{default:o}=await Promise.resolve().then((function(){return Hr}));return o.sign.detached.verify(s,r,n)}case l.publicKey.ed448:return(await d.getNobleCurve(l.publicKey.ed448)).verify(r,s,n);default:throw Error("Unsupported EdDSA algorithm")}}async function Ma(i,e,r){switch(i){case l.publicKey.ed25519:try{const t=d.getWebCrypto(),n=e1(i,e,r),s=Fa(i,e),a=await t.importKey("jwk",n,"Ed25519",!1,["sign"]),o=await t.importKey("jwk",s,"Ed25519",!1,["verify"]),c=Pe(8),u=new Uint8Array(await t.sign("Ed25519",a,c));return await t.verify("Ed25519",o,u,c)}catch(t){if(t.name!=="NotSupportedError")return!1;const{default:n}=await Promise.resolve().then((function(){return Hr})),{publicKey:s}=n.sign.keyPair.fromSeed(r);return d.equalsUint8Array(e,s)}case l.publicKey.ed448:{const t=(await d.getNobleCurve(l.publicKey.ed448)).getPublicKey(r);return d.equalsUint8Array(e,t)}default:return!1}}function Wn(i){switch(i){case l.publicKey.ed25519:return 32;case l.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function $n(i){switch(i){case l.publicKey.ed25519:return l.hash.sha256;case l.publicKey.ed448:return l.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const Fa=(i,e)=>{if(i===l.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:De(e),ext:!0};throw Error("Unsupported EdDSA algorithm")},e1=(i,e,r)=>{if(i===l.publicKey.ed25519){const t=Fa(i,e);return t.d=De(r),t}throw Error("Unsupported EdDSA algorithm")};var I3=Object.freeze({__proto__:null,generate:Qa,getPayloadSize:Wn,getPreferredHashAlgo:$n,sign:Ra,validateParams:Ma,verify:Ta});function t1(i){return i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array"}function ye(i,...e){if(!t1(i))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(i.length))throw Error("Uint8Array expected of length "+e+", got length="+i.length)}function Rn(i,e=!0){if(i.destroyed)throw Error("Hash instance has been destroyed");if(e&&i.finished)throw Error("Hash#digest() has already been called")}function r1(i,e){ye(i);const r=e.outputLen;if(i.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function La(i){return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}function ue(i){return new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4))}function Fe(...i){for(let e=0;e<i.length;e++)i[e].fill(0)}function es(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}const S3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Hi(i){if(typeof i=="string")i=(function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))})(i);else{if(!t1(i))throw Error("Uint8Array expected, got "+typeof i);i=qe(i)}return i}function i1(i,e){return i.buffer===e.buffer&&i.byteOffset<e.byteOffset+e.byteLength&&e.byteOffset<i.byteOffset+i.byteLength}function ea(i,e){if(i1(i,e)&&i.byteOffset<e.byteOffset)throw Error("complex overlap of input and output is not supported")}function n1(i,e){if(i.length!==e.length)return!1;let r=0;for(let t=0;t<i.length;t++)r|=i[t]^e[t];return r===0}const Ji=(i,e)=>{function r(t,...n){if(ye(t),!S3)throw Error("Non little-endian hardware is not yet supported");if(i.nonceLength!==void 0){const u=n[0];if(!u)throw Error("nonce / iv required");i.varSizeNonce?ye(u):ye(u,i.nonceLength)}const s=i.tagLength;s&&n[1]!==void 0&&ye(n[1]);const a=e(t,...n),o=(u,f)=>{if(f!==void 0){if(u!==2)throw Error("cipher output not supported");ye(f)}};let c=!1;return{encrypt(u,f){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,ye(u),o(a.encrypt.length,f),a.encrypt(u,f)},decrypt(u,f){if(ye(u),s&&u.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return o(a.decrypt.length,f),a.decrypt(u,f)}}}return Object.assign(r,i),r};function zi(i,e,r=!0){if(e===void 0)return new Uint8Array(i);if(e.length!==i)throw Error("invalid output length, expected "+i+", got: "+e.length);if(r&&!st(e))throw Error("invalid output, must be aligned");return e}function ta(i,e,r,t){if(typeof i.setBigUint64=="function")return i.setBigUint64(e,r,t);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),o=Number(r&s);i.setUint32(e+0,a,t),i.setUint32(e+4,o,t)}function st(i){return i.byteOffset%4==0}function qe(i){return Uint8Array.from(i)}const Ot=16,Na=new Uint8Array(16),vt=ue(Na),rt=i=>(i>>>0&255)<<24|(i>>>8&255)<<16|(i>>>16&255)<<8|i>>>24&255;class s1{constructor(e,r){this.blockLen=Ot,this.outputLen=Ot,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ye(e=Hi(e),16);const t=es(e);let n=t.getUint32(0,!1),s=t.getUint32(4,!1),a=t.getUint32(8,!1),o=t.getUint32(12,!1);const c=[];for(let v=0;v<128;v++)c.push({s0:rt(n),s1:rt(s),s2:rt(a),s3:rt(o)}),{s0:n,s1:s,s2:a,s3:o}={s3:(h=a)<<31|(y=o)>>>1,s2:(f=s)<<31|h>>>1,s1:(u=n)<<31|f>>>1,s0:u>>>1^225<<24&-(1&y)};var u,f,h,y;const g=(p=r||1024)>65536?8:p>1024?4:2;var p;if(![1,2,4,8].includes(g))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=g;const w=128/g,A=this.windowSize=2**g,m=[];for(let v=0;v<w;v++)for(let E=0;E<A;E++){let k=0,U=0,Q=0,P=0;for(let I=0;I<g;I++){if(!(E>>>g-I-1&1))continue;const{s0:b,s1:K,s2:B,s3:S}=c[g*v+I];k^=b,U^=K,Q^=B,P^=S}m.push({s0:k,s1:U,s2:Q,s3:P})}this.t=m}_updateBlock(e,r,t,n){e^=this.s0,r^=this.s1,t^=this.s2,n^=this.s3;const{W:s,t:a,windowSize:o}=this;let c=0,u=0,f=0,h=0;const y=(1<<s)-1;let g=0;for(const p of[e,r,t,n])for(let w=0;w<4;w++){const A=p>>>8*w&255;for(let m=8/s-1;m>=0;m--){const v=A>>>s*m&y,{s0:E,s1:k,s2:U,s3:Q}=a[g*o+v];c^=E,u^=k,f^=U,h^=Q,g+=1}}this.s0=c,this.s1=u,this.s2=f,this.s3=h}update(e){Rn(this),ye(e=Hi(e));const r=ue(e),t=Math.floor(e.length/Ot),n=e.length%Ot;for(let s=0;s<t;s++)this._updateBlock(r[4*s+0],r[4*s+1],r[4*s+2],r[4*s+3]);return n&&(Na.set(e.subarray(t*Ot)),this._updateBlock(vt[0],vt[1],vt[2],vt[3]),Fe(vt)),this}destroy(){const{t:e}=this;for(const r of e)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(e){Rn(this),r1(e,this),this.finished=!0;const{s0:r,s1:t,s2:n,s3:s}=this,a=ue(e);return a[0]=r,a[1]=t,a[2]=n,a[3]=s,e}digest(){const e=new Uint8Array(Ot);return this.digestInto(e),this.destroy(),e}}class K3 extends s1{constructor(e,r){ye(e=Hi(e));const t=(function(n){n.reverse();const s=1&n[15];let a=0;for(let o=0;o<n.length;o++){const c=n[o];n[o]=c>>>1|a,a=(1&c)<<7}return n[0]^=225&-s,n})(qe(e));super(t,r),Fe(t)}update(e){e=Hi(e),Rn(this);const r=ue(e),t=e.length%Ot,n=Math.floor(e.length/Ot);for(let s=0;s<n;s++)this._updateBlock(rt(r[4*s+3]),rt(r[4*s+2]),rt(r[4*s+1]),rt(r[4*s+0]));return t&&(Na.set(e.subarray(n*Ot)),this._updateBlock(rt(vt[3]),rt(vt[2]),rt(vt[1]),rt(vt[0])),Fe(vt)),this}digestInto(e){Rn(this),r1(e,this),this.finished=!0;const{s0:r,s1:t,s2:n,s3:s}=this,a=ue(e);return a[0]=r,a[1]=t,a[2]=n,a[3]=s,e.reverse()}}function a1(i){const e=(t,n)=>i(n,t.length).update(Hi(t)).digest(),r=i(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(t,n)=>i(t,n),e}const yo=a1(((i,e)=>new s1(i,e)));a1(((i,e)=>new K3(i,e)));const We=16,nn=new Uint8Array(We);function Oa(i){return i<<1^283&-(i>>7)}function Zr(i,e){let r=0;for(;e>0;e>>=1)r^=i&-(1&e),i=Oa(i);return r}const ra=(()=>{const i=new Uint8Array(256);for(let r=0,t=1;r<256;r++,t^=Oa(t))i[r]=t;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let t=i[255-r];t|=t<<8,e[i[r]]=255&(t^t>>4^t>>5^t>>6^t>>7^99)}return Fe(i),e})(),C3=ra.map(((i,e)=>ra.indexOf(e))),vs=i=>i<<8|i>>>24,go=i=>i<<24&4278190080|i<<8&16711680|i>>>8&65280|i>>>24&255;function o1(i,e){if(i.length!==256)throw Error("Wrong sbox length");const r=new Uint32Array(256).map(((u,f)=>e(i[f]))),t=r.map(vs),n=t.map(vs),s=n.map(vs),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let u=0;u<256;u++)for(let f=0;f<256;f++){const h=256*u+f;a[h]=r[u]^t[f],o[h]=n[u]^s[f],c[h]=i[u]<<8|i[f]}return{sbox:i,sbox2:c,T0:r,T1:t,T2:n,T3:s,T01:a,T23:o}}const Ha=o1(ra,(i=>Zr(i,3)<<24|i<<16|i<<8|Zr(i,2))),c1=o1(C3,(i=>Zr(i,11)<<24|Zr(i,13)<<16|Zr(i,9)<<8|Zr(i,14))),U3=(()=>{const i=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=Oa(r))i[e]=r;return i})();function Lr(i){ye(i);const e=i.length;if(![16,24,32].includes(e))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+e);const{sbox2:r}=Ha,t=[];st(i)||t.push(i=qe(i));const n=ue(i),s=n.length,a=u=>It(r,u,u,u,u),o=new Uint32Array(e+28);o.set(n);for(let u=s;u<o.length;u++){let f=o[u-1];u%s==0?f=a((c=f)<<24|c>>>8)^U3[u/s-1]:s>6&&u%s==4&&(f=a(f)),o[u]=o[u-s]^f}var c;return Fe(...t),o}function za(i){const e=Lr(i),r=e.slice(),t=e.length,{sbox2:n}=Ha,{T0:s,T1:a,T2:o,T3:c}=c1;for(let u=0;u<t;u+=4)for(let f=0;f<4;f++)r[u+f]=e[t-u-4+f];Fe(e);for(let u=4;u<t-4;u++){const f=r[u],h=It(n,f,f,f,f);r[u]=s[255&h]^a[h>>>8&255]^o[h>>>16&255]^c[h>>>24]}return r}function hr(i,e,r,t,n,s){return i[r<<8&65280|t>>>8&255]^e[n>>>8&65280|s>>>24&255]}function It(i,e,r,t,n){return i[255&e|65280&r]|i[t>>>16&255|n>>>16&65280]<<16}function pt(i,e,r,t,n){const{sbox2:s,T01:a,T23:o}=Ha;let c=0;e^=i[c++],r^=i[c++],t^=i[c++],n^=i[c++];const u=i.length/4-2;for(let f=0;f<u;f++){const h=i[c++]^hr(a,o,e,r,t,n),y=i[c++]^hr(a,o,r,t,n,e),g=i[c++]^hr(a,o,t,n,e,r),p=i[c++]^hr(a,o,n,e,r,t);e=h,r=y,t=g,n=p}return{s0:i[c++]^It(s,e,r,t,n),s1:i[c++]^It(s,r,t,n,e),s2:i[c++]^It(s,t,n,e,r),s3:i[c++]^It(s,n,e,r,t)}}function ts(i,e,r,t,n){const{sbox2:s,T01:a,T23:o}=c1;let c=0;e^=i[c++],r^=i[c++],t^=i[c++],n^=i[c++];const u=i.length/4-2;for(let f=0;f<u;f++){const h=i[c++]^hr(a,o,e,n,t,r),y=i[c++]^hr(a,o,r,e,n,t),g=i[c++]^hr(a,o,t,r,e,n),p=i[c++]^hr(a,o,n,t,r,e);e=h,r=y,t=g,n=p}return{s0:i[c++]^It(s,e,n,t,r),s1:i[c++]^It(s,r,e,n,t),s2:i[c++]^It(s,t,r,e,n),s3:i[c++]^It(s,n,t,r,e)}}function u1(i,e,r,t){ye(e,We),ye(r);const n=r.length;ea(r,t=zi(n,t));const s=e,a=ue(s);let{s0:o,s1:c,s2:u,s3:f}=pt(i,a[0],a[1],a[2],a[3]);const h=ue(r),y=ue(t);for(let p=0;p+4<=h.length;p+=4){y[p+0]=h[p+0]^o,y[p+1]=h[p+1]^c,y[p+2]=h[p+2]^u,y[p+3]=h[p+3]^f;let w=1;for(let A=s.length-1;A>=0;A--)w=w+(255&s[A])|0,s[A]=255&w,w>>>=8;({s0:o,s1:c,s2:u,s3:f}=pt(i,a[0],a[1],a[2],a[3]))}const g=We*Math.floor(h.length/4);if(g<n){const p=new Uint32Array([o,c,u,f]),w=La(p);for(let A=g,m=0;A<n;A++,m++)t[A]=r[A]^w[m];Fe(p)}return t}function Ui(i,e,r,t,n){ye(r,We),ye(t),n=zi(t.length,n);const s=r,a=ue(s),o=es(s),c=ue(t),u=ue(n),f=e?0:12,h=t.length;let y=o.getUint32(f,e),{s0:g,s1:p,s2:w,s3:A}=pt(i,a[0],a[1],a[2],a[3]);for(let v=0;v+4<=c.length;v+=4)u[v+0]=c[v+0]^g,u[v+1]=c[v+1]^p,u[v+2]=c[v+2]^w,u[v+3]=c[v+3]^A,y=y+1>>>0,o.setUint32(f,y,e),{s0:g,s1:p,s2:w,s3:A}=pt(i,a[0],a[1],a[2],a[3]);const m=We*Math.floor(c.length/4);if(m<h){const v=new Uint32Array([g,p,w,A]),E=La(v);for(let k=m,U=0;k<h;k++,U++)n[k]=t[k]^E[U];Fe(v)}return n}const P3=Ji({blockSize:16,nonceLength:16},(function(i,e){function r(t,n){if(ye(t),n!==void 0&&(ye(n),!st(n)))throw Error("unaligned destination");const s=Lr(i),a=qe(e),o=[s,a];st(t)||o.push(t=qe(t));const c=u1(s,a,t,n);return Fe(...o),c}return{encrypt:(t,n)=>r(t,n),decrypt:(t,n)=>r(t,n)}})),ia=Ji({blockSize:16,nonceLength:16},(function(i,e,r={}){const t=!r.disablePadding;return{encrypt(n,s){const a=Lr(i),{b:o,o:c,out:u}=(function(v,E,k){ye(v);let U=v.length;const Q=U%We;if(!E&&Q!==0)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");st(v)||(v=qe(v));const P=ue(v);if(E){let I=We-Q;I||(I=We),U+=I}return ea(v,k=zi(U,k)),{b:P,o:ue(k),out:k}})(n,t,s);let f=e;const h=[a];st(f)||h.push(f=qe(f));const y=ue(f);let g=y[0],p=y[1],w=y[2],A=y[3],m=0;for(;m+4<=o.length;)g^=o[m+0],p^=o[m+1],w^=o[m+2],A^=o[m+3],{s0:g,s1:p,s2:w,s3:A}=pt(a,g,p,w,A),c[m++]=g,c[m++]=p,c[m++]=w,c[m++]=A;if(t){const v=(function(E){const k=new Uint8Array(16),U=ue(k);k.set(E);const Q=We-E.length;for(let P=We-Q;P<We;P++)k[P]=Q;return U})(n.subarray(4*m));g^=v[0],p^=v[1],w^=v[2],A^=v[3],{s0:g,s1:p,s2:w,s3:A}=pt(a,g,p,w,A),c[m++]=g,c[m++]=p,c[m++]=w,c[m++]=A}return Fe(...h),u},decrypt(n,s){(function(A){if(ye(A),A.length%We!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")})(n);const a=za(i);let o=e;const c=[a];st(o)||c.push(o=qe(o));const u=ue(o);s=zi(n.length,s),st(n)||c.push(n=qe(n)),ea(n,s);const f=ue(n),h=ue(s);let y=u[0],g=u[1],p=u[2],w=u[3];for(let A=0;A+4<=f.length;){const m=y,v=g,E=p,k=w;y=f[A+0],g=f[A+1],p=f[A+2],w=f[A+3];const{s0:U,s1:Q,s2:P,s3:I}=ts(a,y,g,p,w);h[A++]=U^m,h[A++]=Q^v,h[A++]=P^E,h[A++]=I^k}return Fe(...c),(function(A,m){if(!m)return A;const v=A.length;if(!v)throw Error("aes/pcks5: empty ciphertext not allowed");const E=A[v-1];if(E<=0||E>16)throw Error("aes/pcks5: wrong padding");const k=A.subarray(0,-E);for(let U=0;U<E;U++)if(A[v-U-1]!==E)throw Error("aes/pcks5: wrong padding");return k})(s,t)}}})),h1=Ji({blockSize:16,nonceLength:16},(function(i,e){function r(t,n,s){ye(t);const a=t.length;if(i1(t,s=zi(a,s)))throw Error("overlapping src and dst not supported.");const o=Lr(i);let c=e;const u=[o];st(c)||u.push(c=qe(c)),st(t)||u.push(t=qe(t));const f=ue(t),h=ue(s),y=n?h:f,g=ue(c);let p=g[0],w=g[1],A=g[2],m=g[3];for(let E=0;E+4<=f.length;){const{s0:k,s1:U,s2:Q,s3:P}=pt(o,p,w,A,m);h[E+0]=f[E+0]^k,h[E+1]=f[E+1]^U,h[E+2]=f[E+2]^Q,h[E+3]=f[E+3]^P,p=y[E++],w=y[E++],A=y[E++],m=y[E++]}const v=We*Math.floor(f.length/4);if(v<a){({s0:p,s1:w,s2:A,s3:m}=pt(o,p,w,A,m));const E=La(new Uint32Array([p,w,A,m]));for(let k=v,U=0;k<a;k++,U++)s[k]=t[k]^E[U];Fe(E)}return Fe(...u),s}return{encrypt:(t,n)=>r(t,!0,n),decrypt:(t,n)=>r(t,!1,n)}}));function D3(i,e,r,t,n){const s=n?n.length:0,a=i.create(r,t.length+s);n&&a.update(n);const o=(function(u,f,h){const y=new Uint8Array(16),g=es(y);return ta(g,0,BigInt(f),h),ta(g,8,BigInt(u),h),y})(8*t.length,8*s,e);a.update(t),a.update(o);const c=a.digest();return Fe(o),c}const sn=Ji({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},(function(i,e,r){if(e.length<8)throw Error("aes/gcm: invalid nonce length");function t(s,a,o){const c=D3(yo,!1,s,o,r);for(let u=0;u<a.length;u++)c[u]^=a[u];return c}function n(){const s=Lr(i),a=nn.slice(),o=nn.slice();if(Ui(s,!1,o,o,a),e.length===12)o.set(e);else{const c=nn.slice();ta(es(c),8,BigInt(8*e.length),!1);const u=yo.create(a).update(e).update(c);u.digestInto(o),u.destroy()}return{xk:s,authKey:a,counter:o,tagMask:Ui(s,!1,o,nn)}}return{encrypt(s){const{xk:a,authKey:o,counter:c,tagMask:u}=n(),f=new Uint8Array(s.length+16),h=[a,o,c,u];st(s)||h.push(s=qe(s)),Ui(a,!1,c,s,f.subarray(0,s.length));const y=t(o,u,f.subarray(0,f.length-16));return h.push(y),f.set(y,s.length),Fe(...h),f},decrypt(s){const{xk:a,authKey:o,counter:c,tagMask:u}=n(),f=[a,o,u,c];st(s)||f.push(s=qe(s));const h=s.subarray(0,-16),y=s.subarray(-16),g=t(o,u,h);if(f.push(g),!n1(g,y))throw Error("aes/gcm: invalid ghash tag");const p=Ui(a,!1,c,h);return Fe(...f),p}}}));function f1(i){return i instanceof Uint32Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint32Array"}function l1(i,e){if(ye(e,16),!f1(i))throw Error("_encryptBlock accepts result of expandKeyLE");const r=ue(e);let{s0:t,s1:n,s2:s,s3:a}=pt(i,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=n,r[2]=s,r[3]=a,e}function y1(i,e){if(ye(e,16),!f1(i))throw Error("_decryptBlock accepts result of expandKeyLE");const r=ue(e);let{s0:t,s1:n,s2:s,s3:a}=ts(i,r[0],r[1],r[2],r[3]);return r[0]=t,r[1]=n,r[2]=s,r[3]=a,e}const po={encrypt(i,e){if(e.length>=2**32)throw Error("plaintext should be less than 4gb");const r=Lr(i);if(e.length===16)l1(r,e);else{const t=ue(e);let n=t[0],s=t[1];for(let a=0,o=1;a<6;a++)for(let c=2;c<t.length;c+=2,o++){const{s0:u,s1:f,s2:h,s3:y}=pt(r,n,s,t[c],t[c+1]);n=u,s=f^go(o),t[c]=h,t[c+1]=y}t[0]=n,t[1]=s}r.fill(0)},decrypt(i,e){if(e.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=za(i),t=e.length/8-1;if(t===1)y1(r,e);else{const n=ue(e);let s=n[0],a=n[1];for(let o=0,c=6*t;o<6;o++)for(let u=2*t;u>=1;u-=2,c--){a^=go(c);const{s0:f,s1:h,s2:y,s3:g}=ts(r,s,a,n[u],n[u+1]);s=f,a=h,n[u]=y,n[u+1]=g}n[0]=s,n[1]=a}r.fill(0)}},Ao=new Uint8Array(8).fill(166),g1=Ji({blockSize:8},(i=>({encrypt(e){if(!e.length||e.length%8!=0)throw Error("invalid plaintext length");if(e.length===8)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=(function(...t){let n=0;for(let a=0;a<t.length;a++){const o=t[a];ye(o),n+=o.length}const s=new Uint8Array(n);for(let a=0,o=0;a<t.length;a++){const c=t[a];s.set(c,o),o+=c.length}return s})(Ao,e);return po.encrypt(i,r),r},decrypt(e){if(e.length%8!=0||e.length<24)throw Error("invalid ciphertext length");const r=qe(e);if(po.decrypt(i,r),!n1(r.subarray(0,8),Ao))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}))),wo={expandKeyLE:Lr,expandKeyDecLE:za,encrypt:pt,decrypt:ts,encryptBlock:l1,decryptBlock:y1,ctrCounter:u1,ctr32:Ui};async function p1(i){switch(i){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:throw Error("Not a legacy cipher");case l.symmetric.cast5:case l.symmetric.blowfish:case l.symmetric.twofish:case l.symmetric.tripledes:{const{legacyCiphers:e}=await Promise.resolve().then((function(){return A5})),r=l.read(l.symmetric,i),t=e.get(r);if(!t)throw Error("Unsupported cipher algorithm");return t}default:throw Error("Unsupported cipher algorithm")}}function x3(i){switch(i){case l.symmetric.aes128:case l.symmetric.aes192:case l.symmetric.aes256:case l.symmetric.twofish:return 16;case l.symmetric.blowfish:case l.symmetric.cast5:case l.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function Q3(i){switch(i){case l.symmetric.aes128:case l.symmetric.blowfish:case l.symmetric.cast5:return 16;case l.symmetric.aes192:case l.symmetric.tripledes:return 24;case l.symmetric.aes256:case l.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function oe(i){return{keySize:Q3(i),blockSize:x3(i)}}const ii=d.getWebCrypto();async function na(i,e,r){const{keySize:t}=oe(i);if(!d.isAES(i)||e.length!==t)throw Error("Unexpected algorithm or key size");try{const n=await ii.importKey("raw",e,{name:"AES-KW"},!1,["wrapKey"]),s=await ii.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),a=await ii.wrapKey("raw",s,n,{name:"AES-KW"});return new Uint8Array(a)}catch(n){if(n.name!=="NotSupportedError"&&(e.length!==24||n.name!=="OperationError"))throw n;d.printDebugError("Browser did not support operation: "+n.message)}return g1(e).encrypt(r)}async function sa(i,e,r){const{keySize:t}=oe(i);if(!d.isAES(i)||e.length!==t)throw Error("Unexpected algorithm or key size");let n;try{n=await ii.importKey("raw",e,{name:"AES-KW"},!1,["unwrapKey"])}catch(s){if(s.name!=="NotSupportedError"&&(e.length!==24||s.name!=="OperationError"))throw s;return d.printDebugError("Browser did not support operation: "+s.message),g1(e).decrypt(r)}try{const s=await ii.unwrapKey("raw",r,n,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await ii.exportKey("raw",s))}catch(s){throw s.name==="OperationError"?Error("Key Data Integrity failed"):s}}async function Ar(i,e,r,t,n){const s=d.getWebCrypto(),a=l.read(l.webHash,i);if(!a)throw Error("Hash algo not supported with HKDF");const o=await s.importKey("raw",e,"HKDF",!1,["deriveBits"]),c=await s.deriveBits({name:"HKDF",hash:a,salt:r,info:t},o,8*n);return new Uint8Array(c)}const Tn={x25519:d.encodeUTF8("OpenPGP X25519"),x448:d.encodeUTF8("OpenPGP X448")};async function Ga(i){switch(i){case l.publicKey.x25519:try{const e=d.getWebCrypto(),r=await e.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch((s=>{if(s.name==="OperationError"){const a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw s})),t=await e.exportKey("jwk",r.privateKey),n=await e.exportKey("jwk",r.publicKey);if(t.x!==n.x){const s=Error("Unexpected mismatching public point");throw s.name="NotSupportedError",s}return{A:new Uint8Array(Ve(n.x)),k:Ve(t.d)}}catch(e){if(e.name!=="NotSupportedError")throw e;const{default:r}=await Promise.resolve().then((function(){return Hr})),{secretKey:t,publicKey:n}=r.box.keyPair();return{A:n,k:t}}case l.publicKey.x448:{const e=await d.getNobleCurve(l.publicKey.x448),{secretKey:r,publicKey:t}=e.keygen();return{A:t,k:r}}default:throw Error("Unsupported ECDH algorithm")}}async function ja(i,e,r){switch(i){case l.publicKey.x25519:try{const{ephemeralPublicKey:t,sharedSecret:n}=await is(i,e),s=await ns(i,t,e,r);return d.equalsUint8Array(n,s)}catch{return!1}case l.publicKey.x448:{const t=(await d.getNobleCurve(l.publicKey.x448)).getPublicKey(r);return d.equalsUint8Array(e,t)}default:return!1}}async function d1(i,e,r){const{ephemeralPublicKey:t,sharedSecret:n}=await is(i,r),s=d.concatUint8Array([t,r,n]);switch(i){case l.publicKey.x25519:{const a=l.symmetric.aes128,{keySize:o}=oe(a),c=await Ar(l.hash.sha256,s,new Uint8Array,Tn.x25519,o);return{ephemeralPublicKey:t,wrappedKey:await na(a,c,e)}}case l.publicKey.x448:{const a=l.symmetric.aes256,{keySize:o}=oe(l.symmetric.aes256),c=await Ar(l.hash.sha512,s,new Uint8Array,Tn.x448,o);return{ephemeralPublicKey:t,wrappedKey:await na(a,c,e)}}default:throw Error("Unsupported ECDH algorithm")}}async function A1(i,e,r,t,n){const s=await ns(i,e,t,n),a=d.concatUint8Array([e,t,s]);switch(i){case l.publicKey.x25519:{const o=l.symmetric.aes128,{keySize:c}=oe(o);return sa(o,await Ar(l.hash.sha256,a,new Uint8Array,Tn.x25519,c),r)}case l.publicKey.x448:{const o=l.symmetric.aes256,{keySize:c}=oe(l.symmetric.aes256);return sa(o,await Ar(l.hash.sha512,a,new Uint8Array,Tn.x448,c),r)}default:throw Error("Unsupported ECDH algorithm")}}function rs(i){switch(i){case l.publicKey.x25519:return 32;case l.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function is(i,e){switch(i){case l.publicKey.x25519:try{const r=d.getWebCrypto(),t=await r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch((c=>{if(c.name==="OperationError"){const u=Error("Unexpected key generation issue");throw u.name="NotSupportedError",u}throw c})),n=await r.exportKey("jwk",t.publicKey);if((await r.exportKey("jwk",t.privateKey)).x!==n.x){const c=Error("Unexpected mismatching public point");throw c.name="NotSupportedError",c}const s=aa(i,e),a=await r.importKey("jwk",s,"X25519",!1,[]),o=await r.deriveBits({name:"X25519",public:a},t.privateKey,8*rs(i));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(Ve(n.x))}}catch(r){if(r.name!=="NotSupportedError")throw r;const{default:t}=await Promise.resolve().then((function(){return Hr})),{secretKey:n,publicKey:s}=t.box.keyPair(),a=t.scalarMult(n,e);return Mn(a),{ephemeralPublicKey:s,sharedSecret:a}}case l.publicKey.x448:{const r=await d.getNobleCurve(l.publicKey.x448),{secretKey:t,publicKey:n}=r.keygen(),s=r.getSharedSecret(t,e);return Mn(s),{ephemeralPublicKey:n,sharedSecret:s}}default:throw Error("Unsupported ECDH algorithm")}}async function ns(i,e,r,t){switch(i){case l.publicKey.x25519:try{const n=d.getWebCrypto(),s=(function(f,h,y){if(f===l.publicKey.x25519){const g=aa(f,h);return g.d=De(y),g}throw Error("Unsupported ECDH algorithm")})(i,r,t),a=aa(i,e),o=await n.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=await n.importKey("jwk",a,"X25519",!1,[]),u=await n.deriveBits({name:"X25519",public:c},o,8*rs(i));return new Uint8Array(u)}catch(n){if(n.name!=="NotSupportedError")throw n;const{default:s}=await Promise.resolve().then((function(){return Hr})),a=s.scalarMult(t,e);return Mn(a),a}case l.publicKey.x448:{const n=(await d.getNobleCurve(l.publicKey.x448)).getSharedSecret(t,e);return Mn(n),n}default:throw Error("Unsupported ECDH algorithm")}}function Mn(i){let e=0;for(let r=0;r<i.length;r++)e|=i[r];if(e===0)throw Error("Unexpected low order point")}function aa(i,e){if(i===l.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:De(e),ext:!0};throw Error("Unsupported ECDH algorithm")}var R3=Object.freeze({__proto__:null,decrypt:A1,encrypt:d1,generate:Ga,generateEphemeralEncryptionMaterial:is,getPayloadSize:rs,recomputeSharedSecret:ns,validateParams:ja});const Bs=d.getWebCrypto(),Fn=d.getNodeCrypto(),Ct={[l.curve.nistP256]:"P-256",[l.curve.nistP384]:"P-384",[l.curve.nistP521]:"P-521"},Rt=Fn?Fn.getCurves():[],Et=Fn?{[l.curve.secp256k1]:Rt.includes("secp256k1")?"secp256k1":void 0,[l.curve.nistP256]:Rt.includes("prime256v1")?"prime256v1":void 0,[l.curve.nistP384]:Rt.includes("secp384r1")?"secp384r1":void 0,[l.curve.nistP521]:Rt.includes("secp521r1")?"secp521r1":void 0,[l.curve.ed25519Legacy]:Rt.includes("ED25519")?"ED25519":void 0,[l.curve.curve25519Legacy]:Rt.includes("X25519")?"X25519":void 0,[l.curve.brainpoolP256r1]:Rt.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[l.curve.brainpoolP384r1]:Rt.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[l.curve.brainpoolP512r1]:Rt.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},w1={[l.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Et[l.curve.nistP256],web:Ct[l.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[l.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:Et[l.curve.nistP384],web:Ct[l.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[l.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:Et[l.curve.nistP521],web:Ct[l.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[l.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Et[l.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:l.publicKey.eddsaLegacy,hash:l.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:l.publicKey.ecdh,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[l.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:l.publicKey.ecdsa,hash:l.hash.sha256,cipher:l.symmetric.aes128,node:Et[l.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[l.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:l.publicKey.ecdsa,hash:l.hash.sha384,cipher:l.symmetric.aes192,node:Et[l.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[l.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:l.publicKey.ecdsa,hash:l.hash.sha512,cipher:l.symmetric.aes256,node:Et[l.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class ot{constructor(e){try{this.name=e instanceof Gt?e.getName():l.write(l.curve,e)}catch{throw new ne("Unknown curve")}const r=w1[this.name];this.keyType=r.keyType,this.oid=r.oid,this.hash=r.hash,this.cipher=r.cipher,this.node=r.node,this.web=r.web,this.payloadSize=r.payloadSize,this.sharedSize=r.sharedSize,this.wireFormatLeadingByte=r.wireFormatLeadingByte,this.web&&d.getWebCrypto()?this.type="web":this.node&&d.getNodeCrypto()?this.type="node":this.name===l.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===l.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await(async function(e,r){const t=await Bs.generateKey({name:"ECDSA",namedCurve:Ct[e]},!0,["sign","verify"]),n=await Bs.exportKey("jwk",t.privateKey);return{publicKey:k1(await Bs.exportKey("jwk",t.publicKey),r),privateKey:Ve(n.d)}})(this.name,this.wireFormatLeadingByte)}catch(e){return d.printDebugError("Browser did not support generating ec key "+e.message),mo(this.name)}case"node":return(async function(e){const r=Fn.createECDH(Et[e]);return await r.generateKeys(),{publicKey:new Uint8Array(r.getPublicKey()),privateKey:new Uint8Array(r.getPrivateKey())}})(this.name);case"curve25519Legacy":{const{k:e,A:r}=await Ga(l.publicKey.x25519),t=e.slice().reverse();return t[0]=127&t[0]|64,t[31]&=248,{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:t}}case"ed25519Legacy":{const{seed:e,A:r}=await Qa(l.publicKey.ed25519);return{publicKey:d.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),r]),privateKey:e}}default:return mo(this.name)}}}async function bn(i){const e=new ot(i),{oid:r,hash:t,cipher:n}=e,s=await e.genKeyPair();return{oid:r,Q:s.publicKey,secret:d.leftPad(s.privateKey,e.payloadSize),hash:t,cipher:n}}function m1(i){return w1[i.getName()].hash}async function b1(i,e,r,t){const n={[l.curve.nistP256]:!0,[l.curve.nistP384]:!0,[l.curve.nistP521]:!0,[l.curve.secp256k1]:!0,[l.curve.curve25519Legacy]:i===l.publicKey.ecdh,[l.curve.brainpoolP256r1]:!0,[l.curve.brainpoolP384r1]:!0,[l.curve.brainpoolP512r1]:!0},s=e.getName();if(!n[s])return!1;if(s===l.curve.curve25519Legacy){const o=t.slice().reverse();return!(r.length<1||r[0]!==64)&&ja(l.publicKey.x25519,r.subarray(1),o)}const a=(await d.getNobleCurve(l.publicKey.ecdsa,s)).getPublicKey(t,!1);return!!d.equalsUint8Array(a,r)}function Tr(i,e){const{payloadSize:r,wireFormatLeadingByte:t,name:n}=i,s=n===l.curve.curve25519Legacy||n===l.curve.ed25519Legacy?r:2*r;if(e[0]!==t||e.length!==s+1)throw Error("Invalid point encoding")}async function mo(i){const e=await d.getNobleCurve(l.publicKey.ecdsa,i),{secretKey:r}=e.keygen();return{publicKey:e.getPublicKey(r,!1),privateKey:r}}function k1(i,e){const r=Ve(i.x),t=Ve(i.y),n=new Uint8Array(r.length+t.length+1);return n[0]=e,n.set(r,1),n.set(t,r.length+1),n}function ss(i,e,r){const t=i,n=r.slice(1,t+1),s=r.slice(t+1,2*t+1);return{kty:"EC",crv:e,x:De(n),y:De(s),ext:!0}}function E1(i,e,r,t){const n=ss(i,e,r);return n.d=De(t),n}const Ln=d.getWebCrypto(),v1=d.getNodeCrypto();async function oa(i,e,r,t,n,s){const a=new ot(i);if(Tr(a,t),r&&!d.isStream(r)){const c={publicKey:t,privateKey:n};switch(a.type){case"web":try{return await(async function(u,f,h,y){const g=u.payloadSize,p=E1(u.payloadSize,Ct[u.name],y.publicKey,y.privateKey),w=await Ln.importKey("jwk",p,{name:"ECDSA",namedCurve:Ct[u.name],hash:{name:l.read(l.webHash,u.hash)}},!1,["sign"]),A=new Uint8Array(await Ln.sign({name:"ECDSA",namedCurve:Ct[u.name],hash:{name:l.read(l.webHash,f)}},w,h));return{r:A.slice(0,g),s:A.slice(g,g<<1)}})(a,e,r,c)}catch(u){if(a.name!=="nistP521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;d.printDebugError("Browser did not support signing: "+u.message)}break;case"node":return(async function(u,f,h,y){const g=d.nodeRequire("eckey-utils"),p=d.getNodeBuffer(),{privateKey:w}=g.generateDer({curveName:Et[u.name],privateKey:p.from(y)}),A=v1.createSign(l.read(l.hash,f));A.write(h),A.end();const m=new Uint8Array(A.sign({key:w,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),v=u.payloadSize;return{r:m.subarray(0,v),s:m.subarray(v,v<<1)}})(a,e,r,n)}}const o=(await d.getNobleCurve(l.publicKey.ecdsa,a.name)).sign(s,n,{lowS:!1});return{r:be(o.r,"be",a.payloadSize),s:be(o.s,"be",a.payloadSize)}}async function ca(i,e,r,t,n,s){const a=new ot(i);Tr(a,n);const o=async()=>s[0]===0&&bo(a,r,s.subarray(1),n);if(t&&!d.isStream(t))switch(a.type){case"web":try{return await(async function(u,f,{r:h,s:y},g,p){const w=ss(u.payloadSize,Ct[u.name],p),A=await Ln.importKey("jwk",w,{name:"ECDSA",namedCurve:Ct[u.name],hash:{name:l.read(l.webHash,u.hash)}},!1,["verify"]),m=d.concatUint8Array([h,y]).buffer;return Ln.verify({name:"ECDSA",namedCurve:Ct[u.name],hash:{name:l.read(l.webHash,f)}},A,m,g)})(a,e,r,t,n)||o()}catch(c){if(a.name!=="nistP521"&&(c.name==="DataError"||c.name==="OperationError"))throw c;d.printDebugError("Browser did not support verifying: "+c.message)}break;case"node":return await(async function(u,f,{r:h,s:y},g,p){const w=d.nodeRequire("eckey-utils"),A=d.getNodeBuffer(),{publicKey:m}=w.generateDer({curveName:Et[u.name],publicKey:A.from(p)}),v=v1.createVerify(l.read(l.hash,f));v.write(g),v.end();const E=d.concatUint8Array([h,y]);try{return v.verify({key:m,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},E)}catch{return!1}})(a,e,r,t,n)||o()}return await bo(a,r,s,n)||o()}async function bo(i,e,r,t){return(await d.getNobleCurve(l.publicKey.ecdsa,i.name)).verify(d.concatUint8Array([e.r,e.s]),r,t,{lowS:!1})}var T3=Object.freeze({__proto__:null,sign:oa,validateParams:async function(i,e,r){const t=new ot(i);if(t.keyType!==l.publicKey.ecdsa)return!1;switch(t.type){case"web":case"node":{const n=Pe(8),s=l.hash.sha256,a=await xt(s,n);try{const o=await oa(i,s,n,e,r,a);return await ca(i,s,o,n,e,a)}catch{return!1}}default:return b1(l.publicKey.ecdsa,i,e,r)}},verify:ca});async function B1(i,e,r,t,n,s){if(Tr(new ot(i),t),ve(e)<ve(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await Ra(l.publicKey.ed25519,e,0,t.subarray(1),n,s);return{r:a.subarray(0,32),s:a.subarray(32)}}async function I1(i,e,{r,s:t},n,s,a){if(Tr(new ot(i),s),ve(e)<ve(l.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=d.concatUint8Array([r,t]);return Ta(l.publicKey.ed25519,e,{RS:o},0,s.subarray(1),a)}async function S1(i,e,r){return i.getName()===l.curve.ed25519Legacy&&!(e.length<1||e[0]!==64)&&Ma(l.publicKey.ed25519,e.subarray(1),r)}var M3=Object.freeze({__proto__:null,sign:B1,validateParams:S1,verify:I1});function F3(i){const e=i.length;if(e>0){const r=i[e-1];if(r>=1){const t=i.subarray(e-r),n=new Uint8Array(r).fill(r);if(d.equalsUint8Array(t,n))return i.subarray(0,e-r)}}throw Error("Invalid padding")}function K1(i,e,r,t){return d.concatUint8Array([e.write(),new Uint8Array([i]),r.write(),d.stringToUint8Array("Anonymous Sender    "),t])}async function C1(i,e,r,t,n=!1,s=!1){let a;if(n){for(a=0;a<e.length&&e[a]===0;a++);e=e.subarray(a)}if(s){for(a=e.length-1;a>=0&&e[a]===0;a--);e=e.subarray(0,a+1)}return(await xt(i,d.concatUint8Array([new Uint8Array([0,0,0,1]),e,t]))).subarray(0,r)}async function L3(i,e){switch(i.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:t}=await is(l.publicKey.x25519,e.subarray(1));return{publicKey:d.concatUint8Array([new Uint8Array([i.wireFormatLeadingByte]),t]),sharedKey:r}}case"web":if(i.web&&d.getWebCrypto())try{return await(async function(r,t){const n=d.getWebCrypto(),s=ss(r.payloadSize,r.web,t);let a=n.generateKey({name:"ECDH",namedCurve:r.web},!0,["deriveKey","deriveBits"]),o=n.importKey("jwk",s,{name:"ECDH",namedCurve:r.web},!1,[]);[a,o]=await Promise.all([a,o]);let c=n.deriveBits({name:"ECDH",namedCurve:r.web,public:o},a.privateKey,r.sharedSize),u=n.exportKey("jwk",a.publicKey);[c,u]=await Promise.all([c,u]);const f=new Uint8Array(c);return{publicKey:new Uint8Array(k1(u,r.wireFormatLeadingByte)),sharedKey:f}})(i,e)}catch(r){return d.printDebugError(r),Eo(i,e)}break;case"node":return(async function(r,t){const n=d.getNodeCrypto(),s=n.createECDH(r.node);s.generateKeys();const a=new Uint8Array(s.computeSecret(t));return{publicKey:new Uint8Array(s.getPublicKey()),sharedKey:a}})(i,e);default:return Eo(i,e)}}async function U1(i,e,r,t,n){const s=(function(y){const g=8-y.length%8,p=new Uint8Array(y.length+g).fill(g);return p.set(y),p})(r),a=new ot(i);Tr(a,t);const{publicKey:o,sharedKey:c}=await L3(a,t),u=K1(l.publicKey.ecdh,i,e,n),{keySize:f}=oe(e.cipher),h=await C1(e.hash,c,f,u);return{publicKey:o,wrappedKey:await na(e.cipher,h,s)}}async function N3(i,e,r,t){if(t.length!==i.payloadSize){const n=new Uint8Array(i.payloadSize);n.set(t,i.payloadSize-t.length),t=n}switch(i.type){case"curve25519Legacy":{const n=t.slice().reverse();return{secretKey:n,sharedKey:await ns(l.publicKey.x25519,e.subarray(1),r.subarray(1),n)}}case"web":if(i.web&&d.getWebCrypto())try{return await(async function(n,s,a,o){const c=d.getWebCrypto(),u=E1(n.payloadSize,n.web,a,o);let f=c.importKey("jwk",u,{name:"ECDH",namedCurve:n.web},!0,["deriveKey","deriveBits"]);const h=ss(n.payloadSize,n.web,s);let y=c.importKey("jwk",h,{name:"ECDH",namedCurve:n.web},!0,[]);[f,y]=await Promise.all([f,y]);let g=c.deriveBits({name:"ECDH",namedCurve:n.web,public:y},f,n.sharedSize),p=c.exportKey("jwk",f);[g,p]=await Promise.all([g,p]);const w=new Uint8Array(g);return{secretKey:Ve(p.d),sharedKey:w}})(i,e,r,t)}catch(n){return d.printDebugError(n),ko(i,e,t)}break;case"node":return(async function(n,s,a){const o=d.getNodeCrypto(),c=o.createECDH(n.node);c.setPrivateKey(a);const u=new Uint8Array(c.computeSecret(s));return{secretKey:new Uint8Array(c.getPrivateKey()),sharedKey:u}})(i,e,t);default:return ko(i,e,t)}}async function P1(i,e,r,t,n,s,a){const o=new ot(i);Tr(o,n),Tr(o,r);const{sharedKey:c}=await N3(o,r,n,s),u=K1(l.publicKey.ecdh,i,e,a),{keySize:f}=oe(e.cipher);let h;for(let y=0;y<3;y++)try{const g=await C1(e.hash,c,f,u,y===1,y===2);return F3(await sa(e.cipher,g,t))}catch(g){h=g}throw h}async function ko(i,e,r){return{secretKey:r,sharedKey:(await d.getNobleCurve(l.publicKey.ecdh,i.name)).getSharedSecret(r,e).subarray(1)}}async function Eo(i,e){const r=await d.getNobleCurve(l.publicKey.ecdh,i.name),{publicKey:t,privateKey:n}=await i.genKeyPair();return{publicKey:t,sharedKey:r.getSharedSecret(n,e).subarray(1)}}var O3=Object.freeze({__proto__:null,CurveWithOID:ot,ecdh:Object.freeze({__proto__:null,decrypt:P1,encrypt:U1,validateParams:async function(i,e,r){return b1(l.publicKey.ecdh,i,e,r)}}),ecdhX:R3,ecdsa:T3,eddsa:I3,eddsaLegacy:M3,generate:bn,getPreferredHashAlgo:m1});const kn=BigInt(0),Pi=BigInt(1);class D1{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const r=e[0];if(e.length>=1+r)return this.data=e.subarray(1,1+r),1+this.data.length}throw Error("Invalid symmetric key")}write(){return d.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class x1{constructor(e){if(e){const{hash:r,cipher:t}=e;this.hash=r,this.cipher=t}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw new ne("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class as{static fromObject({wrappedKey:e,algorithm:r}){const t=new as;return t.wrappedKey=e,t.algorithm=r,t}read(e){let r=0,t=e[r++];this.algorithm=t%2?e[r++]:null,t-=t%2,this.wrappedKey=d.readExactSubarray(e,r,r+t),r+=t}write(){return d.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function H3(i,e,r,t,n){switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:{const{n:s,e:a}=r;return{c:await b3(t,s,a)}}case l.publicKey.elgamal:{const{p:s,g:a,y:o}=r;return(async function(c,u,f,h){u=Y(u),f=Y(f),h=Y(h);const y=Y(Jc(c,Ye(u))),g=yr(cr,u-cr);return{c1:be(Ue(f,g,u)),c2:be(ee(Ue(h,g,u)*y,u))}})(t,s,a,o)}case l.publicKey.ecdh:{const{oid:s,Q:a,kdfParams:o}=r,{publicKey:c,wrappedKey:u}=await U1(s,o,t,a,n);return{V:c,C:new D1(u)}}case l.publicKey.x25519:case l.publicKey.x448:{if(e&&!d.isAES(e))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:s}=r,{ephemeralPublicKey:a,wrappedKey:o}=await d1(i,t,s);return{ephemeralPublicKey:a,C:as.fromObject({algorithm:e,wrappedKey:o})}}default:return[]}}async function z3(i,e,r,t,n,s){switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:{const{c:a}=t,{n:o,e:c}=e,{d:u,p:f,q:h,u:y}=r;return k3(a,o,c,u,f,h,y,s)}case l.publicKey.elgamal:{const{c1:a,c2:o}=t;return(async function(c,u,f,h,y){return c=Y(c),u=Y(u),f=Y(f),Xc(be(ee(ni(Ue(c,h=Y(h),f),f)*u,f),"be",Ye(f)),y)})(a,o,e.p,r.x,s)}case l.publicKey.ecdh:{const{oid:a,Q:o,kdfParams:c}=e,{d:u}=r,{V:f,C:h}=t;return P1(a,c,f,h.data,o,u,n)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:a}=e,{k:o}=r,{ephemeralPublicKey:c,C:u}=t;if(u.algorithm!==null&&!d.isAES(u.algorithm))throw Error("AES session key expected");return A1(i,c,u.wrappedKey,a,o)}default:throw Error("Unknown public key encryption algorithm.")}}function vo(i,e,r){let t=0;switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const n=d.readMPI(e.subarray(t));t+=n.length+2;const s=d.readMPI(e.subarray(t));t+=s.length+2;const a=d.readMPI(e.subarray(t));t+=a.length+2;const o=d.readMPI(e.subarray(t));return t+=o.length+2,{read:t,privateParams:{d:n,p:s,q:a,u:o}}}case l.publicKey.dsa:case l.publicKey.elgamal:{const n=d.readMPI(e.subarray(t));return t+=n.length+2,{read:t,privateParams:{x:n}}}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const n=Jr(i,r.oid);let s=d.readMPI(e.subarray(t));return t+=s.length+2,s=d.leftPad(s,n),{read:t,privateParams:{d:s}}}case l.publicKey.eddsaLegacy:{const n=Jr(i,r.oid);if(r.oid.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let s=d.readMPI(e.subarray(t));return t+=s.length+2,s=d.leftPad(s,n),{read:t,privateParams:{seed:s}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const n=Jr(i),s=d.readExactSubarray(e,t,t+n);return t+=s.length,{read:t,privateParams:{seed:s}}}case l.publicKey.x25519:case l.publicKey.x448:{const n=Jr(i),s=d.readExactSubarray(e,t,t+n);return t+=s.length,{read:t,privateParams:{k:s}}}default:throw new ne("Unknown public key encryption algorithm.")}}function ai(i,e){const r=new Set([l.publicKey.ed25519,l.publicKey.x25519,l.publicKey.ed448,l.publicKey.x448]),t=Object.keys(e).map((n=>{const s=e[n];return d.isUint8Array(s)?r.has(i)?s:d.uint8ArrayToMPI(s):s.write()}));return d.concatUint8Array(t)}function G3(i,e,r){switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:return(async function(t,n){if(n=BigInt(n),d.getWebCrypto()){const u={name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:be(n),hash:{name:"SHA-1"}},f=await si.generateKey(u,!0,["sign","verify"]);return fo(await si.exportKey("jwk",f.privateKey),n)}if(d.getNodeCrypto()){const u={modulusLength:t,publicExponent:Js(n),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}},f=await new Promise(((h,y)=>{Rr.generateKeyPair("rsa",u,((g,p,w)=>{g?y(g):h(w)}))}));return fo(f,n)}let s,a,o;do a=uo(t-(t>>1),n,40),s=uo(t>>1,n,40),o=s*a;while(ri(o)!==t);const c=(s-dr)*(a-dr);return a<s&&([s,a]=[a,s]),{n:be(o),e:be(n),d:be(ni(n,c)),p:be(s),q:be(a),u:be(ni(s,a))}})(e,65537).then((({n:t,e:n,d:s,p:a,q:o,u:c})=>({privateParams:{d:s,p:a,q:o,u:c},publicParams:{n:t,e:n}})));case l.publicKey.ecdsa:return bn(r).then((({oid:t,Q:n,secret:s})=>({privateParams:{d:s},publicParams:{oid:new Gt(t),Q:n}})));case l.publicKey.eddsaLegacy:return bn(r).then((({oid:t,Q:n,secret:s})=>({privateParams:{seed:s},publicParams:{oid:new Gt(t),Q:n}})));case l.publicKey.ecdh:return bn(r).then((({oid:t,Q:n,secret:s,hash:a,cipher:o})=>({privateParams:{d:s},publicParams:{oid:new Gt(t),Q:n,kdfParams:new x1({hash:a,cipher:o})}})));case l.publicKey.ed25519:case l.publicKey.ed448:return Qa(i).then((({A:t,seed:n})=>({privateParams:{seed:n},publicParams:{A:t}})));case l.publicKey.x25519:case l.publicKey.x448:return Ga(i).then((({A:t,k:n})=>({privateParams:{k:n},publicParams:{A:t}})));case l.publicKey.dsa:case l.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}async function j3(i,e,r){if(!e||!r)throw Error("Missing key parameters");switch(i){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const{n:t,e:n}=e,{d:s,p:a,q:o,u:c}=r;return(async function(u,f,h,y,g,p){if(u=Y(u),(y=Y(y))*(g=Y(g))!==u)return!1;const w=BigInt(2);if(ee(y*(p=Y(p)),g)!==BigInt(1))return!1;f=Y(f),h=Y(h);const A=yr(w,w<<BigInt(Math.floor(ri(u)/3))),m=A*h*f;return!(ee(m,y-dr)!==A||ee(m,g-dr)!==A)})(t,n,s,a,o,c)}case l.publicKey.dsa:{const{p:t,q:n,g:s,y:a}=e,{x:o}=r;return(async function(c,u,f,h,y){if(c=Y(c),u=Y(u),f=Y(f),h=Y(h),f<=Pi||f>=c||ee(c-Pi,u)!==kn||Ue(f,u,c)!==Pi)return!1;const g=BigInt(ri(u));if(g<BigInt(150)||!Zc(u,null,32))return!1;y=Y(y);const p=BigInt(2);return h===Ue(f,u*yr(p<<g-Pi,p<<g)+y,c)})(t,n,s,a,o)}case l.publicKey.elgamal:{const{p:t,g:n,y:s}=e,{x:a}=r;return(async function(o,c,u,f){if(o=Y(o),c=Y(c),u=Y(u),c<=cr||c>=o)return!1;const h=BigInt(ri(o));if(h<BigInt(1023)||Ue(c,o-cr,o)!==cr)return!1;let y=c,g=BigInt(1);const p=BigInt(2),w=p<<BigInt(17);for(;g<w;){if(y=ee(y*c,o),y===cr)return!1;g++}f=Y(f);const A=yr(p<<h-cr,p<<h);return u===Ue(c,(o-cr)*A+f,o)})(t,n,s,a)}case l.publicKey.ecdsa:case l.publicKey.ecdh:{const t=O3[l.read(l.publicKey,i)],{oid:n,Q:s}=e,{d:a}=r;return t.validateParams(n,s,a)}case l.publicKey.eddsaLegacy:{const{Q:t,oid:n}=e,{seed:s}=r;return S1(n,t,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:t}=e,{seed:n}=r;return Ma(i,t,n)}case l.publicKey.x25519:case l.publicKey.x448:{const{A:t}=e,{k:n}=r;return ja(i,t,n)}default:throw Error("Unknown public key algorithm.")}}function ua(i){const{keySize:e}=oe(i);return Pe(e)}function Is(i){try{i.getName()}catch{throw new ne("Unknown curve OID")}}function Jr(i,e){switch(i){case l.publicKey.ecdsa:case l.publicKey.ecdh:case l.publicKey.eddsaLegacy:return new ot(e).payloadSize;case l.publicKey.ed25519:case l.publicKey.ed448:return Wn(i);case l.publicKey.x25519:case l.publicKey.x448:return rs(i);default:throw Error("Unknown elliptic algo")}}const En=d.getWebCrypto(),Gi=d.getNodeCrypto(),Er=Gi?Gi.getCiphers():[],Nn={idea:Er.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Er.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Er.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Er.includes("bf-cfb")?"bf-cfb":void 0,aes128:Er.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Er.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Er.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function Q1(i){const{blockSize:e}=oe(i),r=await Pe(e),t=new Uint8Array([r[r.length-2],r[r.length-1]]);return d.concat([r,t])}async function ji(i,e,r,t,n){const s=l.read(l.symmetric,i);if(d.getNodeCrypto()&&Nn[s])return(function(h,y,g,p){const w=l.read(l.symmetric,h),A=new Gi.createCipheriv(Nn[w],y,p);return we(g,(m=>new Uint8Array(A.update(m))))})(i,e,r,t);if(d.isAES(i))return(async function(h,y,g,p){if(En&&await Bo.isSupported(h)){const w=new Bo(h,y,p);return d.isStream(g)?we(g,(A=>w.encryptChunk(A)),(()=>w.finish())):w.encrypt(g)}if(d.isStream(g)){const w=new R1(!0,h,y,p);return we(g,(A=>w.processChunk(A)),(()=>w.finish()))}return h1(y,p).encrypt(g)})(i,e,r,t);const a=new(await p1(i))(e),o=a.blockSize,c=t.slice();let u=new Uint8Array;const f=h=>{h&&(u=d.concatUint8Array([u,h]));const y=new Uint8Array(u.length);let g,p=0;for(;h?u.length>=o:u.length;){const w=a.encrypt(c);for(g=0;g<o;g++)c[g]=u[g]^w[g],y[p++]=c[g];u=u.subarray(o)}return y.subarray(0,p)};return we(r,f,f)}async function os(i,e,r,t){const n=l.read(l.symmetric,i);if(Gi&&Nn[n])return(function(f,h,y,g){const p=l.read(l.symmetric,f),w=new Gi.createDecipheriv(Nn[p],h,g);return we(y,(A=>new Uint8Array(w.update(A))))})(i,e,r,t);if(d.isAES(i))return(async function(f,h,y,g){if(d.isStream(y)){const p=new R1(!1,f,h,g);return we(y,(w=>p.processChunk(w)),(()=>p.finish()))}return h1(h,g).decrypt(y)})(i,e,r,t);const s=new(await p1(i))(e),a=s.blockSize;let o=t,c=new Uint8Array;const u=f=>{f&&(c=d.concatUint8Array([c,f]));const h=new Uint8Array(c.length);let y,g=0;for(;f?c.length>=a:c.length;){const p=s.encrypt(o);for(o=c.subarray(0,a),y=0;y<a;y++)h[g++]=o[y]^p[y];c=c.subarray(a)}return h.subarray(0,g)};return we(r,u,u)}class Bo{constructor(e,r,t){const{blockSize:n}=oe(e);this.key=r,this.prevBlock=t,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:r}=oe(e);return En.importKey("raw",new Uint8Array(r),"aes-cbc",!1,["encrypt"]).then((()=>!0),(()=>!1))}async _runCBC(e,r){const t="AES-CBC";this.keyRef=this.keyRef||await En.importKey("raw",this.key,t,!1,["encrypt"]);const n=await En.encrypt({name:t,iv:r||this.zeroBlock},this.keyRef,e);return new Uint8Array(n).subarray(0,e.length)}async encryptChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=d.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=d.concatUint8Array([this.prevBlock,a.subarray(0,a.length-this.blockSize)]),c=await this._runCBC(o);return an(c,a),this.prevBlock=c.slice(-this.blockSize),s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,c}let n;if(this.i+=t.length,this.i===this.nextBlock.length){const s=this.nextBlock;n=await this._runCBC(this.prevBlock),an(n,s),this.prevBlock=n.slice(),this.i=0;const a=e.subarray(t.length);this.nextBlock.set(a,this.i),this.i+=a.length}else n=new Uint8Array;return n}async finish(){let e;if(this.i===0)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const r=this.nextBlock,t=await this._runCBC(this.prevBlock);an(t,r),e=t.subarray(0,r.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const r=(await this._runCBC(d.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return an(r,e),this.clearSensitiveData(),r}}class R1{constructor(e,r,t,n){this.forEncryption=e;const{blockSize:s}=oe(r);this.key=wo.expandKeyLE(t),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=Ss(n),this.nextBlock=new Uint8Array(s),this.i=0,this.blockSize=s}_runCFB(e){const r=Ss(e),t=new Uint8Array(e.length),n=Ss(t);for(let s=0;s+4<=n.length;s+=4){const{s0:a,s1:o,s2:c,s3:u}=wo.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[s+0]=r[s+0]^a,n[s+1]=r[s+1]^o,n[s+2]=r[s+2]^c,n[s+3]=r[s+3]^u,this.prevBlock=(this.forEncryption?n:r).slice(s,s+4)}return t}async processChunk(e){const r=this.nextBlock.length-this.i,t=e.subarray(0,r);if(this.nextBlock.set(t,this.i),this.i+e.length>=2*this.blockSize){const s=(e.length-r)%this.blockSize,a=d.concatUint8Array([this.nextBlock,e.subarray(r,e.length-s)]),o=this._runCFB(a);return s>0&&this.nextBlock.set(e.subarray(-s)),this.i=s,o}let n;if(this.i+=t.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const s=e.subarray(t.length);this.nextBlock.set(s,this.i),this.i+=s.length}else n=new Uint8Array;return n}async finish(){let e;return this.i===0?e=new Uint8Array:e=this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function an(i,e){const r=Math.min(i.length,e.length);for(let t=0;t<r;t++)i[t]=i[t]^e[t]}const Ss=i=>new Uint32Array(i.buffer,i.byteOffset,Math.floor(i.byteLength/4)),Io=d.getWebCrypto(),V3=d.getNodeCrypto(),Ur=16;function So(i,e){const r=i.length-Ur;for(let t=0;t<Ur;t++)i[t+r]^=e[t];return i}const vn=new Uint8Array(Ur);async function q3(i){const e=await _3(i),r=d.double(await e(vn)),t=d.double(r);return async function(n){return(await e((function(s,a,o){if(s.length&&s.length%Ur==0)return So(s,a);const c=new Uint8Array(s.length+(Ur-s.length%Ur));return c.set(s),c[s.length]=128,So(c,o)})(n,r,t))).subarray(-16)}}async function _3(i){if(d.getNodeCrypto())return async function(e){const r=new V3.createCipheriv("aes-"+8*i.length+"-cbc",i,vn).update(e);return new Uint8Array(r)};if(d.getWebCrypto())try{return i=await Io.importKey("raw",i,{name:"AES-CBC",length:8*i.length},!1,["encrypt"]),async function(e){const r=await Io.encrypt({name:"AES-CBC",iv:vn,length:128},i,e);return new Uint8Array(r).subarray(0,r.byteLength-Ur)}}catch(e){if(e.name!=="NotSupportedError"&&(i.length!==24||e.name!=="OperationError"))throw e;d.printDebugError("Browser did not support operation: "+e.message)}return async function(e){return ia(i,vn,{disablePadding:!0}).encrypt(e)}}const Ko=d.getWebCrypto(),Y3=d.getNodeCrypto(),Z3=d.getNodeBuffer(),Xi=16,Bn=Xi,Co=new Uint8Array(Xi),ha=new Uint8Array(Xi);ha[15]=1;const fa=new Uint8Array(Xi);async function J3(i){const e=await q3(i);return function(r,t){return e(d.concatUint8Array([r,t]))}}async function X3(i){if(d.getNodeCrypto())return async function(e,r){const t=new Y3.createCipheriv("aes-"+8*i.length+"-ctr",i,r),n=Z3.concat([t.update(e),t.final()]);return new Uint8Array(n)};if(d.getWebCrypto())try{const e=await Ko.importKey("raw",i,{name:"AES-CTR",length:8*i.length},!1,["encrypt"]);return async function(r,t){const n=await Ko.encrypt({name:"AES-CTR",counter:t,length:128},e,r);return new Uint8Array(n)}}catch(e){if(e.name!=="NotSupportedError"&&(i.length!==24||e.name!=="OperationError"))throw e;d.printDebugError("Browser did not support operation: "+e.message)}return async function(e,r){return P3(i,r).encrypt(e)}}async function Di(i,e){if(i!==l.symmetric.aes128&&i!==l.symmetric.aes192&&i!==l.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,t]=await Promise.all([J3(e),X3(e)]);return{encrypt:async function(n,s,a){const[o,c]=await Promise.all([r(Co,s),r(ha,a)]),u=await t(n,o),f=await r(fa,u);for(let h=0;h<Bn;h++)f[h]^=c[h]^o[h];return d.concatUint8Array([u,f])},decrypt:async function(n,s,a){if(n.length<Bn)throw Error("Invalid EAX ciphertext");const o=n.subarray(0,-16),c=n.subarray(-16),[u,f,h]=await Promise.all([r(Co,s),r(ha,a),r(fa,o)]),y=h;for(let g=0;g<Bn;g++)y[g]^=f[g]^u[g];if(!d.equalsUint8Array(c,y))throw Error("Authentication tag mismatch");return await t(o,u)}}}fa[15]=2,Di.getNonce=function(i,e){const r=i.slice();for(let t=0;t<e.length;t++)r[8+t]^=e[t];return r},Di.blockLength=Xi,Di.ivLength=16,Di.tagLength=Bn;const Xe=16,la=16;function Uo(i){let e=0;for(let r=1;!(i&r);r<<=1)e++;return e}function He(i,e){for(let r=0;r<i.length;r++)i[r]^=e[r];return i}function on(i,e){return He(i.slice(),e)}const mi=new Uint8Array(Xe),W3=new Uint8Array([1]);async function xi(i,e){const{keySize:r}=oe(i);if(!d.isAES(i)||e.length!==r)throw Error("Unexpected algorithm or key size");let t=0;const n=c=>ia(e,mi,{disablePadding:!0}).encrypt(c),s=c=>ia(e,mi,{disablePadding:!0}).decrypt(c);let a;function o(c,u,f,h){const y=u.length/Xe|0;(function(P,I){const b=d.nbits(Math.max(P.length,I.length)/Xe|0)-1;for(let K=t+1;K<=b;K++)a[K]=d.double(a[K-1]);t=b})(u,h);const g=d.concatUint8Array([mi.subarray(0,15-f.length),W3,f]),p=63&g[15];g[15]&=192;const w=n(g),A=d.concatUint8Array([w,on(w.subarray(0,8),w.subarray(1,9))]),m=d.shiftRight(A.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),v=new Uint8Array(Xe),E=new Uint8Array(u.length+la);let k,U=0;for(k=0;k<y;k++)He(m,a[Uo(k+1)]),E.set(He(c(on(m,u)),m),U),He(v,c===n?u:E.subarray(U)),u=u.subarray(Xe),U+=Xe;if(u.length){He(m,a.x);const P=n(m);E.set(on(u,P),U);const I=new Uint8Array(Xe);I.set(c===n?u:E.subarray(U,-16),0),I[u.length]=128,He(v,I),U+=u.length}const Q=He(n(He(He(v,m),a.$)),(function(P){if(!P.length)return mi;const I=P.length/Xe|0,b=new Uint8Array(Xe),K=new Uint8Array(Xe);for(let B=0;B<I;B++)He(b,a[Uo(B+1)]),He(K,n(on(b,P))),P=P.subarray(Xe);if(P.length){He(b,a.x);const B=new Uint8Array(Xe);B.set(P,0),B[P.length]=128,He(B,b),He(K,n(B))}return K})(h));return E.set(Q,U),E}return(function(){const c=n(mi),u=d.double(c);a=[],a[0]=d.double(u),a.x=c,a.$=u})(),{encrypt:async function(c,u,f){return o(n,c,u,f)},decrypt:async function(c,u,f){if(c.length<la)throw Error("Invalid OCB ciphertext");const h=c.subarray(-16);c=c.subarray(0,-16);const y=o(s,c,u,f);if(d.equalsUint8Array(h,y.subarray(-16)))return y.subarray(0,-16);throw Error("Authentication tag mismatch")}}}xi.getNonce=function(i,e){const r=i.slice();for(let t=0;t<e.length;t++)r[7+t]^=e[t];return r},xi.blockLength=Xe,xi.ivLength=15,xi.tagLength=la;const Ks=d.getWebCrypto(),Po=d.getNodeCrypto(),Do=d.getNodeBuffer(),In=16,Cs="AES-GCM";async function Xr(i,e){if(i!==l.symmetric.aes128&&i!==l.symmetric.aes192&&i!==l.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(d.getNodeCrypto())return{encrypt:async function(r,t,n=new Uint8Array){const s=new Po.createCipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(n);const a=Do.concat([s.update(r),s.final(),s.getAuthTag()]);return new Uint8Array(a)},decrypt:async function(r,t,n=new Uint8Array){const s=new Po.createDecipheriv("aes-"+8*e.length+"-gcm",e,t);s.setAAD(n),s.setAuthTag(r.slice(r.length-In,r.length));const a=Do.concat([s.update(r.slice(0,r.length-In)),s.final()]);return new Uint8Array(a)}};if(d.getWebCrypto())try{const r=await Ks.importKey("raw",e,{name:Cs},!1,["encrypt","decrypt"]),t=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,s,a=new Uint8Array){if(t&&!n.length)return sn(e,s,a).encrypt(n);const o=await Ks.encrypt({name:Cs,iv:s,additionalData:a,tagLength:128},r,n);return new Uint8Array(o)},decrypt:async function(n,s,a=new Uint8Array){if(t&&n.length===In)return sn(e,s,a).decrypt(n);try{const o=await Ks.decrypt({name:Cs,iv:s,additionalData:a,tagLength:128},r,n);return new Uint8Array(o)}catch(o){if(o.name==="OperationError")throw Error("Authentication tag mismatch")}}}}catch(r){if(r.name!=="NotSupportedError"&&(e.length!==24||r.name!=="OperationError"))throw r;d.printDebugError("Browser did not support operation: "+r.message)}return{encrypt:async function(r,t,n){return sn(e,t,n).encrypt(r)},decrypt:async function(r,t,n){return sn(e,t,n).decrypt(r)}}}function jt(i,e=!1){switch(i){case l.aead.eax:return Di;case l.aead.ocb:return xi;case l.aead.gcm:return Xr;case l.aead.experimentalGCM:if(!e)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return Xr;default:throw Error("Unsupported AEAD mode")}}async function $3(i,e,r,t,n,s){switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=t;return m3(e,n,d.leftPad(r.s,a.length),a,o,s)}case l.publicKey.dsa:{const{g:a,p:o,q:c,y:u}=t,{r:f,s:h}=r;return(async function(y,g,p,w,A,m,v,E){if(g=Y(g),p=Y(p),m=Y(m),v=Y(v),A=Y(A),E=Y(E),g<=kn||g>=v||p<=kn||p>=v)return d.printDebug("invalid DSA Signature"),!1;const k=ee(Y(w.subarray(0,Ye(v))),v),U=ni(p,v);if(U===kn)return d.printDebug("invalid DSA Signature"),!1;A=ee(A,m),E=ee(E,m);const Q=ee(k*U,v),P=ee(g*U,v);return ee(ee(Ue(A,Q,m)*Ue(E,P,m),m),v)===g})(0,f,h,s,a,o,c,u)}case l.publicKey.ecdsa:{const{oid:a,Q:o}=t,c=new ot(a).payloadSize;return ca(a,e,{r:d.leftPad(r.r,c),s:d.leftPad(r.s,c)},n,o,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=t,c=new ot(a).payloadSize;return I1(a,e,{r:d.leftPad(r.r,c),s:d.leftPad(r.s,c)},0,o,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=t;return Ta(i,e,r,0,a,s)}default:throw Error("Unknown signature algorithm.")}}async function eu(i,e,r,t,n,s){if(!r||!t)throw Error("Missing key parameters");switch(i){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const{n:a,e:o}=r,{d:c,p:u,q:f,u:h}=t;return{s:await w3(e,n,a,o,c,u,f,h,s)}}case l.publicKey.dsa:{const{g:a,p:o,q:c}=r,{x:u}=t;return(async function(f,h,y,g,p,w){const A=BigInt(0);let m,v,E,k;g=Y(g),p=Y(p),y=Y(y),w=Y(w),y=ee(y,g),w=ee(w,p);const U=ee(Y(h.subarray(0,Ye(p))),p);for(;;){if(m=yr(Pi,p),v=ee(Ue(y,m,g),p),v===A)continue;const Q=ee(w*v,p);if(k=ee(U+Q,p),E=ee(ni(m,p)*k,p),E!==A)break}return{r:be(v,"be",Ye(g)),s:be(E,"be",Ye(g))}})(0,s,a,o,c,u)}case l.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case l.publicKey.ecdsa:{const{oid:a,Q:o}=r,{d:c}=t;return oa(a,e,n,o,c,s)}case l.publicKey.eddsaLegacy:{const{oid:a,Q:o}=r,{seed:c}=t;return B1(a,e,0,o,c,s)}case l.publicKey.ed25519:case l.publicKey.ed448:{const{A:a}=r,{seed:o}=t;return Ra(i,e,0,a,o,s)}default:throw Error("Unknown signature algorithm.")}}Xr.getNonce=function(i,e){const r=i.slice();for(let t=0;t<e.length;t++)r[4+t]^=e[t];return r},Xr.blockLength=16,Xr.ivLength=12,Xr.tagLength=In;class cs extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,cs),this.name="Argon2OutOfMemoryError"}}let cn,bi;class tu{constructor(e=G){const{passes:r,parallelism:t,memoryExponent:n}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=r,this.p=t,this.encodedM=n}generateSalt(){this.salt=Pe(16)}read(e){let r=0;return this.salt=e.subarray(r,r+16),r+=16,this.t=e[r++],this.p=e[r++],this.encodedM=e[r++],r}write(){const e=[new Uint8Array([l.write(l.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return d.concatUint8Array(e)}async produceKey(e,r){const t=2<<this.encodedM-1;try{cn=cn||(await Promise.resolve().then((function(){return I5}))).default,bi=bi||cn();const n=await bi,s=n({version:19,type:2,password:d.encodeUTF8(e),salt:this.salt,tagLength:r,memorySize:t,parallelism:this.p,passes:this.t});return t>1048576&&(bi=cn(),bi.catch((()=>{}))),s}catch(n){throw n.message&&(n.message.includes("Unable to grow instance memory")||n.message.includes("failed to grow memory")||n.message.includes("WebAssembly.Memory.grow")||n.message.includes("Out of memory"))?new cs("Could not allocate required memory for Argon2"):n}}}class ru{constructor(e,r=G){this.algorithm=l.hash.sha256,this.type=l.read(l.s2k,e),this.c=r.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=Pe(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let r=0;switch(this.algorithm=e[r++],this.type){case"simple":break;case"salted":this.salt=e.subarray(r,r+8),r+=8;break;case"iterated":this.salt=e.subarray(r,r+8),r+=8,this.c=e[r++];break;case"gnu":if(d.uint8ArrayToString(e.subarray(r,r+3))!=="GNU")throw new ne("Unknown s2k type.");if(r+=3,1e3+e[r++]!==1001)throw new ne("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new ne("Unknown s2k type.")}return r}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...d.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([l.write(l.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return d.concatUint8Array(e)}async produceKey(e,r){e=d.encodeUTF8(e);const t=[];let n=0,s=0;for(;n<r;){let a;switch(this.type){case"simple":a=d.concatUint8Array([new Uint8Array(s),e]);break;case"salted":a=d.concatUint8Array([new Uint8Array(s),this.salt,e]);break;case"iterated":{const c=d.concatUint8Array([this.salt,e]);let u=c.length;const f=Math.max(this.getCount(),u);a=new Uint8Array(s+f),a.set(c,s);for(let h=s+u;h<f;h+=u,u*=2)a.copyWithin(h,s,h);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await xt(this.algorithm,a);t.push(o),n+=o.length,s++}return d.concatUint8Array(t).subarray(0,r)}}const iu=new Set([l.s2k.argon2,l.s2k.iterated]);function On(i,e=G){switch(i){case l.s2k.argon2:return new tu(e);case l.s2k.iterated:case l.s2k.gnu:case l.s2k.salted:case l.s2k.simple:return new ru(i,e);default:throw new ne("Unsupported S2K type")}}function T1(i){const{s2kType:e}=i;if(!iu.has(e))throw Error("The provided `config.s2kType` value is not allowed");return On(e,i)}var me=Uint8Array,$e=Uint16Array,Va=Int32Array,us=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hs=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ya=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),M1=function(i,e){for(var r=new $e(31),t=0;t<31;++t)r[t]=e+=1<<i[t-1];var n=new Va(r[30]);for(t=1;t<30;++t)for(var s=r[t];s<r[t+1];++s)n[s]=s-r[t]<<5|t;return{b:r,r:n}},F1=M1(us,2),L1=F1.b,ga=F1.r;L1[28]=258,ga[258]=28;for(var xo=M1(hs,0),nu=xo.b,Qo=xo.r,pa=new $e(32768),he=0;he<32768;++he){var vr=(43690&he)>>1|(21845&he)<<1;vr=(61680&(vr=(52428&vr)>>2|(13107&vr)<<2))>>4|(3855&vr)<<4,pa[he]=((65280&vr)>>8|(255&vr)<<8)>>1}var Ut=function(i,e,r){for(var t=i.length,n=0,s=new $e(e);n<t;++n)i[n]&&++s[i[n]-1];var a,o=new $e(e);for(n=1;n<e;++n)o[n]=o[n-1]+s[n-1]<<1;if(r){a=new $e(1<<e);var c=15-e;for(n=0;n<t;++n)if(i[n])for(var u=n<<4|i[n],f=e-i[n],h=o[i[n]-1]++<<f,y=h|(1<<f)-1;h<=y;++h)a[pa[h]>>c]=u}else for(a=new $e(t),n=0;n<t;++n)i[n]&&(a[n]=pa[o[i[n]-1]++]>>15-i[n]);return a},wr=new me(288);for(he=0;he<144;++he)wr[he]=8;for(he=144;he<256;++he)wr[he]=9;for(he=256;he<280;++he)wr[he]=7;for(he=280;he<288;++he)wr[he]=8;var Vi=new me(32);for(he=0;he<32;++he)Vi[he]=5;var su=Ut(wr,9,0),au=Ut(wr,9,1),ou=Ut(Vi,5,0),cu=Ut(Vi,5,1),Us=function(i){for(var e=i[0],r=1;r<i.length;++r)i[r]>e&&(e=i[r]);return e},ht=function(i,e,r){var t=e/8|0;return(i[t]|i[t+1]<<8)>>(7&e)&r},Ps=function(i,e){var r=e/8|0;return(i[r]|i[r+1]<<8|i[r+2]<<16)>>(7&e)},qa=function(i){return(i+7)/8|0},Qi=function(i,e,r){return(e==null||e<0)&&(e=0),(r==null||r>i.length)&&(r=i.length),new me(i.subarray(e,r))},uu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ke=function(i,e,r){var t=Error(e||uu[i]);if(t.code=i,Error.captureStackTrace&&Error.captureStackTrace(t,Ke),!r)throw t;return t},Tt=function(i,e,r){r<<=7&e;var t=e/8|0;i[t]|=r,i[t+1]|=r>>8},ki=function(i,e,r){r<<=7&e;var t=e/8|0;i[t]|=r,i[t+1]|=r>>8,i[t+2]|=r>>16},Ds=function(i,e){for(var r=[],t=0;t<i.length;++t)i[t]&&r.push({s:t,f:i[t]});var n=r.length,s=r.slice();if(!n)return{t:O1,l:0};if(n==1){var a=new me(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(U,Q){return U.f-Q.f})),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,f=1,h=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};f!=n-1;)o=r[r[u].f<r[h].f?u++:h++],c=r[u!=f&&r[u].f<r[h].f?u++:h++],r[f++]={s:-1,f:o.f+c.f,l:o,r:c};var y=s[0].s;for(t=1;t<n;++t)s[t].s>y&&(y=s[t].s);var g=new $e(y+1),p=da(r[f-1],g,0);if(p>e){t=0;var w=0,A=p-e,m=1<<A;for(s.sort((function(U,Q){return g[Q.s]-g[U.s]||U.f-Q.f}));t<n;++t){var v=s[t].s;if(!(g[v]>e))break;w+=m-(1<<p-g[v]),g[v]=e}for(w>>=A;w>0;){var E=s[t].s;g[E]<e?w-=1<<e-g[E]++-1:++t}for(;t>=0&&w;--t){var k=s[t].s;g[k]==e&&(--g[k],++w)}p=e}return{t:new me(g),l:p}},da=function(i,e,r){return i.s==-1?Math.max(da(i.l,e,r+1),da(i.r,e,r+1)):e[i.s]=r},Ro=function(i){for(var e=i.length;e&&!i[--e];);for(var r=new $e(++e),t=0,n=i[0],s=1,a=function(c){r[t++]=c},o=1;o<=e;++o)if(i[o]==n&&o!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=i[o]}return{c:r.subarray(0,t),n:e}},Ei=function(i,e){for(var r=0,t=0;t<e.length;++t)r+=i[t]*e[t];return r},N1=function(i,e,r){var t=r.length,n=qa(e+2);i[n]=255&t,i[n+1]=t>>8,i[n+2]=255^i[n],i[n+3]=255^i[n+1];for(var s=0;s<t;++s)i[n+s+4]=r[s];return 8*(n+4+t)},To=function(i,e,r,t,n,s,a,o,c,u,f){Tt(e,f++,r),++n[256];for(var h=Ds(n,15),y=h.t,g=h.l,p=Ds(s,15),w=p.t,A=p.l,m=Ro(y),v=m.c,E=m.n,k=Ro(w),U=k.c,Q=k.n,P=new $e(19),I=0;I<v.length;++I)++P[31&v[I]];for(I=0;I<U.length;++I)++P[31&U[I]];for(var b=Ds(P,7),K=b.t,B=b.l,S=19;S>4&&!K[ya[S-1]];--S);var C,D,R,x,T=u+5<<3,N=Ei(n,wr)+Ei(s,Vi)+a,F=Ei(n,y)+Ei(s,w)+a+14+3*S+Ei(P,K)+2*P[16]+3*P[17]+7*P[18];if(c>=0&&T<=N&&T<=F)return N1(e,f,i.subarray(c,c+u));if(Tt(e,f,1+(F<N)),f+=2,F<N){C=Ut(y,g,0),D=y,R=Ut(w,A,0),x=w;var M=Ut(K,B,0);for(Tt(e,f,E-257),Tt(e,f+5,Q-1),Tt(e,f+10,S-4),f+=14,I=0;I<S;++I)Tt(e,f+3*I,K[ya[I]]);f+=3*S;for(var z=[v,U],L=0;L<2;++L){var O=z[L];for(I=0;I<O.length;++I){var H=31&O[I];Tt(e,f,M[H]),f+=K[H],H>15&&(Tt(e,f,O[I]>>5&127),f+=O[I]>>12)}}}else C=su,D=wr,R=ou,x=Vi;for(I=0;I<o;++I){var j=t[I];if(j>255){ki(e,f,C[(H=j>>18&31)+257]),f+=D[H+257],H>7&&(Tt(e,f,j>>23&31),f+=us[H]);var V=31&j;ki(e,f,R[V]),f+=x[V],V>3&&(ki(e,f,j>>5&8191),f+=hs[V])}else ki(e,f,C[j]),f+=D[j]}return ki(e,f,C[256]),f+D[256]},hu=new Va([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),O1=new me(0),Mo=function(){var i=1,e=0;return{p:function(r){for(var t=i,n=e,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)n+=t+=r[a];t=(65535&t)+15*(t>>16),n=(65535&n)+15*(n>>16)}i=t,e=n},d:function(){return(255&(i%=65521))<<24|(65280&i)<<8|(255&(e%=65521))<<8|e>>8}}},H1=function(i,e,r,t,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new me(s.length+i.length);a.set(s),a.set(i,s.length),i=a,n.w=s.length}return(function(o,c,u,f,h,y){var g=y.z||o.length,p=new me(f+g+5*(1+Math.ceil(g/7e3))+h),w=p.subarray(f,p.length-h),A=y.l,m=7&(y.r||0);if(c){m&&(w[0]=y.r>>3);for(var v=hu[c-1],E=v>>13,k=8191&v,U=(1<<u)-1,Q=y.p||new $e(32768),P=y.h||new $e(U+1),I=Math.ceil(u/3),b=2*I,K=function(bs){return(o[bs]^o[bs+1]<<I^o[bs+2]<<b)&U},B=new Va(25e3),S=new $e(288),C=new $e(32),D=0,R=0,x=y.i||0,T=0,N=y.w||0,F=0;x+2<g;++x){var M=K(x),z=32767&x,L=P[M];if(Q[z]=L,P[M]=z,N<=x){var O=g-x;if((D>7e3||T>24576)&&(O>423||!A)){m=To(o,w,0,B,S,C,R,T,F,x-F,m),T=D=R=0,F=x;for(var H=0;H<286;++H)S[H]=0;for(H=0;H<30;++H)C[H]=0}var j=2,V=0,Z=k,q=z-L&32767;if(O>2&&M==K(x-q))for(var $=Math.min(E,O)-1,W=Math.min(32767,x),ie=Math.min(258,O);q<=W&&--Z&&z!=L;){if(o[x+j]==o[x+j-q]){for(var X=0;X<ie&&o[x+X]==o[x+X-q];++X);if(X>j){if(j=X,V=q,X>$)break;var ge=Math.min(q,X-2),de=0;for(H=0;H<ge;++H){var pe=x-q+H&32767,di=pe-Q[pe]&32767;di>de&&(de=di,L=pe)}}}q+=(z=L)-(L=Q[z])&32767}if(V){B[T++]=268435456|ga[j]<<18|Qo[V];var io=31&ga[j],no=31&Qo[V];R+=us[io]+hs[no],++S[257+io],++C[no],N=x+j,++D}else B[T++]=o[x],++S[o[x]]}}for(x=Math.max(x,N);x<g;++x)B[T++]=o[x],++S[o[x]];m=To(o,w,A,B,S,C,R,T,F,x-F,m),A||(y.r=7&m|w[m/8|0]<<3,m-=7,y.h=P,y.p=Q,y.i=x,y.w=N)}else{for(x=y.w||0;x<g+A;x+=65535){var ms=x+65535;ms>=g&&(w[m/8|0]=A,ms=g),m=N1(w,m+1,o.subarray(x,ms))}y.i=g}return Qi(p,0,f+qa(m)+h)})(i,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(i.length)))):20:12+e.mem,r,t,n)},Fo=function(i,e,r){for(;r;++e)i[e]=r,r>>>=8},Sn=(function(){function i(e,r){if(typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new me(98304),this.o.dictionary){var t=this.o.dictionary.subarray(-32768);this.b.set(t,32768-t.length),this.s.i=32768-t.length}}return i.prototype.p=function(e,r){this.ondata(H1(e,this.o,0,0,this.s),r)},i.prototype.push=function(e,r){this.ondata||Ke(5),this.s.l&&Ke(4);var t=e.length+this.s.z;if(t>this.b.length){if(t>2*this.b.length-32768){var n=new me(-32768&t);n.set(this.b.subarray(0,this.s.z)),this.b=n}var s=this.b.length-this.s.z;this.b.set(e.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(s),32768),this.s.z=e.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},i.prototype.flush=function(){this.ondata||Ke(5),this.s.l&&Ke(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},i})(),Kn=(function(){function i(e,r){typeof e=="function"&&(r=e,e={}),this.ondata=r;var t=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:t?t.length:0},this.o=new me(32768),this.p=new me(0),t&&this.o.set(t)}return i.prototype.e=function(e){if(this.ondata||Ke(5),this.d&&Ke(4),this.p.length){if(e.length){var r=new me(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length),this.p=r}}else this.p=e},i.prototype.c=function(e){this.s.i=+(this.d=e||!1);var r=this.s.b,t=(function(n,s,a,o){var c=n.length;if(!c||s.f&&!s.l)return a||new me(0);var u=!a,f=u||s.i!=2,h=s.i;u&&(a=new me(3*c));var y=function(de){var pe=a.length;if(de>pe){var di=new me(Math.max(2*pe,de));di.set(a),a=di}},g=s.f||0,p=s.p||0,w=s.b||0,A=s.l,m=s.d,v=s.m,E=s.n,k=8*c;do{if(!A){g=ht(n,p,1);var U=ht(n,p+1,3);if(p+=3,!U){var Q=n[(T=qa(p)+4)-4]|n[T-3]<<8,P=T+Q;if(P>c){h&&Ke(0);break}f&&y(w+Q),a.set(n.subarray(T,P),w),s.b=w+=Q,s.p=p=8*P,s.f=g;continue}if(U==1)A=au,m=cu,v=9,E=5;else if(U==2){var I=ht(n,p,31)+257,b=ht(n,p+10,15)+4,K=I+ht(n,p+5,31)+1;p+=14;for(var B=new me(K),S=new me(19),C=0;C<b;++C)S[ya[C]]=ht(n,p+3*C,7);p+=3*b;var D=Us(S),R=(1<<D)-1,x=Ut(S,D,1);for(C=0;C<K;){var T,N=x[ht(n,p,R)];if(p+=15&N,(T=N>>4)<16)B[C++]=T;else{var F=0,M=0;for(T==16?(M=3+ht(n,p,3),p+=2,F=B[C-1]):T==17?(M=3+ht(n,p,7),p+=3):T==18&&(M=11+ht(n,p,127),p+=7);M--;)B[C++]=F}}var z=B.subarray(0,I),L=B.subarray(I);v=Us(z),E=Us(L),A=Ut(z,v,1),m=Ut(L,E,1)}else Ke(1);if(p>k){h&&Ke(0);break}}f&&y(w+131072);for(var O=(1<<v)-1,H=(1<<E)-1,j=p;;j=p){var V=(F=A[Ps(n,p)&O])>>4;if((p+=15&F)>k){h&&Ke(0);break}if(F||Ke(2),V<256)a[w++]=V;else{if(V==256){j=p,A=null;break}var Z=V-254;if(V>264){var q=us[C=V-257];Z=ht(n,p,(1<<q)-1)+L1[C],p+=q}var $=m[Ps(n,p)&H],W=$>>4;if($||Ke(3),p+=15&$,L=nu[W],W>3&&(q=hs[W],L+=Ps(n,p)&(1<<q)-1,p+=q),p>k){h&&Ke(0);break}f&&y(w+131072);var ie=w+Z;if(w<L){var X=0-L,ge=Math.min(L,ie);for(X+w<0&&Ke(3);w<ge;++w)a[w]=o[X+w]}for(;w<ie;++w)a[w]=a[w-L]}}s.l=A,s.p=j,s.b=w,s.f=g,A&&(g=1,s.m=v,s.d=m,s.n=E)}while(!g);return w!=a.length&&u?Qi(a,0,w):a.subarray(0,w)})(this.p,this.s,this.o);this.ondata(Qi(t,r,this.s.b),this.d),this.o=Qi(t,this.s.b-32768),this.s.b=this.o.length,this.p=Qi(this.p,this.s.p/8|0),this.s.p&=7},i.prototype.push=function(e,r){this.e(e),this.c(r)},i})(),fu=(function(){function i(e,r){this.c=Mo(),this.v=1,Sn.call(this,e,r)}return i.prototype.push=function(e,r){this.c.p(e),Sn.prototype.push.call(this,e,r)},i.prototype.p=function(e,r){var t=H1(e,this.o,this.v&&(this.o.dictionary?6:2),r&&4,this.s);this.v&&((function(n,s){var a=s.level,o=a==0?0:a<6?1:a==9?3:2;if(n[0]=120,n[1]=o<<6|(s.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,s.dictionary){var c=Mo();c.p(s.dictionary),Fo(n,2,c.d())}})(t,this.o),this.v=0),r&&Fo(t,t.length-4,this.c.d()),this.ondata(t,r)},i.prototype.flush=function(){Sn.prototype.flush.call(this)},i})(),lu=(function(){function i(e,r){Kn.call(this,e,r),this.v=e&&e.dictionary?2:1}return i.prototype.push=function(e,r){if(Kn.prototype.e.call(this,e),this.v){if(this.p.length<6&&!r)return;this.p=this.p.subarray((t=this.p,n=this.v-1,((15&t[0])!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Ke(6,"invalid zlib data"),(t[1]>>5&1)==+!n&&Ke(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4))),this.v=0}var t,n;r&&(this.p.length<4&&Ke(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Kn.prototype.c.call(this,r)},i})(),yu=typeof TextDecoder<"u"&&new TextDecoder;try{yu.decode(O1,{stream:!0})}catch{}class mr{static get tag(){return l.packet.literalData}constructor(e=new Date){this.format=l.literal.utf8,this.date=d.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,r=l.literal.utf8){this.format=r,this.text=e,this.data=null}getText(e=!1){return(this.text===null||d.isStream(this.text))&&(this.text=d.decodeUTF8(d.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,r){this.format=r,this.data=e,this.text=null}getBytes(e=!1){return this.data===null&&(this.data=d.canonicalizeEOL(d.encodeUTF8(this.text))),e?Ni(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await Jn(e,(async r=>{const t=await r.readByte(),n=await r.readByte();this.filename=d.decodeUTF8(await r.readBytes(n)),this.date=d.readDate(await r.readBytes(4));let s=r.remainder();Ee(s)&&(s=await ke(s)),this.setBytes(s,t)}))}writeHeader(){const e=d.encodeUTF8(this.filename),r=new Uint8Array([e.length]),t=new Uint8Array([this.format]),n=d.writeDate(this.date);return d.concatUint8Array([t,r,e,n])}write(){const e=this.writeHeader(),r=this.getBytes();return d.concat([e,r])}}class Pt{constructor(){this.bytes=""}read(e){return this.bytes=d.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return d.stringToUint8Array(this.bytes)}toHex(){return d.uint8ArrayToHex(d.stringToUint8Array(this.bytes))}equals(e,r=!1){return r&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const r=new Pt;return r.read(d.hexToUint8Array(e)),r}static wildcard(){const e=new Pt;return e.read(new Uint8Array(8)),e}}const vi=Symbol("verified"),Lo="salt@notations.openpgpjs.org",gu=new Set([l.signatureSubpacket.issuerKeyID,l.signatureSubpacket.issuerFingerprint,l.signatureSubpacket.embeddedSignature]);class Ie{static get tag(){return l.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Pt,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[vi]=null}read(e,r=G){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new ne("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version!==4&&this.version!==5&&this.version!==6)throw new ne(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.version===6){const o=e[t++];this.salt=e.subarray(t,t+o),t+=o}const n=e.subarray(t,e.length),{read:s,signatureParams:a}=(function(o,c){let u=0;switch(o){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.rsaSign:{const f=d.readMPI(c.subarray(u));return u+=f.length+2,{read:u,signatureParams:{s:f}}}case l.publicKey.dsa:case l.publicKey.ecdsa:{const f=d.readMPI(c.subarray(u));u+=f.length+2;const h=d.readMPI(c.subarray(u));return u+=h.length+2,{read:u,signatureParams:{r:f,s:h}}}case l.publicKey.eddsaLegacy:{const f=d.readMPI(c.subarray(u));u+=f.length+2;const h=d.readMPI(c.subarray(u));return u+=h.length+2,{read:u,signatureParams:{r:f,s:h}}}case l.publicKey.ed25519:case l.publicKey.ed448:{const f=2*Wn(o),h=d.readExactSubarray(c,u,u+f);return u+=h.length,{read:u,signatureParams:{RS:h}}}default:throw new ne("Unknown signature algorithm.")}})(this.publicKeyAlgorithm,n);if(s<n.length)throw Error("Error reading MPIs");this.params=a}writeParams(){return this.params instanceof Promise?Yt((async()=>ai(this.publicKeyAlgorithm,await this.params))):ai(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),this.version===6&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),d.concat(e)}async sign(e,r,t=new Date,n=!1,s){this.version=e.version,this.created=d.normalizeDate(t),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(this.version===6){const f=xs(this.hashAlgorithm);if(this.salt===null)this.salt=Pe(f);else if(f!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(s.nonDeterministicSignaturesViaNotation){if(this.rawNotations.filter((({name:f})=>f===Lo)).length!==0)throw Error("Unexpected existing salt notation");{const f=Pe(xs(this.hashAlgorithm));this.rawNotations.push({name:Lo,value:f,humanReadable:!1,critical:!1})}}a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=d.concat(a);const o=this.toHash(this.signatureType,r,n),c=await this.hash(this.signatureType,r,o,n);this.signedHashValue=xe(Qr(c),0,2);const u=async()=>eu(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,o,await ke(c));d.isStream(c)?this.params=u():(this.params=await u(),this[vi]=!0)}writeHashedSubPackets(){const e=l.signatureSubpacket,r=[];let t;if(this.created===null)throw Error("Missing signature creation time");r.push(ae(e.signatureCreationTime,!0,d.writeDate(this.created))),this.signatureExpirationTime!==null&&r.push(ae(e.signatureExpirationTime,!0,d.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&r.push(ae(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(t=new Uint8Array([this.trustLevel,this.trustAmount]),r.push(ae(e.trustSignature,!0,t))),this.regularExpression!==null&&r.push(ae(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&r.push(ae(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&r.push(ae(e.keyExpirationTime,!0,d.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredSymmetricAlgorithms)),r.push(ae(e.preferredSymmetricAlgorithms,!1,t))),this.revocationKeyClass!==null&&(t=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),t=d.concat([t,this.revocationKeyFingerprint]),r.push(ae(e.revocationKey,!1,t))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&r.push(ae(e.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach((({name:a,value:o,humanReadable:c,critical:u})=>{t=[new Uint8Array([c?128:0,0,0,0])];const f=d.encodeUTF8(a);t.push(d.writeNumber(f.length,2)),t.push(d.writeNumber(o.length,2)),t.push(f),t.push(o),t=d.concat(t),r.push(ae(e.notationData,u,t))})),this.preferredHashAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredHashAlgorithms)),r.push(ae(e.preferredHashAlgorithms,!1,t))),this.preferredCompressionAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredCompressionAlgorithms)),r.push(ae(e.preferredCompressionAlgorithms,!1,t))),this.keyServerPreferences!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.keyServerPreferences)),r.push(ae(e.keyServerPreferences,!1,t))),this.preferredKeyServer!==null&&r.push(ae(e.preferredKeyServer,!1,d.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&r.push(ae(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&r.push(ae(e.policyURI,!1,d.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.keyFlags)),r.push(ae(e.keyFlags,!0,t))),this.signersUserID!==null&&r.push(ae(e.signersUserID,!1,d.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(t=d.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),r.push(ae(e.reasonForRevocation,!0,t))),this.features!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.features)),r.push(ae(e.features,!1,t))),this.signatureTargetPublicKeyAlgorithm!==null&&(t=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],t.push(d.stringToUint8Array(this.signatureTargetHash)),t=d.concat(t),r.push(ae(e.signatureTarget,!0,t))),this.embeddedSignature!==null&&r.push(ae(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(t=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],t=d.concat(t),r.push(ae(e.issuerFingerprint,this.version>=5,t))),this.preferredAEADAlgorithms!==null&&(t=d.stringToUint8Array(d.uint8ArrayToString(this.preferredAEADAlgorithms)),r.push(ae(e.preferredAEADAlgorithms,!1,t))),this.preferredCipherSuites!==null&&(t=new Uint8Array([].concat(...this.preferredCipherSuites)),r.push(ae(e.preferredCipherSuites,!1,t)));const n=d.concat(r),s=d.writeNumber(n.length,this.version===6?4:2);return d.concat([s,n])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map((({type:n,critical:s,body:a})=>ae(n,s,a))),r=d.concat(e),t=d.writeNumber(r.length,this.version===6?4:2);return d.concat([t,r])}readSubPacket(e,r=!0){let t=0;const n=!!(128&e[t]),s=127&e[t];if(t++,r||(this.unhashedSubpackets.push({type:s,critical:n,body:e.subarray(t,e.length)}),gu.has(s)))switch(s){case l.signatureSubpacket.signatureCreationTime:this.created=d.readDate(e.subarray(t,e.length));break;case l.signatureSubpacket.signatureExpirationTime:{const a=d.readNumber(e.subarray(t,e.length));this.signatureNeverExpires=a===0,this.signatureExpirationTime=a;break}case l.signatureSubpacket.exportableCertification:this.exportable=e[t++]===1;break;case l.signatureSubpacket.trustSignature:this.trustLevel=e[t++],this.trustAmount=e[t++];break;case l.signatureSubpacket.regularExpression:this.regularExpression=e[t];break;case l.signatureSubpacket.revocable:this.revocable=e[t++]===1;break;case l.signatureSubpacket.keyExpirationTime:{const a=d.readNumber(e.subarray(t,e.length));this.keyExpirationTime=a,this.keyNeverExpires=a===0;break}case l.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.revocationKey:this.revocationKeyClass=e[t++],this.revocationKeyAlgorithm=e[t++],this.revocationKeyFingerprint=e.subarray(t,t+20);break;case l.signatureSubpacket.issuerKeyID:if(this.version===4)this.issuerKeyID.read(e.subarray(t,e.length));else if(r)throw Error("Unexpected Issuer Key ID subpacket");break;case l.signatureSubpacket.notationData:{const a=!!(128&e[t]);t+=4;const o=d.readNumber(e.subarray(t,t+2));t+=2;const c=d.readNumber(e.subarray(t,t+2));t+=2;const u=d.decodeUTF8(e.subarray(t,t+o)),f=e.subarray(t+o,t+o+c);this.rawNotations.push({name:u,humanReadable:a,value:f,critical:n}),a&&(this.notations[u]=d.decodeUTF8(f));break}case l.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[t++]!==0;break;case l.signatureSubpacket.policyURI:this.policyURI=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.signersUserID:this.signersUserID=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[t++],this.reasonForRevocationString=d.decodeUTF8(e.subarray(t,e.length));break;case l.signatureSubpacket.features:this.features=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[t++],this.signatureTargetHashAlgorithm=e[t++];const a=ve(this.signatureTargetHashAlgorithm);this.signatureTargetHash=d.uint8ArrayToString(e.subarray(t,t+a));break}case l.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Ie,this.embeddedSignature.read(e.subarray(t,e.length));break;case l.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[t++],this.issuerFingerprint=e.subarray(t,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case l.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(t,e.length)];break;case l.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let a=t;a<e.length;a+=2)this.preferredCipherSuites.push([e[a],e[a+1]]);break;default:this.unknownSubpackets.push({type:s,critical:n,body:e.subarray(t,e.length)})}}readSubPackets(e,r=!0,t){const n=this.version===6?4:2,s=d.readNumber(e.subarray(0,n));let a=n;for(;a<2+s;){const o=$c(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),r,t),a+=o.len}return a}toSign(e,r){const t=l.signature;switch(e){case t.binary:return r.text!==null?d.encodeUTF8(r.getText(!0)):r.getBytes(!0);case t.text:{const n=r.getBytes(!0);return d.canonicalizeEOL(n)}case t.standalone:return new Uint8Array(0);case t.certGeneric:case t.certPersona:case t.certCasual:case t.certPositive:case t.certRevocation:{let n,s;if(r.userID)s=180,n=r.userID;else{if(!r.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");s=209,n=r.userAttribute}const a=n.write();return d.concat([this.toSign(t.key,r),new Uint8Array([s]),d.writeNumber(a.length,4),a])}case t.subkeyBinding:case t.subkeyRevocation:case t.keyBinding:return d.concat([this.toSign(t.key,r),this.toSign(t.key,{key:r.bind})]);case t.key:if(r.key===void 0)throw Error("Key packet is required for this signature.");return r.key.writeForHash(this.version);case t.keyRevocation:return this.toSign(t.key,r);case t.timestamp:return new Uint8Array(0);case t.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,r){let t=0;return we(Qr(this.signatureData),(n=>{t+=n.length}),(()=>{const n=[];return this.version!==5||this.signatureType!==l.signature.binary&&this.signatureType!==l.signature.text||(r?n.push(new Uint8Array(6)):n.push(e.writeHeader())),n.push(new Uint8Array([this.version,255])),this.version===5&&n.push(new Uint8Array(4)),n.push(d.writeNumber(t,4)),d.concat(n)}))}toHash(e,r,t=!1){const n=this.toSign(e,r);return d.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(r,t)])}async hash(e,r,t,n=!1){if(this.version===6&&this.salt.length!==xs(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return t||(t=this.toHash(e,r,n)),xt(this.hashAlgorithm,t)}async verify(e,r,t,n=new Date,s=!1,a=G){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=r===l.signature.binary||r===l.signature.text;if(!(this[vi]&&!o)){let u,f;if(this.hashed?f=await this.hashed:(u=this.toHash(r,t,s),f=await this.hash(r,t,u)),f=await ke(f),this.signedHashValue[0]!==f[0]||this.signedHashValue[1]!==f[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[vi]=await $3(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,u,f),!this[vi])throw Error("Signature verification failed")}const c=d.normalizeDate(n);if(c&&this.created>c)throw Error("Signature creation time is in the future");if(c&&c>=this.getExpirationTime())throw Error("Signature is expired");if(a.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(a.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[l.signature.binary,l.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+l.read(l.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach((({type:u,critical:f})=>{if(f)throw Error("Unknown critical signature subpacket type "+u)})),this.rawNotations.forEach((({name:u,critical:f})=>{if(f&&a.knownNotations.indexOf(u)<0)throw Error("Unknown critical notation: "+u)})),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const r=d.normalizeDate(e);return r!==null&&!(this.created<=r&&r<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function ae(i,e,r){const t=[];return t.push(Xn(r.length+1)),t.push(new Uint8Array([(e?128:0)|i])),t.push(r),d.concat(t)}function xs(i){switch(i){case l.hash.sha256:return 16;case l.hash.sha384:return 24;case l.hash.sha512:return 32;case l.hash.sha224:case l.hash.sha3_256:return 16;case l.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class at{static get tag(){return l.packet.onePassSignature}static fromSignaturePacket(e,r){const t=new at;return t.version=e.version===6?6:3,t.signatureType=e.signatureType,t.hashAlgorithm=e.hashAlgorithm,t.publicKeyAlgorithm=e.publicKeyAlgorithm,t.issuerKeyID=e.issuerKeyID,t.salt=e.salt,t.issuerFingerprint=e.issuerFingerprint,t.flags=r?1:0,t}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new ne(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[r++],this.hashAlgorithm=e[r++],this.publicKeyAlgorithm=e[r++],this.version===6){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t,this.issuerFingerprint=e.subarray(r,r+32),r+=32,this.issuerKeyID=new Pt,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Pt,this.issuerKeyID.read(e.subarray(r,r+8)),r+=8;return this.flags=e[r++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return this.version===6?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),d.concatUint8Array(e)}calculateTrailer(...e){return Yt((async()=>Ie.prototype.calculateTrailer.apply(await this.correspondingSig,e)))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==l.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||this.version===3&&e.version===6||this.version===6&&e.version!==6||this.version===6&&!d.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||this.version===6&&!d.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function pu(i,e){if(!e[i]){let r;try{r=l.read(l.packet,i)}catch{throw new mn("Unknown packet type with tag: "+i)}throw Error("Packet not allowed in this context: "+r)}return new e[i]}at.prototype.hash=Ie.prototype.hash,at.prototype.toHash=Ie.prototype.toHash,at.prototype.toSign=Ie.prototype.toSign;class re extends Array{static async fromBinary(e,r,t=G,n=null,s=!1){const a=new re;return await a.read(e,r,t,n,s),a}async read(e,r,t=G,n=null,s=!1){let a;t.additionalAllowedPackets.length&&(a=d.constructAllowedPackets(t.additionalAllowedPackets),r={...r,...a}),this.stream=_t(e,(async(c,u)=>{const f=Vt(c),h=et(u);try{let y=d.isStream(c);for(;;){let g,p;if(await h.ready,await B3(f,y,(async A=>{try{if(A.tag===l.packet.marker||A.tag===l.packet.trust||A.tag===l.packet.padding)return;const m=pu(A.tag,r);try{n?.recordPacket(A.tag,a)}catch(v){if(t.enforceGrammar)throw v;d.printDebugError(v)}m.packets=new re,m.fromStream=d.isStream(A.packet),p=m.fromStream;try{await m.read(A.packet,t)}catch(v){throw v instanceof ne?v:d.wrapError(new Es(`Parsing ${m.constructor.name} failed`),v)}await h.write(m)}catch(m){const v=m instanceof mn&&A.tag<=39,E=m instanceof ne&&!(m instanceof mn)&&!t.ignoreUnsupportedPackets,k=m instanceof Es&&!t.ignoreMalformedPackets,U=wn(A.tag);if(v||E||k||U||!(m instanceof mn||m instanceof ne||m instanceof Es))s?g=m:await h.abort(m);else{const Q=new $s(A.tag,A.packet);await h.write(Q)}d.printDebugError(m)}})),p&&(y=null),g)throw await f.readToEnd(),g;const w=await f.peekBytes(2);if(!w||!w.length){try{n?.recordEnd()}catch(A){if(t.enforceGrammar)throw A;d.printDebugError(A)}return await h.ready,void await h.close()}}}catch(y){await h.abort(y)}}));const o=Vt(this.stream);for(;;){const{done:c,value:u}=await o.read();if(c?this.stream=null:this.push(u),c||wn(u.constructor.tag))break}o.releaseLock()}write(){const e=[];for(let r=0;r<this.length;r++){const t=this[r]instanceof $s?this[r].tag:this[r].constructor.tag,n=this[r].write();if(d.isStream(n)&&wn(this[r].constructor.tag)){let s=[],a=0;const o=512;e.push(Qn(t)),e.push(we(n,(c=>{if(s.push(c),a+=c.length,a>=o){const u=Math.min(Math.log(a)/Math.LN2|0,30),f=2**u,h=d.concat([v3(u)].concat(s));return s=[h.subarray(1+f)],a=s[0].length,h.subarray(0,1+f)}}),(()=>d.concat([Xn(a)].concat(s)))))}else{if(d.isStream(n)){let s=0;e.push(we(Qr(n),(a=>{s+=a.length}),(()=>lo(t,s))))}else e.push(lo(t,n.length));e.push(n)}}return d.concat(e)}filterByTag(...e){const r=new re,t=n=>s=>n===s;for(let n=0;n<this.length;n++)e.some(t(this[n].constructor.tag))&&r.push(this[n]);return r}findPacket(e){return this.find((r=>r.constructor.tag===e))}indexOfTag(...e){const r=[],t=this,n=s=>a=>s===a;for(let s=0;s<this.length;s++)e.some(n(t[s].constructor.tag))&&r.push(s);return r}}class mt extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,mt),this.name="GrammarError"}}var Ae;(function(i){i[i.EmptyMessage=0]="EmptyMessage",i[i.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",i[i.EncryptedSessionKeys=2]="EncryptedSessionKeys",i[i.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"})(Ae||(Ae={}));class fs{constructor(){this.state=Ae.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(e,r){switch(this.state){case Ae.EmptyMessage:case Ae.StandaloneAdditionalAllowedData:switch(e){case l.packet.literalData:case l.packet.compressedData:case l.packet.aeadEncryptedData:case l.packet.symEncryptedIntegrityProtectedData:case l.packet.symmetricallyEncryptedData:return void(this.state=Ae.PlaintextOrEncryptedData);case l.packet.signature:if(this.state===Ae.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new mt("Trailing signature packet without OPS");return;case l.packet.onePassSignature:if(this.state===Ae.StandaloneAdditionalAllowedData)throw new mt("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case l.packet.publicKeyEncryptedSessionKey:case l.packet.symEncryptedSessionKey:return void(this.state=Ae.EncryptedSessionKeys);default:if(!r?.[e])throw new mt(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ae.StandaloneAdditionalAllowedData)}case Ae.PlaintextOrEncryptedData:if(e===l.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new mt("Trailing signature packet without OPS");return void(this.state=Ae.PlaintextOrEncryptedData)}if(!r?.[e])throw new mt(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Ae.PlaintextOrEncryptedData);case Ae.EncryptedSessionKeys:switch(e){case l.packet.publicKeyEncryptedSessionKey:case l.packet.symEncryptedSessionKey:return void(this.state=Ae.EncryptedSessionKeys);case l.packet.symEncryptedIntegrityProtectedData:case l.packet.aeadEncryptedData:case l.packet.symmetricallyEncryptedData:return void(this.state=Ae.PlaintextOrEncryptedData);case l.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new mt("Trailing signature packet without OPS");return void(this.state=Ae.PlaintextOrEncryptedData);default:if(!r?.[e])throw new mt(`Unexpected packet ${e} in state ${this.state}`);this.state=Ae.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case Ae.EmptyMessage:case Ae.PlaintextOrEncryptedData:case Ae.EncryptedSessionKeys:case Ae.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new mt("Missing trailing signature packets")}}}const du=d.constructAllowedPackets([mr,at,Ie]);class Wi{static get tag(){return l.packet.compressedData}constructor(e=G){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,r=G){await Jn(e,(async t=>{this.algorithm=await t.readByte(),this.compressed=t.remainder(),await this.decompress(r)}))}write(){return this.compressed===null&&this.compress(),d.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=G){const r=l.read(l.compression,this.algorithm),t=mu[r];if(!t)throw Error(r+" decompression not supported");this.packets=await re.fromBinary(await t(this.compressed),du,e,new fs)}compress(){const e=l.read(l.compression,this.algorithm),r=wu[e];if(!r)throw Error(e+" compression not supported");this.compressed=r(this.packets.write())}}function Hn(i,e){return r=>{if(!d.isStream(r)||Ee(r))return Yt((()=>ke(r).then((s=>new Promise(((a,o)=>{const c=new e,u=[];c.ondata=(f,h)=>{u.push(f),h&&a(d.concatUint8Array(u))};try{c.push(s,!0)}catch(f){o(f)}}))))));if(i)try{const s=i();return r.pipeThrough(s)}catch(s){if(s.name!=="TypeError")throw s}const t=r.getReader(),n=new e;return new ReadableStream({async start(s){for(n.ondata=async(a,o)=>{s.enqueue(a),o&&s.close()};;){const{done:a,value:o}=await t.read();if(a)return void n.push(new Uint8Array,!0);o.length&&n.push(o)}}})}}function Au(){return async function(i){const{decode:e}=await Promise.resolve().then((function(){return C5}));return Yt((async()=>e(await ke(i))))}}const zn=i=>({compressor:typeof CompressionStream<"u"&&(()=>new CompressionStream(i)),decompressor:typeof DecompressionStream<"u"&&(()=>new DecompressionStream(i))}),wu={zip:Hn(zn("deflate-raw").compressor,Sn),zlib:Hn(zn("deflate").compressor,fu)},mu={uncompressed:i=>i,zip:Hn(zn("deflate-raw").decompressor,Kn),zlib:Hn(zn("deflate").decompressor,lu),bzip2:Au()},bu=d.constructAllowedPackets([mr,Wi,at,Ie]);class oi{static get tag(){return l.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:r}){if(e!==1&&e!==2)throw Error("Unsupported SEIPD version");const t=new oi;return t.version=e,e===2&&(t.aeadAlgorithm=r),t}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await Jn(e,(async r=>{if(this.version=await r.readByte(),this.version!==1&&this.version!==2)throw new ne(`Version ${this.version} of the SEIP packet is unsupported.`);this.version===2&&(this.cipherAlgorithm=await r.readByte(),this.aeadAlgorithm=await r.readByte(),this.chunkSizeByte=await r.readByte(),this.salt=await r.readBytes(32)),this.encrypted=r.remainder()}))}write(){return this.version===2?d.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):d.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,r,t=G){const{blockSize:n,keySize:s}=oe(e);if(r.length!==s)throw Error("Unexpected session key size");let a=this.packets.write();if(Ee(a)&&(a=await ke(a)),this.version===2)this.cipherAlgorithm=e,this.salt=Pe(32),this.chunkSizeByte=t.aeadChunkSizeByte,this.encrypted=await Gn(this,"encrypt",r,a);else{const o=await Q1(e),c=new Uint8Array([211,20]),u=d.concat([o,a,c]),f=await xt(l.hash.sha1,Ni(u)),h=d.concat([u,f]);this.encrypted=await ji(e,r,h,new Uint8Array(n))}return!0}async decrypt(e,r,t=G){if(r.length!==oe(e).keySize)throw Error("Unexpected session key size");let n,s=Qr(this.encrypted);Ee(s)&&(s=await ke(s));let a=!1;if(this.version===2){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");n=await Gn(this,"decrypt",r,s)}else{const{blockSize:o}=oe(e),c=await os(e,r,s,new Uint8Array(o)),u=xe(Ni(c),-20),f=xe(c,0,-20),h=Promise.all([ke(await xt(l.hash.sha1,Ni(f))),ke(u)]).then((([g,p])=>{if(!d.equalsUint8Array(g,p))throw Error("Modification detected.");return new Uint8Array})),y=xe(f,o+2);n=xe(y,0,-2),n=Oe([n,Yt((()=>h))]),d.isStream(s)&&t.allowUnauthenticatedStream?a=!0:n=await ke(n)}return this.packets=await re.fromBinary(n,bu,t,new fs,a),!0}}async function Gn(i,e,r,t){const n=i instanceof oi&&i.version===2,s=!n&&i.constructor.tag===l.packet.aeadEncryptedData;if(!n&&!s)throw Error("Unexpected packet type");const a=jt(i.aeadAlgorithm,s),o=e==="decrypt"?a.tagLength:0,c=e==="encrypt"?a.tagLength:0,u=2**(i.chunkSizeByte+6)+o,f=s?8:0,h=new ArrayBuffer(13+f),y=new Uint8Array(h,0,5+f),g=new Uint8Array(h),p=new DataView(h),w=new Uint8Array(h,5,8);y.set([192|i.constructor.tag,i.version,i.cipherAlgorithm,i.aeadAlgorithm,i.chunkSizeByte],0);let A,m,v=0,E=Promise.resolve(),k=0,U=0;if(n){const{keySize:P}=oe(i.cipherAlgorithm),{ivLength:I}=a,b=new Uint8Array(h,0,5),K=await Ar(l.hash.sha256,r,i.salt,b,P+I);r=K.subarray(0,P),A=K.subarray(P),A.fill(0,A.length-8),m=new DataView(A.buffer,A.byteOffset,A.byteLength)}else A=i.iv;const Q=await a(i.cipherAlgorithm,r);return _t(t,(async(P,I)=>{if(d.isStream(P)!=="array"){const B=new TransformStream({},{highWaterMark:d.getHardwareConcurrency()*2**(i.chunkSizeByte+6),size:S=>S.length});pr(B.readable,I),I=B.writable}const b=Vt(P),K=et(I);try{for(;;){let B=await b.readBytes(u+o)||new Uint8Array;const S=B.subarray(B.length-o);let C,D,R;if(B=B.subarray(0,B.length-o),n)R=A;else{R=A.slice();for(let x=0;x<8;x++)R[A.length-8+x]^=w[x]}if(!v||B.length?(b.unshift(S),C=Q[e](B,R,y),C.catch((()=>{})),U+=B.length-o+c):(p.setInt32(5+f+4,k),C=Q[e](S,R,g),C.catch((()=>{})),U+=c,D=!0),k+=B.length-o,E=E.then((()=>C)).then((async x=>{await K.ready,await K.write(x),U-=x.length})).catch((x=>K.abort(x))),(D||U>K.desiredSize)&&await E,D){await K.close();break}n?m.setInt32(A.length-4,++v):p.setInt32(9,++v)}}catch(B){await K.ready.catch((()=>{})),await K.abort(B)}}))}const ku=d.constructAllowedPackets([mr,Wi,at,Ie]);class Eu{static get tag(){return l.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=l.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(e){await Jn(e,(async r=>{const t=await r.readByte();if(t!==1)throw new ne(`Version ${t} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await r.readByte(),this.aeadAlgorithm=await r.readByte(),this.chunkSizeByte=await r.readByte();const n=jt(this.aeadAlgorithm,!0);this.iv=await r.readBytes(n.ivLength),this.encrypted=r.remainder()}))}write(){return d.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(e,r,t=G){this.packets=await re.fromBinary(await Gn(this,"decrypt",r,Qr(this.encrypted)),ku,t,new fs)}async encrypt(e,r,t=G){this.cipherAlgorithm=e;const{ivLength:n}=jt(this.aeadAlgorithm,!0);this.iv=Pe(n),this.chunkSizeByte=t.aeadChunkSizeByte;const s=this.packets.write();this.encrypted=await Gn(this,"encrypt",r,s)}}class qi{static get tag(){return l.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Pt,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:r,anonymousRecipient:t,sessionKey:n,sessionKeyAlgorithm:s}){const a=new qi;if(e!==3&&e!==6)throw Error("Unsupported PKESK version");return a.version=e,e===6&&(a.publicKeyVersion=t?null:r.version,a.publicKeyFingerprint=t?null:r.getFingerprintBytes()),a.publicKeyID=t?Pt.wildcard():r.getKeyID(),a.publicKeyAlgorithm=r.algorithm,a.sessionKey=n,a.sessionKeyAlgorithm=s,a}read(e){let r=0;if(this.version=e[r++],this.version!==3&&this.version!==6)throw new ne(`Version ${this.version} of the PKESK packet is unsupported.`);if(this.version===6){const t=e[r++];if(t){this.publicKeyVersion=e[r++];const n=t-1;this.publicKeyFingerprint=e.subarray(r,r+n),r+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Pt.wildcard()}else r+=this.publicKeyID.read(e.subarray(r,r+8));if(this.publicKeyAlgorithm=e[r++],this.encrypted=(function(t,n){let s=0;switch(t){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:return{c:d.readMPI(n.subarray(s))};case l.publicKey.elgamal:{const a=d.readMPI(n.subarray(s));return s+=a.length+2,{c1:a,c2:d.readMPI(n.subarray(s))}}case l.publicKey.ecdh:{const a=d.readMPI(n.subarray(s));s+=a.length+2;const o=new D1;return o.read(n.subarray(s)),{V:a,C:o}}case l.publicKey.x25519:case l.publicKey.x448:{const a=Jr(t),o=d.readExactSubarray(n,s,s+a);s+=o.length;const c=new as;return c.read(n.subarray(s)),{ephemeralPublicKey:o,C:c}}default:throw new ne("Unknown public key encryption algorithm.")}})(this.publicKeyAlgorithm,e.subarray(r)),this.publicKeyAlgorithm===l.publicKey.x25519||this.publicKeyAlgorithm===l.publicKey.x448){if(this.version===3)this.sessionKeyAlgorithm=l.write(l.symmetric,this.encrypted.C.algorithm);else if(this.encrypted.C.algorithm!==null)throw Error("Unexpected cleartext symmetric algorithm")}}write(){const e=[new Uint8Array([this.version])];return this.version===6?this.publicKeyFingerprint!==null?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),ai(this.publicKeyAlgorithm,this.encrypted)),d.concatUint8Array(e)}async encrypt(e){const r=l.write(l.publicKey,this.publicKeyAlgorithm),t=this.version===3?this.sessionKeyAlgorithm:null,n=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=No(this.version,r,t,this.sessionKey);this.encrypted=await H3(r,t,e.publicParams,s,n)}async decrypt(e,r){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const t=r?No(this.version,this.publicKeyAlgorithm,r.sessionKeyAlgorithm,r.sessionKey):null,n=e.version===5?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),s=await z3(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,n,t),{sessionKey:a,sessionKeyAlgorithm:o}=(function(c,u,f,h){switch(u){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:{const y=f.subarray(0,f.length-2),g=f.subarray(f.length-2),p=d.writeChecksum(y.subarray(y.length%8)),w=p[0]===g[0]&p[1]===g[1],A=c===6?{sessionKeyAlgorithm:null,sessionKey:y}:{sessionKeyAlgorithm:y[0],sessionKey:y.subarray(1)};if(h){const m=w&A.sessionKeyAlgorithm===h.sessionKeyAlgorithm&A.sessionKey.length===h.sessionKey.length;return{sessionKey:d.selectUint8Array(m,A.sessionKey,h.sessionKey),sessionKeyAlgorithm:c===6?null:d.selectUint8(m,A.sessionKeyAlgorithm,h.sessionKeyAlgorithm)}}if(w&&(c===6||l.read(l.symmetric,A.sessionKeyAlgorithm)))return A;throw Error("Decryption error")}case l.publicKey.x25519:case l.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:f};default:throw Error("Unsupported public key algorithm")}})(this.version,this.publicKeyAlgorithm,s,r);if(this.version===3){const c=this.publicKeyAlgorithm!==l.publicKey.x25519&&this.publicKeyAlgorithm!==l.publicKey.x448;if(this.sessionKeyAlgorithm=c?o:this.sessionKeyAlgorithm,a.length!==oe(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=a}}function No(i,e,r,t){switch(e){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.elgamal:case l.publicKey.ecdh:return d.concatUint8Array([new Uint8Array(i===6?[]:[r]),t,d.writeChecksum(t.subarray(t.length%8))]);case l.publicKey.x25519:case l.publicKey.x448:return t;default:throw Error("Unsupported public key algorithm")}}class ci{static get tag(){return l.packet.symEncryptedSessionKey}constructor(e=G){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=l.write(l.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let r=0;if(this.version=e[r++],this.version!==4&&this.version!==5&&this.version!==6)throw new ne(`Version ${this.version} of the SKESK packet is unsupported.`);this.version===6&&r++;const t=e[r++];this.version>=5&&(this.aeadAlgorithm=e[r++],this.version===6&&r++);const n=e[r++];if(this.s2k=On(n),r+=this.s2k.read(e.subarray(r,e.length)),this.version>=5){const s=jt(this.aeadAlgorithm,!0);this.iv=e.subarray(r,r+=s.ivLength)}this.version>=5||r<e.length?(this.encrypted=e.subarray(r,e.length),this.sessionKeyEncryptionAlgorithm=t):this.sessionKeyAlgorithm=t}write(){const e=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let r;const t=this.s2k.write();if(this.version===6){const n=t.length,s=3+n+this.iv.length;r=d.concatUint8Array([new Uint8Array([this.version,s,e,this.aeadAlgorithm,n]),t,this.iv,this.encrypted])}else this.version===5?r=d.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),t,this.iv,this.encrypted]):(r=d.concatUint8Array([new Uint8Array([this.version,e]),t]),this.encrypted!==null&&(r=d.concatUint8Array([r,this.encrypted])));return r}async decrypt(e){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:t,keySize:n}=oe(r),s=await this.s2k.produceKey(e,n);if(this.version>=5){const a=jt(this.aeadAlgorithm,!0),o=new Uint8Array([192|ci.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=this.version===6?await Ar(l.hash.sha256,s,new Uint8Array,o,n):s,u=await a(r,c);this.sessionKey=await u.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const a=await os(r,s,this.encrypted,new Uint8Array(t));if(this.sessionKeyAlgorithm=l.write(l.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==oe(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=s}async encrypt(e,r=G){const t=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=t,this.s2k=T1(r),this.s2k.generateSalt();const{blockSize:n,keySize:s}=oe(t),a=await this.s2k.produceKey(e,s);if(this.sessionKey===null&&(this.sessionKey=ua(this.sessionKeyAlgorithm)),this.version>=5){const o=jt(this.aeadAlgorithm);this.iv=Pe(o.ivLength);const c=new Uint8Array([192|ci.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),u=this.version===6?await Ar(l.hash.sha256,a,new Uint8Array,c,s):a,f=await o(t,u);this.encrypted=await f.encrypt(this.sessionKey,this.iv,c)}else{const o=d.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await ji(t,a,o,new Uint8Array(n))}}}class St{static get tag(){return l.packet.publicKey}constructor(e=new Date,r=G){this.version=r.v6Keys?6:4,this.created=d.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const r=new St,{version:t,created:n,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=e;return r.version=t,r.created=n,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=c,r}async read(e,r=G){let t=0;if(this.version=e[t++],this.version===5&&!r.enableParsingV5Entities)throw new ne("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(this.version===4||this.version===5||this.version===6){this.created=d.readDate(e.subarray(t,t+4)),t+=4,this.algorithm=e[t++],this.version>=5&&(t+=4);const{read:n,publicParams:s}=(function(a,o){let c=0;switch(a){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:{const u=d.readMPI(o.subarray(c));c+=u.length+2;const f=d.readMPI(o.subarray(c));return c+=f.length+2,{read:c,publicParams:{n:u,e:f}}}case l.publicKey.dsa:{const u=d.readMPI(o.subarray(c));c+=u.length+2;const f=d.readMPI(o.subarray(c));c+=f.length+2;const h=d.readMPI(o.subarray(c));c+=h.length+2;const y=d.readMPI(o.subarray(c));return c+=y.length+2,{read:c,publicParams:{p:u,q:f,g:h,y}}}case l.publicKey.elgamal:{const u=d.readMPI(o.subarray(c));c+=u.length+2;const f=d.readMPI(o.subarray(c));c+=f.length+2;const h=d.readMPI(o.subarray(c));return c+=h.length+2,{read:c,publicParams:{p:u,g:f,y:h}}}case l.publicKey.ecdsa:{const u=new Gt;c+=u.read(o),Is(u);const f=d.readMPI(o.subarray(c));return c+=f.length+2,{read:c,publicParams:{oid:u,Q:f}}}case l.publicKey.eddsaLegacy:{const u=new Gt;if(c+=u.read(o),Is(u),u.getName()!==l.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let f=d.readMPI(o.subarray(c));return c+=f.length+2,f=d.leftPad(f,33),{read:c,publicParams:{oid:u,Q:f}}}case l.publicKey.ecdh:{const u=new Gt;c+=u.read(o),Is(u);const f=d.readMPI(o.subarray(c));c+=f.length+2;const h=new x1;return c+=h.read(o.subarray(c)),{read:c,publicParams:{oid:u,Q:f,kdfParams:h}}}case l.publicKey.ed25519:case l.publicKey.ed448:case l.publicKey.x25519:case l.publicKey.x448:{const u=d.readExactSubarray(o,c,c+Jr(a));return c+=u.length,{read:c,publicParams:{A:u}}}default:throw new ne("Unknown public key encryption algorithm.")}})(this.algorithm,e.subarray(t));if(this.version===6&&s.oid&&(s.oid.getName()===l.curve.curve25519Legacy||s.oid.getName()===l.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=s,t+=n,await this.computeFingerprintAndKeyID(),t}throw new ne(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(d.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const r=ai(this.algorithm,this.publicParams);return this.version>=5&&e.push(d.writeNumber(r.length,4)),e.push(r),d.concatUint8Array(e)}writeForHash(e){const r=this.writePublicKey(),t=149+e,n=e>=5?4:2;return d.concatUint8Array([new Uint8Array([t]),d.writeNumber(r.length,n),r])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Pt,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await xt(l.hash.sha256,e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await xt(l.hash.sha1,e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return d.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&d.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=l.read(l.publicKey,this.algorithm);const r=this.publicParams.n||this.publicParams.p;return r?e.bits=d.uint8ArrayBitLength(r):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}St.prototype.readPublicKey=St.prototype.read,St.prototype.writePublicKey=St.prototype.write;const vu=d.constructAllowedPackets([mr,Wi,at,Ie]);class Bu{static get tag(){return l.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}async decrypt(e,r,t=G){if(!t.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=oe(e),s=await ke(Qr(this.encrypted)),a=await os(e,r,s.subarray(n+2),s.subarray(2,n+2));this.packets=await re.fromBinary(a,vu,t)}async encrypt(e,r,t=G){const n=this.packets.write(),{blockSize:s}=oe(e),a=await Q1(e),o=await ji(e,r,a,new Uint8Array(s)),c=await ji(e,r,n,o.subarray(2));this.encrypted=d.concat([o,c])}}class U5{static get tag(){return l.packet.marker}read(e){return e[0]===80&&e[1]===71&&e[2]===80}write(){return new Uint8Array([80,71,80])}}class ls extends St{static get tag(){return l.packet.publicSubkey}constructor(e,r){super(e,r)}static fromSecretSubkeyPacket(e){const r=new ls,{version:t,created:n,algorithm:s,publicParams:a,keyID:o,fingerprint:c}=e;return r.version=t,r.created=n,r.algorithm=s,r.publicParams=a,r.keyID=o,r.fingerprint=c,r}}class _a{static get tag(){return l.packet.userAttribute}constructor(){this.attributes=[]}read(e){let r=0;for(;r<e.length;){const t=$c(e.subarray(r,e.length));r+=t.offset,this.attributes.push(d.uint8ArrayToString(e.subarray(r,r+t.len))),r+=t.len}}write(){const e=[];for(let r=0;r<this.attributes.length;r++)e.push(Xn(this.attributes[r].length)),e.push(d.stringToUint8Array(this.attributes[r]));return d.concatUint8Array(e)}equals(e){return!!(e&&e instanceof _a)&&this.attributes.every((function(r,t){return r===e.attributes[t]}))}}class Ya extends St{static get tag(){return l.packet.secretKey}constructor(e=new Date,r=G){super(e,r),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(e,r=G){let t=await this.readPublicKey(e,r);const n=t;this.s2kUsage=e[t++],this.version===5&&t++,this.version===6&&this.s2kUsage&&t++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){this.symmetric=e[t++],this.s2kUsage===253&&(this.aead=e[t++]),this.version===6&&t++;const s=e[t++];if(this.s2k=On(s),t+=this.s2k.read(e.subarray(t,e.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=this.s2kUsage===253&&(this.version===5||this.version===4&&r.parseAEADEncryptedV4KeysAsLegacy),this.s2kUsage!==253||this.isLegacyAEAD?(this.iv=e.subarray(t,t+oe(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=e.subarray(t,t+jt(this.aead).ivLength),this.usedModernAEAD=!0),t+=this.iv.length)}catch(s){if(!this.s2kUsage)throw s;this.unparseableKeyMaterial=e.subarray(n),this.isEncrypted=!0}if(this.version===5&&(t+=4),this.keyMaterial=e.subarray(t),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let s;if(this.version===6)s=this.keyMaterial;else if(s=this.keyMaterial.subarray(0,-2),!d.equalsUint8Array(d.writeChecksum(s),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{read:a,privateParams:o}=vo(this.algorithm,s,this.publicParams);if(a<s.length)throw Error("Error reading MPIs");this.privateParams=o}catch(a){throw a instanceof ne?a:Error("Error reading MPIs")}}}write(){const e=this.writePublicKey();if(this.unparseableKeyMaterial)return d.concatUint8Array([e,this.unparseableKeyMaterial]);const r=[e];r.push(new Uint8Array([this.s2kUsage]));const t=[];if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){t.push(this.symmetric),this.s2kUsage===253&&t.push(this.aead);const n=this.s2k.write();this.version===6&&t.push(n.length),t.push(...n)}return this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&t.push(...this.iv),(this.version===5||this.version===6&&this.s2kUsage)&&r.push(new Uint8Array([t.length])),r.push(new Uint8Array(t)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=ai(this.algorithm,this.privateParams)),this.version===5&&r.push(d.writeNumber(this.keyMaterial.length,4)),r.push(this.keyMaterial),this.s2kUsage||this.version===6||r.push(d.writeChecksum(this.keyMaterial))),d.concatUint8Array(r)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(e=G){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=On(l.s2k.gnu,e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=l.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(e,r=G){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=T1(r),this.s2k.generateSalt();const t=ai(this.algorithm,this.privateParams);this.symmetric=l.symmetric.aes256;const{blockSize:n}=oe(this.symmetric);if(r.aeadProtect){this.s2kUsage=253,this.aead=r.preferredAEADAlgorithm;const s=jt(this.aead);this.isLegacyAEAD=this.version===5,this.usedModernAEAD=!this.isLegacyAEAD;const a=Qn(this.constructor.tag),o=await Qs(this.version,this.s2k,e,this.symmetric,this.aead,a,this.isLegacyAEAD),c=await s(this.symmetric,o);this.iv=this.isLegacyAEAD?Pe(n):Pe(s.ivLength);const u=this.isLegacyAEAD?new Uint8Array:d.concatUint8Array([a,this.writePublicKey()]);this.keyMaterial=await c.encrypt(t,this.iv.subarray(0,s.ivLength),u)}else{this.s2kUsage=254,this.usedModernAEAD=!1;const s=await Qs(this.version,this.s2k,e,this.symmetric);this.iv=Pe(n),this.keyMaterial=await ji(this.symmetric,s,d.concatUint8Array([t,await xt(l.hash.sha1,t)]),this.iv)}}async decrypt(e){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let r;const t=Qn(this.constructor.tag);if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");let n;if(r=await Qs(this.version,this.s2k,e,this.symmetric,this.aead,t,this.isLegacyAEAD),this.s2kUsage===253){const s=jt(this.aead,!0),a=await s(this.symmetric,r);try{const o=this.isLegacyAEAD?new Uint8Array:d.concatUint8Array([t,this.writePublicKey()]);n=await a.decrypt(this.keyMaterial,this.iv.subarray(0,s.ivLength),o)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{const s=await os(this.symmetric,r,this.keyMaterial,this.iv);n=s.subarray(0,-20);const a=await xt(l.hash.sha1,n);if(!d.equalsUint8Array(a,s.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:s}=vo(this.algorithm,n,this.publicParams);this.privateParams=s}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");if(this.usedModernAEAD)return;let e;try{e=await j3(this.algorithm,this.publicParams,this.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")}async generate(e,r){if(this.version===6&&(this.algorithm===l.publicKey.ecdh&&r===l.curve.curve25519Legacy||this.algorithm===l.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${r}. Generate a key of type 'curve25519' instead`);const{privateParams:t,publicParams:n}=await G3(this.algorithm,e,r);this.privateParams=t,this.publicParams=n,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach((e=>{this.privateParams[e].fill(0),delete this.privateParams[e]})),this.privateParams=null,this.isEncrypted=!0)}}async function Qs(i,e,r,t,n,s,a){if(e.type==="argon2"&&!n)throw Error("Using Argon2 S2K without AEAD is not allowed");if(e.type==="simple"&&i===6)throw Error("Using Simple S2K with version 6 keys is not allowed");const{keySize:o}=oe(t),c=await e.produceKey(r,o);if(!n||i===5||a)return c;const u=d.concatUint8Array([s,new Uint8Array([i,t,n])]);return Ar(l.hash.sha256,c,new Uint8Array,u,o)}class ys{static get tag(){return l.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(d.isString(e)||e.name&&!d.isString(e.name)||e.email&&!d.isEmailAddress(e.email)||e.comment&&!d.isString(e.comment))throw Error("Invalid user ID format");const r=new ys;Object.assign(r,e);const t=[];return r.name&&t.push(r.name),r.comment&&t.push(`(${r.comment})`),r.email&&t.push(`<${r.email}>`),r.userID=t.join(" "),r}read(e,r=G){const t=d.decodeUTF8(e);if(t.length>r.maxUserIDLength)throw Error("User ID string is too long");const n=o=>/^[^\s@]+@[^\s@]+$/.test(o),s=t.indexOf("<"),a=t.lastIndexOf(">");if(s!==-1&&a!==-1&&a>s){const o=t.substring(s+1,a);if(n(o)){this.email=o;const c=t.substring(0,s).trim(),u=c.indexOf("("),f=c.lastIndexOf(")");u!==-1&&f!==-1&&f>u?(this.comment=c.substring(u+1,f).trim(),this.name=c.substring(0,u).trim()):(this.name=c,this.comment="")}}else n(t.trim())&&(this.email=t.trim(),this.name="",this.comment="");this.userID=t}write(){return d.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}}class z1 extends Ya{static get tag(){return l.packet.secretSubkey}constructor(e=new Date,r=G){super(e,r)}}class P5{static get tag(){return l.packet.trust}read(){throw new ne("Trust packets are not supported")}write(){throw new ne("Trust packets are not supported")}}class D5{static get tag(){return l.packet.padding}constructor(){this.padding=null}read(e){}write(){return this.padding}async createPadding(e){this.padding=await Pe(e)}}const Iu=d.constructAllowedPackets([Ie]);class Pr{constructor(e){this.packets=e||new re}write(){return this.packets.write()}armor(e=G){const r=this.packets.some((t=>t.constructor.tag===Ie.tag&&t.version!==6));return yi(l.armor.signature,this.write(),void 0,void 0,void 0,r,e)}getSigningKeyIDs(){return this.packets.map((e=>e.issuerKeyID))}}async function x5({armoredSignature:i,binarySignature:e,config:r,...t}){r={...G,...r};let n=i||e;if(!n)throw Error("readSignature: must pass options object containing `armoredSignature` or `binarySignature`");if(i&&!d.isString(i))throw Error("readSignature: options.armoredSignature must be a string");if(e&&!d.isUint8Array(e))throw Error("readSignature: options.binarySignature must be a Uint8Array");const s=Object.keys(t);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(i){const{type:o,data:c}=await Zt(n);if(o!==l.armor.signature)throw Error("Armored text not of type signature");n=c}const a=await re.fromBinary(n,Iu,r);return new Pr(a)}async function G1(i,e){const r=new z1(i.date,e);return r.packets=null,r.algorithm=l.write(l.publicKey,i.algorithm),await r.generate(i.rsaBits,i.curve),await r.computeFingerprintAndKeyID(),r}async function Su(i,e){const r=new Ya(i.date,e);return r.packets=null,r.algorithm=l.write(l.publicKey,i.algorithm),await r.generate(i.rsaBits,i.curve,i.config),await r.computeFingerprintAndKeyID(),r}async function it(i,e,r,t,n=new Date,s){let a,o;for(let c=i.length-1;c>=0;c--)try{(!a||i[c].created>=a.created)&&(await i[c].verify(e,r,t,n,void 0,s),a=i[c])}catch(u){o=u}if(!a)throw d.wrapError(`Could not find valid ${l.read(l.signature,r)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,((c,u,f)=>u+" "+f.toLowerCase())),o);return a}function Aa(i,e,r=new Date){const t=d.normalizeDate(r);if(t!==null){const n=jn(i,e);return!(i.created<=t&&t<n)}return!1}async function j1(i,e,r,t){const n={};n.key=e,n.bind=i;const s={signatureType:l.signature.subkeyBinding};return r.sign?(s.keyFlags=[l.keyFlags.signData],s.embeddedSignature=await Dt(n,[],i,{signatureType:l.signature.keyBinding},r.date,void 0,void 0,void 0,t)):s.keyFlags=[l.keyFlags.encryptCommunication|l.keyFlags.encryptStorage],r.keyExpirationTime>0&&(s.keyExpirationTime=r.keyExpirationTime,s.keyNeverExpires=!1),await Dt(n,[],e,s,r.date,void 0,void 0,void 0,t)}async function Ku(i,e,r=new Date,t=[],n){const s=l.hash.sha256,a=n.preferredHashAlgorithm,o=await Promise.all(i.map((async(h,y)=>(await h.getPrimarySelfSignature(r,t[y],n)).preferredHashAlgorithms||[]))),c=new Map;for(const h of o)for(const y of h)try{const g=l.write(l.hash,y);c.set(g,c.has(g)?c.get(g)+1:1)}catch{}const u=h=>i.length===0||c.get(h)===i.length||h===s,f=()=>{if(c.size===0)return s;const h=Array.from(c.keys()).filter((y=>u(y))).sort(((y,g)=>ve(y)-ve(g)))[0];return ve(h)>=ve(s)?h:s};if(new Set([l.publicKey.ecdsa,l.publicKey.eddsaLegacy,l.publicKey.ed25519,l.publicKey.ed448]).has(e.algorithm)){const h=(function(p,w){switch(p){case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return m1(w);case l.publicKey.ed25519:case l.publicKey.ed448:return $n(p);default:throw Error("Unknown elliptic signing algo")}})(e.algorithm,e.publicParams.oid),y=u(a),g=ve(a)>=ve(h);if(y&&g)return a;{const p=f();return ve(p)>=ve(h)?p:h}}return u(a)?a:f()}async function Dt(i,e,r,t,n,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new Ie;return Object.assign(u,t),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await Ku(e,r,n,s,c),u.rawNotations=[...a],await u.sign(r,i,n,o,c),u}async function Dr(i,e,r,t=new Date,n){(i=i[r])&&(e[r].length?await Promise.all(i.map((async function(s){s.isExpired(t)||n&&!await n(s)||e[r].some((function(a){return d.equalsUint8Array(a.writeParams(),s.writeParams())}))||e[r].push(s)}))):e[r]=i)}async function ui(i,e,r,t,n,s,a=new Date,o){s=s||i;const c=[];return await Promise.all(t.map((async function(u){try{if(!n||u.issuerKeyID.equals(n.issuerKeyID)){const f=![l.reasonForRevocation.keyRetired,l.reasonForRevocation.keySuperseded,l.reasonForRevocation.userIDInvalid].includes(u.reasonForRevocationFlag);await u.verify(s,e,r,f?null:a,!1,o),c.push(u.issuerKeyID)}}catch{}}))),n?(n.revoked=!!c.some((u=>u.equals(n.issuerKeyID)))||n.revoked||!1,n.revoked):c.length>0}function jn(i,e){let r;return e.keyNeverExpires===!1&&(r=i.created.getTime()+1e3*e.keyExpirationTime),r?new Date(r):1/0}function wa(i,e={}){switch(i.type=i.type||e.type,i.curve=i.curve||e.curve,i.rsaBits=i.rsaBits||e.rsaBits,i.keyExpirationTime=i.keyExpirationTime!==void 0?i.keyExpirationTime:e.keyExpirationTime,i.passphrase=d.isString(i.passphrase)?i.passphrase:e.passphrase,i.date=i.date||e.date,i.sign=i.sign||!1,i.type){case"ecc":try{i.curve=l.write(l.curve,i.curve)}catch{throw Error("Unknown curve")}i.curve!==l.curve.ed25519Legacy&&i.curve!==l.curve.curve25519Legacy&&i.curve!=="ed25519"&&i.curve!=="curve25519"||(i.curve=i.sign?l.curve.ed25519Legacy:l.curve.curve25519Legacy),i.sign?i.algorithm=i.curve===l.curve.ed25519Legacy?l.publicKey.eddsaLegacy:l.publicKey.ecdsa:i.algorithm=l.publicKey.ecdh;break;case"curve25519":i.algorithm=i.sign?l.publicKey.ed25519:l.publicKey.x25519;break;case"curve448":i.algorithm=i.sign?l.publicKey.ed448:l.publicKey.x448;break;case"rsa":i.algorithm=l.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+i.type)}return i}function Oo(i,e,r){switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ed25519:case l.publicKey.ed448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.signData);default:return!1}}function Ho(i,e,r){switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function zo(i,e,r){if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(i.algorithm){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaEncrypt:case l.publicKey.elgamal:case l.publicKey.ecdh:case l.publicKey.x25519:case l.publicKey.x448:return!(!(!e.keyFlags||e.keyFlags[0]&l.keyFlags.signData)||!r.allowInsecureDecryptionWithSigningKeys)||!e.keyFlags||!!(e.keyFlags[0]&l.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&l.keyFlags.encryptStorage);default:return!1}}function ur(i,e){const r=l.write(l.publicKey,i.algorithm),t=i.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(r))throw Error(t.algorithm+" keys are considered too weak.");switch(r){case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.rsaEncrypt:if(t.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:case l.publicKey.ecdh:if(e.rejectCurves.has(t.curve))throw Error(`Support for ${t.algorithm} keys using curve ${t.curve} is disabled.`)}}class Oi{constructor(e,r){this.userID=e.constructor.tag===l.packet.userID?e:null,this.userAttribute=e.constructor.tag===l.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const e=new re;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new Oi(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,r,t){const n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n},a=new Oi(s.userID||s.userAttribute,this.mainKey);return a.otherCertifications=await Promise.all(e.map((async function(o){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const c=await o.getSigningKey(void 0,r,void 0,t);return Dt(s,[o],c.keyPacket,{signatureType:l.signature.certGeneric,keyFlags:[l.keyFlags.certifyKeys|l.keyFlags.signData]},r,void 0,void 0,void 0,t)}))),await a.update(this,r,t),a}async isRevoked(e,r,t=new Date,n=G){const s=this.mainKey.keyPacket;return ui(s,l.signature.certRevocation,{key:s,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,r,t,n)}async verifyCertificate(e,r,t=new Date,n){const s=this,a=this.mainKey.keyPacket,o={userID:this.userID,userAttribute:this.userAttribute,key:a},{issuerKeyID:c}=e,u=r.filter((f=>f.getKeys(c).length>0));return u.length===0?null:(await Promise.all(u.map((async f=>{const h=await f.getSigningKey(c,e.created,void 0,n);if(e.revoked||await s.isRevoked(e,h.keyPacket,t,n))throw Error("User certificate is revoked");try{await e.verify(h.keyPacket,l.signature.certGeneric,o,t,void 0,n)}catch(y){throw d.wrapError("User certificate is invalid",y)}}))),!0)}async verifyAllCertifications(e,r=new Date,t){const n=this,s=this.selfCertifications.concat(this.otherCertifications);return Promise.all(s.map((async a=>({keyID:a.issuerKeyID,valid:await n.verifyCertificate(a,e,r,t).catch((()=>!1))}))))}async verify(e=new Date,r){if(!this.selfCertifications.length)throw Error("No self-certifications found");const t=this,n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n};let a;for(let o=this.selfCertifications.length-1;o>=0;o--)try{const c=this.selfCertifications[o];if(c.revoked||await t.isRevoked(c,void 0,e,r))throw Error("Self-certification is revoked");try{await c.verify(n,l.signature.certGeneric,s,e,void 0,r)}catch(u){throw d.wrapError("Self-certification is invalid",u)}return!0}catch(c){a=c}throw a}async update(e,r,t){const n=this.mainKey.keyPacket,s={userID:this.userID,userAttribute:this.userAttribute,key:n};await Dr(e,this,"selfCertifications",r,(async function(a){try{return await a.verify(n,l.signature.certGeneric,s,r,!1,t),!0}catch{return!1}})),await Dr(e,this,"otherCertifications",r),await Dr(e,this,"revocationSignatures",r,(function(a){return ui(n,l.signature.certRevocation,s,[a],void 0,void 0,r,t)}))}async revoke(e,{flag:r=l.reasonForRevocation.noReason,string:t=""}={},n=new Date,s=G){const a={userID:this.userID,userAttribute:this.userAttribute,key:e},o=new Oi(a.userID||a.userAttribute,this.mainKey);return o.revocationSignatures.push(await Dt(a,[],e,{signatureType:l.signature.certRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,r),reasonForRevocationString:t},n,void 0,void 0,!1,s)),await o.update(this),o}}class hi{constructor(e,r){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const e=new re;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new hi(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,r,t=new Date,n=G){const s=this.mainKey.keyPacket;return ui(s,l.signature.subkeyRevocation,{key:s,bind:this.keyPacket},this.revocationSignatures,e,r,t,n)}async verify(e=new Date,r=G){const t=this.mainKey.keyPacket,n={key:t,bind:this.keyPacket},s=await it(this.bindingSignatures,t,l.signature.subkeyBinding,n,e,r);if(s.revoked||await this.isRevoked(s,null,e,r))throw Error("Subkey is revoked");if(Aa(this.keyPacket,s,e))throw Error("Subkey is expired");return s}async getExpirationTime(e=new Date,r=G){const t=this.mainKey.keyPacket,n={key:t,bind:this.keyPacket};let s;try{s=await it(this.bindingSignatures,t,l.signature.subkeyBinding,n,e,r)}catch{return null}const a=jn(this.keyPacket,s),o=s.getExpirationTime();return a<o?a:o}async update(e,r=new Date,t=G){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===l.packet.publicSubkey&&e.keyPacket.constructor.tag===l.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const s=this,a={key:n,bind:s.keyPacket};await Dr(e,this,"bindingSignatures",r,(async function(o){for(let c=0;c<s.bindingSignatures.length;c++)if(s.bindingSignatures[c].issuerKeyID.equals(o.issuerKeyID))return o.created>s.bindingSignatures[c].created&&(s.bindingSignatures[c]=o),!1;try{return await o.verify(n,l.signature.subkeyBinding,a,r,void 0,t),!0}catch{return!1}})),await Dr(e,this,"revocationSignatures",r,(function(o){return ui(n,l.signature.subkeyRevocation,a,[o],void 0,void 0,r,t)}))}async revoke(e,{flag:r=l.reasonForRevocation.noReason,string:t=""}={},n=new Date,s=G){const a={key:e,bind:this.keyPacket},o=new hi(this.keyPacket,this.mainKey);return o.revocationSignatures.push(await Dt(a,[],e,{signatureType:l.signature.subkeyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,r),reasonForRevocationString:t},n,void 0,void 0,!1,s)),await o.update(this),o}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach((i=>{hi.prototype[i]=function(){return this.keyPacket[i]()}}));const Cu=d.constructAllowedPackets([Ie]),Go=new Set([l.packet.publicKey,l.packet.privateKey]),jo=new Set([l.packet.publicKey,l.packet.privateKey,l.packet.publicSubkey,l.packet.privateSubkey]);class V1{packetListToStructure(e,r=new Set){let t,n,s,a;for(const o of e){if(o instanceof $s){jo.has(o.tag)&&!a&&(a=Go.has(o.tag)?Go:jo);continue}const c=o.constructor.tag;if(a){if(!a.has(c))continue;a=null}if(r.has(c))throw Error("Unexpected packet type: "+c);switch(c){case l.packet.publicKey:case l.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case l.packet.userID:case l.packet.userAttribute:t=new Oi(o,this),this.users.push(t);break;case l.packet.publicSubkey:case l.packet.secretSubkey:t=null,s=new hi(o,this),this.subkeys.push(s);break;case l.packet.signature:switch(o.signatureType){case l.signature.certGeneric:case l.signature.certPersona:case l.signature.certCasual:case l.signature.certPositive:if(!t){d.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(n)?t.selfCertifications.push(o):t.otherCertifications.push(o);break;case l.signature.certRevocation:t?t.revocationSignatures.push(o):this.directSignatures.push(o);break;case l.signature.key:this.directSignatures.push(o);break;case l.signature.subkeyBinding:if(!s){d.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}s.bindingSignatures.push(o);break;case l.signature.keyRevocation:this.revocationSignatures.push(o);break;case l.signature.subkeyRevocation:if(!s){d.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}s.revocationSignatures.push(o)}}}}toPacketList(){const e=new re;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map((r=>e.push(...r.toPacketList()))),this.subkeys.map((r=>e.push(...r.toPacketList()))),e}clone(e=!1){const r=new this.constructor(this.toPacketList());return e&&r.getKeys().forEach((t=>{if(t.keyPacket=Object.create(Object.getPrototypeOf(t.keyPacket),Object.getOwnPropertyDescriptors(t.keyPacket)),!t.keyPacket.isDecrypted())return;const n={};Object.keys(t.keyPacket.privateParams).forEach((s=>{n[s]=new Uint8Array(t.keyPacket.privateParams[s])})),t.keyPacket.privateParams=n})),r}getSubkeys(e=null){return this.subkeys.filter((r=>!e||r.getKeyID().equals(e,!0)))}getKeys(e=null){const r=[];return e&&!this.getKeyID().equals(e,!0)||r.push(this),r.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map((e=>e.getKeyID()))}getUserIDs(){return this.users.map((e=>e.userID?e.userID.userID:null)).filter((e=>e!==null))}write(){return this.toPacketList().write()}async getSigningKey(e=null,r=new Date,t={},n=G){await this.verifyPrimaryKey(r,t,n);const s=this.keyPacket;try{ur(s,n)}catch(c){throw d.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort(((c,u)=>u.keyPacket.created-c.keyPacket.created||u.keyPacket.algorithm-c.keyPacket.algorithm));let o;for(const c of a)if(!e||c.getKeyID().equals(e))try{await c.verify(r,n);const u={key:s,bind:c.keyPacket},f=await it(c.bindingSignatures,s,l.signature.subkeyBinding,u,r,n);if(!Oo(c.keyPacket,f,n))continue;if(!f.embeddedSignature)throw Error("Missing embedded signature");return await it([f.embeddedSignature],c.keyPacket,l.signature.keyBinding,u,r,n),ur(c.keyPacket,n),c}catch(u){o=u}try{const c=await this.getPrimarySelfSignature(r,t,n);if((!e||s.getKeyID().equals(e))&&Oo(s,c,n))return ur(s,n),this}catch(c){o=c}throw d.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)}async getEncryptionKey(e,r=new Date,t={},n=G){await this.verifyPrimaryKey(r,t,n);const s=this.keyPacket;try{ur(s,n)}catch(c){throw d.wrapError("Could not verify primary key",c)}const a=this.subkeys.slice().sort(((c,u)=>u.keyPacket.created-c.keyPacket.created||u.keyPacket.algorithm-c.keyPacket.algorithm));let o;for(const c of a)if(!e||c.getKeyID().equals(e))try{await c.verify(r,n);const u={key:s,bind:c.keyPacket},f=await it(c.bindingSignatures,s,l.signature.subkeyBinding,u,r,n);if(Ho(c.keyPacket,f,n))return ur(c.keyPacket,n),c}catch(u){o=u}try{const c=await this.getPrimarySelfSignature(r,t,n);if((!e||s.getKeyID().equals(e))&&Ho(s,c,n))return ur(s,n),this}catch(c){o=c}throw d.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),o)}async isRevoked(e,r,t=new Date,n=G){return ui(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,r,t,n)}async verifyPrimaryKey(e=new Date,r={},t=G){const n=this.keyPacket;if(await this.isRevoked(null,null,e,t))throw Error("Primary key is revoked");if(Aa(n,await this.getPrimarySelfSignature(e,r,t),e))throw Error("Primary key is expired");if(n.version!==6){const s=await it(this.directSignatures,n,l.signature.key,{key:n},e,t).catch((()=>{}));if(s&&Aa(n,s,e))throw Error("Primary key is expired")}}async getExpirationTime(e,r=G){let t;try{const n=await this.getPrimarySelfSignature(null,e,r),s=jn(this.keyPacket,n),a=n.getExpirationTime(),o=this.keyPacket.version!==6&&await it(this.directSignatures,this.keyPacket,l.signature.key,{key:this.keyPacket},null,r).catch((()=>{}));if(o){const c=jn(this.keyPacket,o);t=Math.min(s,a,c)}else t=s<a?s:a}catch{t=null}return d.normalizeDate(t)}async getPrimarySelfSignature(e=new Date,r={},t=G){const n=this.keyPacket;if(n.version===6)return it(this.directSignatures,n,l.signature.key,{key:n},e,t);const{selfCertification:s}=await this.getPrimaryUser(e,r,t);return s}async getPrimaryUser(e=new Date,r={},t=G){const n=this.keyPacket,s=[];let a;for(let f=0;f<this.users.length;f++)try{const h=this.users[f];if(!h.userID)continue;if(r.name!==void 0&&h.userID.name!==r.name||r.email!==void 0&&h.userID.email!==r.email||r.comment!==void 0&&h.userID.comment!==r.comment)throw Error("Could not find user that matches that user ID");const y={userID:h.userID,key:n},g=await it(h.selfCertifications,n,l.signature.certGeneric,y,e,t);s.push({index:f,user:h,selfCertification:g})}catch(h){a=h}if(!s.length)throw a||Error("Could not find primary user");await Promise.all(s.map((async function(f){return f.selfCertification.revoked||f.user.isRevoked(f.selfCertification,null,e,t)})));const o=s.sort((function(f,h){const y=f.selfCertification,g=h.selfCertification;return g.revoked-y.revoked||y.isPrimaryUserID-g.isPrimaryUserID||y.created-g.created})).pop(),{user:c,selfCertification:u}=o;if(u.revoked||await c.isRevoked(u,null,e,t))throw Error("Primary user is revoked");return o}async update(e,r=new Date,t=G){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(!(this.subkeys.length===e.subkeys.length&&this.subkeys.every((s=>e.subkeys.some((a=>s.hasSameFingerprintAs(a)))))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,t)}const n=this.clone();return await Dr(e,n,"revocationSignatures",r,(s=>ui(n.keyPacket,l.signature.keyRevocation,n,[s],null,e.keyPacket,r,t))),await Dr(e,n,"directSignatures",r),await Promise.all(e.users.map((async s=>{const a=n.users.filter((o=>s.userID&&s.userID.equals(o.userID)||s.userAttribute&&s.userAttribute.equals(o.userAttribute)));if(a.length>0)await Promise.all(a.map((o=>o.update(s,r,t))));else{const o=s.clone();o.mainKey=n,n.users.push(o)}}))),await Promise.all(e.subkeys.map((async s=>{const a=n.subkeys.filter((o=>o.hasSameFingerprintAs(s)));if(a.length>0)await Promise.all(a.map((o=>o.update(s,r,t))));else{const o=s.clone();o.mainKey=n,n.subkeys.push(o)}}))),n}async getRevocationCertificate(e=new Date,r=G){const t={key:this.keyPacket},n=await it(this.revocationSignatures,this.keyPacket,l.signature.keyRevocation,t,e,r),s=new re;s.push(n);const a=this.keyPacket.version!==6;return yi(l.armor.publicKey,s.write(),null,null,"This is a revocation certificate",a,r)}async applyRevocationCertificate(e,r=new Date,t=G){const n=await Zt(e),s=(await re.fromBinary(n.data,Cu,t)).findPacket(l.packet.signature);if(!s||s.signatureType!==l.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!s.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await s.verify(this.keyPacket,l.signature.keyRevocation,{key:this.keyPacket},r,void 0,t)}catch(o){throw d.wrapError("Could not verify revocation signature",o)}const a=this.clone();return a.revocationSignatures.push(s),a}async signPrimaryUser(e,r,t,n=G){const{index:s,user:a}=await this.getPrimaryUser(r,t,n),o=await a.certify(e,r,n),c=this.clone();return c.users[s]=o,c}async signAllUsers(e,r=new Date,t=G){const n=this.clone();return n.users=await Promise.all(this.users.map((function(s){return s.certify(e,r,t)}))),n}async verifyPrimaryUser(e,r=new Date,t,n=G){const s=this.keyPacket,{user:a}=await this.getPrimaryUser(r,t,n);return e?await a.verifyAllCertifications(e,r,n):[{keyID:s.getKeyID(),valid:await a.verify(r,n).catch((()=>!1))}]}async verifyAllUsers(e,r=new Date,t=G){const n=this.keyPacket,s=[];return await Promise.all(this.users.map((async a=>{const o=e?await a.verifyAllCertifications(e,r,t):[{keyID:n.getKeyID(),valid:await a.verify(r,t).catch((()=>!1))}];s.push(...o.map((c=>({userID:a.userID?a.userID.userID:null,userAttribute:a.userAttribute,keyID:c.keyID,valid:c.valid}))))}))),s}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach((i=>{V1.prototype[i]=hi.prototype[i]}));class ma extends V1{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([l.packet.secretKey,l.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=G){const r=this.keyPacket.version!==6;return yi(l.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}}class gi extends ma{constructor(e){if(super(),this.packetListToStructure(e,new Set([l.packet.publicKey,l.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const e=new re,r=this.toPacketList();for(const t of r)switch(t.constructor.tag){case l.packet.secretKey:{const n=St.fromSecretKeyPacket(t);e.push(n);break}case l.packet.secretSubkey:{const n=ls.fromSecretSubkeyPacket(t);e.push(n);break}default:e.push(t)}return new ma(e)}armor(e=G){const r=this.keyPacket.version!==6;return yi(l.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,r,e)}async getDecryptionKeys(e,r=new Date,t={},n=G){const s=this.keyPacket,a=[];let o=null;for(let u=0;u<this.subkeys.length;u++)if(!e||this.subkeys[u].getKeyID().equals(e,!0)){if(this.subkeys[u].keyPacket.isDummy()){o=o||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{const f={key:s,bind:this.subkeys[u].keyPacket},h=await it(this.subkeys[u].bindingSignatures,s,l.signature.subkeyBinding,f,r,n);zo(this.subkeys[u].keyPacket,h,n)&&a.push(this.subkeys[u])}catch(f){o=f}}const c=await this.getPrimarySelfSignature(r,t,n);if(e&&!s.getKeyID().equals(e,!0)||!zo(s,c,n)||(s.isDummy()?o=o||Error("Gnu-dummy key packets cannot be used for decryption"):a.push(this)),a.length===0)throw o||Error("No decryption key packets found");return a}isDecrypted(){return this.getKeys().some((({keyPacket:e})=>e.isDecrypted()))}async validate(e=G){if(!this.isPrivate())throw Error("Cannot validate a public key");let r;if(this.keyPacket.isDummy()){const t=await this.getSigningKey(null,null,void 0,{...e,rejectPublicKeyAlgorithms:new Set,minRSABits:0});t&&!t.keyPacket.isDummy()&&(r=t.keyPacket)}else r=this.keyPacket;if(r)return r.validate();{const t=this.getKeys();if(t.map((n=>n.keyPacket.isDummy())).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(t.map((async n=>n.keyPacket.validate())))}}clearPrivateParams(){this.getKeys().forEach((({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()}))}async revoke({flag:e=l.reasonForRevocation.noReason,string:r=""}={},t=new Date,n=G){if(!this.isPrivate())throw Error("Need private key for revoking");const s={key:this.keyPacket},a=this.clone();return a.revocationSignatures.push(await Dt(s,[],this.keyPacket,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.write(l.reasonForRevocation,e),reasonForRevocationString:r},t,void 0,void 0,void 0,n)),a}async addSubkey(e={}){const r={...G,...e.config};if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<r.minRSABits)throw Error(`rsaBits should be at least ${r.minRSABits}, got: ${e.rsaBits}`);const t=this.keyPacket;if(t.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!t.isDecrypted())throw Error("Key is not decrypted");const n=t.getAlgorithmInfo();n.type=(function(c){switch(l.write(l.publicKey,c)){case l.publicKey.rsaEncrypt:case l.publicKey.rsaEncryptSign:case l.publicKey.rsaSign:case l.publicKey.dsa:return"rsa";case l.publicKey.ecdsa:case l.publicKey.eddsaLegacy:return"ecc";case l.publicKey.ed25519:return"curve25519";case l.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}})(n.algorithm),n.rsaBits=n.bits||4096,n.curve=n.curve||"curve25519Legacy",e=wa(e,n);const s=await G1(e,{...r,v6Keys:this.keyPacket.version===6});ur(s,r);const a=await j1(s,t,e,r),o=this.toPacketList();return o.push(s,a),new gi(o)}}const gs=d.constructAllowedPackets([St,ls,Ya,z1,ys,_a,Ie]);function q1(i){for(const e of i)switch(e.constructor.tag){case l.packet.secretKey:return new gi(i);case l.packet.publicKey:return new ma(i)}throw Error("No key packet found")}async function _1(i,e,r,t){r.passphrase&&await i.encrypt(r.passphrase,t),await Promise.all(e.map((async function(c,u){const f=r.subkeys[u].passphrase;f&&await c.encrypt(f,t)})));const n=new re;function s(c,u){return[u,...c.filter((f=>f!==u))]}function a(){const c={};c.keyFlags=[l.keyFlags.certifyKeys|l.keyFlags.signData];const u=s([l.symmetric.aes256,l.symmetric.aes128],t.preferredSymmetricAlgorithm);if(c.preferredSymmetricAlgorithms=u,t.aeadProtect){const f=s([l.aead.gcm,l.aead.eax,l.aead.ocb],t.preferredAEADAlgorithm);c.preferredCipherSuites=f.flatMap((h=>u.map((y=>[y,h]))))}return c.preferredHashAlgorithms=s([l.hash.sha512,l.hash.sha256,l.hash.sha3_512,l.hash.sha3_256],t.preferredHashAlgorithm),c.preferredCompressionAlgorithms=s([l.compression.uncompressed,l.compression.zlib,l.compression.zip],t.preferredCompressionAlgorithm),c.features=[0],c.features[0]|=l.features.modificationDetection,t.aeadProtect&&(c.features[0]|=l.features.seipdv2),r.keyExpirationTime>0&&(c.keyExpirationTime=r.keyExpirationTime,c.keyNeverExpires=!1),c}if(n.push(i),i.version===6){const c={key:i},u=a();u.signatureType=l.signature.key;const f=await Dt(c,[],i,u,r.date,void 0,void 0,void 0,t);n.push(f)}await Promise.all(r.userIDs.map((async function(c,u){const f=ys.fromObject(c),h={userID:f,key:i},y=i.version!==6?a():{};return y.signatureType=l.signature.certPositive,u===0&&(y.isPrimaryUserID=!0),{userIDPacket:f,signaturePacket:await Dt(h,[],i,y,r.date,void 0,void 0,void 0,t)}}))).then((c=>{c.forEach((({userIDPacket:u,signaturePacket:f})=>{n.push(u),n.push(f)}))})),await Promise.all(e.map((async function(c,u){const f=r.subkeys[u];return{secretSubkeyPacket:c,subkeySignaturePacket:await j1(c,i,f,t)}}))).then((c=>{c.forEach((({secretSubkeyPacket:u,subkeySignaturePacket:f})=>{n.push(u),n.push(f)}))}));const o={key:i};return n.push(await Dt(o,[],i,{signatureType:l.signature.keyRevocation,reasonForRevocationFlag:l.reasonForRevocation.noReason,reasonForRevocationString:""},r.date,void 0,void 0,void 0,t)),r.passphrase&&i.clearPrivateParams(),await Promise.all(e.map((async function(c,u){r.subkeys[u].passphrase&&c.clearPrivateParams()}))),new gi(n)}async function Q5({armoredKey:i,binaryKey:e,config:r,...t}){if(r={...G,...r},!i&&!e)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(i&&!d.isString(i))throw Error("readKey: options.armoredKey must be a string");if(e&&!d.isUint8Array(e))throw Error("readKey: options.binaryKey must be a Uint8Array");const n=Object.keys(t);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(i){const{type:c,data:u}=await Zt(i);if(c!==l.armor.publicKey&&c!==l.armor.privateKey)throw Error("Armored text not of type key");s=u}else s=e;const a=await re.fromBinary(s,gs,r),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);if(o.length===0)throw Error("No key packet found");return q1(a.slice(o[0],o[1]))}async function R5({armoredKey:i,binaryKey:e,config:r,...t}){if(r={...G,...r},!i&&!e)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(i&&!d.isString(i))throw Error("readPrivateKey: options.armoredKey must be a string");if(e&&!d.isUint8Array(e))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const n=Object.keys(t);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let s;if(i){const{type:c,data:u}=await Zt(i);if(c!==l.armor.privateKey)throw Error("Armored text not of type private key");s=u}else s=e;const a=await re.fromBinary(s,gs,r),o=a.indexOfTag(l.packet.publicKey,l.packet.secretKey);for(let c=0;c<o.length;c++){if(a[o[c]].constructor.tag===l.packet.publicKey)continue;const u=a.slice(o[c],o[c+1]);return new gi(u)}throw Error("No secret key packet found")}async function T5({armoredKeys:i,binaryKeys:e,config:r,...t}){r={...G,...r};let n=i||e;if(!n)throw Error("readKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(i&&!d.isString(i))throw Error("readKeys: options.armoredKeys must be a string");if(e&&!d.isUint8Array(e))throw Error("readKeys: options.binaryKeys must be a Uint8Array");const s=Object.keys(t);if(s.length>0)throw Error("Unknown option: "+s.join(", "));if(i){const{type:u,data:f}=await Zt(i);if(u!==l.armor.publicKey&&u!==l.armor.privateKey)throw Error("Armored text not of type key");n=f}const a=[],o=await re.fromBinary(n,gs,r),c=o.indexOfTag(l.packet.publicKey,l.packet.secretKey);if(c.length===0)throw Error("No key packet found");for(let u=0;u<c.length;u++){const f=q1(o.slice(c[u],c[u+1]));a.push(f)}return a}async function M5({armoredKeys:i,binaryKeys:e,config:r}){r={...G,...r};let t=i||e;if(!t)throw Error("readPrivateKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(i&&!d.isString(i))throw Error("readPrivateKeys: options.armoredKeys must be a string");if(e&&!d.isUint8Array(e))throw Error("readPrivateKeys: options.binaryKeys must be a Uint8Array");if(i){const{type:o,data:c}=await Zt(i);if(o!==l.armor.privateKey)throw Error("Armored text not of type private key");t=c}const n=[],s=await re.fromBinary(t,gs,r),a=s.indexOfTag(l.packet.publicKey,l.packet.secretKey);for(let o=0;o<a.length;o++){if(s[a[o]].constructor.tag===l.packet.publicKey)continue;const c=s.slice(a[o],a[o+1]),u=new gi(c);n.push(u)}if(n.length===0)throw Error("No secret key packet found");return n}const Uu=d.constructAllowedPackets([mr,Wi,Eu,oi,Bu,qi,ci,at,Ie]),Pu=d.constructAllowedPackets([ci]),Du=d.constructAllowedPackets([Ie]);class Le{constructor(e){this.packets=e||new re}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey).forEach((function(r){e.push(r.publicKeyID)})),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),r=e.packets.filterByTag(l.packet.onePassSignature);return r.length>0?r.map((t=>t.issuerKeyID)):e.packets.filterByTag(l.packet.signature).map((t=>t.issuerKeyID))}async decrypt(e,r,t,n=new Date,s=G){const a=this.packets.filterByTag(l.packet.symmetricallyEncryptedData,l.packet.symEncryptedIntegrityProtectedData,l.packet.aeadEncryptedData);if(a.length===0)throw Error("No encrypted data found");const o=a[0],c=o.cipherAlgorithm,u=t||await this.decryptSessionKeys(e,r,c,n,s);let f=null;const h=Promise.all(u.map((async({algorithm:g,data:p})=>{if(!d.isUint8Array(p)||!o.cipherAlgorithm&&!d.isString(g))throw Error("Invalid session key for decryption.");try{const w=o.cipherAlgorithm||l.write(l.symmetric,g);await o.decrypt(w,p,s)}catch(w){d.printDebugError(w),f=w}})));if(Zs(o.encrypted),o.encrypted=null,await h,!o.packets||!o.packets.length)throw f||Error("Decryption failed.");const y=new Le(o.packets);return o.packets=new re,y}async decryptSessionKeys(e,r,t,n=new Date,s=G){let a,o=[];if(r){const c=this.packets.filterByTag(l.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(r.map((async function(u,f){let h;h=f?await re.fromBinary(c.write(),Pu,s):c,await Promise.all(h.map((async function(y){try{await y.decrypt(u),o.push(y)}catch(g){d.printDebugError(g),g instanceof cs&&(a=g)}})))})))}else{if(!e)throw Error("No key or password specified.");{const c=this.packets.filterByTag(l.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(c.map((async function(u){await Promise.all(e.map((async function(f){let h;try{h=(await f.getDecryptionKeys(u.publicKeyID,null,void 0,s)).map((g=>g.keyPacket))}catch(g){return void(a=g)}let y=[l.symmetric.aes256,l.symmetric.aes128,l.symmetric.tripledes,l.symmetric.cast5];try{const g=await f.getPrimarySelfSignature(n,void 0,s);g.preferredSymmetricAlgorithms&&(y=y.concat(g.preferredSymmetricAlgorithms))}catch{}await Promise.all(h.map((async function(g){if(!g.isDecrypted())throw Error("Decryption key is not decrypted.");if(s.constantTimePKCS1Decryption&&(u.publicKeyAlgorithm===l.publicKey.rsaEncrypt||u.publicKeyAlgorithm===l.publicKey.rsaEncryptSign||u.publicKeyAlgorithm===l.publicKey.rsaSign||u.publicKeyAlgorithm===l.publicKey.elgamal)){const p=u.write();await Promise.all((t?[t]:Array.from(s.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map((async w=>{const A=new qi;A.read(p);const m={sessionKeyAlgorithm:w,sessionKey:ua(w)};try{await A.decrypt(g,m),o.push(A)}catch(v){d.printDebugError(v),a=v}})))}else try{await u.decrypt(g);const p=t||u.sessionKeyAlgorithm;if(p&&!y.includes(l.write(l.symmetric,p)))throw Error("A non-preferred symmetric algorithm was used.");o.push(u)}catch(p){d.printDebugError(p),a=p}})))}))),Zs(u.encrypted),u.encrypted=null})))}}if(o.length>0){if(o.length>1){const c=new Set;o=o.filter((u=>{const f=u.sessionKeyAlgorithm+d.uint8ArrayToString(u.sessionKey);return!c.has(f)&&(c.add(f),!0)}))}return o.map((c=>({data:c.sessionKey,algorithm:c.sessionKeyAlgorithm&&l.read(l.symmetric,c.sessionKeyAlgorithm)})))}throw a||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(l.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],r=new Date,t=[],n=G){const{symmetricAlgo:s,aeadAlgo:a}=await(async function(u=[],f=new Date,h=[],y=G){const g=await Promise.all(u.map(((A,m)=>A.getPrimarySelfSignature(f,h[m],y))));if(u.length?g.every((A=>A.features&&A.features[0]&l.features.seipdv2)):y.aeadProtect){const A={symmetricAlgo:l.symmetric.aes128,aeadAlgo:l.aead.ocb},m=[{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:y.preferredAEADAlgorithm},{symmetricAlgo:y.preferredSymmetricAlgorithm,aeadAlgo:l.aead.ocb},{symmetricAlgo:l.symmetric.aes128,aeadAlgo:y.preferredAEADAlgorithm}];for(const v of m)if(g.every((E=>E.preferredCipherSuites&&E.preferredCipherSuites.some((k=>k[0]===v.symmetricAlgo&&k[1]===v.aeadAlgo)))))return v;return A}const p=l.symmetric.aes128,w=y.preferredSymmetricAlgorithm;return{symmetricAlgo:g.every((A=>A.preferredSymmetricAlgorithms&&A.preferredSymmetricAlgorithms.includes(w)))?w:p,aeadAlgo:void 0}})(e,r,t,n),o=l.read(l.symmetric,s),c=a?l.read(l.aead,a):void 0;return await Promise.all(e.map((u=>u.getEncryptionKey().catch((()=>null)).then((f=>{if(f&&(f.keyPacket.algorithm===l.publicKey.x25519||f.keyPacket.algorithm===l.publicKey.x448)&&!c&&!d.isAES(s))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))))),{data:ua(s),algorithm:o,aeadAlgorithm:c}}async encrypt(e,r,t,n=!1,s=[],a=new Date,o=[],c=G){if(t){if(!d.isUint8Array(t.data)||!d.isString(t.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)t=await Le.generateSessionKey(e,a,o,c);else{if(!r||!r.length)throw Error("No keys, passwords, or session key provided.");t=await Le.generateSessionKey(void 0,void 0,void 0,c)}const{data:u,algorithm:f,aeadAlgorithm:h}=t,y=await Le.encryptSessionKey(u,f,h,e,r,n,s,a,o,c),g=oi.fromObject({version:h?2:1,aeadAlgorithm:h?l.write(l.aead,h):null});g.packets=this.packets;const p=l.write(l.symmetric,f);return await g.encrypt(p,u,c),y.packets.push(g),g.packets=new re,y}static async encryptSessionKey(e,r,t,n,s,a=!1,o=[],c=new Date,u=[],f=G){const h=new re,y=l.write(l.symmetric,r),g=t&&l.write(l.aead,t);if(n){const p=await Promise.all(n.map((async function(w,A){const m=await w.getEncryptionKey(o[A],c,u,f),v=qi.fromObject({version:g?6:3,encryptionKeyPacket:m.keyPacket,anonymousRecipient:a,sessionKey:e,sessionKeyAlgorithm:y});return await v.encrypt(m.keyPacket),delete v.sessionKey,v})));h.push(...p)}if(s){const p=async function(v,E){try{return await v.decrypt(E),1}catch{return 0}},w=(v,E)=>v+E,A=async function(v,E,k,U){const Q=new ci(f);return Q.sessionKey=v,Q.sessionKeyAlgorithm=E,k&&(Q.aeadAlgorithm=k),await Q.encrypt(U,f),f.passwordCollisionCheck&&(await Promise.all(s.map((P=>p(Q,P))))).reduce(w)!==1?A(v,E,U):(delete Q.sessionKey,Q)},m=await Promise.all(s.map((v=>A(e,y,g,v))));h.push(...m)}return new Le(h)}async sign(e=[],r=[],t=null,n=[],s=new Date,a=[],o=[],c=[],u=G){const f=new re,h=this.packets.findPacket(l.packet.literalData);if(!h)throw Error("No literal data packet to sign.");const y=await ba(h,e,r,t,n,s,a,o,c,!1,u),g=y.map(((p,w)=>at.fromSignaturePacket(p,w===0))).reverse();return f.push(...g),f.push(h),f.push(...y),new Le(f)}compress(e,r=G){if(e===l.compression.uncompressed)return this;const t=new Wi(r);t.algorithm=e,t.packets=this.packets;const n=new re;return n.push(t),new Le(n)}async signDetached(e=[],r=[],t=null,n=[],s=[],a=new Date,o=[],c=[],u=G){const f=this.packets.findPacket(l.packet.literalData);if(!f)throw Error("No literal data packet to sign.");return new Pr(await ba(f,e,r,t,n,s,a,o,c,!0,u))}async verify(e,r=new Date,t=G){const n=this.unwrapCompressed(),s=n.packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");let a=n.packets;Ee(a.stream)&&(a=a.concat(await ke(a.stream,(u=>u||[]))));const o=a.filterByTag(l.packet.onePassSignature).reverse(),c=a.filterByTag(l.packet.signature);return o.length&&!c.length&&d.isStream(a.stream)&&!Ee(a.stream)?(await Promise.all(o.map((async u=>{u.correspondingSig=new Promise(((f,h)=>{u.correspondingSigResolve=f,u.correspondingSigReject=h})),u.signatureData=Yt((async()=>(await u.correspondingSig).signatureData)),u.hashed=ke(await u.hash(u.signatureType,s[0],void 0,!1)),u.hashed.catch((()=>{}))}))),a.stream=_t(a.stream,(async(u,f)=>{const h=Vt(u),y=et(f);try{for(let g=0;g<o.length;g++){const{value:p}=await h.read();o[g].correspondingSigResolve(p)}await h.readToEnd(),await y.ready,await y.close()}catch(g){o.forEach((p=>{p.correspondingSigReject(g)})),await y.abort(g)}})),Cn(o,s,e,r,!1,t)):Cn(c,s,e,r,!1,t)}verifyDetached(e,r,t=new Date,n=G){const s=this.unwrapCompressed().packets.filterByTag(l.packet.literalData);if(s.length!==1)throw Error("Can only verify message with one literal data packet.");return Cn(e.packets.filterByTag(l.packet.signature),s,r,t,!0,n)}unwrapCompressed(){const e=this.packets.filterByTag(l.packet.compressedData);return e.length?new Le(e[0].packets):this}async appendSignature(e,r=G){await this.packets.read(d.isUint8Array(e)?e:(await Zt(e)).data,Du,r)}write(){return this.packets.write()}armor(e=G){const r=this.packets[this.packets.length-1],t=r.constructor.tag===oi.tag?r.version!==2:this.packets.some((n=>n.constructor.tag===Ie.tag&&n.version!==6));return yi(l.armor.message,this.write(),null,null,null,t,e)}}async function ba(i,e,r=[],t=null,n=[],s=new Date,a=[],o=[],c=[],u=!1,f=G){const h=new re,y=i.text===null?l.signature.binary:l.signature.text;if(await Promise.all(e.map((async(g,p)=>{const w=a[p];if(!g.isPrivate())throw Error("Need private key for signing");const A=await g.getSigningKey(n[p],s,w,f);return Dt(i,r.length?r:[g],A.keyPacket,{signatureType:y},s,o,c,u,f)}))).then((g=>{h.push(...g)})),t){const g=t.packets.filterByTag(l.packet.signature);h.push(...g)}return h}async function Cn(i,e,r,t=new Date,n=!1,s=G){return Promise.all(i.filter((function(a){return["text","binary"].includes(l.read(l.signature,a.signatureType))})).map((async function(a){return(async function(o,c,u,f=new Date,h=!1,y=G){let g,p;for(const m of u){const v=m.getKeys(o.issuerKeyID);if(v.length>0){g=m,p=v[0];break}}const w=o instanceof at?o.correspondingSig:o,A={keyID:o.issuerKeyID,verified:(async()=>{if(!p)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(p.keyPacket,o.signatureType,c[0],f,h,y);const m=await w;if(p.getCreationTime()>m.created)throw Error("Key is newer than the signature");try{await g.getSigningKey(p.getKeyID(),m.created,void 0,y)}catch(v){if(!y.allowInsecureVerificationWithReformattedKeys||!v.message.match(/Signature creation time is in the future/))throw v;await g.getSigningKey(p.getKeyID(),f,void 0,y)}return!0})(),signature:(async()=>{const m=await w,v=new re;return m&&v.push(m),new Pr(v)})()};return A.signature.catch((()=>{})),A.verified.catch((()=>{})),A})(a,e,r,t,n,s)})))}async function F5({armoredMessage:i,binaryMessage:e,config:r,...t}){r={...G,...r};let n=i||e;if(!n)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(i&&!d.isString(i)&&!d.isStream(i))throw Error("readMessage: options.armoredMessage must be a string or stream");if(e&&!d.isUint8Array(e)&&!d.isStream(e))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(t);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=d.isStream(n);if(i){const{type:u,data:f}=await Zt(n);if(u!==l.armor.message)throw Error("Armored text not of type message");n=f}const o=await re.fromBinary(n,Uu,r,new fs),c=new Le(o);return c.fromStream=a,c}async function L5({text:i,binary:e,filename:r,date:t=new Date,format:n=i!==void 0?"utf8":"binary",...s}){const a=i!==void 0?i:e;if(a===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(i&&!d.isString(i)&&!d.isStream(i))throw Error("createMessage: options.text must be a string or stream");if(e&&!d.isUint8Array(e)&&!d.isStream(e))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=d.isStream(a),u=new mr(t);i!==void 0?u.setText(a,l.write(l.literal,n)):u.setBytes(a,l.write(l.literal,n)),r!==void 0&&u.setFilename(r);const f=new re;f.push(u);const h=new Le(f);return h.fromStream=c,h}const xu=d.constructAllowedPackets([Ie]);class qt{constructor(e,r){if(this.text=d.removeTrailingSpaces(e).replace(/\r?\n/g,`\r
`),r&&!(r instanceof Pr))throw Error("Invalid signature input");this.signature=r||new Pr(new re)}getSigningKeyIDs(){const e=[];return this.signature.packets.forEach((function(r){e.push(r.issuerKeyID)})),e}async sign(e,r=[],t=null,n=[],s=new Date,a=[],o=[],c=[],u=G){const f=new mr;f.setText(this.text);const h=new Pr(await ba(f,e,r,t,n,s,a,o,c,!0,u));return new qt(this.text,h)}verify(e,r=new Date,t=G){const n=this.signature.packets.filterByTag(l.packet.signature),s=new mr;return s.setText(this.text),Cn(n,[s],e,r,!0,t)}getText(){return this.text.replace(/\r\n/g,`
`)}armor(e=G){const r=this.signature.packets.some((n=>n.version!==6)),t={hash:r?Array.from(new Set(this.signature.packets.map((n=>l.read(l.hash,n.hashAlgorithm).toUpperCase())))).join():null,text:this.text,data:this.signature.packets.write()};return yi(l.armor.signed,t,void 0,void 0,void 0,r,e)}}async function N5({cleartextMessage:i,config:e,...r}){if(e={...G,...e},!i)throw Error("readCleartextMessage: must pass options object containing `cleartextMessage`");if(!d.isString(i))throw Error("readCleartextMessage: options.cleartextMessage must be a string");const t=Object.keys(r);if(t.length>0)throw Error("Unknown option: "+t.join(", "));const n=await Zt(i);if(n.type!==l.armor.signed)throw Error("No cleartext signed message.");const s=await re.fromBinary(n.data,xu,e);(function(o,c){const u=function(h){const y=g=>p=>g.hashAlgorithm===p;for(let g=0;g<c.length;g++)if(c[g].constructor.tag===l.packet.signature&&!h.some(y(c[g])))return!1;return!0},f=[];if(o.forEach((h=>{const y=h.match(/^Hash: (.+)$/);if(!y)throw Error('Only "Hash" header allowed in cleartext signed message');{const g=y[1].replace(/\s/g,"").split(",").map((p=>{try{return l.write(l.hash,p.toLowerCase())}catch{throw Error("Unknown hash algorithm in armor header: "+p.toLowerCase())}}));f.push(...g)}})),f.length&&!u(f))throw Error("Hash algorithm mismatch in armor header and signature")})(n.headers,s);const a=new Pr(s);return new qt(n.text,a)}async function O5({text:i,...e}){if(!i)throw Error("createCleartextMessage: must pass options object containing `text`");if(!d.isString(i))throw Error("createCleartextMessage: options.text must be a string");const r=Object.keys(e);if(r.length>0)throw Error("Unknown option: "+r.join(", "));return new qt(i)}async function H5({userIDs:i=[],passphrase:e,type:r,curve:t,rsaBits:n=4096,keyExpirationTime:s=0,date:a=new Date,subkeys:o=[{}],format:c="armored",config:u,...f}){ut(u={...G,...u}),r||t?(r=r||"ecc",t=t||"curve25519Legacy"):(r=u.v6Keys?"curve25519":"ecc",t="curve25519Legacy"),i=se(i);const h=Object.keys(f);if(h.length>0)throw Error("Unknown option: "+h.join(", "));if(i.length===0&&!u.v6Keys)throw Error("UserIDs are required for V4 keys");if(r==="rsa"&&n<u.minRSABits)throw Error(`rsaBits should be at least ${u.minRSABits}, got: ${n}`);const y={userIDs:i,passphrase:e,type:r,rsaBits:n,curve:t,keyExpirationTime:s,date:a,subkeys:o};try{const{key:g,revocationCertificate:p}=await(async function(w,A){w.sign=!0,(w=wa(w)).subkeys=w.subkeys.map(((U,Q)=>wa(w.subkeys[Q],w)));let m=[Su(w,A)];m=m.concat(w.subkeys.map((U=>G1(U,A))));const v=await Promise.all(m),E=await _1(v[0],v.slice(1),w,A),k=await E.getRevocationCertificate(w.date,A);return E.revocationSignatures=[],{key:E,revocationCertificate:k}})(y,u);return g.getKeys().forEach((({keyPacket:w})=>ur(w,u))),{privateKey:gr(g,c,u),publicKey:gr(g.toPublic(),c,u),revocationCertificate:p}}catch(g){throw d.wrapError("Error generating keypair",g)}}async function z5({privateKey:i,userIDs:e=[],passphrase:r,keyExpirationTime:t=0,date:n,format:s="armored",config:a,...o}){ut(a={...G,...a}),e=se(e);const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(e.length===0&&i.keyPacket.version!==6)throw Error("UserIDs are required for V4 keys");const u={privateKey:i,userIDs:e,passphrase:r,keyExpirationTime:t,date:n};try{const{key:f,revocationCertificate:h}=await(async function(y,g){y=E(y);const{privateKey:p}=y;if(!p.isPrivate())throw Error("Cannot reformat a public key");if(p.keyPacket.isDummy())throw Error("Cannot reformat a gnu-dummy primary key");if(!p.getKeys().every((({keyPacket:k})=>k.isDecrypted())))throw Error("Key is not decrypted");const w=p.keyPacket;y.subkeys||(y.subkeys=await Promise.all(p.subkeys.map((async k=>{const U=k.keyPacket,Q={key:w,bind:U},P=await it(k.bindingSignatures,w,l.signature.subkeyBinding,Q,null,g).catch((()=>({})));return{sign:P.keyFlags&&P.keyFlags[0]&l.keyFlags.signData}}))));const A=p.subkeys.map((k=>k.keyPacket));if(y.subkeys.length!==A.length)throw Error("Number of subkey options does not match number of subkeys");y.subkeys=y.subkeys.map((k=>E(k,y)));const m=await _1(w,A,y,g),v=await m.getRevocationCertificate(y.date,g);return m.revocationSignatures=[],{key:m,revocationCertificate:v};function E(k,U={}){return k.keyExpirationTime=k.keyExpirationTime||U.keyExpirationTime,k.passphrase=d.isString(k.passphrase)?k.passphrase:U.passphrase,k.date=k.date||U.date,k}})(u,a);return{privateKey:gr(f,s,a),publicKey:gr(f.toPublic(),s,a),revocationCertificate:h}}catch(f){throw d.wrapError("Error reformatting keypair",f)}}async function G5({key:i,revocationCertificate:e,reasonForRevocation:r,date:t=new Date,format:n="armored",config:s,...a}){ut(s={...G,...s});const o=Object.keys(a);if(o.length>0)throw Error("Unknown option: "+o.join(", "));try{const c=e?await i.applyRevocationCertificate(e,t,s):await i.revoke(r,t,s);return c.isPrivate()?{privateKey:gr(c,n,s),publicKey:gr(c.toPublic(),n,s)}:{privateKey:null,publicKey:gr(c,n,s)}}catch(c){throw d.wrapError("Error revoking key",c)}}async function j5({privateKey:i,passphrase:e,config:r,...t}){ut(r={...G,...r});const n=Object.keys(t);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!i.isPrivate())throw Error("Cannot decrypt a public key");const s=i.clone(!0),a=d.isArray(e)?e:[e];try{return await Promise.all(s.getKeys().map((o=>d.anyPromise(a.map((c=>o.keyPacket.decrypt(c))))))),await s.validate(r),s}catch(o){throw s.clearPrivateParams(),d.wrapError("Error decrypting private key",o)}}async function V5({privateKey:i,passphrase:e,config:r,...t}){ut(r={...G,...r});const n=Object.keys(t);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!i.isPrivate())throw Error("Cannot encrypt a public key");const s=i.clone(!0),a=s.getKeys(),o=d.isArray(e)?e:Array(a.length).fill(e);if(o.length!==a.length)throw Error("Invalid number of passphrases given for key encryption");try{return await Promise.all(a.map((async(c,u)=>{const{keyPacket:f}=c;await f.encrypt(o[u],r),f.clearPrivateParams()}))),s}catch(c){throw s.clearPrivateParams(),d.wrapError("Error encrypting private key",c)}}async function q5({message:i,encryptionKeys:e,signingKeys:r,passwords:t,sessionKey:n,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:f=new Date,signingUserIDs:h=[],encryptionUserIDs:y=[],signatureNotations:g=[],config:p,...w}){if(ut(p={...G,...p}),Za(i),Ja(s),e=se(e),r=se(r),t=se(t),c=se(c),u=se(u),h=se(h),y=se(y),g=se(g),w.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(w.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(w.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(w.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const A=Object.keys(w);if(A.length>0)throw Error("Unknown option: "+A.join(", "));r||(r=[]);try{if((r.length||a)&&(i=await i.sign(r,e,a,c,f,h,u,g,p)),i=i.compress(await(async function(v=[],E=new Date,k=[],U=G){const Q=l.compression.uncompressed,P=U.preferredCompressionAlgorithm;return(await Promise.all(v.map((async function(b,K){const B=(await b.getPrimarySelfSignature(E,k[K],U)).preferredCompressionAlgorithms;return!!B&&B.indexOf(P)>=0})))).every(Boolean)?P:Q})(e,f,y,p),p),i=await i.encrypt(e,t,n,o,u,f,y,p),s==="object")return i;const m=s==="armored"?i.armor(p):i.write();return await ps(m)}catch(m){throw d.wrapError("Error encrypting message",m)}}async function _5({message:i,decryptionKeys:e,passwords:r,sessionKeys:t,verificationKeys:n,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...f}){if(ut(u={...G,...u}),Za(i),n=se(n),e=se(e),r=se(r),t=se(t),f.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(f.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const h=Object.keys(f);if(h.length>0)throw Error("Unknown option: "+h.join(", "));try{const y=await i.decrypt(e,r,t,c,u);n||(n=[]);const g={};if(g.signatures=o?await y.verifyDetached(o,n,c,u):await y.verify(n,c,u),g.data=a==="binary"?y.getLiteralData():y.getText(),g.filename=y.getFilename(),Z1(g,i,...new Set([y,y.unwrapCompressed()])),s){if(n.length===0)throw Error("Verification keys are required to verify message signatures");if(g.signatures.length===0)throw Error("Message is not signed");g.data=Oe([g.data,Yt((async()=>(await d.anyPromise(g.signatures.map((p=>p.verified))),a==="binary"?new Uint8Array:"")))])}return g.data=await ps(g.data),g}catch(y){throw d.wrapError("Error decrypting message",y)}}async function Y5({message:i,signingKeys:e,recipientKeys:r=[],format:t="armored",detached:n=!1,signingKeyIDs:s=[],date:a=new Date,signingUserIDs:o=[],recipientUserIDs:c=[],signatureNotations:u=[],config:f,...h}){if(ut(f={...G,...f}),Y1(i),Ja(t),e=se(e),s=se(s),o=se(o),r=se(r),c=se(c),u=se(u),h.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.sign, pass `signingKeys` instead");if(h.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.sign, pass `format` instead.");const y=Object.keys(h);if(y.length>0)throw Error("Unknown option: "+y.join(", "));if(i instanceof qt&&t==="binary")throw Error("Cannot return signed cleartext message in binary format");if(i instanceof qt&&n)throw Error("Cannot detach-sign a cleartext message");if(!e||e.length===0)throw Error("No signing keys provided");try{let g;return g=n?await i.signDetached(e,r,void 0,s,a,o,c,u,f):await i.sign(e,r,void 0,s,a,o,c,u,f),t==="object"?g:(g=t==="armored"?g.armor(f):g.write(),n&&(g=_t(i.packets.write(),(async(p,w)=>{await Promise.all([pr(g,w),ke(p).catch((()=>{}))])}))),await ps(g))}catch(g){throw d.wrapError("Error signing message",g)}}async function Z5({message:i,verificationKeys:e,expectSigned:r=!1,format:t="utf8",signature:n=null,date:s=new Date,config:a,...o}){if(ut(a={...G,...a}),Y1(i),e=se(e),o.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");const c=Object.keys(o);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(i instanceof qt&&t==="binary")throw Error("Can't return cleartext message data as binary");if(i instanceof qt&&n)throw Error("Can't verify detached cleartext signature");try{const u={};if(u.signatures=n?await i.verifyDetached(n,e,s,a):await i.verify(e,s,a),u.data=t==="binary"?i.getLiteralData():i.getText(),i.fromStream&&!n&&Z1(u,...new Set([i,i.unwrapCompressed()])),r){if(u.signatures.length===0)throw Error("Message is not signed");u.data=Oe([u.data,Yt((async()=>(await d.anyPromise(u.signatures.map((f=>f.verified))),t==="binary"?new Uint8Array:"")))])}return u.data=await ps(u.data),u}catch(u){throw d.wrapError("Error verifying signed message",u)}}async function J5({encryptionKeys:i,date:e=new Date,encryptionUserIDs:r=[],config:t,...n}){if(ut(t={...G,...t}),i=se(i),r=se(r),n.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.generateSessionKey, pass `encryptionKeys` instead");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));try{return await Le.generateSessionKey(i,e,r,t)}catch(a){throw d.wrapError("Error generating session key",a)}}async function X5({data:i,algorithm:e,aeadAlgorithm:r,encryptionKeys:t,passwords:n,format:s="armored",wildcard:a=!1,encryptionKeyIDs:o=[],date:c=new Date,encryptionUserIDs:u=[],config:f,...h}){if(ut(f={...G,...f}),(function(g){if(!d.isUint8Array(g))throw Error("Parameter [data] must be of type Uint8Array")})(i),(function(g,p){if(!d.isString(g))throw Error("Parameter ["+p+"] must be of type String")})(e,"algorithm"),Ja(s),t=se(t),n=se(n),o=se(o),u=se(u),h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encryptSessionKey, pass `encryptionKeys` instead");const y=Object.keys(h);if(y.length>0)throw Error("Unknown option: "+y.join(", "));if(!(t&&t.length!==0||n&&n.length!==0))throw Error("No encryption keys or passwords provided.");try{return gr(await Le.encryptSessionKey(i,e,r,t,n,a,o,c,u,f),s,f)}catch(g){throw d.wrapError("Error encrypting session key",g)}}async function W5({message:i,decryptionKeys:e,passwords:r,date:t=new Date,config:n,...s}){if(ut(n={...G,...n}),Za(i),e=se(e),r=se(r),s.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decryptSessionKeys, pass `decryptionKeys` instead");const a=Object.keys(s);if(a.length>0)throw Error("Unknown option: "+a.join(", "));try{return await i.decryptSessionKeys(e,r,void 0,t,n)}catch(o){throw d.wrapError("Error decrypting session keys",o)}}function Za(i){if(!(i instanceof Le))throw Error("Parameter [message] needs to be of type Message")}function Y1(i){if(!(i instanceof qt||i instanceof Le))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}function Ja(i){if(i!=="armored"&&i!=="binary"&&i!=="object")throw Error("Unsupported format "+i)}const Qu=Object.keys(G).length;function ut(i){const e=Object.keys(i);if(e.length!==Qu){for(const r of e)if(G[r]===void 0)throw Error("Unknown config property: "+r)}}function se(i){return i&&!d.isArray(i)&&(i=[i]),i}async function ps(i){return d.isStream(i)==="array"?ke(i):i}function Z1(i,e,...r){i.data=_t(e.packets.stream,(async(t,n)=>{await pr(i.data,n,{preventClose:!0});const s=et(n);try{await ke(t,(a=>a)),await Promise.all(r.map((a=>ke(a.packets.stream,(o=>o))))),await s.close()}catch(a){await s.abort(a)}}))}function gr(i,e,r){switch(e){case"object":return i;case"armored":return i.armor(r);case"binary":return i.write();default:throw Error("Unsupported format "+e)}}const zr=typeof Me=="object"&&"crypto"in Me?Me.crypto:void 0;function $i(i){return i instanceof Uint8Array||ArrayBuffer.isView(i)&&i.constructor.name==="Uint8Array"}function _i(i){if(!Number.isSafeInteger(i)||i<0)throw Error("positive integer expected, got "+i)}function Qt(i,...e){if(!$i(i))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(i.length))throw Error("Uint8Array expected of length "+e+", got length="+i.length)}function J1(i){if(typeof i!="function"||typeof i.create!="function")throw Error("Hash should be wrapped by utils.createHasher");_i(i.outputLen),_i(i.blockLen)}function fi(i,e=!0){if(i.destroyed)throw Error("Hash instance has been destroyed");if(e&&i.finished)throw Error("Hash#digest() has already been called")}function X1(i,e){Qt(i);const r=e.outputLen;if(i.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function ct(...i){for(let e=0;e<i.length;e++)i[e].fill(0)}function Rs(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}function dt(i,e){return i<<32-e|i>>>e}function fr(i,e){return i<<e|i>>>32-e>>>0}const Vo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68?i=>i:function(i){for(let r=0;r<i.length;r++)i[r]=(e=i[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;var e;return i},W1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ru=Array.from({length:256},((i,e)=>e.toString(16).padStart(2,"0")));function xr(i){if(Qt(i),W1)return i.toHex();let e="";for(let r=0;r<i.length;r++)e+=Ru[i[r]];return e}const qo=48,Tu=57,_o=65,Mu=70,Yo=97,Fu=102;function Zo(i){return i>=qo&&i<=Tu?i-qo:i>=_o&&i<=Mu?i-(_o-10):i>=Yo&&i<=Fu?i-(Yo-10):void 0}function Vn(i){if(typeof i!="string")throw Error("hex string expected, got "+typeof i);if(W1)return Uint8Array.fromHex(i);const e=i.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const a=Zo(i.charCodeAt(s)),o=Zo(i.charCodeAt(s+1));if(a===void 0||o===void 0){const c=i[s]+i[s+1];throw Error('hex string expected, got non-hex character "'+c+'" at index '+s)}t[n]=16*a+o}return t}function en(i){return typeof i=="string"&&(i=(function(e){if(typeof e!="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))})(i)),Qt(i),i}function lt(...i){let e=0;for(let t=0;t<i.length;t++){const n=i[t];Qt(n),e+=n.length}const r=new Uint8Array(e);for(let t=0,n=0;t<i.length;t++){const s=i[t];r.set(s,n),n+=s.length}return r}class Xa{}function Wt(i){const e=t=>i().update(en(t)).digest(),r=i();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>i(),e}const Lu=Wt;function ds(i=32){if(zr&&typeof zr.getRandomValues=="function")return zr.getRandomValues(new Uint8Array(i));if(zr&&typeof zr.randomBytes=="function")return Uint8Array.from(zr.randomBytes(i));throw Error("crypto.getRandomValues must be defined")}const Wa=BigInt(0),ka=BigInt(1);function Mr(i,e=""){if(typeof i!="boolean")throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof i);return i}function gt(i,e,r=""){const t=$i(i),n=i?.length,s=e!==void 0;if(!t||s&&n!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?" of length "+e:"")+", got "+(t?"length="+n:"type="+typeof i));return i}function un(i){const e=i.toString(16);return 1&e.length?"0"+e:e}function $1(i){if(typeof i!="string")throw Error("hex string expected, got "+typeof i);return i===""?Wa:BigInt("0x"+i)}function As(i){return $1(xr(i))}function Fr(i){return Qt(i),$1(xr(Uint8Array.from(i).reverse()))}function $a(i,e){return Vn(i.toString(16).padStart(2*e,"0"))}function eo(i,e){return $a(i,e).reverse()}function le(i,e,r){let t;if(typeof e=="string")try{t=Vn(e)}catch(s){throw Error(i+" must be hex string or Uint8Array, cause: "+s)}else{if(!$i(e))throw Error(i+" must be hex string or Uint8Array");t=Uint8Array.from(e)}const n=t.length;if(typeof r=="number"&&n!==r)throw Error(i+" of length "+r+" expected, got "+n);return t}function Jo(i){return Uint8Array.from(i)}const Ts=i=>typeof i=="bigint"&&Wa<=i;function Yi(i,e,r,t){if(!(function(n,s,a){return Ts(n)&&Ts(s)&&Ts(a)&&s<=n&&n<a})(e,r,t))throw Error("expected valid "+i+": "+r+" <= n < "+t+", got "+e)}function e0(i){let e;for(e=0;i>Wa;i>>=ka,e+=1);return e}const tn=i=>(ka<<BigInt(i))-ka;function pi(i,e,r={}){if(!i||typeof i!="object")throw Error("expected valid options object");function t(n,s,a){const o=i[n];if(a&&o===void 0)return;const c=typeof o;if(c!==s||o===null)throw Error(`param "${n}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach((([n,s])=>t(n,s,!1))),Object.entries(r).forEach((([n,s])=>t(n,s,!0)))}function qn(i){const e=new WeakMap;return(r,...t)=>{const n=e.get(r);if(n!==void 0)return n;const s=i(r,...t);return e.set(r,s),s}}const je=BigInt(0),Ne=BigInt(1),Sr=BigInt(2),t0=BigInt(3),r0=BigInt(4),i0=BigInt(5),Nu=BigInt(7),n0=BigInt(8),Ou=BigInt(9),Xo=BigInt(16);function Be(i,e){const r=i%e;return r>=je?r:e+r}function fe(i,e,r){let t=i;for(;e-- >je;)t*=t,t%=r;return t}function Wo(i,e){if(i===je)throw Error("invert: expected non-zero number");if(e<=je)throw Error("invert: expected positive modulus, got "+e);let r=Be(i,e),t=e,n=je,s=Ne;for(;r!==je;){const a=t%r,o=n-s*(t/r);t=r,r=a,n=s,s=o}if(t!==Ne)throw Error("invert: does not exist");return Be(n,e)}function to(i,e,r){if(!i.eql(i.sqr(e),r))throw Error("Cannot find square root")}function s0(i,e){const r=(i.ORDER+Ne)/r0,t=i.pow(e,r);return to(i,t,e),t}function Hu(i,e){const r=(i.ORDER-i0)/n0,t=i.mul(e,Sr),n=i.pow(t,r),s=i.mul(e,n),a=i.mul(i.mul(s,Sr),n),o=i.mul(s,i.sub(a,i.ONE));return to(i,o,e),o}function $o(i){if(i<t0)throw Error("sqrt is not defined for small field");let e=i-Ne,r=0;for(;e%Sr===je;)e/=Sr,r++;let t=Sr;const n=Je(i);for(;ec(n,t)===1;)if(t++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return s0;let s=n.pow(t,e);const a=(e+Ne)/Sr;return function(o,c){if(o.is0(c))return c;if(ec(o,c)!==1)throw Error("Cannot find square root");let u=r,f=o.mul(o.ONE,s),h=o.pow(c,e),y=o.pow(c,a);for(;!o.eql(h,o.ONE);){if(o.is0(h))return o.ZERO;let g=1,p=o.sqr(h);for(;!o.eql(p,o.ONE);)if(g++,p=o.sqr(p),g===u)throw Error("Cannot find square root");const w=Ne<<BigInt(u-g-1),A=o.pow(f,w);u=g,f=o.sqr(A),h=o.mul(h,f),y=o.mul(y,A)}return y}}function zu(i){return i%r0===t0?s0:i%n0===i0?Hu:i%Xo===Ou?(function(e){const r=Je(e),t=$o(e),n=t(r,r.neg(r.ONE)),s=t(r,n),a=t(r,r.neg(n)),o=(e+Nu)/Xo;return(c,u)=>{let f=c.pow(u,o),h=c.mul(f,n);const y=c.mul(f,s),g=c.mul(f,a),p=c.eql(c.sqr(h),u),w=c.eql(c.sqr(y),u);f=c.cmov(f,h,p),h=c.cmov(g,y,w);const A=c.eql(c.sqr(h),u),m=c.cmov(f,h,A);return to(c,m,u),m}})(i):$o(i)}const Gu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function a0(i,e,r=!1){const t=Array(e.length).fill(r?i.ZERO:void 0),n=e.reduce(((a,o,c)=>i.is0(o)?a:(t[c]=a,i.mul(a,o))),i.ONE),s=i.inv(n);return e.reduceRight(((a,o,c)=>i.is0(o)?a:(t[c]=i.mul(a,t[c]),i.mul(a,o))),s),t}function ec(i,e){const r=(i.ORDER-Ne)/Sr,t=i.pow(e,r),n=i.eql(t,i.ONE),s=i.eql(t,i.ZERO),a=i.eql(t,i.neg(i.ONE));if(!n&&!s&&!a)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function o0(i,e){e!==void 0&&_i(e);const r=e!==void 0?e:i.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Je(i,e,r=!1,t={}){if(i<=je)throw Error("invalid field: expected ORDER > 0, got "+i);let n,s,a,o=!1;if(typeof e=="object"&&e!=null){if(t.sqrt||r)throw Error("cannot specify opts in two arguments");const y=e;y.BITS&&(n=y.BITS),y.sqrt&&(s=y.sqrt),typeof y.isLE=="boolean"&&(r=y.isLE),typeof y.modFromBytes=="boolean"&&(o=y.modFromBytes),a=y.allowedLengths}else typeof e=="number"&&(n=e),t.sqrt&&(s=t.sqrt);const{nBitLength:c,nByteLength:u}=o0(i,n);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let f;const h=Object.freeze({ORDER:i,isLE:r,BITS:c,BYTES:u,MASK:tn(c),ZERO:je,ONE:Ne,allowedLengths:a,create:y=>Be(y,i),isValid:y=>{if(typeof y!="bigint")throw Error("invalid field element: expected bigint, got "+typeof y);return je<=y&&y<i},is0:y=>y===je,isValidNot0:y=>!h.is0(y)&&h.isValid(y),isOdd:y=>(y&Ne)===Ne,neg:y=>Be(-y,i),eql:(y,g)=>y===g,sqr:y=>Be(y*y,i),add:(y,g)=>Be(y+g,i),sub:(y,g)=>Be(y-g,i),mul:(y,g)=>Be(y*g,i),pow:(y,g)=>(function(p,w,A){if(A<je)throw Error("invalid exponent, negatives unsupported");if(A===je)return p.ONE;if(A===Ne)return w;let m=p.ONE,v=w;for(;A>je;)A&Ne&&(m=p.mul(m,v)),v=p.sqr(v),A>>=Ne;return m})(h,y,g),div:(y,g)=>Be(y*Wo(g,i),i),sqrN:y=>y*y,addN:(y,g)=>y+g,subN:(y,g)=>y-g,mulN:(y,g)=>y*g,inv:y=>Wo(y,i),sqrt:s||(y=>(f||(f=zu(i)),f(h,y))),toBytes:y=>r?eo(y,u):$a(y,u),fromBytes:(y,g=!0)=>{if(a){if(!a.includes(y.length)||y.length>u)throw Error("Field.fromBytes: expected "+a+" bytes, got "+y.length);const w=new Uint8Array(u);w.set(y,r?0:w.length-y.length),y=w}if(y.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+y.length);let p=r?Fr(y):As(y);if(o&&(p=Be(p,i)),!g&&!h.isValid(p))throw Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:y=>a0(h,y),cmov:(y,g,p)=>p?g:y});return Object.freeze(h)}function c0(i){if(typeof i!="bigint")throw Error("field order must be bigint");const e=i.toString(2).length;return Math.ceil(e/8)}function tc(i){const e=c0(i);return e+Math.ceil(e/2)}function u0(i,e,r){return i&e^~i&r}function h0(i,e,r){return i&e^i&r^e&r}class rn extends Xa{constructor(e,r,t,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=t,this.isLE=n,this.buffer=new Uint8Array(e),this.view=Rs(this.buffer)}update(e){fi(this),Qt(e=en(e));const{view:r,buffer:t,blockLen:n}=this,s=e.length;for(let a=0;a<s;){const o=Math.min(n-this.pos,s-a);if(o!==n)t.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===n&&(this.process(r,0),this.pos=0);else{const c=Rs(e);for(;n<=s-a;a+=n)this.process(c,a)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){fi(this),X1(e,this),this.finished=!0;const{buffer:r,view:t,blockLen:n,isLE:s}=this;let{pos:a}=this;r[a++]=128,ct(this.buffer.subarray(a)),this.padOffset>n-a&&(this.process(t,0),a=0);for(let h=a;h<n;h++)r[h]=0;(function(h,y,g,p){if(typeof h.setBigUint64=="function")return h.setBigUint64(y,g,p);const w=BigInt(32),A=BigInt(4294967295),m=Number(g>>w&A),v=Number(g&A),E=p?4:0,k=p?0:4;h.setUint32(y+E,m,p),h.setUint32(y+k,v,p)})(t,n-8,BigInt(8*this.length),s),this.process(t,0);const o=Rs(e),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,f=this.get();if(u>f.length)throw Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)o.setUint32(4*h,f[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const t=e.slice(0,r);return this.destroy(),t}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:t,length:n,finished:s,destroyed:a,pos:o}=this;return e.destroyed=a,e.finished=s,e.length=n,e.pos=o,n%r&&e.buffer.set(t),e}clone(){return this._cloneInto()}}const $t=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Qe=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Re=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),hn=BigInt(2**32-1),rc=BigInt(32);function ju(i,e=!1){return e?{h:Number(i&hn),l:Number(i>>rc&hn)}:{h:0|Number(i>>rc&hn),l:0|Number(i&hn)}}function f0(i,e=!1){const r=i.length;let t=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){const{h:a,l:o}=ju(i[s],e);[t[s],n[s]]=[a,o]}return[t,n]}const ic=(i,e,r)=>i>>>r,nc=(i,e,r)=>i<<32-r|e>>>r,Gr=(i,e,r)=>i>>>r|e<<32-r,jr=(i,e,r)=>i<<32-r|e>>>r,fn=(i,e,r)=>i<<64-r|e>>>r-32,ln=(i,e,r)=>i>>>r-32|e<<64-r;function Mt(i,e,r,t){const n=(e>>>0)+(t>>>0);return{h:i+r+(n/2**32|0)|0,l:0|n}}const Vu=(i,e,r)=>(i>>>0)+(e>>>0)+(r>>>0),qu=(i,e,r,t)=>e+r+t+(i/2**32|0)|0,_u=(i,e,r,t)=>(i>>>0)+(e>>>0)+(r>>>0)+(t>>>0),Yu=(i,e,r,t,n)=>e+r+t+n+(i/2**32|0)|0,Zu=(i,e,r,t,n)=>(i>>>0)+(e>>>0)+(r>>>0)+(t>>>0)+(n>>>0),Ju=(i,e,r,t,n,s)=>e+r+t+n+s+(i/2**32|0)|0,Xu=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tr=new Uint32Array(64);class l0 extends rn{constructor(e=32){super(64,e,8,!1),this.A=0|$t[0],this.B=0|$t[1],this.C=0|$t[2],this.D=0|$t[3],this.E=0|$t[4],this.F=0|$t[5],this.G=0|$t[6],this.H=0|$t[7]}get(){const{A:e,B:r,C:t,D:n,E:s,F:a,G:o,H:c}=this;return[e,r,t,n,s,a,o,c]}set(e,r,t,n,s,a,o,c){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|n,this.E=0|s,this.F=0|a,this.G=0|o,this.H=0|c}process(e,r){for(let h=0;h<16;h++,r+=4)tr[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const y=tr[h-15],g=tr[h-2],p=dt(y,7)^dt(y,18)^y>>>3,w=dt(g,17)^dt(g,19)^g>>>10;tr[h]=w+tr[h-7]+p+tr[h-16]|0}let{A:t,B:n,C:s,D:a,E:o,F:c,G:u,H:f}=this;for(let h=0;h<64;h++){const y=f+(dt(o,6)^dt(o,11)^dt(o,25))+u0(o,c,u)+Xu[h]+tr[h]|0,g=(dt(t,2)^dt(t,13)^dt(t,22))+h0(t,n,s)|0;f=u,u=c,c=o,o=a+y|0,a=s,s=n,n=t,t=y+g|0}t=t+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(t,n,s,a,o,c,u,f)}roundClean(){ct(tr)}destroy(){this.set(0,0,0,0,0,0,0,0),ct(this.buffer)}}class Wu extends l0{constructor(){super(28),this.A=0|er[0],this.B=0|er[1],this.C=0|er[2],this.D=0|er[3],this.E=0|er[4],this.F=0|er[5],this.G=0|er[6],this.H=0|er[7]}}const y0=f0(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((i=>BigInt(i)))),$u=y0[0],eh=y0[1],rr=new Uint32Array(80),ir=new Uint32Array(80);class g0 extends rn{constructor(e=64){super(128,e,16,!1),this.Ah=0|Re[0],this.Al=0|Re[1],this.Bh=0|Re[2],this.Bl=0|Re[3],this.Ch=0|Re[4],this.Cl=0|Re[5],this.Dh=0|Re[6],this.Dl=0|Re[7],this.Eh=0|Re[8],this.El=0|Re[9],this.Fh=0|Re[10],this.Fl=0|Re[11],this.Gh=0|Re[12],this.Gl=0|Re[13],this.Hh=0|Re[14],this.Hl=0|Re[15]}get(){const{Ah:e,Al:r,Bh:t,Bl:n,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:f,Fh:h,Fl:y,Gh:g,Gl:p,Hh:w,Hl:A}=this;return[e,r,t,n,s,a,o,c,u,f,h,y,g,p,w,A]}set(e,r,t,n,s,a,o,c,u,f,h,y,g,p,w,A){this.Ah=0|e,this.Al=0|r,this.Bh=0|t,this.Bl=0|n,this.Ch=0|s,this.Cl=0|a,this.Dh=0|o,this.Dl=0|c,this.Eh=0|u,this.El=0|f,this.Fh=0|h,this.Fl=0|y,this.Gh=0|g,this.Gl=0|p,this.Hh=0|w,this.Hl=0|A}process(e,r){for(let E=0;E<16;E++,r+=4)rr[E]=e.getUint32(r),ir[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const k=0|rr[E-15],U=0|ir[E-15],Q=Gr(k,U,1)^Gr(k,U,8)^ic(k,0,7),P=jr(k,U,1)^jr(k,U,8)^nc(k,U,7),I=0|rr[E-2],b=0|ir[E-2],K=Gr(I,b,19)^fn(I,b,61)^ic(I,0,6),B=jr(I,b,19)^ln(I,b,61)^nc(I,b,6),S=_u(P,B,ir[E-7],ir[E-16]),C=Yu(S,Q,K,rr[E-7],rr[E-16]);rr[E]=0|C,ir[E]=0|S}let{Ah:t,Al:n,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:f,Eh:h,El:y,Fh:g,Fl:p,Gh:w,Gl:A,Hh:m,Hl:v}=this;for(let E=0;E<80;E++){const k=Gr(h,y,14)^Gr(h,y,18)^fn(h,y,41),U=jr(h,y,14)^jr(h,y,18)^ln(h,y,41),Q=h&g^~h&w,P=Zu(v,U,y&p^~y&A,eh[E],ir[E]),I=Ju(P,m,k,Q,$u[E],rr[E]),b=0|P,K=Gr(t,n,28)^fn(t,n,34)^fn(t,n,39),B=jr(t,n,28)^ln(t,n,34)^ln(t,n,39),S=t&s^t&o^s&o,C=n&a^n&c^a&c;m=0|w,v=0|A,w=0|g,A=0|p,g=0|h,p=0|y,{h,l:y}=Mt(0|u,0|f,0|I,0|b),u=0|o,f=0|c,o=0|s,c=0|a,s=0|t,a=0|n;const D=Vu(b,B,C);t=qu(D,I,K,S),n=0|D}({h:t,l:n}=Mt(0|this.Ah,0|this.Al,0|t,0|n)),{h:s,l:a}=Mt(0|this.Bh,0|this.Bl,0|s,0|a),{h:o,l:c}=Mt(0|this.Ch,0|this.Cl,0|o,0|c),{h:u,l:f}=Mt(0|this.Dh,0|this.Dl,0|u,0|f),{h,l:y}=Mt(0|this.Eh,0|this.El,0|h,0|y),{h:g,l:p}=Mt(0|this.Fh,0|this.Fl,0|g,0|p),{h:w,l:A}=Mt(0|this.Gh,0|this.Gl,0|w,0|A),{h:m,l:v}=Mt(0|this.Hh,0|this.Hl,0|m,0|v),this.set(t,n,s,a,o,c,u,f,h,y,g,p,w,A,m,v)}roundClean(){ct(rr,ir)}destroy(){ct(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class th extends g0{constructor(){super(48),this.Ah=0|Qe[0],this.Al=0|Qe[1],this.Bh=0|Qe[2],this.Bl=0|Qe[3],this.Ch=0|Qe[4],this.Cl=0|Qe[5],this.Dh=0|Qe[6],this.Dl=0|Qe[7],this.Eh=0|Qe[8],this.El=0|Qe[9],this.Fh=0|Qe[10],this.Fl=0|Qe[11],this.Gh=0|Qe[12],this.Gl=0|Qe[13],this.Hh=0|Qe[14],this.Hl=0|Qe[15]}}const ro=Wt((()=>new l0)),rh=Wt((()=>new Wu)),p0=Wt((()=>new g0)),d0=Wt((()=>new th));class A0 extends Xa{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,J1(e);const t=en(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(t.length>n?e.create().update(t).digest():t);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),ct(s)}update(e){return fi(this),this.iHash.update(e),this}digestInto(e){fi(this),Qt(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:t,finished:n,destroyed:s,blockLen:a,outputLen:o}=this;return e.finished=n,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=t._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const w0=(i,e,r)=>new A0(i,e).update(r).digest();w0.create=(i,e)=>new A0(i,e);const li=BigInt(0),Kr=BigInt(1);function _n(i,e){const r=e.negate();return i?r:e}function Cr(i,e){const r=a0(i.Fp,e.map((t=>t.Z)));return e.map(((t,n)=>i.fromAffine(t.toAffine(r[n]))))}function m0(i,e){if(!Number.isSafeInteger(i)||i<=0||i>e)throw Error("invalid window size, expected [1.."+e+"], got W="+i)}function Ms(i,e){m0(i,e);const r=2**i;return{windows:Math.ceil(e/i)+1,windowSize:2**(i-1),mask:tn(i),maxNumber:r,shiftBy:BigInt(i)}}function sc(i,e,r){const{windowSize:t,mask:n,maxNumber:s,shiftBy:a}=r;let o=Number(i&n),c=i>>a;o>t&&(o-=s,c+=Kr);const u=e*t;return{nextN:c,offset:u+Math.abs(o)-1,isZero:o===0,isNeg:o<0,isNegF:e%2!=0,offsetF:u}}const Fs=new WeakMap,b0=new WeakMap;function Ls(i){return b0.get(i)||1}function ac(i){if(i!==li)throw Error("invalid wNAF")}class k0{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,t=this.ZERO){let n=e;for(;r>li;)r&Kr&&(t=t.add(n)),n=n.double(),r>>=Kr;return t}precomputeWindow(e,r){const{windows:t,windowSize:n}=Ms(r,this.bits),s=[];let a=e,o=a;for(let c=0;c<t;c++){o=a,s.push(o);for(let u=1;u<n;u++)o=o.add(a),s.push(o);a=o.double()}return s}wNAF(e,r,t){if(!this.Fn.isValid(t))throw Error("invalid scalar");let n=this.ZERO,s=this.BASE;const a=Ms(e,this.bits);for(let o=0;o<a.windows;o++){const{nextN:c,offset:u,isZero:f,isNeg:h,isNegF:y,offsetF:g}=sc(t,o,a);t=c,f?s=s.add(_n(y,r[g])):n=n.add(_n(h,r[u]))}return ac(t),{p:n,f:s}}wNAFUnsafe(e,r,t,n=this.ZERO){const s=Ms(e,this.bits);for(let a=0;a<s.windows&&t!==li;a++){const{nextN:o,offset:c,isZero:u,isNeg:f}=sc(t,a,s);if(t=o,!u){const h=r[c];n=n.add(f?h.negate():h)}}return ac(t),n}getPrecomputes(e,r,t){let n=Fs.get(r);return n||(n=this.precomputeWindow(r,e),e!==1&&(typeof t=="function"&&(n=t(n)),Fs.set(r,n))),n}cached(e,r,t){const n=Ls(e);return this.wNAF(n,this.getPrecomputes(n,e,t),r)}unsafe(e,r,t,n){const s=Ls(e);return s===1?this._unsafeLadder(e,r,n):this.wNAFUnsafe(s,this.getPrecomputes(s,e,t),r,n)}createCache(e,r){m0(r,this.bits),b0.set(e,r),Fs.delete(e)}hasCache(e){return Ls(e)!==1}}function E0(i,e,r,t){(function(y,g){if(!Array.isArray(y))throw Error("array expected");y.forEach(((p,w)=>{if(!(p instanceof g))throw Error("invalid point at index "+w)}))})(r,i),(function(y,g){if(!Array.isArray(y))throw Error("array of scalars expected");y.forEach(((p,w)=>{if(!g.isValid(p))throw Error("invalid scalar at index "+w)}))})(t,e);const n=r.length,s=t.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");const a=i.ZERO,o=e0(BigInt(n));let c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);const u=tn(c),f=Array(Number(u)+1).fill(a);let h=a;for(let y=Math.floor((e.BITS-1)/c)*c;y>=0;y-=c){f.fill(a);for(let p=0;p<s;p++){const w=t[p],A=Number(w>>BigInt(y)&u);f[A]=f[A].add(r[p])}let g=a;for(let p=f.length-1,w=a;p>0;p--)w=w.add(f[p]),g=g.add(w);if(h=h.add(g),y!==0)for(let p=0;p<c;p++)h=h.double()}return h}function oc(i,e,r){if(e){if(e.ORDER!==i)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return(function(t){pi(t,Gu.reduce(((n,s)=>(n[s]="function",n)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))})(e),e}return Je(i,{isLE:r})}function v0(i,e,r={},t){if(t===void 0&&(t=i==="edwards"),!e||typeof e!="object")throw Error(`expected valid ${i} CURVE object`);for(const o of["p","n","h"]){const c=e[o];if(!(typeof c=="bigint"&&c>li))throw Error(`CURVE.${o} must be positive bigint`)}const n=oc(e.p,r.Fp,t),s=oc(e.n,r.Fn,t),a=["Gx","Gy","a",i==="weierstrass"?"b":"d"];for(const o of a)if(!n.isValid(e[o]))throw Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:n,Fn:s}}const cc=(i,e)=>(i+(i>=0?e:-e)/B0)/e;function Ea(i){if(!["compact","recovered","der"].includes(i))throw Error('Signature format must be "compact", "recovered", or "der"');return i}function Ns(i,e){const r={};for(let t of Object.keys(e))r[t]=i[t]===void 0?e[t]:i[t];return Mr(r.lowS,"lowS"),Mr(r.prehash,"prehash"),r.format!==void 0&&Ea(r.format),r}const Ht={Err:class extends Error{constructor(i=""){super(i)}},_tlv:{encode:(i,e)=>{const{Err:r}=Ht;if(i<0||i>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");const t=e.length/2,n=un(t);if(n.length/2&128)throw new r("tlv.encode: long form length too big");const s=t>127?un(n.length/2|128):"";return un(i)+s+n+e},decode(i,e){const{Err:r}=Ht;let t=0;if(i<0||i>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[t++]!==i)throw new r("tlv.decode: wrong tlv");const n=e[t++];let s=0;if(128&n){const o=127&n;if(!o)throw new r("tlv.decode(long): indefinite length not supported");if(o>4)throw new r("tlv.decode(long): byte length is too big");const c=e.subarray(t,t+o);if(c.length!==o)throw new r("tlv.decode: length bytes not complete");if(c[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of c)s=s<<8|u;if(t+=o,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;const a=e.subarray(t,t+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(t+s)}}},_int:{encode(i){const{Err:e}=Ht;if(i<zt)throw new e("integer: negative integers are not allowed");let r=un(i);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(i){const{Err:e}=Ht;if(128&i[0])throw new e("invalid signature integer: negative");if(i[0]===0&&!(128&i[1]))throw new e("invalid signature integer: unnecessary leading zero");return As(i)}},toSig(i){const{Err:e,_int:r,_tlv:t}=Ht,n=le("signature",i),{v:s,l:a}=t.decode(48,n);if(a.length)throw new e("invalid signature: left bytes after parsing");const{v:o,l:c}=t.decode(2,s),{v:u,l:f}=t.decode(2,c);if(f.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(u)}},hexFromSig(i){const{_tlv:e,_int:r}=Ht,t=e.encode(2,r.encode(i.r))+e.encode(2,r.encode(i.s));return e.encode(48,t)}},zt=BigInt(0),Wr=BigInt(1),B0=BigInt(2),yn=BigInt(3),ih=BigInt(4);function $r(i,e){const{BYTES:r}=i;let t;if(typeof e=="bigint")t=e;else{let n=le("private key",e);try{t=i.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!i.isValidNot0(t))throw Error("invalid private key: out of range [1..N-1]");return t}function nh(i,e={}){const r=v0("weierstrass",i,e),{Fp:t,Fn:n}=r;let s=r.CURVE;const{h:a,n:o}=s;pi(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!t.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');const u=S0(t,n);function f(){if(!t.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}const h=e.toBytes||function(K,B,S){const{x:C,y:D}=B.toAffine(),R=t.toBytes(C);return Mr(S,"isCompressed"),S?(f(),lt(I0(!t.isOdd(D)),R)):lt(Uint8Array.of(4),R,t.toBytes(D))},y=e.fromBytes||function(K){gt(K,void 0,"Point");const{publicKey:B,publicKeyUncompressed:S}=u,C=K.length,D=K[0],R=K.subarray(1);if(C!==B||D!==2&&D!==3){if(C===S&&D===4){const x=t.BYTES,T=t.fromBytes(R.subarray(0,x)),N=t.fromBytes(R.subarray(x,2*x));if(!p(T,N))throw Error("bad point: is not on curve");return{x:T,y:N}}throw Error(`bad point: got length ${C}, expected compressed=${B} or uncompressed=${S}`)}{const x=t.fromBytes(R);if(!t.isValid(x))throw Error("bad point: is not on curve, wrong x");const T=g(x);let N;try{N=t.sqrt(T)}catch(F){const M=F instanceof Error?": "+F.message:"";throw Error("bad point: is not on curve, sqrt error"+M)}return f(),!(1&~D)!==t.isOdd(N)&&(N=t.neg(N)),{x,y:N}}};function g(K){const B=t.sqr(K),S=t.mul(B,K);return t.add(t.add(S,t.mul(K,s.a)),s.b)}function p(K,B){const S=t.sqr(B),C=g(K);return t.eql(S,C)}if(!p(s.Gx,s.Gy))throw Error("bad curve params: generator point");const w=t.mul(t.pow(s.a,yn),ih),A=t.mul(t.sqr(s.b),BigInt(27));if(t.is0(t.add(w,A)))throw Error("bad curve params: a or b");function m(K,B,S=!1){if(!t.isValid(B)||S&&t.is0(B))throw Error("bad point coordinate "+K);return B}function v(K){if(!(K instanceof P))throw Error("ProjectivePoint expected")}function E(K){if(!c||!c.basises)throw Error("no endo");return(function(B,S,C){const[[D,R],[x,T]]=S,N=cc(T*B,C),F=cc(-R*B,C);let M=B-N*D-F*x,z=-N*R-F*T;const L=M<zt,O=z<zt;L&&(M=-M),O&&(z=-z);const H=tn(Math.ceil(e0(C)/2))+Wr;if(M<zt||M>=H||z<zt||z>=H)throw Error("splitScalar (endomorphism): failed, k="+B);return{k1neg:L,k1:M,k2neg:O,k2:z}})(K,c.basises,n.ORDER)}const k=qn(((K,B)=>{const{X:S,Y:C,Z:D}=K;if(t.eql(D,t.ONE))return{x:S,y:C};const R=K.is0();B==null&&(B=R?t.ONE:t.inv(D));const x=t.mul(S,B),T=t.mul(C,B),N=t.mul(D,B);if(R)return{x:t.ZERO,y:t.ZERO};if(!t.eql(N,t.ONE))throw Error("invZ was invalid");return{x,y:T}})),U=qn((K=>{if(K.is0()){if(e.allowInfinityPoint&&!t.is0(K.Y))return;throw Error("bad point: ZERO")}const{x:B,y:S}=K.toAffine();if(!t.isValid(B)||!t.isValid(S))throw Error("bad point: x or y not field elements");if(!p(B,S))throw Error("bad point: equation left != right");if(!K.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0}));function Q(K,B,S,C,D){return S=new P(t.mul(S.X,K),S.Y,S.Z),B=_n(C,B),S=_n(D,S),B.add(S)}class P{constructor(B,S,C){this.X=m("x",B),this.Y=m("y",S,!0),this.Z=m("z",C),Object.freeze(this)}static CURVE(){return s}static fromAffine(B){const{x:S,y:C}=B||{};if(!B||!t.isValid(S)||!t.isValid(C))throw Error("invalid affine point");if(B instanceof P)throw Error("projective point not allowed");return t.is0(S)&&t.is0(C)?P.ZERO:new P(S,C,t.ONE)}static fromBytes(B){const S=P.fromAffine(y(gt(B,void 0,"point")));return S.assertValidity(),S}static fromHex(B){return P.fromBytes(le("pointHex",B))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(B=8,S=!0){return b.createCache(this,B),S||this.multiply(yn),this}assertValidity(){U(this)}hasEvenY(){const{y:B}=this.toAffine();if(!t.isOdd)throw Error("Field doesn't support isOdd");return!t.isOdd(B)}equals(B){v(B);const{X:S,Y:C,Z:D}=this,{X:R,Y:x,Z:T}=B,N=t.eql(t.mul(S,T),t.mul(R,D)),F=t.eql(t.mul(C,T),t.mul(x,D));return N&&F}negate(){return new P(this.X,t.neg(this.Y),this.Z)}double(){const{a:B,b:S}=s,C=t.mul(S,yn),{X:D,Y:R,Z:x}=this;let T=t.ZERO,N=t.ZERO,F=t.ZERO,M=t.mul(D,D),z=t.mul(R,R),L=t.mul(x,x),O=t.mul(D,R);return O=t.add(O,O),F=t.mul(D,x),F=t.add(F,F),T=t.mul(B,F),N=t.mul(C,L),N=t.add(T,N),T=t.sub(z,N),N=t.add(z,N),N=t.mul(T,N),T=t.mul(O,T),F=t.mul(C,F),L=t.mul(B,L),O=t.sub(M,L),O=t.mul(B,O),O=t.add(O,F),F=t.add(M,M),M=t.add(F,M),M=t.add(M,L),M=t.mul(M,O),N=t.add(N,M),L=t.mul(R,x),L=t.add(L,L),M=t.mul(L,O),T=t.sub(T,M),F=t.mul(L,z),F=t.add(F,F),F=t.add(F,F),new P(T,N,F)}add(B){v(B);const{X:S,Y:C,Z:D}=this,{X:R,Y:x,Z:T}=B;let N=t.ZERO,F=t.ZERO,M=t.ZERO;const z=s.a,L=t.mul(s.b,yn);let O=t.mul(S,R),H=t.mul(C,x),j=t.mul(D,T),V=t.add(S,C),Z=t.add(R,x);V=t.mul(V,Z),Z=t.add(O,H),V=t.sub(V,Z),Z=t.add(S,D);let q=t.add(R,T);return Z=t.mul(Z,q),q=t.add(O,j),Z=t.sub(Z,q),q=t.add(C,D),N=t.add(x,T),q=t.mul(q,N),N=t.add(H,j),q=t.sub(q,N),M=t.mul(z,Z),N=t.mul(L,j),M=t.add(N,M),N=t.sub(H,M),M=t.add(H,M),F=t.mul(N,M),H=t.add(O,O),H=t.add(H,O),j=t.mul(z,j),Z=t.mul(L,Z),H=t.add(H,j),j=t.sub(O,j),j=t.mul(z,j),Z=t.add(Z,j),O=t.mul(H,Z),F=t.add(F,O),O=t.mul(q,Z),N=t.mul(V,N),N=t.sub(N,O),O=t.mul(V,H),M=t.mul(q,M),M=t.add(M,O),new P(N,F,M)}subtract(B){return this.add(B.negate())}is0(){return this.equals(P.ZERO)}multiply(B){const{endo:S}=e;if(!n.isValidNot0(B))throw Error("invalid scalar: out of range");let C,D;const R=x=>b.cached(this,x,(T=>Cr(P,T)));if(S){const{k1neg:x,k1:T,k2neg:N,k2:F}=E(B),{p:M,f:z}=R(T),{p:L,f:O}=R(F);D=z.add(O),C=Q(S.beta,M,L,x,N)}else{const{p:x,f:T}=R(B);C=x,D=T}return Cr(P,[C,D])[0]}multiplyUnsafe(B){const{endo:S}=e,C=this;if(!n.isValid(B))throw Error("invalid scalar: out of range");if(B===zt||C.is0())return P.ZERO;if(B===Wr)return C;if(b.hasCache(this))return this.multiply(B);if(S){const{k1neg:D,k1:R,k2neg:x,k2:T}=E(B),{p1:N,p2:F}=(function(M,z,L,O){let H=z,j=M.ZERO,V=M.ZERO;for(;L>li||O>li;)L&Kr&&(j=j.add(H)),O&Kr&&(V=V.add(H)),H=H.double(),L>>=Kr,O>>=Kr;return{p1:j,p2:V}})(P,C,R,T);return Q(S.beta,N,F,D,x)}return b.unsafe(C,B)}multiplyAndAddUnsafe(B,S,C){const D=this.multiplyUnsafe(S).add(B.multiplyUnsafe(C));return D.is0()?void 0:D}toAffine(B){return k(this,B)}isTorsionFree(){const{isTorsionFree:B}=e;return a===Wr||(B?B(P,this):b.unsafe(this,o).is0())}clearCofactor(){const{clearCofactor:B}=e;return a===Wr?this:B?B(P,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(B=!0){return Mr(B,"isCompressed"),this.assertValidity(),h(P,this,B)}toHex(B=!0){return xr(this.toBytes(B))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(B=!0){return this.toBytes(B)}_setWindowSize(B){this.precompute(B)}static normalizeZ(B){return Cr(P,B)}static msm(B,S){return E0(P,n,B,S)}static fromPrivateKey(B){return P.BASE.multiply($r(n,B))}}P.BASE=new P(s.Gx,s.Gy,t.ONE),P.ZERO=new P(t.ZERO,t.ONE,t.ZERO),P.Fp=t,P.Fn=n;const I=n.BITS,b=new k0(P,e.endo?Math.ceil(I/2):I);return P.BASE.precompute(8),P}function I0(i){return Uint8Array.of(i?2:3)}function S0(i,e){return{secretKey:e.BYTES,publicKey:1+i.BYTES,publicKeyUncompressed:1+2*i.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function sh(i,e={}){const{Fn:r}=i,t=e.randomBytes||ds,n=Object.assign(S0(i.Fp,r),{seed:tc(r.ORDER)});function s(f){try{return!!$r(r,f)}catch{return!1}}function a(f=t(n.seed)){return(function(h,y,g=!1){const p=h.length,w=c0(y),A=tc(y);if(p<16||p<A||p>1024)throw Error("expected "+A+"-1024 bytes of input, got "+p);const m=Be(g?Fr(h):As(h),y-Ne)+Ne;return g?eo(m,w):$a(m,w)})(gt(f,n.seed,"seed"),r.ORDER)}function o(f,h=!0){return i.BASE.multiply($r(r,f)).toBytes(h)}function c(f){if(typeof f=="bigint")return!1;if(f instanceof i)return!0;const{secretKey:h,publicKey:y,publicKeyUncompressed:g}=n;if(r.allowedLengths||h===y)return;const p=le("key",f).length;return p===y||p===g}return Object.freeze({getPublicKey:o,getSharedSecret:function(f,h,y=!0){if(c(f)===!0)throw Error("first arg must be private key");if(c(h)===!1)throw Error("second arg must be public key");const g=$r(r,f);return i.fromHex(h).multiply(g).toBytes(y)},keygen:function(f){const h=a(f);return{secretKey:h,publicKey:o(h)}},Point:i,utils:{isValidSecretKey:s,isValidPublicKey:function(f,h){const{publicKey:y,publicKeyUncompressed:g}=n;try{const p=f.length;return(h!==!0||p===y)&&(h!==!1||p===g)&&!!i.fromBytes(f)}catch{return!1}},randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:f=>$r(r,f),precompute:(f=8,h=i.BASE)=>h.precompute(f,!1)},lengths:n})}function ah(i,e,r={}){J1(e),pi(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const t=r.randomBytes||ds,n=r.hmac||((I,...b)=>w0(e,I,lt(...b))),{Fp:s,Fn:a}=i,{ORDER:o,BITS:c}=a,{keygen:u,getPublicKey:f,getSharedSecret:h,utils:y,lengths:g}=sh(i,r),p={prehash:!1,lowS:typeof r.lowS=="boolean"&&r.lowS,format:void 0,extraEntropy:!1},w="compact";function A(I){return I>o>>Wr}function m(I,b){if(!a.isValidNot0(b))throw Error(`invalid signature ${I}: out of range 1..Point.Fn.ORDER`);return b}class v{constructor(b,K,B){this.r=m("r",b),this.s=m("s",K),B!=null&&(this.recovery=B),Object.freeze(this)}static fromBytes(b,K=w){let B;if((function(R,x){Ea(x);const T=g.signature;gt(R,x==="compact"?T:x==="recovered"?T+1:void 0,x+" signature")})(b,K),K==="der"){const{r:R,s:x}=Ht.toSig(gt(b));return new v(R,x)}K==="recovered"&&(B=b[0],K="compact",b=b.subarray(1));const S=a.BYTES,C=b.subarray(0,S),D=b.subarray(S,2*S);return new v(a.fromBytes(C),a.fromBytes(D),B)}static fromHex(b,K){return this.fromBytes(Vn(b),K)}addRecoveryBit(b){return new v(this.r,this.s,b)}recoverPublicKey(b){const K=s.ORDER,{r:B,s:S,recovery:C}=this;if(C==null||![0,1,2,3].includes(C))throw Error("recovery id invalid");if(o*B0<K&&C>1)throw Error("recovery id is ambiguous for h>1 curve");const D=C===2||C===3?B+o:B;if(!s.isValid(D))throw Error("recovery id 2 or 3 invalid");const R=s.toBytes(D),x=i.fromBytes(lt(I0(!(1&C)),R)),T=a.inv(D),N=k(le("msgHash",b)),F=a.create(-N*T),M=a.create(S*T),z=i.BASE.multiplyUnsafe(F).add(x.multiplyUnsafe(M));if(z.is0())throw Error("point at infinify");return z.assertValidity(),z}hasHighS(){return A(this.s)}toBytes(b=w){if(Ea(b),b==="der")return Vn(Ht.hexFromSig(this));const K=a.toBytes(this.r),B=a.toBytes(this.s);if(b==="recovered"){if(this.recovery==null)throw Error("recovery bit must be present");return lt(Uint8Array.of(this.recovery),K,B)}return lt(K,B)}toHex(b){return xr(this.toBytes(b))}assertValidity(){}static fromCompact(b){return v.fromBytes(le("sig",b),"compact")}static fromDER(b){return v.fromBytes(le("sig",b),"der")}normalizeS(){return this.hasHighS()?new v(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return xr(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return xr(this.toBytes("compact"))}}const E=r.bits2int||function(I){if(I.length>8192)throw Error("input is too large");const b=As(I),K=8*I.length-c;return K>0?b>>BigInt(K):b},k=r.bits2int_modN||function(I){return a.create(E(I))},U=tn(c);function Q(I){return Yi("num < 2^"+c,I,zt,U),a.toBytes(I)}function P(I,b){return gt(I,void 0,"message"),b?gt(e(I),void 0,"prehashed message"):I}return Object.freeze({keygen:u,getPublicKey:f,getSharedSecret:h,utils:y,lengths:g,Point:i,sign:function(I,b,K={}){I=le("message",I);const{seed:B,k2sig:S}=(function(D,R,x){if(["recovered","canonical"].some((j=>j in x)))throw Error("sign() legacy options not supported");const{lowS:T,prehash:N,extraEntropy:F}=Ns(x,p);D=P(D,N);const M=k(D),z=$r(a,R),L=[Q(z),Q(M)];if(F!=null&&F!==!1){const j=F===!0?t(g.secretKey):F;L.push(le("extraEntropy",j))}const O=lt(...L),H=M;return{seed:O,k2sig:function(j){const V=E(j);if(!a.isValidNot0(V))return;const Z=a.inv(V),q=i.BASE.multiply(V).toAffine(),$=a.create(q.x);if($===zt)return;const W=a.create(Z*a.create(H+$*z));if(W===zt)return;let ie=(q.x===$?0:2)|Number(q.y&Wr),X=W;return T&&A(W)&&(X=a.neg(W),ie^=1),new v($,X,ie)}}})(I,b,K);return(function(D,R,x){if(typeof D!="number"||D<2)throw Error("hashLen must be a number");if(typeof R!="number"||R<2)throw Error("qByteLen must be a number");if(typeof x!="function")throw Error("hmacFn must be a function");const T=V=>new Uint8Array(V),N=V=>Uint8Array.of(V);let F=T(D),M=T(D),z=0;const L=()=>{F.fill(1),M.fill(0),z=0},O=(...V)=>x(M,F,...V),H=(V=T(0))=>{M=O(N(0),V),F=O(),V.length!==0&&(M=O(N(1),V),F=O())},j=()=>{if(z++>=1e3)throw Error("drbg: tried 1000 values");let V=0;const Z=[];for(;V<R;){F=O();const q=F.slice();Z.push(q),V+=F.length}return lt(...Z)};return(V,Z)=>{let q;for(L(),H(V);!(q=Z(j()));)H();return L(),q}})(e.outputLen,a.BYTES,n)(B,S)},verify:function(I,b,K,B={}){const{lowS:S,prehash:C,format:D}=Ns(B,p);if(K=le("publicKey",K),b=P(le("message",b),C),"strict"in B)throw Error("options.strict was renamed to lowS");const R=D===void 0?(function(x){let T;const N=typeof x=="string"||$i(x),F=!N&&x!==null&&typeof x=="object"&&typeof x.r=="bigint"&&typeof x.s=="bigint";if(!N&&!F)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(F)T=new v(x.r,x.s);else if(N){try{T=v.fromBytes(le("sig",x),"der")}catch(M){if(!(M instanceof Ht.Err))throw M}if(!T)try{T=v.fromBytes(le("sig",x),"compact")}catch{return!1}}return T||!1})(I):v.fromBytes(le("sig",I),D);if(R===!1)return!1;try{const x=i.fromBytes(K);if(S&&R.hasHighS())return!1;const{r:T,s:N}=R,F=k(b),M=a.inv(N),z=a.create(F*M),L=a.create(T*M),O=i.BASE.multiplyUnsafe(z).add(x.multiplyUnsafe(L));return O.is0()?!1:a.create(O.x)===T}catch{return!1}},recoverPublicKey:function(I,b,K={}){const{prehash:B}=Ns(K,p);return b=P(b,B),v.fromBytes(I,"recovered").recoverPublicKey(b).toBytes()},Signature:v,hash:e})}function oh(i){const{CURVE:e,curveOpts:r}=(function(n){const s={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},a=n.Fp;let o=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map((c=>Math.ceil(c/2))))):void 0;return{CURVE:s,curveOpts:{Fp:a,Fn:Je(s.n,{BITS:n.nBitLength,allowedLengths:o,modFromBytes:n.wrapPrivateKey}),allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes}}})(i),t={hmac:i.hmac,randomBytes:i.randomBytes,lowS:i.lowS,bits2int:i.bits2int,bits2int_modN:i.bits2int_modN};return{CURVE:e,curveOpts:r,hash:i.hash,ecdsaOpts:t}}function ch(i){const{CURVE:e,curveOpts:r,hash:t,ecdsaOpts:n}=oh(i);return(function(s,a){const o=a.Point;return Object.assign({},a,{ProjectivePoint:o,CURVE:Object.assign({},s,o0(o.Fn.ORDER,o.Fn.BITS))})})(i,ah(nh(e,r),t,n))}function Nr(i,e){const r=t=>ch({...i,hash:t});return{...r(e),create:r}}const K0={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},C0={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},U0={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},uh=Je(K0.p),hh=Je(C0.p),fh=Je(U0.p),lh=Nr({...K0,Fp:uh,lowS:!1},ro),yh=Nr({...C0,Fp:hh,lowS:!1},d0),gh=Nr({...U0,Fp:fh,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},p0),ph=BigInt(0),Bi=BigInt(1),dh=BigInt(2),Ah=BigInt(7),wh=BigInt(256),mh=BigInt(113),P0=[],D0=[],x0=[];for(let i=0,e=Bi,r=1,t=0;i<24;i++){[r,t]=[t,(2*r+3*t)%5],P0.push(2*(5*t+r)),D0.push((i+1)*(i+2)/2%64);let n=ph;for(let s=0;s<7;s++)e=(e<<Bi^(e>>Ah)*mh)%wh,e&dh&&(n^=Bi<<(Bi<<BigInt(s))-Bi);x0.push(n)}const Q0=f0(x0,!0),bh=Q0[0],kh=Q0[1],uc=(i,e,r)=>r>32?((t,n,s)=>n<<s-32|t>>>64-s)(i,e,r):((t,n,s)=>t<<s|n>>>32-s)(i,e,r),hc=(i,e,r)=>r>32?((t,n,s)=>t<<s-32|n>>>64-s)(i,e,r):((t,n,s)=>n<<s|t>>>32-s)(i,e,r);class ws extends Xa{constructor(e,r,t,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=t,this.enableXOF=n,this.rounds=s,_i(t),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}clone(){return this._cloneInto()}keccak(){Vo(this.state32),(function(e,r=24){const t=new Uint32Array(10);for(let n=24-r;n<24;n++){for(let o=0;o<10;o++)t[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,u=(o+2)%10,f=t[u],h=t[u+1],y=uc(f,h,1)^t[c],g=hc(f,h,1)^t[c+1];for(let p=0;p<50;p+=10)e[o+p]^=y,e[o+p+1]^=g}let s=e[2],a=e[3];for(let o=0;o<24;o++){const c=D0[o],u=uc(s,a,c),f=hc(s,a,c),h=P0[o];s=e[h],a=e[h+1],e[h]=u,e[h+1]=f}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)t[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~t[(c+2)%10]&t[(c+4)%10]}e[0]^=bh[n],e[1]^=kh[n]}ct(t)})(this.state32,this.rounds),Vo(this.state32),this.posOut=0,this.pos=0}update(e){fi(this),Qt(e=en(e));const{blockLen:r,state:t}=this,n=e.length;for(let s=0;s<n;){const a=Math.min(r-this.pos,n-s);for(let o=0;o<a;o++)t[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:t,blockLen:n}=this;e[t]^=r,128&r&&t===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){fi(this,!1),Qt(e),this.finish();const r=this.state,{blockLen:t}=this;for(let n=0,s=e.length;n<s;){this.posOut>=t&&this.keccak();const a=Math.min(t-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+a),n),this.posOut+=a,n+=a}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return _i(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(X1(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ct(this.state)}_cloneInto(e){const{blockLen:r,suffix:t,outputLen:n,rounds:s,enableXOF:a}=this;return e||(e=new ws(r,t,n,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=t,e.outputLen=n,e.enableXOF=a,e.destroyed=this.destroyed,e}}const R0=(i,e,r)=>Wt((()=>new ws(e,i,r))),Eh=R0(6,136,32),vh=R0(6,72,64),Bh=(i,e,r)=>(function(t){const n=(a,o)=>t(o).update(en(a)).digest(),s=t({});return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=a=>t(a),n})(((t={})=>new ws(e,i,t.dkLen===void 0?r:t.dkLen,!0))),Ih=Bh(31,136,32),nr=BigInt(0),Se=BigInt(1),Os=BigInt(2),Sh=BigInt(8);function T0(i,e={}){const r=v0("edwards",i,e,e.FpFnLE),{Fp:t,Fn:n}=r;let s=r.CURVE;const{h:a}=s;pi(e,{},{uvRatio:"function"});const o=Os<<BigInt(8*n.BYTES)-Se,c=A=>t.create(A),u=e.uvRatio||((A,m)=>{try{return{isValid:!0,value:t.sqrt(t.div(A,m))}}catch{return{isValid:!1,value:nr}}});if(!(function(A,m,v,E){const k=A.sqr(v),U=A.sqr(E),Q=A.add(A.mul(m.a,k),U),P=A.add(A.ONE,A.mul(m.d,A.mul(k,U)));return A.eql(Q,P)})(t,s,s.Gx,s.Gy))throw Error("bad curve params: generator point");function f(A,m,v=!1){return Yi("coordinate "+A,m,v?Se:nr,o),m}function h(A){if(!(A instanceof p))throw Error("ExtendedPoint expected")}const y=qn(((A,m)=>{const{X:v,Y:E,Z:k}=A,U=A.is0();m==null&&(m=U?Sh:t.inv(k));const Q=c(v*m),P=c(E*m),I=t.mul(k,m);if(U)return{x:nr,y:Se};if(I!==Se)throw Error("invZ was invalid");return{x:Q,y:P}})),g=qn((A=>{const{a:m,d:v}=s;if(A.is0())throw Error("bad point: ZERO");const{X:E,Y:k,Z:U,T:Q}=A,P=c(E*E),I=c(k*k),b=c(U*U),K=c(b*b),B=c(P*m);if(c(b*c(B+I))!==c(K+c(v*c(P*I))))throw Error("bad point: equation left != right (1)");if(c(E*k)!==c(U*Q))throw Error("bad point: equation left != right (2)");return!0}));class p{constructor(m,v,E,k){this.X=f("x",m),this.Y=f("y",v),this.Z=f("z",E,!0),this.T=f("t",k),Object.freeze(this)}static CURVE(){return s}static fromAffine(m){if(m instanceof p)throw Error("extended point not allowed");const{x:v,y:E}=m||{};return f("x",v),f("y",E),new p(v,E,Se,c(v*E))}static fromBytes(m,v=!1){const E=t.BYTES,{a:k,d:U}=s;m=Jo(gt(m,E,"point")),Mr(v,"zip215");const Q=Jo(m),P=m[E-1];Q[E-1]=-129&P;const I=Fr(Q),b=v?o:t.ORDER;Yi("point.y",I,nr,b);const K=c(I*I),B=c(K-Se),S=c(U*K-k);let{isValid:C,value:D}=u(B,S);if(!C)throw Error("bad point: invalid y coordinate");const R=(D&Se)===Se,x=!!(128&P);if(!v&&D===nr&&x)throw Error("bad point: x=0 and x_0=1");return x!==R&&(D=c(-D)),p.fromAffine({x:D,y:I})}static fromHex(m,v=!1){return p.fromBytes(le("point",m),v)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(m=8,v=!0){return w.createCache(this,m),v||this.multiply(Os),this}assertValidity(){g(this)}equals(m){h(m);const{X:v,Y:E,Z:k}=this,{X:U,Y:Q,Z:P}=m,I=c(v*P),b=c(U*k),K=c(E*P),B=c(Q*k);return I===b&&K===B}is0(){return this.equals(p.ZERO)}negate(){return new p(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:m}=s,{X:v,Y:E,Z:k}=this,U=c(v*v),Q=c(E*E),P=c(Os*c(k*k)),I=c(m*U),b=v+E,K=c(c(b*b)-U-Q),B=I+Q,S=B-P,C=I-Q,D=c(K*S),R=c(B*C),x=c(K*C),T=c(S*B);return new p(D,R,T,x)}add(m){h(m);const{a:v,d:E}=s,{X:k,Y:U,Z:Q,T:P}=this,{X:I,Y:b,Z:K,T:B}=m,S=c(k*I),C=c(U*b),D=c(P*E*B),R=c(Q*K),x=c((k+U)*(I+b)-S-C),T=R-D,N=R+D,F=c(C-v*S),M=c(x*T),z=c(N*F),L=c(x*F),O=c(T*N);return new p(M,z,O,L)}subtract(m){return this.add(m.negate())}multiply(m){if(!n.isValidNot0(m))throw Error("invalid scalar: expected 1 <= sc < curve.n");const{p:v,f:E}=w.cached(this,m,(k=>Cr(p,k)));return Cr(p,[v,E])[0]}multiplyUnsafe(m,v=p.ZERO){if(!n.isValid(m))throw Error("invalid scalar: expected 0 <= sc < curve.n");return m===nr?p.ZERO:this.is0()||m===Se?this:w.unsafe(this,m,(E=>Cr(p,E)),v)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,s.n).is0()}toAffine(m){return y(this,m)}clearCofactor(){return a===Se?this:this.multiplyUnsafe(a)}toBytes(){const{x:m,y:v}=this.toAffine(),E=t.toBytes(v);return E[E.length-1]|=m&Se?128:0,E}toHex(){return xr(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(m){return Cr(p,m)}static msm(m,v){return E0(p,n,m,v)}_setWindowSize(m){this.precompute(m)}toRawBytes(){return this.toBytes()}}p.BASE=new p(s.Gx,s.Gy,Se,c(s.Gx*s.Gy)),p.ZERO=new p(nr,Se,Se,nr),p.Fp=t,p.Fn=n;const w=new k0(p,n.BITS);return p.BASE.precompute(8),p}function Kh(i,e,r={}){if(typeof e!="function")throw Error('"hash" function param is required');pi(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:t}=r,{BASE:n,Fp:s,Fn:a}=i,o=r.randomBytes||ds,c=r.adjustScalarBytes||(E=>E),u=r.domain||((E,k,U)=>{if(Mr(U,"phflag"),k.length||U)throw Error("Contexts/pre-hash are not supported");return E});function f(E){return a.create(Fr(E))}function h(E){const{head:k,prefix:U,scalar:Q}=(function(b){const K=A.secretKey;b=le("private key",b,K);const B=le("hashed private key",e(b),2*K),S=c(B.slice(0,K));return{head:S,prefix:B.slice(K,2*K),scalar:f(S)}})(E),P=n.multiply(Q),I=P.toBytes();return{head:k,prefix:U,scalar:Q,point:P,pointBytes:I}}function y(E){return h(E).pointBytes}function g(E=Uint8Array.of(),...k){const U=lt(...k);return f(e(u(U,le("context",E),!!t)))}const p={zip215:!0},w=s.BYTES,A={secretKey:w,publicKey:w,signature:2*w,seed:w};function m(E=o(A.seed)){return gt(E,A.seed,"seed")}const v={getExtendedPublicKey:h,randomSecretKey:m,isValidSecretKey:function(E){return $i(E)&&E.length===a.BYTES},isValidPublicKey:function(E,k){try{return!!i.fromBytes(E,k)}catch{return!1}},toMontgomery(E){const{y:k}=i.fromBytes(E),U=A.publicKey,Q=U===32;if(!Q&&U!==57)throw Error("only defined for 25519 and 448");const P=Q?s.div(Se+k,Se-k):s.div(k-Se,k+Se);return s.toBytes(P)},toMontgomeryPriv(E){const k=A.secretKey;gt(E,k);const U=e(E.subarray(0,k));return c(U).subarray(0,k)},randomPrivateKey:m,precompute:(E=8,k=i.BASE)=>k.precompute(E,!1)};return Object.freeze({keygen:function(E){const k=v.randomSecretKey(E);return{secretKey:k,publicKey:y(k)}},getPublicKey:y,sign:function(E,k,U={}){E=le("message",E),t&&(E=t(E));const{prefix:Q,scalar:P,pointBytes:I}=h(k),b=g(U.context,Q,E),K=n.multiply(b).toBytes(),B=g(U.context,K,I,E),S=a.create(b+B*P);if(!a.isValid(S))throw Error("sign failed: invalid s");return gt(lt(K,a.toBytes(S)),A.signature,"result")},verify:function(E,k,U,Q=p){const{context:P,zip215:I}=Q,b=A.signature;E=le("signature",E,b),k=le("message",k),U=le("publicKey",U,A.publicKey),I!==void 0&&Mr(I,"zip215"),t&&(k=t(k));const K=b/2,B=E.subarray(0,K),S=Fr(E.subarray(K,b));let C,D,R;try{C=i.fromBytes(U,I),D=i.fromBytes(B,I),R=n.multiplyUnsafe(S)}catch{return!1}if(!I&&C.isSmallOrder())return!1;const x=g(P,D.toBytes(),C.toBytes(),k);return D.add(C.multiplyUnsafe(x)).subtract(R).clearCofactor().is0()},utils:v,Point:i,lengths:A})}const Ii=BigInt(0),Vr=BigInt(1),gn=BigInt(2);function Ch(i){const e=(pi(r=i,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r}));var r;const{P:t,type:n,adjustScalarBytes:s,powPminus2:a,randomBytes:o}=e,c=n==="x25519";if(!c&&n!=="x448")throw Error("invalid type");const u=o||ds,f=c?255:448,h=c?32:56,y=BigInt(c?9:5),g=BigInt(c?121665:39081),p=c?gn**BigInt(254):gn**BigInt(447),w=c?BigInt(8)*gn**BigInt(251)-Vr:BigInt(4)*gn**BigInt(445)-Vr,A=p+w+Vr,m=b=>Be(b,t),v=E(y);function E(b){return eo(m(b),h)}function k(b,K){const B=(function(S,C){Yi("u",S,Ii,t),Yi("scalar",C,p,A);const D=C,R=S;let x=Vr,T=Ii,N=S,F=Vr,M=Ii;for(let L=BigInt(f-1);L>=Ii;L--){const O=D>>L&Vr;M^=O,{x_2:x,x_3:N}=Q(M,x,N),{x_2:T,x_3:F}=Q(M,T,F),M=O;const H=x+T,j=m(H*H),V=x-T,Z=m(V*V),q=j-Z,$=N+F,W=m((N-F)*H),ie=m($*V),X=W+ie,ge=W-ie;N=m(X*X),F=m(R*m(ge*ge)),x=m(j*Z),T=m(q*(j+m(g*q)))}({x_2:x,x_3:N}=Q(M,x,N)),{x_2:T,x_3:F}=Q(M,T,F);const z=a(T);return m(x*z)})((function(S){const C=le("u coordinate",S,h);return c&&(C[31]&=127),m(Fr(C))})(K),(function(S){return Fr(s(le("scalar",S,h)))})(b));if(B===Ii)throw Error("invalid private or public key received");return E(B)}function U(b){return k(b,v)}function Q(b,K,B){const S=m(b*(K-B));return{x_2:K=m(K-S),x_3:B=m(B+S)}}const P={secretKey:h,publicKey:h,seed:h},I=(b=u(h))=>(Qt(b,P.seed),b);return{keygen:function(b){const K=I(b);return{secretKey:K,publicKey:U(K)}},getSharedSecret:(b,K)=>k(b,K),getPublicKey:b=>U(b),scalarMult:k,scalarMultBase:U,utils:{randomSecretKey:I,randomPrivateKey:I},GuBytes:v.slice(),lengths:P}}const Or={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},Uh=Object.assign({},Or,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),Ph=Wt((()=>Ih.create({dkLen:114}))),Dh=BigInt(1),va=BigInt(2),fc=BigInt(3);BigInt(4);const xh=BigInt(11),Qh=BigInt(22),lc=BigInt(44),Rh=BigInt(88),Th=BigInt(223);function M0(i){const e=Or.p,r=i*i*i%e,t=r*r*i%e,n=fe(t,fc,e)*t%e,s=fe(n,fc,e)*t%e,a=fe(s,va,e)*r%e,o=fe(a,xh,e)*a%e,c=fe(o,Qh,e)*o%e,u=fe(c,lc,e)*c%e,f=fe(u,Rh,e)*u%e,h=fe(f,lc,e)*c%e,y=fe(h,va,e)*r%e,g=fe(y,Dh,e)*i%e;return fe(g,Th,e)*y%e}function F0(i){return i[0]&=252,i[55]|=128,i[56]=0,i}function Mh(i,e){const r=Or.p,t=Be(i*i*e,r),n=Be(t*i,r),s=Be(n*t*e,r),a=Be(n*M0(s),r),o=Be(a*a,r);return{isValid:Be(o*e,r)===i,value:a}}const Fh=Je(Or.p,{BITS:456,isLE:!0}),yc=Je(Or.n,{BITS:456,isLE:!0});function Lh(i,e,r){if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return lt((t="SigEd448",Uint8Array.from(t,((n,s)=>{const a=n.charCodeAt(0);if(n.length!==1||a>127)throw Error(`string contains non-ASCII character "${t[s]}" with code ${a} at position ${s}`);return a}))),new Uint8Array([r?1:0,e.length]),e,i);var t}const Nh=(function(i){const{CURVE:e,curveOpts:r,hash:t,eddsaOpts:n}=(function(s){const a={a:s.a,d:s.d,p:s.Fp.ORDER,n:s.n,h:s.h,Gx:s.Gx,Gy:s.Gy},o={Fp:s.Fp,Fn:Je(a.n,s.nBitLength,!0),uvRatio:s.uvRatio},c={randomBytes:s.randomBytes,adjustScalarBytes:s.adjustScalarBytes,domain:s.domain,prehash:s.prehash,mapToCurve:s.mapToCurve};return{CURVE:a,curveOpts:o,hash:s.hash,eddsaOpts:c}})(i);return(function(s,a){const o=a.Point;return Object.assign({},a,{ExtendedPoint:o,CURVE:s,nBitLength:o.Fn.BITS,nByteLength:o.Fn.BYTES})})(i,Kh(T0(e,r),t,n))})({...Or,Fp:Fh,Fn:yc,nBitLength:yc.BITS,hash:Ph,adjustScalarBytes:F0,domain:Lh,uvRatio:Mh});T0(Uh);const Oh=(()=>{const i=Or.p;return Ch({P:i,type:"x448",powPminus2:e=>Be(fe(M0(e),va,i)*e,i),adjustScalarBytes:F0})})(),Ba={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Hh={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},gc=BigInt(2);const Ia=Je(Ba.p,{sqrt:function(i){const e=Ba.p,r=BigInt(3),t=BigInt(6),n=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=i*i*i%e,f=u*u*i%e,h=fe(f,r,e)*f%e,y=fe(h,r,e)*f%e,g=fe(y,gc,e)*u%e,p=fe(g,n,e)*g%e,w=fe(p,s,e)*p%e,A=fe(w,o,e)*w%e,m=fe(A,c,e)*A%e,v=fe(m,o,e)*w%e,E=fe(v,r,e)*f%e,k=fe(E,a,e)*p%e,U=fe(k,t,e)*u%e,Q=fe(U,gc,e);if(!Ia.eql(Ia.sqr(Q),i))throw Error("Cannot find square root");return Q}}),zh=Nr({...Ba,Fp:Ia,lowS:!0,endo:Hh},ro),L0=ro,Gh=rh,pc=Je(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),jh=Nr({a:pc.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:pc,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},L0),N0=p0,O0=d0,dc=Je(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Vh=Nr({a:dc.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:dc,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},O0),Ac=Je(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),qh=Nr({a:Ac.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:Ac,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},N0),_h=new Map(Object.entries({nistP256:lh,nistP384:yh,nistP521:gh,brainpoolP256r1:jh,brainpoolP384r1:Vh,brainpoolP512r1:qh,secp256k1:zh,x448:Oh,ed448:Nh}));var Yh=Object.freeze({__proto__:null,nobleCurves:_h});const Si=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),sr=new Uint32Array(80);class Zh extends rn{constructor(){super(64,20,8,!1),this.A=0|Si[0],this.B=0|Si[1],this.C=0|Si[2],this.D=0|Si[3],this.E=0|Si[4]}get(){const{A:e,B:r,C:t,D:n,E:s}=this;return[e,r,t,n,s]}set(e,r,t,n,s){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|n,this.E=0|s}process(e,r){for(let c=0;c<16;c++,r+=4)sr[c]=e.getUint32(r,!1);for(let c=16;c<80;c++)sr[c]=fr(sr[c-3]^sr[c-8]^sr[c-14]^sr[c-16],1);let{A:t,B:n,C:s,D:a,E:o}=this;for(let c=0;c<80;c++){let u,f;c<20?(u=u0(n,s,a),f=1518500249):c<40?(u=n^s^a,f=1859775393):c<60?(u=h0(n,s,a),f=2400959708):(u=n^s^a,f=3395469782);const h=fr(t,5)+u+o+f+sr[c]|0;o=a,a=s,s=fr(n,30),n=t,t=h}t=t+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,this.set(t,n,s,a,o)}roundClean(){ct(sr)}destroy(){this.set(0,0,0,0,0),ct(this.buffer)}}const Jh=Wt((()=>new Zh)),Xh=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),H0=Uint8Array.from(Array(16).fill(0).map(((i,e)=>e))),Wh=H0.map((i=>(9*i+5)%16)),z0=(()=>{const i=[[H0],[Wh]];for(let e=0;e<4;e++)for(let r of i)r.push(r[e].map((t=>Xh[t])));return i})(),G0=z0[0],j0=z0[1],V0=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((i=>Uint8Array.from(i))),$h=G0.map(((i,e)=>i.map((r=>V0[e][r])))),e5=j0.map(((i,e)=>i.map((r=>V0[e][r])))),t5=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),r5=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function wc(i,e,r,t){return i===0?e^r^t:i===1?e&r|~e&t:i===2?(e|~r)^t:i===3?e&t|r&~t:e^(r|~t)}const pn=new Uint32Array(16);class i5 extends rn{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:r,h2:t,h3:n,h4:s}=this;return[e,r,t,n,s]}set(e,r,t,n,s){this.h0=0|e,this.h1=0|r,this.h2=0|t,this.h3=0|n,this.h4=0|s}process(e,r){for(let g=0;g<16;g++,r+=4)pn[g]=e.getUint32(r,!0);let t=0|this.h0,n=t,s=0|this.h1,a=s,o=0|this.h2,c=o,u=0|this.h3,f=u,h=0|this.h4,y=h;for(let g=0;g<5;g++){const p=4-g,w=t5[g],A=r5[g],m=G0[g],v=j0[g],E=$h[g],k=e5[g];for(let U=0;U<16;U++){const Q=fr(t+wc(g,s,o,u)+pn[m[U]]+w,E[U])+h|0;t=h,h=u,u=0|fr(o,10),o=s,s=Q}for(let U=0;U<16;U++){const Q=fr(n+wc(p,a,c,f)+pn[v[U]]+A,k[U])+y|0;n=y,y=f,f=0|fr(c,10),c=a,a=Q}}this.set(this.h1+o+f|0,this.h2+u+y|0,this.h3+h+n|0,this.h4+t+a|0,this.h0+s+c|0)}roundClean(){ct(pn)}destroy(){this.destroyed=!0,ct(this.buffer),this.set(0,0,0,0,0)}}const n5=Jh,s5=Wt((()=>new i5)),a5=Array.from({length:64},((i,e)=>Math.floor(2**32*Math.abs(Math.sin(e+1))))),mc=(i,e,r)=>i&e^~i&r,dn=new Uint32Array([1732584193,4023233417,2562383102,271733878]),Hs=new Uint32Array(16);class o5 extends rn{constructor(){super(64,16,8,!0),this.A=0|dn[0],this.B=0|dn[1],this.C=0|dn[2],this.D=0|dn[3]}get(){const{A:e,B:r,C:t,D:n}=this;return[e,r,t,n]}set(e,r,t,n){this.A=0|e,this.B=0|r,this.C=0|t,this.D=0|n}process(e,r){for(let o=0;o<16;o++,r+=4)Hs[o]=e.getUint32(r,!0);let{A:t,B:n,C:s,D:a}=this;for(let o=0;o<64;o++){let c,u,f;o<16?(c=mc(n,s,a),u=o,f=[7,12,17,22]):o<32?(c=mc(a,n,s),u=(5*o+1)%16,f=[5,9,14,20]):o<48?(c=n^s^a,u=(3*o+5)%16,f=[4,11,16,23]):(c=s^(n|~a),u=7*o%16,f=[6,10,15,21]),c=c+t+a5[o]+Hs[u],t=a,a=s,s=n,n+=fr(c,f[o%4])}t=t+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,this.set(t,n,s,a)}roundClean(){Hs.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const c5=new Map(Object.entries({md5:Lu((()=>new o5)),sha1:n5,sha224:Gh,sha256:L0,sha384:O0,sha512:N0,sha3_256:Eh,sha3_512:vh,ripemd160:s5}));var u5=Object.freeze({__proto__:null,nobleHashes:c5});const zs=typeof Me=="object"&&"crypto"in Me?Me.crypto:void 0,ze={};var _=function(i){var e,r=new Float64Array(16);if(i)for(e=0;e<i.length;e++)r[e]=i[e];return r},Sa=function(){throw Error("no PRNG")},q0=new Uint8Array(32);q0[0]=9;var Ka=_(),Yn=_([1]),h5=_([56129,1]),f5=_([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l5=_([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),bc=_([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),kc=_([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y5=_([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Ec(i,e,r,t){i[e]=r>>24&255,i[e+1]=r>>16&255,i[e+2]=r>>8&255,i[e+3]=255&r,i[e+4]=t>>24&255,i[e+5]=t>>16&255,i[e+6]=t>>8&255,i[e+7]=255&t}function _0(i,e,r,t){return(function(n,s,a,o,c){var u,f=0;for(u=0;u<c;u++)f|=n[s+u]^a[o+u];return(1&f-1>>>8)-1})(i,e,r,t,32)}function lr(i,e){var r;for(r=0;r<16;r++)i[r]=0|e[r]}function Gs(i){var e,r,t=1;for(e=0;e<16;e++)r=i[e]+t+65535,t=Math.floor(r/65536),i[e]=r-65536*t;i[0]+=t-1+37*(t-1)}function ei(i,e,r){for(var t,n=~(r-1),s=0;s<16;s++)t=n&(i[s]^e[s]),i[s]^=t,e[s]^=t}function Zi(i,e){var r,t,n,s=_(),a=_();for(r=0;r<16;r++)a[r]=e[r];for(Gs(a),Gs(a),Gs(a),t=0;t<2;t++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,ei(a,s,1-n)}for(r=0;r<16;r++)i[2*r]=255&a[r],i[2*r+1]=a[r]>>8}function vc(i,e){var r=new Uint8Array(32),t=new Uint8Array(32);return Zi(r,i),Zi(t,e),_0(r,0,t,0)}function Y0(i){var e=new Uint8Array(32);return Zi(e,i),1&e[0]}function Z0(i,e){var r;for(r=0;r<16;r++)i[r]=e[2*r]+(e[2*r+1]<<8);i[15]&=32767}function Bt(i,e,r){for(var t=0;t<16;t++)i[t]=e[t]+r[t]}function Kt(i,e,r){for(var t=0;t<16;t++)i[t]=e[t]-r[t]}function te(i,e,r){var t,n,s=0,a=0,o=0,c=0,u=0,f=0,h=0,y=0,g=0,p=0,w=0,A=0,m=0,v=0,E=0,k=0,U=0,Q=0,P=0,I=0,b=0,K=0,B=0,S=0,C=0,D=0,R=0,x=0,T=0,N=0,F=0,M=r[0],z=r[1],L=r[2],O=r[3],H=r[4],j=r[5],V=r[6],Z=r[7],q=r[8],$=r[9],W=r[10],ie=r[11],X=r[12],ge=r[13],de=r[14],pe=r[15];s+=(t=e[0])*M,a+=t*z,o+=t*L,c+=t*O,u+=t*H,f+=t*j,h+=t*V,y+=t*Z,g+=t*q,p+=t*$,w+=t*W,A+=t*ie,m+=t*X,v+=t*ge,E+=t*de,k+=t*pe,a+=(t=e[1])*M,o+=t*z,c+=t*L,u+=t*O,f+=t*H,h+=t*j,y+=t*V,g+=t*Z,p+=t*q,w+=t*$,A+=t*W,m+=t*ie,v+=t*X,E+=t*ge,k+=t*de,U+=t*pe,o+=(t=e[2])*M,c+=t*z,u+=t*L,f+=t*O,h+=t*H,y+=t*j,g+=t*V,p+=t*Z,w+=t*q,A+=t*$,m+=t*W,v+=t*ie,E+=t*X,k+=t*ge,U+=t*de,Q+=t*pe,c+=(t=e[3])*M,u+=t*z,f+=t*L,h+=t*O,y+=t*H,g+=t*j,p+=t*V,w+=t*Z,A+=t*q,m+=t*$,v+=t*W,E+=t*ie,k+=t*X,U+=t*ge,Q+=t*de,P+=t*pe,u+=(t=e[4])*M,f+=t*z,h+=t*L,y+=t*O,g+=t*H,p+=t*j,w+=t*V,A+=t*Z,m+=t*q,v+=t*$,E+=t*W,k+=t*ie,U+=t*X,Q+=t*ge,P+=t*de,I+=t*pe,f+=(t=e[5])*M,h+=t*z,y+=t*L,g+=t*O,p+=t*H,w+=t*j,A+=t*V,m+=t*Z,v+=t*q,E+=t*$,k+=t*W,U+=t*ie,Q+=t*X,P+=t*ge,I+=t*de,b+=t*pe,h+=(t=e[6])*M,y+=t*z,g+=t*L,p+=t*O,w+=t*H,A+=t*j,m+=t*V,v+=t*Z,E+=t*q,k+=t*$,U+=t*W,Q+=t*ie,P+=t*X,I+=t*ge,b+=t*de,K+=t*pe,y+=(t=e[7])*M,g+=t*z,p+=t*L,w+=t*O,A+=t*H,m+=t*j,v+=t*V,E+=t*Z,k+=t*q,U+=t*$,Q+=t*W,P+=t*ie,I+=t*X,b+=t*ge,K+=t*de,B+=t*pe,g+=(t=e[8])*M,p+=t*z,w+=t*L,A+=t*O,m+=t*H,v+=t*j,E+=t*V,k+=t*Z,U+=t*q,Q+=t*$,P+=t*W,I+=t*ie,b+=t*X,K+=t*ge,B+=t*de,S+=t*pe,p+=(t=e[9])*M,w+=t*z,A+=t*L,m+=t*O,v+=t*H,E+=t*j,k+=t*V,U+=t*Z,Q+=t*q,P+=t*$,I+=t*W,b+=t*ie,K+=t*X,B+=t*ge,S+=t*de,C+=t*pe,w+=(t=e[10])*M,A+=t*z,m+=t*L,v+=t*O,E+=t*H,k+=t*j,U+=t*V,Q+=t*Z,P+=t*q,I+=t*$,b+=t*W,K+=t*ie,B+=t*X,S+=t*ge,C+=t*de,D+=t*pe,A+=(t=e[11])*M,m+=t*z,v+=t*L,E+=t*O,k+=t*H,U+=t*j,Q+=t*V,P+=t*Z,I+=t*q,b+=t*$,K+=t*W,B+=t*ie,S+=t*X,C+=t*ge,D+=t*de,R+=t*pe,m+=(t=e[12])*M,v+=t*z,E+=t*L,k+=t*O,U+=t*H,Q+=t*j,P+=t*V,I+=t*Z,b+=t*q,K+=t*$,B+=t*W,S+=t*ie,C+=t*X,D+=t*ge,R+=t*de,x+=t*pe,v+=(t=e[13])*M,E+=t*z,k+=t*L,U+=t*O,Q+=t*H,P+=t*j,I+=t*V,b+=t*Z,K+=t*q,B+=t*$,S+=t*W,C+=t*ie,D+=t*X,R+=t*ge,x+=t*de,T+=t*pe,E+=(t=e[14])*M,k+=t*z,U+=t*L,Q+=t*O,P+=t*H,I+=t*j,b+=t*V,K+=t*Z,B+=t*q,S+=t*$,C+=t*W,D+=t*ie,R+=t*X,x+=t*ge,T+=t*de,N+=t*pe,k+=(t=e[15])*M,a+=38*(Q+=t*L),o+=38*(P+=t*O),c+=38*(I+=t*H),u+=38*(b+=t*j),f+=38*(K+=t*V),h+=38*(B+=t*Z),y+=38*(S+=t*q),g+=38*(C+=t*$),p+=38*(D+=t*W),w+=38*(R+=t*ie),A+=38*(x+=t*X),m+=38*(T+=t*ge),v+=38*(N+=t*de),E+=38*(F+=t*pe),s=(t=(s+=38*(U+=t*z))+(n=1)+65535)-65536*(n=Math.floor(t/65536)),a=(t=a+n+65535)-65536*(n=Math.floor(t/65536)),o=(t=o+n+65535)-65536*(n=Math.floor(t/65536)),c=(t=c+n+65535)-65536*(n=Math.floor(t/65536)),u=(t=u+n+65535)-65536*(n=Math.floor(t/65536)),f=(t=f+n+65535)-65536*(n=Math.floor(t/65536)),h=(t=h+n+65535)-65536*(n=Math.floor(t/65536)),y=(t=y+n+65535)-65536*(n=Math.floor(t/65536)),g=(t=g+n+65535)-65536*(n=Math.floor(t/65536)),p=(t=p+n+65535)-65536*(n=Math.floor(t/65536)),w=(t=w+n+65535)-65536*(n=Math.floor(t/65536)),A=(t=A+n+65535)-65536*(n=Math.floor(t/65536)),m=(t=m+n+65535)-65536*(n=Math.floor(t/65536)),v=(t=v+n+65535)-65536*(n=Math.floor(t/65536)),E=(t=E+n+65535)-65536*(n=Math.floor(t/65536)),k=(t=k+n+65535)-65536*(n=Math.floor(t/65536)),s=(t=(s+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(t/65536)),a=(t=a+n+65535)-65536*(n=Math.floor(t/65536)),o=(t=o+n+65535)-65536*(n=Math.floor(t/65536)),c=(t=c+n+65535)-65536*(n=Math.floor(t/65536)),u=(t=u+n+65535)-65536*(n=Math.floor(t/65536)),f=(t=f+n+65535)-65536*(n=Math.floor(t/65536)),h=(t=h+n+65535)-65536*(n=Math.floor(t/65536)),y=(t=y+n+65535)-65536*(n=Math.floor(t/65536)),g=(t=g+n+65535)-65536*(n=Math.floor(t/65536)),p=(t=p+n+65535)-65536*(n=Math.floor(t/65536)),w=(t=w+n+65535)-65536*(n=Math.floor(t/65536)),A=(t=A+n+65535)-65536*(n=Math.floor(t/65536)),m=(t=m+n+65535)-65536*(n=Math.floor(t/65536)),v=(t=v+n+65535)-65536*(n=Math.floor(t/65536)),E=(t=E+n+65535)-65536*(n=Math.floor(t/65536)),k=(t=k+n+65535)-65536*(n=Math.floor(t/65536)),s+=n-1+37*(n-1),i[0]=s,i[1]=a,i[2]=o,i[3]=c,i[4]=u,i[5]=f,i[6]=h,i[7]=y,i[8]=g,i[9]=p,i[10]=w,i[11]=A,i[12]=m,i[13]=v,i[14]=E,i[15]=k}function yt(i,e){te(i,e,e)}function J0(i,e){var r,t=_();for(r=0;r<16;r++)t[r]=e[r];for(r=253;r>=0;r--)yt(t,t),r!==2&&r!==4&&te(t,t,e);for(r=0;r<16;r++)i[r]=t[r]}function X0(i,e,r){var t,n,s=new Uint8Array(32),a=new Float64Array(80),o=_(),c=_(),u=_(),f=_(),h=_(),y=_();for(n=0;n<31;n++)s[n]=e[n];for(s[31]=127&e[31]|64,s[0]&=248,Z0(a,r),n=0;n<16;n++)c[n]=a[n],f[n]=o[n]=u[n]=0;for(o[0]=f[0]=1,n=254;n>=0;--n)ei(o,c,t=s[n>>>3]>>>(7&n)&1),ei(u,f,t),Bt(h,o,u),Kt(o,o,u),Bt(u,c,f),Kt(c,c,f),yt(f,h),yt(y,o),te(o,u,o),te(u,c,h),Bt(h,o,u),Kt(o,o,u),yt(c,o),Kt(u,f,y),te(o,u,h5),Bt(o,o,f),te(u,u,o),te(o,f,y),te(f,c,a),yt(c,h),ei(o,c,t),ei(u,f,t);for(n=0;n<16;n++)a[n+16]=o[n],a[n+32]=u[n],a[n+48]=c[n],a[n+64]=f[n];var g=a.subarray(32),p=a.subarray(16);return J0(g,g),te(p,p,g),Zi(i,p),0}function Bc(i,e){return X0(i,e,q0)}var Ic=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Sc(i,e,r,t){for(var n,s,a,o,c,u,f,h,y,g,p,w,A,m,v,E,k,U,Q,P,I,b,K,B,S,C,D=new Int32Array(16),R=new Int32Array(16),x=i[0],T=i[1],N=i[2],F=i[3],M=i[4],z=i[5],L=i[6],O=i[7],H=e[0],j=e[1],V=e[2],Z=e[3],q=e[4],$=e[5],W=e[6],ie=e[7],X=0;t>=128;){for(Q=0;Q<16;Q++)P=8*Q+X,D[Q]=r[P+0]<<24|r[P+1]<<16|r[P+2]<<8|r[P+3],R[Q]=r[P+4]<<24|r[P+5]<<16|r[P+6]<<8|r[P+7];for(Q=0;Q<80;Q++)if(n=x,s=T,a=N,o=F,c=M,u=z,f=L,y=H,g=j,p=V,w=Z,A=q,m=$,v=W,K=65535&(b=ie),B=b>>>16,S=65535&(I=O),C=I>>>16,K+=65535&(b=(q>>>14|M<<18)^(q>>>18|M<<14)^(M>>>9|q<<23)),B+=b>>>16,S+=65535&(I=(M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23)),C+=I>>>16,K+=65535&(b=q&$^~q&W),B+=b>>>16,S+=65535&(I=M&z^~M&L),C+=I>>>16,K+=65535&(b=Ic[2*Q+1]),B+=b>>>16,S+=65535&(I=Ic[2*Q]),C+=I>>>16,I=D[Q%16],B+=(b=R[Q%16])>>>16,S+=65535&I,C+=I>>>16,S+=(B+=(K+=65535&b)>>>16)>>>16,K=65535&(b=U=65535&K|B<<16),B=b>>>16,S=65535&(I=k=65535&S|(C+=S>>>16)<<16),C=I>>>16,K+=65535&(b=(H>>>28|x<<4)^(x>>>2|H<<30)^(x>>>7|H<<25)),B+=b>>>16,S+=65535&(I=(x>>>28|H<<4)^(H>>>2|x<<30)^(H>>>7|x<<25)),C+=I>>>16,B+=(b=H&j^H&V^j&V)>>>16,S+=65535&(I=x&T^x&N^T&N),C+=I>>>16,h=65535&(S+=(B+=(K+=65535&b)>>>16)>>>16)|(C+=S>>>16)<<16,E=65535&K|B<<16,K=65535&(b=w),B=b>>>16,S=65535&(I=o),C=I>>>16,B+=(b=U)>>>16,S+=65535&(I=k),C+=I>>>16,T=n,N=s,F=a,M=o=65535&(S+=(B+=(K+=65535&b)>>>16)>>>16)|(C+=S>>>16)<<16,z=c,L=u,O=f,x=h,j=y,V=g,Z=p,q=w=65535&K|B<<16,$=A,W=m,ie=v,H=E,Q%16==15)for(P=0;P<16;P++)I=D[P],K=65535&(b=R[P]),B=b>>>16,S=65535&I,C=I>>>16,I=D[(P+9)%16],K+=65535&(b=R[(P+9)%16]),B+=b>>>16,S+=65535&I,C+=I>>>16,k=D[(P+1)%16],K+=65535&(b=((U=R[(P+1)%16])>>>1|k<<31)^(U>>>8|k<<24)^(U>>>7|k<<25)),B+=b>>>16,S+=65535&(I=(k>>>1|U<<31)^(k>>>8|U<<24)^k>>>7),C+=I>>>16,k=D[(P+14)%16],B+=(b=((U=R[(P+14)%16])>>>19|k<<13)^(k>>>29|U<<3)^(U>>>6|k<<26))>>>16,S+=65535&(I=(k>>>19|U<<13)^(U>>>29|k<<3)^k>>>6),C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,D[P]=65535&S|C<<16,R[P]=65535&K|B<<16;K=65535&(b=H),B=b>>>16,S=65535&(I=x),C=I>>>16,I=i[0],B+=(b=e[0])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[0]=x=65535&S|C<<16,e[0]=H=65535&K|B<<16,K=65535&(b=j),B=b>>>16,S=65535&(I=T),C=I>>>16,I=i[1],B+=(b=e[1])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[1]=T=65535&S|C<<16,e[1]=j=65535&K|B<<16,K=65535&(b=V),B=b>>>16,S=65535&(I=N),C=I>>>16,I=i[2],B+=(b=e[2])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[2]=N=65535&S|C<<16,e[2]=V=65535&K|B<<16,K=65535&(b=Z),B=b>>>16,S=65535&(I=F),C=I>>>16,I=i[3],B+=(b=e[3])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[3]=F=65535&S|C<<16,e[3]=Z=65535&K|B<<16,K=65535&(b=q),B=b>>>16,S=65535&(I=M),C=I>>>16,I=i[4],B+=(b=e[4])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[4]=M=65535&S|C<<16,e[4]=q=65535&K|B<<16,K=65535&(b=$),B=b>>>16,S=65535&(I=z),C=I>>>16,I=i[5],B+=(b=e[5])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[5]=z=65535&S|C<<16,e[5]=$=65535&K|B<<16,K=65535&(b=W),B=b>>>16,S=65535&(I=L),C=I>>>16,I=i[6],B+=(b=e[6])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[6]=L=65535&S|C<<16,e[6]=W=65535&K|B<<16,K=65535&(b=ie),B=b>>>16,S=65535&(I=O),C=I>>>16,I=i[7],B+=(b=e[7])>>>16,S+=65535&I,C+=I>>>16,C+=(S+=(B+=(K+=65535&b)>>>16)>>>16)>>>16,i[7]=O=65535&S|C<<16,e[7]=ie=65535&K|B<<16,X+=128,t-=128}return t}function Ri(i,e,r){var t,n=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Sc(n,s,e,r),r%=128,t=0;t<r;t++)a[t]=e[o-r+t];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,Ec(a,r-8,o/536870912|0,o<<3),Sc(n,s,a,r),t=0;t<8;t++)Ec(i,8*t,n[t],s[t]);return 0}function Ca(i,e){var r=_(),t=_(),n=_(),s=_(),a=_(),o=_(),c=_(),u=_(),f=_();Kt(r,i[1],i[0]),Kt(f,e[1],e[0]),te(r,r,f),Bt(t,i[0],i[1]),Bt(f,e[0],e[1]),te(t,t,f),te(n,i[3],e[3]),te(n,n,l5),te(s,i[2],e[2]),Bt(s,s,s),Kt(a,t,r),Kt(o,s,n),Bt(c,s,n),Bt(u,t,r),te(i[0],a,o),te(i[1],u,c),te(i[2],c,o),te(i[3],a,u)}function Kc(i,e,r){var t;for(t=0;t<4;t++)ei(i[t],e[t],r)}function Ua(i,e){var r=_(),t=_(),n=_();J0(n,e[2]),te(r,e[0],n),te(t,e[1],n),Zi(i,t),i[31]^=Y0(r)<<7}function W0(i,e,r){var t,n;for(lr(i[0],Ka),lr(i[1],Yn),lr(i[2],Yn),lr(i[3],Ka),n=255;n>=0;--n)Kc(i,e,t=r[n/8|0]>>(7&n)&1),Ca(e,i),Ca(i,i),Kc(i,e,t)}function Pa(i,e){var r=[_(),_(),_(),_()];lr(r[0],bc),lr(r[1],kc),lr(r[2],Yn),te(r[3],bc,kc),W0(i,r,e)}function Cc(i,e,r){var t,n=new Uint8Array(64),s=[_(),_(),_(),_()];for(r||Sa(e,32),Ri(n,e,32),n[0]&=248,n[31]&=127,n[31]|=64,Pa(s,n),Ua(i,s),t=0;t<32;t++)e[t+32]=i[t];return 0}var js=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $0(i,e){var r,t,n,s;for(t=63;t>=32;--t){for(r=0,n=t-32,s=t-12;n<s;++n)e[n]+=r-16*e[t]*js[n-(t-32)],r=Math.floor((e[n]+128)/256),e[n]-=256*r;e[n]+=r,e[t]=0}for(r=0,n=0;n<32;n++)e[n]+=r-(e[31]>>4)*js[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;n++)e[n]-=r*js[n];for(t=0;t<32;t++)e[t+1]+=e[t]>>8,i[t]=255&e[t]}function Vs(i){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=i[e];for(e=0;e<64;e++)i[e]=0;$0(i,r)}function g5(i,e){var r=_(),t=_(),n=_(),s=_(),a=_(),o=_(),c=_();return lr(i[2],Yn),Z0(i[1],e),yt(n,i[1]),te(s,n,f5),Kt(n,n,i[2]),Bt(s,i[2],s),yt(a,s),yt(o,a),te(c,o,a),te(r,c,n),te(r,r,s),(function(u,f){var h,y=_();for(h=0;h<16;h++)y[h]=f[h];for(h=250;h>=0;h--)yt(y,y),h!==1&&te(y,y,f);for(h=0;h<16;h++)u[h]=y[h]})(r,r),te(r,r,n),te(r,r,s),te(r,r,s),te(i[0],r,s),yt(t,i[0]),te(t,t,s),vc(t,n)&&te(i[0],i[0],y5),yt(t,i[0]),te(t,t,s),vc(t,n)?-1:(Y0(i[0])===e[31]>>7&&Kt(i[0],Ka,i[0]),te(i[3],i[0],i[1]),0)}var Br=64;function qr(){for(var i=0;i<arguments.length;i++)if(!(arguments[i]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}ze.scalarMult=function(i,e){if(qr(i,e),i.length!==32)throw Error("bad n size");if(e.length!==32)throw Error("bad p size");var r=new Uint8Array(32);return X0(r,i,e),r},ze.box={},ze.box.keyPair=function(){var i=new Uint8Array(32),e=new Uint8Array(32);return(function(r,t){Sa(t,32),Bc(r,t)})(i,e),{publicKey:i,secretKey:e}},ze.box.keyPair.fromSecretKey=function(i){if(qr(i),i.length!==32)throw Error("bad secret key size");var e=new Uint8Array(32);return Bc(e,i),{publicKey:e,secretKey:new Uint8Array(i)}},ze.sign=function(i,e){if(qr(i,e),e.length!==64)throw Error("bad secret key size");var r=new Uint8Array(Br+i.length);return(function(t,n,s,a){var o,c,u=new Uint8Array(64),f=new Uint8Array(64),h=new Uint8Array(64),y=new Float64Array(64),g=[_(),_(),_(),_()];for(Ri(u,a,32),u[0]&=248,u[31]&=127,u[31]|=64,o=0;o<s;o++)t[64+o]=n[o];for(o=0;o<32;o++)t[32+o]=u[32+o];for(Ri(h,t.subarray(32),s+32),Vs(h),Pa(g,h),Ua(t,g),o=32;o<64;o++)t[o]=a[o];for(Ri(f,t,s+64),Vs(f),o=0;o<64;o++)y[o]=0;for(o=0;o<32;o++)y[o]=h[o];for(o=0;o<32;o++)for(c=0;c<32;c++)y[o+c]+=f[o]*u[c];$0(t.subarray(32),y)})(r,i,i.length,e),r},ze.sign.detached=function(i,e){for(var r=ze.sign(i,e),t=new Uint8Array(Br),n=0;n<t.length;n++)t[n]=r[n];return t},ze.sign.detached.verify=function(i,e,r){if(qr(i,e,r),e.length!==Br)throw Error("bad signature size");if(r.length!==32)throw Error("bad public key size");var t,n=new Uint8Array(Br+i.length),s=new Uint8Array(Br+i.length);for(t=0;t<Br;t++)n[t]=e[t];for(t=0;t<i.length;t++)n[t+Br]=i[t];return(function(a,o,c,u){var f,h=new Uint8Array(32),y=new Uint8Array(64),g=[_(),_(),_(),_()],p=[_(),_(),_(),_()];if(c<64||g5(p,u))return-1;for(f=0;f<c;f++)a[f]=o[f];for(f=0;f<32;f++)a[f+32]=u[f];if(Ri(y,a,c),Vs(y),W0(g,p,y),Pa(p,o.subarray(32)),Ca(g,p),Ua(h,g),c-=64,_0(o,0,h,0)){for(f=0;f<c;f++)a[f]=0;return-1}for(f=0;f<c;f++)a[f]=o[f+64];return c})(s,n,n.length,r)>=0},ze.sign.keyPair=function(){var i=new Uint8Array(32),e=new Uint8Array(64);return Cc(i,e),{publicKey:i,secretKey:e}},ze.sign.keyPair.fromSecretKey=function(i){if(qr(i),i.length!==64)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=i[32+r];return{publicKey:e,secretKey:new Uint8Array(i)}},ze.sign.keyPair.fromSeed=function(i){if(qr(i),i.length!==32)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),t=0;t<32;t++)r[t]=i[t];return Cc(e,r,!0),{publicKey:e,secretKey:r}},ze.setPRNG=function(i){Sa=i},(function(){zs&&zs.getRandomValues&&ze.setPRNG((function(i,e){var r,t=new Uint8Array(e);for(r=0;r<e;r+=65536)zs.getRandomValues(t.subarray(r,r+Math.min(e-r,65536)));for(r=0;r<e;r++)i[r]=t[r];(function(n){for(var s=0;s<n.length;s++)n[s]=0})(t)}))})();var Hr=Object.freeze({__proto__:null,default:ze});function qs(i,e,r,t,n,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],f=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],h=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],y=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],g=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let p,w,A,m,v,E,k,U,Q,P,I=0,b=e.length;const K=i.length===32?3:9;U=K===3?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(e=(function(C){const D=8-C.length%8;let R;if(!(D<8)){if(D===8)return C;throw Error("des: invalid padding")}R=0;const x=new Uint8Array(C.length+D);for(let T=0;T<C.length;T++)x[T]=C[T];for(let T=0;T<D;T++)x[C.length+T]=R;return x})(e),b=e.length);let B=new Uint8Array(b),S=0;for(;I<b;){for(E=e[I++]<<24|e[I++]<<16|e[I++]<<8|e[I++],k=e[I++]<<24|e[I++]<<16|e[I++]<<8|e[I++],A=252645135&(E>>>4^k),k^=A,E^=A<<4,A=65535&(E>>>16^k),k^=A,E^=A<<16,A=858993459&(k>>>2^E),E^=A,k^=A<<2,A=16711935&(k>>>8^E),E^=A,k^=A<<8,A=1431655765&(E>>>1^k),k^=A,E^=A<<1,E=E<<1|E>>>31,k=k<<1|k>>>31,w=0;w<K;w+=3){for(Q=U[w+1],P=U[w+2],p=U[w];p!==Q;p+=P)m=k^i[p],v=(k>>>4|k<<28)^i[p+1],A=E,E=k,k=A^(o[m>>>24&63]|u[m>>>16&63]|h[m>>>8&63]|g[63&m]|a[v>>>24&63]|c[v>>>16&63]|f[v>>>8&63]|y[63&v]);A=E,E=k,k=A}E=E>>>1|E<<31,k=k>>>1|k<<31,A=1431655765&(E>>>1^k),k^=A,E^=A<<1,A=16711935&(k>>>8^E),E^=A,k^=A<<8,A=858993459&(k>>>2^E),E^=A,k^=A<<2,A=65535&(E>>>16^k),k^=A,E^=A<<16,A=252645135&(E>>>4^k),k^=A,E^=A<<4,B[S++]=E>>>24,B[S++]=E>>>16&255,B[S++]=E>>>8&255,B[S++]=255&E,B[S++]=k>>>24,B[S++]=k>>>16&255,B[S++]=k>>>8&255,B[S++]=255&k}return r||(B=(function(C){let D,R=null;if(D=0,!R){for(R=1;C[C.length-R]===D;)R++;R--}return C.subarray(0,C.length-R)})(B)),B}function _s(i){const e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],t=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],w=i.length>8?3:1,A=Array(32*w),m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let v,E,k,U=0,Q=0;for(let P=0;P<w;P++){let I=i[U++]<<24|i[U++]<<16|i[U++]<<8|i[U++],b=i[U++]<<24|i[U++]<<16|i[U++]<<8|i[U++];k=252645135&(I>>>4^b),b^=k,I^=k<<4,k=65535&(b>>>-16^I),I^=k,b^=k<<-16,k=858993459&(I>>>2^b),b^=k,I^=k<<2,k=65535&(b>>>-16^I),I^=k,b^=k<<-16,k=1431655765&(I>>>1^b),b^=k,I^=k<<1,k=16711935&(b>>>8^I),I^=k,b^=k<<8,k=1431655765&(I>>>1^b),b^=k,I^=k<<1,k=I<<8|b>>>20&240,I=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=k;for(let K=0;K<16;K++)m[K]?(I=I<<2|I>>>26,b=b<<2|b>>>26):(I=I<<1|I>>>27,b=b<<1|b>>>27),I&=-15,b&=-15,v=e[I>>>28]|r[I>>>24&15]|t[I>>>20&15]|n[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|o[I>>>4&15],E=c[b>>>28]|u[b>>>24&15]|f[b>>>20&15]|h[b>>>16&15]|y[b>>>12&15]|g[b>>>8&15]|p[b>>>4&15],k=65535&(E>>>16^v),A[Q++]=v^k,A[Q++]=E^k<<16}return A}function Ti(i){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(i.subarray(8*e,8*e+8)));this.encrypt=function(e){return qs(_s(this.key[2]),qs(_s(this.key[1]),qs(_s(this.key[0]),e,!0),!1),!0)}}function p5(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(a),!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,f=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],h=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=h,h=f^r(h,this.masking[0],this.rotate[0]),f=u,u=h,h=f^t(h,this.masking[1],this.rotate[1]),f=u,u=h,h=f^n(h,this.masking[2],this.rotate[2]),f=u,u=h,h=f^r(h,this.masking[3],this.rotate[3]),f=u,u=h,h=f^t(h,this.masking[4],this.rotate[4]),f=u,u=h,h=f^n(h,this.masking[5],this.rotate[5]),f=u,u=h,h=f^r(h,this.masking[6],this.rotate[6]),f=u,u=h,h=f^t(h,this.masking[7],this.rotate[7]),f=u,u=h,h=f^n(h,this.masking[8],this.rotate[8]),f=u,u=h,h=f^r(h,this.masking[9],this.rotate[9]),f=u,u=h,h=f^t(h,this.masking[10],this.rotate[10]),f=u,u=h,h=f^n(h,this.masking[11],this.rotate[11]),f=u,u=h,h=f^r(h,this.masking[12],this.rotate[12]),f=u,u=h,h=f^t(h,this.masking[13],this.rotate[13]),f=u,u=h,h=f^n(h,this.masking[14],this.rotate[14]),f=u,u=h,h=f^r(h,this.masking[15],this.rotate[15]),f=u,o[c]=h>>>24&255,o[c+1]=h>>>16&255,o[c+2]=h>>>8&255,o[c+3]=255&h,o[c+4]=f>>>24&255,o[c+5]=f>>>16&255,o[c+6]=f>>>8&255,o[c+7]=255&f}return o},this.decrypt=function(a){const o=Array(a.length);for(let c=0;c<a.length;c+=8){let u,f=a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3],h=a[c+4]<<24|a[c+5]<<16|a[c+6]<<8|a[c+7];u=h,h=f^r(h,this.masking[15],this.rotate[15]),f=u,u=h,h=f^n(h,this.masking[14],this.rotate[14]),f=u,u=h,h=f^t(h,this.masking[13],this.rotate[13]),f=u,u=h,h=f^r(h,this.masking[12],this.rotate[12]),f=u,u=h,h=f^n(h,this.masking[11],this.rotate[11]),f=u,u=h,h=f^t(h,this.masking[10],this.rotate[10]),f=u,u=h,h=f^r(h,this.masking[9],this.rotate[9]),f=u,u=h,h=f^n(h,this.masking[8],this.rotate[8]),f=u,u=h,h=f^t(h,this.masking[7],this.rotate[7]),f=u,u=h,h=f^r(h,this.masking[6],this.rotate[6]),f=u,u=h,h=f^n(h,this.masking[5],this.rotate[5]),f=u,u=h,h=f^t(h,this.masking[4],this.rotate[4]),f=u,u=h,h=f^r(h,this.masking[3],this.rotate[3]),f=u,u=h,h=f^n(h,this.masking[2],this.rotate[2]),f=u,u=h,h=f^t(h,this.masking[1],this.rotate[1]),f=u,u=h,h=f^r(h,this.masking[0],this.rotate[0]),f=u,o[c]=h>>>24&255,o[c+1]=h>>>16&255,o[c+2]=h>>>8&255,o[c+3]=255&h,o[c+4]=f>>>24&255,o[c+5]=f>>16&255,o[c+6]=f>>8&255,o[c+7]=255&f}return o};const i=[,,,,];i[0]=[,,,,],i[0][0]=[4,0,13,15,12,14,8],i[0][1]=[5,2,16,18,17,19,10],i[0][2]=[6,3,23,22,21,20,9],i[0][3]=[7,1,26,25,27,24,11],i[1]=[,,,,],i[1][0]=[0,6,21,23,20,22,16],i[1][1]=[1,4,0,2,1,3,18],i[1][2]=[2,5,7,6,5,4,17],i[1][3]=[3,7,10,9,11,8,19],i[2]=[,,,,],i[2][0]=[4,0,13,15,12,14,8],i[2][1]=[5,2,16,18,17,19,10],i[2][2]=[6,3,23,22,21,20,9],i[2][3]=[7,1,26,25,27,24,11],i[3]=[,,,,],i[3][0]=[0,6,21,23,20,22,16],i[3][1]=[1,4,0,2,1,3,18],i[3][2]=[2,5,7,6,5,4,17],i[3][3]=[3,7,10,9,11,8,19];const e=[,,,,];function r(a,o,c){const u=o+a,f=u<<c|u>>>32-c;return(s[0][f>>>24]^s[1][f>>>16&255])-s[2][f>>>8&255]+s[3][255&f]}function t(a,o,c){const u=o^a,f=u<<c|u>>>32-c;return s[0][f>>>24]-s[1][f>>>16&255]+s[2][f>>>8&255]^s[3][255&f]}function n(a,o,c){const u=o-a,f=u<<c|u>>>32-c;return(s[0][f>>>24]+s[1][f>>>16&255]^s[2][f>>>8&255])-s[3][255&f]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(a){const o=[,,,,,,,,],c=Array(32);let u;for(let g=0;g<4;g++)u=4*g,o[g]=a[u]<<24|a[u+1]<<16|a[u+2]<<8|a[u+3];const f=[6,7,4,5];let h,y=0;for(let g=0;g<2;g++)for(let p=0;p<4;p++){for(u=0;u<4;u++){const w=i[p][u];h=o[w[1]],h^=s[4][o[w[2]>>>2]>>>24-8*(3&w[2])&255],h^=s[5][o[w[3]>>>2]>>>24-8*(3&w[3])&255],h^=s[6][o[w[4]>>>2]>>>24-8*(3&w[4])&255],h^=s[7][o[w[5]>>>2]>>>24-8*(3&w[5])&255],h^=s[f[u]][o[w[6]>>>2]>>>24-8*(3&w[6])&255],o[w[0]]=h}for(u=0;u<4;u++){const w=e[p][u];h=s[4][o[w[0]>>>2]>>>24-8*(3&w[0])&255],h^=s[5][o[w[1]>>>2]>>>24-8*(3&w[1])&255],h^=s[6][o[w[2]>>>2]>>>24-8*(3&w[2])&255],h^=s[7][o[w[3]>>>2]>>>24-8*(3&w[3])&255],h^=s[4+u][o[w[4]>>>2]>>>24-8*(3&w[4])&255],c[y]=h,y++}}for(let g=0;g<16;g++)this.masking[g]=c[g],this.rotate[g]=31&c[16+g]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Mi(i){this.cast5=new p5,this.cast5.setKey(i),this.encrypt=function(e){return this.cast5.encrypt(e)}}Ti.keySize=Ti.prototype.keySize=24,Ti.blockSize=Ti.prototype.blockSize=8,Mi.blockSize=Mi.prototype.blockSize=8,Mi.keySize=Mi.prototype.keySize=16;const tt=4294967295;function At(i,e){return(i<<e|i>>>32-e)&tt}function Ft(i,e){return i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24}function ar(i,e,r){i.splice(e,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function J(i,e){return i>>>8*e&255}function Fi(i){this.tf=(function(){let e=null,r=null,t=-1,n=[],s=[[],[],[],[]];function a(f){return s[0][J(f,0)]^s[1][J(f,1)]^s[2][J(f,2)]^s[3][J(f,3)]}function o(f){return s[0][J(f,3)]^s[1][J(f,0)]^s[2][J(f,1)]^s[3][J(f,2)]}function c(f,h){let y=a(h[0]),g=o(h[1]);h[2]=At(h[2]^y+g+n[4*f+8]&tt,31),h[3]=At(h[3],1)^y+2*g+n[4*f+9]&tt,y=a(h[2]),g=o(h[3]),h[0]=At(h[0]^y+g+n[4*f+10]&tt,31),h[1]=At(h[1],1)^y+2*g+n[4*f+11]&tt}function u(f,h){let y=a(h[0]),g=o(h[1]);h[2]=At(h[2],1)^y+g+n[4*f+10]&tt,h[3]=At(h[3]^y+2*g+n[4*f+11]&tt,31),y=a(h[2]),g=o(h[3]),h[0]=At(h[0],1)^y+g+n[4*f+8]&tt,h[1]=At(h[1]^y+2*g+n[4*f+9]&tt,31)}return{name:"twofish",blocksize:16,open:function(f){let h,y,g,p,w;e=f;const A=[],m=[],v=[];let E;const k=[];let U,Q,P;const I=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],b=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],K=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],B=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],S=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],C=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],D=[[],[]],R=[[],[],[],[]];function x(z){return z^z>>2^[0,90,180,238][3&z]}function T(z){return z^z>>1^z>>2^[0,238,180,90][3&z]}function N(z,L){let O,H,j;for(O=0;O<8;O++)H=L>>>24,L=L<<8&tt|z>>>24,z=z<<8&tt,j=H<<1,128&H&&(j^=333),L^=H^j<<16,j^=H>>>1,1&H&&(j^=166),L^=j<<24|j<<8;return L}function F(z,L){const O=L>>4,H=15&L,j=I[z][O^H],V=b[z][S[H]^C[O]];return B[z][S[V]^C[j]]<<4|K[z][j^V]}function M(z,L){let O=J(z,0),H=J(z,1),j=J(z,2),V=J(z,3);switch(E){case 4:O=D[1][O]^J(L[3],0),H=D[0][H]^J(L[3],1),j=D[0][j]^J(L[3],2),V=D[1][V]^J(L[3],3);case 3:O=D[1][O]^J(L[2],0),H=D[1][H]^J(L[2],1),j=D[0][j]^J(L[2],2),V=D[0][V]^J(L[2],3);case 2:O=D[0][D[0][O]^J(L[1],0)]^J(L[0],0),H=D[0][D[1][H]^J(L[1],1)]^J(L[0],1),j=D[1][D[0][j]^J(L[1],2)]^J(L[0],2),V=D[1][D[1][V]^J(L[1],3)]^J(L[0],3)}return R[0][O]^R[1][H]^R[2][j]^R[3][V]}for(e=e.slice(0,32),h=e.length;h!==16&&h!==24&&h!==32;)e[h++]=0;for(h=0;h<e.length;h+=4)v[h>>2]=Ft(e,h);for(h=0;h<256;h++)D[0][h]=F(0,h),D[1][h]=F(1,h);for(h=0;h<256;h++)U=D[1][h],Q=x(U),P=T(U),R[0][h]=U+(Q<<8)+(P<<16)+(P<<24),R[2][h]=Q+(P<<8)+(U<<16)+(P<<24),U=D[0][h],Q=x(U),P=T(U),R[1][h]=P+(P<<8)+(Q<<16)+(U<<24),R[3][h]=Q+(U<<8)+(P<<16)+(Q<<24);for(E=v.length/2,h=0;h<E;h++)y=v[h+h],A[h]=y,g=v[h+h+1],m[h]=g,k[E-h-1]=N(y,g);for(h=0;h<40;h+=2)y=16843009*h,g=y+16843009,y=M(y,A),g=At(M(g,m),8),n[h]=y+g&tt,n[h+1]=At(y+2*g,9);for(h=0;h<256;h++)switch(y=g=p=w=h,E){case 4:y=D[1][y]^J(k[3],0),g=D[0][g]^J(k[3],1),p=D[0][p]^J(k[3],2),w=D[1][w]^J(k[3],3);case 3:y=D[1][y]^J(k[2],0),g=D[1][g]^J(k[2],1),p=D[0][p]^J(k[2],2),w=D[0][w]^J(k[2],3);case 2:s[0][h]=R[0][D[0][D[0][y]^J(k[1],0)]^J(k[0],0)],s[1][h]=R[1][D[0][D[1][g]^J(k[1],1)]^J(k[0],1)],s[2][h]=R[2][D[1][D[0][p]^J(k[1],2)]^J(k[0],2)],s[3][h]=R[3][D[1][D[1][w]^J(k[1],3)]^J(k[0],3)]}},close:function(){n=[],s=[[],[],[],[]]},encrypt:function(f,h){r=f,t=h;const y=[Ft(r,t)^n[0],Ft(r,t+4)^n[1],Ft(r,t+8)^n[2],Ft(r,t+12)^n[3]];for(let g=0;g<8;g++)c(g,y);return ar(r,t,y[2]^n[4]),ar(r,t+4,y[3]^n[5]),ar(r,t+8,y[0]^n[6]),ar(r,t+12,y[1]^n[7]),t+=16,r},decrypt:function(f,h){r=f,t=h;const y=[Ft(r,t)^n[4],Ft(r,t+4)^n[5],Ft(r,t+8)^n[6],Ft(r,t+12)^n[7]];for(let g=7;g>=0;g--)u(g,y);ar(r,t,y[2]^n[0]),ar(r,t+4,y[3]^n[1]),ar(r,t+8,y[0]^n[2]),ar(r,t+12,y[1]^n[3]),t+=16},finalize:function(){return r}}})(),this.tf.open(Array.from(i),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function ft(){}function Li(i){this.bf=new ft,this.bf.init(i),this.encrypt=function(e){return this.bf.encryptBlock(e)}}Fi.keySize=Fi.prototype.keySize=32,Fi.blockSize=Fi.prototype.blockSize=16,ft.prototype.BLOCKSIZE=8,ft.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],ft.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],ft.prototype.NN=16,ft.prototype._clean=function(i){return i<0&&(i=(2147483647&i)+2147483648),i},ft.prototype._F=function(i){let e;const r=255&i,t=255&(i>>>=8),n=255&(i>>>=8),s=255&(i>>>=8);return e=this.sboxes[0][s]+this.sboxes[1][n],e^=this.sboxes[2][t],e+=this.sboxes[3][r],e},ft.prototype._encryptBlock=function(i){let e,r=i[0],t=i[1];for(e=0;e<this.NN;++e){r^=this.parray[e],t=this._F(r)^t;const n=r;r=t,t=n}r^=this.parray[this.NN+0],t^=this.parray[this.NN+1],i[0]=this._clean(t),i[1]=this._clean(r)},ft.prototype.encryptBlock=function(i){let e;const r=[0,0],t=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)r[0]=r[0]<<8|255&i[e+0],r[1]=r[1]<<8|255&i[e+t];this._encryptBlock(r);const n=[];for(e=0;e<this.BLOCKSIZE/2;++e)n[e+0]=r[0]>>>24-8*e&255,n[e+t]=r[1]>>>24-8*e&255;return n},ft.prototype._decryptBlock=function(i){let e,r=i[0],t=i[1];for(e=this.NN+1;e>1;--e){r^=this.parray[e],t=this._F(r)^t;const n=r;r=t,t=n}r^=this.parray[1],t^=this.parray[0],i[0]=this._clean(t),i[1]=this._clean(r)},ft.prototype.init=function(i){let e,r=0;for(this.parray=[],e=0;e<this.NN+2;++e){let n=0;for(let s=0;s<4;++s)n=n<<8|255&i[r],++r>=i.length&&(r=0);this.parray[e]=this.PARRAY[e]^n}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],r=0;r<256;++r)this.sboxes[e][r]=this.SBOXES[e][r];const t=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(t),this.parray[e+0]=t[0],this.parray[e+1]=t[1];for(e=0;e<4;++e)for(r=0;r<256;r+=2)this._encryptBlock(t),this.sboxes[e][r+0]=t[0],this.sboxes[e][r+1]=t[1]},Li.keySize=Li.prototype.keySize=16,Li.blockSize=Li.prototype.blockSize=8;const d5=new Map(Object.entries({tripledes:Ti,cast5:Mi,twofish:Fi,blowfish:Li}));var A5=Object.freeze({__proto__:null,legacyCiphers:d5});function _r(i,e,r,t){i[e]+=r[t],i[e+1]+=r[t+1]+(i[e]<r[t])}function Uc(i,e){i[0]+=e,i[1]+=i[0]<e}function or(i,e,r,t,n,s,a,o){_r(i,r,i,t),_r(i,r,e,a);let c=i[s]^i[r],u=i[s+1]^i[r+1];i[s]=u,i[s+1]=c,_r(i,n,i,s),c=i[t]^i[n],u=i[t+1]^i[n+1],i[t]=c>>>24^u<<8,i[t+1]=u>>>24^c<<8,_r(i,r,i,t),_r(i,r,e,o),c=i[s]^i[r],u=i[s+1]^i[r+1],i[s]=c>>>16^u<<16,i[s+1]=u>>>16^c<<16,_r(i,n,i,s),c=i[t]^i[n],u=i[t+1]^i[n+1],i[t]=u>>>31^c<<1,i[t+1]=c>>>31^u<<1}const e3=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Te=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((i=>2*i)));function Pc(i,e){const r=new Uint32Array(32),t=new Uint32Array(i.b.buffer,i.b.byteOffset,32);for(let s=0;s<16;s++)r[s]=i.h[s],r[s+16]=e3[s];r[24]^=i.t0[0],r[25]^=i.t0[1];const n=e?4294967295:0;r[28]^=n,r[29]^=n;for(let s=0;s<12;s++){const a=s<<4;or(r,t,0,8,16,24,Te[a+0],Te[a+1]),or(r,t,2,10,18,26,Te[a+2],Te[a+3]),or(r,t,4,12,20,28,Te[a+4],Te[a+5]),or(r,t,6,14,22,30,Te[a+6],Te[a+7]),or(r,t,0,10,20,30,Te[a+8],Te[a+9]),or(r,t,2,12,22,24,Te[a+10],Te[a+11]),or(r,t,4,14,16,26,Te[a+12],Te[a+13]),or(r,t,6,8,18,28,Te[a+14],Te[a+15])}for(let s=0;s<16;s++)i.h[s]^=r[s]^r[s+16]}class w5{constructor(e,r,t,n){const s=new Uint8Array(64);this.S={b:new Uint8Array(Ki),h:new Uint32Array(Da/4),t0:new Uint32Array(2),c:0,outlen:e},s[0]=e,r&&(s[1]=r.length),s[2]=1,s[3]=1,t&&s.set(t,32),n&&s.set(n,48);const a=new Uint32Array(s.buffer,s.byteOffset,s.length/Uint32Array.BYTES_PER_ELEMENT);for(let o=0;o<16;o++)this.S.h[o]=e3[o]^a[o];if(r){const o=new Uint8Array(Ki);o.set(r),this.update(o)}}update(e){if(!(e instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let r=0;for(;r<e.length;){this.S.c===Ki&&(Uc(this.S.t0,this.S.c),Pc(this.S,!1),this.S.c=0);let t=Ki-this.S.c;this.S.b.set(e.subarray(r,r+t),this.S.c);const n=Math.min(t,e.length-r);this.S.c+=n,r+=n}return this}digest(e){Uc(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=Ki,Pc(this.S,!0);const r=e||new Uint8Array(this.S.outlen);for(let t=0;t<this.S.outlen;t++)r[t]=this.S.h[t>>2]>>8*(3&t);return this.S.h=null,r.buffer}}function Un(i,e,r,t){if(i>Da)throw Error(`outlen must be at most ${Da} (given: ${i})`);return new w5(i,e,r,t)}const Da=64,Ki=128,Lt=1024,m5=new Uint8Array(new Uint16Array([43981]).buffer)[0]===205;function Ge(i,e,r){return i[r+0]=e,i[r+1]=e>>8,i[r+2]=e>>16,i[r+3]=e>>24,i}function Ir(i,e,r){if(e>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let t=e;for(let n=r;n<r+7;n++)i[n]=t,t=(t-i[n])/256;return i}function Ys(i,e,r){const t=new Uint8Array(64),n=new Uint8Array(4+e.length);if(Ge(n,i,0),n.set(e,4),i<=64)return Un(i).update(n).digest(r),r;const s=Math.ceil(i/32)-2;for(let o=0;o<s;o++)Un(64).update(o===0?n:t).digest(t),r.set(t.subarray(0,32),32*o);const a=new Uint8Array(Un(i-32*s).update(t).digest());return r.set(a,32*s),r}function Dc(i,e,r,t){return i.fn.XOR(e.byteOffset,r.byteOffset,t.byteOffset),e}function b5(i,e,r,t){return i.fn.G(e.byteOffset,r.byteOffset,t.byteOffset,i.refs.gZ.byteOffset),t}function k5(i,e,r,t){return i.fn.G2(e.byteOffset,r.byteOffset,t.byteOffset,i.refs.gZ.byteOffset),t}function*E5(i,e,r,t,n,s,a,o){i.refs.prngTmp.fill(0);const c=i.refs.prngTmp.subarray(0,48);Ir(c,e,0),Ir(c,r,8),Ir(c,t,16),Ir(c,n,24),Ir(c,s,32),Ir(c,2,40);for(let u=1;u<=a;u++){Ir(i.refs.prngTmp,u,c.length);const f=k5(i,i.refs.ZERO1024,i.refs.prngTmp,i.refs.prngR);for(let h=u===1?8*o:0;h<f.length;h+=8)yield f.subarray(h,h+8)}return[]}function v5(i,{memory:e,instance:r}){if(!m5)throw Error("BigEndian system not supported");const t=(function({type:b,version:K,tagLength:B,password:S,salt:C,ad:D,secret:R,parallelism:x,memorySize:T,passes:N}){const F=(M,z,L,O)=>{if(z<L||z>O)throw Error(`${M} size should be between ${L} and ${O} bytes`)};if(b!==2||K!==19)throw Error("Unsupported type or version");return F("password",S,8,4294967295),F("salt",C,8,4294967295),F("tag",B,4,4294967295),F("memory",T,8*x,4294967295),D&&F("associated data",D,0,4294967295),R&&F("secret",R,0,32),{type:b,version:K,tagLength:B,password:S,salt:C,ad:D,secret:R,lanes:x,memorySize:T,passes:N}})({type:2,version:19,...i}),{G:n,G2:s,xor:a,getLZ:o}=r.exports,c={},u={};u.G=n,u.G2=s,u.XOR=a;const f=4*t.lanes*Math.floor(t.memorySize/(4*t.lanes)),h=f*Lt+10240;if(e.buffer.byteLength<h){const b=Math.ceil((h-e.buffer.byteLength)/65536);e.grow(b)}let y=0;c.gZ=new Uint8Array(e.buffer,y,Lt),y+=c.gZ.length,c.prngR=new Uint8Array(e.buffer,y,Lt),y+=c.prngR.length,c.prngTmp=new Uint8Array(e.buffer,y,Lt),y+=c.prngTmp.length,c.ZERO1024=new Uint8Array(e.buffer,y,1024),y+=c.ZERO1024.length;const g=new Uint32Array(e.buffer,y,2);y+=g.length*Uint32Array.BYTES_PER_ELEMENT;const p={fn:u,refs:c},w=new Uint8Array(e.buffer,y,Lt);y+=w.length;const A=new Uint8Array(e.buffer,y,t.memorySize*Lt),m=new Uint8Array(e.buffer,0,y),v=(function(b){const K=Un(64),B=new Uint8Array(4),S=new Uint8Array(24);Ge(S,b.lanes,0),Ge(S,b.tagLength,4),Ge(S,b.memorySize,8),Ge(S,b.passes,12),Ge(S,b.version,16),Ge(S,b.type,20);const C=[S];b.password?(C.push(Ge(new Uint8Array(4),b.password.length,0)),C.push(b.password)):C.push(B),b.salt?(C.push(Ge(new Uint8Array(4),b.salt.length,0)),C.push(b.salt)):C.push(B),b.secret?(C.push(Ge(new Uint8Array(4),b.secret.length,0)),C.push(b.secret)):C.push(B),b.ad?(C.push(Ge(new Uint8Array(4),b.ad.length,0)),C.push(b.ad)):C.push(B),K.update((function(R){if(R.length===1)return R[0];let x=0;for(let F=0;F<R.length;F++){if(!(R[F]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");x+=R[F].length}const T=new Uint8Array(x);let N=0;return R.forEach((F=>{T.set(F,N),N+=F.length})),T})(C));const D=K.digest();return new Uint8Array(D)})(t),E=f/t.lanes,k=Array(t.lanes).fill(null).map((()=>Array(E))),U=(b,K)=>(k[b][K]=A.subarray(b*E*1024+1024*K,b*E*1024+1024*K+Lt),k[b][K]);for(let b=0;b<t.lanes;b++){const K=new Uint8Array(v.length+8);K.set(v),Ge(K,0,v.length),Ge(K,b,v.length+4),Ys(Lt,K,U(b,0)),Ge(K,1,v.length),Ys(Lt,K,U(b,1))}const Q=E/4;for(let b=0;b<t.passes;b++)for(let K=0;K<4;K++){const B=b===0&&K<=1;for(let S=0;S<t.lanes;S++){let C=K===0&&b===0?2:0;const D=B?E5(p,b,S,K,f,t.passes,Q,C):null;for(;C<Q;C++){const R=K*Q+C,x=R>0?k[S][R-1]:k[S][E-1],T=B?D.next().value:x;o(g.byteOffset,T.byteOffset,S,t.lanes,b,K,C,4,Q);const N=g[0],F=g[1];b===0&&U(S,R),b5(p,x,k[N][F],b>0?w:k[S][R]),b>0&&Dc(p,k[S][R],w,k[S][R])}}}const P=k[0][E-1];for(let b=1;b<t.lanes;b++)Dc(p,P,P,k[b][E-1]);const I=Ys(t.tagLength,P,new Uint8Array(t.tagLength));return m.fill(0),e.grow(0),I}let An;async function B5(i,e){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),t=await(async function(n,s,a){const o={env:{memory:n}};if(An===void 0)try{const c=await s(o);return An=!0,c}catch{An=!1}return(An?s:a)(o)})(r,i,e);return n=>v5(n,{instance:t.instance,memory:r})}function xc(i,e,r,t){var n=null,s=Me.atob(r),a=s.length;n=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)n[o]=s.charCodeAt(o);return(function(c,u,f){var h=f?WebAssembly.instantiateStreaming:WebAssembly.instantiate,y=f?WebAssembly.compileStreaming:WebAssembly.compile;return u?h(c,u):y(c)})(n,t,!1)}var Qc,Rc,Tc,Mc,Fc,Lc,Nc,Oc,I5=Object.freeze({__proto__:null,default:async()=>B5((i=>xc(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",i)),(i=>xc(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",i)))});function S5(){if(Rc)return Qc;Rc=1;var i=[0,1,3,7,15,31,63,127,255],e=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};return e.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},e.prototype.read=function(r){for(var t=0;r>0;){this._ensureByte();var n=8-this.bitOffset;if(r>=n)t<<=n,t|=i[n]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=n;else{t<<=r;var s=n-r;t|=(this.curByte&i[r]<<s)>>s,this.bitOffset+=r,r=0}}return t},e.prototype.seek=function(r){var t=r%8,n=(r-t)/8;this.bitOffset=t,this.stream.seek(n),this.hasByte=!1},e.prototype.pi=function(){var r,t=new Uint8Array(6);for(r=0;r<t.length;r++)t[r]=this.read(8);return(function(n){return Array.prototype.map.call(n,(s=>("00"+s.toString(16)).slice(-2))).join("")})(t)},Qc=e}var K5=(function(){if(Oc)return Nc;Oc=1;var i,e=S5(),r=(function(){if(Mc)return Tc;Mc=1;var h=function(){};return h.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},h.prototype.read=function(y,g,p){for(var w=0;w<p;){var A=this.readByte();if(A<0)return w===0?-1:w;y[g++]=A,w++}return w},h.prototype.seek=function(y){throw Error("abstract method seek() not implemented")},h.prototype.writeByte=function(y){throw Error("abstract method readByte() not implemented")},h.prototype.write=function(y,g,p){var w;for(w=0;w<p;w++)this.writeByte(y[g++]);return p},h.prototype.flush=function(){},Tc=h})(),t=Lc?Fc:(Lc=1,i=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),Fc=function(){var h=4294967295;this.getCRC=function(){return~h>>>0},this.updateCRC=function(y){h=h<<8^i[255&(h>>>24^y)]},this.updateCRCRun=function(y,g){for(;g-- >0;)h=h<<8^i[255&(h>>>24^y)]}}),n=function(h,y){var g,p=h[y];for(g=y;g>0;g--)h[g]=h[g-1];return h[0]=p,p},s={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},a={};a[s.LAST_BLOCK]="Bad file checksum",a[s.NOT_BZIP_DATA]="Not bzip data",a[s.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",a[s.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",a[s.DATA_ERROR]="Data error",a[s.OUT_OF_MEMORY]="Out of memory",a[s.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var o=function(h,y){var g=a[h]||"unknown error";y&&(g+=": "+y);var p=new TypeError(g);throw p.errorCode=h,p},c=function(h,y){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(h,y)};c.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new t,!0):(this.writeCount=-1,!1)},c.prototype._start_bunzip=function(h,y){var g=new Uint8Array(4);h.read(g,0,4)===4&&String.fromCharCode(g[0],g[1],g[2])==="BZh"||o(s.NOT_BZIP_DATA,"bad magic");var p=g[3]-48;(p<1||p>9)&&o(s.NOT_BZIP_DATA,"level out of range"),this.reader=new e(h),this.dbufSize=1e5*p,this.nextoutput=0,this.outputStream=y,this.streamCRC=0},c.prototype._get_next_block=function(){var h,y,g,p=this.reader,w=p.pi();if(w==="177245385090")return!1;w!=="314159265359"&&o(s.NOT_BZIP_DATA),this.targetBlockCRC=p.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,p.read(1)&&o(s.OBSOLETE_INPUT);var A=p.read(24);A>this.dbufSize&&o(s.DATA_ERROR,"initial position out of bounds");var m=p.read(16),v=new Uint8Array(256),E=0;for(h=0;h<16;h++)if(m&1<<15-h){var k=16*h;for(g=p.read(16),y=0;y<16;y++)g&1<<15-y&&(v[E++]=k+y)}var U=p.read(3);(U<2||U>6)&&o(s.DATA_ERROR);var Q=p.read(15);Q===0&&o(s.DATA_ERROR);var P=new Uint8Array(256);for(h=0;h<U;h++)P[h]=h;var I=new Uint8Array(Q);for(h=0;h<Q;h++){for(y=0;p.read(1);y++)y>=U&&o(s.DATA_ERROR);I[h]=n(P,y)}var b,K=E+2,B=[];for(y=0;y<U;y++){var S,C,D=new Uint8Array(K),R=new Uint16Array(21);for(m=p.read(5),h=0;h<K;h++){for(;(m<1||m>20)&&o(s.DATA_ERROR),p.read(1);)p.read(1)?m--:m++;D[h]=m}for(S=C=D[0],h=1;h<K;h++)D[h]>C?C=D[h]:D[h]<S&&(S=D[h]);b={},B.push(b),b.permute=new Uint16Array(258),b.limit=new Uint32Array(22),b.base=new Uint32Array(21),b.minLen=S,b.maxLen=C;var x=0;for(h=S;h<=C;h++)for(R[h]=b.limit[h]=0,m=0;m<K;m++)D[m]===h&&(b.permute[x++]=m);for(h=0;h<K;h++)R[D[h]]++;for(x=m=0,h=S;h<C;h++)x+=R[h],b.limit[h]=x-1,x<<=1,m+=R[h],b.base[h+1]=x-m;b.limit[C+1]=Number.MAX_VALUE,b.limit[C]=x+R[C]-1,b.base[S]=0}var T=new Uint32Array(256);for(h=0;h<256;h++)P[h]=h;var N,F=0,M=0,z=0,L=this.dbuf=new Uint32Array(this.dbufSize);for(K=0;;){for(K--||(K=49,z>=Q&&o(s.DATA_ERROR),b=B[I[z++]]),h=b.minLen,y=p.read(h);h>b.maxLen&&o(s.DATA_ERROR),!(y<=b.limit[h]);h++)y=y<<1|p.read(1);((y-=b.base[h])<0||y>=258)&&o(s.DATA_ERROR);var O=b.permute[y];if(O!==0&&O!==1){if(F)for(F=0,M+m>this.dbufSize&&o(s.DATA_ERROR),T[N=v[P[0]]]+=m;m--;)L[M++]=N;if(O>E)break;M>=this.dbufSize&&o(s.DATA_ERROR),T[N=v[N=n(P,h=O-1)]]++,L[M++]=N}else F||(F=1,m=0),m+=O===0?F:2*F,F<<=1}for((A<0||A>=M)&&o(s.DATA_ERROR),y=0,h=0;h<256;h++)g=y+T[h],T[h]=y,y=g;for(h=0;h<M;h++)L[T[N=255&L[h]]]|=h<<8,T[N]++;var H=0,j=0,V=0;return M&&(j=255&(H=L[A]),H>>=8,V=-1),this.writePos=H,this.writeCurrent=j,this.writeCount=M,this.writeRun=V,!0},c.prototype._read_bunzip=function(h,y){var g,p,w;if(this.writeCount<0)return 0;var A=this.dbuf,m=this.writePos,v=this.writeCurrent,E=this.writeCount;this.outputsize;for(var k=this.writeRun;E;){for(E--,p=v,v=255&(m=A[m]),m>>=8,k++==3?(g=v,w=p,v=-1):(g=1,w=v),this.blockCRC.updateCRCRun(w,g);g--;)this.outputStream.writeByte(w),this.nextoutput++;v!=p&&(k=0)}return this.writeCount=E,this.blockCRC.getCRC()!==this.targetBlockCRC&&o(s.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var u=function(h){if("readByte"in h)return h;var y=new r;return y.pos=0,y.readByte=function(){return h[this.pos++]},y.seek=function(g){this.pos=g},y.eof=function(){return this.pos>=h.length},y},f=function(h){var y=new r,g=!0;if(h)if(typeof h=="number")y.buffer=new Uint8Array(h),g=!1;else{if("writeByte"in h)return h;y.buffer=h,g=!1}else y.buffer=new Uint8Array(16384);return y.pos=0,y.writeByte=function(p){if(g&&this.pos>=this.buffer.length){var w=new Uint8Array(2*this.buffer.length);w.set(this.buffer),this.buffer=w}this.buffer[this.pos++]=p},y.getBuffer=function(){if(this.pos!==this.buffer.length){if(!g)throw new TypeError("outputsize does not match decoded input");var p=new Uint8Array(this.pos);p.set(this.buffer.subarray(0,this.pos)),this.buffer=p}return this.buffer},y._coerced=!0,y};return Nc={Bunzip:c,Stream:r,Err:s,decode:function(h,y,g){for(var p=u(h),w=f(y),A=new c(p,w);!("eof"in p)||!p.eof();)if(A._init_block())A._read_bunzip();else{var m=A.reader.read(32)>>>0;if(m!==A.streamCRC&&o(s.DATA_ERROR,"Bad stream CRC (got "+A.streamCRC.toString(16)+" expected "+m.toString(16)+")"),!g||!("eof"in p)||p.eof())break;A._start_bunzip(p,w)}if("getBuffer"in w)return w.getBuffer()},decodeBlock:function(h,y,g){var p=u(h),w=f(g),A=new c(p,w);if(A.reader.seek(y),A._get_next_block()&&(A.blockCRC=new t,A.writeCopies=0,A._read_bunzip()),"getBuffer"in w)return w.getBuffer()},table:function(h,y,g){var p=new r;p.delegate=u(h),p.pos=0,p.readByte=function(){return this.pos++,this.delegate.readByte()},p.delegate.eof&&(p.eof=p.delegate.eof.bind(p.delegate));var w=new r;w.pos=0,w.writeByte=function(){this.pos++};for(var A=new c(p,w),m=A.dbufSize;!("eof"in p)||!p.eof();){var v=8*p.pos+A.reader.bitOffset;if(A.reader.hasByte&&(v-=8),A._init_block()){var E=w.pos;A._read_bunzip(),y(v,w.pos-E)}else{if(A.reader.read(32),!g||!("eof"in p)||p.eof())break;A._start_bunzip(p,w),console.assert(A.dbufSize===m,"shouldn't change block size within multistream file")}}}}})(),C5=t3({__proto__:null},[K5]);export{Eu as AEADEncryptedDataPacket,qt as CleartextMessage,Wi as CompressedDataPacket,mt as GrammarError,mr as LiteralDataPacket,U5 as MarkerPacket,Le as Message,at as OnePassSignaturePacket,re as PacketList,D5 as PaddingPacket,gi as PrivateKey,ma as PublicKey,qi as PublicKeyEncryptedSessionKeyPacket,St as PublicKeyPacket,ls as PublicSubkeyPacket,Ya as SecretKeyPacket,z1 as SecretSubkeyPacket,Pr as Signature,Ie as SignaturePacket,hi as Subkey,oi as SymEncryptedIntegrityProtectedDataPacket,ci as SymEncryptedSessionKeyPacket,Bu as SymmetricallyEncryptedDataPacket,P5 as TrustPacket,$s as UnparseablePacket,_a as UserAttributePacket,ys as UserIDPacket,yi as armor,G as config,O5 as createCleartextMessage,L5 as createMessage,_5 as decrypt,j5 as decryptKey,W5 as decryptSessionKeys,q5 as encrypt,V5 as encryptKey,X5 as encryptSessionKey,l as enums,H5 as generateKey,J5 as generateSessionKey,N5 as readCleartextMessage,Q5 as readKey,T5 as readKeys,F5 as readMessage,R5 as readPrivateKey,M5 as readPrivateKeys,x5 as readSignature,z5 as reformatKey,G5 as revokeKey,Y5 as sign,Zt as unarmor,Z5 as verify};
