import{r as n,$ as pe,w as he,o as fe,a6 as ge,n as be,f as S,g as w,a3 as r,Q as s,j as d,T as v,U as i,y as f,F as O,l as j,P as we,aA as ve}from"./apexcharts-nIAyciCq.js";import{_ as ye,e as xe,x as W}from"./index-QPPWK7xw.js";import{E as X}from"./ExplorerService-oc3qiwdf.js";import{b as _e,a as T}from"./http-BZQDkn3h.js";import{s as ke}from"./vue-core-CU9AIURn.js";import{a as Ve,g as Ce,b as Fe}from"./useSEO-5BaNf11O.js";import{o as A,n as Re,p as N,V as D,d as G,Q as Se,b as Te,ah as Q,G as q,ai as Ne,aj as De,s as Ee,c as Ue}from"./vuetify-_4u1He_j.js";import{u as Pe}from"./i18n-Bm8bpAAW.js";import"./crypto-metamask-D6vz180a.js";import"./ansi-utils-ChIB8aIv.js";import"./socketio-BDGyx5_k.js";import"./uuid-B49X2dQj.js";import"./vueuse-Bid7ZbHY.js";import"./unhead-DEOrWl0D.js";import"./cookie-BfmCf_44.js";import"./unjs-utils-GcjLqAqW.js";import"./query-parser-C3-dT-Rr.js";import"./casl-DNC8KRD8.js";import"./scrollbar-CXs_Utq1.js";import"./icons-mdi-_QP0sdRJ.js";import"./sanitizer-DAUAC_Zc.js";import"./element-plus-Cr1Qs4Q_.js";import"./lodash-C_Sw0jJq.js";const Be={class:"d-flex align-center mb-3"},Le={class:"text-h4 mb-1"},He={class:"text-body-2 mb-0 text-medium-emphasis"},Ie={class:"text-body-1 mb-0"},Me={class:"mb-4"},$e={class:"d-flex justify-space-between align-center gap-2 flex-wrap mb-2"},ze={class:"d-flex flex-column"},Oe={class:"app-timeline-title"},je={class:"app-timeline-meta"},We={__name:"rewards",setup(Xe){const{t}=Pe();Ve({title:"Flux Node Rewards - FLUX Token Mining & Staking | FluxCloud",description:"Track Flux node rewards and FLUX token distribution. View real-time rewards for Cumulus, Nimbus, and Stratus nodes. Monitor block rewards, node earnings, and staking returns on the Flux network.",url:"https://cloud.runonflux.com/dashboards/rewards",keywords:"flux rewards, flux token, node rewards, FLUX mining, flux staking, node earnings, flux income, blockchain rewards, passive income, flux node profit",structuredData:[Ce(),Fe([{name:"Home",url:"https://cloud.runonflux.com"},{name:"Flux Network",url:"https://cloud.runonflux.com/dashboards/overview"},{name:"Rewards",url:"https://cloud.runonflux.com/dashboards/rewards"}])]});const J=xe(),{theme:E}=ke(J),b=n(!0);_e(T,{retries:3,retryDelay:e=>e*1e3,onRetry:e=>{console.log(`Retry attempt #${e}`)}});const K={primary:"#7367F0"},u=n({show:!1,message:"",color:"error"}),y=n(!0),U=n([]),x=n({series:[],chartOptions:{colors:[K.primary],labels:[t("pages.dashboard.rewards.price")],grid:{show:!1},chart:{toolbar:{show:!1},sparkline:{enabled:!0},stacked:!0},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2.5},fill:{type:"gradient",gradient:{shadeIntensity:.9,opacityFrom:.7,opacityTo:0}},xaxis:{type:"numeric",lines:{show:!1},axisBorder:{show:!1},labels:{show:!1}},yaxis:[{y:0}],tooltip:{x:{formatter:e=>new Date(e).toLocaleString("en-GB")},y:{formatter:e=>`$${V(e,2)} ${t("pages.dashboard.rewards.usd")}`},theme:E.value}}}),P=n(0),B=n(0),L=n(0),H=n(0),I=n(0),M=n(0),_=n([]),k=n(null),p=pe([{title:t("pages.dashboard.rewards.cumulusTotalRewards"),collateral:0,type:"cumulus",dotColor:"primary",rewards:{}},{title:t("pages.dashboard.rewards.nimbusTotalRewards"),collateral:0,type:"nimbus",dotColor:"warning",rewards:{}},{title:t("pages.dashboard.rewards.stratusTotalRewards"),collateral:0,type:"stratus",dotColor:"error",rewards:{}}]),$=[{label:t("pages.dashboard.rewards.perDay"),factor:.14285714},{label:t("pages.dashboard.rewards.perWeek"),factor:1},{label:t("pages.dashboard.rewards.perMonth"),factor:4.34812141}];he(E,e=>{k.value&&k.value.updateOptions({tooltip:{theme:e}},!1,!1)});const V=(e,a=2)=>(typeof e=="number"&&!isNaN(e)?e:0).toFixed(a).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");function Y(e){let l=_.value[0]?.find(g=>g.code==="USD");l||(l={rate:0});let o=_.value[1]?.[e];return o===void 0&&(o=0),l.rate*o}const Z=(e,a)=>a*e.factor,h=e=>{u.value.message=e,u.value.color="error",u.value.show=!0},ee=()=>{p[0].collateral=H.value,p[1].collateral=I.value,p[2].collateral=M.value},ae=()=>{p.forEach(e=>{const a=e.type==="cumulus"?P.value:e.type==="nimbus"?B.value:L.value;$.forEach(l=>{e.rewards[l.label]=Z(l,a)})})};let C=null;fe(()=>{z(),C=setInterval(()=>z(),1e3*60*10)}),ge(()=>{C&&clearInterval(C)});const te=async()=>{try{const e=await X.getScannedHeight();return e.data.status==="success"?e.data.data.generalScannedHeight:0}catch(e){return console.error("Error fetching block height:",e),0}},z=async()=>{try{const e=await X.getScannedHeight();if(e.data.status==="success"){const a=e.data.data.generalScannedHeight;H.value=a<1076532?1e4:1e3,I.value=a<1081572?25e3:12500,M.value=a<1087332?1e5:4e4}ee(),await Promise.all([re(),se(),oe()]),ae(),b.value=!1,be(()=>console.log("UI has been updated after calculations."))}catch(e){b.value=!1,console.error("Error fetching data:",e),h(t("pages.dashboard.rewards.errors.failedToFetchData"))}},re=async()=>{try{const e=await T.get("https://vipdrates.zelcore.io/rates");_.value=e.data}catch(e){console.error("Error fetching rates:",e),h(t("pages.dashboard.rewards.errors.failedToFetchRates"))}},se=async()=>{y.value=!0;try{const e=await T.get("https://api.coingecko.com/api/v3/coins/zelcash/market_chart?vs_currency=USD&days=30");U.value=e.data.prices.filter(l=>l[0]>14832324e5);const a=U.value.filter((l,o)=>o%3===0);x.value.series=[{name:t("pages.dashboard.rewards.price"),data:a}]}catch(e){console.error("Error fetching price data:",e),h(t("pages.dashboard.rewards.errors.failedToFetchPriceData"))}finally{y.value=!1}},oe=async()=>{try{const e=await W.fluxnodeCount();if(e.data.status==="error"){h(e.data.data.message||e.data.data);return}const a=e.data.data,l={"stratus-enabled":a["stratus-enabled"],"nimbus-enabled":a["nimbus-enabled"],"cumulus-enabled":a["cumulus-enabled"]};await le(l)}catch(e){console.error("Error fetching node count:",e),h(t("pages.dashboard.rewards.errors.failedToFetchNodeCount"))}},le=async e=>{let a=2.8125,l=4.6875,o=11.25;const c=await te()>=202e4,F=c?.074:.075,ne=c?.259:.125,de=c?.666:.3;try{const m=await W.blockReward();m.data.status!=="error"?(a=(m.data.data.miner*F).toFixed(4),l=(m.data.data.miner*ne).toFixed(4),o=(m.data.data.miner*de).toFixed(4)):h(m.data.data.message||m.data.data)}catch(m){console.error("Error fetching block reward:",m),h(t("pages.dashboard.rewards.errors.failedToFetchBlockReward"))}const ie=e["stratus-enabled"],ce=e["nimbus-enabled"],ue=e["cumulus-enabled"],me=c?4:1,R=720*7*me;P.value=a*R/ue*2,B.value=l*R/ce*2,L.value=o*R/ie*2};return(e,a)=>{const l=ve;return w(),S("div",null,[r(A,null,{default:s(()=>[r(N,{cols:"12"},{default:s(()=>[r(D,{class:"rewards-intro-card"},{default:s(()=>[r(G,null,{default:s(()=>[d("div",Be,[r(Se,{size:"48",color:"success",variant:"tonal",class:"mr-3"},{default:s(()=>[r(Te,{size:"28"},{default:s(()=>[...a[3]||(a[3]=[v("mdi-cash-multiple",-1)])]),_:1})]),_:1}),d("div",null,[d("h2",Le,i(f(t)("pages.dashboard.rewards.intro.title")),1),d("p",He,i(f(t)("pages.dashboard.rewards.intro.subtitle")),1)])]),d("p",Ie,i(f(t)("pages.dashboard.rewards.intro.description")),1)]),_:1})]),_:1})]),_:1})]),_:1}),r(A,null,{default:s(()=>[(w(!0),S(O,null,j(p,(o,g)=>(w(),we(N,{key:g,cols:"12",md:p.length%2===1&&g===p.length-1?"12":"6",lg:"4"},{default:s(()=>[r(D,{title:o.title},{default:s(()=>[r(Q,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=c=>b.value=c),contained:"","scroll-strategy":"none",class:"align-center justify-center overlay"},{default:s(()=>[r(q,{indeterminate:""})]),_:1},8,["modelValue"]),r(G,null,{default:s(()=>[d("div",Me,i(o.collateral.toLocaleString())+" "+i(f(t)("pages.dashboard.rewards.fluxCollateral")),1),r(Ne,{side:"end",align:"start","truncate-line":"both",density:"comfortable","line-thickness":"10",class:"mt-2"},{default:s(()=>[(w(),S(O,null,j($,(c,F)=>r(De,{key:F,"dot-color":o.dotColor,size:"x-small"},{default:s(()=>[d("div",$e,[d("div",ze,[d("span",Oe,i(V(o.rewards[c.label]))+" FLUX ",1),r(Ee,{color:"success",size:"small"},{default:s(()=>[v(" ~$"+i(V(o.rewards[c.label]*Y("FLUX")))+" "+i(f(t)("pages.dashboard.rewards.usd")),1)]),_:2},1024)]),d("span",je,i(c.label),1)]),a[4]||(a[4]=d("div",{class:"mb-3"},null,-1))]),_:2},1032,["dot-color"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["md"]))),128)),r(N,{cols:"12",md:"12",lg:"12"},{default:s(()=>[r(D,{title:f(t)("pages.dashboard.rewards.historicalPriceChart"),height:"350"},{default:s(()=>[r(l,{ref_key:"historyPrice",ref:k,type:"area",height:"300",width:"100%",options:x.value.chartOptions,series:x.value.series},null,8,["options","series"]),r(Q,{"model-value":y.value,contained:"",class:"align-center justify-center overlay"},{default:s(()=>[r(q,{indeterminate:""})]),_:1},8,["model-value"])]),_:1},8,["title"])]),_:1})]),_:1}),r(Re,{modelValue:u.value.show,"onUpdate:modelValue":a[2]||(a[2]=o=>u.value.show=o),color:u.value.color,timeout:"3000"},{actions:s(()=>[r(Ue,{color:"white",variant:"text",onClick:a[1]||(a[1]=o=>u.value.show=!1)},{default:s(()=>[v(i(f(t)("pages.dashboard.rewards.close")),1)]),_:1})]),default:s(()=>[v(i(u.value.message)+" ",1)]),_:1},8,["modelValue","color"])])}}},fa=ye(We,[["__scopeId","data-v-b5d58016"]]);export{fa as default};
