const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-T-LZewlR.js","assets/apexcharts-nIAyciCq.js"])))=>i.map(i=>d[i]);
import{_ as pl}from"./SubscriptionManager-Ck2M1jzK.js";import{_ as ml,a as tl,b as fl,c as vl}from"./ConfirmCustomDialog-D5jNuL5-.js";import{_ as aa,e as Ma,r as Ca,c as gl,j as yl,I as bl}from"./index-QPPWK7xw.js";import{p as me,Q as Nt,b,o as et,s as Ee,Y as Sa,Z as _a,X as Ua,_ as Aa,E as hl,c as B,G as ia,K as Wt,y as wl,z as Wa,A as La,D as Ka,a2 as oa,a3 as wa,a1 as fa,r as ra,a4 as xl,d as Dt,w as al,v as xa,a0 as Gt,a5 as kl,I as Zt,V as rt,n as Va,a as Ht,a6 as _l,F as Ze,a7 as ll,a8 as Tt,J as ta,h as ua,a9 as Xa,f as ka,aa as $l,ab as Cl,g as Za,u as ol,e as ga,L as zl,M as Sl,N as Al,O as Vl,ac as Tl}from"./vuetify-_4u1He_j.js";import{u as pa}from"./i18n-Bm8bpAAW.js";import{$ as Ba,w as bt,f as T,g as d,a3 as t,Q as e,j as s,T as n,U as c,y as a,x as I,P as C,F as De,r as p,c as $e,o as Ta,H as gt,Y as Rl,l as ut,R as Ie,L as wt,q as ca,n as it,az as sl,p as Ft,a2 as za,m as St,s as va,E as ja,ax as Il,a6 as Oa,al as Dl,a as Ul}from"./apexcharts-nIAyciCq.js";import{a as da}from"./http-BZQDkn3h.js";import{s as Fa,u as Ya,e as Ll}from"./vue-core-CU9AIURn.js";import{e as qt}from"./eventBus-BZyChua5.js";import{C as Qa}from"./scrollbar-CXs_Utq1.js";import{q as nl}from"./query-parser-C3-dT-Rr.js";import{_ as el}from"./crypto-metamask-D6vz180a.js";import{H as Bl}from"./syntax-highlight-CM4dKbYA.js";import{x as Fl,a as El,b as Pl,c as Ml,d as jl}from"./xterm-Bx8ZPCXT.js";import{l as Ol}from"./socketio-BDGyx5_k.js";import{L as rl}from"./LoadingSpinner-BLJvP0iy.js";import{_ as Nl}from"./drag-drop-DkJOfs8F.js";import{C as il}from"./clipboard-DDQOmope.js";import{A as ql}from"./ansi-utils-ChIB8aIv.js";import{P as Hl}from"./json-viewer-B_WkHLki.js";import{i as Wl,a as Jl,e as Gl,d as Kl}from"./enterpriseCrypto-BkXqwt7M.js";import{f as Xl}from"./firebase-Cn841U3c.js";import{D as Zl}from"./DaemonService-D09C4O6H.js";import{u as Yl}from"./useSEO-5BaNf11O.js";import{C as ha,L as Ql,a as eo,P as to,b as ao,c as lo,i as oo,p as so,d as no}from"./chartjs-CfHf8-US.js";import"./TosDialog-BaExyJJf.js";import"./uuid-B49X2dQj.js";import"./element-plus-Cr1Qs4Q_.js";import"./lodash-C_Sw0jJq.js";import"./geolocation-BklMEt0S.js";import"./walletService-ARo4SzYC.js";import"./firebase-BnYKcu-W.js";import"./PayPal-ugRCKXrL.js";import"./ExplorerService-oc3qiwdf.js";import"./yaml-CtIyp6rB.js";import"./ssp-logo-white-BYX0TNEU.js";import"./MapComponent-D1NdOhsg.js";import"./leaflet-core-jNE0Bq0j.js";import"./leaflet-cluster-0ODEUdTP.js";import"./vueuse-Bid7ZbHY.js";import"./unhead-DEOrWl0D.js";import"./cookie-BfmCf_44.js";import"./unjs-utils-GcjLqAqW.js";import"./casl-DNC8KRD8.js";import"./icons-mdi-_QP0sdRJ.js";import"./sanitizer-DAUAC_Zc.js";import"./event-utils-DGlX1gEp.js";import"./crypto-walletconnect-Nsddz84n.js";import"./lit-Ba94Z-Zv.js";import"./crypto-viem-CJP2v0S5.js";import"./date-utils-Cx_iWJ70.js";import"./crypto-ox-C1hHNqF1.js";const ro={class:"d-flex w-100 align-center border-frame"},io={class:"d-flex align-center"},uo={class:"text-h5"},co={key:0},po={__name:"RunningInstances",props:{masterSlaveApp:{type:Boolean,required:!0,default:!1},masterIp:{type:[String,null],required:!0,default:""},appSpecs:{type:Object,required:!0},instances:{type:Object,required:!0},selectedNode:{type:String,default:""}},setup(xe){const f=xe,{t:i}=pa(),te=Ba({...f.instances}),q=Ba({...f.appSpecs});return bt(()=>f.instances,j=>{Object.assign(te,j)},{deep:!0}),bt(()=>f.appSpecs,j=>{Object.assign(q,j)},{deep:!0}),(j,he)=>{const ge=ml;return d(),T(De,null,[t(et,{class:"align-center justify-space-between"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center pb-0"},{default:e(()=>[s("div",ro,[s("div",io,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...he[0]||(he[0]=[n(" mdi-information-variant-circle-outline ",-1)])]),_:1})]),_:1}),s("span",uo,c(a(i)("core.runningInstances.deployedInstances")),1)])])]),_:1})]),_:1}),t(et,null,{default:e(()=>[t(me,{class:"pt-0"},{default:e(()=>[s("div",null,[xe.masterSlaveApp&&xe.masterIp?(d(),T("div",co,[t(et,{align:"center",justify:"space-between",class:"mt-1"},{default:e(()=>[t(me,null,{default:e(()=>[t(b,{class:"mr-1"},{default:e(()=>[...he[1]||(he[1]=[n(" mdi-server-network ",-1)])]),_:1}),t(Ee,{color:"success",size:"small"},{default:e(()=>[n(c(a(i)("core.runningInstances.primaryServerIpAddress")),1)]),_:1})]),_:1}),t(Ee,{color:"success",size:"small","text-color":"white",class:"mx-2 mr-4",style:{"font-family":"monospace","font-size":"13px"}},{default:e(()=>[n(c(xe.masterIp),1)]),_:1})]),_:1})])):I("",!0),xe.instances.data.length>0&&q?(d(),C(ge,{key:1,"app-locations":xe.instances.data,expanded:"","app-spec":q,"show-location":"","selected-node":xe.selectedNode,class:"mt-3"},null,8,["app-locations","app-spec","selected-node"])):I("",!0)])]),_:1})]),_:1})],64)}}},mo=aa(po,[["__scopeId","data-v-a981928b"]]),fo={class:"d-flex align-center tab-content"},vo={class:"d-flex align-center tab-content"},go={class:"mx-8 mt-6"},yo={class:"d-flex w-100 align-center border-frame"},bo={class:"d-flex align-center"},ho={class:"text-h5"},wo={class:"d-flex mb-4 gap-2"},xo={key:0,class:"pa-4 border rounded"},ko={class:"d-flex align-center justify-center"},_o={style:{"font-size":"15px"}},$o={key:0,class:"mb-2"},Co={class:"text-white text-caption px-2"},zo={key:0,class:"mt-6"},So={class:"d-flex justify-space-between align-center mb-2"},Ao={style:{"font-size":"16px"}},Vo={class:"d-flex align-center",style:{gap:"8px"}},To={class:"px-4 pt-2 pb-2 text-center top-header"},Ro={class:"text-subtitle-1 font-weight-medium"},Io={class:"d-flex justify-space-between align-center"},Do={style:{"font-size":"14px"}},Uo={style:{"white-space":"nowrap"}},Lo={style:{"white-space":"nowrap","font-size":"14px"}},Bo={style:{"white-space":"nowrap","font-size":"14px"}},Fo={class:"d-flex gap-2"},Eo={class:"ml-2",style:{"font-size":"0.9rem"}},Po={key:1},Mo={class:"d-flex w-100 align-center border-frame"},jo={class:"d-flex align-center"},Oo={class:"text-h5"},No={key:2,style:{"font-size":"0.9rem"}},qo={class:"mt-2 ml-8",style:{"font-size":"0.9rem","text-align":"left"}},Ho={key:0},Wo={class:"mt-1"},Jo={class:"mb-3 mt-3 w-100 pa-4 border rounded"},Go={style:{"font-size":"16px","margin-bottom":"8px"}},Ko={class:"d-flex align-center justify-center"},Xo={class:"text-white text-caption",style:{"font-size":"0.85rem"}},Zo={class:"text-center"},Yo={class:"d-flex w-100 align-center border-frame"},Qo={class:"d-flex align-center"},es={class:"text-h5"},ts={key:0},as={class:"d-flex px-4 pt-2 pb-2 justify-center align-center top-header"},ls={class:"text-subtitle-1 font-weight-medium"},os={class:"d-flex justify-end align-center"},ss={key:0},ns={class:"d-flex justify-space-between align-center"},rs={style:{"font-size":"14px"}},is={key:1},us={style:{"white-space":"nowrap","font-size":"14px"}},ds=["colspan"],cs={class:"d-flex justify-space-between align-center"},ps={style:{"font-size":"14px"}},ms={class:"d-flex justify-space-between align-center"},fs={style:{"font-size":"14px"}},vs=["href"],gs={style:{"white-space":"nowrap"}},ys={class:"d-flex justify-end align-center"},bs={class:"py-2"},hs={class:"my-0",style:{color:"orange"}},ws={class:"d-flex px-4 pt-2 pb-2 justify-center align-center top-header"},xs={class:"text-subtitle-1 font-weight-medium"},ks={class:"d-flex justify-space-between align-center"},_s={style:{"font-size":"14px"}},$s={class:"d-flex justify-space-between align-center"},Cs={style:{"font-size":"14px"}},zs={class:"d-flex justify-space-between align-center"},Ss={style:{"font-size":"14px"}},As=["href"],Vs={style:{"white-space":"nowrap"}},Ts={class:"d-flex align-center justify-end"},Rs={class:"top-header"},Is={class:"text-center d-flex align-center justify-end mr-2 my-1"},Ds={key:1,class:"mb-2 mt-4 w-100 d-flex justify-center align-center pa-4 border rounded"},Us={class:"text-center",style:{"font-size":"16px"}},Ls={key:0},Bs={key:1},Fs={class:"d-flex align-center mt-2"},Es={class:"d-flex px-4 pt-2 pb-2 justify-center align-center top-header"},Ps={class:"text-subtitle-1 font-weight-medium"},Ms={class:"d-flex justify-space-between align-center"},js={style:{"font-size":"14px"}},Os={class:"d-flex justify-space-between align-center"},Ns={style:{"font-size":"14px"}},qs={style:{"white-space":"nowrap"}},Hs={class:"d-flex align-center justify-end"},Ws={class:"top-header"},Js={class:"text-center d-flex align-center justify-end mr-2 my-1"},Gs={style:{"font-size":"14px"}},Ks={key:1,class:"mb-2 mt-4 w-100 pa-4 border rounded"},Xs={class:"text-center",style:{"font-size":"16px"}},Zs={class:"text-white text-caption",style:{"font-size":"0.85rem"}},Ys={key:2},Qs={class:"d-flex justify-space-between align-center"},en={class:"d-flex px-4 pt-2 pb-2 justify-center align-center top-header"},tn={class:"text-subtitle-1 font-weight-medium"},an={class:"d-flex justify-space-between align-center"},ln={style:{"font-size":"14px"}},on={class:"d-flex justify-space-between align-center"},sn={style:{"font-size":"14px"}},nn={class:"d-flex justify-space-between align-center"},rn={style:{"font-size":"14px"}},un=["href"],dn={style:{"white-space":"nowrap"}},cn={class:"d-flex align-center justify-end"},pn={class:"top-header"},mn={class:"text-center d-flex align-center justify-end mr-2 my-1"},fn={style:{"font-size":"14px"}},vn={key:1,class:"mb-2 mt-4 w-100 d-flex justify-center align-center pa-4 border rounded"},gn={class:"text-center",style:{"font-size":"16px"}},yn={key:0},bn={class:"d-flex align-center"},hn={__name:"BackupAndRestore",props:{appSpec:{type:Object,required:!0},executeLocalCommand:{type:Function,required:!0},isComposeSingle:{type:Boolean,required:!0},ipAccess:{type:Boolean,required:!0},currentInstanceIp:{type:String,required:!0}},setup(xe){const f=xe,{t:i}=pa(),te=p({model:!1,text:"",color:"info",icon:"mdi-information",timeout:4e3});let q=null;function j($,u,_=null,y=4e3){q&&clearTimeout(q),te.value={model:!1,text:u,icon:_||{success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information",danger:"mdi-alert-circle"}[$]||"mdi-information",color:$==="danger"?"error":$,timeout:y},requestAnimationFrame(()=>{te.value.model=!0}),q=setTimeout(()=>{te.value.model=!1},y)}function he($,u){return $.length>u?$.slice(0,u)+"...":$}const ge=p(0),ne=p([]),pe=p([]),M=$e(()=>(f.appSpec.compose||[]).map($=>$.name)),Q=$e(()=>({zelidauth:localStorage.getItem("zelidauth")})),Ue=$e(()=>[{title:i("core.backupAndRestore.component"),key:"component"},{title:i("core.backupAndRestore.size"),key:"file_size"},{title:i("core.backupAndRestore.created"),key:"create"},{title:i("core.backupAndRestore.expires"),key:"expire"},{title:i("core.backupAndRestore.actions"),key:"actions"}]),F=p([]),ie=p(!1),ye=p([]),O=$e(()=>ye.value.map($=>$.timestamp)),le=p([]),N=p([]),H=p([]),re=$e(()=>H.value),oe=p([]),G=p("https://mws.fluxdrive.runonflux.io"),Le=p([]),se=p([]),Te=p(!1),L=p(!1),qe=p(!1),Oe=p(null),Re=p([]),He=p(null),je=p(!1),ht=Ma(),{theme:dt}=Fa(ht),Ce={backupList:le,fluxDriveBackups:N,files:Re},at=$e(()=>Re.value.filter($=>$.uploading));function ue(){ne.value=[...M.value]}function S(){return{style:{backgroundColor:"rgba(55, 71, 79, 0.4)"}}}async function w($="local",u="backupList"){const _=f.appSpec.name,y=[];for(const V of M.value){let U;try{const fe=(await f.executeLocalCommand(`/backup/getvolumedataofcomponent/${_}/${V}/B/0/mount`,null,null,!0)).data?.data;if(U=(await f.executeLocalCommand(`/backup/getlocalbackuplist/${encodeURIComponent(`${fe.mount}/backup/${$}`)}/B/0/true/${_}`,null,null,!0)).data?.data,Array.isArray(U)){const ze={component:V,create:+U[0].create,file_size:U[0].size,file:`${fe.mount}/backup/${$}/${U[0].name}`,file_name:U[0].name};y.push(ze)}Ce[u].value=y}catch{return}}}function h($){const u=["B","KB","MB","GB"];let _=0;for(;$>1024&&_<u.length-1;)$/=1024,_++;return`${$.toFixed(2)} ${u[_]}`}function m($,u=!1){const _=new Date($);if(u){_.setDate(_.getDate()+1);const V=_-new Date;if(V>0){const U=Math.floor(V/1e3),W=Math.floor(U/3600),fe=Math.floor(U%3600/60),nt=U%60,ze=` (${W}h ${fe}m ${nt}s left)`;return _.toLocaleString()+ze}else return _.toLocaleString()+" (expired)"}return _.toLocaleString()}const x=p("FluxDrive"),A=$e(()=>[{key:"timestamp",title:i("core.backupAndRestore.name"),sortable:!1},{key:"timestamp",title:i("core.backupAndRestore.time"),sortable:!1},{title:"",value:"actions",sortable:!1}]),de=async($,u=0)=>{if(u!==0){se.value=se.value.filter(_=>_.timestamp!==u);try{const y={headers:{zelidauth:localStorage.getItem("zelidauth")}},V={appname:f.appSpec.name,timestamp:u},U=await da.post(`${G.value}/removeCheckpoint`,V,y);if(U&&U.data&&U.data.status==="success"){const W=$.findIndex(fe=>fe.timestamp===u);return $.splice(W,1),j("success",i("core.backupAndRestore.checkpointBackupRemovedSuccessfully")),!0}return j("danger",U.data.data.message),!1}catch(_){console.error("Error removing checkpoint",_),j("danger",i("core.backupAndRestore.errorRemovingCheckpoint"))}}return!1},E=async()=>{Ct.value=!1,Et.value=!0,be.value=i("core.backupAndRestore.uploading");try{const $=Re.value.map(ve=>new Promise(async(Me,zt)=>{if(!ve.uploaded&&!ve.uploading&&ve.selected_file)try{await st(ve),Me()}catch(vt){zt(vt)}else Me()}));await Promise.all($),Re.value.forEach(ve=>{ve.uploading=!1,ve.uploaded=!1,ve.progress=0}),be.value=i("core.backupAndRestore.initializingRestoreJobs");const u=kt("restore","upload");let _;for(const ve of Re.value)_=jt(u,ve.component,"restore");const V={zelidauth:localStorage.getItem("zelidauth"),"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Connection:"keep-alive"},U=f.currentInstanceIp.split(":")[0],W=f.currentInstanceIp.split(":")[1]||16127;let fe=`https://${U.replace(/\./g,"-")}-${W}.node.api.runonflux.io/apps/appendrestoretask`;f.ipAccess&&(fe=`http://${U}:${W}/apps/appendrestoretask`);const ze=(await fetch(fe,{method:"POST",body:JSON.stringify(_),headers:V})).body.getReader();await new Promise((ve,Me)=>{const zt=()=>{ze.read().then(async({done:vt,value:tt})=>{if(vt){ve();return}const ea=new TextDecoder("utf-8").decode(tt).split(`
`);await We(ea,"restore_upload"),zt()}).catch(Me)};zt()}),Et.value=!1,be.value="",w("upload","files"),j("success",i("core.backupAndRestore.restoreCompletedSuccessfully"))}catch($){console.error("Upload failed",$),Et.value=!1,be.value="Error during upload",j("error",i("core.backupAndRestore.restoreFailed"))}},ce=p(""),Pe=p(null),Je=async()=>{Be.value=!1,je.value=!0,Ve.value=i("core.backupAndRestore.initializingRestoreJobs");const $=localStorage.getItem("zelidauth");try{const u={zelidauth:$,"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Connection:"keep-alive"},_=kt("restore","remote");let y;for(const ze of Ye.value)y=jt(_,ze.component,"restore",Ye.value);const V=f.currentInstanceIp.split(":")[0],U=f.currentInstanceIp.split(":")[1]||16127;let W=`https://${V.replace(/\./g,"-")}-${U}.node.api.runonflux.io/apps/appendrestoretask`;f.ipAccesse&&(W=`http://${V}:${U}/apps/appendrestoretask`);const nt=(await fetch(W,{method:"POST",body:JSON.stringify(y),headers:u})).body.getReader();await new Promise((ze,ve)=>{const Me=()=>{nt.read().then(async({done:zt,value:vt})=>{if(zt){ze();return}const Bt=new TextDecoder("utf-8").decode(vt).split(`
`);await We(Bt,"restore_remote"),Me()}).catch(ve)};Me()}),je.value=!1,Ve.value="",j("success",i("core.backupAndRestore.restoreCompletedSuccessfully"))}catch(u){console.error("Upload failed",u),je.value=!1,Ve.value="Error during upload",j("error",i("core.backupAndRestore.restoreFailed"))}},At=$e(()=>[{key:"component",title:i("core.backupAndRestore.component"),sortable:!1},{key:"file_url",title:i("core.backupAndRestore.url"),sortable:!1},{key:"file_size",title:i("core.backupAndRestore.size"),sortable:!1},{key:"actions",title:"",sortable:!1}]),lt=$e(()=>[{key:"component",title:i("core.backupAndRestore.component"),sortable:!1},{key:"file_url",title:i("core.backupAndRestore.url"),sortable:!1},{key:"timestamp",title:i("core.backupAndRestore.timestamp"),sortable:!1},{key:"file_size",title:i("core.backupAndRestore.size"),sortable:!1},{key:"actions",title:"",sortable:!1}]),ct=$e(()=>[{key:"component",title:i("core.backupAndRestore.component"),sortable:!1},{key:"url",title:i("core.backupAndRestore.url"),sortable:!1},{key:"file_size",title:i("core.backupAndRestore.size"),sortable:!1},{key:"actions",title:"",sortable:!1}]),pt=$e(()=>[{key:"component",title:i("core.backupAndRestore.component"),sortable:!1},{key:"file_name",title:i("core.backupAndRestore.file"),sortable:!1},{key:"file_size",title:i("core.backupAndRestore.size"),sortable:!1},{key:"actions",title:"",sortable:!1}]),be=p(""),Ve=p(""),Ge=p(""),Ke=p(""),Rt=p(""),Yt=p(""),Ct=p(!1),Be=p(!1),Mt=p(!1),Ye=p([]),Qe=p(!1),It=p(!1),Ut=p("flux"),Et=p(!1),ma=$e(()=>[{value:"flux",disabled:!1,text:i("core.backupAndRestore.fluxDrive")},{value:"google",disabled:!0,text:i("core.backupAndRestore.googleDrive")},{value:"as3",disabled:!0,text:i("core.backupAndRestore.as3Storage")}]),Qt={showTopUpload:Ct,showTopRemote:Be,showTopFluxDrive:Mt};function Vt($,u,_,y){Rt.value=$,Yt.value=u,Qt[_]?Qt[_].value=y:console.warn(`Unknown alert element '${_}'`)}const xt=()=>{const $=/^(http|https):\/\/\S+$/,_=(ce.value?ce.value.split("?"):[])[0]||"";return ce.value===""||_.endsWith(".tar.gz")&&$.test(_)},Kt=$e(()=>[$=>$?xt()||i("core.backupAndRestore.invalidUrlValidation"):!0]);async function We($,u){const _={restore_upload:be,restore_remote:Ve,backup:Ke,restore_fluxdrive:Ge};for(const y of $)if(y!==""){const V=_[u];V&&(V.value=y,u==="restore_upload"?y.includes("Error:")?(console.log(y),Vt("danger",y,"showTopUpload",!0)):y.includes("Finalizing")&&setTimeout(()=>{Vt("success",i("core.backupAndRestore.restoreCompletedSuccessfully"),"showTopUpload",!0)},5e3):u==="restore_remote"?y.includes("Error:")?Vt("danger",y,"showTopRemote",!0):y.includes("Finalizing")&&setTimeout(()=>{Vt("success",i("core.backupAndRestore.restoreCompletedSuccessfully"),"showTopRemote",!0),Ye.value=[]},5e3):u==="restore_fluxdrive"&&(y.includes("Error:")?Vt("danger",y,"showTopFluxDrive",!0):y.includes("Finalizing")&&setTimeout(()=>{Vt("success",i("core.backupAndRestore.restoreCompletedSuccessfully"),"showTopFluxDrive",!0),Ye.value=[]},5e3)))}}function kt($,u=""){return{appname:f.appSpec.name,...$==="restore"?{type:u}:{},[$]:f.appSpec.compose.map(_=>({component:_.name,[$]:!1,...$==="restore"&&u==="remote"?{url:""}:{}}))}}function jt($,u,_,y=[]){const V=$[_].find(U=>U.component===u);if(V){if(V[_]=!0,_==="restore"&&$?.type==="remote"){const U=y.find(W=>W.component===u);U?(V.url=U.url,console.log(`URL for ${u}: ${U.url}`)):console.log(`URL info not found for component ${u}.`)}console.log(`Status for ${u} set to true for ${_}.`)}else console.log(`Component ${u} not found in the ${_} array.`);return $}async function sa($){if(!$?.length)return;Qe.value=!0,Ke.value=i("core.backupAndRestore.initializingBackupJobs");const _={zelidauth:localStorage.getItem("zelidauth"),"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Connection:"keep-alive"},y=kt("backup");let V;for(const ve of $)V=jt(y,ve,"backup");const[U,W="16127"]=f.currentInstanceIp.split(":"),fe=f.ipAccess?`http://${U}:${W}/apps/appendbackuptask`:`https://${U.replace(/\./g,"-")}-${W}.node.api.runonflux.io/apps/appendbackuptask`,ze=(await fetch(fe,{method:"POST",body:JSON.stringify(V),headers:_})).body.getReader();await new Promise(ve=>{function Me(){ze.read().then(async({done:zt,value:vt})=>{if(zt){ve();return}const Bt=new TextDecoder("utf-8").decode(vt).split(`
`);await We(Bt,"backup"),Me()})}Me()}),setTimeout(()=>{Qe.value=!1},5e3),w()}function ya($,u,_,y,V){const U=H.value.findIndex(W=>W.fileName===$);U!==-1?H.value[U]={...H.value[U],progress:u,loaded:_,total:y}:H.value.push({fileName:$,progress:u,loaded:_,total:y,component:V})}async function mt($){try{Ke.value=i("core.backupAndRestore.downloadingBackupFiles"),It.value=!0;const _={headers:{zelidauth:localStorage.getItem("zelidauth")},responseType:"blob",onDownloadProgress(U){const{loaded:W,total:fe,event:nt}=U;if(nt?.target?.responseURL)try{const ve=decodeURIComponent(nt.target.responseURL).split("/").slice(-2,-1)[0],Me=fe?W/fe*100:0,zt=le.value.find(vt=>vt.file.includes(ve));zt?ya(ve,Me,W,fe,zt.component):console.warn("Could not match file for progress tracking:",ve)}catch(ze){console.warn("Error parsing responseURL in onDownloadProgress:",ze)}}},y=$.map(async U=>{try{const W=U.file,fe=W.split("/").pop(),nt=await f.executeLocalCommand(`/backup/downloadlocalfile/${encodeURIComponent(W)}/${f.appSpec.name}`,null,_),ze=new Blob([nt.data]),ve=URL.createObjectURL(ze),Me=document.createElement("a");return Me.href=ve,Me.setAttribute("download",fe),document.body.appendChild(Me),Me.click(),document.body.removeChild(Me),URL.revokeObjectURL(ve),!0}catch(W){return console.error("Error downloading file:",W),!1}});(await Promise.all(y)).every(Boolean)?console.log("✅ All downloads completed successfully"):console.warn("⚠️ Some downloads failed. See logs for details.")}catch(u){console.error("Error downloading files:",u)}finally{setTimeout(()=>{It.value=!1,H.value=[],Ke.value=""},5e3)}}async function Pt($,u,_=0){if(_===0){for(const y of u){const V=y.file;await f.executeLocalCommand(`/backup/removebackupfile/${encodeURIComponent(V)}/${f.appSpec.name}`)}le.value=[],pe.value=[]}else{await f.executeLocalCommand(`/backup/removebackupfile/${encodeURIComponent(_)}/${f.appSpec.name}`);const y=u.findIndex(V=>V.component===$);y!==-1&&u.splice(y,1)}await w()}const ot=($,u)=>{const _=F.value.findIndex(y=>y.fileName===u);_!==-1?F.value[_]={fileName:u,progress:+$}:F.value.push({fileName:u,progress:+$})},ft=$e(()=>F.value.filter($=>$.progress>0)),Fe=async()=>{const u={headers:{zelidauth:localStorage.getItem("zelidauth")}},_=[];let y=!1;for(const V of oe.value)try{const U=await da.get(`${G.value}/gettaskstatus?taskId=${V.taskId}`,u);U&&U.data&&U.data.status==="success"?(V.status=U.data.data.status.state,V.status==="downloading"?V.progress=U.data.data.status.progress/2:V.status==="uploading"?V.progress=50+U.data.data.status.progress/2:V.progress=U.data.data.status.progress,V.message=U.data.data.status.message,ot(V.progress,V.component),qe.value=U.data.data.status.message,V.status==="finished"?j("success",i("core.backupAndRestore.backupUploadedSuccessfully",{component:V.component})):V.status==="failed"?j("danger",i("core.backupAndRestore.backupUploadFailed",{component:V.component,message:qe.value})):_.push(V)):y=!0}catch{y=!0,console.log("error fetching upload status")}y||(oe.value=_),oe.value.length>0?setTimeout(()=>{Fe()},2e3):(Te.value=!1,L.value=!1,qe.value="",F.value=[])},Lt=async()=>{try{Te.value=!0;const u={headers:{zelidauth:localStorage.getItem("zelidauth")}};let _=0;const y=pe.value.map(async U=>{try{const{file:W,component:fe,file_size:nt,file_name:ze,create:ve}=U;let Me=ve;Math.abs(Me-_)>1e3*60*60?_=Me:Me=_;const zt=f.currentInstanceIp.split(":")[0],vt=f.currentInstanceIp.split(":")[1]||16127,tt=`https://${zt.replace(/\./g,"-")}-${vt}.node.api.runonflux.io/backup/downloadlocalfile/${encodeURIComponent(W)}/${f.appSpec.name}`,Bt={appname:f.appSpec.name,component:fe,filename:ze,timestamp:Me,host:tt,filesize:nt};console.log(Bt);const ea=await da.post(`${G.value}/registerbackupfile`,Bt,u);if(ea&&ea.data&&ea.data.status==="success")oe.value.push({taskId:ea.data.data.taskId,filename:ze,component:fe,status:"in queue",progress:0});else return console.error(ea.data),j("danger",ea.data.data.message),!1;return!0}catch(W){return console.error("Error registering file:",W),j("danger",i("core.backupAndRestore.errorRegisteringFiles")),!1}});(await Promise.all(y)).every(U=>U)?(console.log("All uploads registered successfully"),L.value=!0):console.error("Some uploads failed. Check the console for details.")}catch($){console.error("Error registering files:",$),j("danger",i("core.backupAndRestore.errorRegisteringFiles"))}finally{setTimeout(()=>{Fe()},2e3)}},la=async()=>{try{const u={headers:{zelidauth:localStorage.getItem("zelidauth")}},_=await da.get(`${G.value}/getbackuplist?appname=${f.appSpec.name}`,u);if(_.data?.status==="success"){console.log(JSON.stringify(_.data.checkpoints));const y=new Set;_.data.checkpoints.forEach(({components:U})=>{U.forEach(W=>y.add(W.component))});const V=[{value:"",text:"all"}];y.forEach(U=>{V.push({value:U,text:U})}),Le.value=V,ye.value=_.data.checkpoints}else _.data?.status==="error"&&j("danger",_.data.data.message)}catch($){console.error("Error receiving FluxDrive backup list",$),j("danger",i("core.backupAndRestore.errorReceivingFluxDriveBackupList"))}};function k($){const u=ye.value.find(_=>_.timestamp===$);if(u){const _=u.components.map(y=>({component:y.component,file_url:y.file_url,timestamp:u.timestamp,file_size:y.file_size}));se.value=_}}function o($,u){const _=se.value.findIndex(y=>y.component===$.component);_!==-1?se.value[_]={component:$.component,file_url:$.file_url,timestamp:u,file_size:$.file_size}:se.value.push({component:$.component,timestamp:u,file_url:$.file_url,file_size:$.file_size})}async function l($){const u=$.map(ze=>({component:ze.component,file_size:ze.file_size,url:ze.file_url}));ie.value=!0,Ge.value=i("core.backupAndRestore.initializingRestoreJobs");const y={zelidauth:localStorage.getItem("zelidauth"),"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Connection:"keep-alive"},V=kt("restore","remote");let U;for(const ze of u)U=jt(V,ze.component,"restore",u);const[W,fe=16127]=f.currentInstanceIp.split(":");let nt=`https://${W.replace(/\./g,"-")}-${fe}.node.api.runonflux.io/apps/appendrestoretask`;f.ipAccess&&(nt=`http://${W}:${fe}/apps/appendrestoretask`);try{const ve=(await fetch(nt,{method:"POST",body:JSON.stringify(U),headers:y})).body.getReader();await new Promise((Me,zt)=>{function vt(){ve.read().then(async({done:tt,value:Bt})=>{if(tt){Me();return}const Ea=new TextDecoder("utf-8").decode(Bt).split(`
`);await We(Ea,"restore_fluxdrive"),vt()}).catch(zt)}vt()}),ie.value=!1,Ge.value="",j("success",i("core.backupAndRestore.restoreCompletedSuccessfully"))}catch(ze){console.error("Error during restore process:",ze),ie.value=!1,Ge.value="Restore failed.",j("error",i("core.backupAndRestore.restoreFailed"))}}const v=$=>$.reduce((u,_)=>u+_.file_size,0),R=($,u)=>{u.splice($,1)},z=async($,u)=>{if(ce.value.trim()!==""&&u!==null)try{const _=await f.executeLocalCommand(`/backup/getremotefilesize/${encodeURIComponent(ce.value.trim())}/B/0/true/${$}`);if(_.data?.status!=="success"){j("danger",_.data?.data?.message||_.data?.massage);return}const y=await f.executeLocalCommand(`/backup/getvolumedataofcomponent/${$}/${u}/B/0/size,available,mount`);if(y.data?.status!=="success"){j("danger",y.data?.data?.message||y.data?.data);return}if(_.data?.data>y.data?.data?.available){j("danger",`File is too large (${h(_.value.data.data)})...`);return}if(Ye.value.findIndex(W=>W.url===ce.value)!==-1){j("warning",i("core.backupAndRestore.urlAlreadyInQueue",{url:ce.value}));return}const U=Ye.value.findIndex(W=>W.component===u);if(_.data?.data===0||_.data?.data===null)return;U!==-1?(Ye.value[U].url=ce.value,Ye.value[U].file_size=_.value.data.data):Ye.value.push({url:ce.value,component:u,file_size:_.data.data})}catch(_){j("danger",`Error: ${_.message}`)}},D=()=>{it(()=>{Oe.value?(Oe.value.value="",Oe.value.click()):console.error("File input reference not available")})},X=$=>{const{files:u}=$.target;u.length>0?P([...u]):console.warn("No files selected.")},P=async $=>{for(const u of $){const y=(await f.executeLocalCommand(`/backup/getvolumedataofcomponent/${f.appSpec.name}/${He.value}/B/0/mount,available,size`)).data?.data?.mount;if(Re.value.findIndex(fe=>fe.file_name===u.name&&fe.component!==He.value)!==-1)return j("warning",i("core.backupAndRestore.fileAlreadyInQueue",{fileName:u.name})),!1;const U=Re.value.findIndex(fe=>fe.component===He.value),W={selected_file:u,uploading:!1,uploaded:!1,progress:0,path:`${y}/backup/upload`,component:He.value,file_name:`backup_${He.value.toLowerCase()}.tar.gz`,file_size:u.size};U!==-1?Re.value[U]=W:Re.value.push(W)}return!0},ke=$=>{Re.value=Re.value.filter(u=>u.selected_file.name!==$.selected_file.name)};function Ne($){const u=f.currentInstanceIp.split(":")[0],_=f.currentInstanceIp.split(":")[1]||16127,y=encodeURIComponent($);return f.ipAccess?`http://${u}:${_}/ioutils/fileupload/backup/${f.appSpec.name}/${He.value}/null/${y}`:`https://${u.replace(/\./g,"-")}-${_}.node.api.runonflux.io/ioutils/fileupload/backup/${f.appSpec.name}/${He.value}/null/${y}`}async function st($,u=!1){return new Promise((_,y)=>{if(typeof XMLHttpRequest>"u"){y("XMLHttpRequest is not supported.");return}const V=new XMLHttpRequest;let U;u?U=getUploadFolder():U=Ne($.file_name),V.upload&&(V.upload.onprogress=function(ve){ve.total>0&&(ve.percent=ve.loaded/ve.total*100),$.progress=ve.percent});const W=new FormData;if(u){const ze=new Blob([$.content],{type:"text/plain"});W.append($.file_name,ze)}else W.append($.selected_file.name,$.selected_file);$.uploading=!0,V.onerror=function(ve){Et.value=!1,be.value="",Re.value.forEach(Me=>{Me.uploading=!1,Me.uploaded=!1,Me.progress=0}),j("danger",i("core.backupAndRestore.uploadError",{fileName:$.selected_file.name})),y(ve)},V.onload=function(){if(V.status<200||V.status>=300){console.error(V.status),Et.value=!1,be.value="",Re.value.forEach(ve=>{ve.uploading=!1,ve.uploaded=!1,ve.progress=0}),j("danger",i("core.backupAndRestore.uploadErrorWithStatus",{fileName:$.selected_file.name,status:V.status})),y(V.status);return}$.uploaded=!0,$.uploading=!1,_()},V.open("post",U,!0);const fe=Q.value||{},nt=Object.keys(fe);for(let ze=0;ze<nt.length;ze+=1){const ve=nt[ze];Object.prototype.hasOwnProperty.call(fe,ve)&&fe[ve]!==null&&V.setRequestHeader(ve,fe[ve])}V.setRequestHeader("Access-Control-Allow-Origin","*"),V.send(W)})}bt(ge,async($,u)=>{console.log("Tab changed from",u,"to",$),$===0?await w():$===1&&await la()});const _t=({item:$})=>pe.value.some(_=>_.file===$.file)?{style:"background-color: rgba(var(--v-theme-primary), 0.2) !important;"}:{};return Ta(async()=>{await w(),await la()}),($,u)=>{const _=tl;return d(),T(De,null,[t(rt,{flat:""},{default:e(()=>[t(Sa,{modelValue:a(ge),"onUpdate:modelValue":u[0]||(u[0]=y=>gt(ge)?ge.value=y:null),grow:"",density:"comfortable",class:"v-tabs-pill"},{default:e(()=>[t(_a,{value:0,class:"mx-1"},{default:e(()=>[s("div",fo,[t(b,{class:"mr-2",style:{"font-size":"22px !important",height:"22px !important",width:"22px !important"}},{default:e(()=>[...u[18]||(u[18]=[n(" mdi-database-arrow-up ",-1)])]),_:1}),s("span",null,c(a(i)("core.backupAndRestore.backup")),1)])]),_:1}),t(_a,{value:1,class:"mx-1"},{default:e(()=>[s("div",vo,[t(b,{class:"mr-2",style:{"font-size":"22px !important",height:"22px !important",width:"22px !important"}},{default:e(()=>[...u[19]||(u[19]=[n(" mdi-database-arrow-down ",-1)])]),_:1}),s("span",null,c(a(i)("core.backupAndRestore.restore")),1)])]),_:1})]),_:1},8,["modelValue"]),t(Ua,{modelValue:a(ge),"onUpdate:modelValue":u[16]||(u[16]=y=>gt(ge)?ge.value=y:null)},{default:e(()=>[t(Aa,{value:0},{default:e(()=>[s("div",go,[t(et,{class:"align-center justify-space-between mb-3"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center pb-0"},{default:e(()=>[s("div",yo,[s("div",bo,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...u[20]||(u[20]=[n(" mdi-database-arrow-up ",-1)])]),_:1})]),_:1}),s("span",ho,c(a(i)("core.backupAndRestore.backupContainerData")),1)])])]),_:1})]),_:1}),t(hl,{modelValue:a(ne),"onUpdate:modelValue":u[1]||(u[1]=y=>gt(ne)?ne.value=y:null),items:a(M),multiple:"",chips:"","closable-chips":"",placeholder:a(i)("core.backupAndRestore.selectComponentsToBackup"),"hide-selected":"","hide-no-data":"",class:"mb-4 red-hover",clearable:"",rounded:""},null,8,["modelValue","items","placeholder"]),s("div",wo,[t(B,{variant:"outlined",color:"primary",density:"comfortable",onClick:ue},{default:e(()=>[t(b,{start:"",size:"19"},{default:e(()=>[...u[21]||(u[21]=[n(" mdi-checkbox-multiple-marked ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.selectAll")),1)]),_:1}),t(B,{variant:"outlined",color:"primary",density:"comfortable",disabled:a(ne).length===0||a(Qe),onClick:u[2]||(u[2]=y=>sa(a(ne)))},{default:e(()=>[t(b,{start:"",size:"19"},{default:e(()=>[...u[22]||(u[22]=[n(" mdi-database-arrow-up ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.createBackup")),1)]),_:1},8,["disabled"])]),t(Rl,{name:"fade"},{default:e(()=>[a(Qe)||a(It)?(d(),T("div",xo,[s("div",ko,[t(ia,{indeterminate:"",size:"20",class:"mr-2"}),s("span",_o,c(a(Ke)),1)]),a(It)?(d(),T("div",$o)):I("",!0),(d(!0),T(De,null,ut(a(re),(y,V)=>(d(),T("div",{key:V},[t(Wt,{"model-value":y.progress,height:"16",class:"mb-2",color:"success"},{default:e(()=>[s("div",Co,c(y.fileName)+" - "+c(y.progress.toFixed(2))+"% ",1)]),_:2},1032,["model-value"])]))),128))])):I("",!0)]),_:1}),a(le).length>0&&!a(It)&&!a(Qe)?(d(),T("div",zo,[s("div",So,[t(Ee,{class:"current-task-chip",variant:"tonal",rounded:"pill"},{prepend:e(()=>[t(b,{size:"24",class:"mr-1"},{default:e(()=>[...u[23]||(u[23]=[n(" mdi-lifebuoy ",-1)])]),_:1})]),default:e(()=>[s("span",Ao,c(a(i)("core.backupAndRestore.availableLocalBackups")),1)]),_:1}),s("div",Vo,[t(wl,null,{activator:e(({props:y})=>[t(B,wt(y,{icon:"",color:"primary",density:"compact"}),{default:e(()=>[t(b,null,{default:e(()=>[...u[24]||(u[24]=[n(" mdi-download ",-1)])]),_:1})]),_:1},16)]),default:e(()=>[t(Wa,null,{default:e(()=>[t(La,{disabled:a(pe)?.length===0,onClick:u[3]||(u[3]=y=>mt(a(pe)))},{default:e(()=>[t(Ka,null,{default:e(()=>[t(b,{start:"",size:"20"},{default:e(()=>[...u[25]||(u[25]=[n(" mdi-progress-check ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.downloadSelected")),1)]),_:1})]),_:1},8,["disabled"]),t(La,{onClick:u[4]||(u[4]=y=>mt(a(le)))},{default:e(()=>[t(Ka,null,{default:e(()=>[t(b,{start:"",size:"20"},{default:e(()=>[...u[26]||(u[26]=[n(" mdi-download-circle-outline ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.downloadAll")),1)]),_:1})]),_:1})]),_:1})]),_:1}),Ie((d(),C(B,{id:"remove-all",class:"mr-2",icon:"",color:"error",density:"compact"},{default:e(()=>[t(b,null,{default:e(()=>[...u[27]||(u[27]=[n(" mdi-trash-can-outline ",-1)])]),_:1})]),_:1})),[[oa,a(i)("core.backupAndRestore.removeAllBackupFiles"),void 0,{bottom:!0}]]),t(_,{target:"remove-all","confirm-button":a(i)("core.backupAndRestore.removeAllBackupFiles"),onConfirm:u[5]||(u[5]=y=>Pt(null,a(le)))},null,8,["confirm-button"])])]),t(wa,{border:"",rounded:"",class:"mt-2",style:{"max-height":"400px"}},{default:e(()=>[t(fa,{modelValue:a(pe),"onUpdate:modelValue":u[6]||(u[6]=y=>gt(pe)?pe.value=y:null),items:a(le),headers:a(Ue),class:"elevation-1 overflow-hidden","show-select":"","hide-default-footer":"","return-object":"",density:"compact","item-value":"file","row-props":_t},{top:e(()=>[s("div",To,[s("div",Ro,c(a(i)("core.backupAndRestore.backupListDescription")),1)]),t(ra)]),"item.component":e(({item:y})=>[s("div",Io,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[28]||(u[28]=[n(" mdi-cube ",-1)])]),_:1})]),default:e(()=>[s("span",Do,c(y.component),1)]),_:2},1024)])]),"item.file_size":e(({item:y})=>[s("span",Uo,c(h(y.file_size)),1)]),"item.create":e(({item:y})=>[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"warning",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[29]||(u[29]=[n(" mdi-timer-cog ",-1)])]),_:1})]),default:e(()=>[s("span",Lo,c(m(y.create)),1)]),_:2},1024)]),"item.expire":e(({item:y})=>[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"error",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[30]||(u[30]=[n(" mdi-timer-remove ",-1)])]),_:1})]),default:e(()=>[s("span",Bo,c(m(y.create,!0)),1)]),_:2},1024)]),"item.actions":e(({item:y})=>[s("div",Fo,[Ie((d(),C(B,{icon:"",density:"compact",variant:"tonal",onClick:V=>mt([{component:y.component,file:y.file}])},{default:e(()=>[t(b,{size:"19"},{default:e(()=>[...u[31]||(u[31]=[n(" mdi-cloud-download ",-1)])]),_:1})]),_:1},8,["onClick"])),[[oa,a(i)("core.backupAndRestore.downloadBackupFile"),void 0,{bottom:!0}]]),Ie((d(),C(B,{id:`remove-${y.component}`,icon:"",color:"error",variant:"tonal",density:"compact"},{default:e(()=>[t(b,{size:"19"},{default:e(()=>[...u[32]||(u[32]=[n(" mdi-trash-can-outline ",-1)])]),_:1})]),_:1},8,["id"])),[[oa,a(i)("core.backupAndRestore.removeBackupFile"),void 0,{bottom:!0}]]),t(_,{target:`remove-${y.component}`,"confirm-button":a(i)("core.backupAndRestore.removeBackupFile"),onConfirm:V=>Pt(y.component,a(le),y.file)},null,8,["target","confirm-button","onConfirm"])])]),_:1},8,["modelValue","items","headers"])]),_:1}),s("span",Eo,c(a(i)("core.backupAndRestore.selectComponentsToUpload")),1)])):I("",!0),a(le).length>0&&!a(It)&&!a(Qe)?(d(),T("div",Po,[t(et,{class:"align-center justify-space-between mt-2"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center pb-0"},{default:e(()=>[s("div",Mo,[s("div",jo,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...u[33]||(u[33]=[n(" mdi-server ",-1)])]),_:1})]),_:1}),s("span",Oo,c(a(i)("core.backupAndRestore.chooseStorageMethod")),1)])])]),_:1}),t(xl,{modelValue:a(Ut),"onUpdate:modelValue":u[7]||(u[7]=y=>gt(Ut)?Ut.value=y:null),mandatory:"",color:"primary",class:"ml-2",style:{border:"none"},group:""},{default:e(()=>[(d(!0),T(De,null,ut(a(ma),y=>(d(),C(B,{key:y.value,value:y.value,disabled:y.disabled,style:{"min-width":"150px","max-width":"200px"},class:"mr-2",variant:"tonal",size:"small",density:"compact"},{default:e(()=>[n(c(y.text),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})])):I("",!0),a(Ut)==="flux"&&a(le).length>0&&!a(It)&&!a(Qe)?(d(),T("div",No,[s("div",null,[s("ul",qo,[s("li",null,c(a(i)("core.backupAndRestore.freeFluxDriveInfo")),1),s("li",null,c(a(i)("core.backupAndRestore.fluxDriveDownloadInfo")),1)])]),a(ft).length>0?(d(),T("div",Ho,[s("div",Wo,[s("div",Jo,[s("h5",Go,[s("span",Ko,[t(ia,{indeterminate:"",size:"20",class:"mr-2"}),n(" "+c(a(qe)),1)])]),(d(!0),T(De,null,ut(a(ft),(y,V)=>(d(),C(Wt,{key:V,"model-value":y.progress,class:"mt-1",style:{height:"16px"},max:100,color:"success"},{default:e(({value:U})=>[s("span",Xo,c(`${y.fileName} - ${U.toFixed(2)}%`),1)]),_:2},1032,["model-value"]))),128))])])])):I("",!0),s("div",Zo,[t(B,{class:"mt-4",disabled:a(pe).length===0&&a(Te)===!1,style:{width:"100%"},variant:"flat",color:"primary",onClick:Lt},{default:e(()=>[t(b,{class:"mr-1",size:"1.5rem"},{default:e(()=>[...u[34]||(u[34]=[n(" mdi-cloud-upload ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.uploadSelectedComponents")),1)]),_:1},8,["disabled"])])])):I("",!0)])]),_:1}),t(Aa,{value:1},{default:e(()=>[t(Dt,null,{default:e(()=>[t(et,{class:"align-center justify-space-between mb-3"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center pb-0"},{default:e(()=>[s("div",Yo,[s("div",Qo,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...u[35]||(u[35]=[n(" mdi-cloud-download ",-1)])]),_:1})]),_:1}),s("span",es,c(a(i)("core.backupAndRestore.selectRestoreMethod")),1)])])]),_:1})]),_:1}),t(al,{modelValue:a(x),"onUpdate:modelValue":u[8]||(u[8]=y=>gt(x)?x.value=y:null),inline:"",class:"mb-2 fit-to-content-with-border",color:"primary"},{default:e(()=>[t(xa,{label:a(i)("core.backupAndRestore.fluxDrive"),value:"FluxDrive"},null,8,["label"]),t(xa,{label:a(i)("core.backupAndRestore.uploadFile"),value:"Upload File"},null,8,["label"]),t(xa,{label:a(i)("core.backupAndRestore.remoteUrl"),value:"Remote URL",class:"mr-2"},null,8,["label"])]),_:1},8,["modelValue"]),a(x)==="FluxDrive"?(d(),T("div",ts,[t(wa,{class:"mt-2 overflow-hidden",border:"",rounded:""},{default:e(()=>[t(fa,{expanded:a(O),"onUpdate:expanded":u[9]||(u[9]=y=>gt(O)?O.value=y:null),items:a(ye),headers:a(A),"item-value":"timestamp",class:"elevation-1","hide-default-footer":"","hide-default-header":a(ye).length===0,density:"compact","row-props":S},{top:e(()=>[s("div",as,[t(b,{size:"22",class:"mr-1"},{default:e(()=>[...u[36]||(u[36]=[n(" mdi-archive-sync ",-1)])]),_:1}),s("div",ls,[s("b",null,c(a(i)("core.backupAndRestore.backupsInventory")),1)])]),t(ra)]),"item.actions":e(({item:y})=>[s("div",os,[Ie((d(),C(B,{id:`remove-checkpoint-${y.timestamp}`,icon:"",variant:"text",color:a(dt)==="dark"?"error":"rgba(211, 47, 47, 0.85)",class:"mr-1",size:"small"},{default:e(()=>[t(b,{size:"19"},{default:e(()=>[...u[37]||(u[37]=[n(" mdi-delete ",-1)])]),_:1})]),_:1},8,["id","color"])),[[oa,a(i)("core.backupAndRestore.removeBackup"),void 0,{bottom:!0}]]),t(_,{target:`remove-checkpoint-${y.timestamp}`,"confirm-button":a(i)("core.backupAndRestore.removeBackup"),onConfirm:V=>de(a(ye),y.timestamp)},null,8,["target","confirm-button","onConfirm"]),Ie((d(),C(B,{icon:"",variant:"text",color:a(dt)==="dark"?"success":"rgba(1, 87, 72, 0.75)",size:"small",onClick:V=>k(y.timestamp)},{default:e(()=>[t(b,{size:"19"},{default:e(()=>[...u[38]||(u[38]=[n(" mdi-plus-box-multiple ",-1)])]),_:1})]),_:1},8,["color","onClick"])),[[oa,a(i)("core.backupAndRestore.addAllToRestoreList"),void 0,{bottom:!0}]])])]),"item.timestamp":e(({item:y,column:V})=>[s("div",null,[V.title==="Name"?(d(),T("div",ss,[s("div",ns,[t(Ee,{class:"current-task-chip",variant:"flat",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[39]||(u[39]=[n(" mdi-archive-cog ",-1)])]),_:1})]),default:e(()=>[s("span",rs,"backup_"+c(y.timestamp),1)]),_:2},1024)])])):I("",!0),V.title==="Time"?(d(),T("div",is,[t(Ee,{class:"current-task-chip",variant:"flat",size:"small",color:"info",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[40]||(u[40]=[n(" mdi-timer-cog ",-1)])]),_:1})]),default:e(()=>[s("span",us,c(m(y.timestamp)),1)]),_:2},1024)])):I("",!0)])]),"expanded-row":e(({columns:y,item:V})=>[s("tr",null,[s("td",{colspan:y.length,style:{padding:"0px !important"}},[t(fa,{items:V.components,headers:a(At),"hide-default-footer":"","item-value":"component",density:"compact","hide-default-header":""},{"item.component":e(({item:U})=>[s("div",cs,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[41]||(u[41]=[n(" mdi-cube ",-1)])]),_:1})]),default:e(()=>[s("span",ps,c(U.component),1)]),_:2},1024)])]),"item.file_url":e(({item:U})=>[s("div",ms,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"#0091EA",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[42]||(u[42]=[n(" mdi-link-box-variant ",-1)])]),_:1})]),default:e(()=>[s("span",fs,[s("a",{href:U.file_url,class:"truncate-text"},c(U.file_url),9,vs)])]),_:2},1024)])]),"item.file_size":e(({item:U})=>[s("span",gs,c(h(U.file_size)),1)]),"item.actions":e(({item:U})=>[s("div",ys,[Ie((d(),C(B,{icon:"",variant:"text",color:a(dt)==="dark"?"success":"rgba(1, 87, 72, 0.75)",size:"small",onClick:W=>o(U,V.timestamp)},{default:e(()=>[t(b,{size:"19"},{default:e(()=>[...u[43]||(u[43]=[n(" mdi-plus-box ",-1)])]),_:1})]),_:1},8,["color","onClick"])),[[oa,a(i)("core.backupAndRestore.addToRestoreList"),void 0,{bottom:!0}]])])]),_:2},1032,["items","headers"])],8,ds)])]),"no-data":e(()=>[s("div",bs,[s("p",hs,c(a(i)("core.backupAndRestore.noBackupRecords")),1)])]),_:1},8,["expanded","items","headers","hide-default-header"])]),_:1}),a(se).length>0?(d(),C(wa,{key:0,class:"mt-6 overflow-hidden",border:"",rounded:""},{default:e(()=>[t(fa,{items:a(se),headers:a(lt),"item-key":"component",density:"compact","hide-default-footer":""},{top:e(()=>[s("div",ws,[t(b,{size:"22",class:"mr-1"},{default:e(()=>[...u[44]||(u[44]=[n(" mdi-lifebuoy ",-1)])]),_:1}),s("div",xs,[s("b",null,c(a(i)("core.backupAndRestore.restoreOverview")),1)])]),t(ra)]),"item.component":e(({item:y})=>[s("div",ks,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[45]||(u[45]=[n(" mdi-cube ",-1)])]),_:1})]),default:e(()=>[s("span",_s,c(y.component),1)]),_:2},1024)])]),"item.timestamp":e(({item:y})=>[s("div",$s,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"warning",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[46]||(u[46]=[n(" mdi-archive-clock ",-1)])]),_:1})]),default:e(()=>[s("span",Cs,c(y.timestamp),1)]),_:2},1024)])]),"item.file_url":e(({item:y})=>[s("div",zs,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"#0091EA",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[47]||(u[47]=[n(" mdi-link-box-variant ",-1)])]),_:1})]),default:e(()=>[s("span",Ss,[s("a",{href:y.file_url,class:"truncate-text"},c(y.file_url),9,As)])]),_:2},1024)])]),"item.file_size":e(({item:y})=>[s("span",Vs,c(h(y.file_size)),1)]),"item.actions":e(({index:y})=>[s("div",Ts,[Ie((d(),C(B,{icon:"",variant:"text",color:"error",size:"small",onClick:V=>R(y,a(se))},{default:e(()=>[t(b,null,{default:e(()=>[...u[48]||(u[48]=[n("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[oa,a(i)("core.backupAndRestore.removeRestoreJob"),void 0,{bottom:!0}]])])]),bottom:e(()=>[t(ra),s("th",Rs,[s("div",Is,[t(b,{class:"mr-2"},{default:e(()=>[...u[49]||(u[49]=[n(" mdi-equal-box ",-1)])]),_:1}),n(" "+c(h(v(a(se)))),1)])])]),_:1},8,["items","headers"])]),_:1})):I("",!0),a(ie)?(d(),T("div",Ds,[s("h5",Us,[a(ie)?(d(),T("span",Ls,[t(ia,{indeterminate:"",size:"20",class:"mr-2"}),n(" "+c(he(a(Ge),50)),1)])):I("",!0)])])):I("",!0),a(se).length>0?(d(),C(B,{key:2,disabled:a(ie),class:"mt-4",block:"",variant:"flat",color:"primary",onClick:u[10]||(u[10]=y=>l(a(se)))},{default:e(()=>[t(b,{start:"",size:"22"},{default:e(()=>[...u[50]||(u[50]=[n(" mdi-rotate-left ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.restore")),1)]),_:1},8,["disabled"])):I("",!0)])):I("",!0),a(x)==="Upload File"?(d(),T("div",Bs,[s("div",Fs,[t(Gt,{modelValue:a(He),"onUpdate:modelValue":u[11]||(u[11]=y=>gt(He)?He.value=y:null),items:a(M),placeholder:a(i)("core.backupAndRestore.selectComponent"),"prepend-inner-icon":"mdi-cube-outline","prepend-icon":"",clearable:""},null,8,["modelValue","items","placeholder"]),t(B,{icon:"",color:"primary",disabled:!a(He),class:"ml-2",onClick:D},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...u[51]||(u[51]=[n(" mdi-cloud-upload ",-1)])]),_:1})]),_:1},8,["disabled"]),t(kl,{id:"file-selector",ref_key:"fileselector",ref:Oe,modelValue:a(Oe),"onUpdate:modelValue":u[12]||(u[12]=y=>gt(Oe)?Oe.value=y:null),type:"file",accept:".tar.gz",style:{display:"none"},onChange:X},null,8,["modelValue"])]),a(Re).length>0?(d(),C(wa,{key:0,class:"mt-4 overflow-hidden",border:"",rounded:""},{default:e(()=>[t(fa,{items:a(Re),headers:a(pt),"item-key":"component",density:"compact","hide-default-footer":""},{top:e(()=>[s("div",Es,[t(b,{size:"22",class:"mr-1"},{default:e(()=>[...u[52]||(u[52]=[n(" mdi-lifebuoy ",-1)])]),_:1}),s("div",Ps,[s("b",null,c(a(i)("core.backupAndRestore.restoreOverview")),1)])]),t(ra)]),"item.component":e(({item:y})=>[s("div",Ms,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[53]||(u[53]=[n(" mdi-cube ",-1)])]),_:1})]),default:e(()=>[s("span",js,c(y.component),1)]),_:2},1024)])]),"item.file_name":e(({item:y})=>[s("div",Os,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"#0091EA",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[54]||(u[54]=[n(" mdi-zip-box ",-1)])]),_:1})]),default:e(()=>[s("span",Ns,c(y.file_name),1)]),_:2},1024)])]),"item.file_size":e(({item:y})=>[s("span",qs,c(h(y.file_size)),1)]),"item.actions":e(({item:y})=>[s("div",Hs,[Ie((d(),C(B,{icon:"",variant:"text",color:"error",size:"small",onClick:V=>ke(y)},{default:e(()=>[t(b,null,{default:e(()=>[...u[55]||(u[55]=[n("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[oa,a(i)("core.backupAndRestore.removeRestoreJob"),void 0,{top:!0}]])])]),bottom:e(()=>[t(ra),s("th",Ws,[s("div",Js,[t(b,{class:"mr-2"},{default:e(()=>[...u[56]||(u[56]=[n(" mdi-equal-box ",-1)])]),_:1}),s("span",Gs,c(h(v(a(Re)))),1)])])]),_:1},8,["items","headers"])]),_:1})):I("",!0),a(Et)?(d(),T("div",Ks,[s("h5",Xs,[a(Et)?(d(),T("span",{key:0,class:ca(["d-flex justify-center align-center",[{"mb-2":a(at).length>0}]])},[t(ia,{indeterminate:"",size:"20",class:"mr-2"}),n(" "+c(he(a(be),50)),1)],2)):I("",!0)]),(d(!0),T(De,null,ut(a(at),y=>(d(),T("div",{key:y.file_name,class:"upload-item mb-1 w-100"},[y.uploading?(d(),C(Wt,{key:0,"model-value":y.progress,max:"100",height:"16",color:"success"},{default:e(({value:V})=>[s("span",Zs,c(`${y.file_name} - ${V.toFixed(2)}%`),1)]),_:2},1032,["model-value"])):I("",!0)]))),128))])):I("",!0),a(Re).length>0?(d(),C(B,{key:2,class:"mt-4",block:"",color:"primary",disabled:a(Et),onClick:E},{default:e(()=>[t(b,{start:"",size:"22"},{default:e(()=>[...u[57]||(u[57]=[n(" mdi-rotate-left ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.restore")),1)]),_:1},8,["disabled"])):I("",!0)])):I("",!0),a(x)==="Remote URL"?(d(),T("div",Ys,[t(Zt,{modelValue:a(ce),"onUpdate:modelValue":u[13]||(u[13]=y=>gt(ce)?ce.value=y:null),placeholder:a(i)("core.backupAndRestore.enterRemoteBackupUrl"),class:"mb-4 mt-2","prepend-inner-icon":"mdi-web","prepend-icon":"",type:"url",clearable:"",rules:a(Kt)},null,8,["modelValue","placeholder","rules"]),s("div",Qs,[t(Gt,{modelValue:a(Pe),"onUpdate:modelValue":u[14]||(u[14]=y=>gt(Pe)?Pe.value=y:null),items:a(M),placeholder:a(i)("core.backupAndRestore.selectComponent"),"prepend-inner-icon":"mdi-cube-outline","prepend-icon":"",clearable:""},null,8,["modelValue","items","placeholder"]),Ie((d(),C(B,{icon:"",variant:"flat",class:"ml-2",color:"primary",disabled:!a(ce)||!a(Pe),onClick:u[15]||(u[15]=y=>z(f.appSpec.name,a(Pe)))},{default:e(()=>[t(b,null,{default:e(()=>[...u[58]||(u[58]=[n(" mdi-plus ",-1)])]),_:1})]),_:1},8,["disabled"])),[[oa,a(i)("core.backupAndRestore.addToRestoreList"),void 0,{top:!0}]])]),a(Ye).length>0?(d(),C(wa,{key:0,class:"mt-4 overflow-hidden",border:"",rounded:""},{default:e(()=>[t(fa,{items:a(Ye),headers:a(ct),"item-key":"component",density:"compact","hide-default-footer":""},{top:e(()=>[s("div",en,[t(b,{size:"22",class:"mr-1"},{default:e(()=>[...u[59]||(u[59]=[n(" mdi-lifebuoy ",-1)])]),_:1}),s("div",tn,[s("b",null,c(a(i)("core.backupAndRestore.restoreOverview")),1)])]),t(ra)]),"item.timestamp":e(({item:y})=>[s("div",an,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"warning",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[60]||(u[60]=[n(" mdi-archive-clock ",-1)])]),_:1})]),default:e(()=>[s("span",ln,c(y.timestamp),1)]),_:2},1024)])]),"item.component":e(({item:y})=>[s("div",on,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"success",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[61]||(u[61]=[n(" mdi-cube ",-1)])]),_:1})]),default:e(()=>[s("span",sn,c(y.component),1)]),_:2},1024)])]),"item.url":e(({item:y})=>[s("div",nn,[t(Ee,{class:"current-task-chip",variant:"tonal",size:"small",color:"#0091EA",rounded:"pill"},{prepend:e(()=>[t(b,{size:"20",class:"mr-1"},{default:e(()=>[...u[62]||(u[62]=[n(" mdi-link-box-variant ",-1)])]),_:1})]),default:e(()=>[s("span",rn,[s("a",{href:y.url,class:"truncate-text"},c(y.url),9,un)])]),_:2},1024)])]),"item.file_size":e(({item:y})=>[s("span",dn,c(h(y.file_size)),1)]),"item.actions":e(({index:y})=>[s("div",cn,[Ie((d(),C(B,{icon:"",variant:"text",color:"error",size:"small",onClick:V=>R(y,a(Ye))},{default:e(()=>[t(b,null,{default:e(()=>[...u[63]||(u[63]=[n("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[oa,a(i)("core.backupAndRestore.removeRestoreJob"),void 0,{top:!0}]])])]),bottom:e(()=>[t(ra),s("th",pn,[s("div",mn,[t(b,{class:"mr-2"},{default:e(()=>[...u[64]||(u[64]=[n(" mdi-equal-box ",-1)])]),_:1}),s("span",fn,c(h(v(a(Ye)))),1)])])]),_:1},8,["items","headers"])]),_:1})):I("",!0),a(je)?(d(),T("div",vn,[s("h5",gn,[a(je)?(d(),T("span",yn,[t(ia,{indeterminate:"",size:"20",class:"mr-2"}),n(" "+c(he(a(Ve),50)),1)])):I("",!0)])])):I("",!0),a(Ye).length>0?(d(),C(B,{key:2,class:"mt-4",block:"",color:"primary",disabled:!a(ce)||!a(Pe)||a(je),onClick:Je},{default:e(()=>[t(b,{start:"",size:"22"},{default:e(()=>[...u[65]||(u[65]=[n(" mdi-rotate-left ",-1)])]),_:1}),n(" "+c(a(i)("core.backupAndRestore.restore")),1)]),_:1},8,["disabled"])):I("",!0)])):I("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(Va,{modelValue:a(te).model,"onUpdate:modelValue":u[17]||(u[17]=y=>a(te).model=y),timeout:a(te).timeout,color:a(te).color,location:"top",elevation:4,variant:"flat",class:"mb-2"},{default:e(()=>[s("div",bn,[a(te).icon?(d(),C(b,{key:0,icon:a(te).icon,class:"me-2"},null,8,["icon"])):I("",!0),s("span",null,c(a(te).text),1)])]),_:1},8,["modelValue","timeout","color"])],64)}}},wn=aa(hn,[["__scopeId","data-v-c625d9aa"]]),xn={class:"d-flex w-100 align-center justify-space-between border-frame"},kn={class:"d-flex align-center"},_n={class:"text-h5"},$n={class:"ml-2",style:{"font-size":"16px","font-weight":"800"}},Cn={class:"listbox-wrapper"},zn={class:"tiny-label"},Sn={class:"ml-2",style:{"font-size":"16px","font-weight":"800"}},An={class:"listbox-wrapper"},Vn={class:"tiny-label"},Tn={class:"d-flex flex-column align-center justify-center"},Rn={class:"d-flex flex-column align-center justify-center"},In={class:"align-center"},Dn={class:"action-center"},Un={key:0},Ln={class:"mb-2 d-flex align-center"},Bn={key:1},Fn={key:2,class:"mt-4"},En={class:"mb-2 d-flex align-center"},Pn={class:"mt-4"},Mn={class:"mb-2 d-flex align-center"},jn={class:"mt-2"},On={class:"d-flex align-center ml-4"},Nn={class:"action-center"},qn={class:"d-flex align-center justify-center"},Hn={key:0},Wn={class:"mb-2 d-flex align-center"},Jn={key:1},Gn={key:2,class:"mt-4"},Kn={class:"mb-2 d-flex align-center"},Xn={key:3,class:"mt-4"},Zn={class:"mb-2 d-flex align-center"},Yn={class:"d-flex align-center"},Qn={key:4,class:"mt-4"},er={class:"mb-2 d-flex align-center"},tr={class:"mt-2"},ar={class:"d-flex align-center"},lr={__name:"AppControl",props:{appSpec:{type:Object,required:!0},executeLocalCommand:{type:Function,required:!0},instances:{type:Array,default:()=>[]},currentInstanceIp:{type:String,required:!0},logout:{type:Function,required:!0},ipAccess:{type:Boolean,required:!0},isComposeSingle:{type:Boolean,required:!0}},setup(xe){const f=xe,{t:i}=pa(),te=p([]),q=p(""),j=p(""),he=p({show:!1,title:"",name:""}),ge=p({show:!1,title:"",name:""}),ne=p({show:!1,title:"",name:""}),pe=p({}),M=p(null),Q=p(!1),Ue=p(""),F=p({}),ie=p({}),ye=p({show:!1,title:"",name:""}),O=$e(()=>f.instances),le=p(""),N=p(null),H=p(!1),re=p(0),oe=p([]),G=p(!1),Le=p([]),se=p("3"),Te=p({}),L=p(""),qe=p(!1),Oe=p(""),Re=$e(()=>O.value.filter(o=>!oe.value.includes(o)));bt(()=>f.instances,o=>{const l=new Set(o);oe.value.filter(R=>!l.has(R)).forEach(R=>{console.log(`[Removed] IP ${R} no longer exists in available instances list`)}),oe.value=oe.value.filter(R=>l.has(R))},{immediate:!0}),bt(()=>ie,async()=>{await it();const o=N.value?.$el||N.value;o&&(o.scrollTop=o.scrollHeight)},{deep:!0});function He(o){return new Promise(l=>setTimeout(l,o))}function je(o){switch(o){case"success":return"success";case"error":return"error";case"pending":return"warning";case"initial":return"secondary";default:return"default"}}function ht(o){Le.value.includes(o)?Le.value=Le.value.filter(l=>l!==o):Le.value.push(o)}function dt(){Le.value.forEach(o=>{oe.value.includes(o)||oe.value.push(o)}),Le.value=[]}function Ce(){const o=Re.value.filter(l=>!oe.value.includes(l));oe.value.push(...o),Le.value=[]}function at(o){oe.value=oe.value.filter(l=>l!==o)}function ue(){oe.value=[]}const S=$e(()=>{const o=Object.values(pe.value).filter(R=>R?.detail);if(!o.length)return{current:0,total:0};const l=o.reduce((R,z)=>R+z.detail.total,0);return{current:o.reduce((R,z)=>R+z.detail.current,0),total:l}}),w=$e(()=>q.value.trim()?q.value:"Waiting for the operation to be completed..."),h=p({model:!1,text:"",color:"info",icon:"mdi-information",timeout:4e3});let m=null;function x(o,l,v=null,R=4e3){m&&clearTimeout(m),h.value={model:!1,text:l,icon:v||{success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information",danger:"mdi-alert-circle"}[o]||"mdi-information",color:o==="danger"?"error":o,timeout:R},requestAnimationFrame(()=>{h.value.model=!0}),m=setTimeout(()=>{h.value.model=!1},R)}async function A(o,l,v,R=0){te.value=[],j.value="",he.value.show=!0,he.value.title=`${l}...`,he.value.name=`${o}`,R>0&&await new Promise(z=>setTimeout(z,R));try{const z=await f.executeLocalCommand(v),D=z.data?.data?.message||z.data?.data;z.data?.status==="success"?(x("success",D),qt.emit("updateAppStatus"),l==="Removing"&&(qt.emit("updateInstanceList"),re.value+=1)):x("error",D),console.log(z)}catch(z){x("error","Operation failed."),console.error(z)}finally{he.value.show=!1}}const de=o=>A(o,i("core.appControl.operations.stopping"),`/apps/appstop/${o}`,2e3),E=o=>A(o,i("core.appControl.operations.starting"),`/apps/appstart/${o}`,3e3),ce=o=>A(o,i("core.appControl.operations.restarting"),`/apps/apprestart/${o}`,3e3),Pe=o=>A(o,i("core.appControl.operations.pausing"),`/apps/apppause/${o}`,3e3),Je=o=>A(o,i("core.appControl.operations.unpausing"),`/apps/apppause/${o}`,3e3),At=o=>A(o,i("core.appControl.operations.startingMonitoring"),`/apps/startmonitoring/${o}`,3e3),lt=o=>A(o,i("core.appControl.operations.stoppingMonitoring"),`/apps/stopmonitoring/${o}`,3e3),ct=o=>A(o,i("core.appControl.operations.stoppingMonitoringAndDeleting"),`/apps/stopmonitoring/${o}/true`,3e3);async function pt(o,l,v){te.value=[],F.value=[],pe.value={},j.value="",Ue.value="",ge.value.title=`${l}...`,ge.value.name=`${o}`,ge.value.show=!0,Q.value=!1;const R=localStorage.getItem("zelidauth");try{const z={headers:{zelidauth:R},onDownloadProgress(Ne){const st=Ne.event?.target?.response,_t=JSON.parse(`[${st.replace(/\}\{/g,"},{")}]`);te.value=_t;const $=_t.at(-1);j.value=$?.data?.message||$?.data||$?.status}},D=await f.executeLocalCommand(v,null,z),X=typeof D.data=="string"?D.data:JSON.stringify(D.data),P=JSON.parse(`[${X.replace(/\}\{/g,"},{")}]`);te.value=P;const ke=P.at(-1);j.value=ke?.data?.message||ke?.data||ke?.status,Ue.value=ke?.status,l==="Removing"?(qt.emit("updateInstanceList"),refreshLis.value+=1):qt.emit("updateAppStatus")}catch(z){x("error",z.message||z)}}const be=o=>pt(o,i("core.appControl.operations.removing"),`/apps/appremove/${o}`),Ve=o=>pt(o,i("core.appControl.operations.softReinstalling"),`/apps/redeploy/${o}/false`),Ge=o=>pt(o,i("core.appControl.operations.hardReinstalling"),`/apps/redeploy/${o}/true`);bt([te,F],()=>{it(()=>{M.value&&(M.value.scrollTop=M.value.scrollHeight)});const o=[];if(Array.isArray(te.value)&&o.push(...te.value.map(l=>({...l,__source:"output"}))),typeof F.value=="object")for(const[l,v]of Object.entries(F.value))Array.isArray(v)&&o.push(...v.map(R=>({...R,ip:l,__source:"outputs"})));o.forEach(l=>{if(!l?.status||l.__source==="outputs"&&l.ip!==le.value)return;const v=l.status,R=l.progressDetail;(l.status==="Downloading"||l.status==="Extracting")&&(pe.value[v]||(pe.value[v]={id:v,detail:{current:0,total:1},variant:l.status==="Downloading"?"error":"primary"}),R&&R.total>0&&(pe.value[v].detail={current:R.current,total:R.total})),(l.status==="Download complete"||l.status==="Pull complete")&&pe.value[v]&&(pe.value[v].detail={current:1,total:1},pe.value[v].variant="success"),!pe.value[v]&&R&&(pe.value[v]={id:v,detail:{current:1,total:1},variant:"primary"})})},{deep:!0}),bt(le,(o,l)=>{if(l&&o!==l&&Te.value[l]){const v=Te.value[l];v.status==="pending"&&(v.status=v.count>0?"error":"success")}});function Ke(){const o={},l={},v=D=>{let X=0;for(let st=0;st<D.length;st++)X=D.charCodeAt(st)+((X<<5)-X);return`hsl(${Math.abs(X)%360}, 65%, 45%)`},R=[],z=[];if(Array.isArray(te.value)&&te.value.length>0)z.push(["",te.value]);else if(typeof F.value=="object")for(const[D,X]of Object.entries(F.value))Array.isArray(X)&&z.push([D,X]);for(const[D,X]of z){let P=[],ke="General",Ne=null,st=0;Te.value[D]||(Te.value[D]={count:0,status:"initial"}),Te.value[D].status==="initial"&&(Te.value[D].status="pending");const _t=$=>{const u=$||Ne||"General";P.forEach(({text:_,phase:y})=>{R.push({ip:D,component:u,phase:y,text:_}),y==="Error"&&st++}),P=[]};for(const $ of X){const u=$?.data?.message||$?.data||$?.status,_=typeof u=="string"?u:JSON.stringify(u),y=_.toLowerCase(),V=/Flux App (\w[\w-]*)/.exec(_);V&&!_.includes("component")&&(Ne=V[1]);const U=/^Pulling from /i.test(_),W=/Pulling component (\w[\w-]*) of Flux App/.exec(_),fe=/Pulling global Flux App (\w[\w-]*) was successful/i.exec(_),nt=/Creating component (\w[\w-]*) of Flux App/.exec(_),ze=/Starting component (\w[\w-]*) of Flux App/.exec(_),ve=/Creating Flux App (\w[\w-]*)/.exec(_),Me=/Starting Flux App (\w[\w-]*)/.exec(_),zt=/Stopping Flux App (\w[\w-]*)/.exec(_),vt=/(?:Stopping|Removing|Cleaning|Flux App component)\s+(?:Flux App\s+)?component\s+(\w[\w-]*)/i.exec(_);let tt="Finalizing";if(/error|fail|aborting|http code|unauthorized/.test(y)?tt="Error":/warning/.test(y)?tt="Warning":/initial|connecting|checking|allocating|creating|adjusting|searching|mounting|making|ports...|removing|stopping|starting|initiating|denying|unmounting|clearing|cleaning/.test(y)?tt="Setup":/pull|download|digest|waiting|extract|verify|already exists/.test(y)&&(tt="Pulling"),vt){_t(vt[1]),ke=vt[1],R.push({ip:D,component:ke,phase:tt,text:_}),tt==="Error"&&st++;continue}if(U){_t(ke),P.push({text:_,phase:tt});continue}if(W){_t(W[1]),ke=W[1],R.push({ip:D,component:ke,phase:tt,text:_}),tt==="Error"&&st++;continue}if(fe){_t(fe[1]),ke=fe[1],R.push({ip:D,component:ke,phase:tt,text:_}),tt==="Error"&&st++;continue}if(nt||ze){const Bt=(nt||ze)[1];_t(Bt),ke=Bt,R.push({ip:D,component:ke,phase:tt,text:_}),tt==="Error"&&st++;continue}if(ve||Me||zt){const Bt=(ve||Me||zt)[1];Ne=Bt,ke=Bt}R.length===0&&P.length===0?(R.push({ip:D,component:ke,phase:tt,text:_}),tt==="Error"&&st++):P.push({text:_,phase:tt})}_t(ke),Te.value[D].count=st}return R.map(({ip:D,component:X,phase:P,text:ke})=>{o[X]||(o[X]=v(X)),D&&!l[D]&&(l[D]=v(D));const Ne=D?`<span class="tag tag-ip" style="background-color:${l[D]};color:#fff;">${D}</span>`:"",st=`<span class="tag tag-component" style="background-color:${o[X]};color:#fff;">${X}</span>`,_t=`<span class="tag tag-${P.toLowerCase()}">${P}</span>`;return`${Ne}${st}${_t}&nbsp;${ke}`}).join("<br>")}function Rt(){setTimeout(()=>{Te.value={}},3e3)}const Yt=$e(()=>{const o=le.value,l=[];return!o&&Array.isArray(te.value)&&l.push(...te.value),o&&typeof F.value=="object"&&Array.isArray(F.value[o])&&l.push(...F.value[o]),l.some(R=>{const z=R?.data?.message||R?.data||R?.status||"";return/error/i.test(z)})||/error|aborting|http code/i.test(j.value)||/error/i.test(Ue.value)?"error":/success/i.test(Ue.value)?"success":/warning/i.test(Ue.value)?"warning":"grey"});async function Ct({ipList:o,method:l="GET",endpoint:v="",payload:R=null,headers:z={},timeout:D=25e3,useDownloadProgress:X=!1}){F.value={},ie.value={},console.log("[sendRequestsSequentially] Starting with IP list:",o);for(const P of o){le.value=P,pe.value={};const[ke,Ne]=P.split(":"),st=ke?.trim(),_t=Ne?.trim()||"16127";if(!st||!/^\d{1,3}(\.\d{1,3}){3}$/.test(st)){console.error(`[${P}] Invalid IP format. Skipping.`);continue}let $=`https://${st.replace(/\./g,"-")}-${_t}.node.api.runonflux.io${v}`;const u=`http://${st}:${_t}${v}`;f.ipAccess&&($=u),ie.value[P]={status:"pending",message:""},F.value[P]=null;const _={method:l,url:$,headers:z,...R?{data:R}:{},...X?{}:{timeout:D}};X&&(_.onDownloadProgress=y=>{const V=y.event?.target?.response;if(V)try{const U=JSON.parse(`[${V.replace(/\}\{/g,"},{")}]`);F.value[P]=U;const W=U.at(-1);j.value=W?.data?.message||W?.data||W?.status,Ue.value=W?.status,ie.value[P].message=W?.data?.message||W?.data||W?.status,ie.value[P].status=W?.status}catch{}});try{console.log(`[${P}] Sending request to domain URL...`);const y=await da(_),V=typeof y.data=="string"?y.data:JSON.stringify(y.data),W=JSON.parse(`[${V.replace(/\}\{/g,"},{")}]`).at(-1);j.value=W?.data?.message||W?.data||W?.status,Ue.value=W?.status,ie.value[P].message=W?.data?.message||W?.data||W?.status,ie.value[P].status=W?.status}catch(y){console.warn(`[${P}] Domain request failed: ${y?.message||y}. Retrying with fallback...`);try{_.url=u,console.log(`[${P}] Fallback URL:`,u);const V=await da(_),U=typeof V.data=="string"?V.data:JSON.stringify(V.data),fe=JSON.parse(`[${U.replace(/\}\{/g,"},{")}]`).at(-1);j.value=fe?.data?.message||fe?.data||fe?.status,Ue.value=fe?.status,ie.value[P].message=fe?.data?.message||fe?.data||fe?.status,ie.value[P].status=fe?.status}catch(V){console.error(`[${P}] Fallback request failed:`,V?.message),ie.value[P].status="error",ie.value[P].message=`Requests failed: ${V?.message} - check node accessibility.`,Array.isArray(F.value[P])||(F.value[P]=[]),F.value[P].push({data:{message:`Requests failed: ${V?.message} - check node accessibility.`},status:"error"}),Te.value[P]||(Te.value[P]={count:1,status:"error"}),j.value=`Requests failed: ${V?.message} - check node accessibility.`}}await it(),console.log(`[${P}] Finished processing.`)}pe.value={},le.value="",console.log("[sendRequestsSequentially] All IPs processed.")}const Be=async(o,l,v,R,z=!1)=>{if(R.length===0){x("warning","You must choose one or more nodes to proceed.");return}pe.value={},te.value=[],j.value="",Ue.value="",Q.value=!1,G.value=!1,F.value={},ie.value={},le.value="",z?(ne.value.title=`${l}...`,ne.value.name=`${o}`,ne.value.show=!0):(ye.value.title=`${l}...`,ye.value.name=`${o}`,ye.value.show=!0);const D=localStorage.getItem("zelidauth");await Ct({ipList:R,method:"GET",endpoint:`${v}`,headers:{zelidauth:D},useDownloadProgress:z}),G.value=!0,v.includes("appremove")&&R.includes(f.currentInstanceIp)?qt.emit("updateInstanceList"):R.includes(f.currentInstanceIp)&&qt.emit("updateAppStatus")},Mt=async(o,l)=>await Be(o,i("core.appControl.operations.starting"),`/apps/apprestart/${o}`,l),Ye=async(o,l)=>await Be(o,i("core.appControl.operations.stopping"),`/apps/appstop/${o}`,l),Qe=async(o,l)=>await Be(o,i("core.appControl.operations.restarting"),`/apps/apprestart/${o}`,l),It=async(o,l)=>await Be(o,i("core.appControl.operations.pausing"),`/apps/apppause/${o}`,l),Ut=async(o,l)=>await Be(o,i("core.appControl.operations.unpausing"),`/apps/appunpause/${o}`,l),Et=async(o,l)=>await Be(o,i("core.appControl.operations.removing"),`/apps/appremove/${o}`,l,!0),ma=async(o,l)=>await Be(o,i("core.appControl.operations.softReinstalling"),`/apps/redeploy/${o}/false`,l,!0),Qt=async(o,l)=>await Be(o,i("core.appControl.operations.hardReinstalling"),`/apps/redeploy/${o}/true`,l,!0),Vt=async(o,l)=>await Be(o,i("core.appControl.operations.startingMonitoring"),`/apps/startmonitoring/${o}`,l),xt=async(o,l)=>await Be(o,i("core.appControl.operations.stoppingMonitoring"),`/apps/stopmonitoring/${o}`,l),Kt=async(o,l)=>await Be(o,i("core.appControl.operations.stoppingMonitoringAndDeleting"),`/apps/stopmonitoring/${o}/true`,l),We=async(o,l,v,R)=>{try{const D={headers:{zelidauth:localStorage.getItem("zelidauth")}};if(await Lt(),!L.value)return;x("warning",v),await He(3e3);let X=`/apps/${l}/${o}`;R&&(X+=`/${R}`),X+="/true";const P=await Ca.justAPI().get(X,D);await He(500),P.data.status==="success"?x("success",P.data.data.message||P.data.data):x("danger",P.data.data.message||P.data.data)}catch(z){x("danger",z.message||z)}},kt=async o=>{We(o,"appstop",`Stopping ${o} globally. This will take a while...`)},jt=async o=>{We(o,"appstart",`Starting ${o} globally. This will take a while...`)},sa=async o=>{We(o,"apprestart",`Restarting ${o} globally. This will take a while...`)},ya=async o=>{We(o,"apppause",`Pausing ${o} globally. This will take a while...`)},mt=async o=>{We(o,"appunpause",`Unpausing ${o} globally. This will take a while...`)},Pt=async o=>{We(o,"redeploy",`Soft redeploying ${o} globally. This will take a while...`,"false"),H.value=!0},ot=async o=>{We(o,"redeploy",`Hard redeploying ${o} globally. This will take a while...`,"true"),H.value=!0},ft=async o=>{We(o,"appremove",`Reinstalling ${o} globally. This will take a while...`,"true"),H.value=!0},Fe=async(o,l=null)=>{let v=f.appSpec.name;l!==null&&(v=`${f.appSpec.compose[l].name}_${f.appSpec.name}`,console.log(v));const R=se.value;if(Lt(),!!L.value){if(!v){x("warning","App name is missing.");return}if(R==="1"){if(!oe.value?.length){x("warning","Select one or more nodes to proceed.");return}switch(o){case"start":await Mt(v,oe.value);break;case"stop":await Ye(v,oe.value);break;case"restart":await Qe(v,oe.value);break;case"pause":await It(v,oe.value);break;case"unpause":await Ut(v,oe.value);break;case"remove":await Et(v,oe.value);break;case"reinstall-soft":await ma(v,oe.value);break;case"reinstall-hard":await Qt(v,oe.value);break;case"start-monitoring":await Vt(v,oe.value);break;case"stop-monitoring":await xt(v,oe.value);break;case"stop-and-del-monitoring":await Kt(v,oe.value);break;default:x("warning","Invalid multi-app operation selected.")}}else if(R==="2"||R==="3")switch(o){case"start":await E(v);break;case"stop":await de(v);break;case"restart":await ce(v);break;case"pause":await Pe(v);break;case"unpause":await Je(v);break;case"remove":await be(v);break;case"reinstall-soft":await Ve(v);break;case"reinstall-hard":await Ge(v);break;case"start-monitoring":await At(v);break;case"stop-monitoring":await lt(v);break;case"stop-and-del-monitoring":await ct(v);break;default:x("warning","Invalid multi-app operation selected.")}else if(R==="4")switch(o){case"start":await jt(v);break;case"stop":await kt(v);break;case"restart":await sa(v);break;case"pause":await ya(v);break;case"unpause":await mt(v);break;case"remove":await ft(v);break;case"reinstall-soft":await Pt(v);break;case"reinstall-hard":await ot(v);break;default:x("warning","Invalid multi-app operation selected.")}else x("warning","Invalid mode selected.")}};async function Lt(){const o=localStorage.getItem("zelidauth"),l=nl.parse(o||""),v=Date.now(),R=1.5*60*60*1e3,z=l?.loginPhrase?.substring(0,13)||0,D=+z+R;+z>0&&v<D?L.value=!0:(L.value=!1,await He(1e3),await f.logout())}async function la(){if(!qe.value){qe.value=!0;try{qt.emit("updateInstanceList"),re.value+=1,await it()}finally{setTimeout(()=>{qe.value=!1},5e3)}}}function k(o){return o?o.version>=4?o.compose:[{...o,repoauth:!1}]:[]}return(o,l)=>{const v=tl,R=sl("sanitize-html");return d(),T(De,null,[t(et,{class:"align-center justify-space-between mb-1"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center pb-0"},{default:e(()=>[s("div",xn,[s("div",kn,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...l[24]||(l[24]=[n(" mdi-controller ",-1)])]),_:1})]),_:1}),s("span",_n,c(a(i)("core.appControl.title")),1)])])]),_:1})]),_:1}),t(al,{modelValue:a(se),"onUpdate:modelValue":l[0]||(l[0]=z=>gt(se)?se.value=z:null),inline:""},{default:e(()=>[t(xa,{label:a(i)("core.appControl.manual"),value:"1"},null,8,["label"]),f.isComposeSingle?I("",!0):(d(),C(xa,{key:0,label:a(i)("core.appControl.component"),value:"2"},null,8,["label"])),t(xa,{label:a(i)("core.appControl.local"),value:"3"},null,8,["label"]),t(xa,{label:a(i)("core.appControl.global"),value:"4"},null,8,["label"])]),_:1},8,["modelValue"]),a(se)==="1"?(d(),C(rt,{key:0,class:"card-height-2 mx-1 mt-1 mb-6"},{default:e(()=>[t(Ht,{class:"mb-4 bg-primary"},{default:e(()=>[t(Nt,{size:"34",variant:"tonal",color:"lighten-4",class:"mr-1"},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[25]||(l[25]=[n(" mdi-selection-marker ",-1)])]),_:1})]),_:1}),n(" "+c(a(i)("core.appControl.manualSelection")),1)]),_:1}),t(Dt,null,{default:e(()=>[t(et,null,{default:e(()=>[t(me,{cols:"12",md:"5"},{default:e(()=>[s("div",$n,c(a(i)("core.appControl.available")),1),s("div",Cn,[(d(),C(Wa,{key:a(re),class:"listbox",density:"compact"},{default:e(()=>[(d(!0),T(De,null,ut(a(Re),z=>(d(),C(La,{key:z,value:z,onClick:D=>ht(z)},{prepend:e(()=>[t(_l,{"model-value":a(Le).includes(z),density:"compact",ripple:!1,class:"tiny-checkbox","onUpdate:modelValue":D=>ht(z)},null,8,["model-value","onUpdate:modelValue"])]),default:e(()=>[s("span",zn,c(z),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}))])]),_:1}),t(me,{cols:"12",md:"2",class:"d-flex flex-md-column flex-row align-center justify-center my-2",style:{gap:"8px"}},{default:e(()=>[t(Ze,{location:"top",text:a(i)("core.appControl.tooltips.addSelected")},{activator:e(({props:z})=>[t(B,wt(z,{icon:"",variant:"text",color:"default",disabled:a(Le).length===0,onClick:dt}),{default:e(()=>[t(b,null,{default:e(()=>[...l[26]||(l[26]=[n("mdi-plus-box",-1)])]),_:1})]),_:1},16,["disabled"])]),_:1},8,["text"]),t(Ze,{location:"top",text:a(i)("core.appControl.tooltips.addAll")},{activator:e(({props:z})=>[t(B,wt(z,{icon:"",variant:"text",color:"success",disabled:a(Re).length===0,onClick:Ce}),{default:e(()=>[t(b,null,{default:e(()=>[...l[27]||(l[27]=[n("mdi-plus-box-multiple",-1)])]),_:1})]),_:1},16,["disabled"])]),_:1},8,["text"]),t(Ze,{location:"top",text:a(i)("core.appControl.tooltips.removeSelected")},{activator:e(({props:z})=>[t(B,wt(z,{icon:"",variant:"text",color:"error",disabled:a(oe).length===0,onClick:ue}),{default:e(()=>[t(b,null,{default:e(()=>[...l[28]||(l[28]=[n("mdi-delete-sweep",-1)])]),_:1})]),_:1},16,["disabled"])]),_:1},8,["text"]),t(Ze,{location:"top",text:a(i)("core.appControl.tooltips.refreshAvailable")},{activator:e(({props:z})=>[t(B,wt(z,{icon:"",variant:"text",color:"success",disabled:a(qe),onClick:la}),{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[29]||(l[29]=[n(" mdi-refresh-circle ",-1)])]),_:1})]),_:1},16,["disabled"])]),_:1},8,["text"])]),_:1}),t(me,{cols:"12",md:"5"},{default:e(()=>[s("div",Sn,c(a(i)("core.appControl.selected")),1),s("div",An,[t(Wa,{class:"listbox",density:"compact"},{default:e(()=>[(d(!0),T(De,null,ut(a(oe),z=>(d(),C(La,{key:z,value:z},{append:e(()=>[t(B,{icon:"mdi-trash-can",size:"small",color:"error",variant:"text",density:"compact",onClick:D=>at(z)},null,8,["onClick"])]),default:e(()=>[s("span",Vn,c(z),1)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})):I("",!0),a(se)==="2"?(d(),C(Sa,{key:1,modelValue:a(Oe),"onUpdate:modelValue":l[1]||(l[1]=z=>gt(Oe)?Oe.value=z:null),"align-tabs":"start","background-color":"transparent",color:"primary","hide-slider":"",density:"comfortable",class:"v-tabs-pill",style:{"margin-top":"1px"}},{default:e(()=>[(d(!0),T(De,null,ut(k(f.appSpec),(z,D)=>(d(),C(_a,{key:D,value:D,class:"v-tabs-pill text-no-transform"},{default:e(()=>[t(b,{size:"18",class:"mr-1"},{default:e(()=>[...l[30]||(l[30]=[n(" mdi-cube ",-1)])]),_:1}),n(" "+c(z.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):I("",!0),a(se)==="2"?(d(),C(Ua,{key:2,modelValue:a(Oe),"onUpdate:modelValue":l[2]||(l[2]=z=>gt(Oe)?Oe.value=z:null),class:"pa-4",touch:!1},{default:e(()=>[(d(!0),T(De,null,ut(k(f.appSpec),(z,D)=>(d(),C(Aa,{key:D,value:D},{default:e(()=>[t(ll,{mode:"out-in"},{default:e(()=>[t(et,{class:"pa-1"},{default:e(()=>[t(me,{xs:"12",md:a(se)==="4"?12:6,sm:"12",class:"d-flex flex-wrap justify-start"},{default:e(()=>[t(rt,{class:"card-height",style:{width:"100%"}},{default:e(()=>[t(Ht,{class:"mb-8 bg-primary d-flex justify-space-between align-center"},{default:e(()=>[s("div",null,[t(Nt,{size:"34",color:"lighten-4",variant:"tonal",class:"mr-1"},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[31]||(l[31]=[n(" mdi-gamepad-down ",-1)])]),_:1})]),_:1}),n(" "+c(a(i)("core.appControl.control")),1)]),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(z.name),1)]),_:2},1024)]),_:2},1024),t(Dt,{class:"text-center"},{default:e(()=>[t(et,{class:"d-flex flex-wrap justify-center"},{default:e(()=>[t(me,{class:"d-flex justify-center",cols:"6",sm:"6",md:"6",lg:"6"},{default:e(()=>[Ie((d(),C(B,{id:`start-app-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[32]||(l[32]=[n(" mdi-play-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.startComponent")),1)]),_:1},8,["id","style"])),[[Tt]]),t(v,{target:"start-app","confirm-button":a(i)("core.appControl.confirmButtons.startComponent"),onConfirm:X=>Fe("start",D)},null,8,["confirm-button","onConfirm"])]),_:2},1024),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:`stop-app-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[33]||(l[33]=[n(" mdi-stop-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopComponent")),1)]),_:1},8,["id","style"])),[[Tt]]),t(v,{target:`stop-app-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.stopComponent"),onConfirm:X=>Fe("stop",D)},null,8,["target","confirm-button","onConfirm"])]),_:2},1024),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:`restart-app-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[34]||(l[34]=[n(" mdi-restart ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.restartComponent")),1)]),_:1},8,["id","style"])),[[Tt]]),t(v,{target:`restart-app-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.restartComponent"),onConfirm:X=>Fe("restart",D)},null,8,["target","confirm-button","onConfirm"])]),_:2},1024),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:`pause-app-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[35]||(l[35]=[n(" mdi-pause-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.pauseComponent")),1)]),_:1},8,["id","style"])),[[Tt]]),t(v,{target:`pause-app-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.pauseComponent"),onConfirm:X=>Fe("pause",D)},null,8,["target","confirm-button","onConfirm"])]),_:2},1024),t(me,{class:"d-flex justify-center",cols:"12"},{default:e(()=>[Ie((d(),C(B,{id:`unpause-app-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[36]||(l[36]=[n(" mdi-motion-play-outline ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.unpauseComponent")),1)]),_:1},8,["id","style"])),[[Tt]]),t(v,{target:`unpause-app-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.unpauseComponent"),onConfirm:X=>Fe("unpause",D)},null,8,["target","confirm-button","onConfirm"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["md"]),a(se)!=="4"?(d(),C(me,{key:0,xs:"12",md:"6",sm:"12",class:"d-flex flex-wrap justify-start"},{default:e(()=>[t(rt,{class:"card-height",style:{width:"100%"}},{default:e(()=>[t(Ht,{class:"mb-8 bg-primary d-flex justify-space-between align-center"},{default:e(()=>[s("div",null,[t(Nt,{size:"34",color:"lighten-4",variant:"tonal",class:"mr-1"},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[37]||(l[37]=[n(" mdi-cctv ",-1)])]),_:1})]),_:1}),n(" "+c(a(i)("core.appControl.monitoring")),1)]),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(z.name),1)]),_:2},1024)]),_:2},1024),t(Dt,{class:"text-center"},{default:e(()=>[s("div",Tn,[Ie((d(),C(B,{id:`start-monitoring-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[38]||(l[38]=[n(" mdi-play-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.startMonitoring")),1)]),_:1},8,["id"])),[[Tt]]),t(v,{target:`start-monitoring-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.startMonitoring"),onConfirm:X=>Fe("start-monitoring",D)},null,8,["target","confirm-button","onConfirm"]),Ie((d(),C(B,{id:`stop-monitoring-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-6 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[39]||(l[39]=[n(" mdi-stop-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopMonitoring")),1)]),_:1},8,["id"])),[[Tt]]),t(v,{target:`stop-monitoring-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.stopMonitoring"),onConfirm:X=>Fe("stop-monitoring",D)},null,8,["target","confirm-button","onConfirm"]),Ie((d(),C(B,{id:`stop-monitoring-delete-${D}`,variant:"outlined",color:"dark",class:"mx-1 my-1 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[40]||(l[40]=[n(" mdi-trash-can ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopMonitoringDelete")),1)]),_:1},8,["id"])),[[Tt]]),t(v,{target:`stop-monitoring-delete-${D}`,"confirm-button":a(i)("core.appControl.confirmButtons.stopMonitoringDelete"),onConfirm:X=>Fe("stop-and-del-monitoring",D)},null,8,["target","confirm-button","onConfirm"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):I("",!0),a(se)!=="2"?(d(),C(et,{key:3,class:"pa-1"},{default:e(()=>[t(me,{xs:"12",md:a(se)==="4"?12:6,sm:"12",class:"d-flex flex-wrap justify-start"},{default:e(()=>[t(rt,{class:"card-height",style:{width:"100%"}},{default:e(()=>[t(Ht,{class:"mb-8 bg-primary"},{default:e(()=>[t(Nt,{size:"34",variant:"tonal",color:"lighten-4",class:"mr-1"},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[41]||(l[41]=[n(" mdi-gamepad-down ",-1)])]),_:1})]),_:1}),n(" "+c(a(i)("core.appControl.control")),1)]),_:1}),t(Dt,{class:"text-center"},{default:e(()=>[t(et,{class:"d-flex flex-wrap justify-center"},{default:e(()=>[t(me,{class:"d-flex justify-center",cols:"6",sm:"6",md:"6",lg:"6"},{default:e(()=>[Ie((d(),C(B,{id:"start-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[42]||(l[42]=[n(" mdi-play-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.startApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"start-app","confirm-button":a(i)("core.appControl.confirmButtons.startApplication"),onConfirm:l[3]||(l[3]=z=>Fe("start"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"stop-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[43]||(l[43]=[n(" mdi-stop-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"stop-app","confirm-button":a(i)("core.appControl.confirmButtons.stopApplication"),onConfirm:l[4]||(l[4]=z=>Fe("stop"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"restart-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[44]||(l[44]=[n(" mdi-restart ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.restartApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"restart-app","confirm-button":a(i)("core.appControl.confirmButtons.restartApplication"),onConfirm:l[5]||(l[5]=z=>Fe("restart"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"pause-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[45]||(l[45]=[n(" mdi-pause-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.pauseApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"pause-app","confirm-button":a(i)("core.appControl.confirmButtons.pauseApplication"),onConfirm:l[6]||(l[6]=z=>Fe("pause"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"unpause-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[46]||(l[46]=[n(" mdi-motion-play-outline ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.unpauseApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"unpause-app","confirm-button":a(i)("core.appControl.confirmButtons.unpauseApplication"),onConfirm:l[7]||(l[7]=z=>Fe("unpause"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"remove-app",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[47]||(l[47]=[n(" mdi-trash-can ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.removeApplication")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"remove-app","confirm-button":a(i)("core.appControl.confirmButtons.removeApplication"),onConfirm:l[8]||(l[8]=z=>Fe("remove"))},null,8,["confirm-button"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"redeploy-app-soft",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-1"},{default:e(()=>[...l[48]||(l[48]=[n(" mdi-backup-restore ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.softReinstall")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"redeploy-app-soft","confirm-button":a(i)("core.appControl.confirmButtons.softReinstall"),message:a(i)("core.appControl.confirmMessages.softReinstall"),"alert-type":"info",onConfirm:l[9]||(l[9]=z=>Fe("reinstall-soft"))},null,8,["confirm-button","message"])]),_:1}),t(me,{class:"d-flex justify-center",cols:"6"},{default:e(()=>[Ie((d(),C(B,{id:"redeploy-app-hard",variant:"outlined",color:"dark",class:"mx-1 my-1",style:Ft([{width:"100%","font-size":"13px"},a(se)==="4"?"min-width: 180px; max-width: 500px":"width: 100%"])},{default:e(()=>[t(b,{left:"",size:"22",class:"mr-1"},{default:e(()=>[...l[49]||(l[49]=[n(" mdi-delete-restore ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.hardReinstall")),1)]),_:1},8,["style"])),[[Tt]]),t(v,{target:"redeploy-app-hard","confirm-button":a(i)("core.appControl.confirmButtons.hardReinstall"),message:a(i)("core.appControl.confirmMessages.hardReinstall"),"alert-type":"warning",onConfirm:l[10]||(l[10]=z=>Fe("reinstall-hard"))},null,8,["confirm-button","message"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["md"]),a(se)!=="4"?(d(),C(me,{key:0,xs:"12",md:"6",sm:"12",class:"d-flex flex-wrap justify-start"},{default:e(()=>[t(rt,{class:"card-height",style:{width:"100%"}},{default:e(()=>[t(Ht,{class:"mb-8 bg-primary"},{default:e(()=>[t(Nt,{size:"34",color:"lighten-4",variant:"tonal",class:"mr-1"},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...l[50]||(l[50]=[n(" mdi-cctv ",-1)])]),_:1})]),_:1}),n(" "+c(a(i)("core.appControl.monitoring")),1)]),_:1}),t(Dt,{class:"text-center"},{default:e(()=>[s("div",Rn,[Ie((d(),C(B,{id:"start-monitoring",variant:"outlined",color:"dark",class:"mx-1 my-1 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[51]||(l[51]=[n(" mdi-play-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.startMonitoring")),1)]),_:1})),[[Tt]]),t(v,{target:"start-monitoring","confirm-button":a(i)("core.appControl.confirmButtons.startMonitoring"),onConfirm:l[11]||(l[11]=z=>Fe("start-monitoring"))},null,8,["confirm-button"]),Ie((d(),C(B,{id:"stop-monitoring",variant:"outlined",color:"dark",class:"mx-1 my-6 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[52]||(l[52]=[n(" mdi-stop-circle ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopMonitoring")),1)]),_:1})),[[Tt]]),t(v,{target:"stop-monitoring","confirm-button":a(i)("core.appControl.confirmButtons.stopMonitoring"),onConfirm:l[12]||(l[12]=z=>Fe("stop-monitoring"))},null,8,["confirm-button"]),Ie((d(),C(B,{id:"stop-monitoring-delete",variant:"outlined",color:"dark",class:"mx-1 my-1 d-block",style:{width:"50%","font-size":"13px"}},{default:e(()=>[t(b,{left:"",size:"20",class:"mr-2"},{default:e(()=>[...l[53]||(l[53]=[n(" mdi-trash-can ",-1)])]),_:1}),n(" "+c(a(i)("core.appControl.buttons.stopMonitoringDelete")),1)]),_:1})),[[Tt]]),t(v,{target:"stop-monitoring-delete","confirm-button":a(i)("core.appControl.confirmButtons.stopMonitoringDelete"),onConfirm:l[13]||(l[13]=z=>Fe("stop-and-del-monitoring"))},null,8,["confirm-button"])])]),_:1})]),_:1})]),_:1})):I("",!0)]),_:1})):I("",!0),t(ua,{modelValue:a(he).show,"onUpdate:modelValue":l[14]||(l[14]=z=>a(he).show=z),persistent:"",width:"500"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary dialog-title d-flex justify-space-between align-center"},{default:e(()=>[n(c(a(he).title)+" ",1),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(a(he).name),1)]),_:1})]),_:1}),t(Dt,{class:"d-flex flex-column align-center justify-center",style:{"min-height":"100px"}},{default:e(()=>[s("div",In,[t(ta,{type:"info",variant:"outlined",class:"text-center text-caption font-weight-bold px-4 py-2",style:{"border-radius":"12px","max-width":"100%"}},{default:e(()=>[n(c(a(w)),1)]),_:1}),t(Wt,{indeterminate:"",color:"info",class:"mt-2"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(ge).show,"onUpdate:modelValue":l[17]||(l[17]=z=>a(ge).show=z),"max-width":"900",persistent:""},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary dialog-title d-flex justify-space-between align-center"},{default:e(()=>[n(c(a(ge).title)+" ",1),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(a(ge).name),1)]),_:1})]),_:1}),t(Dt,null,{default:e(()=>[s("div",Dn,[a(j)?(d(),T("div",Un,[s("h3",Ln,[t(b,{icon:"mdi-progress-tag",class:"mr-1"}),l[54]||(l[54]=n(" Current Task: ",-1))]),t(Ee,{class:"current-task-chip",color:a(Yt),variant:"tonal",rounded:"pill"},{prepend:e(()=>[t(b,{size:"24",class:"mr-1"},{default:e(()=>[...l[55]||(l[55]=[n(" mdi-progress-wrench ",-1)])]),_:1})]),default:e(()=>[n(" "+c(a(j)),1)]),_:1},8,["color"])])):(d(),T("div",Bn,[t(Wt,{indeterminate:"",color:"primary"})])),a(S).total>0?(d(),T("div",Fn,[s("h3",En,[t(b,{icon:"mdi-progress-download",class:"mr-1"}),l[56]||(l[56]=n(" Overall Progress ",-1))]),t(Wt,{"model-value":a(S).current/a(S).total*100,height:"16",color:"success",rounded:""},null,8,["model-value"])])):I("",!0),Ie(s("div",Pn,[s("h3",Mn,[t(b,{icon:"mdi-text-box-outline",class:"mr-1"}),l[57]||(l[57]=n(" Full Logs ",-1))]),t(B,{size:"small",variant:"text",color:"grey",onClick:l[15]||(l[15]=z=>Q.value=!a(Q))},{default:e(()=>[t(b,{icon:a(Q)?"mdi-eye-off":"mdi-eye",start:"",class:"mr-1"},null,8,["icon"]),n(" "+c(a(Q)?a(i)("core.appControl.hideLogs"):a(i)("core.appControl.showLogs")),1)]),_:1}),t(Xa,null,{default:e(()=>[Ie(s("div",jn,[s("div",{ref_key:"logContainer",ref:M,class:"log-output log-html"},[Ie(s("div",null,null,512),[[R,Ke()]])],512)],512),[[za,a(Q)]])]),_:1})],512),[[za,a(te).length>1]])])]),_:1}),a(j)?(d(),C(ka,{key:0,class:"justify-end px-7"},{default:e(()=>[t(B,{color:"error",size:"small",variant:"flat",onClick:l[16]||(l[16]=()=>{a(ge).show=!1,a(qt).emit("updateInstalledApp")})},{default:e(()=>[...l[58]||(l[58]=[n(" Close ",-1)])]),_:1})]),_:1})):I("",!0)]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(ye).show,"onUpdate:modelValue":l[19]||(l[19]=z=>a(ye).show=z),persistent:"",width:"600"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary dialog-title d-flex justify-space-between align-center"},{default:e(()=>[n(c(a(ye).title)+" ",1),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(a(ye).name),1)]),_:1})]),_:1}),t(Dt,{class:"d-flex flex-column align-center justify-center pt-4 pb-2"},{default:e(()=>[a(G)?I("",!0):(d(),C(ta,{key:0,type:"info",variant:"outlined",class:"text-caption font-weight-bold mb-4",style:{"border-radius":"12px",width:"400px"}},{default:e(()=>[n(c(a(w)),1)]),_:1})),a(G)?(d(),C(ta,{key:1,type:"success",variant:"outlined",class:"text-caption font-weight-bold mb-4",style:{"border-radius":"12px",width:"400px"}},{default:e(()=>[...l[59]||(l[59]=[n(" Great! The operation is complete. ",-1)])]),_:1})):I("",!0),t(a(Qa),{ref_key:"scrollRef",ref:N,style:{"max-height":"100px","overflow-x":"hidden","overflow-y":"auto"},class:"d-flex flex-column align-center w-75"},{default:e(()=>[(d(!0),T(De,null,ut(a(ie),(z,D)=>(d(),T("div",{key:D,class:"d-flex justify-space-between align-center text-body-2",style:{width:"100%",padding:"3px 0"}},[s("div",On,[t(b,{size:"18",class:"mr-2"},{default:e(()=>[...l[60]||(l[60]=[n(" mdi-laptop ",-1)])]),_:1}),n(" "+c(D),1)]),z.message?(d(),C(Ze,{key:0,location:"top"},{activator:e(({props:X})=>[t(Ee,wt({ref_for:!0},X,{color:je(z.status),size:"x-small",variant:"tonal",class:"ml-2 mr-4",style:{width:"70px"}}),{default:e(()=>[n(c(z.status),1)]),_:2},1040,["color"])]),default:e(()=>[s("span",null,c(z.message),1)]),_:2},1024)):(d(),C(Ee,{key:1,color:je(z.status),size:"x-small",variant:"tonal",class:"ml-2 mr-4",style:{width:"70px"}},{default:e(()=>[n(c(z.status),1)]),_:2},1032,["color"]))]))),128))]),_:1},512)]),_:1}),t(ka,{class:"justify-end px-6 pb-4"},{default:e(()=>[t(B,{color:"error",variant:"flat",size:"small",disabled:a(G)===!1,onClick:l[18]||(l[18]=()=>{a(ye).show=!1,Rt(),a(qt).emit("updateInstalledApp")})},{default:e(()=>[...l[61]||(l[61]=[n(" Close ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(ne).show,"onUpdate:modelValue":l[22]||(l[22]=z=>a(ne).show=z),"max-width":"900",persistent:""},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary dialog-title d-flex justify-space-between align-center"},{default:e(()=>[n(c(a(ne).title)+" ",1),t(Ee,{size:"small",variant:"flat",color:"info",class:"ml-2 mr-4",rounded:"pill"},{default:e(()=>[n(c(a(ne).name),1)]),_:1})]),_:1}),t(Dt,null,{default:e(()=>[s("div",Nn,[s("div",qn,[a(G)?(d(),C(ta,{key:0,type:"success",variant:"outlined",class:"text-caption font-weight-bold mb-4",style:{"border-radius":"12px",width:"400px"}},{default:e(()=>[...l[62]||(l[62]=[n(" Great! The operation is complete. ",-1)])]),_:1})):I("",!0)]),a(j)?(d(),T("div",Hn,[s("h3",Wn,[t(b,{icon:"mdi-progress-tag",class:"mr-1"}),l[63]||(l[63]=n(" Current Task: ",-1))]),t(Ee,{class:"current-task-chip",color:a(Yt),variant:"tonal",rounded:"pill"},{prepend:e(()=>[t(b,{size:"24",class:"mr-1"},{default:e(()=>[...l[64]||(l[64]=[n(" mdi-progress-wrench ",-1)])]),_:1})]),default:e(()=>[n(" "+c(a(j)),1)]),_:1},8,["color"])])):(d(),T("div",Jn,[t(Wt,{indeterminate:"",color:"primary"})])),a(S).total>0?(d(),T("div",Gn,[s("h3",Kn,[t(b,{icon:"mdi-progress-download",class:"mr-1"}),l[65]||(l[65]=n(" Overall Progress ",-1))]),t(Wt,{"model-value":a(S).current/a(S).total*100,height:"16",color:"success",rounded:""},null,8,["model-value"])])):I("",!0),Object.keys(a(Te)).length>0?(d(),T("div",Xn,[s("h3",Zn,[t(b,{icon:"mdi-lan-connect",class:"mr-1"}),l[66]||(l[66]=n(" Node Status ",-1))]),t(a(Qa),{ref_key:"scrollRef",ref:N,style:{"max-height":"80px","overflow-x":"hidden","overflow-y":"auto"},class:"d-flex flex-column align-center w-100"},{default:e(()=>[(d(!0),T(De,null,ut(a(Te),(z,D)=>(d(),T("div",{key:D,class:"d-flex justify-space-between align-center text-body-2",style:{width:"100%",padding:"4px 12px"}},[s("div",Yn,[t(b,{size:"18",class:"mr-2"},{default:e(()=>[...l[67]||(l[67]=[n(" mdi-laptop ",-1)])]),_:1}),n(" "+c(D),1)]),t(Ze,{location:"top"},{activator:e(({props:X})=>[t(Ee,wt({ref_for:!0},X,{color:je(z.status),size:"x-small",variant:"tonal",class:"ml-2 mr-4",style:{width:"80px"}}),{default:e(()=>[n(c(z.status)+" ",1),z.count>0?(d(),T(De,{key:0},[n(" ("+c(z.count)+") ",1)],64)):I("",!0)]),_:2},1040,["color"])]),default:e(()=>[s("span",null,c(a(ie)[D]?.message||"waiting for response..."),1)]),_:2},1024)]))),128))]),_:1},512)])):I("",!0),Object.keys(a(F)).some(z=>a(F)[z])?(d(),T("div",Qn,[s("h3",er,[t(b,{icon:"mdi-text-box-outline",class:"mr-1"}),l[68]||(l[68]=n(" Full Logs ",-1))]),t(B,{size:"small",variant:"text",color:"grey",onClick:l[20]||(l[20]=z=>Q.value=!a(Q))},{default:e(()=>[t(b,{icon:a(Q)?"mdi-eye-off":"mdi-eye",start:"",class:"mr-1"},null,8,["icon"]),n(" "+c(a(Q)?a(i)("core.appControl.hideLogs"):a(i)("core.appControl.showLogs")),1)]),_:1}),t(Xa,null,{default:e(()=>[Ie(s("div",tr,[s("div",{ref_key:"logContainer",ref:M,class:"log-output log-html"},[Ie(s("div",null,null,512),[[R,Ke()]])],512)],512),[[za,a(Q)]])]),_:1})])):I("",!0)])]),_:1}),a(j)?(d(),C(ka,{key:0,class:"justify-end px-7"},{default:e(()=>[t(B,{color:"error",size:"small",variant:"flat",onClick:l[21]||(l[21]=()=>{a(ne).show=!1,Rt(),a(qt).emit("updateInstalledApp")})},{default:e(()=>[...l[69]||(l[69]=[n(" Close ",-1)])]),_:1})]),_:1})):I("",!0)]),_:1})]),_:1},8,["modelValue"]),t(Va,{modelValue:a(h).model,"onUpdate:modelValue":l[23]||(l[23]=z=>a(h).model=z),timeout:a(h).timeout,color:a(h).color,location:"top",elevation:4,variant:"flat",class:"mb-2"},{default:e(()=>[s("div",ar,[a(h).icon?(d(),C(b,{key:0,icon:a(h).icon,class:"me-2"},null,8,["icon"])):I("",!0),s("span",null,c(a(h).text),1)])]),_:1},8,["modelValue","timeout","color"])],64)}}},or=aa(lr,[["__scopeId","data-v-95ea3114"]]),sr={class:"upload-footer"},nr={class:"d-flex align-center justify-space-between"},rr={class:"file-name text-truncate"},ir={__name:"FileUpload",props:{uploadFolder:{type:String,required:!0},headers:{type:Object,required:!0}},setup(xe){const f=xe,{t:i}=pa(),te=Ba([]),q=p(null),j=p(!1),he=p(""),ge=p("success"),ne=(N,H="success")=>{he.value=N,ge.value=H,j.value=!0},pe=$e(()=>te.length>0&&te.some(N=>!N.uploading&&!N.uploaded&&N.progress===0)),M=(N,H="auto",re=2)=>{const oe={B:1,KB:1024,MB:1048576,GB:1073741824};let G="B",Le=N;if(H==="auto")for(const se of["GB","MB","KB","B"]){const Te=N/oe[se];if(Te>=1){G=se,Le=Te;break}}else G=H,Le=N/oe[H];return`${Le.toFixed(re)} ${G}`},Q=()=>{q.value.click()},Ue=N=>{const H=Array.from(N.target.files);ie(H),N.target.value=""},F=N=>{const H=Array.from(N.dataTransfer.files);ie(H)},ie=N=>{for(const H of N)te.some(re=>re.file.name===H.name)?ne(i("core.fileUpload.alreadyInQueue",{fileName:H.name}),"warning"):te.push({file:H,uploading:!1,uploaded:!1,progress:0})},ye=N=>{const H=te.findIndex(re=>re.file.name===N.file.name);H!==-1&&te.splice(H,1)},O=()=>{te.forEach(N=>{!N.uploaded&&!N.uploading&&le(N)})},le=N=>{const H=new XMLHttpRequest;H.open("POST",f.uploadFolder,!0);for(const[oe,G]of Object.entries(f.headers))H.setRequestHeader(oe,G);H.upload.onprogress=oe=>{oe.lengthComputable&&(N.progress=oe.loaded/oe.total*100)},H.onload=()=>{N.uploading=!1,H.status>=200&&H.status<300?(N.uploaded=!0,N.progress=100,ne(i("core.fileUpload.uploadSuccess",{fileName:N.file.name}),"success"),setTimeout(()=>{ye(N)},1500)):ne(i("core.fileUpload.uploadError",{fileName:N.file.name,status:H.status}),"error")},H.onerror=()=>{N.uploading=!1,ne(i("core.fileUpload.uploadFailed",{fileName:N.file.name}),"error"),ye(N)};const re=new FormData;re.append(N.file.name,N.file),N.uploading=!0,H.send(re)};return(N,H)=>(d(),T("div",{class:"flux-share-upload",onDrop:St(F,["prevent"]),onDragover:H[1]||(H[1]=St(()=>{},["prevent"]))},[Ie(s("input",{ref_key:"fileselector",ref:q,type:"file",multiple:"",onChange:Ue},null,544),[[za,!1]]),t(rt,{class:"flux-share-upload-drop",onClick:Q},{default:e(()=>[t(Dt,{class:"text-center"},{default:e(()=>[t(b,{size:"64"},{default:e(()=>[...H[2]||(H[2]=[n(" mdi-cloud-upload ",-1)])]),_:1}),s("p",null,[n(c(a(i)("core.fileUpload.dropFilesHere"))+" ",1),s("em",null,c(a(i)("core.fileUpload.clickToUpload")),1)]),s("p",sr,c(a(i)("core.fileUpload.fileSizeLimit")),1)]),_:1})]),_:1}),t(et,{class:"upload-column mt-4","no-gutters":""},{default:e(()=>[(d(!0),T(De,null,ut(te,re=>(d(),C(me,{key:re.file.name,cols:"12",class:"upload-item"},{default:e(()=>[s("div",nr,[s("div",rr,c(re.file.name)+" ("+c(M(re.file.size))+") ",1),re.progress===0?(d(),C(b,{key:0,class:"cursor-pointer",color:"error",onClick:St(oe=>ye(re),["stop"])},{default:e(()=>[...H[3]||(H[3]=[n(" mdi-trash-can-outline ",-1)])]),_:1},8,["onClick"])):I("",!0)]),re.uploading||re.uploaded?(d(),C(Wt,{key:0,"model-value":re.progress,height:"6",color:"success"},null,8,["model-value"])):I("",!0)]),_:2},1024))),128))]),_:1}),t(et,{class:"mt-3"},{default:e(()=>[t(me,{class:"text-center"},{default:e(()=>[t(B,{color:"primary",disabled:!pe.value,onClick:O},{default:e(()=>[n(c(a(i)("core.fileUpload.uploadFiles")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),t(Va,{modelValue:j.value,"onUpdate:modelValue":H[0]||(H[0]=re=>j.value=re),color:ge.value,timeout:"4000",location:"top right"},{default:e(()=>[n(c(he.value),1)]),_:1},8,["modelValue","color"])],32))}},ur=aa(ir,[["__scopeId","data-v-75cab953"]]),dr={class:"d-flex align-center justify-space-between"},cr={class:"d-flex align-center border-frame w-100"},pr={class:"d-flex align-center mr-4"},mr={class:"text-h5"},fr={key:0},vr={class:"progress-wrapper"},gr={class:"progress-text"},yr={key:1,class:"my-4 px-4 py-3",style:{border:"1px solid #eaeaea","border-radius":"8px","box-shadow":"0 4px 8px rgba(0, 0, 0, 0.1)","text-align":"center"}},br={class:"mb-3 text-subtitle-1"},hr={key:0},wr={key:1},xr={class:"text-white text-caption"},kr={class:"no-wrap"},_r=["onClick"],$r={key:5},Cr={key:0,class:"hide-on-sm",style:{"font-size":"14px","white-space":"nowrap"}},zr={key:0,style:{"font-size":"14px","white-space":"nowrap"}},Sr={key:0,class:"d-flex justify-end"},Ar={class:"align-center"},Vr={class:"text-truncate"},Tr={class:"editor-container"},Rr={key:0,class:"d-flex align-center justify-center",style:{height:"100%"}},Ir={class:"d-flex align-center"},Dr={__name:"VolumeBrowser",props:{appSpec:{type:Object,required:!0},isComposeSingle:{type:Boolean,required:!0},executeLocalCommand:{type:Function,required:!0},ipAccess:{type:Boolean,required:!0},selectedIp:{type:String,required:!0}},setup(xe){const f=xe,i=Il(()=>el(()=>import("./monaco-T-LZewlR.js"),__vite__mapDeps([0,1])).then(k=>k.VueMonacoEditor)),{smAndDown:te}=$l(),q=Ma(),{theme:j}=Fa(q),he=p("success"),ge=p(!1),ne=p(""),pe=p(""),M=p(!1),Q=p(!1),Ue=p([]),F=p(""),ie=p(!1),ye=p(""),O=p(!1),le=p(!1),N=p(""),H=p(""),re=p(""),oe=p(""),G=p(null),Le=p(""),se=p([]),Te=p(null),L=p(""),qe=Ba({used:0,total:1}),Oe=p(""),Re=p(""),He=p(""),je=p(!1),ht=p(!1),dt=p(!1),Ce=p(!1),at=p(""),ue=p(null),S=p(!1),w=p(!1),h=va(null),m=va(null),{t:x}=pa(),A=$e(()=>{const k=[{title:x("core.volumeBrowser.name"),key:"name",sortable:!1},{title:x("core.volumeBrowser.size"),key:"size",sortable:!1},{title:"",key:"actions",sortable:!1}];return te.value||k.splice(2,0,{title:x("core.volumeBrowser.modifiedAt"),key:"modifiedAt",sortable:!1}),k}),de=$e(()=>{const k=Ue.value.filter(l=>l.name.toLowerCase().includes(ye.value.toLowerCase()));return[F.value?{name:"..",symLink:!1,isDirectory:!1,isUpButton:!0}:null,...k.filter(l=>l.name!==".gitkeep")].filter(Boolean)}),E=$e(()=>f.appSpec),ce=$e(()=>qe.used/qe.total*100);bt(()=>f.appSpec?.compose,k=>{k&&k.length===1&&(G.value=k[0].name)},{immediate:!0});const Pe=()=>{ue.value?.editor&&ue.value.editor.updateOptions({language:ct.value})},Je=p(["abap","apex","azcli","bat","c","cameligo","clojure","coffeescript","cpp","csharp","csp","css","dart","dockerfile","ecl","fsharp","flow","git-commit","git-rebase","go","graphql","handlebars","hcl","html","ini","java","javascript","javascriptreact","json","jsonc","less","lexon","lua","markdown","mips","mysql","objective-c","pascal","perl","pgsql","php","plaintext","pom","powershell","pug","python","r","razor","ruby","rust","sb","scss","shell","sol","sql","swift","typescript","typescriptreact","vb","xml","yaml"]),At=p({year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),lt=p({abap:"abap",cls:"apex",azcli:"azcli",bat:"bat",c:"c",mligo:"cameligo",clj:"clojure",coffee:"coffeescript",cpp:"cpp",cc:"cpp",cxx:"cpp",cs:"csharp",csp:"csp",css:"css",dart:"dart",dockerfile:"dockerfile",ecl:"ecl",fs:"fsharp",fsi:"fsharp",flow:"flow",go:"go",graphql:"graphql",gql:"graphql",hbs:"handlebars",hcl:"hcl",html:"html",htm:"html",ini:"ini",conf:"ini",java:"java",js:"javascript",jsx:"javascriptreact",json:"json",jsonc:"jsonc",less:"less",lexon:"lexon",lua:"lua",md:"markdown",markdown:"markdown",mips:"mips",mysql:"mysql",m:"objective-c",mm:"objective-c",pas:"pascal",pp:"pascal",pl:"perl",pm:"perl",pgsql:"pgsql",php:"php",txt:"plaintext","pom.xml":"pom",ps1:"powershell",pug:"pug",py:"python",r:"r",cshtml:"razor",razor:"razor",rb:"ruby",rs:"rust",sb:"sb",scss:"scss",sh:"shell",bash:"shell",sol:"sol",sql:"sql",swift:"swift",ts:"typescript",tsx:"typescriptreact",vb:"vb",xml:"xml",yaml:"yaml",yml:"yaml"}),ct=p("plaintext"),pt=p({automaticLayout:!0,formatOnType:!0,formatOnPaste:!0,fontFamily:'"Courier New", Courier, monospace',fontSize:14,fontWeight:"normal",letterSpacing:0,lineHeight:19,wordWrap:"off",wordWrapColumn:0,wrappingStrategy:"simple",stopRenderingLineAfter:-1,scrollBeyondLastColumn:50,scrollBeyondLastLine:!0,smoothScrolling:!1,disableMonospaceOptimizations:!0,scrollbar:{horizontal:"visible",vertical:"visible",horizontalScrollbarSize:10,verticalScrollbarSize:10,useShadows:!1,handleMouseWheel:!0},minimap:{enabled:!1},renderWhitespace:"none",renderControlCharacters:!1,fontLigatures:!1});function be(k,o,l=null){pe.value=o,he.value=k==="danger"?"error":k,ne.value=l||{success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information",danger:"mdi-alert-circle"}[k]||"mdi-information",ge.value=!0}function Ve(k,o){return k?.compose?k.compose.find(v=>v.name===o).hdd:k.hdd}async function Ge(k,o=!1){try{ye.value="",o||(Ue.value=[]),Q.value=!0;const l=await f.executeLocalCommand(`/apps/getfolderinfo/${f.appSpec.name}/${G.value}/${encodeURIComponent(k)}`);Q.value=!1,l.data.status==="success"?(Ue.value=l.data.data,console.log(Ue.value)):be("danger",l.data.data.message||l.data.data)}catch(l){Q.value=!1,console.log(l.message),be("danger",l.message||l)}}async function Ke(){try{Te.value=await f.executeLocalCommand(`/backup/getvolumedataofcomponent/${f.appSpec.name}/${G.value}/B/2/used,size`),L.value=Te.value?.data?.data,Te.value?.data?.status==="success"?(qe.total=Ve(E.value,G.value)*1024*1024*1024,qe.used=Te.value.data.data.used):be("danger",Te.value.data.data.message||Te.value.data.data)}catch(k){be("danger",k.message||k)}}function Rt(){F.value="";const o=F.value.split("/").filter(l=>l!=="").map(l=>`${l}`).join("/");Le.value=`/${o}`,Ge(F.value,!0),Ke()}function Yt(k){return new Promise((o,l)=>{const v=new FileReader;v.onload=()=>o(v.result),v.onerror=l,v.readAsText(k,"utf-8")})}function Ct(){const o=F.value.split("/").filter(l=>l!=="").map(l=>`${l}`).join("/");Le.value=`/${o}`,Ge(F.value,!0),Ke()}function Be(k){if(k===".."){const v=F.value.split("/");v.pop(),F.value=v.join("/")}else F.value===""?F.value=k:F.value=`${F.value}/${k}`;const l=F.value.split("/").filter(v=>v!=="").map(v=>`${v}`).join("/");Le.value=`/${l}`,Ge(F.value)}function Mt(k){return k<50?"success":k<75?"warning":"error"}async function Ye(k){O.value=!1;try{let o=k;F.value!==""&&(o=`${F.value}/${k}`);const l=await f.executeLocalCommand(`/apps/createfolder/${f.appSpec.name}/${G.value}/${encodeURIComponent(o)}`);l.data.status==="error"?l.data.data.code==="EEXIST"?be("danger",x("core.volumeBrowser.folderAlreadyExists",{folder:k})):be("danger",l.data.data.message||l.data.data):(be("success",x("core.volumeBrowser.folderCreated",{folder:k})),await Ge(F.value,!0))}catch(o){Q.value=!1,console.error(o.message),be("danger",o.message||o)}re.value=""}ja(()=>{f.isComposeSingle&&Ct()});const Qe=$e(()=>se.value);function It(){const k=Qe.value.every(o=>o.progress===100);return k&&setTimeout(()=>{se.value=se.value.filter(o=>o.progress!==100)},5e3),k}function Ut(k,o="auto",l=2){const v={B:1,KB:1024,MB:1048576,GB:1073741824},R=(X,P)=>X/v[P.toUpperCase()],z=(X,P)=>`${P==="B"?X.toFixed(0):X.toFixed(l)} ${P}`;let D;if(Array.isArray(k)&&k.length>0)D=+k.reduce((X,P)=>X+(P.file_size||0),0);else if(typeof+k=="number")D=+k;else return console.error("Invalid sizes parameter"),"N/A";if(isNaN(D))return console.error("Total size is not a valid number"),"N/A";if(o==="auto"){let X,P=D;return Object.keys(v).forEach(ke=>{const Ne=R(D,ke);Ne>=1&&(P===void 0||Ne<P)&&(P=Ne,X=ke)}),X=X||"B",z(P,X)}else{const X=R(D,o);return z(X,o)}}function Et(k){le.value=!0;let o=k;F.value!==""&&(o=`${F.value}/${k}`),H.value=o,N.value=k}async function ma(){le.value=!1;try{const k=H.value,o=N.value,l=await f.executeLocalCommand(`/apps/renameobject/${f.appSpec.name}/${G.value}/${encodeURIComponent(k)}/${o}`);console.log(l),l.data.status==="error"?be("danger",l.data.data.message||l.data.data):(k.includes("/")?be("success",x("core.volumeBrowser.renamedSuccess",{oldName:k.split("/").pop(),newName:o})):be("success",x("core.volumeBrowser.renamedSuccess",{oldName:k,newName:o})),Ge(F.value,!0))}catch(k){be("danger",k.message||k)}}async function Qt(k){try{const o=F.value,l=o?`${o}/${k}`:k,v=await f.executeLocalCommand(`/apps/removeobject/${f.appSpec.name}/${G.value}/${encodeURIComponent(l)}`);v.data.status==="error"?be("danger",v.data.data.message||v.data.data):(Ge(F.value,!0),be("success",x("core.volumeBrowser.deleted",{name:k})))}catch(o){be("danger",o.message||o)}}function Vt(k,o){const l=se.value.findIndex(v=>v.fileName===k);l!==-1?se.value[l]={fileName:k,progress:o}:se.value.push({fileName:k,progress:o})}async function xt(k,o=!1,l=!1){try{const v=F.value,R=v?`${v}/${k}`:k,z={headers:Kt(),responseType:"blob",onDownloadProgress(P){if(l)return;const{loaded:ke,total:Ne,lengthComputable:st}=P,_t=o?`${k}.zip`:k;if(st){const $=ke/Ne*100;Vt(_t,$)}else console.log("Total file size is unknown. Cannot compute progress percentage."),Vt(_t,"Downloading...")}};!l&&o&&be("info",x("core.volumeBrowser.directoryDownloadInitiated"));const D=o?"downloadfolder":"downloadfile",X=await f.executeLocalCommand(`/apps/${D}/${f.appSpec.name}/${G.value}/${encodeURIComponent(R)}`,null,z);if(console.log(X),!l&&!o&&X.data&&X.status===200&&Vt(k,100),console.log("Downloading Test..."),X.data?.status==="error")be("danger",X.data.data.message||X.data.data);else{if(l)return await Yt(X.data);{console.log("Downloading...");const P=window.URL.createObjectURL(new Blob([X.data])),ke=document.createElement("a");ke.href=P,ke.setAttribute("download",o?`${k}.zip`:k),document.body.appendChild(ke),ke.click(),ke.remove(),window.URL.revokeObjectURL(P)}}}catch(v){console.error(v.message),be("danger",v.message||v)}}function Kt(){return{zelidauth:localStorage.getItem("zelidauth")}}function We(k){const o=Bl.highlightAuto(k);return console.log("Detected language:",o.language),o.language||"plaintext"}function kt(k){const o=k.toLowerCase();if(o==="dockerfile")return Je.value.includes("dockerfile")?"dockerfile":"plaintext";if(o==="pom.xml")return Je.value.includes("pom")?"pom":"plaintext";const l=o.split(".");if(l.length<=1)return"plaintext";const v=l.pop(),R=lt.value[v]||"plaintext";return Je.value.includes(R)?R:"plaintext"}function jt(k,o){const l={"php-template":"php",bash:"shell",smalltalk:"json"},v=kt(o);if(v!==k&&v!=="plaintext")return console.log("Selected by fileType"),v;if(Je.value.includes(k))return console.log("Selected by supportedLanguages"),k;if(l[k]){const R=l[k];return console.log("Selected by aliasMapping"),R}return"plaintext"}function sa(k){return new Promise(o=>setTimeout(o,k))}async function ya(k,o){if(4194304<o){be("warning",x("core.volumeBrowser.fileTooLarge"));return}Re.value=x("core.volumeBrowser.initializing"),He.value=x("core.volumeBrowser.loadingFile",{file:k}),je.value=!0,Oe.value=k,await sa(3e3),xt(k,!1,!0).then(v=>{setTimeout(()=>{He.value="",Re.value=""},2e3),je.value=!1,oe.value=v;const R=v.slice(0,500),z=We(R),D=jt(z,k);ct.value=D,S.value=!0,Ce.value=!0,setTimeout(()=>{w.value=!0},300)}).catch(v=>{je.value=!1,setTimeout(()=>{He.value="",Re.value=""},2e3),console.error("Error loading file for editing:",v),be("danger",x("core.volumeBrowser.errorLoadingFile"))})}function mt(){S.value=!1,w.value=!1,it(()=>{try{h.value&&typeof h.value.dispose=="function"&&h.value.dispose(),h.value=null,oe.value="",Oe.value="",dt.value=!1,Ce.value=!1}catch(k){console.error("Error during closeEditor:",k),be("danger",x("core.volumeBrowser.errorClosingEditor"))}})}async function Pt(){console.log("[SAVE] Starting saveContent()"),ht.value=!0,await it(),console.log("[SAVE] Spinner enabled");let k="";try{const l=m.value||h.value?.getModel();if(!l||typeof l.getValue!="function")throw new Error("No valid Monaco model found");k=l.getValue(),console.log("[SAVE] Got model value")}catch(l){console.error("[SAVE] Error getting editor content:",l),be("danger",x("core.volumeBrowser.editorNotReady")),ht.value=!1;return}const o={file_name:Oe.value,content:k};try{console.log("[SAVE] Uploading..."),await Lt(o,!0),be("success",x("core.volumeBrowser.fileUpdated")),await Ct()}catch(l){console.error("[SAVE] Upload failed:",l),be("danger",x("core.volumeBrowser.errorSavingFile",{error:l.message}))}finally{dt.value=!1,ht.value=!1}}function ot(){!dt.value&&Ce.value&&(dt.value=!0)}function ft(k){h.value=k,m.value=k.getModel();const o=k.getDomNode()?.parentElement;setTimeout(()=>{o&&k.layout({width:o.offsetWidth,height:o.offsetHeight}),window.monaco?.editor&&window.monaco.editor.remeasureFonts()},100),k.onDidChangeModelContent(ot)}function Fe(){if(f.selectedIp){const[k,o=16127]=f.selectedIp.split(":"),l=F.value?`/ioutils/fileupload/volume/${f.appSpec.name}/${G.value}/${encodeURIComponent(F.value)}`:`/ioutils/fileupload/volume/${f.appSpec.name}/${G.value}`;return f.ipAccess?`http://${k}:${o}${l}`:`https://${k.replace(/\./g,"-")}-${o}.node.api.runonflux.io${l}`}}async function Lt(k,o=!1){return new Promise((l,v)=>{if(typeof XMLHttpRequest>"u"){v("XMLHttpRequest is not supported.");return}const R=new XMLHttpRequest,z=o?Fe():la(k.file_name);R.upload&&(R.upload.onprogress=function(ke){ke.total>0&&(ke.percent=ke.loaded/ke.total*100),k.progress=ke.percent});const D=new FormData;if(o){const P=new Blob([k.content],{type:"text/plain"});D.append(k.file_name,P)}else D.append(k.selected_file.name,k.selected_file);k.uploading=!0,R.onerror=function(ke){k.uploading=!1,k.uploaded=!1,k.progress=0,be("danger",`An error occurred while uploading ${k.selected_file?.name||k.file_name}`),v(ke)},R.onload=function(){if(R.status<200||R.status>=300){console.error(R.status),k.uploading=!1,k.uploaded=!1,k.progress=0,be("danger",`Upload failed with status ${R.status}`),v(R.status);return}k.uploaded=!0,k.uploading=!1,l()},R.open("post",z,!0);const X=Kt()||{};Object.keys(X).forEach(P=>{X[P]!=null&&R.setRequestHeader(P,X[P])}),R.setRequestHeader("Access-Control-Allow-Origin","*"),R.send(D)})}function la(k){const o=f.selectedIp.split(":")[0],l=f.selectedIp.split(":")[1]||16127,v=encodeURIComponent(k);return f.ipAccess?`http://${o}:${l}/ioutils/fileupload/backup/${f.appSpec.name}/${at.value}/null/${v}`:`https://${o.replace(/\./g,"-")}-${l}.node.api.runonflux.io/ioutils/fileupload/backup/${f.appSpec.name}/${at.value}/null/${v}`}return Ta(()=>{el(async()=>{const{loader:k}=await import("./monaco-T-LZewlR.js");return{loader:k}},__vite__mapDeps([0,1])).then(({loader:k})=>{k.init().then(()=>{M.value=!0})})}),(k,o)=>{const l=ur;return d(),T(De,null,[s("div",null,[t(et,{class:"align-center justify-space-between mb-1 mt-1"},{default:e(()=>[t(me,{cols:"12"},{default:e(()=>[s("div",dr,[s("div",cr,[s("div",pr,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...o[15]||(o[15]=[n(" mdi-server ",-1)])]),_:1})]),_:1}),s("span",mr,c(a(x)("core.volumeBrowser.title")),1)])]),a(G)||!a(E)?.compose?(d(),T("div",fr,[s("div",vr,[t(ia,{"model-value":a(ce),color:Mt(a(ce)),size:60,width:7,class:"progress-glow"},{default:e(()=>[s("span",gr,c(a(ce).toFixed(1))+"% ",1)]),_:1},8,["model-value","color"])])])):I("",!0)])]),_:1})]),_:1}),a(E)?.compose?(d(),C(Gt,{key:0,modelValue:a(G),"onUpdate:modelValue":[o[0]||(o[0]=v=>gt(G)?G.value=v:null),Rt],items:a(E).compose.map(v=>v.name),disabled:xe.isComposeSingle,label:a(x)("core.volumeBrowser.selectComponent"),class:"mb-4",style:{"max-width":"280px"}},null,8,["modelValue","items","disabled","label"])):I("",!0),a(se).length>0?(d(),T("div",yr,[s("h5",br,[It()?(d(),T("span",wr,c(a(x)("core.volumeBrowser.downloadCompleted")),1)):(d(),T("span",hr,[t(ia,{indeterminate:"",size:"20",class:"mr-2",color:"success"}),n(" "+c(a(x)("core.volumeBrowser.downloading")),1)]))]),(d(!0),T(De,null,ut(a(Qe),(v,R)=>(d(),C(Wt,{key:R,"model-value":typeof v.progress=="number"?v.progress:0,height:"16",class:"mb-2",color:"success"},{default:e(()=>[s("strong",xr,c(v.fileName)+" - "+c(typeof v.progress=="number"?v.progress.toFixed(2)+"%":v.progress),1)]),_:2},1032,["model-value"]))),128))])):I("",!0),a(G)||!a(E)?.compose?(d(),C(et,{key:2,class:"mb-4"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center"},{default:e(()=>[t(Zt,{modelValue:a(Le),"onUpdate:modelValue":o[1]||(o[1]=v=>gt(Le)?Le.value=v:null),label:a(x)("core.volumeBrowser.path"),"prepend-inner-icon":"mdi-home",dense:"",class:"flex-grow-1 mr-2",disabled:""},null,8,["modelValue","label"]),t(B,{icon:"",class:"mr-1",onClick:Ct},{default:e(()=>[t(b,null,{default:e(()=>[...o[16]||(o[16]=[n("mdi-redo",-1)])]),_:1})]),_:1}),t(B,{icon:"",class:"mr-1",onClick:o[2]||(o[2]=v=>ie.value=!0)},{default:e(()=>[t(b,null,{default:e(()=>[...o[17]||(o[17]=[n("mdi-cloud-upload",-1)])]),_:1})]),_:1}),t(B,{icon:"",onClick:o[3]||(o[3]=v=>O.value=!0)},{default:e(()=>[t(b,null,{default:e(()=>[...o[18]||(o[18]=[n("mdi-folder-plus",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):I("",!0),a(G)||f.isComposeSingle?(d(),C(wa,{key:3,border:"",rounded:"",class:"mt-4",style:{"max-height":"400px"}},{default:e(()=>[a(G)||f.isComposeSingle?(d(),C(fa,{key:0,items:a(de),headers:a(A),"fixed-header":"",loading:a(Q),"no-data-text":a(x)("core.volumeBrowser.files.emptyDirectory"),"item-value":"name",class:"elevation-1 no-wrap-table",density:"compact","sort-by":[{key:"name",order:"asc"}],"items-per-page":-1,"hide-default-footer":"",style:{"min-height":"80px","max-height":"380px"}},{"item.name":e(({item:v})=>[s("span",kr,[v.isUpButton?(d(),C(b,{key:0,class:"mr-1"},{default:e(()=>[...o[19]||(o[19]=[n(" mdi-folder-arrow-up ",-1)])]),_:1})):I("",!0),v.symLink?(d(),C(b,{key:1,class:"mr-1"},{default:e(()=>[...o[20]||(o[20]=[n(" mdi-folder-symlink ",-1)])]),_:1})):I("",!0),v.isDirectory?(d(),C(b,{key:2,class:"mr-1"},{default:e(()=>[...o[21]||(o[21]=[n(" mdi-folder ",-1)])]),_:1})):I("",!0),v.isFile?(d(),C(b,{key:3,class:"mr-1"},{default:e(()=>[...o[22]||(o[22]=[n(" mdi-file ",-1)])]),_:1})):I("",!0),v.isDirectory||v.isUpButton?(d(),T("span",{key:4,class:"cursor-pointer text-primary",onClick:R=>Be(v.name)},c(v.name),9,_r)):(d(),T("span",$r,c(v.name),1))])]),"item.modifiedAt":e(({item:v})=>[v.isUpButton?I("",!0):(d(),T("span",Cr,c(new Date(v.modifiedAt).toLocaleString("en-GB",a(At))),1))]),"item.size":e(({item:v})=>[v.size>0?(d(),T("span",zr,c(Ut(v.size)),1)):I("",!0)]),"item.actions":e(({item:v})=>[v.isUpButton?I("",!0):(d(),T("div",Sr,[t(Cl,{density:"compact",variant:"flat",rounded:"0"},{default:e(()=>[t(Ze,{text:v.isDirectory?a(x)("core.volumeBrowser.downloadFolderAsArchive"):a(x)("core.volumeBrowser.downloadFile"),location:"top"},{activator:e(({props:R})=>[t(B,wt(R,{icon:"",size:"small",rounded:"0",density:"comfortable",class:"mr-1",onClick:z=>xt(v.name,v.isDirectory)}),{default:e(()=>[t(b,null,{default:e(()=>[n(c(v.isDirectory?"mdi-archive-arrow-down":"mdi-download"),1)]),_:2},1024)]),_:2},1040,["onClick"])]),_:2},1032,["text"]),t(Ze,{text:a(x)("core.volumeBrowser.rename"),location:"top"},{activator:e(({props:R})=>[t(B,wt(R,{icon:"",size:"small",rounded:"0",density:"comfortable",class:"mr-1",onClick:z=>Et(v.name)}),{default:e(()=>[t(b,null,{default:e(()=>[...o[23]||(o[23]=[n("mdi-pencil",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1032,["text"]),v.isFile?(d(),C(Ze,{key:0,text:a(x)("core.volumeBrowser.edit"),location:"top"},{activator:e(({props:R})=>[t(B,wt(R,{icon:"",size:"small",rounded:"0",density:"comfortable",class:"mr-1",onClick:z=>ya(v.name,v.size)}),{default:e(()=>[t(b,null,{default:e(()=>[...o[24]||(o[24]=[n("mdi-file-edit",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1032,["text"])):I("",!0),t(Ze,{text:a(x)("core.volumeBrowser.delete"),location:"top"},{activator:e(({props:R})=>[t(B,wt(R,{icon:"",size:"small",rounded:"0",density:"comfortable",class:"mr-1",onClick:z=>Qt(v.name)}),{default:e(()=>[t(b,null,{default:e(()=>[...o[25]||(o[25]=[n("mdi-trash-can-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1032,["text"])]),_:2},1024)]))]),_:1},8,["items","headers","loading","no-data-text"])):I("",!0)]),_:1})):I("",!0),t(ua,{modelValue:a(je),"onUpdate:modelValue":o[4]||(o[4]=v=>gt(je)?je.value=v:null),persistent:"",width:"500"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary text-h6 justify-center"},{default:e(()=>[n(c(a(Re)),1)]),_:1}),t(Dt,{class:"d-flex flex-column align-center justify-center",style:{"min-height":"100px"}},{default:e(()=>[s("div",Ar,[n(c(a(He))+" ",1),t(Wt,{indeterminate:"",class:"mt-2"})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(O),"onUpdate:modelValue":o[7]||(o[7]=v=>gt(O)?O.value=v:null),"max-width":"500px"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,null,{default:e(()=>[n(c(a(x)("core.volumeBrowser.createFolder")),1)]),_:1}),t(Dt,null,{default:e(()=>[t(Zt,{modelValue:a(re),"onUpdate:modelValue":o[5]||(o[5]=v=>gt(re)?re.value=v:null),label:a(x)("core.volumeBrowser.folderName")},null,8,["modelValue","label"])]),_:1}),t(ka,null,{default:e(()=>[t(Za),t(B,{color:"primary",onClick:o[6]||(o[6]=v=>Ye(a(re)))},{default:e(()=>[n(c(a(x)("core.volumeBrowser.create")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(ie),"onUpdate:modelValue":o[9]||(o[9]=v=>gt(ie)?ie.value=v:null),"max-width":"700px"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary text-white"},{default:e(()=>[n(c(a(x)("core.volumeBrowser.uploadFiles")),1)]),_:1}),t(Dt,null,{default:e(()=>[t(l,{"upload-folder":Fe(),headers:Kt()},null,8,["upload-folder","headers"])]),_:1}),t(ka,null,{default:e(()=>[t(B,{color:"error",size:"small",variant:"flat",text:"",onClick:o[8]||(o[8]=v=>{Ct(),ie.value=!1})},{default:e(()=>[n(c(a(x)("core.volumeBrowser.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ua,{modelValue:a(le),"onUpdate:modelValue":o[11]||(o[11]=v=>gt(le)?le.value=v:null),"max-width":"500px"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,null,{default:e(()=>[n(c(a(x)("core.volumeBrowser.rename")),1)]),_:1}),t(Dt,null,{default:e(()=>[t(Zt,{modelValue:a(N),"onUpdate:modelValue":o[10]||(o[10]=v=>gt(N)?N.value=v:null),label:a(x)("core.volumeBrowser.newName")},null,8,["modelValue","label"])]),_:1}),t(ka,null,{default:e(()=>[t(Za),t(B,{color:"primary",onClick:ma},{default:e(()=>[n(c(a(x)("core.volumeBrowser.rename")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(S)?(d(),C(ua,{key:4,modelValue:a(S),"onUpdate:modelValue":o[13]||(o[13]=v=>gt(S)?S.value=v:null),"max-width":"80vw"},{default:e(()=>[t(rt,null,{default:e(()=>[t(Ht,{class:"bg-primary text-white d-flex align-center justify-space-between"},{default:e(()=>[s("span",Vr,c(a(x)("core.volumeBrowser.editing",{file:a(Oe)})),1),t(Gt,{modelValue:a(ct),"onUpdate:modelValue":[o[12]||(o[12]=v=>gt(ct)?ct.value=v:null),Pe],items:a(Je),dense:"","hide-details":"",style:{"max-width":"150px"}},null,8,["modelValue","items"])]),_:1}),t(Dt,{class:"pa-4"},{default:e(()=>[s("div",Tr,[a(w)?I("",!0):(d(),T("div",Rr,[t(ia,{indeterminate:"",color:"primary",size:"48"})])),a(w)?(d(),C(a(i),{key:1,ref_key:"monacoEditor",ref:ue,value:a(oe),theme:a(j)==="dark"?"vs-dark":"vs",language:a(ct),options:a(pt),onMount:ft},null,8,["value","theme","language","options"])):I("",!0)])]),_:1}),t(ka,null,{default:e(()=>[t(B,{color:"error",variant:"flat",onClick:mt},{default:e(()=>[n(c(a(x)("core.volumeBrowser.close")),1)]),_:1}),t(B,{class:"mr-2",color:"primary",variant:"flat",disabled:!a(dt)||a(ht),onClick:Pt},{default:e(()=>[a(ht)?(d(),T(De,{key:0},[t(ia,{indeterminate:"",size:"18",class:"mr-2"}),n(" "+c(a(x)("core.volumeBrowser.saving")),1)],64)):(d(),T(De,{key:1},[n(c(a(x)("core.volumeBrowser.save")),1)],64))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):I("",!0)]),t(Va,{modelValue:a(ge),"onUpdate:modelValue":o[14]||(o[14]=v=>gt(ge)?ge.value=v:null),color:a(he),timeout:"4000",location:"top",elevation:"4"},{default:e(()=>[s("div",Ir,[t(b,{class:"mr-1"},{default:e(()=>[n(c(a(ne)),1)]),_:1}),s("span",null,c(a(pe)),1)])]),_:1},8,["modelValue","color"])],64)}}},Ur=aa(Dr,[["__scopeId","data-v-6c67a3f5"]]),Lr={key:0,class:"terminal-window-manager-overlay"},Br={class:"window-container"},Fr={class:"titlebar-left"},Er={class:"window-title"},Pr={class:"titlebar-center"},Mr={class:"view-toggle-modern"},jr={class:"titlebar-right"},Or={class:"window-content"},Nr={key:0,class:"grid-layout"},qr=["onDrop"],Hr=["onDragstart"],Wr={class:"pane-title"},Jr={class:"pane-buttons"},Gr=["id"],Kr={key:1,class:"horizontal-layout"},Xr=["onDrop"],Zr=["onDragstart"],Yr={class:"pane-title"},Qr={class:"pane-buttons"},ei=["id"],ti={key:2,class:"vertical-layout"},ai=["onDrop"],li=["onDragstart"],oi={class:"pane-title"},si={class:"pane-buttons"},ni=["id"],ri={__name:"TerminalWindowManager",props:{terminals:{type:Array,default:()=>[]},isOpen:{type:Boolean,default:!1}},emits:["closeWindow","closeTerminal","unpinTerminal","terminalReady","update:isOpen","reorderTerminals"],setup(xe,{emit:f}){const i=xe,te=f;ol();const{t:q}=pa(),j=document.documentElement.clientWidth,he=document.documentElement.clientHeight,ge=Math.min(Math.floor(j*.8),1200),ne=Math.min(Math.floor(he*.8),800),pe=Math.floor((j-ge)/2),M=Math.floor((he-ne)/2),Q=p(pe),Ue=p(M),F=p(ge),ie=p(ne),ye=p(!0),O=p(!1),le=p("grid"),N=p(null),H=p([]),re=p(null);bt(()=>i.terminals,ue=>{const S=ue.filter((w,h,m)=>w.id?h===m.findIndex(x=>x.id===w.id):!1);H.value=[...S],S.length!==ue.length&&console.log(`🧹 Filtered out ${ue.length-S.length} invalid terminal(s) from manager`)},{immediate:!0,deep:!0});const oe=p(pe),G=p(M),Le=p(ge),se=p(ne);bt(()=>i.isOpen,ue=>{ue&&(Q.value=0,Ue.value=0,F.value=document.documentElement.clientWidth,ie.value=document.documentElement.clientHeight,O.value=!0)}),bt(()=>i.terminals,ue=>{ue.length>0&&!N.value&&(N.value=ue[0].id),it(()=>{ue.forEach(S=>{document.getElementById(`terminal-${S.id}`)&&te("terminalReady",S.id)})})},{deep:!0,immediate:!0});const Te=new Map;bt(le,(ue,S)=>{console.log("🔄 Layout mode changing from",S,"to",ue),Te.clear(),i.terminals.forEach(w=>{const h=document.getElementById(`terminal-${w.id}`);if(h){const m=h.querySelector(".xterm");m&&(console.log(`💾 Saving xterm element for terminal ${w.id}`),h.removeChild(m),Te.set(w.id,m))}})},{flush:"sync"}),bt(le,(ue,S)=>{it(()=>{setTimeout(()=>{console.log("📦 New layout DOM ready, restoring xterm elements"),i.terminals.forEach(w=>{const h=Te.get(w.id);if(!h){console.warn(`  ⚠️ No saved xterm element for terminal ${w.id}`),te("terminalReady",w.id);return}const m=document.getElementById(`terminal-${w.id}`);if(!m){console.error(`  ❌ New container not found for terminal ${w.id}`),te("terminalReady",w.id);return}console.log(`  ♻️ Restoring xterm element to terminal ${w.id}`),m.appendChild(h),console.log("  ✅ Restore complete"),setTimeout(()=>{te("terminalReady",w.id)},50)}),Te.clear()},100)})});function L(){O.value?(Q.value=oe.value,Ue.value=G.value,F.value=Le.value,ie.value=se.value,O.value=!1):(oe.value=Q.value,G.value=Ue.value,Le.value=F.value,se.value=ie.value,Q.value=0,Ue.value=0,F.value=document.documentElement.clientWidth,ie.value=document.documentElement.clientHeight,O.value=!0),setTimeout(()=>{i.terminals.forEach(ue=>{te("terminalReady",ue.id)})},150)}function qe(){te("closeWindow"),te("update:isOpen",!1)}function Oe(ue){te("unpinTerminal",ue)}function Re(ue){te("closeTerminal",ue)}function He(){const ue=H.value.length;if(ue===1)return{width:"100%",height:"100%"};if(ue===2)return{width:"50%",height:"100%"};if(ue===3)return{width:"33.33%",height:"100%"};if(ue===4)return{width:"50%",height:"50%"};const S=Math.ceil(Math.sqrt(ue));return{width:`${100/S}%`,height:`${100/Math.ceil(ue/S)}%`}}function je(ue,S){ue.stopPropagation(),re.value=S,ue.dataTransfer.effectAllowed="move",ue.dataTransfer.setData("text/plain",S),console.log("🎯 Drag started:",S)}function ht(ue){ue.preventDefault(),ue.dataTransfer.dropEffect="move"}function dt(ue,S){ue.preventDefault();const w=re.value;if(!w||w===S)return;console.log("🔄 Reordering:",w,"→",S);const h=H.value.findIndex(de=>de.id===w),m=H.value.findIndex(de=>de.id===S);if(h===-1||m===-1)return;const x=[...H.value],[A]=x.splice(h,1);x.splice(m,0,A),H.value=x,re.value=null,te("reorderTerminals",x.map(de=>de.id)),console.log("✅ Reorder complete")}function Ce(){re.value=null}let at=null;return Ta(()=>{at=()=>{O.value&&(F.value=document.documentElement.clientWidth,ie.value=document.documentElement.clientHeight)},window.addEventListener("resize",at)}),Oa(()=>{at&&window.removeEventListener("resize",at)}),(ue,S)=>(d(),C(Dl,{to:"body"},[xe.isOpen?(d(),T("div",Lr,[t(a(Nl),{x:Q.value,"onUpdate:x":S[19]||(S[19]=w=>Q.value=w),y:Ue.value,"onUpdate:y":S[20]||(S[20]=w=>Ue.value=w),w:F.value,"onUpdate:w":S[21]||(S[21]=w=>F.value=w),h:ie.value,"onUpdate:h":S[22]||(S[22]=w=>ie.value=w),active:ye.value,"onUpdate:active":S[23]||(S[23]=w=>ye.value=w),minWidth:800,minHeight:600,maxWidth:a(j),maxHeight:a(he),draggable:!O.value,resizable:!O.value,parent:!1,z:99999,className:O.value?"terminal-manager-window maximized":"terminal-manager-window",classNameActive:"terminal-manager-window-active"},{default:e(()=>[s("div",Br,[s("div",{class:"window-titlebar",onDblclick:L,onMousedown:S[3]||(S[3]=w=>O.value?w.stopPropagation():null)},[s("div",Fr,[t(b,{size:"18",class:"mr-2"},{default:e(()=>[...S[24]||(S[24]=[n("mdi-console-line",-1)])]),_:1}),s("span",Er,c(a(q)("core.terminal.manager.title")),1),t(Ee,{size:"small",color:"success",class:"ml-1 terminal-count-chip"},{default:e(()=>[n(c(xe.terminals.length),1)]),_:1})]),s("div",Pr,[s("div",Mr,[t(B,{variant:le.value==="grid"?"flat":"text",color:le.value==="grid"?"primary":void 0,size:"x-small",height:"24",width:"24",class:"view-toggle-btn",onClick:S[0]||(S[0]=w=>le.value="grid")},{default:e(()=>[t(b,{icon:"mdi-view-grid",size:"18"}),t(Ze,{activator:"parent",location:"bottom"},{default:e(()=>[n(c(a(q)("core.terminal.manager.layoutGrid")),1)]),_:1})]),_:1},8,["variant","color"]),t(B,{variant:le.value==="horizontal"?"flat":"text",color:le.value==="horizontal"?"primary":void 0,size:"x-small",height:"24",width:"24",class:"view-toggle-btn",onClick:S[1]||(S[1]=w=>le.value="horizontal")},{default:e(()=>[t(b,{icon:"mdi-view-column",size:"18"}),t(Ze,{activator:"parent",location:"bottom"},{default:e(()=>[n(c(a(q)("core.terminal.manager.layoutHorizontal")),1)]),_:1})]),_:1},8,["variant","color"]),t(B,{variant:le.value==="vertical"?"flat":"text",color:le.value==="vertical"?"primary":void 0,size:"x-small",height:"24",width:"24",class:"view-toggle-btn",onClick:S[2]||(S[2]=w=>le.value="vertical")},{default:e(()=>[t(b,{icon:"mdi-view-stream",size:"18"}),t(Ze,{activator:"parent",location:"bottom"},{default:e(()=>[n(c(a(q)("core.terminal.manager.layoutVertical")),1)]),_:1})]),_:1},8,["variant","color"])])]),s("div",jr,[t(B,{icon:"",size:"small",variant:"text",color:"",onClick:L,class:"control-btn"},{default:e(()=>[t(b,{size:"16"},{default:e(()=>[n(c(O.value?"mdi-window-restore":"mdi-window-maximize"),1)]),_:1})]),_:1}),t(B,{icon:"",size:"small",variant:"text",color:"",onClick:qe,class:"control-btn close-btn"},{default:e(()=>[t(b,{size:"16"},{default:e(()=>[...S[25]||(S[25]=[n("mdi-close",-1)])]),_:1})]),_:1})])],32),s("div",Or,[le.value==="grid"?(d(),T("div",Nr,[(d(!0),T(De,null,ut(H.value,w=>(d(),T("div",{key:`grid-terminal-${w.id}`,class:ca(["grid-item",{dragging:re.value===w.id}]),style:Ft(He()),onDragover:S[8]||(S[8]=h=>ht(h)),onDrop:h=>dt(h,w.id)},[s("div",{class:"pane-header",draggable:"true",onDragstart:h=>je(h,w.id),onDragend:Ce,onMousedown:S[6]||(S[6]=St(()=>{},["stop"])),style:{cursor:"move"}},[t(b,{size:"16",class:"mr-1 drag-handle"},{default:e(()=>[...S[26]||(S[26]=[n("mdi-drag",-1)])]),_:1}),s("span",Wr,c(w.managerLabel||w.label),1),s("div",Jr,[t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn unpin-btn-manager",onClick:h=>Oe(w.id),onMousedown:S[4]||(S[4]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[27]||(S[27]=[n("mdi-pin-off",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.unpinToTabs")),1)]),_:1})]),_:1},8,["onClick"]),t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn close-btn",onClick:h=>Re(w.id),onMousedown:S[5]||(S[5]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[28]||(S[28]=[n("mdi-close",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.closeTerminal")),1)]),_:1})]),_:1},8,["onClick"])])],40,Hr),s("div",{id:`terminal-${w.id}`,class:"terminal-pane",onMousedown:S[7]||(S[7]=St(()=>{},["stop"]))},null,40,Gr)],46,qr))),128))])):le.value==="horizontal"?(d(),T("div",Kr,[(d(!0),T(De,null,ut(H.value,w=>(d(),T("div",{key:`horiz-terminal-${w.id}`,class:ca(["horizontal-item",{dragging:re.value===w.id}]),style:Ft({width:`${100/H.value.length}%`}),onDragover:S[13]||(S[13]=h=>ht(h)),onDrop:h=>dt(h,w.id)},[s("div",{class:"pane-header",draggable:"true",onDragstart:h=>je(h,w.id),onDragend:Ce,onMousedown:S[11]||(S[11]=St(()=>{},["stop"])),style:{cursor:"move"}},[t(b,{size:"16",class:"mr-1 drag-handle"},{default:e(()=>[...S[29]||(S[29]=[n("mdi-drag",-1)])]),_:1}),s("span",Yr,c(w.managerLabel||w.label),1),s("div",Qr,[t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn unpin-btn-manager",onClick:h=>Oe(w.id),onMousedown:S[9]||(S[9]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[30]||(S[30]=[n("mdi-pin-off",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.unpinToTabs")),1)]),_:1})]),_:1},8,["onClick"]),t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn close-btn",onClick:h=>Re(w.id),onMousedown:S[10]||(S[10]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[31]||(S[31]=[n("mdi-close",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.closeTerminal")),1)]),_:1})]),_:1},8,["onClick"])])],40,Zr),s("div",{id:`terminal-${w.id}`,class:"terminal-pane",onMousedown:S[12]||(S[12]=St(()=>{},["stop"]))},null,40,ei)],46,Xr))),128))])):le.value==="vertical"?(d(),T("div",ti,[(d(!0),T(De,null,ut(H.value,w=>(d(),T("div",{key:`vert-terminal-${w.id}`,class:ca(["vertical-item",{dragging:re.value===w.id}]),style:Ft({height:`${100/H.value.length}%`}),onDragover:S[18]||(S[18]=h=>ht(h)),onDrop:h=>dt(h,w.id)},[s("div",{class:"pane-header",draggable:"true",onDragstart:h=>je(h,w.id),onDragend:Ce,onMousedown:S[16]||(S[16]=St(()=>{},["stop"])),style:{cursor:"move"}},[t(b,{size:"16",class:"mr-1 drag-handle"},{default:e(()=>[...S[32]||(S[32]=[n("mdi-drag",-1)])]),_:1}),s("span",oi,c(w.managerLabel||w.label),1),s("div",si,[t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn unpin-btn-manager",onClick:h=>Oe(w.id),onMousedown:S[14]||(S[14]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[33]||(S[33]=[n("mdi-pin-off",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.unpinToTabs")),1)]),_:1})]),_:1},8,["onClick"]),t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"control-btn close-btn",onClick:h=>Re(w.id),onMousedown:S[15]||(S[15]=St(()=>{},["stop"]))},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...S[34]||(S[34]=[n("mdi-close",-1)])]),_:1}),t(Ze,{activator:"parent",location:"left"},{default:e(()=>[n(c(a(q)("core.terminal.manager.closeTerminal")),1)]),_:1})]),_:1},8,["onClick"])])],40,li),s("div",{id:`terminal-${w.id}`,class:"terminal-pane",onMousedown:S[17]||(S[17]=St(()=>{},["stop"]))},null,40,ni)],46,ai))),128))])):I("",!0)])])]),_:1},8,["x","y","w","h","active","maxWidth","maxHeight","draggable","resizable","className"])])):I("",!0)]))}},ii=aa(ri,[["__scopeId","data-v-52918792"]]),ui={class:"d-flex w-100 align-center justify-space-between border-frame"},di={class:"d-flex align-center"},ci={class:"text-h5"},pi={class:"d-flex flex-wrap align-center"},mi={class:"d-flex flex-wrap align-center ml-auto"},fi={class:"text-caption terminal-tab-text"},vi={class:"d-flex align-center"},gi={__name:"Terminal",props:{appSpec:{type:Object,required:!0},selectedIp:{type:String,required:!0},logout:{type:Function,required:!0}},setup(xe){const f=xe,{t:i}=pa(),te=ol(),q=$e(()=>{const w=te.global.name.value==="light";return{background:"#000000",foreground:"#ffffff",cursor:"#ffffff",cursorAccent:"#000000"}}),j=p("success"),he=p(!1),ge=p(""),ne=p(""),pe=p(!1),M=p([]),Q=p(null);let Ue=0;const F=p([]),ie=p([]),ye=p(!1),O=p(null),le=p(null),N=p(""),H=p(""),re=p(""),oe=p(!1),G=p(!1),Le=$e(()=>f.appSpec?.version<=3?!0:f.appSpec.compose?.length===1);ja(()=>{f.appSpec&&f.appSpec?.version<=3?O.value=f.appSpec.name:f.appSpec&&f.appSpec?.compose&&f.appSpec?.compose.length<2&&(O.value=f.appSpec?.compose[0].name)});function se(){const w=++Ue,h=f.appSpec.version>3?`${O.value}_${f.appSpec.name}`:f.appSpec.name,m={id:w,terminal:null,socket:null,element:null,isConnecting:!0,isVisible:!1,isClosing:!1,isPoppedOut:!1,popoutWindow:null,selectedApp:O.value,selectedCmd:le.value,customValue:N.value,userInputValue:H.value,envInputValue:re.value,enableUser:oe.value,enableEnvironment:G.value,fitAddon:null,label:`${O.value} - ${le.value==="Custom"?N.value:le.value}`,managerLabel:`${O.value} - ${le.value==="Custom"?N.value:le.value} (${new Date().toLocaleTimeString()})`};M.value.push(m),Q.value=w,it(()=>{setTimeout(()=>{const x=M.value.find(A=>A.id===w);x&&x.element?Te(w,h):(console.error("Terminal element not ready for terminal ID:",w),L(w))},50)})}function Te(w,h){const m=M.value.find(Ve=>Ve.id===w);if(!m)return;if(!m.element){console.error("Terminal element not available for terminal ID:",w),Ce("danger","Terminal element not ready"),L(w);return}if(f.appSpec.version>=4&&!f.appSpec.compose?.some(Ge=>Ge.name===m.selectedApp)){Ce("danger",i("core.terminal.errors.selectContainer")),L(w);return}if(!m.selectedCmd||m.selectedCmd==="Custom"&&!m.customValue){Ce("danger",m.selectedCmd==="Custom"?i("core.terminal.errors.enterCustomCommand"):i("core.terminal.errors.noCommandSelected")),L(w);return}async function x(Ve=!1){if(!m.terminal)return;const Ge=m.terminal.getSelectionPosition();if(!Ge||!Ge.start||!Ge.end)return;const{start:Ke,end:Rt}=Ge,Yt=m.terminal.buffer.active,Ct=[],Be=Math.max(0,Ke.y),Mt=Math.min(Yt.length-1,Rt.y);for(let Qe=Be;Qe<=Mt;Qe++){const It=Yt.getLine(Qe);if(!It)continue;const Ut=It.translateToString(!1);Qe===Be&&Qe===Mt?Ct.push(Ut.slice(Ke.x,Rt.x)):Qe===Be?Ct.push(Ut.slice(Ke.x)):Qe===Mt?Ct.push(Ut.slice(0,Rt.x)):Ct.push(Ut)}const Ye=Ct.join(`
`);if(Ye)try{await navigator.clipboard.writeText(Ye),Ce("success",i("core.terminal.copiedToClipboard"),"mdi-content-copy"),m.terminal.clearSelection()}catch{A(Ye,Ve)}}function A(Ve,Ge){try{const Ke=document.createElement("textarea");Ke.style.position="absolute",Ke.style.left="-9999px",Ke.style.opacity="0",Ke.value=Ve,document.body.appendChild(Ke),Ke.focus(),Ke.select();const Rt=document.execCommand("copy");document.body.removeChild(Ke),Rt?(Ce("success",i("core.terminal.copiedToClipboard"),"mdi-content-copy"),m.terminal.clearSelection()):Ge?Ce("error",i("core.terminal.errors.clipboardInaccessible"),"mdi-alert"):Ce("warning",i("core.terminal.warnings.clipboardHttps"),"mdi-alert")}catch(Ke){console.error("Fallback execCommand exception:",Ke),Ge?Ce("error",i("core.terminal.errors.clipboardError"),"mdi-alert"):Ce("warning",i("core.terminal.warnings.clipboardHttps"),"mdi-alert")}}m.isConnecting=!0;const de=localStorage.getItem("zelidauth"),[E,ce=16127]=f.selectedIp.split(":"),Pe=pe.value?`http://${E}:${ce}/terminal`:`https://${E.replace(/\./g,"-")}-${ce}.node.api.runonflux.io/terminal`;m.socket=Ol.connect(Pe),m.terminal=new Fl.Terminal({allowProposedApi:!0,cursorBlink:!0,theme:q.value}),m.fitAddon=new El.FitAddon,m.terminal.loadAddon(m.fitAddon),m.terminal.loadAddon(new Pl.WebLinksAddon),m.terminal.loadAddon(new Ml.Unicode11Addon),m.terminal.loadAddon(new jl.SerializeAddon),m.terminal._initialized=!0,m.terminal.open(m.element),m.terminal.onResize(({cols:Ve,rows:Ge})=>{m.socket&&m.socket.emit("resize",{cols:Ve,rows:Ge})}),m.terminal.onData(Ve=>{m.socket&&m.socket.emit("cmd",Ve)});function Je(Ve,Ge){let Ke;return function(...Rt){clearTimeout(Ke),Ke=setTimeout(()=>Ve.apply(this,Rt),Ge)}}let At=!1;m.terminal.onSelectionChange(Je(()=>{if(!At){At=!0,m.terminal.focus();try{x()}finally{setTimeout(()=>{At=!1},300)}}},200));const lt=m.enableUser?m.userInputValue:"",ct=m.customValue||m.selectedCmd;let pt=0,be=0;m.socket.emit("exec",de,h,ct,m.envInputValue,lt),m.socket.on("error",Ve=>{if(console.error("❌ Socket error event:",Ve),(typeof Ve=="string"?Ve:Ve?.message||String(Ve)).toLowerCase().includes("not authorized")){console.warn("🔒 Authorization error detected, triggering logout"),m.isConnecting=!1,L(w),f.logout&&typeof f.logout=="function"&&f.logout();return}Ce("danger",i("core.terminal.errors.connectionError",{error:Ve})),m.isConnecting=!1,L(w)}),m.socket.on("connect_error",Ve=>{console.error("❌ Socket connect_error event:",Ve.message,Ve),Ce("danger",i("core.terminal.errors.connectionErrorWithMessage",{message:Ve.message})),m.isConnecting=!1,L(w)}),m.socket.on("connect_timeout",()=>{console.error("⏱️ Socket connect_timeout event"),Ce("danger",i("core.terminal.errors.connectionTimeout")),m.isConnecting=!1,L(w)}),m.socket.on("show",Ve=>{if(typeof Ve=="string"&&pt===0&&Ve.includes("OCI runtime exec")){be=1,console.warn("⚠️ OCI runtime exec error detected, disconnecting"),Ce("danger",i("core.terminal.errors.commandNotSupported",{cmd:ct})),L(w);return}pt===0&&(pt=1,m.customValue||(m.socket.emit("cmd",`export TERM=xterm
`),m.selectedCmd==="/bin/bash"&&m.socket.emit("cmd",`PS1="\\[\\033[01;31m\\]\\u\\[\\033[01;33m\\]@\\[\\033[01;36m\\]\\h \\[\\033[01;33m\\]\\w \\[\\033[01;35m\\]\\$ \\[\\033[00m\\]"
`),m.socket.emit("cmd",`alias ls='ls --color'
`),m.socket.emit("cmd",`alias ll='ls -alF'
`)),setTimeout(()=>{it(()=>{setTimeout(()=>{m.isConnecting=!1,m.isVisible=!0,m.terminal.clear(),it(()=>{m.terminal.focus(),setTimeout(()=>{m.fitAddon.fit(),m.socket.emit("resize",{cols:m.terminal.cols,rows:m.terminal.rows})},100)})},500)})},1400)),m.terminal.write(Ve)}),m.socket.on("disconnect",Ve=>{console.warn("🔌 Socket disconnect event, reason:",Ve),be||Ce("warning",i("core.terminal.warnings.disconnected")),L(w)}),m.socket.on("end",()=>{L(w)}),m.socket.on("connect",()=>{})}function L(w){console.log("closeTerminal called with ID:",w);const h=M.value.find(m=>m.id===w);if(!h){console.warn("Terminal not found with ID:",w);return}if(h.isClosing){console.log("Terminal is already closing, ignoring duplicate call");return}if(h.isClosing=!0,console.log("Closing terminal:",h.label),h.socket&&(console.log("Disconnecting socket..."),h.socket.removeAllListeners(),h.socket.disconnect(),h.socket=null),h.terminal){console.log("Disposing terminal...");try{h.terminal.dispose(),console.log("✅ Terminal disposed successfully")}catch(m){m.message&&m.message.includes("Could not dispose an addon")?console.warn("⚠️ Harmless addon disposal warning (occurs after unpinning):",m.message):console.error("❌ Error disposing terminal:",m)}h.terminal=null,h.fitAddon=null}if(h.element&&(h.element=null),Q.value===w){const m=M.value.filter(x=>x.id!==w);m.length>0?(Q.value=m[0].id,console.log("Switched to terminal ID:",Q.value)):(Q.value=null,console.log("No terminals remaining"))}it(()=>{const m=M.value.findIndex(x=>x.id===w);console.log("Terminal index in array:",m,"Total terminals before removal:",M.value.length),m!==-1&&(M.value=M.value.filter(x=>x.id!==w),console.log("Terminal removed. Remaining terminals:",M.value.length),console.log("Remaining terminal IDs:",M.value.map(x=>x.id)))})}function qe(w){console.log("unpinTerminal called with ID:",w);const h=M.value.find(m=>m.id===w);if(!h){console.warn("Terminal not found with ID:",w);return}if(h.isPoppedOut){console.log("Terminal already popped out, skipping");return}h.isPoppedOut=!0,ie.value.includes(w)||ie.value.push(w),F.value.push({id:w,label:h.label,managerLabel:h.managerLabel}),ye.value=!0,Ce("success",`Terminal "${h.label}" moved to terminal manager`)}function Oe(){console.log("🪟 Unpinning all terminals to manager");const w=M.value.filter(h=>!h.isPoppedOut);if(w.length===0){console.log("No terminals to unpin");return}w.forEach(h=>{h.isPoppedOut=!0,ie.value.includes(h.id)||ie.value.push(h.id),F.value.find(m=>m.id===h.id)||F.value.push({id:h.id,label:h.label,managerLabel:h.managerLabel})}),ye.value=!0,Ce("success",`${w.length} terminals moved to manager`)}function Re(w){console.log("🔄 Reordering terminals:",w);const h=[];w.forEach(m=>{const x=M.value.find(A=>A.id===m);x&&h.push(x)}),M.value.forEach(m=>{h.find(x=>x.id===m.id)||h.push(m)}),M.value=h,console.log("✅ Terminals reordered")}function He(w){console.log("=== moveTerminalToManager called for ID:",w);const h=M.value.find(m=>m.id===w);if(!h){console.error("❌ Terminal data not found for ID:",w),console.log("Available terminals:",M.value.map(m=>m.id));return}if(!h.terminal){console.error("❌ Terminal instance not ready for ID:",w);return}console.log("✅ Terminal found, isPoppedOut:",h.isPoppedOut),setTimeout(()=>{const m=document.getElementById(`terminal-${w}`);if(console.log("📦 Looking for container with ID:",`terminal-${w}`),console.log("📦 Container found:",!!m),m&&(console.log("📦 Container dimensions:",m.clientWidth,"x",m.clientHeight),console.log("📦 Container parent:",m.parentElement?.className)),!m){console.error("❌ Container not found in manager");const x=document.querySelectorAll('[id^="terminal-"]');console.log("🔍 All terminal containers in DOM:",Array.from(x).map(A=>({id:A.id,parent:A.parentElement?.className})));return}if(m.clientWidth===0||m.clientHeight===0){console.warn("⚠️ Container has zero dimensions, retrying in 200ms..."),setTimeout(()=>He(w),200);return}try{const x=m.querySelector(".xterm");if(x&&(console.log("♻️ Terminal already in container, just resizing"),x.querySelector(".xterm-viewport"))){console.log("✅ Confirmed: correct terminal already in container"),setTimeout(()=>{try{h.fitAddon.fit(),h.terminal.focus(),console.log("✅ Terminal resized after layout change")}catch(ce){console.error("❌ Error fitting terminal:",ce)}},100);return}console.log("🚚 Moving terminal to manager container");let A=null,de=null;if(h.element&&(A=h.element.querySelector(".xterm"),A&&(de=h.element,console.log("📍 Found xterm in main container"))),!A){console.log("🔍 Searching for xterm in old layout containers...");const E=document.querySelectorAll(`[id="terminal-${w}"]`);console.log(`   Found ${E.length} containers with id terminal-${w}`),E.forEach(ce=>{if(ce===m){console.log("   Skipping target container");return}const Pe=ce.querySelector(".xterm");Pe&&(A=Pe,de=ce,console.log("📍 Found xterm in old layout container"),console.log("   Parent class:",ce.parentElement?.className))})}if(console.log("🔍 Found xterm element:",!!A),console.log("📍 Old container:",de?.id||de?.className),A){console.log("✅ Moving existing xterm DOM element"),console.log("   From:",de.id||de.className),console.log("   To:",m.id),de.removeChild(A),console.log("✅ Removed from old container"),m.appendChild(A),console.log("✅ Added to new container");const E=m.querySelector(".xterm");console.log("✅ Verification - xterm in new container:",!!E)}else console.warn("⚠️ No xterm element found, calling terminal.open()"),h.terminal.open(m);setTimeout(()=>{try{h.fitAddon.fit(),h.terminal.focus(),console.log("✅ Terminal resized and focused in manager")}catch(E){console.error("❌ Error fitting terminal:",E)}},150)}catch(x){console.error("❌ Error moving terminal to manager:",x),console.error("Stack:",x.stack)}},300)}function je(){console.log("Closing terminal manager, pinning all terminals back"),[...ie.value].forEach(h=>{S(h)}),ye.value=!1}function ht(w){console.log("Unpinning terminal from manager:",w),S(w),it(()=>{F.value.length===0&&(console.log("No more terminals in manager, closing window"),ye.value=!1)})}function dt(w){console.log("Closing terminal from manager:",w);const h=M.value.find(A=>A.id===w),m=F.value.findIndex(A=>A.id===w);m>-1&&F.value.splice(m,1);const x=ie.value.indexOf(w);x>-1&&ie.value.splice(x,1),h&&(h.isPoppedOut=!1),L(w),F.value.length===0&&(console.log("No more terminals in manager, closing window"),ye.value=!1)}function Ce(w,h,m=null){ne.value=h,j.value=w==="danger"?"error":w,ge.value=m||{success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information",danger:"mdi-alert-circle"}[w]||"mdi-information",he.value=!0}bt(Q,(w,h)=>{w&&(console.log("🔄 Active terminal changed from",h,"to",w),it(()=>{setTimeout(()=>{const m=M.value.find(A=>A.id===w);if(!m||!m.fitAddon||!m.element){console.log("   Terminal not ready for fitting");return}const x=m.element;x.clientWidth>0&&x.clientHeight>0?(console.log("📏 Fitting newly active terminal",w),console.log("   Container dimensions:",x.clientWidth,"x",x.clientHeight),m.fitAddon.fit(),console.log("   Terminal fitted to",m.terminal.cols,"x",m.terminal.rows)):console.log("⚠️ Container still has zero dimensions for terminal",w)},100)}))}),bt(()=>te.global.name.value,()=>{console.log("🎨 Theme changed, updating all terminals"),M.value.forEach(w=>{w.terminal&&(w.terminal.options.theme=q.value)})});let at=null;Ta(()=>{const{hostname:w}=window.location,h=/[A-Z]/gi;w.match(h)?pe.value=!1:pe.value=!0,it(()=>{const x=M.value.filter(E=>!E.socket||!E.socket.connected);x.length>0&&(console.log(`🧹 Cleaning up ${x.length} stale terminal(s) after page refresh`),x.forEach(E=>{M.value=M.value.filter(ce=>ce.id!==E.id),ie.value=ie.value.filter(ce=>ce!==E.id),F.value=F.value.filter(ce=>ce.id!==E.id)}),M.value.length>0?Q.value=M.value[0].id:Q.value=null);const A=M.value.map(E=>E.id),de=F.value.length;F.value=F.value.filter(E=>A.includes(E.id)),F.value.length<de&&console.log(`🧹 Cleaned up ${de-F.value.length} orphaned floating terminal entries`)});let m=null;at=()=>{m&&clearTimeout(m),m=setTimeout(()=>{const x=M.value.find(A=>A.id===Q.value);x&&x.fitAddon&&x.isVisible&&x.fitAddon.fit()},150)},window.addEventListener("resize",at),window.addEventListener("message",ue)});function ue(w){}function S(w){console.log("=== 📌 pinBackTerminal called for ID:",w);const h=M.value.find(Pe=>Pe.id===w);if(!h){console.error("❌ Terminal not found with ID:",w),console.log("Available terminals:",M.value.map(Pe=>({id:Pe.id,label:Pe.label})));return}if(console.log("✅ Terminal found:",h.label,"isPoppedOut:",h.isPoppedOut),!h.isPoppedOut){console.log("⚠️ Terminal already pinned back, skipping");return}console.log("🚚 Starting DOM element move back to main view - FIRST before removing from arrays");const m=h.element;if(console.log("📦 Main container:",m),!m){console.error("❌ Main container (termData.element) not found");return}let x=null,A=null;const de=document.getElementById(`terminal-${w}`);if(de&&de!==m&&(A=de.querySelector(".xterm"),A&&(x=de,console.log("✅ Found xterm in specific manager container:",de.id))),!A){console.log("🔍 Searching all terminal containers for xterm element...");const Pe=document.querySelectorAll('[id^="terminal-"]');console.log("📋 All terminal containers found:",Pe.length);for(const Je of Pe){if(Je===m)continue;const At=Je.querySelector(".xterm");if(At&&Je.id===`terminal-${w}`){A=At,x=Je,console.log("✅ Found xterm in container:",Je.id);break}}}if(!A){console.error("❌ XTerm element not found in manager"),console.log('🔍 Debug: Listing all containers with class or id containing "terminal":'),document.querySelectorAll('[id*="terminal"], [class*="terminal"]').forEach(Pe=>{console.log("  -",Pe.id||Pe.className,"has .xterm:",!!Pe.querySelector(".xterm"))});return}console.log("✅ Found xterm element, extracting NOW"),x.removeChild(A),console.log("✅ Removed xterm from manager container");const E=ie.value.indexOf(w);E>-1&&(ie.value.splice(E,1),console.log("✅ Removed from poppedOutTerminals array"));const ce=F.value.findIndex(Pe=>Pe.id===w);ce>-1&&(F.value.splice(ce,1),console.log("✅ Removed from floatingTerminalsData array")),h.isPoppedOut=!1,console.log("✅ Set isPoppedOut=false"),Q.value=w,console.log("✅ Set as active terminal:",w),it(()=>{setTimeout(()=>{console.log("📦 Main container display after Vue update:",window.getComputedStyle(m).display),console.log("📦 Main container dimensions after Vue update:",m.clientWidth,"x",m.clientHeight),Pe();function Pe(){try{console.log("✅ Adding xterm to main container"),console.log("📦 Main container display:",window.getComputedStyle(m).display),console.log("📦 Main container dimensions:",m.clientWidth,"x",m.clientHeight),m.appendChild(A),console.log("✅ Added xterm to main container");const Je=m.querySelector(".xterm");if(Je){Je.style.width="",Je.style.height="";const lt=Je.querySelector(".xterm-viewport"),ct=Je.querySelector(".xterm-screen");lt&&(lt.style.width="",lt.style.height=""),ct&&(ct.style.width="",ct.style.height="");const pt=Je.querySelectorAll("canvas");pt.forEach(be=>{be.style.width="",be.style.height=""}),console.log("✅ Reset xterm inline styles (including",pt.length,"canvas elements)")}const At=m.querySelector(".xterm");console.log("✅ Verification - xterm now in main container:",!!At),setTimeout(()=>{try{console.log("📦 Container dimensions before fit:",m.clientWidth,"x",m.clientHeight),console.log("📺 Terminal cols x rows before fit:",h.terminal.cols,"x",h.terminal.rows),console.log("🔧 Fitting terminal to main container...");const lt=m.querySelector(".xterm");lt&&(lt.style.width="",lt.style.height="",lt.querySelectorAll("canvas").forEach(pt=>{pt.style.width="",pt.style.height=""}),console.log("✅ Reset xterm inline styles")),m.clientWidth>0&&m.clientHeight>0?(h.fitAddon.fit(),console.log("📺 Terminal fitted:",h.terminal.cols,"x",h.terminal.rows),h.terminal.focus(),console.log("✅ Terminal fitted and focused in main view"),setTimeout(()=>{h.fitAddon.fit(),console.log("📺 Final fit:",h.terminal.cols,"x",h.terminal.rows)},300)):console.log("⚠️ Container not visible, will fit when tab becomes active")}catch(lt){console.error("❌ Error fitting terminal:",lt)}},150)}catch(Je){console.error("❌ Error adding terminal to main view:",Je),console.error("Stack:",Je.stack)}}},100)}),console.log("📣 Showing success toast"),Ce("success",`Terminal "${h.label}" pinned back`)}return Oa(()=>{at&&window.removeEventListener("resize",at),window.removeEventListener("message",ue),M.value.forEach(w=>{L(w.id)})}),(w,h)=>(d(),T(De,null,[t(et,{class:"align-center justify-space-between mb-1"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center"},{default:e(()=>[s("div",ui,[s("div",di,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...h[10]||(h[10]=[n(" mdi-console ",-1)])]),_:1})]),_:1}),s("span",ci,c(a(i)("core.terminal.title")),1)]),M.value.filter(m=>!m.isPoppedOut).length>1?(d(),C(Ze,{key:0,location:"bottom"},{activator:e(({props:m})=>[t(B,wt({icon:"",variant:"tonal",density:"comfortable",color:"success",class:"mr-4 import-glow-btn border-frame-btn"},m,{onClick:Oe}),{default:e(()=>[t(b,{size:"22"},{default:e(()=>[...h[11]||(h[11]=[n("mdi-window-restore",-1)])]),_:1})]),_:1},16)]),default:e(()=>[s("span",null,c(a(i)("core.terminal.popOutAll")),1)]),_:1})):I("",!0)])]),_:1})]),_:1}),t(et,{class:"mb-3",align:"center",dense:""},{default:e(()=>[xe.appSpec?.name?(d(),C(me,{key:0,cols:"12",class:"d-flex flex-wrap align-center justify-space-between"},{default:e(()=>[s("div",pi,[t(Gt,{modelValue:O.value,"onUpdate:modelValue":h[0]||(h[0]=m=>O.value=m),items:xe.appSpec?.compose?xe.appSpec.compose.map(m=>m.name):[xe.appSpec.name],label:a(i)("core.terminal.selectComponent"),dense:"",density:"comfortable",disabled:Le.value,class:"mr-3 mb-2",style:{"min-width":"250px"}},null,8,["modelValue","items","label","disabled"]),t(Gt,{modelValue:le.value,"onUpdate:modelValue":h[1]||(h[1]=m=>le.value=m),items:["/bin/bash","/bin/sh","Custom"],label:a(i)("core.terminal.selectCommand"),dense:"",density:"comfortable",class:"mr-3 mb-2",style:{"min-width":"200px"}},null,8,["modelValue","label"]),t(B,{color:"success",disabled:!le.value||le.value==="Custom"&&!N.value,density:"compact",size:"large",class:"text-subtitle-1 mr-2 mb-2",onClick:se},{default:e(()=>[t(b,{class:"mr-1"},{default:e(()=>[...h[12]||(h[12]=[n("mdi-plus",-1)])]),_:1}),n(" "+c(a(i)("core.terminal.newTerminal")),1)]),_:1},8,["disabled"])]),s("div",mi,[t(ga,{modelValue:oe.value,"onUpdate:modelValue":h[2]||(h[2]=m=>oe.value=m),label:a(i)("core.terminal.user"),dense:"",class:"ml-2 mr-4"},null,8,["modelValue","label"]),t(ga,{modelValue:G.value,"onUpdate:modelValue":h[3]||(h[3]=m=>G.value=m),label:a(i)("core.terminal.environment"),dense:"",class:"mr-2"},null,8,["modelValue","label"])])]),_:1})):I("",!0),le.value==="Custom"?(d(),C(me,{key:1,cols:"12",md:"6"},{default:e(()=>[t(Zt,{modelValue:N.value,"onUpdate:modelValue":h[4]||(h[4]=m=>N.value=m),label:a(i)("core.terminal.customCommand"),dense:"",density:"comfortable"},null,8,["modelValue","label"])]),_:1})):I("",!0),oe.value?(d(),C(me,{key:2,cols:"12"},{default:e(()=>[t(Zt,{modelValue:H.value,"onUpdate:modelValue":h[5]||(h[5]=m=>H.value=m),label:a(i)("core.terminal.userUid"),dense:"",density:"comfortable"},null,8,["modelValue","label"])]),_:1})):I("",!0),G.value?(d(),C(me,{key:3,cols:"12"},{default:e(()=>[t(Zt,{modelValue:re.value,"onUpdate:modelValue":h[6]||(h[6]=m=>re.value=m),label:a(i)("core.terminal.environmentVariables"),dense:"",density:"comfortable","persistent-hint":""},null,8,["modelValue","label"])]),_:1})):I("",!0)]),_:1}),M.value.length>0?(d(),C(et,{key:0,class:"mt-2 mb-0"},{default:e(()=>[t(me,{cols:"12",class:"pb-2 d-flex align-center"},{default:e(()=>[t(Sa,{modelValue:Q.value,"onUpdate:modelValue":h[7]||(h[7]=m=>Q.value=m),color:"primary","align-tabs":"start",class:"terminal-tabs","hide-slider":"",style:{flex:"1"}},{default:e(()=>[(d(!0),T(De,null,ut(M.value.filter(m=>!m.isPoppedOut),m=>(d(),C(_a,{key:m.id,value:m.id,class:"terminal-tab"},{default:e(()=>[s("span",fi,c(m.label),1),t(B,{icon:"",size:"x-small",variant:"text",class:"ml-2 unpin-btn",onClick:St(x=>qe(m.id),["stop"])},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...h[13]||(h[13]=[n("mdi-open-in-new",-1)])]),_:1})]),_:1},8,["onClick"]),t(B,{icon:"",size:"x-small",variant:"text",color:"",class:"ml-1 tab-close-btn",onClick:St(x=>L(m.id),["stop"])},{default:e(()=>[t(b,{size:"14"},{default:e(()=>[...h[14]||(h[14]=[n("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),M.value.length>0?(d(),C(et,{key:1,class:"mt-0"},{default:e(()=>[t(me,{cols:"12"},{default:e(()=>[(d(!0),T(De,null,ut(M.value,m=>Ie((d(),T("div",{key:`loader-${m.id}`,class:"terminal-loading-wrapper"},[t(rl,{icon:"mdi-console",title:"Connecting to terminal...",message:""})])),[[za,Q.value===m.id&&m.isConnecting&&!m.isVisible]])),128)),(d(!0),T(De,null,ut(M.value,m=>Ie((d(),T("div",{key:`terminal-${m.id}`,ref_for:!0,ref:x=>{x&&(m.element=x)},class:"terminal-container"})),[[za,Q.value===m.id&&m.isVisible&&!m.isPoppedOut]])),128))]),_:1})]),_:1})):I("",!0),t(Va,{modelValue:he.value,"onUpdate:modelValue":h[8]||(h[8]=m=>he.value=m),color:j.value,timeout:"4000",location:"top",elevation:"4"},{default:e(()=>[s("div",vi,[t(b,{class:"mr-1"},{default:e(()=>[n(c(ge.value),1)]),_:1}),s("span",null,c(ne.value),1)])]),_:1},8,["modelValue","color"]),t(ii,{terminals:F.value,isOpen:ye.value,onCloseWindow:je,onUnpinTerminal:ht,onCloseTerminal:dt,onTerminalReady:He,onReorderTerminals:Re,"onUpdate:isOpen":h[9]||(h[9]=m=>ye.value=m)},null,8,["terminals","isOpen"])],64))}},yi=aa(gi,[["__scopeId","data-v-572853ad"]]),bi={class:"d-flex w-100 align-center border-frame"},hi={class:"d-flex align-center"},wi={class:"text-h5"},xi={class:"d-flex flex-column"},ki={class:"d-flex align-center mb-4",style:{gap:"8px"}},_i={class:"d-flex flex-column"},$i={class:"text-caption"},Ci={class:"text-caption"},zi={class:"text-caption"},Si={class:"text-caption"},Ai={class:"text-caption"},Vi=["onClick"],Ti={key:0,class:"log-entry"},Ri={key:1,class:"no-matches"},Ii={__name:"LogViewer",props:{appSpecification:{type:Object,required:!0},executeLocalCommand:{type:Function,required:!0}},setup(xe){const f=xe,{t:i}=pa(),te=p([]),q=p(null),j=p([]),he=p(!1),ge=p(""),ne=p(!1),pe=p(100),M=p(""),Q=p(!1),Ue=p(!1),F=p(!0),ie=p(!0),ye=p(!1),O=p(!1),le=p(null),N=p(null),H=p(null),re=p(""),oe=p(!1),G=p(0),Le=p(0),se=p(!1),Te=p(!1),L=$e(()=>f.appSpecification?.version<=3?!0:f.appSpecification.compose?.length===1);ja(()=>{se.value||(f.appSpecification&&f.appSpecification?.version<=3?(q.value=f.appSpecification.name,Ce(),se.value=!0):f.appSpecification&&f.appSpecification?.compose&&f.appSpecification?.compose.length<2&&(q.value=f.appSpecification?.compose[0].name,Ce(),se.value=!0))});const qe=$e(()=>{if(!re.value.trim())return te.value;const x=re.value.toLowerCase();return te.value.filter(A=>A.toLowerCase().includes(x))}),Oe=$e(()=>f.appSpecification.compose?.map(x=>x.name)||[]);function Re(x){return x.split(" ")[0]}function He(x){const A=Re(x),de=j.value.indexOf(A);de!==-1?j.value.splice(de,1):j.value.push(A)}function je(){j.value=[]}function ht(x){const A=new ql;if(!x)return"";if(F.value){const[de,...E]=x.split(" "),ce=E.join(" ");return`<span style="
      background-color: rgba(25, 135, 84, 0.1);
      color: rgb(var(--v-theme-success)) !important;
      border-radius: 3px; 
      padding: 1px 4px 1px 4px; 
      width: 179px; 
      text-align: 
      center; font-family: monospace;
    ">${de}</span> - ${A.toHtml(ce)}`}else{const de=/^[^\s]+\s*/;return A.toHtml(x.replace(de,""))}}function dt(){let x=Ue.value&&j.value.length?qe.value.filter(A=>j.value.includes(Re(A))).join(`
`):te.value.join(`
`);if(x=x.replace(/\x1B\[[0-9;]*[a-z]/gi,""),!F.value){const A=/^\S+\s*/;x=x.split(/\r?\n/).map(de=>de.replace(A,"")).join(`
`)}ge.value=x,it(()=>{const A=H.value?.$el;if(!A){console.error("copyBtn $el not found");return}A.setAttribute("data-clipboard-text",ge.value);const de=new il(A);de.on("success",()=>{he.value=!0,setTimeout(()=>he.value=!1,2e3),de.destroy()}),de.on("error",E=>{console.error("ClipboardJS failed:",E),de.destroy()}),A.click()})}async function Ce(){ye.value=!0,await at(),ye.value=!1}async function at(){if(!q.value)return;const x=f.appSpecification?.compose?`${q.value}_${f.appSpecification.name}`:f.appSpecification.name;if(!O.value){O.value=!0,oe.value=!1;try{const A=Te.value?"all":pe.value||100,E=(await f.executeLocalCommand(`/apps/applogpolling/${x}/${A}/${M.value}`))?.data??{};te.value=Array.isArray(E?.logs)?E.logs:[],E?.status==="success"&&te.value.length===0&&(oe.value=!0),it(()=>{ie.value&&N.value&&(N.value.scrollTop=N.value.scrollHeight)})}catch(A){console.error("Failed to fetch logs:",A),S()}finally{O.value=!1}}}function ue(){S(),le.value=setInterval(()=>at(),3e3)}function S(){le.value&&(clearInterval(le.value),le.value=null)}function w(){Q.value?ue():S()}function h(){q.value&&Ce()}async function m(x){G.value=0,Le.value=0;const de={headers:{zelidauth:localStorage.getItem("zelidauth")},responseType:"blob",onDownloadProgress:E=>{G.value=E.loaded,Le.value=E.total,G.value===Le.value&&setTimeout(()=>{G.value=0,Le.value=0},5e3)}};try{ne.value=!0;const E=await f.executeLocalCommand(`/apps/applogpolling/${x}/all`,null,de);let ce;if(E.data instanceof Blob){const pt=await E.data.text();ce=JSON.parse(pt).logs}else ce=E.data.logs;if(!Array.isArray(ce)||ce.length===0)throw new Error(i("core.logViewer.errors.noLogsToDownload"));const Pe=/\u001b\[[0-9;]*[a-z]/gi;if(ce=ce.map(pt=>pt.replace(Pe,"")),!F.value){const pt=/^\S+\s*/;ce=ce.map(be=>be.replace(pt,""))}const Je=new Blob([ce.join(`
`)],{type:"text/plain"}),At=URL.createObjectURL(Je),lt=document.createElement("a"),ct=`app-${x}-${new Date().toISOString().replace(/[:.]/g,"-")}.log`;lt.href=At,lt.setAttribute("download",ct),document.body.appendChild(lt),lt.click(),document.body.removeChild(lt),setTimeout(()=>URL.revokeObjectURL(At),1e3),ne.value=!1}catch(E){ne.value=!1,console.error("Download error:",E),showToast("danger",E.message||E)}}return Oa(()=>{S()}),(x,A)=>{const de=sl("sanitize-html");return d(),T("div",null,[t(et,{class:"align-center justify-space-between mb-2"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center"},{default:e(()=>[s("div",bi,[s("div",hi,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[...A[12]||(A[12]=[n(" mdi-file-search-outline ",-1)])]),_:1})]),_:1}),s("span",wi,c(a(i)("core.logViewer.title")),1)])])]),_:1})]),_:1}),t(et,{dense:""},{default:e(()=>[t(me,{cols:"12",md:"8"},{default:e(()=>[s("div",xi,[s("div",ki,[f?.appSpecification?(d(),C(Gt,{key:0,modelValue:q.value,"onUpdate:modelValue":[A[0]||(A[0]=E=>q.value=E),h],items:Oe.value,label:q.value?a(i)("core.logViewer.component"):a(i)("core.logViewer.selectComponent"),disabled:L.value,dense:"",density:"comfortable","hide-details":"",style:{"max-width":"350px","margin-bottom":"0"}},{"prepend-inner":e(()=>[t(b,{icon:"mdi-docker",size:"20"})]),_:1},8,["modelValue","items","label","disabled"])):I("",!0),t(B,{loading:ye.value||Q.value,disabled:O.value||Q.value,icon:"",color:"success",density:"comfortable",variant:"tonal",onClick:Ce},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...A[13]||(A[13]=[n(" mdi-refresh ",-1)])]),_:1})]),_:1},8,["loading","disabled"])]),t(Zt,{modelValue:pe.value,"onUpdate:modelValue":[A[1]||(A[1]=E=>pe.value=E),Ce],type:"number",label:a(i)("core.logViewer.lineCount"),dense:"",density:"comfortable","hide-details":"",class:"mb-4",style:{"max-width":"210px"}},{"prepend-inner":e(()=>[t(b,{icon:"mdi-counter",size:"20"})]),_:1},8,["modelValue","label"]),t(Zt,{modelValue:M.value,"onUpdate:modelValue":[A[2]||(A[2]=E=>M.value=E),Ce],label:a(i)("core.logViewer.logsSince"),type:"datetime-local",dense:"",density:"comfortable","hide-details":"",clearable:"",class:"mb-2",style:{"max-width":"210px"},"onClick:clear":A[3]||(A[3]=E=>M.value="")},null,8,["modelValue","label"])])]),_:1}),t(me,{cols:"12",md:"4"},{default:e(()=>[t(Zt,{modelValue:re.value,"onUpdate:modelValue":A[4]||(A[4]=E=>re.value=E),label:a(i)("core.logViewer.filterLogs"),dense:"",density:"comfortable","hide-details":"",placeholder:a(i)("core.logViewer.enterKeywords"),clearable:"","onClick:clear":A[5]||(A[5]=E=>re.value="")},{"append-inner":e(()=>[t(b,{size:"20"},{default:e(()=>[...A[14]||(A[14]=[n("tabler-search",-1)])]),_:1})]),_:1},8,["modelValue","label","placeholder"]),t(zl,{multiple:"",elevation:"0"},{default:e(()=>[t(Sl,null,{default:e(()=>[t(Al,null,{default:e(()=>[t(b,{icon:"mdi-cog",size:"20",class:"mr-1"}),n(" "+c(a(i)("core.logViewer.advanceOptions")),1)]),_:1}),t(Vl,null,{default:e(()=>[s("div",_i,[t(ga,{modelValue:Q.value,"onUpdate:modelValue":A[6]||(A[6]=E=>Q.value=E),"hide-details":"",density:"comfortable",inset:"",onChange:w},{label:e(()=>[s("span",$i,c(a(i)("core.logViewer.autoRefresh")),1)]),_:1},8,["modelValue"]),t(ga,{modelValue:Te.value,"onUpdate:modelValue":A[7]||(A[7]=E=>Te.value=E),"hide-details":"",density:"comfortable",inset:"",onChange:Ce},{label:e(()=>[s("span",Ci,c(a(i)("core.logViewer.displayAllLogs")),1)]),_:1},8,["modelValue"]),t(ga,{modelValue:F.value,"onUpdate:modelValue":A[8]||(A[8]=E=>F.value=E),"hide-details":"",density:"comfortable",inset:""},{label:e(()=>[s("span",zi,c(a(i)("core.logViewer.displayTimestamp")),1)]),_:1},8,["modelValue"]),t(ga,{modelValue:Ue.value,"onUpdate:modelValue":A[9]||(A[9]=E=>Ue.value=E),"hide-details":"",density:"comfortable",inset:""},{label:e(()=>[s("span",Si,c(a(i)("core.logViewer.lineSelection")),1)]),_:1},8,["modelValue"]),t(ga,{modelValue:ie.value,"onUpdate:modelValue":A[10]||(A[10]=E=>ie.value=E),"hide-details":"",density:"comfortable",inset:""},{label:e(()=>[s("span",Ai,c(a(i)("core.logViewer.autoScroll")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s("div",{ref_key:"logsContainer",ref:N,class:ca(["code-container mt-3",{"line-by-line-mode":Ue.value}])},[qe.value.length>0?(d(),C(B,{key:0,ref_key:"copyBtn",ref:H,class:"log-copy-button ml-2",size:"small",color:"default",disabled:he.value,onClick:dt},{default:e(()=>[t(b,null,{default:e(()=>[n(c(he.value?"mdi-check":"mdi-content-copy"),1)]),_:1}),n(" "+c(he.value?a(i)("core.logViewer.copied"):a(i)("core.logViewer.copy")),1)]),_:1},8,["disabled"])):I("",!0),Ue.value&&j.value.length?(d(),C(B,{key:1,class:"log-copy-button ml-2",size:"small",color:"default",onClick:je},{default:e(()=>[t(b,{start:""},{default:e(()=>[...A[15]||(A[15]=[n(" mdi-arrange-send-backward ",-1)])]),_:1}),n(" "+c(a(i)("core.logViewer.unselect")),1)]),_:1})):I("",!0),qe.value.length>0?(d(),C(B,{key:2,class:"download-button ml-2",color:"success",loading:ne.value,disabled:ne.value,size:"small",onClick:A[11]||(A[11]=E=>m(f.appSpecification.version<4?f.appSpecification.name:`${q.value}_${f.appSpecification.name}`))},{default:e(()=>[t(b,{start:""},{default:e(()=>[...A[16]||(A[16]=[n(" mdi-download ",-1)])]),_:1}),n(" "+c(a(i)("core.logViewer.download")),1)]),_:1},8,["loading","disabled"])):I("",!0),qe.value.length>0?(d(!0),T(De,{key:3},ut(qe.value,E=>Ie((d(),T("div",{key:Re(E)+Math.random(),class:ca(["log-entry",{selected:j.value.includes(Re(E))}]),onClick:ce=>Ue.value&&He(E)},null,10,Vi)),[[de,ht(E)]])),128)):(d(),T(De,{key:4},[re.value.trim()!==""?(d(),T("div",Ti,c(a(i)("core.logViewer.noMatchingLogs",{keyword:re.value})),1)):oe.value?(d(),T("div",Ri,c(a(i)("core.logViewer.noLogsFound")),1)):I("",!0)],64))],2)])}}},Di=aa(Ii,[["__scopeId","data-v-ee0e9451"]]),Ui={class:"d-flex w-100 align-center border-frame"},Li={class:"d-flex align-center"},Bi={class:"text-h5"},Fi={class:"d-flex align-center"},Ei={class:"text-no-transform"},Pi={class:"json-container"},Mi={style:{"font-size":"12px","vertical-align":"middle"}},ji={class:"json-pretty-wrapper"},Oi={__name:"JsonViewer",props:{data:{type:Array,default:()=>[]},message:{type:String,default:""},title:{type:String,default:""},icon:{type:String,default:"mdi-folder-information-outline"}},setup(xe){const f=xe,i=Ma(),{theme:te}=Fa(i),q=p(0),j=Ba({});let he=null;return Ta(()=>{it(()=>{he=new il(".copy-json-btn"),he.on("success",ge=>{const ne=ge.trigger?.getAttribute("data-index");ne!==null&&(j[ne]={copied:!0,disabled:!0},setTimeout(()=>{j[ne]={copied:!1,disabled:!1}},2e3))}),he.on("error",ge=>{console.error("Copy failed",ge)})})}),Oa(()=>{he&&he.destroy()}),(ge,ne)=>(d(),T(De,null,[t(et,{class:"align-center justify-space-between mb-1"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center"},{default:e(()=>[s("div",Ui,[s("div",Li,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"26"},{default:e(()=>[n(c(f.icon),1)]),_:1})]),_:1}),s("span",Bi,c(f.title),1),xe.message?(d(),C(Ze,{key:0,text:xe.message},{activator:e(({props:pe})=>[t(b,wt(pe,{size:"18",class:"ml-1"}),{default:e(()=>[...ne[2]||(ne[2]=[n(" mdi-information-outline ",-1)])]),_:1},16)]),_:1},8,["text"])):I("",!0)])])]),_:1})]),_:1}),t(Sa,{modelValue:q.value,"onUpdate:modelValue":ne[0]||(ne[0]=pe=>q.value=pe),class:"tabs-no-slide-v v-tabs-pill","hide-slider":"",density:"comfortable"},{default:e(()=>[(d(!0),T(De,null,ut(xe.data,(pe,M)=>(d(),C(_a,{key:M,value:M,class:"custom-tab-gap"},{default:e(()=>[s("div",Fi,[t(b,{class:"mr-1 custom-tab-icon"},{default:e(()=>[...ne[3]||(ne[3]=[n(" mdi-docker ",-1)])]),_:1}),s("div",Ei,c(pe.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Ua,{modelValue:q.value,"onUpdate:modelValue":ne[1]||(ne[1]=pe=>q.value=pe),class:"mt-2"},{default:e(()=>[(d(!0),T(De,null,ut(xe.data,(pe,M)=>(d(),C(Aa,{key:M,value:M},{default:e(()=>[s("div",Pi,[t(B,{icon:"",size:"small",class:"copy-json-btn transparent-btn",variant:"plain",color:"default","data-index":M,disabled:j[M]?.disabled,"data-clipboard-text":JSON.stringify(pe.callData,null,2)},{default:e(()=>[t(b,{style:{"font-size":"18px"}},{default:e(()=>[...ne[4]||(ne[4]=[n(" mdi-content-copy ",-1)])]),_:1}),s("span",Mi,c(j[M]?.copied?"Copied!":"Copy"),1)]),_:2},1032,["data-index","disabled","data-clipboard-text"]),s("div",ji,[t(a(Hl),{data:pe.callData,deep:2,"show-icon":"","show-line":!1,virtual:"",class:"json-pretty-inner",theme:a(te)==="dark"?"dark":"light"},null,8,["data","theme"])])])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64))}},Ni=aa(Oi,[["__scopeId","data-v-ad387be7"]]),qi={class:"chip-grid"},Hi={class:"chip-left"},Wi={style:{"font-size":"18px"}},Ji={class:"chip-buttons d-flex align-center"},Gi={__name:"SmartChip",props:{icon:{type:String,default:"mdi-hexagon-multiple"},iconAfterTrue:{type:String,default:"mdi-check-circle"},iconAfterFalse:{type:String,default:"mdi-alert-circle"},iconState:{type:[Function,Boolean],required:!0},textOn:{type:String,default:"Local Specification"},textOff:{type:String,default:"Global Specification"},toggleTrueLabel:{type:String,default:"LOCAL"},toggleFalseLabel:{type:String,default:"GLOBAL"},color:{type:String,default:"info"},variant:{type:String,default:"tonal"},rounded:{type:String,default:"md"},className:{type:String,default:""},modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(xe,{emit:f}){const i=xe,te=f,q=p(i.modelValue);bt(q,pe=>{te("update:modelValue",pe)});const j=$e(()=>q.value?i.textOn:i.textOff),he=$e(()=>typeof i.iconState=="function"?i.iconState():i.iconState),ge=$e(()=>q.value?he.value?i.iconAfterTrue:i.iconAfterFalse:null),ne=$e(()=>q.value?he.value?"success":"error":null);return(pe,M)=>(d(),C(Ee,{color:xe.color,variant:xe.variant,rounded:xe.rounded,class:ca(["my-3",xe.className]),style:{width:"100%","padding-inline":"12px",overflow:"hidden"}},{default:e(()=>[s("div",qi,[s("div",Hi,[t(b,{size:"22",class:"mr-2"},{default:e(()=>[n(c(xe.icon),1)]),_:1}),s("span",Wi,c(j.value),1),ge.value?(d(),C(Ze,{key:0,location:"top"},{activator:e(({props:Q})=>[t(b,wt({size:"20",class:"ml-2",color:ne.value},Q),{default:e(()=>[n(c(ge.value),1)]),_:1},16,["color"])]),default:e(()=>[s("span",null,c(he.value?"Application is synced with global network!":"Application does not match global specifications!"),1)]),_:1})):I("",!0)]),s("div",Ji,[t(B,{size:"x-small",variant:q.value?"flat":"outlined",color:"primary",class:"toggle-btn mr-2",rounded:"pill",disabled:xe.disabled,onClick:M[0]||(M[0]=Q=>q.value=!0)},{default:e(()=>[n(c(xe.toggleTrueLabel),1)]),_:1},8,["variant","disabled"]),t(B,{size:"x-small",variant:q.value?"outlined":"flat",color:"primary",rounded:"pill",class:"toggle-btn",disabled:xe.disabled,onClick:M[1]||(M[1]=Q=>q.value=!1)},{default:e(()=>[n(c(xe.toggleFalseLabel),1)]),_:1},8,["variant","disabled"])])])]),_:1},8,["color","variant","rounded","class"]))}},Ki=aa(Gi,[["__scopeId","data-v-965b2bb5"]]),Xi={class:"d-flex justify-space-between align-center"},Zi={class:"d-flex align-center mr-1"},Yi={style:{"font-size":"12px"}},Qi={class:"pa-2"},eu={class:"app-header d-flex align-center"},tu={class:"d-flex flex-wrap gap-4 ml-4 mb-3 mt-2"},au={class:"app-details"},lu={class:"d-flex align-center mb-1"},ou={class:"d-flex align-center"},su={key:0},nu={class:"d-flex d-sm-none flex-column w-100"},ru={class:"d-flex align-start w-100"},iu={class:"flex-grow-1"},uu={class:"font-weight-bold mb-1 text-h6 text-white"},du={class:"text-body-2 text-white"},cu={class:"d-flex justify-end mt-3"},pu={class:"d-none d-sm-flex align-center w-100"},mu={class:"flex-grow-1"},fu={class:"font-weight-bold mb-1 text-h6 text-white"},vu={class:"text-body-2 text-white"},gu={class:"d-flex align-center justify-space-between w-100"},yu={class:"d-flex flex-column"},bu={class:"font-weight-bold mb-1"},hu={class:"text-body-2"},wu={key:0,class:"pa-0"},xu={class:"d-flex align-center justify-start my-3"},ku={class:"ml-1"},_u={class:"d-flex align-center justify-start my-3"},$u={class:"ml-1",style:{"font-size":"18px"}},Cu={key:1},zu={key:2},Su={key:3},Au={class:"d-flex align-center justify-space-between mb-2 w-100 border-frame"},Vu={class:"d-flex align-center"},Tu={class:"text-h5"},Ru={class:"d-flex align-center mb-2"},Iu={class:"d-flex align-center mb-2"},Du={class:"d-flex align-center mb-2"},Uu={class:"d-flex align-center mb-2"},Lu={class:"d-flex align-center mb-2"},Bu={class:"text-h6"},Fu={class:"d-flex align-center mb-2"},Eu={class:"text-h6"},Pu={class:"d-flex align-center mb-2"},Mu={class:"mr-2"},ju={key:4},Ou={key:5},Nu={key:6},qu={key:7},Hu={key:8},Wu={key:9},Ju={key:10},Gu={class:"d-flex align-center justify-start w-100"},Ku={class:"d-flex align-center justify-start w-100"},Xu={class:"flex-grow-1"},Zu={__name:"[appName]",setup(xe){Yl(),ha.register(Ql,eo,to,ao,lo,oo,so,no);const{t:f}=pa(),i=Ma(),{theme:te}=Fa(i),q=p(!1),j=p(!1),he=p(!1),ge=p([]),ne=p([]),pe=Ya(),M=gl(),Q=p("1"),Ue=p(Date.now()),F=p("renewal"),ie=Ll(),ye=p(Ya().params.appName),O=p(""),le=p(null),N=p(!1),H=p(!0),re=p(!1),oe=p(!1);p("");const G=p(!1),Le=p(!1),se=p(""),Te=p("success"),L=p(null),qe=p(null),Oe=p(null);bt(qe,g=>{if(console.log("[Spec Adapter] Input spec:",g),!g){console.log("[Spec Adapter] No spec available"),Oe.value=null;return}console.log("[Spec Adapter] Spec version:",g.version),console.log("[Spec Adapter] Has compose?",!!g.compose),g.version===3?(console.log("[Spec Adapter] Converting V3 flat to compose format"),console.log("[Spec Adapter] Original V3 spec:",JSON.parse(JSON.stringify(g))),Oe.value={...JSON.parse(JSON.stringify(g)),compose:[{name:g.name,description:g.description,repotag:g.repotag,ports:g.ports?.map(r=>parseInt(r,10))||[],containerPorts:g.containerPorts?.map(r=>parseInt(r,10))||[],domains:g.domains||[],environmentParameters:g.enviromentParameters||[],commands:g.commands||[],containerData:g.containerData||"",cpu:g.cpu||.1,ram:g.ram||100,hdd:g.hdd||1,tiered:!1}],_isV3Original:!0},console.log("[Spec Adapter] Adapted spec with compose:",JSON.parse(JSON.stringify(Oe.value)))):(console.log("[Spec Adapter] Returning deep copy of spec (not V3)"),Oe.value=JSON.parse(JSON.stringify(g)))},{immediate:!0});function Re(g){console.log("[handleSpecConverted] Received converted spec:",g),console.log("[handleSpecConverted] Original version:",qe.value?.version),console.log("[handleSpecConverted] New version:",g.version),qe.value=g,console.log("[handleSpecConverted] App specification updated to V"+g.version)}const He=p([]),je=p(-1),ht=p(0),dt=p(!0),Ce=p(!1),at=p(!1),ue=p(!1),S=p(0),{privilege:w}=Fa(M),h=p(f("pages.apps.manage.messages.dataRetrievalError")),m=p([]),x=p({status:null,data:null}),A=p(1),de=p(5),E=p(""),ce=p(1440*60*1e3),Pe=[{key:"uid",title:"UID"},{key:"pid",title:"PID"},{key:"ppid",title:"PPID"},{key:"c",title:"C"},{key:"stime",title:"STIME"},{key:"tty",title:"TTY"},{key:"time",title:"TIME"},{key:"cmd",title:"CMD"}],Je=[{value:5,title:"5"},{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],At=[{value:5e3,title:"5s"},{value:1e4,title:"10s"},{value:3e4,title:"30s"}],lt=$e(()=>[{value:900*1e3,title:f("pages.apps.manage.timeRange.last15Minutes")},{value:1800*1e3,title:f("pages.apps.manage.timeRange.last30Minutes")},{value:3600*1e3,title:f("pages.apps.manage.timeRange.last1Hour")},{value:7200*1e3,title:f("pages.apps.manage.timeRange.last2Hours")},{value:10800*1e3,title:f("pages.apps.manage.timeRange.last3Hours")},{value:300*60*1e3,title:f("pages.apps.manage.timeRange.last5Hours")},{value:1440*60*1e3,title:f("pages.apps.manage.timeRange.last1Day")},{value:2880*60*1e3,title:f("pages.apps.manage.timeRange.last2Days")},{value:4320*60*1e3,title:f("pages.apps.manage.timeRange.last3Days")},{value:10080*60*1e3,title:f("pages.apps.manage.timeRange.last7Days")}]);p(!1);const ct=p(500),pt=[5,10,25,50,100,200,300,400,500],be=$e(()=>{if(E.value){const g=E.value.toLowerCase();return Vt.value.filter(r=>Object.values(r).some(K=>String(K).toLowerCase().includes(g)))}return Vt.value}),Ve=$e(()=>{const g=(A.value-1)*de.value,r=g+de.value;return be.value.slice(g,r)}),Ge=$e(()=>Array.isArray(L.value?.compose)),Ke=$e(()=>m.value.includes(qe.value?.owner)),Rt=$e(()=>[{label:f("pages.apps.manage.tabs.specifications"),value:"1"},{label:f("pages.apps.manage.tabs.information"),value:"2",requiresInstance:!0},{label:f("pages.apps.manage.tabs.fileChanges"),value:"3",requiresInstance:!0},{label:f("pages.apps.manage.tabs.monitoring"),value:"4",requiresInstance:!0},{label:f("pages.apps.manage.tabs.logs"),value:"5",requiresInstance:!0},{label:f("pages.apps.manage.tabs.terminal"),value:"6",requiresInstance:!0},{label:f("pages.apps.manage.tabs.control"),value:"7",requiresInstance:!0},w.value!=="fluxteam"&&Ge.value&&{label:f("pages.apps.manage.tabs.backupRestore"),value:"8",requiresInstance:!0},{label:f("pages.apps.manage.tabs.instances"),value:"9",requiresInstance:!0},Ke.value&&{label:f("pages.apps.manage.tabs.subscription"),value:"10"}].filter(Boolean)),Yt=$e(()=>O.value?Rt.value:Rt.value.filter(g=>!g.requiresInstance)),Ct=p({status:null,data:null}),Be=p({status:null,data:null}),Mt=p(!1),Ye=p(!1),Qe=p(null),It=p(0),Ut=p(1),Et=p(0),ma=p(0),Qt=p(""),Vt=p([]),xt=p(null),Kt=p(5e3),We=p(!1),kt=p({data:[]}),jt=p(""),sa=p(!1),ya=$e(()=>jt.value?kt.value.data.map(g=>g.ip).filter(g=>g.toLowerCase().includes(jt.value.toLowerCase())):kt.value.data.map(g=>g.ip));bt(sa,g=>{g&&it(()=>{setTimeout(()=>{const r=document.querySelector(".v-overlay--active .v-list");r&&(r.scrollTop=0)},50)})});const mt=va(null),Pt=va(null),ot=va(null),ft=va(null),Fe=va(null),Lt=va(null);let la=!1;const k=$e(()=>We.value?f("pages.apps.manage.titles.historyStatsOverview"):f("pages.apps.manage.titles.statsProcessesOverview")),o=$e(()=>Ct.value?.data?.hash===Be.value?.data?.hash),l=$e(()=>L.value.version<=3?!0:L.value.compose?.length===1);ja(()=>{try{L.value&&L.value.version<=3?xt.value=L.value.name:L.value&&Array.isArray(L.value.compose)&&L.value.compose.length===1&&(xt.value=L.value.compose[0].name)}catch(g){console.error("watchEffect error (selectedContainerMonitoring):",g)}}),bt(Q,async(g,r)=>{g==="9"&&S.value++,g==="10"&&(Ue.value=Date.now()),r==="10"&&g!=="10"&&(console.log("🔄 Left subscription tab - reloading original spec from API"),await nt(!0))}),bt(xt,async g=>{try{if(!G.value||q.value)return;g&&(Mt.value=!1,We.value?(Jt(),await Ra()):(Qe.value&&Jt(),xt.value!==null&&$a(),Ia()))}catch(r){console.error("Error watching selectedContainerMonitoring:",r)}}),bt(Kt,()=>{try{if(!G.value||q.value)return;We.value?Jt():(Qe.value&&Jt(),$a())}catch(g){console.error("Error watching refreshRateMonitoring:",g)}}),bt(dt,()=>{try{L.value=dt.value?Ct.value.data:Be.value.data}catch(g){console.error("Error watching status:",g)}}),bt(O,g=>{g||(dt.value=!1)}),bt(Q,async g=>{if(await y(),!(!G.value||q.value))try{g==="1"?(L.value=null,O.value?(await W(),await nt()):Be.value.data&&(L.value={...Be.value.data})):g==="2"?(ge.value=[],await Me()):g==="3"?(ne.value=[],await Me("changes")):g==="4"&&(Vt.value=[],await it(),Ga(),setTimeout(async()=>{if(await y(),!(!G.value||q.value))try{$a()}catch(r){console.error("Polling stats error (delayed):",r)}},2e3))}catch(r){console.error("Error watching currentTab:",r)}});function v(g){return new Promise(r=>setTimeout(r,g))}function R(g,r){if(!g)return"primary";const K=g.toLowerCase();return K==="running"?r?.toLowerCase().includes("unhealthy")?"warning":"success":K==="restarting"?"warning":K==="exited"&&!re.value?"error":"primary"}function z(g,r){return R(g,r)}function D(g,r){if(!Array.isArray(g))return!1;const K=g.find(ee=>ee.Names?.[0]===_t(r));return K?{name:r.includes("_")?r.substring(0,r.lastIndexOf("_")):r,state:K.State??f("common.notAvailable"),status:K.Status?.toLowerCase()??f("common.notAvailable"),image:K.Image??f("common.notAvailable")}:!1}function X(g){return g?g.version>=4?g.compose:[{...g,repoauth:!1}]:[]}function P(g,r){se.value=r,Te.value=g==="danger"?"error":g,Le.value=!0}function ke(g,r){if(!r)return f("pages.apps.manage.messages.applicationExpired");if(je.value===-1)return f("pages.apps.manage.messages.cannotCalculateExpiration");const K=202e4,ee=r>=K?88e3:22e3;let Se=r+(g||ee);if(r<K&&je.value>=K&&Se>K){const yt=Se-K;Se=K+yt*4}const _e=Se-je.value;if(_e<1)return f("pages.apps.manage.messages.applicationExpired");const Z=je.value>=K?.5:2,Y=_e*Z,Ae={day:1440,hour:60,minute:1},Xe=[];let $t=Y;for(const yt in Ae){const J=Math.floor($t/Ae[yt]);J>0&&Xe.push(`${J} ${yt}${J>1?"s":""}`),$t%=Ae[yt]}return Xe.slice(0,3).join(", ")}async function Ne(g,r=null,K=null,ee=!1,we=!1){try{const Se=localStorage.getItem("zelidauth"),_e=K||{headers:{zelidauth:Se,...ee&&{"x-apicache-bypass":"true"}},timeout:6e4};if(ue.value=!1,await y(),!G.value||q.value)return;const[Z,Y=16127]=O.value?.split(":")||[];if(Z)h.value=f("pages.apps.manage.messages.dataRetrievalError");else throw h.value=f("pages.apps.manage.messages.instanceNotFound"),new Error("Instance not found with deployed application.");let Xe=`https://${Z.replace(/\./g,"-")}-${Y}.node.api.runonflux.io${g}`;return oe.value&&(Xe=`http://${Z}:${Y}${g}`),r?await da.post(Xe,r,_e):await da.get(Xe,_e)}catch(Se){throw we||(ue.value=!0),console.error("executeLocalCommand error:",Se),Se}}function st(g){return g?g.startsWith("zel")||g.startsWith("flux")?g:g==="KadenaChainWebNode"||g==="FoldingAtHomeB"?`zel${g}`:`flux${g}`:""}function _t(g){const r=st(g);return r.startsWith("/")?r:`/${r}`}function $(){ie.push("/apps/management")}async function u(){if(!G.value||q.value)return;const g=await Ca.getAppLocation(ye.value);if(g.data.status==="error")return;const r=O.value;kt.value.data=g.data.data;const K=r&&kt.value.data.some(ee=>ee.ip===r);if(console.log("[getInstancesForDropDown] previousIp:",r),console.log("[getInstancesForDropDown] instances count:",kt.value.data.length),console.log("[getInstancesForDropDown] previousIpStillValid:",K),console.log("[getInstancesForDropDown] masterSlaveApp:",re.value),re.value){le.value=null;const ee=`https://${ye.value}.app.runonflux.io/fluxstatistics?scope=${ye.value}apprunonfluxio;json;norefresh`;let we=!1,Se=await da.get(ee).catch(_e=>{we=!0,le.value=f("pages.apps.manage.messages.failedToCheck"),console.error("UImasterSlave: Failed to reach FDM:",_e)});if(!we&&Se?.data?.length){for(const _e of Se.data)if(_e.find(Y=>Y.id===1&&Y.objType==="Server"&&Y.field.name==="pxname"&&Y.value.value.toLowerCase().startsWith(`${ye.value.toLowerCase()}apprunonfluxio`))){const Y=_e.find(Ae=>Ae.id===1&&Ae.objType==="Server"&&Ae.field.name==="svname");if(Y){const[Ae,Xe]=Y.value.value.split(":");le.value=Ae,O.value=Xe==="16127"?Ae:Y.value.value;break}}}le.value||(le.value=f("pages.apps.manage.messages.definingNewPrimary")),O.value||(O.value=kt.value.data[0]?.ip),console.log("[getInstancesForDropDown] Master/slave - selectedIp set to:",O.value)}else!r||!K?(O.value=kt.value.data[0]?.ip,console.log("[getInstancesForDropDown] Regular app - selectedIp set to:",O.value)):console.log("[getInstancesForDropDown] Regular app - preserving selectedIp:",O.value);console.log("[getInstancesForDropDown] FINAL selectedIp.value:",O.value),kt.value.totalRows=kt.value.data.length}async function _(){if(!(!G.value||q.value)){N.value=!0,H.value=!0;try{if(await new Promise(g=>setTimeout(g,3e3)),!G.value||q.value)return;await u(),await U(!1)}catch(g){console.error("Error refreshing info:",g)}finally{N.value=!1,H.value=!1}}}async function y(){const g=localStorage.getItem("zelidauth"),r=nl.parse(g||""),K=Date.now(),ee=1.5*60*60*1e3,we=r?.loginPhrase?.substring(0,13)||0,Se=+we+ee;+we>0&&K<Se?G.value=!0:(G.value=!1,await v(1e3),await V())}async function V(){if(q.value)return;q.value=!0,G.value=!1;const g=localStorage.getItem("zelidauth");console.log("Session expired, logging out..."),P("warning",f("pages.apps.manage.messages.sessionExpired")),await v(300),localStorage.removeItem("zelidauth"),localStorage.removeItem("loginType"),yl(),M.setPrivilege("none"),M.setZelid("");try{await bl.logoutCurrentSession(g)}catch(r){console.error("Logout API error (suppressed):",r)}try{await Xl.auth().signOut()}catch(r){console.error("Firebase logout error (suppressed):",r)}pe.path==="/"?window.location.reload():await ie.push("/")}async function U(g=!1){if(!G.value||!O.value)return;if(g||await ze(),!L.value?.name&&(await W(!0),!L.value?.name)){He.value=[],await it();return}const r=[];if(L.value?.version>=4&&Array.isArray(L.value.compose))for(const K of L.value.compose){const ee=D(x.value.data,`${K.name}_${L.value.name}`);ee&&r.push(ee)}else{const K=D(x.value.data,L.value.name);K&&r.push(K)}He.value=r,await it()}async function W(g=!1){if(!G.value||q.value)return;console.log("[getInstalledApplicationSpecifics] START - selectedIp.value:",O.value),L.value=null,await v(1e3),Ce.value=!0,at.value=!1;const r=kt.value.data||[],K=O.value;console.log("[getInstalledApplicationSpecifics] currentIp:",K),console.log("[getInstalledApplicationSpecifics] availableInstances:",r.length);const ee=5,we=r.map(Y=>Y.ip).filter(Y=>Y&&Y!==K),Se=[K,...we.slice(0,ee-1)];let _e=null,Z=0;for(const Y of Se){if(!Y)continue;Z++,console.log(`Attempting to fetch app spec from backend ${Z}/${Se.length}: ${Y}`);const Ae=O.value;try{O.value=Y;const Xe=await Ne(`/apps/installedapps/${ye.value}`,null,null,!0,!0);if(O.value=Ae,!Xe){_e="No response from backend",console.log(`Backend ${Y} failed: No response`);continue}const{status:$t,data:yt}=Xe.data;if($t!=="success"||!yt?.length){_e="Unable to get installed app spec",console.log(`Backend ${Y} failed: ${_e}`);continue}let J={...yt[0]};if(!J||!J.name||J.version===void 0){_e="Installed app specification is empty or invalid",console.log(`Backend ${Y} failed: ${_e}`);continue}console.log(`Successfully fetched app spec from ${Y}`);const ae=J.version>=8&&J.enterprise&&J.enterprise!=="",Ot=ae&&J.enterprise===Be.value.data?.enterprise;if(ae&&Ot)J.contacts=Be.value.data.contacts,J.compose=Be.value.data.compose;else if(ae&&!Ot){const na=await fe({local:!0});if(!na){g||P("danger","Unable to get decrypted app spec"),at.value=!0;return}J.contacts=na.contacts,J.compose=na.compose}Ct.value.status=$t,Ct.value.data=J,L.value=J,Ce.value=!1,O.value=Ae;return}catch(Xe){_e=Xe.message||"Connection error",O.value=Ae;continue}}if(console.error(`All ${Z} backends failed. Last error: ${_e}`),Be.value.data&&Be.value.data.name){console.log("No local spec available, using global spec as fallback"),L.value={...Be.value.data},Ce.value=!1;return}at.value=!0,Ce.value=!1}async function fe(g={}){if(!G.value||q.value)return null;const r=g.local??!1,K=await Ca.getAppOriginalOwner(ye.value),{status:ee,data:we}=K.data;if(ee!=="success")return P("error","Unable to get app owner"),null;const Se=localStorage.getItem("zelidauth"),_e=await Ca.getAppPublicKey(Se,{name:ye.value,owner:we}),{status:Z,data:Y}=_e.data;if(Z!=="success")return P("error","Unable to get encryption pubkey"),null;if(!Wl())return console.warn("WebCrypto not available, cannot decrypt enterprise app"),P("warning","Enterprise features require HTTPS or localhost. Please access this application using a secure connection."),null;const Ae=await Jl(Y),Xe=crypto.getRandomValues(new Uint8Array(32)),$t=await Gl(Xe,Ae);console.log("Encrypted Enterprise key:",$t);const yt={headers:{zelidauth:Se,"enterprise-key":$t}},J=`/apps/appspecifications/${ye.value}/true`,ae=r?await Ne(J,null,yt):await Ca.getAppEncryptedSpecifics(ye.value,Se,$t);console.log(`Get ${r?"local":"global"} encrypted fields`,ae);const{status:na,data:Pa}=ae.data;if(na!=="success")return P("error","Unable to get encrypted app data"),Be.value.status=na,null;const ba=await Kl(Pa.enterprise,Xe).catch(Da=>(console.log("Error found:",Da),null));return ba?JSON.parse(ba):(P("error","Unable to decrypt app specs"),null)}async function nt(g=!1){if(!G.value||q.value)return;const r=await Ca.getAppSpecifics(ye.value);if(!r)return;const{status:K,data:ee,message:we}=r.data||{};if(K!=="success"){g||P("error",we||"Unable to get global app spec"),Be.value.status=K;return}if(ee.version>=8&&ee.enterprise&&ee.enterprise!==""&&typeof fe=="function"){const _e=await fe();if(!_e)return;Object.assign(ee,_e)}Be.value.status=K,Be.value.data=ee,qe.value=ee,re.value=ee.version>3&&Array.isArray(ee.compose)&&ee.compose.some(_e=>_e.containerData?.includes("g:"))}async function ze(){if(!G.value||q.value)return;const g=await Ne("/apps/listallapps",null,null,!0);x.value.status=g?.data?.status,x.value.data=g?.data?.data,await U(!0),await it()}async function ve(){try{if(!G.value||q.value)return;const g=await Zl.getBlockCount();g.data.status==="success"?(je.value=g.data.data,console.log("Daemon block count set:",je.value)):(console.warn("Daemon block count fetch failed:",g.data),je.value=-1)}catch(g){console.error("Error fetching daemon block count:",g.message),je.value=-1}}const Me=async(g="inspect")=>{if(!G.value||q.value)return;const r=g==="inspect",K=[],ee=r?j:he;ee.value=!0;try{if(L.value?.version>=4)for(const we of L.value.compose){const Se=`/apps/app${g}/${we.name}_${L.value.name}`,_e=await Ne(Se);_e.data.status==="error"||K.push({name:we.name,callData:_e.data.data})}else{const we=`/apps/app${g}/${ye.value}`,Se=await Ne(we);Se.data.status==="error"||K.push({name:L.value.name,callData:Se.data.data}),r||console.log(Se)}r?ge.value=[...K]:ne.value=[...K]}catch{}finally{ee.value=!1}};function zt(){Mt.value=!1,Ye.value=!1,We.value?(Jt(),Ia(),Ra()):(Ia(),$a())}function vt(g){const r=g.data.datasets[0].data.length;if(r>ct.value){const K=r-ct.value;g.data.labels=g.data.labels.slice(K),g.data.datasets.forEach(ee=>{ee.data=ee.data.slice(K)}),g.update({duration:800,lazy:!1,easing:"easeOutBounce"})}}async function tt(){await it(),window.scrollTo(0,document.body.scrollHeight)}function Bt(g,r){return g?.compose?g.compose.find(ee=>ee.name===r).hdd:g.hdd}function ea(g,r){return g?.compose?g.compose.find(ee=>ee.name===r).cpu:g.cpu}function Ea(g,r=null){const K=g.memory_stats.limit;It.value=K;const ee=g.memory_stats?.usage??null,we=ee,Se=(ee/K*100).toFixed(1),_e=g.cpu_stats.cpu_usage.total_usage-g.precpu_stats.cpu_usage.total_usage,Z=g.cpu_stats.system_cpu_usage-g.precpu_stats.system_cpu_usage,Y=g.cpu_stats.online_cpus,{nanoCpus:Ae}=g;let Xe;if(!L.value)return;L.value.version>=4?Xe=ea(L.value,xt.value):Xe=L.value.cpu;const $t=(_e/Z*Y).toFixed(2)||0,yt=($t/(Ae/Xe/1e9)*100/100).toFixed(2),J=($t/(Ae/Xe/1e9)*100/Xe).toFixed(2);Ut.value=Xe;const ae=g.blkio_stats.io_service_bytes_recursive?g.blkio_stats.io_service_bytes_recursive.find(Ha=>Ha.op.toLowerCase()==="read")?.value||0:null,Ot=g.blkio_stats.io_service_bytes_recursive?g.blkio_stats.io_service_bytes_recursive.find(Ha=>Ha.op.toLowerCase()==="write")?.value||0:null,na=g.networks?.eth0?.rx_bytes??null,Pa=g.networks?.eth0?.tx_bytes??null;let ba=g.disk_stats?.bind??null,Da;L.value?.version>=4?Da=Bt(L.value,xt.value):Da=L.value.hdd,Et.value=Number(Da)*1024*1024*1024,ma.value=ba/Et.value*100;let Na=g.disk_stats?.volume??null,qa=g.disk_stats?.rootfs??null;g.disk_stats?.status==="error"&&(ba=null,Na=null,qa=null),console.log("Resource Metrics:",{"CPU Size":yt,"CPU Percent":J,"Memory Usage (MB)":we,"Memory Usage (%)":Se,"Network RX Bytes":na,"Network TX Bytes":Pa,"I/O Read Bytes":ae,"I/O Write Bytes":Ot,"Disk Usage Mounts":ba,"Disk Usage Volume":Na,"Disk Usage RootFS":qa}),ul(J,we,Se,na,Pa,ae,Ot,ba,Na,qa,yt,r)}async function Ra(){try{if(!G.value||q.value){Jt();return}if(!L.value)return;if(L.value?.version>=4&&!xt.value){Qe.value&&Jt();return}if(Q.value!=="4")return;We.value&&Ia();const g=xt.value,r=O.value,K=L.value?.version>=4?`${xt.value}_${L.value?.name}`:L.value?.name;let ee,we;if(Qt.value="",We.value?ee=await Ne(`/apps/appmonitor/${K}/${ce.value}`):ee=await Ne(`/apps/appstats/${K}`),we=await Ne(`/apps/appinspect/${K}`),ee.data.status==="error")P("danger",ee.data.data.message||ee.data.data);else if(we.data.status==="error")P("danger",we.data.data.message||we.data.data);else{We.value||cl(K,g,r);const _e=we.data.data?.State?.Status;if(_e!=="running"&&!We.value){Ye.value=!0,_e==="exited"?Qt.value="(Container marked as stand by)":Qt.value="(Container not running)",Jt(!0);return}let Z;ee.data?.data?.lastDay?Z=ee.data.data.lastDay.reverse():Z=ee.data.data,Array.isArray(Z)?Z.forEach(Y=>{Ea(Y.data,Y.timestamp)}):Ea(Z),g===xt.value&&r===O.value?dl():Ia()}}catch(g){console.error("Error fetching container data:",g),Jt(!0)}}function Ja(){ot.value&&ot.value.data.labels.length===1&&ot.value.options?.scales?.y&&ot.value.options?.scales?.y1&&(ot.value.options.scales.y.max=It.value*1.2,ot.value.options.scales.y1.max=120),ft.value&&ft.value.data.labels.length===1&&ft.value.options?.scales?.y&&ft.value.options?.scales?.y1&&(ft.value.options.scales.y.max=Number((Ut.value*1.35).toFixed(1)),ft.value.options.scales.y1.max=135)}function ul(g,r,K,ee,we,Se,_e,Z,Y,Ae,Xe,$t=null){const yt=$t===null?new Date().toLocaleTimeString():new Date($t).toLocaleTimeString();r!==null&&(vt(ot.value),ot.value.data.labels.push(yt),ot.value.data.datasets[0].data.push(r),ot.value.data.datasets[1].data.push(K)),!Number.isNaN(Number(Xe))&&!Number.isNaN(Number(g))&&(vt(ft.value),ft.value.data.labels.push(yt),ft.value.data.datasets[0].data.push(Xe),ft.value.data.datasets[1].data.push(g)),ee!==null&&we!==null&&(vt(Fe.value),Fe.value.data.labels.push(yt),Fe.value.data.datasets[0].data.push(ee),Fe.value.data.datasets[1].data.push(we)),Se!==null&&_e!==null&&(vt(Lt.value),Lt.value.data.labels.push(yt),Lt.value.data.datasets[0].data.push(Se),Lt.value.data.datasets[1].data.push(_e)),Z!==null&&(vt(mt.value),mt.value.data.labels.push(yt),mt.value.data.datasets[0].data.push(Z)),Y!==null&&mt.value.data.datasets[1].data.push(Y),mt.value.data?.datasets[1]?.data&&(Array.isArray(mt.value.data.datasets[1].data)&&mt.value.data.datasets[1].data.some(ae=>ae>0)?mt.value.data.datasets[1].hidden=!1:mt.value.data.datasets[1].hidden=!0),Ae!==null&&(vt(Pt.value),Pt.value.data.labels.push(yt),Pt.value.data.datasets[0].data.push(Ae)),Ye.value=!0,Ja()}function dl(){ot.value?.update(),ft.value?.update(),Fe.value?.update(),Lt.value?.update(),mt.value?.update(),Pt.value?.update()}function Xt(g,r={base:10,round:1}){if(g<=5)return`${g} B`;const K=r.base===10?1e3:1024,ee=r.base===10?["B","KB","MB","GB"]:["B","KiB","MiB","GiB"];if(g===0)return"0 B";let we=g,Se=0;for(;we>=K&&Se<ee.length-1;)we/=K,Se++;return`${parseFloat(we.toFixed(r.round)).toString()} ${ee[Se]}`}async function cl(g,r,K){try{if(!G.value||q.value)return;const ee=await Ne(`/apps/apptop/${g}`);if(ee.data.status==="error"){P("danger",ee.data.data.message||ee.data.data),Jt(!0);return}xt.value===r&&O.value===K?Vt.value=(ee.data?.data?.Processes||[]).map(we=>({uid:we[0],pid:we[1],ppid:we[2],c:we[3],stime:we[4],tty:we[5],time:we[6],cmd:we[7]})):(Vt.value=[],console.error("Selected container has changed. Proccess list discarded."))}catch(ee){console.error("Error fetching processes:",ee)}}function Ga(){ot.value&&(ot.value.destroy(),ft.value.destroy(),Fe.value.destroy(),Lt.value.destroy(),mt.value.destroy(),Pt.value.destroy());const g=document.getElementById("memoryChart").getContext("2d"),r=document.getElementById("cpuChart").getContext("2d"),K=document.getElementById("networkChart").getContext("2d"),ee=document.getElementById("ioChart").getContext("2d"),we=document.getElementById("diskPersistentChart").getContext("2d"),Se=document.getElementById("diskFileSystemChart").getContext("2d"),_e={id:"noDataPlugin",beforeDraw:Z=>{if(!(!Z||!Z.data||!Z.data.datasets)&&Z.data.datasets.every(Y=>Y.data.length===0)&&Ye.value===!0){const{ctx:Y,width:Ae,height:Xe}=Z;Y.save();const $t=Math.min(Ae,Xe)/14;Y.font=`400 ${$t}px Arial`,te.value==="dark"?Y.fillStyle="rgba(255, 255, 255, 0.6)":Y.fillStyle="rgba(0, 0, 0, 0.6)",Y.textAlign="center",Y.textBaseline="middle",Y.translate(Ae/2,Xe/2),Y.fillText("No Data Available",0,0);const yt=Qt?.value||"",J=$t*.7;Y.font=`400 ${J}px Arial`,Y.fillText(yt,0,$t),Y.restore()}}};mt.value=new ha(we,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.bind"),data:[],fill:!0,backgroundColor:"rgba(119,255,132,0.3)",borderColor:"rgba(119,255,132,0.6)",tension:.4},{label:f("pages.apps.manage.charts.volume"),data:[],borderColor:"rgba(155,99,132,1)",borderDash:[5,5],pointRadius:2,borderWidth:2,tension:.5,fill:!1}]},options:{responsive:!0,scales:{x:{title:{display:!0,text:""}},y:{title:{display:!0,text:""},beginAtZero:!0,ticks:{callback:Z=>Xt(Z,{base:2,round:0})}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return`${Y}: ${Xt(Ae,{base:2,round:1})}`},footer:()=>[`Available Bind Size: ${Xt(Et.value,{base:2,round:1})}`,`Bind Usage (%): ${ma.value.toFixed(2)}%`]}},legend:{display:!0,labels:{filter:Z=>{if(!mt.value)return!0;if(Z.datasetIndex===1){const Y=mt.value.data.datasets[Z.datasetIndex]?.data;return Array.isArray(Y)&&Y.some(Ae=>Ae>0)}return!0}}}}},plugins:[_e]}),Pt.value=new ha(Se,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.fileSystem"),data:[],fill:!0,backgroundColor:"rgba(159,155,132,0.3)",borderColor:"rgba(159,155,132,0.6)",tension:.4}]},options:{responsive:!0,scales:{x:{title:{display:!0,text:""}},y:{title:{display:!0,text:""},beginAtZero:!0,ticks:{callback:Z=>Xt(Z,{base:2,round:0})}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return`${Y}: ${Xt(Ae,{base:2,round:1})}`}}}}},plugins:[_e]}),ot.value=new ha(g,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.memoryAllocated"),data:[],fill:!0,backgroundColor:"rgba(151,187,205,0.4)",borderColor:"rgba(151,187,205,0.6)",yAxisID:"y",pointRadius:2,borderWidth:2,tension:.4},{label:f("pages.apps.manage.charts.memoryUtilization"),data:[],fill:!1,borderColor:"rgba(255,99,132,1)",borderDash:[5,5],yAxisID:"y1",pointRadius:2,borderWidth:2,tension:.4}]},options:{responsive:!0,scales:{x:{title:{display:!0}},y:{id:"y",title:{display:!0},beginAtZero:!0,precision:0,ticks:{callback:Z=>Xt(Z,{base:2,round:1})}},y1:{id:"y1",title:{display:!0},beginAtZero:!0,position:"right",grid:{display:!1},ticks:{callback:Z=>`${Z}%`}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return Y.includes("%")?`Memory Utilization: ${Ae}%`:`${Y}: ${Xt(Ae,{base:2,round:1})}`},footer:()=>`Available Memory: ${Xt(It.value,{base:2,round:1})}`}}}},plugins:[_e]}),ft.value=new ha(r,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.cpuAllocated"),data:[],fill:!0,backgroundColor:"rgba(255,99,132,0.4)",borderColor:"rgba(255,99,132,0.6)",tension:.4},{label:f("pages.apps.manage.charts.cpuUtilization"),fill:!1,borderColor:"rgba(255,99,132,1)",borderDash:[5,5],yAxisID:"y1",pointRadius:2,borderWidth:2,tension:.4}]},options:{responsive:!0,scales:{x:{title:{display:!0}},y:{id:"y",title:{display:!0},beginAtZero:!0,ticks:{callback:Z=>`${Z} CPU`}},y1:{id:"y1",title:{display:!0},beginAtZero:!0,position:"right",grid:{display:!1},ticks:{callback:Z=>`${Z}%`}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return Y.includes("%")?`CPU Utilization: ${Ae}%`:`CPU Allocated: ${Ae} CPU`},footer:()=>`Available CPU Core(s): ${Ut.value}`}}}},plugins:[_e]}),Fe.value=new ha(K,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.networkRx"),data:[],fill:!0,backgroundColor:"rgba(99,255,132,0.4)",borderColor:"rgba(99,255,132,0.6)",tension:.4},{label:f("pages.apps.manage.charts.networkTx"),data:[],fill:!1,borderColor:"rgba(132,99,255,1)",tension:.4}]},options:{responsive:!0,scales:{x:{title:{display:!0,text:""}},y:{title:{display:!0,text:""},beginAtZero:!0,ticks:{callback:Z=>Xt(Z,{base:10,round:0})}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return`${Y}: ${Xt(Ae)}`}}}}},plugins:[_e]}),Lt.value=new ha(ee,{type:"line",data:{labels:[],datasets:[{label:f("pages.apps.manage.charts.ioRead"),data:[],fill:!1,borderColor:"rgba(99,132,255,0.6)",tension:.4},{label:f("pages.apps.manage.charts.ioWrite"),data:[],fill:!0,backgroundColor:"rgba(255,132,99,0.4)",borderColor:"rgba(255,132,99,0.6)",tension:.4}]},options:{responsive:!0,scales:{x:{title:{display:!0}},y:{title:{display:!0},beginAtZero:!0,ticks:{callback:Z=>Xt(Z,{base:10,round:0})}}},plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label:Z=>{const Y=Z.dataset.label,Ae=Z.raw;return`${Y}: ${Xt(Ae)}`}}}}},plugins:[_e]}),Ja()}function $a(g=!1){console.log("⏱ startPollingStats..."),!(!G.value||q.value)&&(Jt(),Qe.value=setInterval(async()=>{if(!G.value||q.value){Jt();return}la||(la=!0,await Ra(),la=!1)},Kt.value),g===!0&&(Mt.value=!1))}function Jt(g=!1){clearInterval(Qe.value),Qe.value=null,g===!0?Mt.value=!0:Ye.value=!1}function Ia(){ot.value&&(Ye.value=!1,ot.value.data.labels=[],ot.value.data.datasets.forEach(g=>{g.data=[]}),ot.value.options.scales.y.max=1.2,ot.value.options.scales.y1.max=120,ot.value.update(),ft.value.data.labels=[],ft.value.data.datasets.forEach(g=>{g.data=[]}),ft.value.options.scales.y.max=1.2,ft.value.options.scales.y1.max=120,ft.value.update(),Fe.value.data.labels=[],Fe.value.data.datasets.forEach(g=>{g.data=[]}),Fe.value.update(),Lt.value.data.labels=[],Lt.value.data.datasets.forEach(g=>{g.data=[]}),Lt.value.update(),mt.value.data.labels=[],mt.value.data.datasets.forEach(g=>{g.data=[]}),mt.value.update(),Pt.value.data.labels=[],Pt.value.data.datasets.forEach(g=>{g.data=[]}),Pt.value.update(),Vt.value=[])}return Ta(async()=>{try{const g=localStorage.getItem("zelidauth");g&&(m.value=g),qt.on("updateAppStatus",ze),qt.on("updateInstanceList",_);const{hostname:r}=window.location,K=/[A-Z]/gi;r.match(K)?oe.value=!1:oe.value=!0,await y(),await ve(),await nt(),await u(),await W(),await U()}catch(g){console.error("Error during initial mount:",g)}finally{H.value=!1}}),Ul(()=>{Jt(),qt.off("updateAppStatus",ze),qt.off("updateInstanceList",_)}),(g,r)=>{const K=Ki,ee=fl,we=vl,Se=Ni,_e=Di,Z=yi,Y=Ur,Ae=or,Xe=wn,$t=mo,yt=pl;return d(),T(De,null,[s("div",null,[s("div",Xi,[s("div",Zi,[t(B,{variant:"outlined",icon:"mdi-arrow-left-circle",density:"compact",class:"mr-1",color:"secondary",onClick:$}),t(Ee,{class:"current-task-chip",variant:"tonal",rounded:"pill"},{prepend:e(()=>[t(b,{size:"24",class:"mr-1"},{default:e(()=>[...r[32]||(r[32]=[n(" mdi-progress-tag ",-1)])]),_:1})]),default:e(()=>[s("span",Yi,c(ye.value),1)]),_:1})]),t(et,{class:"d-flex align-center my-1",style:{"max-width":"255px","flex-wrap":"nowrap"},"no-gutters":""},{default:e(()=>[O.value?(d(),C(Gt,{key:0,modelValue:O.value,"onUpdate:modelValue":[r[5]||(r[5]=J=>O.value=J),r[7]||(r[7]=async J=>{try{O.value=J,jt.value="",await W(),Q.value==="4"&&(Ga(),$a()),await U(!1)}catch(ae){console.error("Error in IP select handler:",ae)}})],menu:sa.value,"onUpdate:menu":r[6]||(r[6]=J=>sa.value=J),items:ya.value,variant:"outlined",density:"compact","hide-details":"",class:"flex-grow-1",style:{"min-width":"0"},"menu-props":{maxHeight:300,scrollToSelectedItem:!1}},{"prepend-inner":e(()=>[t(b,{icon:"mdi-laptop",size:"20",class:"mr-1"})]),item:e(({item:J,props:ae})=>[t(La,wt(ae,{title:J.value,color:"success"}),null,16,["title"])]),"prepend-item":e(()=>[s("div",Qi,[t(Zt,{modelValue:jt.value,"onUpdate:modelValue":r[0]||(r[0]=J=>jt.value=J),density:"compact",variant:"outlined",placeholder:a(f)("pages.apps.manage.searchIpPlaceholder"),"hide-details":"",clearable:"","onClick:clear":r[1]||(r[1]=()=>jt.value=""),onKeydown:r[2]||(r[2]=St(()=>{},["stop"])),onClick:r[3]||(r[3]=St(()=>{},["stop"])),onMousedown:r[4]||(r[4]=St(()=>{},["stop"]))},null,8,["modelValue","placeholder"])]),t(ra,{class:"mt-2"})]),_:1},8,["modelValue","menu","items"])):I("",!0),O.value?(d(),C(B,{key:1,icon:"",color:"success",density:"compact",variant:"tonal",class:ca(["ml-1",{"v-icon--disabled":N.value}]),loading:N.value,onClick:r[8]||(r[8]=J=>!N.value&&_())},{default:e(()=>[t(b,{size:"20"},{default:e(()=>[...r[33]||(r[33]=[n(" mdi-refresh ",-1)])]),_:1})]),_:1},8,["class","loading"])):I("",!0)]),_:1})]),He.value.length>0?(d(),C(rt,{key:0,color:"surface",class:"mt-2",elevation:"2"},{default:e(()=>[s("div",eu,[s("div",tu,[(d(!0),T(De,null,ut(He.value,(J,ae)=>(d(),T("div",{key:ae,class:"d-flex align-center"},[t(Ze,{location:"top"},{activator:e(({props:Ot})=>[s("div",wt({ref_for:!0},Ot,{class:"app-item d-flex align-center",style:{cursor:"pointer"}}),[t(b,{icon:"mdi-heart-pulse",color:z(J.state,J.status),size:"28",class:"mr-1"},null,8,["color"]),s("div",au,[t(Ee,{color:"info",variant:"tonal",size:"x-small",rounded:"pill",class:"mb-1"},{default:e(()=>[n(c(J.name),1)]),_:2},1024),t(Ee,{color:z(J.state,J.status),variant:"tonal",destiny:"comfort",size:"x-small",rounded:"pill",class:"d-flex align-center justify-center"},{default:e(()=>[n(c(J.state),1)]),_:2},1032,["color"])])],16)]),default:e(()=>[s("div",null,[s("div",lu,[t(b,{icon:"mdi-information",class:"mr-1",size:"16"}),r[34]||(r[34]=s("strong",null,"Image: ",-1)),n(" "+c(J.image),1)]),s("div",ou,[t(b,{icon:"mdi-clock",class:"mr-1",size:"16"}),r[35]||(r[35]=s("strong",null,"Status: ",-1)),n(" "+c(J.status)+" ",1),re.value&&!J.status?.includes("running")&&!J.status?.includes("healthy")?(d(),T("span",su," (standby mode)")):I("",!0)])])]),_:2},1024)]))),128))])])]),_:1})):I("",!0)]),H.value?(d(),C(rl,{key:0,icon:"mdi-hexagon-multiple","icon-size":68,"rotate-icon":"",title:a(f)("pages.apps.manage.messages.loadingTitle"),message:a(f)("pages.apps.manage.messages.loadingMessage")},null,8,["title","message"])):!O.value&&!L.value&&!H.value&&Be.value.data===null?(d(),C(rt,{key:1,class:"mt-4 mb-1"},{default:e(()=>[t(Dt,null,{default:e(()=>[t(ta,{color:"error",prominent:"",class:"mb-0"},{default:e(()=>[s("div",nu,[s("div",ru,[t(b,{size:"40",class:"mr-3 flex-shrink-0"},{default:e(()=>[...r[36]||(r[36]=[n("mdi-server-off",-1)])]),_:1}),s("div",iu,[s("div",uu,c(a(f)("pages.apps.manage.messages.noInstancesAvailableTitle")),1),s("div",du,c(a(f)("pages.apps.manage.messages.noInstancesAvailableMessage")),1)])]),s("div",cu,[t(B,{color:"white",variant:"text",size:"large",loading:N.value,onClick:r[9]||(r[9]=J=>_())},{default:e(()=>[t(b,{class:"mr-2"},{default:e(()=>[...r[37]||(r[37]=[n("mdi-refresh",-1)])]),_:1}),n(" "+c(a(f)("pages.apps.manage.messages.retry")),1)]),_:1},8,["loading"])])]),s("div",pu,[t(b,{class:"mr-3",size:"40"},{default:e(()=>[...r[38]||(r[38]=[n("mdi-server-off",-1)])]),_:1}),s("div",mu,[s("div",fu,c(a(f)("pages.apps.manage.messages.noInstancesAvailableTitle")),1),s("div",vu,c(a(f)("pages.apps.manage.messages.noInstancesAvailableMessage")),1)]),t(B,{color:"white",variant:"text",size:"large",loading:N.value,onClick:r[10]||(r[10]=J=>_()),class:"ml-4"},{default:e(()=>[t(b,{class:"mr-2"},{default:e(()=>[...r[39]||(r[39]=[n("mdi-refresh",-1)])]),_:1}),n(" "+c(a(f)("pages.apps.manage.messages.retry")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1})):(d(),T(De,{key:2},[!O.value&&L.value?(d(),C(ta,{key:0,color:"warning",variant:"tonal",class:"mt-3 mb-3",border:"start","border-color":"warning"},{prepend:e(()=>[t(b,null,{default:e(()=>[...r[40]||(r[40]=[n("mdi-alert-circle",-1)])]),_:1})]),default:e(()=>[s("div",gu,[s("div",yu,[s("div",bu,c(a(f)("pages.apps.manage.messages.noInstancesWarningTitle")),1),s("div",hu,c(a(f)("pages.apps.manage.messages.noInstancesWarningMessage")),1)]),t(B,{icon:"mdi-refresh",size:"small",variant:"text",color:"warning",onClick:r[11]||(r[11]=J=>_())})])]),_:1})):I("",!0),t(Sa,{modelValue:Q.value,"onUpdate:modelValue":r[12]||(r[12]=J=>Q.value=J),"show-arrows":"",class:"v-tabs-pill",style:{"margin-top":"1px","margin-bottom":"1px"}},{default:e(()=>[(d(!0),T(De,null,ut(Yt.value,J=>(d(),C(_a,{key:J.value,value:J.value},{default:e(()=>[n(c(J.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(rt,null,{default:e(()=>[t(Dt,null,{default:e(()=>[t(Ua,{modelValue:Q.value,"onUpdate:modelValue":r[30]||(r[30]=J=>Q.value=J)},{default:e(()=>[(d(!0),T(De,null,ut(Rt.value,J=>(d(),C(Aa,{key:J.value,value:J.value},{default:e(()=>[L.value&&J.value==="1"?(d(),T("div",wu,[t(K,{modelValue:dt.value,"onUpdate:modelValue":r[13]||(r[13]=ae=>dt.value=ae),icon:"mdi-cube-outline","text-on":a(f)("pages.apps.manage.specification.local"),"text-off":a(f)("pages.apps.manage.specification.global"),"icon-after-true":"mdi-wifi","icon-after-false":"mdi-wifi-off",color:"info",variant:"tonal",rounded:"md","icon-state":o.value,disabled:!O.value,"class-name":"mb-0"},null,8,["modelValue","text-on","text-off","icon-state","disabled"]),s("div",{style:Ft({display:"grid",gridTemplateColumns:L.value?.version>=6?"1fr 1fr 1fr":"1fr 1fr",gap:"8px"}),class:"mt-3 mb-2"},[t(B,{variant:"flat",color:"primary",size:"small",onClick:r[14]||(r[14]=()=>{F.value="update",Q.value="10"})},{default:e(()=>[t(b,{size:"16",class:"mr-2"},{default:e(()=>[...r[41]||(r[41]=[n("mdi-update",-1)])]),_:1}),n(" "+c(g.$t("core.appDetailsCard.updateSubscription")),1)]),_:1}),t(B,{variant:"flat",color:"success",size:"small",onClick:r[15]||(r[15]=()=>{F.value="renewal",Q.value="10"})},{default:e(()=>[t(b,{size:"16",class:"mr-2"},{default:e(()=>[...r[42]||(r[42]=[n("mdi-refresh",-1)])]),_:1}),n(" "+c(g.$t("core.appDetailsCard.renewSubscription")),1)]),_:1}),L.value?.version>=6?(d(),C(B,{key:0,variant:"flat",color:"error",size:"small",onClick:r[16]||(r[16]=()=>{F.value="cancel",Q.value="10"})},{default:e(()=>[t(b,{size:"16",class:"mr-2"},{default:e(()=>[...r[43]||(r[43]=[n("mdi-cancel",-1)])]),_:1}),n(" "+c(g.$t("core.appDetailsCard.cancelSubscription")),1)]),_:1})):I("",!0)],4),s("div",null,[s("div",xu,[t(Ee,{color:"info",variant:"tonal",class:"w-100",style:{padding:"8px 16px","border-radius":"6px","font-family":"monospace","font-size":"18px"}},{default:e(()=>[t(b,{size:"22",class:"ml-1"},{default:e(()=>[...r[44]||(r[44]=[n(" mdi-information-outline ",-1)])]),_:1}),s("span",ku,c(g.$t("core.appDetailsCard.general")),1)]),_:1})])]),t(ee,{app:L.value,"get-new-expire-label":ke(L.value.expire,L.value.height),"show-general-section":!1,class:"px-4"},null,8,["app","get-new-expire-label"]),s("div",null,[s("div",_u,[t(Ee,{color:"info",variant:"tonal",class:"composition-chip w-100"},{default:e(()=>[t(b,{size:"22",class:"ml-1"},{default:e(()=>[...r[45]||(r[45]=[n(" mdi-hexagon-multiple ",-1)])]),_:1}),s("span",$u,c(a(f)("pages.apps.manage.composition")),1)]),_:1})]),t(Sa,{modelValue:ht.value,"onUpdate:modelValue":r[17]||(r[17]=ae=>ht.value=ae),"align-tabs":"start","background-color":"transparent",color:"primary","hide-slider":"",density:"comfortable",class:"v-tabs-pill"},{default:e(()=>[(d(!0),T(De,null,ut(X(L.value),(ae,Ot)=>(d(),C(_a,{key:Ot,value:Ot,class:"v-tabs-pill text-no-transform"},{default:e(()=>[t(b,{size:"18",class:"mr-1"},{default:e(()=>[...r[46]||(r[46]=[n(" mdi-cube ",-1)])]),_:1}),n(" "+c(ae.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Ua,{modelValue:ht.value,"onUpdate:modelValue":r[18]||(r[18]=ae=>ht.value=ae),class:"pa-4",touch:!1},{default:e(()=>[(d(!0),T(De,null,ut(X(L.value),(ae,Ot)=>(d(),C(Aa,{key:Ot,value:Ot},{default:e(()=>[t(ll,{mode:"out-in"},{default:e(()=>[s("div",null,[t(we,{component:ae,"app-name":L.value.name||"",index:Ot},null,8,["component","app-name","index"])])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])])):L.value&&J.value==="2"?(d(),T("div",Cu,[ge.value.length>0?(d(),C(Se,{key:0,data:ge.value,title:a(f)("pages.apps.manage.titles.inspectDetails")},null,8,["data","title"])):!ue.value&&ge.value.length===0?(d(),C(Wt,{key:1,indeterminate:"",color:"primary"})):I("",!0),ue.value?(d(),C(ta,{key:2,color:"error",icon:"$error",text:h.value},null,8,["text"])):I("",!0)])):L.value&&J.value==="3"?(d(),T("div",zu,[ne.value.length>0?(d(),C(Se,{key:0,data:ne.value,title:a(f)("pages.apps.manage.titles.fileChanges"),icon:"mdi-file-arrow-left-right-outline",message:a(f)("pages.apps.manage.messages.fileChangesDescription")},null,8,["data","title","message"])):!ue.value&&ne.value.length===0?(d(),C(Wt,{key:1,indeterminate:"",color:"primary"})):I("",!0),ue.value?(d(),C(ta,{key:2,color:"error",icon:"$error",text:h.value},null,8,["text"])):I("",!0)])):L.value&&J.value==="4"?(d(),T("div",Su,[t(et,{class:"mb-2"},{default:e(()=>[t(me,{cols:"12",class:"d-flex align-center"},{default:e(()=>[s("div",Au,[s("div",Vu,[t(Nt,{size:"35",color:"success",variant:"tonal",rounded:"sm",class:"mr-2 ml-1"},{default:e(()=>[t(b,{size:"28"},{default:e(()=>[...r[47]||(r[47]=[n(" mdi-chart-bar ",-1)])]),_:1})]),_:1}),s("span",Tu,c(k.value),1)]),s("div",null,[t(ga,{modelValue:We.value,"onUpdate:modelValue":r[19]||(r[19]=ae=>We.value=ae),class:"mr-1",label:a(f)("pages.apps.manage.labels.historyStatistics"),inset:"",onChange:zt},null,8,["modelValue","label"])])])]),_:1})]),_:1}),ue.value?(d(),C(ta,{key:0,color:"error",icon:"$error",text:h.value,class:"mb-8"},null,8,["text"])):I("",!0),t(et,{class:"d-flex align-center mb-4 flex-nowrap","no-gutters":""},{default:e(()=>[t(me,{class:"d-flex align-center gap-2 flex-nowrap",style:{width:"100%"}},{default:e(()=>[L.value?(d(),C(Gt,{key:0,modelValue:xt.value,"onUpdate:modelValue":r[20]||(r[20]=ae=>xt.value=ae),items:L.value.compose?.map(ae=>ae.name),label:xt.value?a(f)("pages.apps.manage.labels.component"):a(f)("pages.apps.manage.labels.selectComponent"),density:"comfortable",style:{"max-width":"320px"},disabled:l.value,class:"centered-select"},{"prepend-inner":e(()=>[t(b,{icon:"mdi-docker",size:"20"})]),_:1},8,["modelValue","items","label","disabled"])):I("",!0),We.value?(d(),C(B,{key:1,icon:"",color:"success",density:"comfortable",variant:"tonal",onClick:Ra},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...r[48]||(r[48]=[n(" mdi-refresh ",-1)])]),_:1})]),_:1})):I("",!0),!We.value&&Mt.value===!0?(d(),C(B,{key:2,icon:"",color:"success",density:"comfortable",variant:"tonal",onClick:r[21]||(r[21]=ae=>$a(!0))},{default:e(()=>[t(b,{size:"24"},{default:e(()=>[...r[49]||(r[49]=[n(" mdi-refresh ",-1)])]),_:1})]),_:1})):I("",!0)]),_:1}),t(me,{class:"d-flex flex-wrap align-center justify-end gap-4"},{default:e(()=>[We.value?I("",!0):(d(),C(Gt,{key:0,modelValue:ct.value,"onUpdate:modelValue":r[22]||(r[22]=ae=>ct.value=ae),items:pt,label:a(f)("pages.apps.manage.labels.points"),density:"comfortable",style:{"max-width":"110px"}},{"prepend-inner":e(()=>[t(b,{icon:"mdi-file-chart",size:"16"})]),_:1},8,["modelValue","label"])),We.value?I("",!0):(d(),C(Gt,{key:1,modelValue:Kt.value,"onUpdate:modelValue":r[23]||(r[23]=ae=>Kt.value=ae),items:At,label:a(f)("pages.apps.manage.labels.refreshRate"),density:"comfortable",style:{"max-width":"110px"}},{"prepend-inner":e(()=>[t(b,{icon:"mdi-clock-time-eight-outline",size:"16"})]),_:1},8,["modelValue","label"])),We.value?(d(),C(Gt,{key:2,modelValue:ce.value,"onUpdate:modelValue":[r[24]||(r[24]=ae=>ce.value=ae),Ra],items:lt.value,label:a(f)("pages.apps.manage.labels.timeRange"),density:"comfortable",style:{"max-width":"140px"}},null,8,["modelValue","items","label"])):I("",!0)]),_:1})]),_:1}),t(et,{dense:""},{default:e(()=>[t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Ru,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[50]||(r[50]=[n(" mdi-chart-line ",-1)])]),_:1}),r[53]||(r[53]=s("span",{class:"text-h6"},"CPU usage",-1)),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[51]||(r[51]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[r[52]||(r[52]=n(" Displays CPU usage over time. Helps identify high load periods and performance bottlenecks. ",-1))]),_:1})]),r[54]||(r[54]=s("canvas",{id:"cpuChart"},null,-1))]),_:1})]),_:1}),t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Iu,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[55]||(r[55]=[n(" mdi-chart-line ",-1)])]),_:1}),r[58]||(r[58]=s("span",{class:"text-h6"},"Memory usage",-1)),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[56]||(r[56]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[r[57]||(r[57]=n(" Displays memory usage over time. Helps identify memory leaks and optimize performance. ",-1))]),_:1})]),r[59]||(r[59]=s("canvas",{id:"memoryChart"},null,-1))]),_:1})]),_:1}),t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Du,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[60]||(r[60]=[n(" mdi-chart-line ",-1)])]),_:1}),r[63]||(r[63]=s("span",{class:"text-h6"},"Network usage (aggregate)",-1)),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[61]||(r[61]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[r[62]||(r[62]=n(" TX = Transmit, RX = Receive. Useful for spotting bottlenecks and measuring bandwidth. ",-1))]),_:1})]),r[64]||(r[64]=s("canvas",{id:"networkChart"},null,-1))]),_:1})]),_:1}),t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Uu,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[65]||(r[65]=[n(" mdi-chart-line ",-1)])]),_:1}),r[68]||(r[68]=s("span",{class:"text-h6"},"I/O usage (aggregate)",-1)),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[66]||(r[66]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[r[67]||(r[67]=n(" Displays read/write disk activity. Useful for detecting performance bottlenecks. ",-1))]),_:1})]),r[69]||(r[69]=s("canvas",{id:"ioChart"},null,-1))]),_:1})]),_:1}),t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Lu,[t(b,{class:"mr-2",size:"25"},{default:e(()=>[...r[70]||(r[70]=[n(" mdi-chart-line ",-1)])]),_:1}),s("span",Bu,c(a(f)("pages.apps.manage.persistentStorage")),1),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[71]||(r[71]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[n(" "+c(a(f)("pages.apps.manage.persistentStorageTooltip")),1)]),_:1})]),r[72]||(r[72]=s("canvas",{id:"diskPersistentChart"},null,-1))]),_:1})]),_:1}),t(me,{cols:"12",md:"6",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Fu,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[73]||(r[73]=[n(" mdi-chart-line ",-1)])]),_:1}),s("span",Eu,c(a(f)("pages.apps.manage.rootFilesystem")),1),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[74]||(r[74]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[n(" "+c(a(f)("pages.apps.manage.rootFilesystemTooltip")),1)]),_:1})]),r[75]||(r[75]=s("canvas",{id:"diskFileSystemChart"},null,-1))]),_:1})]),_:1}),We.value?I("",!0):(d(),C(me,{key:0,cols:"12",class:"pa-2"},{default:e(()=>[t(rt,{class:"pa-3 mb-2"},{default:e(()=>[s("div",Pu,[t(b,{class:"mr-2",size:"26"},{default:e(()=>[...r[76]||(r[76]=[n(" mdi-format-list-bulleted ",-1)])]),_:1}),r[79]||(r[79]=s("span",{class:"text-h6"},"Processes",-1)),t(Ze,{bottom:""},{activator:e(({props:ae})=>[t(b,wt({size:"18",class:"ml-2"},{ref_for:!0},ae),{default:e(()=>[...r[77]||(r[77]=[n(" mdi-information ",-1)])]),_:1},16)]),default:e(()=>[r[78]||(r[78]=n(" List of running processes in container. ",-1))]),_:1})]),t(Zt,{modelValue:E.value,"onUpdate:modelValue":r[25]||(r[25]=ae=>E.value=ae),placeholder:a(f)("pages.apps.manage.placeholders.searchProcesses"),class:"mb-2"},{"append-inner":e(()=>[t(b,{size:"20"},{default:e(()=>[...r[80]||(r[80]=[n(" tabler-search ",-1)])]),_:1})]),_:1},8,["modelValue","placeholder"]),t(wa,{border:"",rounded:"",class:"mt-4",style:{"max-height":"none",overflow:"visible"}},{default:e(()=>[t(fa,{items:Ve.value,headers:Pe,dense:"",class:"table-monitoring","items-per-page":de.value,"hide-default-footer":"","no-data-text":a(f)("pages.apps.manage.messages.noRecordsAvailable")},null,8,["items","items-per-page","no-data-text"])]),_:1}),t(et,{class:"align-center justify-space-between mt-2"},{default:e(()=>[t(me,{cols:"auto"},{default:e(()=>[be.value.length?(d(),C(Tl,{key:0,modelValue:A.value,"onUpdate:modelValue":r[26]||(r[26]=ae=>A.value=ae),length:Math.ceil(be.value.length/de.value),"total-visible":"5",size:"small",onInput:tt},null,8,["modelValue","length"])):I("",!0)]),_:1}),t(me,{cols:"auto",class:"d-flex align-center"},{default:e(()=>[s("span",Mu,c(a(f)("pages.apps.manage.labels.itemsPerPage"))+":",1),t(Gt,{modelValue:de.value,"onUpdate:modelValue":r[27]||(r[27]=ae=>de.value=ae),items:Je,density:"compact","hide-details":"",style:{"max-width":"100px"},onChange:tt},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})])):L.value&&J.value==="5"?(d(),T("div",ju,[t(_e,{"app-specification":L.value,"execute-local-command":Ne},null,8,["app-specification"])])):L.value&&J.value==="6"?(d(),T("div",Ou,[t(Z,{"app-spec":L.value,"selected-ip":O.value,logout:V},null,8,["app-spec","selected-ip"]),t(Y,{"app-spec":L.value,"is-compose-single":l.value,"execute-local-command":Ne,"ip-access":oe.value,"selected-ip":O.value},null,8,["app-spec","is-compose-single","ip-access","selected-ip"])])):L.value&&J.value==="7"?(d(),T("div",Nu,[t(Ae,{"app-spec":L.value,"execute-local-command":Ne,instances:kt.value.data.map(ae=>ae.ip),"current-instance-ip":O.value,"ip-access":oe.value,"is-compose-single":l.value,logout:V},null,8,["app-spec","instances","current-instance-ip","ip-access","is-compose-single"])])):L.value?.compose&&J.value==="8"&&a(w)!=="fluxteam"?(d(),T("div",qu,[(d(),C(Xe,{key:Q.value,"app-spec":L.value,"execute-local-command":Ne,"ip-access":oe.value,"is-compose-single":l.value,"current-instance-ip":O.value},null,8,["app-spec","ip-access","is-compose-single","current-instance-ip"]))])):L.value&&J.value==="9"?(d(),T("div",Hu,[(d(),C($t,{key:S.value,"master-slave-app":re.value,"master-ip":le.value,instances:kt.value,"app-specs":L.value,"selected-node":O.value},null,8,["master-slave-app","master-ip","instances","app-specs","selected-node"]))])):qe.value&&J.value==="10"?(d(),T("div",Wu,[t(yt,{"app-spec":Oe.value,"new-app":!1,"execute-local-command":O.value?Ne:void 0,"reset-trigger":Ue.value,"instance-ready":!!qe.value,"initial-action":F.value,onSpecConverted:Re},null,8,["app-spec","execute-local-command","reset-trigger","instance-ready","initial-action"])])):Ce.value?(d(),T("div",Ju,[t(Wt,{indeterminate:"",color:"primary"})])):I("",!0),at.value?(d(),C(ta,{key:11,color:"error",density:"comfortable",class:"pa-3"},{default:e(()=>[s("div",Gu,[t(b,{icon:"mdi-alert-circle",class:"mr-2",size:"34"}),r[81]||(r[81]=s("div",{class:"flex-grow-1"},[s("div",{class:"font-weight-bold mb-1"},"Unable to Load Installed App Specification"),s("div",{class:"text-body-2"},"The app specification is empty or invalid. This may indicate the app is not properly installed.")],-1)),t(B,{icon:"mdi-refresh",color:"white",variant:"text",loading:Ce.value,onClick:r[28]||(r[28]=ae=>g.getInstalledAppSpecification()),class:"ml-2"},null,8,["loading"])])]),_:1})):I("",!0),ue.value&&!at.value?(d(),C(ta,{key:12,color:"error",density:"comfortable",class:"pa-3"},{default:e(()=>[s("div",Ku,[t(b,{icon:"mdi-alert-decagram",class:"mr-2",size:"34"}),s("div",Xu,c(h.value),1),t(B,{icon:"mdi-refresh",color:"white",variant:"text",class:ca([{"v-icon--disabled":N.value},"ml-2"]),loading:N.value,onClick:r[29]||(r[29]=ae=>!N.value&&_())},null,8,["class","loading"])])]),_:1})):I("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})],64)),t(Va,{modelValue:Le.value,"onUpdate:modelValue":r[31]||(r[31]=J=>Le.value=J),color:Te.value,timeout:"4000",location:"top",elevation:"4"},{default:e(()=>[n(c(se.value),1)]),_:1},8,["modelValue","color"])],64)}}},Xd=aa(Zu,[["__scopeId","data-v-d16fe6e3"]]);export{Xd as default};
