import{r as x,$ as P,o as q,n as S,w as Q,f as y,g as b,a3 as e,P as k,x as R,Q as n,q as H,y as h,j as c,T as w,U as m,aA as J}from"./apexcharts-nIAyciCq.js";import{_ as K}from"./MapComponent-D1NdOhsg.js";import{a as W}from"./http-BZQDkn3h.js";import{_ as X,e as Y,x as Z}from"./index-QPPWK7xw.js";import{s as oo}from"./vue-core-CU9AIURn.js";import{a as to,g as eo,b as ao}from"./useSEO-5BaNf11O.js";import{o as D,p as V,V as C,d as so,Q as L,b as z,g as E,s as T,ah as F,G as N}from"./vuetify-_4u1He_j.js";import{u as no}from"./i18n-Bm8bpAAW.js";import"./leaflet-core-jNE0Bq0j.js";import"./leaflet-cluster-0ODEUdTP.js";import"./LoadingSpinner-BLJvP0iy.js";import"./ansi-utils-ChIB8aIv.js";import"./crypto-metamask-D6vz180a.js";import"./socketio-BDGyx5_k.js";import"./uuid-B49X2dQj.js";import"./vueuse-Bid7ZbHY.js";import"./unhead-DEOrWl0D.js";import"./cookie-BfmCf_44.js";import"./unjs-utils-GcjLqAqW.js";import"./query-parser-C3-dT-Rr.js";import"./casl-DNC8KRD8.js";import"./scrollbar-CXs_Utq1.js";import"./icons-mdi-_QP0sdRJ.js";import"./sanitizer-DAUAC_Zc.js";import"./element-plus-Cr1Qs4Q_.js";import"./lodash-C_Sw0jJq.js";const ro={class:"d-flex align-center mb-3"},io={class:"text-h4 mb-1"},lo={class:"text-body-2 mb-0 text-medium-emphasis"},co={class:"text-body-1 mb-0"},uo={class:"location-card-wrapper"},po={class:"location-card-header"},mo={class:"text-h5 mb-0"},ho={key:1,class:"no-data"},go={class:"location-card-wrapper"},fo={class:"location-card-header"},vo={class:"text-h5 mb-0"},bo={key:1,class:"no-data"},_o={__name:"locations",setup(xo){const{t:i}=no();to({title:"Flux Node Locations - Global Network Map | FluxCloud",description:"Explore the global distribution of 8,000+ FluxNodes. Interactive map showing node locations across 70+ countries. View network decentralization and geographic spread of Flux infrastructure worldwide.",url:"https://cloud.runonflux.com/dashboards/locations",keywords:"flux node map, node locations, global network, geographic distribution, flux nodes worldwide, decentralized network map, node distribution, blockchain network map",structuredData:[eo(),ao([{name:"Home",url:"https://cloud.runonflux.com"},{name:"Flux Network",url:"https://cloud.runonflux.com/dashboards/overview"},{name:"Locations",url:"https://cloud.runonflux.com/dashboards/locations"}])]});const d=x([]),_=x(0),B=x(null),I=x(null),g=x(!0),u=P({series:[],chartOptions:{chart:{toolbar:{show:!1}},dataLabels:{enabled:!0},legend:{show:!0,position:"bottom",height:100},stroke:{width:0},plotOptions:{pie:{donut:{size:"40%"}}},responsive:[{breakpoint:600,options:{chart:{height:400},legend:{show:!0,position:"bottom",height:80,fontSize:"10px"},dataLabels:{enabled:!0}}}]}}),p=P({series:[],chartOptions:{chart:{toolbar:{show:!1}},dataLabels:{enabled:!0},legend:{show:!0,position:"bottom",height:100},stroke:{width:0},plotOptions:{pie:{donut:{size:"40%"}}},responsive:[{breakpoint:600,options:{chart:{height:400},legend:{show:!0,position:"bottom",height:80,fontSize:"10px"},dataLabels:{enabled:!0}}}]}}),M=Y(),{theme:v}=oo(M),$=async()=>{try{const o=await W.get("https://stats.runonflux.io/fluxinfo?projection=geolocation,ip,tier");d.value=o.data.data||[],console.log("fluxList length:",d.value.length);const a=await Z.fluxnodeCount();_.value=a.data.data.total||0,console.log("fluxNodeCount:",_.value)}catch(o){console.error("Error fetching flux list:",o),d.value=[],_.value=0}},j=async()=>{try{const o=[],a=[],r=[];d.value.forEach(t=>{const s=t.geolocation?.country||i("pages.dashboard.locations.unknown"),l=r.find(f=>f.country===s);l?l.amount+=1:r.push({country:s,amount:1})});for(let t=0;t<_.value-d.value.length;t++){const s=i("pages.dashboard.locations.unknown"),l=r.find(f=>f.country===s);l?l.amount+=1:r.push({country:s,amount:1})}r.sort((t,s)=>s.amount-t.amount),r.forEach(t=>{o.push(`${t.country} (${t.amount})`),a.push(t.amount)}),p.series=a,p.chartOptions={...p.chartOptions,labels:o}}catch(o){console.error("Error generating geographic pie:",o),p.series=[]}},G=async()=>{try{const o=[],a=[],r=[];d.value.forEach(t=>{const s=t.geolocation?.org||i("pages.dashboard.locations.unknown"),l=r.find(f=>f.org===s);l?l.amount+=1:r.push({org:s,amount:1})});for(let t=0;t<_.value-d.value.length;t++){const s=i("pages.dashboard.locations.unknown"),l=r.find(f=>f.org===s);l?l.amount+=1:r.push({org:s,amount:1})}r.sort((t,s)=>s.amount-t.amount),r.forEach(t=>{o.push(`${t.org} (${t.amount})`),a.push(t.amount)}),u.series=a,u.chartOptions={...u.chartOptions,labels:o}}catch(o){console.error("Error generating provider pie:",o),u.series=[]}},A=()=>p.series.length>0?p.series.length:0,U=()=>u.series.length>0?u.series.length:0,O=()=>{const o=document.querySelector(".map");v.value==="dark"&&!o.classList.contains("dark-theme")?(console.log("Forcing dark-theme class on mount"),o.classList.add("dark-theme")):v.value!=="dark"&&o.classList.contains("dark-theme")&&(console.log("Forcing removal of dark-theme class on mount"),o.classList.remove("dark-theme"))};return q(async()=>{console.log("ðŸŸ¢ onMounted: Starting"),console.log("Initial theme:",v.value,"Type:",typeof v.value),O(),g.value=!0;try{console.log("ðŸ”„ Fetching flux list..."),await $(),console.log("âœ… Flux list fetched, awaiting DOM update..."),await S(),setTimeout(async()=>{console.log("ðŸ“Š Starting both pie generations in parallel...");const o=j(),a=G();await Promise.all([o,a]),console.log("âœ… Both pie charts generated"),g.value=!1},1e3)}catch(o){console.error("âŒ Error during initialization:",o),g.value=!1}}),Q(()=>v.value,async(o,a)=>{console.log("Theme changed from:",a,"to:",o),O(),await S()}),(o,a)=>{const r=K,t=J;return b(),y("div",{class:H(["map",{"dark-theme":h(v).value==="dark"}])},[e(D,{class:"mb-3"},{default:n(()=>[e(V,{cols:"12"},{default:n(()=>[e(C,{class:"locations-intro-card"},{default:n(()=>[e(so,null,{default:n(()=>[c("div",ro,[e(L,{size:"48",color:"primary",variant:"tonal",class:"mr-3"},{default:n(()=>[e(z,{size:"28"},{default:n(()=>[...a[2]||(a[2]=[w("mdi-earth",-1)])]),_:1})]),_:1}),c("div",null,[c("h2",io,m(h(i)("pages.dashboard.locations.intro.title")),1),c("p",lo,m(h(i)("pages.dashboard.locations.intro.subtitle")),1)])]),c("p",co,m(h(i)("pages.dashboard.locations.intro.description")),1)]),_:1})]),_:1})]),_:1})]),_:1}),d.value.length>0?(b(),k(r,{key:0,nodes:d.value,class:"mb-6"},null,8,["nodes"])):R("",!0),e(D,null,{default:n(()=>[e(V,{md:"6",sm:"12",cols:"12"},{default:n(()=>[c("div",uo,[c("div",po,[e(L,{size:"48",color:"secondary",variant:"tonal",class:"mr-3"},{default:n(()=>[e(z,{size:"24"},{default:n(()=>[...a[3]||(a[3]=[w(" mdi-map-marker ",-1)])]),_:1})]),_:1}),c("h3",mo,m(h(i)("pages.dashboard.locations.geographicTitle")),1),e(E),e(T,{color:"success",size:"small"},{default:n(()=>[w(m(A()),1)]),_:1})]),e(C,{style:{overflow:"visible !important","clip-path":"none !important","min-height":"400px","padding-top":"30px !important"},class:"location-card-content"},{default:n(()=>[e(F,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=s=>g.value=s),contained:"",persistent:"","scroll-strategy":"none",class:"align-center justify-center overlay"},{default:n(()=>[e(N,{indeterminate:""})]),_:1},8,["modelValue"]),p.series.length>0?(b(),k(t,{key:0,ref_key:"geoChart",ref:B,type:"donut",height:"400",width:"100%",options:p.chartOptions,series:p.series},null,8,["options","series"])):(b(),y("div",ho,m(h(i)("pages.dashboard.locations.noGeographicData")),1))]),_:1})])]),_:1}),e(V,{md:"6",sm:"12",cols:"12"},{default:n(()=>[c("div",go,[c("div",fo,[e(L,{size:"48",color:"secondary",variant:"tonal",class:"mr-3"},{default:n(()=>[e(z,{size:"24"},{default:n(()=>[...a[4]||(a[4]=[w(" mdi-server-network ",-1)])]),_:1})]),_:1}),c("h3",vo,m(h(i)("pages.dashboard.locations.providersTitle")),1),e(E),e(T,{color:"success",size:"small"},{default:n(()=>[w(m(U()),1)]),_:1})]),e(C,{style:{overflow:"visible !important","clip-path":"none !important","min-height":"400px","padding-top":"30px !important"},class:"location-card-content"},{default:n(()=>[e(F,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=s=>g.value=s),contained:"",persistent:"","scroll-strategy":"none",class:"align-center justify-center overlay"},{default:n(()=>[e(N,{indeterminate:""})]),_:1},8,["modelValue"]),u.series.length>0?(b(),k(t,{key:0,ref_key:"providerChart",ref:I,type:"donut",height:"400",width:"100%",options:u.chartOptions,series:u.series},null,8,["options","series"])):(b(),y("div",bo,m(h(i)("pages.dashboard.locations.noProviderData")),1))]),_:1})])]),_:1})]),_:1})],2)}}},Ho=X(_o,[["__scopeId","data-v-f431c6aa"]]);export{Ho as default};
