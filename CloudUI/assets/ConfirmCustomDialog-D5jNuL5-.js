import{_ as ae}from"./MapComponent-D1NdOhsg.js";import{a as ne}from"./http-BZQDkn3h.js";import{_ as G}from"./index-QPPWK7xw.js";import{p as J,a0 as oe,I as ie,F as H,b as M,o as se,a1 as re,c as O,s as F,a3 as le,ac as ce,d as Q,V as Z,n as de,a as ue,J as pe,f as me,g as fe,h as he}from"./vuetify-_4u1He_j.js";import{u as X}from"./i18n-Bm8bpAAW.js";import{r as W,c as _,w as K,o as ee,f as b,g as u,x as P,j as l,P as B,a3 as s,Q as i,y as d,L as q,T as E,U as m,q as z,b as ge,k as Y,F as T,l as U,p as ye}from"./apexcharts-nIAyciCq.js";import{g as j}from"./geolocation-BklMEt0S.js";import{E as ke}from"./ExplorerService-oc3qiwdf.js";import{D as be}from"./DaemonService-D09C4O6H.js";const ve={class:"table-wrapper"},xe={key:0,class:"map-wrapper d-flex justify-center"},we={class:"map-inner"},Ce={class:"table-wrapper-location mt-4"},De={class:"d-flex align-center"},$e={class:"d-flex align-center"},Ae={class:"d-flex align-center"},Pe={class:"d-flex align-center"},Ve={class:"d-flex align-center"},Ne={class:"d-flex align-center"},Se={key:0,class:"d-flex align-center text-no-wrap"},Me={key:0,class:"d-flex align-center text-no-wrap"},Be={key:0,class:"d-flex align-center text-no-wrap"},Ee={class:"d-flex justify-end"},Le={__name:"Locations",props:{appLocations:{type:Array,default:()=>[]},expanded:{type:Boolean,default:!1},appSpec:{type:Object,required:!0},showLocation:{type:Boolean,default:!1},selectedNode:{type:String,default:""}},setup(e){const n=e,{t}=X(),$=W(n.expanded),p=W({perPage:5,pageOptions:[5,10,25,50,100],currentPage:1,filter:"",sortBy:[]}),S=_(()=>[{key:"ip",title:t("core.locations.ipAddress"),sortable:!0,cellClass:"column-ip",headerProps:{class:"column-ip"}},{key:"osUptime",title:t("core.locations.uptime"),sortable:!0,cellClass:"column-uptime",headerProps:{class:"column-uptime"}},{key:"runningSince",value:"runningSince",title:t("core.locations.running"),sortable:!0,cellClass:"column-running",headerProps:{class:"column-running"}},...n.showLocation?[{key:"continent",title:t("core.locations.continent"),sortable:!0,cellClass:"column-continent",headerProps:{class:"column-continent"}}]:[],...n.showLocation?[{key:"country",title:t("core.locations.country"),sortable:!0,cellClass:"column-country",headerProps:{class:"column-country"}}]:[],...n.showLocation?[{key:"region",title:t("core.locations.region"),sortable:!0,cellClass:"column-region",headerProps:{class:"column-region"}}]:[],{key:"visit",title:"",sortable:!1}]),N={ip:"mdi-laptop",osUptime:"mdi-home-clock",running:"mdi-clock-fast",continent:"mdi-earth",country:"mdi-flag",region:"mdi-map-marker"},C=_(()=>g.value.map(r=>r.ip)),f=_(()=>C.value.map(r=>typeof r=="string"?r:r.ip).join(",")),g=_(()=>{const r=p.value.filter?.toLowerCase();return r?n.appLocations.filter(o=>{const h=o.ip?.toLowerCase().includes(r),a=o.continent?.toLowerCase().includes(r),v=o.country?.toLowerCase().includes(r),A=o.region?.toLowerCase().includes(r);return h||a||v||A}):n.appLocations});_(()=>{const r=(p.value.currentPage-1)*p.value.perPage,o=r+p.value.perPage;return g.value.slice(r,o)}),K(()=>n.expanded,r=>{$.value=r}),K(()=>p.value.filter,()=>{p.value.currentPage=1});function x(r){if(!r||isNaN(r))return t("core.locations.notAvailable");const o=Math.floor(r/86400),h=Math.floor(r%86400/3600),a=Math.floor(r%3600/60),v=[];return o>0&&v.push(`${o}d`),(h>0||o>0)&&v.push(`${h}h`),v.push(`${a}m`),v.join(" ")}function V(r){if(r.port)return r.port;if(Array.isArray(r.ports)&&r.ports.length>0)return r.ports[0];if(Array.isArray(r.compose)){for(const o of r.compose)if(Array.isArray(o.ports)&&o.ports.length>0)return o.ports[0]}return null}function I(r){window.open(r,"_blank")?.focus()}function c(r,o,h){o&&h?I(`http://${o}:${h}`):console.error("No port provided for App")}function y(r,o){r&&o?I(`http://${r}:${o}`):console.error("No FluxNode port available")}async function k(r,o=5){const h=[],a=[];for(const v of r){const A=v().then(R=>(a.splice(a.indexOf(A),1),R));h.push(A),a.push(A),a.length>=o&&await Promise.race(a)}return Promise.all(h)}async function w(){try{const r=n.appLocations.map(o=>async()=>{const h=o.ip.split(":")[0],a=o.ip.split(":")[1]||16127,v=`http://${h}:${a}/flux/geolocation`;try{const A=await ne.get(v);A.data?.status==="success"?(o.continent=A.data.data.continent||"N/A",o.country=A.data.data.country||"N/A",o.region=A.data.data.regionName||"N/A"):(o.continent="N/A",o.country="N/A",o.region="N/A")}catch(A){console.error(`Error fetching geolocation for ${h}:${a}`,A),o.continent="N/A",o.country="N/A",o.region="N/A"}});await k(r,10)}catch(r){console.error("Error fetching locations:",r)}}function D(r){const o=new Date(r),a=new Date-o,v=Math.floor(a/(1e3*60*60*24)),A=Math.floor(a%(1e3*60*60*24)/(1e3*60*60)),R=Math.floor(a%(1e3*60*60)/(1e3*60));return`${v}d ${A}h ${R}m`}return ee(async()=>{n.showLocation&&await w()}),(r,o)=>{const h=ae;return u(),b("div",ve,[$.value&&C.value.length?(u(),b("div",xe,[l("div",we,[(u(),B(h,{key:f.value,class:"mb-0","show-all":!1,"filter-nodes":C.value},null,8,["filter-nodes"]))])])):P("",!0),l("div",Ce,[s(se,{class:"align-center"},{default:i(()=>[s(J,{cols:"4"},{default:i(()=>[s(oe,{modelValue:p.value.perPage,"onUpdate:modelValue":o[0]||(o[0]=a=>p.value.perPage=a),label:d(t)("core.locations.perPage"),items:p.value.pageOptions,density:"compact",class:"flex-grow-1"},null,8,["modelValue","label","items"])]),_:1}),s(J,{cols:"8"},{default:i(()=>[s(ie,{modelValue:p.value.filter,"onUpdate:modelValue":o[2]||(o[2]=a=>p.value.filter=a),label:d(t)("core.locations.filter"),density:"compact",variant:"outlined",placeholder:d(t)("core.locations.typeToSearch"),clearable:"",class:"flex-grow-1"},{"prepend-inner":i(()=>[s(M,{size:"20"},{default:i(()=>[...o[6]||(o[6]=[E(" tabler-search ",-1)])]),_:1})]),"append-inner":i(()=>[s(H,{text:d(t)("core.locations.selectActiveInstance")},{activator:i(({props:a})=>[e.selectedNode?(u(),B(M,q({key:0},a,{icon:"mdi-map-marker-radius-outline",size:"20",class:"mx-1",onClick:o[1]||(o[1]=v=>p.value.filter=e.selectedNode)}),null,16)):P("",!0)]),_:1},8,["text"])]),_:1},8,["modelValue","label","placeholder"])]),_:1})]),_:1}),s(le,{border:"",rounded:"",class:z(g.value.length>=5?"mb-2 mt-4":"mb-4 mt-4"),style:{"max-height":"none",overflow:"visible"}},{default:i(()=>[s(re,{headers:S.value,items:g.value,"items-per-page":p.value.perPage,page:p.value.currentPage,"onUpdate:page":o[3]||(o[3]=a=>p.value.currentPage=a),"sort-by":p.value.sortBy,"onUpdate:sortBy":o[4]||(o[4]=a=>p.value.sortBy=a),"must-sort":"",class:"locations-table","hide-default-footer":"","fixed-header":"",density:"compact","no-data-text":d(t)("core.locations.noInstancesFound")},{"header.ip":i(()=>[l("div",De,[s(M,{icon:N.ip,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.ipAddress")),1)])]),"header.osUptime":i(()=>[l("div",$e,[s(M,{icon:N.osUptime,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.uptime")),1)])]),"header.runningSince":i(()=>[l("div",Ae,[s(M,{icon:N.running,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.running")),1)])]),"item.ip":i(({item:a})=>[s(F,{color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(a.ip),1)]),_:2},1024)]),"item.osUptime":i(({item:a})=>[s(F,{color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(x(a.osUptime)),1)]),_:2},1024)]),"item.runningSince":i(({item:a})=>[s(F,{color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(D(a.runningSince)),1)]),_:2},1024)]),"header.continent":i(()=>[l("div",Pe,[s(M,{icon:N.continent,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.continent")),1)])]),"header.country":i(()=>[l("div",Ve,[s(M,{icon:N.country,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.country")),1)])]),"header.region":i(()=>[l("div",Ne,[s(M,{icon:N.region,size:"18",class:"mr-2"},null,8,["icon"]),l("span",null,m(d(t)("core.locations.region")),1)])]),"item.continent":i(({item:a})=>[e.showLocation?(u(),b("div",Se,[a.continent?(u(),B(F,{key:0,color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(a.continent),1)]),_:2},1024)):P("",!0)])):P("",!0)]),"item.country":i(({item:a})=>[e.showLocation?(u(),b("div",Me,[a.country?(u(),B(F,{key:0,color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(a.country),1)]),_:2},1024)):P("",!0)])):P("",!0)]),"item.region":i(({item:a})=>[e.showLocation?(u(),b("div",Be,[a.region?(u(),B(F,{key:0,color:"success",label:"",size:"small",class:"text-no-wrap",style:{"border-radius":"15px"}},{default:i(()=>[l("strong",null,m(a.region),1)]),_:2},1024)):P("",!0)])):P("",!0)]),"item.visit":i(({item:a})=>[l("div",Ee,[s(H,{text:d(t)("core.locations.visitApp")},{activator:i(({props:v})=>[s(O,q(v,{size:"x-small",color:"primary",class:"mr-2",rounded:"pill",onClick:A=>c(a.name,a.ip.split(":")[0],V(e.appSpec))}),{default:i(()=>[s(M,{size:"18",icon:"mdi-door-open"})]),_:1},16,["onClick"])]),_:2},1032,["text"]),s(H,{text:d(t)("core.locations.visitFluxNode")},{activator:i(({props:v})=>[s(O,q(v,{size:"x-small",color:"primary",rounded:"pill",onClick:A=>y(a.ip.split(":")[0],a.ip.split(":")[1]?+a.ip.split(":")[1]-1:16126)}),{default:i(()=>[s(M,{size:"18",icon:"mdi-home"})]),_:1},16,["onClick"])]),_:2},1032,["text"])])]),_:1},8,["headers","items","items-per-page","page","sort-by","no-data-text"])]),_:1},8,["class"]),l("div",null,[g.value.length>5?(u(),B(ce,{key:0,modelValue:p.value.currentPage,"onUpdate:modelValue":o[5]||(o[5]=a=>p.value.currentPage=a),length:Math.ceil(g.value.length/p.value.perPage),density:"compact",rounded:"",size:"small","total-visible":"5",class:"justify-center mb-2"},null,8,["modelValue","length"])):P("",!0)])])])}}},Pt=G(Le,[["__scopeId","data-v-318aa61a"]]),ze={class:"title-content"},Ie={class:"title-text"},_e={key:0},Fe=["href"],Te={key:2},Ue={__name:"ListEntry",props:{title:String,titleIcon:String,titleIconScale:{type:[Number,String],default:24},classes:{type:String,default:"mb-1"},data:{type:[String,Array,Number],default:""},number:{type:Number,default:Number.MAX_VALUE},variant:{type:String,default:"secondary"},href:{type:String,default:""},click:{type:Boolean,default:!1},hideIfEmpty:{type:Boolean,default:!1},kbdVariant:{type:String,default:null}},emits:["click"],setup(e){const n=e;ge();const t=_(()=>Array.isArray(n.data)?n.data.join(", "):typeof n.data=="string"&&n.data.trim()||typeof n.data=="number"&&!Number.isNaN(n.data)?n.data:n.number!==Number.MAX_VALUE?n.number:""),$=_(()=>{const S=Array.isArray(n.data)?n.data.length>0:String(n.data||"").trim()!=="",N=n.number!==Number.MAX_VALUE;return!(S||N)}),p=_(()=>n.hideIfEmpty&&$.value);return(S,N)=>p.value?P("",!0):(u(),b("dl",{key:0,class:z(["grid-row",e.classes])},[l("dt",null,[l("div",ze,[e.titleIcon?(u(),B(M,{key:0,icon:e.titleIcon,size:Number(e.titleIconScale)*18,class:"mr-1"},null,8,["icon","size"])):P("",!0),l("span",Ie,[Y(S.$slots,"title",{},()=>[E(m(e.title),1)],!0)])])]),e.href.length>0?(u(),b("dd",_e,[l("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",class:"text-decoration-none"},[e.kbdVariant?(u(),b("kbd",{key:0,class:z(["resource-kbd",[`kbd-${e.kbdVariant}`]])},m(t.value),3)):(u(),b("span",{key:1,class:z([`text-${e.variant}`,"value-span"])},m(t.value),3))],8,Fe)])):e.click?(u(),b("dd",{key:1,onClick:N[0]||(N[0]=C=>S.$emit("click"))},[s(O,{variant:"text",class:"pa-0"},{default:i(()=>[e.kbdVariant?(u(),b("kbd",{key:0,class:z(["resource-kbd",[`kbd-${e.kbdVariant}`]])},m(t.value),3)):(u(),b("span",{key:1,class:z([`text-${e.variant}`,"value-span"])},m(t.value),3))]),_:1})])):(u(),b("dd",Te,[Y(S.$slots,"default",{},()=>[e.kbdVariant?(u(),b("kbd",{key:0,class:z(["resource-kbd",[`kbd-${e.kbdVariant}`]])},m(t.value),3)):(u(),b("span",{key:1,class:z([`text-${e.variant}`,"value-span"])},m(t.value),3))],!0)]))],2))}},te=G(Ue,[["__scopeId","data-v-2cbeb9a3"]]),je={key:0,class:"component-details-root"},Oe=["href"],Re={class:"alert-secondary resource-kbd"},We={class:"kbd-list"},He=["href"],Ge={class:"alert-info resource-kbd animated-link"},Xe={class:"kbd-list"},qe=["href"],Ke={class:"alert-info resource-kbd animated-link"},Je={class:"kbd-list"},Ye={class:"kbd-list"},Qe={class:"alert-secondary resource-kbd d-flex align-items-center",style:{width:"fit-content"}},Ze={class:"alert-secondary resource-kbd d-inline-flex align-items-center"},et={class:"d-flex align-center justify-start my-3"},tt={class:"ml-1 hardware-chip-text"},at={class:"hardware-resources-grid"},nt={class:"resource-label"},ot={class:"text-subtitle-1 font-weight-medium"},it={class:"circular-progress-wrapper"},st={class:"circular-progress",viewBox:"0 0 100 100",style:{overflow:"visible"}},rt=["id"],lt=["stroke","stroke-dasharray","stroke-dashoffset","filter"],ct=["transform"],dt={class:"circular-content"},ut={__name:"ComponentDetails",props:{component:Object,index:Number,appName:String},setup(e){const{t:n}=X();function t(C){const f={success:"#4CAF50",warning:"#FF9800",info:"#2196F3"};return f[C]||f.success}function $(C){const f=g=>g.replace(/^https?:\/\//,"");return C?Array.isArray(C)?C.flatMap(g=>typeof g=="string"?g.split(",").map(x=>f(x.trim())):[g]).filter(Boolean):typeof C=="string"?C.split(",").map(g=>f(g.trim())).filter(Boolean):[]:[]}function p(C){if(!C)return null;const[f]=C.split(":");return f.startsWith("ghcr.io/")||f.startsWith("registry.gitlab.com/")?`https://${f}`:f.startsWith("docker.io/")?`https://hub.docker.com/r/${f.replace("docker.io/","")}`:f.includes("/")?`https://hub.docker.com/r/${f}`:`https://hub.docker.com/_/${f}`}function S(C){const f=(h,a,v)=>`${h} ${h===1?a:v}`,c=C.cpu||0,y=C.ram||0,k=C.hdd||0,w=(h,a)=>{const v=h/a*100,A=h>0?Math.max(v,2):0;return{percentage:v.toFixed(1),visualPercentage:A.toFixed(1)}},D=w(c,15),r=w(y,65536),o=w(k,820);return[{label:n("core.componentDetails.cpu"),icon:"mdi-cpu-64-bit",color:"success",value:f(c,n("core.componentDetails.vCore"),n("core.componentDetails.vCores")),percentage:D.percentage,visualPercentage:D.visualPercentage},{label:n("core.componentDetails.ram"),icon:"mdi-memory",color:"warning",value:n("core.componentDetails.ramValue",{value:y}),percentage:r.percentage,visualPercentage:r.visualPercentage},{label:n("core.componentDetails.ssd"),icon:"mdi-harddisk",color:"info",value:n("core.componentDetails.ssdValue",{value:k}),percentage:o.percentage,visualPercentage:o.visualPercentage}]}function N(C,f,g=0){if(!Array.isArray(C)||!f)return[];const x=f.toLowerCase(),V=[];g===0&&V.push(`${x}.app.runonflux.io`);for(const I of C)V.push(`${x}_${I}.app.runonflux.io`);return V}return(C,f)=>{const g=te;return e.component?(u(),b("div",je,[s(g,{title:d(n)("core.componentDetails.name"),data:e.component.name,"title-icon":"mdi-cube-scan","title-icon-scale":"1.3","kbd-variant":"secondary"},null,8,["title","data"]),s(g,{title:d(n)("core.componentDetails.description"),data:e.component.description,"title-icon":"mdi-text-box","title-icon-scale":"1.3","kbd-variant":"secondary","hide-if-empty":""},null,8,["title","data"]),s(g,{title:d(n)("core.componentDetails.repository"),"title-icon":"mdi-docker","title-icon-scale":"1.5"},{default:i(()=>[l("a",{href:p(e.component.repotag),target:"_blank",rel:"noopener noreferrer",class:z(["mr-1 d-inline-block",{"resource-kbd-disabled":e.component.repoauth}])},[l("kbd",{class:z(["alert-danger resource-kbd",[{"animated-link":!e.component.repoauth}]])},m(e.component.repotag),3)],10,Oe)]),_:1},8,["title"]),s(g,{title:d(n)("core.componentDetails.repositoryAuthentication"),"title-icon":"mdi-lock","title-icon-scale":"1.4"},{default:i(()=>[l("kbd",Re,[s(M,{size:"18"},{default:i(()=>[E(m(e.component?.repoauth?"mdi-eye-off":"mdi-eye"),1)]),_:1}),E(" "+m(e.component?.repoauth?d(n)("core.componentDetails.private"):d(n)("core.componentDetails.public")),1)])]),_:1},8,["title"]),s(g,{title:d(n)("core.componentDetails.customDomains"),data:$(e.component?.domains)||"","hide-if-empty":"","title-icon":"mdi-link","title-icon-scale":"1.3"},{default:i(()=>[l("div",We,[(u(!0),b(T,null,U($(e.component?.domains),(x,V)=>(u(),b("a",{key:V,href:`https://${x}`,target:"_blank",rel:"noopener noreferrer",class:"d-inline-block"},[l("kbd",Ge,m(x),1)],8,He))),128))])]),_:1},8,["title","data"]),s(g,{title:d(n)("core.componentDetails.automaticDomains"),data:N(e.component?.ports,e.appName,e.index),"title-icon":"mdi-earth","title-icon-scale":"1.2","hide-if-empty":""},{default:i(()=>[l("div",Xe,[(u(!0),b(T,null,U(N(e.component?.ports,e.appName,e.index),(x,V)=>(u(),b("a",{key:V,href:`https://${x}`,target:"_blank",rel:"noopener noreferrer"},[l("kbd",Ke,m(x),1)],8,qe))),128))])]),_:1},8,["title","data"]),s(g,{title:d(n)("core.componentDetails.ports"),data:$(e.component?.ports),"hide-if-empty":"","title-icon":"mdi-power-plug","title-icon-scale":"1.3"},{default:i(()=>[l("div",Je,[(u(!0),b(T,null,U($(e.component?.ports),(x,V)=>(u(),b("kbd",{key:V,class:"alert-success resource-kbd"},m(x),1))),128))])]),_:1},8,["title","data"]),s(g,{title:d(n)("core.componentDetails.containerPorts"),data:$(e.component?.containerPorts),"hide-if-empty":"","title-icon":"mdi-power-plug-outline","title-icon-scale":"1.3"},{default:i(()=>[l("div",Ye,[(u(!0),b(T,null,U($(e.component?.containerPorts),(x,V)=>(u(),b("kbd",{key:V,class:"alert-success resource-kbd"},m(x),1))),128))])]),_:1},8,["title","data"]),s(g,{title:d(n)("core.componentDetails.containerData"),data:e.component?.containerData,"title-icon":"mdi-folder","title-icon-scale":"1.3","kbd-variant":"secondary"},{default:i(()=>[l("kbd",Qe,[/s:|r:|g:/i.test(e.component?.containerData)?(u(),B(M,{key:0,size:"20",color:"info",class:"mr-1"},{default:i(()=>[...f[0]||(f[0]=[E("mdi-folder-sync",-1)])]),_:1})):P("",!0),E(" "+m(e.component?.containerData),1)])]),_:1},8,["title","data"]),s(g,{title:d(n)("core.componentDetails.environmentParameters"),data:Array.isArray(e.component?.environmentParameters)?e.component.environmentParameters.join(", "):"","hide-if-empty":"","title-icon":"mdi-cog-outline","title-icon-scale":"1.3","kbd-variant":"secondary"},null,8,["title","data"]),s(g,{title:d(n)("core.componentDetails.commands"),data:Array.isArray(e.component?.commands)?e.component.commands.join(", "):"","hide-if-empty":"","title-icon":"mdi-console","title-icon-scale":"1.2","kbd-variant":"secondary"},null,8,["title","data"]),e.component?.secrets?(u(),B(g,{key:0,title:d(n)("core.componentDetails.secrets"),"title-icon":"mdi-shield-lock","title-icon-scale":"1.3","kbd-variant":"secondary"},{default:i(()=>[l("kbd",Ze,m(d(n)("core.componentDetails.contentEncrypted")),1)]),_:1},8,["title"])):P("",!0),l("div",et,[s(F,{color:"surface",variant:"tonal",class:"hardware-chip w-100"},{default:i(()=>[s(M,{size:"22",class:"ml-1",color:"success"},{default:i(()=>[...f[1]||(f[1]=[E(" mdi-chart-box-outline ",-1)])]),_:1}),l("span",tt,m(d(n)("core.componentDetails.hardwareResources")),1)]),_:1})]),l("div",at,[(u(!0),b(T,null,U(S(e.component),(x,V)=>(u(),B(Z,{key:V,border:"",class:"hardware-card"},{default:i(()=>[s(Q,{class:"pa-3 position-relative d-flex align-center justify-center"},{default:i(()=>[l("div",nt,[s(M,{icon:x.icon,size:"24",color:"grey",class:"mr-2"},null,8,["icon"]),l("span",ot,m(x.label),1)]),l("div",it,[(u(),b("svg",st,[l("defs",null,[l("filter",{id:`progress-glow-${V}`,x:"-20%",y:"-20%",width:"140%",height:"140%"},[...f[2]||(f[2]=[l("feGaussianBlur",{stdDeviation:"1.2",result:"coloredBlur"},null,-1),l("feMerge",null,[l("feMergeNode",{in:"coloredBlur"}),l("feMergeNode",{in:"SourceGraphic"})],-1)])],8,rt)]),f[3]||(f[3]=l("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"rgba(var(--v-theme-on-surface), 0.12)","stroke-width":"8","stroke-dasharray":"none"},null,-1)),l("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:t(x.color),"stroke-width":"8","stroke-linecap":"butt","stroke-dasharray":`${2*Math.PI*42}`,"stroke-dashoffset":`${2*Math.PI*42-2*Math.PI*42*x.visualPercentage/100}`,filter:`url(#progress-glow-${V})`,transform:"rotate(-90 50 50)"},null,8,lt),(u(),b(T,null,U(30,I=>l("line",{key:`sep-${I}`,x1:"50",y1:"0",x2:"50",y2:"100",stroke:"rgb(var(--v-theme-surface))","stroke-width":"2",transform:`rotate(${-90+(I-.5)*(360/30)} 50 50)`},null,8,ct)),64))])),l("div",dt,[s(F,{color:x.color,variant:"tonal",size:"small",rounded:"xl"},{default:i(()=>[E(m(x.value),1)]),_:2},1032,["color"]),l("div",{class:"text-caption font-weight-bold mt-1",style:ye({color:t(x.color)})},m(x.percentage)+"%",5)])])]),_:2},1024)]),_:2},1024))),128))])])):P("",!0)}}},Vt=G(ut,[["__scopeId","data-v-60541b73"]]),pt={key:0,class:"app-details-wrapper"},mt={key:0,class:"d-flex align-center justify-start mb-3 general-header"},ft={class:"ml-1"},ht={class:"kbd-list"},L=202e4,gt={__name:"AppDetailsCard",props:{app:Object,getNewExpireLabel:{type:[String,Number,Function],required:!1,default:null},activeAppsTab:{type:Boolean,default:!1},expiredAppsTab:{type:Boolean,default:!1},isMarketplace:{type:Boolean,default:!1},showGeneralSection:{type:Boolean,default:!1}},setup(e){const n=e,{t}=X(),$=W(null),p=W({show:!1,message:"",color:"success",timeout:3e3}),S=_(()=>{if(!n.app?.height||!n.app?.hash||n.app.hash.length!==64)return null;const c=n.app.height>=L?88e3:22e3,y=n.app.expire||c,k=n.app.height+y;if(n.app.height<L&&k>L){const D=y*2,o=(L-n.app.height)*2,a=(D-o)/.5;return L+a}return k}),N=_(()=>{if(!n.app?.height||$.value===null||$.value<0)return t("core.appDetailsCard.notAvailable");const c=n.app.height>=L?88e3:22e3,y=n.app.expire||c,k=n.app.height<L?2:.5,w=y*k;let D=0;if(n.app.height<L)if($.value<=L)D=($.value-n.app.height)*2;else{const A=L-n.app.height,R=$.value-L;D=A*2+R*.5}else D=($.value-n.app.height)*.5;const r=w-D;if(r<=0)return t("core.appDetailsCard.applicationExpired");const o=Math.floor(r/1440),h=Math.floor(r%1440/60),a=Math.floor(r%60),v=[];return o>0&&v.push(`${o} day${o!==1?"s":""}`),h>0&&v.push(`${h} hour${h!==1?"s":""}`),(a>0||v.length===0)&&v.push(`${a} minute${a!==1?"s":""}`),v.slice(0,3).join(", ")});ee(async()=>{try{const c=await be.getBlockCount();if(c?.data?.status==="success"&&typeof c.data?.data=="number"){$.value=c.data.data;return}}catch(c){console.log("Daemon block height not available, falling back to explorer:",c)}try{const c=await ke.getScannedHeight();c.data.status==="success"&&($.value=c.data.data.generalScannedHeight)}catch(c){console.error("Error fetching block height from both sources:",c),$.value=null}});function C(c){if(!c||c.length<14)return!1;const y=c.substring(c.length-13),k=Number(y);return!isNaN(k)}async function f(){try{const c=JSON.stringify(n.app,null,2);await navigator.clipboard.writeText(c),p.value.message=t("core.appDetailsCard.specificationCopied"),p.value.color="success",p.value.show=!0}catch(c){console.error("Failed to copy specification:",c),p.value.message=t("core.appDetailsCard.specificationCopyFailed"),p.value.color="error",p.value.show=!0}}function g(c){if(!c)return t("core.appDetailsCard.worldwide");if(c.startsWith("a")&&!c.startsWith("ac")&&!c.startsWith("a!c")){const y=c.slice(1),k=j.continents.find(w=>w.code===y)||{name:t("core.appDetailsCard.unknown")};return t("core.appDetailsCard.continent",{name:k.name})}if(c.startsWith("b")){const y=c.slice(1),k=j.countries.find(w=>w.code===y)||{name:t("core.appDetailsCard.unknown")};return t("core.appDetailsCard.country",{name:k.name})}if(c.startsWith("ac")){const y=c.slice(2),[k,w,D]=y.split("_"),r=j.continents.find(a=>a.code===k)||{name:t("core.appDetailsCard.unknown")},o=j.countries.find(a=>a.code===w)||{name:t("core.appDetailsCard.unknown")};let h=t("core.appDetailsCard.allowedContinent",{name:r.name});return w&&(h+=t("core.appDetailsCard.country",{name:o.name})),D&&(h+=t("core.appDetailsCard.region",{name:D})),h}if(c.startsWith("a!c")){const y=c.slice(3),[k,w,D]=y.split("_"),r=j.continents.find(a=>a.code===k)||{name:t("core.appDetailsCard.unknown")},o=j.countries.find(a=>a.code===w)||{name:t("core.appDetailsCard.unknown")};let h=t("core.appDetailsCard.forbiddenContinent",{name:r.name});return w&&(h+=t("core.appDetailsCard.country",{name:o.name})),D&&(h+=t("core.appDetailsCard.region",{name:D})),h}return t("core.appDetailsCard.worldwide")}function x(c){return c?Array.isArray(c)?c.flatMap(y=>typeof y=="string"?y.split(",").map(k=>k.trim()):[y]).filter(Boolean):typeof c=="string"?c.split(",").map(y=>y.trim()).filter(Boolean):[]:[]}function V(c){return c.some(y=>typeof y=="string"&&y.includes("@"))?"mdi-email-outline":"mdi-email-lock"}function I(c){const y=typeof c=="string"?c.match(/\d+\s*(day|hour|minute)/gi):null;if(!y)return"secondary";const w=y.reduce((D,r)=>{const[o,h]=r.match(/\d+|\D+/g).map(v=>v.trim()),a=parseInt(o,10);return h.startsWith("day")?D+a*1440:h.startsWith("hour")?D+a*60:h.startsWith("minute")?D+a:D},0)/1440;return w<3?"danger":w<=4?"warning":"success"}return(c,y)=>{const k=te;return e.app?(u(),b("div",pt,[e.showGeneralSection?(u(),b("h3",mt,[s(F,{color:"info",variant:"tonal",class:"general-chip"},{default:i(()=>[s(M,{size:"22",class:"ml-1"},{default:i(()=>[...y[1]||(y[1]=[E(" mdi-information-outline ",-1)])]),_:1}),l("span",ft,m(d(t)("core.appDetailsCard.general")),1)]),_:1}),e.activeAppsTab&&!e.isMarketplace&&!C(e.app.name)?(u(),B(O,{key:0,icon:"",variant:"text",color:"info",size:"x-small",class:"export-btn-icon",onClick:f},{default:i(()=>[s(M,{size:"16"},{default:i(()=>[...y[2]||(y[2]=[E("mdi-content-copy",-1)])]),_:1}),s(H,{activator:"parent",location:"left"},{default:i(()=>[E(m(d(t)("core.appDetailsCard.copySpecification")),1)]),_:1})]),_:1})):P("",!0)])):P("",!0),s(de,{modelValue:p.value.show,"onUpdate:modelValue":y[0]||(y[0]=w=>p.value.show=w),color:p.value.color,timeout:p.value.timeout,location:"top"},{default:i(()=>[E(m(p.value.message),1)]),_:1},8,["modelValue","color","timeout"]),s(k,{title:d(t)("core.appDetailsCard.name"),data:e.app.name,"title-icon":"mdi-package-variant","title-icon-scale":"1.3","kbd-variant":"secondary"},null,8,["title","data"]),s(k,{title:d(t)("core.appDetailsCard.description"),data:e.app.description,"title-icon":"mdi-text-box-outline","title-icon-scale":"1.3","kbd-variant":"secondary","hide-if-empty":""},null,8,["title","data"]),s(k,{title:d(t)("core.appDetailsCard.owner"),data:e.app.owner,"title-icon":"mdi-account","title-icon-scale":"1.3","kbd-variant":"secondary"},null,8,["title","data"]),e.expiredAppsTab?P("",!0):(u(),B(k,{key:1,title:d(t)("core.appDetailsCard.hash"),data:e.app.hash,"title-icon":"mdi-pound-box","title-icon-scale":"1.3","kbd-variant":"secondary"},null,8,["title","data"])),e.app?.contacts&&e.app.contacts.length>0?(u(),B(k,{key:2,title:d(t)("core.appDetailsCard.contacts"),data:x(e.app.contacts),"title-icon":V(x(e.app.contacts)),"title-icon-scale":"1.3","kbd-variant":"secondary","hide-if-empty":""},null,8,["title","data","title-icon"])):P("",!0),s(k,{title:d(t)("core.appDetailsCard.geolocation"),"title-icon":"mdi-earth","title-icon-scale":"1.3","kbd-variant":"secondary"},{default:i(()=>[l("div",ht,[(u(!0),b(T,null,U(e.app?.geolocation&&e.app.geolocation.length>0?e.app.geolocation:[d(t)("core.appDetailsCard.worldwide")],(w,D)=>(u(),b("div",{key:D,class:"d-inline-block",style:{"margin-right":"5px"}},[l("kbd",{class:z(["resource-kbd",[{"alert-info":g(w).toLowerCase().includes("allowed"),"alert-danger":g(w).toLowerCase().includes("forbidden"),"alert-secondary":!["allowed","forbidden"].some(r=>g(w).toLowerCase().includes(r))}]])},m(g(w)),3)]))),128))])]),_:1},8,["title"]),s(k,{title:d(t)("core.appDetailsCard.instances"),data:e.app?.instances||3,"title-icon":"mdi-map-marker","title-icon-scale":"1.3","kbd-variant":"success"},null,8,["title","data"]),s(k,{title:d(t)("core.appDetailsCard.specificationsVersion"),data:e.app.version,"title-icon":"mdi-file-code","title-icon-scale":"1.3","kbd-variant":"success"},null,8,["title","data"]),e.expiredAppsTab?P("",!0):(u(),B(k,{key:3,title:d(t)("core.appDetailsCard.registeredOnBlockheight"),data:e.app.height,"title-icon":"mdi-calendar-check","title-icon-scale":"1.2","kbd-variant":"success"},null,8,["title","data"])),e.app.hash&&e.app.hash.length===64&&S.value?(u(),B(k,{key:4,title:d(t)("core.appDetailsCard.expiresOnBlockheight"),data:S.value,"title-icon":"mdi-hourglass","title-icon-scale":"1.2","kbd-variant":"success"},null,8,["title","data"])):P("",!0),e.expiredAppsTab?P("",!0):(u(),B(k,{key:5,title:d(t)("core.appDetailsCard.expiresIn"),data:N.value,"title-icon":"mdi-clock-outline","title-icon-scale":"1.2","kbd-variant":I(N.value)},null,8,["title","data","kbd-variant"])),s(k,{title:d(t)("core.appDetailsCard.enterpriseNodes"),data:e.app?.nodes&&e.app?.nodes.length>0?e.app.nodes.join(", "):d(t)("core.appDetailsCard.notScoped"),"title-icon":"mdi-server-network","title-icon-scale":"1.2","kbd-variant":"secondary"},null,8,["title","data"]),s(k,{title:d(t)("core.appDetailsCard.staticIp"),data:e.app.staticip?d(t)("core.appDetailsCard.staticIpYes"):d(t)("core.appDetailsCard.staticIpNo"),"title-icon":"mdi-map-marker-radius","title-icon-scale":"1.2","kbd-variant":"secondary"},null,8,["title","data"])])):P("",!0)}}},Nt=G(gt,[["__scopeId","data-v-ea9d742b"]]),yt={key:1},St={__name:"ConfirmCustomDialog",props:{target:String,confirmButton:{type:String,default:""},title:{type:String,default:""},message:{type:String,default:""},alertType:{type:String,default:"info",validator:e=>["info","warning","error","success"].includes(e)}},emits:["confirm"],setup(e,{emit:n}){const t=e,$=n,{t:p}=X(),S=W(!1);K(()=>t.target,()=>{S.value=!1});function N(){S.value=!1,$("confirm")}return(C,f)=>(u(),B(he,{modelValue:S.value,"onUpdate:modelValue":f[1]||(f[1]=g=>S.value=g),activator:`#${e.target}`,width:e.message?"500":"400"},{default:i(()=>[s(Z,null,{default:i(()=>[s(ue,{class:"text-h5 bg-primary d-flex align-center"},{default:i(()=>[s(M,{class:"mr-2",color:"white"},{default:i(()=>[...f[2]||(f[2]=[E("mdi-help-circle-outline",-1)])]),_:1}),E(" "+m(e.title||d(p)("core.confirmCustomDialog.confirmation")),1)]),_:1}),s(Q,{class:"pa-4"},{default:i(()=>[e.message?(u(),B(pe,{key:0,type:e.alertType,variant:"tonal",density:"compact"},{default:i(()=>[E(m(e.message),1)]),_:1},8,["type"])):(u(),b("div",yt,m(d(p)("core.confirmCustomDialog.areYouSure")),1))]),_:1}),s(me,null,{default:i(()=>[s(fe),s(O,{variant:"text",color:"grey",size:"small",onClick:f[0]||(f[0]=g=>S.value=!1)},{default:i(()=>[E(m(d(p)("core.confirmCustomDialog.cancel")),1)]),_:1}),s(O,{variant:"elevated",color:"primary",size:"small",onClick:N},{default:i(()=>[E(m(e.confirmButton||d(p)("core.confirmCustomDialog.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","activator","width"]))}};export{Pt as _,St as a,Nt as b,Vt as c};
