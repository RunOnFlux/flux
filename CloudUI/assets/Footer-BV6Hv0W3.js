import{D as U}from"./DaemonService-D09C4O6H.js";import{F as Q}from"./FluxService-BN8XNIXv.js";import{_ as W,c as Y}from"./index-QPPWK7xw.js";import{e as $}from"./eventBus-BZyChua5.js";import{s as J}from"./vue-core-CU9AIURn.js";import{F as m,c as V,x as T,b as _,G as K,V as X}from"./vuetify-_4u1He_j.js";import{u as Z}from"./i18n-Bm8bpAAW.js";import{A as ee,r as b,$ as te,w as F,o as j,a6 as q,P as k,x as S,g as h,Q as a,a3 as i,j as s,U as d,y as l,L as w,p as L,T as x,q as I,f as ae}from"./apexcharts-nIAyciCq.js";import"./crypto-metamask-D6vz180a.js";import"./ansi-utils-ChIB8aIv.js";import"./socketio-BDGyx5_k.js";import"./uuid-B49X2dQj.js";import"./vueuse-Bid7ZbHY.js";import"./unhead-DEOrWl0D.js";import"./cookie-BfmCf_44.js";import"./unjs-utils-GcjLqAqW.js";import"./http-BZQDkn3h.js";import"./query-parser-C3-dT-Rr.js";import"./casl-DNC8KRD8.js";import"./scrollbar-CXs_Utq1.js";import"./icons-mdi-_QP0sdRJ.js";import"./sanitizer-DAUAC_Zc.js";import"./element-plus-Cr1Qs4Q_.js";import"./lodash-C_Sw0jJq.js";import"./event-utils-DGlX1gEp.js";const se={class:"d-inline-flex align-center",style:{"white-space":"nowrap"}},oe={class:"d-inline-flex align-center",style:{"white-space":"nowrap"}},ne={class:"d-inline-flex align-center",style:{"white-space":"nowrap"}},re={class:"d-inline-flex align-center"},le={class:"ms-1 d-flex align-center"},ie={__name:"StatusBar",setup(O){const{t:e}=Z(),B=ee().appContext.config.globalProperties.$i18n,u="2.2.0",v=Y(),{fluxVersion:E}=J(v),o=b(0),R=b(!1),N=b(!1),p=b(!1),g=b(localStorage.getItem("statusBarHidden")==="true"),G=()=>{g.value=!g.value,localStorage.setItem("statusBarHidden",g.value.toString());const c=p.value||t.class==="error";window.dispatchEvent(new CustomEvent("statusbar-toggle",{detail:{hidden:g.value,hasError:c}}))},D=c=>{g.value=c.detail.hidden};window.addEventListener("statusbar-toggle",D);const M=()=>{window.dispatchEvent(new CustomEvent("open-cookie-settings"))},t=te({nodeStatus:e("core.statusBar.checkingStatus"),class:"primary",message:e("core.statusBar.checkingStatusMessage")}),z=async()=>{const[c,n]=await Promise.all([U.getFluxNodeStatus().catch(()=>null),U.getBlockchainInfo().catch(()=>null)]);if(!c||!n){t.nodeStatus=e("core.statusBar.unreachable"),t.class="error",t.message=e("core.statusBar.unreachable");return}const r=c.data?.data,f=n.data?.data,P=f?.headers-f?.blocks;t.status=c.data?.status,t.data=r,f?.headers>0&&f?.blocks>0&&P>3?(t.nodeStatus=e("core.statusBar.notSynced"),t.class="warning",t.message=e("core.statusBar.notSyncedMessage",{blocks:f?.blocks,headers:f?.headers,blocksBehind:P})):r.status==="CONFIRMED"||r.location==="CONFIRMED"?(t.nodeStatus=e("core.statusBar.connected"),t.class="success",t.message=e("core.statusBar.connectedMessage")):r.status==="STARTED"||r.location==="STARTED"?(t.nodeStatus=e("core.statusBar.connecting"),t.class="warning",t.message=e("core.statusBar.connectingMessage")):(t.nodeStatus=e("core.statusBar.disconnected"),t.class="error",t.message=e("core.statusBar.disconnectedMessage"))};F(()=>B.locale,()=>{z()}),F(()=>p.value||t.class==="error",c=>{window.dispatchEvent(new CustomEvent("statusbar-toggle",{detail:{hidden:g.value,hasError:c}}))});const H=async()=>{try{const n=(await Q.getFluxVersion()).data?.data;E.value=n,p.value=!1}catch(c){console.error(c),p.value=!0,E.value=null}},A=()=>{H(),z()};let y=null;return j(()=>{typeof window<"u"&&(o.value=window.innerWidth,y=()=>{o.value=window.innerWidth},window.addEventListener("resize",y)),H(),z(),$.on("backendURLChanged",A)}),q(()=>{y&&window.removeEventListener("resize",y),window.removeEventListener("statusbar-toggle",D),$.off("backendURLChanged",A)}),(c,n)=>g.value?S("",!0):(h(),k(X,{key:0,icon:"mdi-server",class:"rounded elevation-4 mb-0 pa-2 statusbar-card",style:{width:"100%",position:"relative",overflow:"visible"}},{default:a(()=>[i(m,{location:"left"},{activator:a(({props:r})=>[i(V,w({icon:"mdi-close",size:"x-small",variant:"flat",color:"error",class:["position-absolute","close-btn-hover",o.value<745?"mobile-small":"desktop-small"],style:{top:"-4px",right:"-4px"},onClick:G},r),null,16,["class"])]),default:a(()=>[s("span",null,d(l(e)("core.statusBar.hideStatusBar")),1)]),_:1}),s("div",{class:"d-flex align-center px-2",style:L({fontSize:"clamp(9.2px, 2vw, 14px)",overflow:"visible",width:"100%",justifyContent:"flex-start",paddingRight:o.value<850?"64px":"0"})},[s("div",{class:"d-flex align-center",style:L({gap:o.value<640?"12px":o.value<800?"18px":"25px",flexWrap:"nowrap",justifyContent:"flex-start"})},[s("div",se,[i(m,{location:"top"},{activator:a(({props:r})=>[s("span",w({class:"d-inline-flex align-center",style:{position:"relative"}},r),[i(T,{dot:"",bordered:"",color:p.value?"error":R.value?"warning":"success",location:"top start","offset-x":"-1","offset-y":"2"},{badge:a(()=>[...n[0]||(n[0]=[s("span",{class:"v-badge__dot",style:{"background-color":"#ff7043"}},null,-1)])]),default:a(()=>[i(_,{size:o.value<640?14:o.value<800?16:20,class:"me-2"},{default:a(()=>[...n[1]||(n[1]=[x("tabler-settings",-1)])]),_:1},8,["size"])]),_:1},8,["color"])],16)]),default:a(()=>[s("span",null,d(p.value?l(e)("core.statusBar.backendError"):R.value?l(e)("core.statusBar.updateAvailable"):l(e)("core.statusBar.upToDate")),1)]),_:1}),s("span",null,[x(d(l(e)("core.statusBar.backend"))+": ",1),s("span",{class:I(p.value?"text-error":"")},d(p.value?l(e)("core.statusBar.error"):l(E)),3)])]),s("div",oe,[i(m,{location:"top"},{activator:a(({props:r})=>[s("span",w({class:"d-inline-flex align-center",style:{position:"relative"}},r),[i(T,{dot:"",bordered:"",location:"top start",color:N.value?"warning":"success","offset-x":"-1","offset-y":"1"},{badge:a(()=>[...n[2]||(n[2]=[s("span",{class:"v-badge__dot",style:{"background-color":"#ff7043"}},null,-1)])]),default:a(()=>[i(_,{size:o.value<640?14:o.value<800?16:20,class:"me-2"},{default:a(()=>[...n[3]||(n[3]=[x("mdi-view-dashboard-outline",-1)])]),_:1},8,["size"])]),_:1},8,["color"])],16)]),default:a(()=>[s("span",null,d(N.value?l(e)("core.statusBar.updateAvailable"):l(e)("core.statusBar.upToDate")),1)]),_:1}),s("span",null,d(l(e)("core.statusBar.frontend"))+": "+d(l(u)),1)]),s("div",ne,[i(m,{location:"top"},{activator:a(({props:r})=>[s("span",w({class:"d-inline-flex align-center",style:{position:"relative"}},r),[i(T,{dot:"",bordered:"",location:"top start",color:t.class,"offset-x":"-1","offset-y":"1"},{badge:a(()=>[...n[4]||(n[4]=[s("span",{class:"v-badge__dot",style:{"background-color":"#ff7043"}},null,-1)])]),default:a(()=>[i(_,{size:o.value<640?14:o.value<800?16:20,class:"me-2"},{default:a(()=>[...n[5]||(n[5]=[x("tabler-heartbeat",-1)])]),_:1},8,["size"])]),_:1},8,["color"])],16)]),default:a(()=>[s("span",null,d(t.message),1)]),_:1}),s("span",re,[x(d(l(e)("core.statusBar.statusMessage"))+": ",1),t.nodeStatus===l(e)("core.statusBar.checkingStatus")?(h(),k(K,{key:0,color:"primary",size:14,width:2,indeterminate:"",class:"ml-1"})):S("",!0),s("span",{class:I(`ml-1 text-${t.class}`)},d(t.nodeStatus),3)])])],4),o.value>=640?(h(),k(m,{key:0,location:"top"},{activator:a(({props:r})=>[i(V,w(r,{color:"success",variant:"tonal",size:o.value<745||o.value<800?"x-small":"small",rounded:"pill",class:"d-flex align-center",style:{marginLeft:"auto",marginRight:"20px",fontSize:o.value<745?"0.65rem":o.value<800?"0.7rem":"0.875rem",padding:o.value<745?"4px 8px":void 0},onClick:M}),{default:a(()=>[i(_,{size:o.value<745?12:o.value<800?14:o.value<1100?18:20},{default:a(()=>[...n[6]||(n[6]=[x("mdi-cookie-settings",-1)])]),_:1},8,["size"]),s("span",le,d(l(e)("common.cookieConsent.manageCookies")),1)]),_:1},16,["size","style"])]),default:a(()=>[s("span",null,d(l(e)("core.statusBar.manageCookiesTooltip")),1)]),_:1})):S("",!0)],4),o.value<640?(h(),k(m,{key:0,location:"top"},{activator:a(({props:r})=>[i(V,w(r,{color:"success",variant:"tonal",size:"x-small",icon:"mdi-cookie-settings",class:"position-absolute",style:{top:"50%",right:"24px",transform:"translateY(-50%)"},onClick:M}),null,16)]),default:a(()=>[s("span",null,d(l(e)("core.statusBar.manageCookiesTooltip")),1)]),_:1})):S("",!0)]),_:1}))}},ce=W(ie,[["__scopeId","data-v-7b3e48c6"]]),de={class:"footer-container"},ue={__name:"Footer",setup(O){const e=b(localStorage.getItem("statusBarHidden")==="true"),C=u=>{e.value=u.detail.hidden},B=()=>{const u=document.querySelector(".layout-footer"),v=document.querySelector(".layout-page-content");u&&(e.value?(u.classList.add("statusbar-hidden"),v&&(v.style.paddingBlockEnd="0.25rem")):(u.classList.remove("statusbar-hidden"),v&&(v.style.paddingBlockEnd="0.5rem")))};return F(e,B),j(()=>{window.addEventListener("statusbar-toggle",C),B()}),q(()=>{window.removeEventListener("statusbar-toggle",C)}),(u,v)=>(h(),ae("div",de,[s("div",{class:I(["d-flex align-center w-100 footer-wrapper",{"statusbar-hidden":e.value}]),style:L({height:e.value?"0px":"100%",minHeight:e.value?"0px":"auto",paddingBottom:e.value?"1rem":"0"})},[i(ce,{style:{width:"100%"}})],6)]))}},Me=W(ue,[["__scopeId","data-v-bc8539d2"]]);export{Me as default};
